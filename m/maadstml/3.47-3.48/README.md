# Comparing `tmp/maadstml-3.47.tar.gz` & `tmp/maadstml-3.48.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "maadstml-3.47.tar", last modified: Wed Feb 21 02:03:01 2024, max compression
+gzip compressed data, was "maadstml-3.48.tar", last modified: Wed Apr 17 14:19:38 2024, max compression
```

## Comparing `maadstml-3.47.tar` & `maadstml-3.48.tar`

### file list

```diff
@@ -1,19 +1,19 @@
-drwxrwxrwx   0        0        0        0 2024-02-21 02:03:01.548497 maadstml-3.47/
--rw-rw-rw-   0        0        0      852 2020-02-09 18:05:54.000000 maadstml-3.47/LICENSE.txt
--rw-rw-rw-   0        0        0       65 2021-01-25 23:03:44.000000 maadstml-3.47/MANIFEST.in
--rw-rw-rw-   0        0        0   179908 2024-02-21 02:03:01.547492 maadstml-3.47/PKG-INFO
--rw-rw-rw-   0        0        0   179243 2024-02-21 02:01:39.000000 maadstml-3.47/README.md
-drwxrwxrwx   0        0        0        0 2024-02-21 02:03:01.517089 maadstml-3.47/maadstml/
--rw-rw-rw-   0        0        0     2551 2024-02-20 20:20:07.000000 maadstml-3.47/maadstml/__init__.py
--rw-rw-rw-   0        0        0     4871 2023-06-10 19:44:05.000000 maadstml-3.47/maadstml/readpdf.py
--rw-rw-rw-   0        0        0    85828 2024-02-21 00:56:15.000000 maadstml-3.47/maadstml/sendfiles.py
--rw-rw-rw-   0        0        0    10850 2023-06-10 19:08:28.000000 maadstml-3.47/maadstml/tmltextsummary.py
-drwxrwxrwx   0        0        0        0 2024-02-21 02:03:01.545492 maadstml-3.47/maadstml.egg-info/
--rw-rw-rw-   0        0        0   179908 2024-02-21 02:03:01.000000 maadstml-3.47/maadstml.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      320 2024-02-21 02:03:01.000000 maadstml-3.47/maadstml.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2024-02-21 02:03:01.000000 maadstml-3.47/maadstml.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0      211 2024-02-21 02:03:01.000000 maadstml-3.47/maadstml.egg-info/requires.txt
--rw-rw-rw-   0        0        0        9 2024-02-21 02:03:01.000000 maadstml-3.47/maadstml.egg-info/top_level.txt
--rw-rw-rw-   0        0        0      226 2024-02-20 20:15:13.000000 maadstml-3.47/requirements.txt
--rw-rw-rw-   0        0        0       42 2024-02-21 02:03:01.548497 maadstml-3.47/setup.cfg
--rw-rw-rw-   0        0        0     1156 2024-02-20 20:21:09.000000 maadstml-3.47/setup.py
+drwxrwxrwx   0        0        0        0 2024-04-17 14:19:38.500236 maadstml-3.48/
+-rw-rw-rw-   0        0        0      852 2020-02-09 18:05:54.000000 maadstml-3.48/LICENSE.txt
+-rw-rw-rw-   0        0        0       65 2021-01-25 23:03:44.000000 maadstml-3.48/MANIFEST.in
+-rw-rw-rw-   0        0        0   179908 2024-04-17 14:19:38.500236 maadstml-3.48/PKG-INFO
+-rw-rw-rw-   0        0        0   179243 2024-02-21 02:01:39.000000 maadstml-3.48/README.md
+drwxrwxrwx   0        0        0        0 2024-04-17 14:19:38.469391 maadstml-3.48/maadstml/
+-rw-rw-rw-   0        0        0     2551 2024-02-20 20:20:07.000000 maadstml-3.48/maadstml/__init__.py
+-rw-rw-rw-   0        0        0     4871 2023-06-10 19:44:05.000000 maadstml-3.48/maadstml/readpdf.py
+-rw-rw-rw-   0        0        0    86510 2024-04-17 14:17:10.000000 maadstml-3.48/maadstml/sendfiles.py
+-rw-rw-rw-   0        0        0    10850 2023-06-10 19:08:28.000000 maadstml-3.48/maadstml/tmltextsummary.py
+drwxrwxrwx   0        0        0        0 2024-04-17 14:19:38.498173 maadstml-3.48/maadstml.egg-info/
+-rw-rw-rw-   0        0        0   179908 2024-04-17 14:19:38.000000 maadstml-3.48/maadstml.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      320 2024-04-17 14:19:38.000000 maadstml-3.48/maadstml.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-04-17 14:19:38.000000 maadstml-3.48/maadstml.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0      211 2024-04-17 14:19:38.000000 maadstml-3.48/maadstml.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        9 2024-04-17 14:19:38.000000 maadstml-3.48/maadstml.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0      226 2024-02-20 20:15:13.000000 maadstml-3.48/requirements.txt
+-rw-rw-rw-   0        0        0       42 2024-04-17 14:19:38.501152 maadstml-3.48/setup.cfg
+-rw-rw-rw-   0        0        0     1156 2024-04-17 14:05:49.000000 maadstml-3.48/setup.py
```

### Comparing `maadstml-3.47/LICENSE.txt` & `maadstml-3.48/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `maadstml-3.47/PKG-INFO` & `maadstml-3.48/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: maadstml
-Version: 3.47
+Version: 3.48
 Summary: Multi-Agent Accelerator for Data Science (MAADS): Transactional Machine Learning
 Home-page: https://github.com/smaurice101/transactionalmachinelearning
 Author: Sebastian Maurice
 Author-email: sebastian.maurice@otics.ca
 License: MIT License
 Keywords: genai, multi-agent, transactional machine learning, artificial intelligence, chatGPT, generative AI, privateGPT, data streams, data science, optimization, prescriptive analytics, machine learning, automl,auto-ml,artificial intelligence,predictive analytics,advanced analytics
 Description-Content-Type: text/markdown
```

### Comparing `maadstml-3.47/README.md` & `maadstml-3.48/README.md`

 * *Files identical despite different names*

### Comparing `maadstml-3.47/maadstml/__init__.py` & `maadstml-3.48/maadstml/__init__.py`

 * *Files identical despite different names*

### Comparing `maadstml-3.47/maadstml/readpdf.py` & `maadstml-3.48/maadstml/readpdf.py`

 * *Files identical despite different names*

### Comparing `maadstml-3.47/maadstml/sendfiles.py` & `maadstml-3.48/maadstml/sendfiles.py`

 * *Files 4% similar despite different names*

```diff
@@ -14,5352 +14,5394 @@
 000000d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000000e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000000f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000100: 2323 2323 2323 2323 2323 2323 0d0a 0d0a  ############....
 00000110: 696d 706f 7274 206a 736f 6e2c 2075 726c  import json, url
 00000120: 6c69 620d 0a69 6d70 6f72 7420 7265 7175  lib..import requ
 00000130: 6573 7473 0d0a 696d 706f 7274 2063 7376  ests..import csv
-00000140: 0d0a 696d 706f 7274 206f 730d 0a69 6d70  ..import os..imp
-00000150: 6f72 7420 696d 700d 0a69 6d70 6f72 7420  ort imp..import 
-00000160: 7265 0d0a 696d 706f 7274 2075 726c 6c69  re..import urlli
-00000170: 622e 7265 7175 6573 740d 0a69 6d70 6f72  b.request..impor
-00000180: 7420 6173 796e 6369 6f0d 0a69 6d70 6f72  t asyncio..impor
-00000190: 7420 7661 6c69 6461 746f 7273 0d0a 6672  t validators..fr
-000001a0: 6f6d 2075 726c 6c69 622e 7061 7273 6520  om urllib.parse 
-000001b0: 696d 706f 7274 2075 726c 6a6f 696e 0d0a  import urljoin..
-000001c0: 6672 6f6d 2075 726c 6c69 622e 7061 7273  from urllib.pars
-000001d0: 6520 696d 706f 7274 2075 726c 7370 6c69  e import urlspli
-000001e0: 740d 0a69 6d70 6f72 7420 6169 6f68 7474  t..import aiohtt
-000001f0: 700d 0a66 726f 6d20 6169 6f68 7474 7020  p..from aiohttp 
-00000200: 696d 706f 7274 2043 6c69 656e 7453 6573  import ClientSes
-00000210: 7369 6f6e 2c43 6c69 656e 7454 696d 656f  sion,ClientTimeo
-00000220: 7574 0d0a 696d 706f 7274 2061 7379 6e63  ut..import async
-00000230: 5f74 696d 656f 7574 0d0a 2369 6d70 6f72  _timeout..#impor
-00000240: 7420 7265 6164 7064 660d 0a66 726f 6d20  t readpdf..from 
-00000250: 7365 6c65 6e69 756d 2e77 6562 6472 6976  selenium.webdriv
-00000260: 6572 2e66 6972 6566 6f78 2e6f 7074 696f  er.firefox.optio
-00000270: 6e73 2069 6d70 6f72 7420 4f70 7469 6f6e  ns import Option
-00000280: 730d 0a66 726f 6d20 7365 6c65 6e69 756d  s..from selenium
-00000290: 2069 6d70 6f72 7420 7765 6264 7269 7665   import webdrive
-000002a0: 720d 0a0d 0a63 6f6e 6e65 6374 696f 6e65  r....connectione
-000002b0: 7272 6f72 3d22 220d 0a0d 0a6c 6f6f 7020  rror=""....loop 
-000002c0: 3d20 6173 796e 6369 6f2e 6765 745f 6576  = asyncio.get_ev
-000002d0: 656e 745f 6c6f 6f70 2829 0d0a 0d0a 6465  ent_loop()....de
-000002e0: 6620 6361 6e63 656c 616c 6c74 6173 6b73  f cancelalltasks
-000002f0: 2829 3a0d 0a20 2020 2074 7279 3a0d 0a20  ():..    try:.. 
-00000300: 2020 2020 2070 656e 6469 6e67 203d 2061       pending = a
-00000310: 7379 6e63 696f 2e61 6c6c 5f74 6173 6b73  syncio.all_tasks
-00000320: 2829 0d0a 2020 2020 2020 666f 7220 7461  ()..      for ta
-00000330: 736b 2069 6e20 7065 6e64 696e 673a 0d0a  sk in pending:..
-00000340: 2020 2020 2020 2020 7461 736b 2e63 616e          task.can
-00000350: 6365 6c28 290d 0a20 2020 2065 7863 6570  cel()..    excep
-00000360: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-00000370: 3a0d 0a20 2020 2020 2070 6173 7320 200d  :..      pass  .
-00000380: 0a0d 0a64 6566 2066 6f72 6d61 7475 726c  ...def formaturl
-00000390: 286d 6169 6e64 6174 612c 686f 7374 2c6d  (maindata,host,m
-000003a0: 6963 726f 7365 7276 6963 6569 642c 7072  icroserviceid,pr
-000003b0: 6568 6f73 742c 706f 7274 293a 0d0a 0d0a  ehost,port):....
-000003c0: 2020 2020 6966 206c 656e 286d 6963 726f      if len(micro
-000003d0: 7365 7276 6963 6569 6429 3e30 3a20 2020  serviceid)>0:   
-000003e0: 200d 0a20 2020 2020 206d 6169 6e75 726c   ..      mainurl
-000003f0: 3d70 7265 686f 7374 202b 2022 3a2f 2f22  =prehost + "://"
-00000400: 202b 2068 6f73 7420 2b20 2022 3a22 202b   + host +  ":" +
-00000410: 2073 7472 2870 6f72 7429 202b 222f 2220   str(port) +"/" 
-00000420: 2b20 6d69 6372 6f73 6572 7669 6365 6964  + microserviceid
-00000430: 202b 2022 2f3f 6879 7065 7270 7265 6469   + "/?hyperpredi
-00000440: 6374 3d22 202b 206d 6169 6e64 6174 610d  ct=" + maindata.
-00000450: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
-00000460: 2020 6d61 696e 7572 6c3d 7072 6568 6f73    mainurl=prehos
-00000470: 7420 2b20 223a 2f2f 2220 2b20 686f 7374  t + "://" + host
-00000480: 202b 2022 3a22 202b 2073 7472 2870 6f72   + ":" + str(por
-00000490: 7429 202b 222f 3f68 7970 6572 7072 6564  t) +"/?hyperpred
-000004a0: 6963 743d 2220 2b20 6d61 696e 6461 7461  ict=" + maindata
-000004b0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-000004c0: 7265 7475 726e 206d 6169 6e75 726c 0d0a  return mainurl..
-000004d0: 2020 2020 0d0a 6173 796e 6320 6465 6620      ..async def 
-000004e0: 7463 705f 6563 686f 5f63 6c69 656e 7428  tcp_echo_client(
-000004f0: 6d65 7373 6167 652c 206c 6f6f 702c 686f  message, loop,ho
-00000500: 7374 2c70 6f72 742c 7573 6572 6576 6572  st,port,userever
-00000510: 7365 7072 6f78 792c 6d69 6372 6f73 6572  seproxy,microser
-00000520: 7669 6365 6964 293a 0d0a 0d0a 2020 2020  viceid):....    
-00000530: 686f 7374 6172 723d 686f 7374 2e73 706c  hostarr=host.spl
-00000540: 6974 2822 3a22 290d 0a20 2020 2068 6275  it(":")..    hbu
-00000550: 663d 686f 7374 6172 725b 305d 0d0a 2020  f=hostarr[0]..  
-00000560: 2023 2070 7269 6e74 2868 6275 6629 0d0a   # print(hbuf)..
-00000570: 2020 2020 6862 7566 3d68 6275 662e 6c6f      hbuf=hbuf.lo
-00000580: 7765 7228 290d 0a20 2020 2064 6f6d 6169  wer()..    domai
-00000590: 6e3d 2727 0d0a 2020 2020 6966 2068 6275  n=''..    if hbu
-000005a0: 663d 3d27 6874 7470 7327 3a0d 0a20 2020  f=='https':..   
-000005b0: 2020 2020 646f 6d61 696e 3d68 6f73 745b      domain=host[
-000005c0: 383a 5d0d 0a20 2020 2065 6c73 653a 0d0a  8:]..    else:..
-000005d0: 2020 2020 2020 2064 6f6d 6169 6e3d 686f         domain=ho
-000005e0: 7374 5b37 3a5d 0d0a 2020 2020 686f 7374  st[7:]..    host
-000005f0: 3d64 6f6d 6169 6e20 200d 0a0d 0a20 2020  =domain  ....   
-00000600: 2069 6620 7573 6572 6576 6572 7365 7072   if usereversepr
-00000610: 6f78 793a 0d0a 2020 2020 2020 2020 6765  oxy:..        ge
-00000620: 7475 726c 3d66 6f72 6d61 7475 726c 286d  turl=formaturl(m
-00000630: 6573 7361 6765 2c68 6f73 742c 6d69 6372  essage,host,micr
-00000640: 6f73 6572 7669 6365 6964 2c68 6275 662c  oserviceid,hbuf,
-00000650: 706f 7274 2920 2368 6f73 7420 636f 6e74  port) #host cont
-00000660: 6169 6e73 2068 7474 703a 2f2f 206f 7220  ains http:// or 
-00000670: 6874 7470 733a 2f2f 0d0a 2020 2020 2020  https://..      
-00000680: 2020 6d65 7373 6167 653d 2247 4554 2025    message="GET %
-00000690: 735c 6e5c 6e22 2025 2067 6574 7572 6c20  s\n\n" % geturl 
-000006a0: 0d0a 0d0a 2020 2020 7265 6164 6572 2c20  ....    reader, 
-000006b0: 7772 6974 6572 203d 2061 7761 6974 2061  writer = await a
-000006c0: 7379 6e63 696f 2e6f 7065 6e5f 636f 6e6e  syncio.open_conn
-000006d0: 6563 7469 6f6e 2868 6f73 742c 2070 6f72  ection(host, por
-000006e0: 742c 206c 6f6f 703d 6c6f 6f70 290d 0a20  t, loop=loop).. 
-000006f0: 2020 2074 7279 3a0d 0a20 2020 2020 206d     try:..      m
-00000700: 7973 7472 3d73 7472 2e65 6e63 6f64 6528  ystr=str.encode(
-00000710: 6d65 7373 6167 6529 0d0a 2020 2020 2020  message)..      
-00000720: 7772 6974 6572 2e77 7269 7465 286d 7973  writer.write(mys
-00000730: 7472 290d 0a20 2020 2020 2064 6174 616d  tr)..      datam
-00000740: 3d27 270d 0a20 2020 2020 2077 6869 6c65  =''..      while
-00000750: 2054 7275 653a 0d0a 2020 2020 2020 2020   True:..        
-00000760: 6461 7461 203d 2061 7761 6974 2072 6561  data = await rea
-00000770: 6465 722e 7265 6164 2831 3032 3429 0d0a  der.read(1024)..
-00000780: 2020 2020 2020 2320 2070 7269 6e74 2864        #  print(d
-00000790: 6174 6129 0d0a 2020 2020 2020 2020 6461  ata)..        da
-000007a0: 7461 6d3d 6461 7461 6d2b 6461 7461 2e64  tam=datam+data.d
-000007b0: 6563 6f64 6528 2275 7466 2d38 2229 0d0a  ecode("utf-8")..
-000007c0: 2020 2020 2020 2023 2070 7269 6e74 2864         # print(d
-000007d0: 6174 616d 290d 0a20 2020 2020 2020 2069  atam)..        i
-000007e0: 6620 6e6f 7420 6461 7461 3a0d 0a20 2020  f not data:..   
-000007f0: 2020 2020 2020 2020 6272 6561 6b0d 0a20          break.. 
-00000800: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00000810: 2061 7761 6974 2077 7269 7465 722e 6472   await writer.dr
-00000820: 6169 6e28 290d 0a20 2020 2320 2020 7072  ain()..   #   pr
-00000830: 696e 7428 6461 7461 6d29 2020 0d0a 2020  int(datam)  ..  
-00000840: 2020 2020 7072 6564 6963 7469 6f6e 3d28      prediction=(
-00000850: 2225 7322 2025 2028 6461 7461 6d29 290d  "%s" % (datam)).
-00000860: 0a20 2020 2020 2077 7269 7465 722e 636c  .      writer.cl
-00000870: 6f73 6528 290d 0a20 2020 2065 7863 6570  ose()..    excep
-00000880: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-00000890: 3a0d 0a20 2020 2020 2070 7269 6e74 2865  :..      print(e
-000008a0: 290d 0a20 2020 2020 2072 6574 7572 6e20  )..      return 
-000008b0: 650d 0a20 2020 200d 0a20 2020 2072 6574  e..    ..    ret
-000008c0: 7572 6e20 7072 6564 6963 7469 6f6e 0d0a  urn prediction..
-000008d0: 0d0a 6465 6620 6879 7065 7270 7265 6469  ..def hyperpredi
-000008e0: 6374 696f 6e73 286d 6161 6473 746f 6b65  ctions(maadstoke
-000008f0: 6e2c 706b 6579 2c74 6865 696e 7075 7464  n,pkey,theinputd
-00000900: 6174 612c 686f 7374 2c70 6f72 742c 7573  ata,host,port,us
-00000910: 6572 6576 6572 7365 7072 6f78 793d 302c  ereverseproxy=0,
-00000920: 6d69 6372 6f73 6572 7669 6365 6964 3d27  microserviceid='
-00000930: 272c 7573 6572 6e61 6d65 3d27 272c 7061  ',username='',pa
-00000940: 7373 776f 7264 3d27 272c 636f 6d70 616e  ssword='',compan
-00000950: 793d 2727 2c65 6d61 696c 3d27 2729 3a0d  y='',email=''):.
-00000960: 0a20 2020 2069 6620 275f 6e6c 7063 6c61  .    if '_nlpcla
-00000970: 7373 6966 7927 206e 6f74 2069 6e20 706b  ssify' not in pk
-00000980: 6579 3a0d 0a20 2020 2020 2074 6865 696e  ey:..      thein
-00000990: 7075 7464 6174 613d 7468 6569 6e70 7574  putdata=theinput
-000009a0: 6461 7461 2e72 6570 6c61 6365 2822 2c22  data.replace(","
-000009b0: 2c22 3a22 290d 0a20 2020 2065 6c73 653a  ,":")..    else:
-000009c0: 2020 0d0a 2020 2020 2020 6275 6632 203d    ..      buf2 =
-000009d0: 2072 652e 7375 6228 275b 5e61 2d7a 412d   re.sub('[^a-zA-
-000009e0: 5a30 2d39 205c 6e5c 2e5d 272c 2027 272c  Z0-9 \n\.]', '',
-000009f0: 2074 6865 696e 7075 7464 6174 6129 0d0a   theinputdata)..
-00000a00: 2020 2020 2020 6275 6632 3d62 7566 322e        buf2=buf2.
-00000a10: 7265 706c 6163 6528 225c 6e22 2c20 2222  replace("\n", ""
-00000a20: 292e 7374 7269 7028 290d 0a20 2020 2020  ).strip()..     
-00000a30: 2062 7566 323d 6275 6632 2e72 6570 6c61   buf2=buf2.repla
-00000a40: 6365 2822 5c72 222c 2022 2229 2e73 7472  ce("\r", "").str
-00000a50: 6970 2829 0d0a 2020 2020 2020 7468 6569  ip()..      thei
-00000a60: 6e70 7574 6461 7461 3d62 7566 320d 0a0d  nputdata=buf2...
-00000a70: 0a20 2020 2069 6620 7573 6572 6576 6572  .    if userever
-00000a80: 7365 7072 6f78 793a 0d0a 2020 2020 2020  seproxy:..      
-00000a90: 2074 6865 696e 7075 7464 6174 613d 7572   theinputdata=ur
-00000aa0: 6c6c 6962 2e70 6172 7365 2e71 756f 7465  llib.parse.quote
-00000ab0: 2874 6865 696e 7075 7464 6174 6129 0d0a  (theinputdata)..
-00000ac0: 2020 0d0a 2020 2020 7661 6c75 653d 2225    ..    value="%
-00000ad0: 732c 5b25 735d 2c25 7322 2025 2028 706b  s,[%s],%s" % (pk
-00000ae0: 6579 2c74 6865 696e 7075 7464 6174 612c  ey,theinputdata,
-00000af0: 6d61 6164 7374 6f6b 656e 290d 0a20 2020  maadstoken)..   
-00000b00: 206c 6f6f 7020 3d20 6173 796e 6369 6f2e   loop = asyncio.
-00000b10: 6e65 775f 6576 656e 745f 6c6f 6f70 2829  new_event_loop()
-00000b20: 0d0a 2020 2020 7661 6c3d 6c6f 6f70 2e72  ..    val=loop.r
-00000b30: 756e 5f75 6e74 696c 5f63 6f6d 706c 6574  un_until_complet
-00000b40: 6528 7463 705f 6563 686f 5f63 6c69 656e  e(tcp_echo_clien
-00000b50: 7428 7661 6c75 652c 206c 6f6f 702c 686f  t(value, loop,ho
-00000b60: 7374 2c70 6f72 742c 7573 6572 6576 6572  st,port,userever
-00000b70: 7365 7072 6f78 792c 6d69 6372 6f73 6572  seproxy,microser
-00000b80: 7669 6365 6964 2929 0d0a 2020 2020 6c6f  viceid))..    lo
-00000b90: 6f70 2e63 6c6f 7365 2829 0d0a 0d0a 2020  op.close()....  
-00000ba0: 2020 7265 7475 726e 2076 616c 0d0a 2323    return val..##
+00000140: 0d0a 696d 706f 7274 206f 730d 0a23 696d  ..import os..#im
+00000150: 706f 7274 2069 6d70 0d0a 696d 706f 7274  port imp..import
+00000160: 2072 650d 0a69 6d70 6f72 7420 7572 6c6c   re..import urll
+00000170: 6962 2e72 6571 7565 7374 0d0a 696d 706f  ib.request..impo
+00000180: 7274 2061 7379 6e63 696f 0d0a 696d 706f  rt asyncio..impo
+00000190: 7274 2076 616c 6964 6174 6f72 730d 0a66  rt validators..f
+000001a0: 726f 6d20 7572 6c6c 6962 2e70 6172 7365  rom urllib.parse
+000001b0: 2069 6d70 6f72 7420 7572 6c6a 6f69 6e0d   import urljoin.
+000001c0: 0a66 726f 6d20 7572 6c6c 6962 2e70 6172  .from urllib.par
+000001d0: 7365 2069 6d70 6f72 7420 7572 6c73 706c  se import urlspl
+000001e0: 6974 0d0a 696d 706f 7274 2061 696f 6874  it..import aioht
+000001f0: 7470 0d0a 6672 6f6d 2061 696f 6874 7470  tp..from aiohttp
+00000200: 2069 6d70 6f72 7420 436c 6965 6e74 5365   import ClientSe
+00000210: 7373 696f 6e2c 436c 6965 6e74 5469 6d65  ssion,ClientTime
+00000220: 6f75 740d 0a69 6d70 6f72 7420 6173 796e  out..import asyn
+00000230: 635f 7469 6d65 6f75 740d 0a23 696d 706f  c_timeout..#impo
+00000240: 7274 2072 6561 6470 6466 0d0a 6672 6f6d  rt readpdf..from
+00000250: 2073 656c 656e 6975 6d2e 7765 6264 7269   selenium.webdri
+00000260: 7665 722e 6669 7265 666f 782e 6f70 7469  ver.firefox.opti
+00000270: 6f6e 7320 696d 706f 7274 204f 7074 696f  ons import Optio
+00000280: 6e73 0d0a 6672 6f6d 2073 656c 656e 6975  ns..from seleniu
+00000290: 6d20 696d 706f 7274 2077 6562 6472 6976  m import webdriv
+000002a0: 6572 0d0a 0d0a 636f 6e6e 6563 7469 6f6e  er....connection
+000002b0: 6572 726f 723d 2222 0d0a 0d0a 6c6f 6f70  error=""....loop
+000002c0: 203d 2061 7379 6e63 696f 2e67 6574 5f65   = asyncio.get_e
+000002d0: 7665 6e74 5f6c 6f6f 7028 290d 0a0d 0a64  vent_loop()....d
+000002e0: 6566 2063 616e 6365 6c61 6c6c 7461 736b  ef cancelalltask
+000002f0: 7328 293a 0d0a 2020 2020 7472 793a 0d0a  s():..    try:..
+00000300: 2020 2020 2020 7065 6e64 696e 6720 3d20        pending = 
+00000310: 6173 796e 6369 6f2e 616c 6c5f 7461 736b  asyncio.all_task
+00000320: 7328 290d 0a20 2020 2020 2066 6f72 2074  s()..      for t
+00000330: 6173 6b20 696e 2070 656e 6469 6e67 3a0d  ask in pending:.
+00000340: 0a20 2020 2020 2020 2074 6173 6b2e 6361  .        task.ca
+00000350: 6e63 656c 2829 0d0a 2020 2020 6578 6365  ncel()..    exce
+00000360: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
+00000370: 653a 0d0a 2020 2020 2020 7061 7373 2020  e:..      pass  
+00000380: 0d0a 0d0a 6465 6620 666f 726d 6174 7572  ....def formatur
+00000390: 6c28 6d61 696e 6461 7461 2c68 6f73 742c  l(maindata,host,
+000003a0: 6d69 6372 6f73 6572 7669 6365 6964 2c70  microserviceid,p
+000003b0: 7265 686f 7374 2c70 6f72 7429 3a0d 0a0d  rehost,port):...
+000003c0: 0a20 2020 2069 6620 6c65 6e28 6d69 6372  .    if len(micr
+000003d0: 6f73 6572 7669 6365 6964 293e 303a 2020  oserviceid)>0:  
+000003e0: 2020 0d0a 2020 2020 2020 6d61 696e 7572    ..      mainur
+000003f0: 6c3d 7072 6568 6f73 7420 2b20 223a 2f2f  l=prehost + "://
+00000400: 2220 2b20 686f 7374 202b 2020 223a 2220  " + host +  ":" 
+00000410: 2b20 7374 7228 706f 7274 2920 2b22 2f22  + str(port) +"/"
+00000420: 202b 206d 6963 726f 7365 7276 6963 6569   + microservicei
+00000430: 6420 2b20 222f 3f68 7970 6572 7072 6564  d + "/?hyperpred
+00000440: 6963 743d 2220 2b20 6d61 696e 6461 7461  ict=" + maindata
+00000450: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+00000460: 2020 206d 6169 6e75 726c 3d70 7265 686f     mainurl=preho
+00000470: 7374 202b 2022 3a2f 2f22 202b 2068 6f73  st + "://" + hos
+00000480: 7420 2b20 223a 2220 2b20 7374 7228 706f  t + ":" + str(po
+00000490: 7274 2920 2b22 2f3f 6879 7065 7270 7265  rt) +"/?hyperpre
+000004a0: 6469 6374 3d22 202b 206d 6169 6e64 6174  dict=" + maindat
+000004b0: 610d 0a20 2020 2020 2020 200d 0a20 2020  a..        ..   
+000004c0: 2072 6574 7572 6e20 6d61 696e 7572 6c0d   return mainurl.
+000004d0: 0a20 2020 200d 0a61 7379 6e63 2064 6566  .    ..async def
+000004e0: 2074 6370 5f65 6368 6f5f 636c 6965 6e74   tcp_echo_client
+000004f0: 286d 6573 7361 6765 2c20 6c6f 6f70 2c68  (message, loop,h
+00000500: 6f73 742c 706f 7274 2c75 7365 7265 7665  ost,port,usereve
+00000510: 7273 6570 726f 7879 2c6d 6963 726f 7365  rseproxy,microse
+00000520: 7276 6963 6569 6429 3a0d 0a0d 0a20 2020  rviceid):....   
+00000530: 2068 6f73 7461 7272 3d68 6f73 742e 7370   hostarr=host.sp
+00000540: 6c69 7428 223a 2229 0d0a 2020 2020 6862  lit(":")..    hb
+00000550: 7566 3d68 6f73 7461 7272 5b30 5d0d 0a20  uf=hostarr[0].. 
+00000560: 2020 2320 7072 696e 7428 6862 7566 290d    # print(hbuf).
+00000570: 0a20 2020 2068 6275 663d 6862 7566 2e6c  .    hbuf=hbuf.l
+00000580: 6f77 6572 2829 0d0a 2020 2020 646f 6d61  ower()..    doma
+00000590: 696e 3d27 270d 0a20 2020 2069 6620 6862  in=''..    if hb
+000005a0: 7566 3d3d 2768 7474 7073 273a 0d0a 2020  uf=='https':..  
+000005b0: 2020 2020 2064 6f6d 6169 6e3d 686f 7374       domain=host
+000005c0: 5b38 3a5d 0d0a 2020 2020 656c 7365 3a0d  [8:]..    else:.
+000005d0: 0a20 2020 2020 2020 646f 6d61 696e 3d68  .       domain=h
+000005e0: 6f73 745b 373a 5d0d 0a20 2020 2068 6f73  ost[7:]..    hos
+000005f0: 743d 646f 6d61 696e 2020 0d0a 0d0a 2020  t=domain  ....  
+00000600: 2020 6966 2075 7365 7265 7665 7273 6570    if usereversep
+00000610: 726f 7879 3a0d 0a20 2020 2020 2020 2067  roxy:..        g
+00000620: 6574 7572 6c3d 666f 726d 6174 7572 6c28  eturl=formaturl(
+00000630: 6d65 7373 6167 652c 686f 7374 2c6d 6963  message,host,mic
+00000640: 726f 7365 7276 6963 6569 642c 6862 7566  roserviceid,hbuf
+00000650: 2c70 6f72 7429 2023 686f 7374 2063 6f6e  ,port) #host con
+00000660: 7461 696e 7320 6874 7470 3a2f 2f20 6f72  tains http:// or
+00000670: 2068 7474 7073 3a2f 2f0d 0a20 2020 2020   https://..     
+00000680: 2020 206d 6573 7361 6765 3d22 4745 5420     message="GET 
+00000690: 2573 5c6e 5c6e 2220 2520 6765 7475 726c  %s\n\n" % geturl
+000006a0: 200d 0a0d 0a20 2020 2072 6561 6465 722c   ....    reader,
+000006b0: 2077 7269 7465 7220 3d20 6177 6169 7420   writer = await 
+000006c0: 6173 796e 6369 6f2e 6f70 656e 5f63 6f6e  asyncio.open_con
+000006d0: 6e65 6374 696f 6e28 686f 7374 2c20 706f  nection(host, po
+000006e0: 7274 290d 0a20 2020 2074 7279 3a0d 0a20  rt)..    try:.. 
+000006f0: 2020 2020 206d 7973 7472 3d73 7472 2e65       mystr=str.e
+00000700: 6e63 6f64 6528 6d65 7373 6167 6529 0d0a  ncode(message)..
+00000710: 2020 2020 2020 7772 6974 6572 2e77 7269        writer.wri
+00000720: 7465 286d 7973 7472 290d 0a20 2020 2020  te(mystr)..     
+00000730: 2064 6174 616d 3d27 270d 0a20 2020 2020   datam=''..     
+00000740: 2077 6869 6c65 2054 7275 653a 0d0a 2020   while True:..  
+00000750: 2020 2020 2020 6461 7461 203d 2061 7761        data = awa
+00000760: 6974 2072 6561 6465 722e 7265 6164 2831  it reader.read(1
+00000770: 3032 3429 0d0a 2020 2020 2020 2320 2070  024)..      #  p
+00000780: 7269 6e74 2864 6174 6129 0d0a 2020 2020  rint(data)..    
+00000790: 2020 2020 6461 7461 6d3d 6461 7461 6d2b      datam=datam+
+000007a0: 6461 7461 2e64 6563 6f64 6528 2275 7466  data.decode("utf
+000007b0: 2d38 2229 0d0a 2020 2020 2020 2023 2070  -8")..       # p
+000007c0: 7269 6e74 2864 6174 616d 290d 0a20 2020  rint(datam)..   
+000007d0: 2020 2020 2069 6620 6e6f 7420 6461 7461       if not data
+000007e0: 3a0d 0a20 2020 2020 2020 2020 2020 6272  :..           br
+000007f0: 6561 6b0d 0a20 2020 2020 2020 200d 0a20  eak..        .. 
+00000800: 2020 2020 2020 2061 7761 6974 2077 7269         await wri
+00000810: 7465 722e 6472 6169 6e28 290d 0a20 2020  ter.drain()..   
+00000820: 2320 2020 7072 696e 7428 6461 7461 6d29  #   print(datam)
+00000830: 2020 0d0a 2020 2020 2020 7072 6564 6963    ..      predic
+00000840: 7469 6f6e 3d28 2225 7322 2025 2028 6461  tion=("%s" % (da
+00000850: 7461 6d29 290d 0a20 2020 2020 2077 7269  tam))..      wri
+00000860: 7465 722e 636c 6f73 6528 290d 0a20 2020  ter.close()..   
+00000870: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+00000880: 6e20 6173 2065 3a0d 0a20 2020 2020 2070  n as e:..      p
+00000890: 7269 6e74 2865 290d 0a20 2020 2020 2072  rint(e)..      r
+000008a0: 6574 7572 6e20 650d 0a20 2020 200d 0a20  eturn e..    .. 
+000008b0: 2020 2072 6574 7572 6e20 7072 6564 6963     return predic
+000008c0: 7469 6f6e 0d0a 0d0a 6465 6620 6879 7065  tion....def hype
+000008d0: 7270 7265 6469 6374 696f 6e73 286d 6161  rpredictions(maa
+000008e0: 6473 746f 6b65 6e2c 706b 6579 2c74 6865  dstoken,pkey,the
+000008f0: 696e 7075 7464 6174 612c 686f 7374 2c70  inputdata,host,p
+00000900: 6f72 742c 7573 6572 6576 6572 7365 7072  ort,usereversepr
+00000910: 6f78 793d 302c 6d69 6372 6f73 6572 7669  oxy=0,microservi
+00000920: 6365 6964 3d27 272c 7573 6572 6e61 6d65  ceid='',username
+00000930: 3d27 272c 7061 7373 776f 7264 3d27 272c  ='',password='',
+00000940: 636f 6d70 616e 793d 2727 2c65 6d61 696c  company='',email
+00000950: 3d27 2729 3a0d 0a20 2020 2069 6620 275f  =''):..    if '_
+00000960: 6e6c 7063 6c61 7373 6966 7927 206e 6f74  nlpclassify' not
+00000970: 2069 6e20 706b 6579 3a0d 0a20 2020 2020   in pkey:..     
+00000980: 2074 6865 696e 7075 7464 6174 613d 7468   theinputdata=th
+00000990: 6569 6e70 7574 6461 7461 2e72 6570 6c61  einputdata.repla
+000009a0: 6365 2822 2c22 2c22 3a22 290d 0a20 2020  ce(",",":")..   
+000009b0: 2065 6c73 653a 2020 0d0a 2020 2020 2020   else:  ..      
+000009c0: 6275 6632 203d 2072 652e 7375 6228 275b  buf2 = re.sub('[
+000009d0: 5e61 2d7a 412d 5a30 2d39 205c 6e5c 2e5d  ^a-zA-Z0-9 \n\.]
+000009e0: 272c 2027 272c 2074 6865 696e 7075 7464  ', '', theinputd
+000009f0: 6174 6129 0d0a 2020 2020 2020 6275 6632  ata)..      buf2
+00000a00: 3d62 7566 322e 7265 706c 6163 6528 225c  =buf2.replace("\
+00000a10: 6e22 2c20 2222 292e 7374 7269 7028 290d  n", "").strip().
+00000a20: 0a20 2020 2020 2062 7566 323d 6275 6632  .      buf2=buf2
+00000a30: 2e72 6570 6c61 6365 2822 5c72 222c 2022  .replace("\r", "
+00000a40: 2229 2e73 7472 6970 2829 0d0a 2020 2020  ").strip()..    
+00000a50: 2020 7468 6569 6e70 7574 6461 7461 3d62    theinputdata=b
+00000a60: 7566 320d 0a0d 0a20 2020 2069 6620 7573  uf2....    if us
+00000a70: 6572 6576 6572 7365 7072 6f78 793a 0d0a  ereverseproxy:..
+00000a80: 2020 2020 2020 2074 6865 696e 7075 7464         theinputd
+00000a90: 6174 613d 7572 6c6c 6962 2e70 6172 7365  ata=urllib.parse
+00000aa0: 2e71 756f 7465 2874 6865 696e 7075 7464  .quote(theinputd
+00000ab0: 6174 6129 0d0a 2020 0d0a 2020 2020 7661  ata)..  ..    va
+00000ac0: 6c75 653d 2225 732c 5b25 735d 2c25 7322  lue="%s,[%s],%s"
+00000ad0: 2025 2028 706b 6579 2c74 6865 696e 7075   % (pkey,theinpu
+00000ae0: 7464 6174 612c 6d61 6164 7374 6f6b 656e  tdata,maadstoken
+00000af0: 290d 0a20 2020 206c 6f6f 7020 3d20 6173  )..    loop = as
+00000b00: 796e 6369 6f2e 6e65 775f 6576 656e 745f  yncio.new_event_
+00000b10: 6c6f 6f70 2829 0d0a 2020 2020 7661 6c3d  loop()..    val=
+00000b20: 6c6f 6f70 2e72 756e 5f75 6e74 696c 5f63  loop.run_until_c
+00000b30: 6f6d 706c 6574 6528 7463 705f 6563 686f  omplete(tcp_echo
+00000b40: 5f63 6c69 656e 7428 7661 6c75 652c 206c  _client(value, l
+00000b50: 6f6f 702c 686f 7374 2c70 6f72 742c 7573  oop,host,port,us
+00000b60: 6572 6576 6572 7365 7072 6f78 792c 6d69  ereverseproxy,mi
+00000b70: 6372 6f73 6572 7669 6365 6964 2929 0d0a  croserviceid))..
+00000b80: 2020 2020 6c6f 6f70 2e63 6c6f 7365 2829      loop.close()
+00000b90: 0d0a 0d0a 2020 2020 7265 7475 726e 2076  ....    return v
+00000ba0: 616c 0d0a 2323 2323 2323 2323 2323 2323  al..############
 00000bb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000bc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00000bd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00000be0: 2323 2323 2323 230d 0a23 2323 2323 2323  #######..#######
-00000bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00000c00: 5649 5045 5220 4675 6e63 7469 6f6e 730d  VIPER Functions.
-00000c10: 0a0d 0a64 6566 2066 6f72 6d61 7475 726c  ...def formaturl
-00000c20: 7669 7065 7228 6d61 696e 6461 7461 2c68  viper(maindata,h
-00000c30: 6f73 742c 6d69 6372 6f73 6572 7669 6365  ost,microservice
-00000c40: 6964 2c70 7265 686f 7374 2c70 6f72 7429  id,prehost,port)
-00000c50: 3a0d 0a0d 0a20 2020 2069 6620 6c65 6e28  :....    if len(
-00000c60: 6d69 6372 6f73 6572 7669 6365 6964 293e  microserviceid)>
-00000c70: 303a 2020 2020 0d0a 2020 2020 2020 6d61  0:    ..      ma
-00000c80: 696e 7572 6c3d 7072 6568 6f73 7420 2b20  inurl=prehost + 
-00000c90: 223a 2f2f 2220 2b20 686f 7374 202b 2020  "://" + host +  
-00000ca0: 223a 2220 2b20 7374 7228 706f 7274 2920  ":" + str(port) 
-00000cb0: 2b22 2f22 202b 206d 6963 726f 7365 7276  +"/" + microserv
-00000cc0: 6963 6569 6420 2b20 222f 2220 2b20 6d61  iceid + "/" + ma
-00000cd0: 696e 6461 7461 0d0a 2020 2020 656c 7365  indata..    else
-00000ce0: 3a0d 0a20 2020 2020 206d 6169 6e75 726c  :..      mainurl
-00000cf0: 3d70 7265 686f 7374 202b 2022 3a2f 2f22  =prehost + "://"
-00000d00: 202b 2068 6f73 7420 2b20 223a 2220 2b20   + host + ":" + 
-00000d10: 7374 7228 706f 7274 2920 2b22 2f22 202b  str(port) +"/" +
-00000d20: 206d 6169 6e64 6174 610d 0a20 2020 2020   maindata..     
-00000d30: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
-00000d40: 6d61 696e 7572 6c0d 0a0d 0a0d 0a61 7379  mainurl......asy
-00000d50: 6e63 2064 6566 2066 6574 6368 2863 6c69  nc def fetch(cli
-00000d60: 656e 742c 7572 6c29 3a0d 0a20 2020 2061  ent,url):..    a
-00000d70: 7379 6e63 2077 6974 6820 636c 6965 6e74  sync with client
-00000d80: 2e67 6574 2875 726c 2920 6173 2072 6573  .get(url) as res
-00000d90: 703a 0d0a 2020 2020 2020 2020 2361 7379  p:..        #asy
-00000da0: 6369 6f2e 656e 7375 7265 5f66 7574 7572  cio.ensure_futur
-00000db0: 6528 290d 0a20 2020 2020 2020 2072 6574  e()..        ret
-00000dc0: 7572 6e20 6177 6169 7420 7265 7370 2e74  urn await resp.t
-00000dd0: 6578 7428 290d 0a0d 0a61 7379 6e63 2064  ext()....async d
-00000de0: 6566 2066 6574 6368 3228 636c 6965 6e74  ef fetch2(client
-00000df0: 2c75 726c 293a 0d0a 2020 2020 7461 736b  ,url):..    task
-00000e00: 7320 3d20 5b5d 0d0a 2020 2020 7461 736b  s = []..    task
-00000e10: 732e 6170 7065 6e64 2861 7379 6e63 696f  s.append(asyncio
-00000e20: 2e65 6e73 7572 655f 6675 7475 7265 2866  .ensure_future(f
-00000e30: 6574 6368 2863 6c69 656e 742c 2075 726c  etch(client, url
-00000e40: 2929 290d 0a20 2020 206f 7269 6769 6e61  )))..    origina
-00000e50: 6c20 3d20 6177 6169 7420 6173 796e 6369  l = await asynci
-00000e60: 6f2e 6761 7468 6572 282a 7461 736b 7329  o.gather(*tasks)
-00000e70: 0d0a 2020 2020 666f 7220 696e 666f 2069  ..    for info i
-00000e80: 6e20 6f72 6967 696e 616c 3a0d 0a20 2020  n original:..   
-00000e90: 2020 2020 2072 6574 7572 6e20 696e 666f       return info
-00000ea0: 0d0a 2020 2020 0d0a 2323 2323 2323 2323  ..    ..########
-00000eb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00000ec0: 2323 2323 2356 4950 4552 2041 5049 2043  #####VIPER API C
-00000ed0: 414c 4c53 2023 2323 2323 2323 2323 2323  ALLS ###########
-00000ee0: 2323 2323 2320 2020 200d 0a61 7379 6e63  #####    ..async
-00000ef0: 2064 6566 2074 6370 5f65 6368 6f5f 636c   def tcp_echo_cl
-00000f00: 6965 6e74 7669 7065 7228 6d65 7373 6167  ientviper(messag
-00000f10: 652c 206c 6f6f 702c 686f 7374 2c70 6f72  e, loop,host,por
-00000f20: 742c 6d69 6372 6f73 6572 7669 6365 6964  t,microserviceid
-00000f30: 2c74 696d 656f 7574 3d36 3030 293a 0d0a  ,timeout=600):..
-00000f40: 2020 2020 676c 6f62 616c 2063 6f6e 6e65      global conne
-00000f50: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
-00000f60: 2020 636f 6e6e 6563 7469 6f6e 6572 726f    connectionerro
-00000f70: 723d 2222 0d0a 2020 2020 686f 7374 6172  r=""..    hostar
-00000f80: 723d 686f 7374 2e73 706c 6974 2822 3a22  r=host.split(":"
-00000f90: 290d 0a20 2020 2068 6275 663d 686f 7374  )..    hbuf=host
-00000fa0: 6172 725b 305d 0d0a 2020 2020 6862 7566  arr[0]..    hbuf
-00000fb0: 3d68 6275 662e 6c6f 7765 7228 290d 0a20  =hbuf.lower().. 
-00000fc0: 2020 2064 6f6d 6169 6e3d 2727 0d0a 2020     domain=''..  
-00000fd0: 2020 6966 2068 6275 663d 3d27 6874 7470    if hbuf=='http
-00000fe0: 7327 3a0d 0a20 2020 2020 2020 646f 6d61  s':..       doma
-00000ff0: 696e 3d68 6f73 745b 383a 5d0d 0a20 2020  in=host[8:]..   
-00001000: 2065 6c73 653a 0d0a 2020 2020 2020 2064   else:..       d
-00001010: 6f6d 6169 6e3d 686f 7374 5b37 3a5d 0d0a  omain=host[7:]..
-00001020: 2020 2020 686f 7374 3d64 6f6d 6169 6e20      host=domain 
-00001030: 200d 0a0d 0a20 2020 2067 6574 7572 6c3d   ....    geturl=
-00001040: 666f 726d 6174 7572 6c76 6970 6572 286d  formaturlviper(m
-00001050: 6573 7361 6765 2c68 6f73 742c 6d69 6372  essage,host,micr
-00001060: 6f73 6572 7669 6365 6964 2c68 6275 662c  oserviceid,hbuf,
-00001070: 706f 7274 2920 2368 6f73 7420 636f 6e74  port) #host cont
-00001080: 6169 6e73 2068 7474 703a 2f2f 206f 7220  ains http:// or 
-00001090: 6874 7470 733a 2f2f 0d0a 2020 2020 6d65  https://..    me
-000010a0: 7373 6167 653d 2225 7322 2025 2067 6574  ssage="%s" % get
-000010b0: 7572 6c0d 0a20 2020 2073 7469 6d65 6f75  url..    stimeou
-000010c0: 7420 3d20 436c 6965 6e74 5469 6d65 6f75  t = ClientTimeou
-000010d0: 7428 746f 7461 6c3d 7469 6d65 6f75 7429  t(total=timeout)
-000010e0: 0d0a 2020 2020 200d 0a20 2020 2074 7279  ..     ..    try
-000010f0: 3a0d 0a20 2020 2020 7769 7468 2061 7379  :..     with asy
-00001100: 6e63 5f74 696d 656f 7574 2e74 696d 656f  nc_timeout.timeo
-00001110: 7574 2874 696d 656f 7574 293a 0d0a 2020  ut(timeout):..  
-00001120: 2020 2020 6173 796e 6320 7769 7468 2043      async with C
-00001130: 6c69 656e 7453 6573 7369 6f6e 2863 6f6e  lientSession(con
-00001140: 6e65 6374 6f72 203d 2061 696f 6874 7470  nector = aiohttp
-00001150: 2e54 4350 436f 6e6e 6563 746f 7228 7373  .TCPConnector(ss
-00001160: 6c3d 4661 6c73 6529 2c74 696d 656f 7574  l=False),timeout
-00001170: 3d73 7469 6d65 6f75 7429 2061 7320 7365  =stimeout) as se
-00001180: 7373 696f 6e3a 0d0a 2020 2020 2020 2020  ssion:..        
-00001190: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-000011a0: 6874 6d6c 203d 2061 7761 6974 2066 6574  html = await fet
-000011b0: 6368 3228 7365 7373 696f 6e2c 6d65 7373  ch2(session,mess
-000011c0: 6167 6529 0d0a 2020 2020 2020 2020 2020  age)..          
-000011d0: 6177 6169 7420 7365 7373 696f 6e2e 636c  await session.cl
-000011e0: 6f73 6528 290d 0a20 2020 2020 2020 2020  ose()..         
-000011f0: 2072 6574 7572 6e20 6874 6d6c 0d0a 2020   return html..  
-00001200: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-00001210: 6570 7469 6f6e 2061 7320 653a 0d0a 2020  eption as e:..  
-00001220: 2020 2020 2020 2020 7072 696e 7428 6529          print(e)
-00001230: 0d0a 2020 2020 2020 2020 2020 7061 7373  ..          pass
-00001240: 0d0a 2020 2020 6578 6365 7074 2028 6169  ..    except (ai
-00001250: 6f68 7474 702e 5365 7276 6572 4469 7363  ohttp.ServerDisc
-00001260: 6f6e 6e65 6374 6564 4572 726f 722c 2061  onnectedError, a
-00001270: 696f 6874 7470 2e43 6c69 656e 7452 6573  iohttp.ClientRes
-00001280: 706f 6e73 6545 7272 6f72 2c61 696f 6874  ponseError,aioht
-00001290: 7470 2e43 6c69 656e 7443 6f6e 6e65 6374  tp.ClientConnect
-000012a0: 6f72 4572 726f 7229 2061 7320 653a 2020  orError) as e:  
-000012b0: 2020 2020 200d 0a20 2020 2020 636f 6e6e       ..     conn
-000012c0: 6563 7469 6f6e 6572 726f 723d 7374 7228  ectionerror=str(
-000012d0: 6529 2020 200d 0a20 2020 2020 7072 696e  e)   ..     prin
-000012e0: 7428 2254 4350 436f 6e6e 6563 7469 6f6e  t("TCPConnection
-000012f0: 4572 726f 723d 222c 6529 2020 200d 0a20  Error=",e)   .. 
-00001300: 2020 2020 7061 7373 2020 200d 0a0d 0a0d      pass   .....
-00001310: 0a64 6566 2076 6970 6572 7374 6174 7328  .def viperstats(
-00001320: 7669 7065 7274 6f6b 656e 2c68 6f73 742c  vipertoken,host,
-00001330: 706f 7274 3d2d 3939 392c 6272 6f6b 6572  port=-999,broker
-00001340: 686f 7374 3d27 272c 6272 6f6b 6572 706f  host='',brokerpo
-00001350: 7274 3d2d 3939 392c 6d69 6372 6f73 6572  rt=-999,microser
-00001360: 7669 6365 6964 3d27 2729 3a0d 0a20 2020  viceid=''):..   
-00001370: 2067 6c6f 6261 6c20 636f 6e6e 6563 7469   global connecti
-00001380: 6f6e 6572 726f 720d 0a0d 0a20 2020 2069  onerror....    i
-00001390: 6620 6c65 6e28 7669 7065 7274 6f6b 656e  f len(vipertoken
-000013a0: 293d 3d30 206f 7220 6c65 6e28 686f 7374  )==0 or len(host
-000013b0: 293d 3d30 206f 7220 706f 7274 3d3d 2d39  )==0 or port==-9
-000013c0: 3939 3a0d 0a20 2020 2020 2020 7265 7475  99:..       retu
-000013d0: 726e 2022 506c 6561 7365 2065 6e74 6572  rn "Please enter
-000013e0: 2076 6970 6572 746f 6b65 6e2c 686f 7374   vipertoken,host
-000013f0: 2061 6e64 2070 6f72 7422 0d0a 0d0a 2020   and port"....  
-00001400: 2020 7661 6c75 653d 2276 6970 6572 7374    value="viperst
-00001410: 6174 733f 7669 7065 7274 6f6b 656e 3d22  ats?vipertoken="
-00001420: 2b76 6970 6572 746f 6b65 6e20 2b20 2226  +vipertoken + "&
-00001430: 6272 6f6b 6572 686f 7374 3d22 2b62 726f  brokerhost="+bro
-00001440: 6b65 7268 6f73 742b 2226 6272 6f6b 6572  kerhost+"&broker
-00001450: 706f 7274 3d22 2b73 7472 2862 726f 6b65  port="+str(broke
-00001460: 7270 6f72 7429 0d0a 2020 2020 6c6f 6f70  rport)..    loop
-00001470: 203d 2061 7379 6e63 696f 2e6e 6577 5f65   = asyncio.new_e
-00001480: 7665 6e74 5f6c 6f6f 7028 290d 0a20 2020  vent_loop()..   
-00001490: 2076 616c 3d6c 6f6f 702e 7275 6e5f 756e   val=loop.run_un
-000014a0: 7469 6c5f 636f 6d70 6c65 7465 2874 6370  til_complete(tcp
-000014b0: 5f65 6368 6f5f 636c 6965 6e74 7669 7065  _echo_clientvipe
-000014c0: 7228 7661 6c75 652c 206c 6f6f 702c 686f  r(value, loop,ho
-000014d0: 7374 2c70 6f72 742c 6d69 6372 6f73 6572  st,port,microser
-000014e0: 7669 6365 6964 2929 0d0a 2020 2020 6c6f  viceid))..    lo
-000014f0: 6f70 2e63 6c6f 7365 2829 0d0a 2020 2020  op.close()..    
-00001500: 6966 2063 6f6e 6e65 6374 696f 6e65 7272  if connectionerr
-00001510: 6f72 3a0d 0a20 2020 2020 2020 2020 7265  or:..         re
-00001520: 7475 726e 2063 6f6e 6e65 6374 696f 6e65  turn connectione
-00001530: 7272 6f72 0d0a 0d0a 2020 2020 7265 7475  rror....    retu
-00001540: 726e 2076 616c 0d0a 0d0a 0d0a 6465 6620  rn val......def 
-00001550: 7669 7065 726c 6973 7474 6f70 6963 7328  viperlisttopics(
-00001560: 7669 7065 7274 6f6b 656e 2c68 6f73 742c  vipertoken,host,
-00001570: 706f 7274 3d2d 3939 392c 6272 6f6b 6572  port=-999,broker
-00001580: 686f 7374 3d27 272c 6272 6f6b 6572 706f  host='',brokerpo
-00001590: 7274 3d2d 3939 392c 6d69 6372 6f73 6572  rt=-999,microser
-000015a0: 7669 6365 6964 3d27 2729 3a0d 0a20 2020  viceid=''):..   
-000015b0: 2067 6c6f 6261 6c20 636f 6e6e 6563 7469   global connecti
-000015c0: 6f6e 6572 726f 720d 0a0d 0a20 2020 2069  onerror....    i
-000015d0: 6620 6c65 6e28 7669 7065 7274 6f6b 656e  f len(vipertoken
-000015e0: 293d 3d30 206f 7220 6c65 6e28 686f 7374  )==0 or len(host
-000015f0: 293d 3d30 206f 7220 706f 7274 3d3d 2d39  )==0 or port==-9
-00001600: 3939 3a0d 0a20 2020 2020 2020 7265 7475  99:..       retu
-00001610: 726e 2022 506c 6561 7365 2065 6e74 6572  rn "Please enter
-00001620: 2076 6970 6572 746f 6b65 6e2c 686f 7374   vipertoken,host
-00001630: 2061 6e64 2070 6f72 7422 0d0a 2020 2020   and port"..    
-00001640: 0d0a 2020 2020 7661 6c75 653d 226c 6973  ..    value="lis
-00001650: 7474 6f70 6963 733f 7669 7065 7274 6f6b  ttopics?vipertok
-00001660: 656e 3d22 2b76 6970 6572 746f 6b65 6e20  en="+vipertoken 
-00001670: 2b20 2226 6272 6f6b 6572 686f 7374 3d22  + "&brokerhost="
-00001680: 2b62 726f 6b65 7268 6f73 742b 2226 6272  +brokerhost+"&br
-00001690: 6f6b 6572 706f 7274 3d22 2b73 7472 2862  okerport="+str(b
-000016a0: 726f 6b65 7270 6f72 7429 0d0a 0d0a 2020  rokerport)....  
-000016b0: 2020 7661 6c3d 6c6f 6f70 2e72 756e 5f75    val=loop.run_u
-000016c0: 6e74 696c 5f63 6f6d 706c 6574 6528 7463  ntil_complete(tc
-000016d0: 705f 6563 686f 5f63 6c69 656e 7476 6970  p_echo_clientvip
-000016e0: 6572 2876 616c 7565 2c20 6c6f 6f70 2c68  er(value, loop,h
-000016f0: 6f73 742c 706f 7274 2c6d 6963 726f 7365  ost,port,microse
-00001700: 7276 6963 6569 6429 290d 0a20 2020 2069  rviceid))..    i
-00001710: 6620 636f 6e6e 6563 7469 6f6e 6572 726f  f connectionerro
-00001720: 723a 0d0a 2020 2020 2020 2020 2072 6574  r:..         ret
-00001730: 7572 6e20 636f 6e6e 6563 7469 6f6e 6572  urn connectioner
-00001740: 726f 720d 0a0d 0a20 2020 2072 6574 7572  ror....    retur
-00001750: 6e20 7661 6c0d 0a0d 0a64 6566 2076 6970  n val....def vip
-00001760: 6572 7375 6273 6372 6962 6563 6f6e 7375  ersubscribeconsu
-00001770: 6d65 7228 7669 7065 7274 6f6b 656e 2c68  mer(vipertoken,h
-00001780: 6f73 742c 706f 7274 2c74 6f70 6963 2c63  ost,port,topic,c
-00001790: 6f6d 7061 6e79 6e61 6d65 2c63 6f6e 7461  ompanyname,conta
-000017a0: 6374 6e61 6d65 2c63 6f6e 7461 6374 656d  ctname,contactem
-000017b0: 6169 6c2c 6c6f 6361 7469 6f6e 2c64 6573  ail,location,des
-000017c0: 6372 6970 7469 6f6e 2c62 726f 6b65 7268  cription,brokerh
-000017d0: 6f73 743d 2727 2c62 726f 6b65 7270 6f72  ost='',brokerpor
-000017e0: 743d 2d39 3939 2c67 726f 7570 6964 3d27  t=-999,groupid='
-000017f0: 272c 6d69 6372 6f73 6572 7669 6365 6964  ',microserviceid
-00001800: 3d27 2729 3a0d 0a20 2020 2067 6c6f 6261  =''):..    globa
-00001810: 6c20 636f 6e6e 6563 7469 6f6e 6572 726f  l connectionerro
-00001820: 720d 0a0d 0a20 2020 2069 6620 6c65 6e28  r....    if len(
-00001830: 686f 7374 293d 3d30 206f 7220 6c65 6e28  host)==0 or len(
-00001840: 7669 7065 7274 6f6b 656e 293d 3d30 206f  vipertoken)==0 o
-00001850: 7220 706f 7274 3d3d 2d39 3939 206f 7220  r port==-999 or 
-00001860: 6c65 6e28 746f 7069 6329 3d3d 3020 6f72  len(topic)==0 or
-00001870: 206c 656e 2863 6f6d 7061 6e79 6e61 6d65   len(companyname
-00001880: 293d 3d30 206f 7220 6c65 6e28 636f 6e74  )==0 or len(cont
-00001890: 6163 746e 616d 6529 3d3d 3020 6f72 206c  actname)==0 or l
-000018a0: 656e 2863 6f6e 7461 6374 656d 6169 6c29  en(contactemail)
-000018b0: 3d3d 3020 6f72 206c 656e 286c 6f63 6174  ==0 or len(locat
-000018c0: 696f 6e29 3d3d 3020 6f72 206c 656e 2864  ion)==0 or len(d
-000018d0: 6573 6372 6970 7469 6f6e 293d 3d30 3a0d  escription)==0:.
-000018e0: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
-000018f0: 2022 506c 6561 7365 2065 6e74 6572 2068   "Please enter h
-00001900: 6f73 742c 706f 7274 2c76 6970 6572 746f  ost,port,viperto
-00001910: 6b65 6e2c 746f 7069 632c 2063 6f6d 7061  ken,topic, compa
-00001920: 6e79 6e61 6d65 2c63 6f6e 7461 6374 6e61  nyname,contactna
-00001930: 6d65 2c63 6f6e 7461 6374 656d 6169 6c2c  me,contactemail,
-00001940: 6c6f 6361 7469 6f6e 2061 6e64 2064 6573  location and des
-00001950: 6372 6970 7469 6f6e 220d 0a20 2020 2020  cription"..     
-00001960: 2020 200d 0a20 2020 2076 616c 7565 3d28     ..    value=(
-00001970: 2273 7562 7363 7269 6265 636f 6e73 756d  "subscribeconsum
-00001980: 6572 3f76 6970 6572 746f 6b65 6e3d 222b  er?vipertoken="+
-00001990: 7669 7065 7274 6f6b 656e 202b 2022 2674  vipertoken + "&t
-000019a0: 6f70 6963 3d22 2b74 6f70 6963 202b 2022  opic="+topic + "
-000019b0: 2663 6f6d 7061 6e79 6e61 6d65 3d22 202b  &companyname=" +
-000019c0: 2063 6f6d 7061 6e79 6e61 6d65 202b 2022   companyname + "
-000019d0: 2663 6f6e 7461 6374 6e61 6d65 3d22 2b63  &contactname="+c
-000019e0: 6f6e 7461 6374 6e61 6d65 202b 0d0a 2020  ontactname +..  
-000019f0: 2020 2020 2020 2020 2022 2663 6f6e 7461           "&conta
-00001a00: 6374 656d 6169 6c3d 222b 636f 6e74 6163  ctemail="+contac
-00001a10: 7465 6d61 696c 202b 2022 266c 6f63 6174  temail + "&locat
-00001a20: 696f 6e3d 222b 6c6f 6361 7469 6f6e 2b22  ion="+location+"
-00001a30: 2664 6573 6372 6970 7469 6f6e 3d22 2b64  &description="+d
-00001a40: 6573 6372 6970 7469 6f6e 2b20 2226 6272  escription+ "&br
-00001a50: 6f6b 6572 686f 7374 3d22 2b62 726f 6b65  okerhost="+broke
-00001a60: 7268 6f73 7420 2b20 2226 6272 6f6b 6572  rhost + "&broker
-00001a70: 706f 7274 3d22 2b73 7472 2862 726f 6b65  port="+str(broke
-00001a80: 7270 6f72 7429 202b 2022 2667 726f 7570  rport) + "&group
-00001a90: 6964 3d22 202b 2067 726f 7570 6964 290d  id=" + groupid).
-00001aa0: 0a0d 0a20 2020 2076 616c 3d6c 6f6f 702e  ...    val=loop.
-00001ab0: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
-00001ac0: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
-00001ad0: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
-00001ae0: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
-00001af0: 6372 6f73 6572 7669 6365 6964 2929 0d0a  croserviceid))..
-00001b00: 2020 2020 6966 2063 6f6e 6e65 6374 696f      if connectio
-00001b10: 6e65 7272 6f72 3a0d 0a20 2020 2020 2020  nerror:..       
-00001b20: 2020 7265 7475 726e 2063 6f6e 6e65 6374    return connect
-00001b30: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
-00001b40: 7265 7475 726e 2076 616c 0d0a 0d0a 0d0a  return val......
-00001b50: 6465 6620 7669 7065 7275 6e73 7562 7363  def viperunsubsc
-00001b60: 7269 6265 636f 6e73 756d 6572 2876 6970  ribeconsumer(vip
-00001b70: 6572 746f 6b65 6e2c 686f 7374 2c70 6f72  ertoken,host,por
-00001b80: 742c 636f 6e73 756d 6572 6964 2c62 726f  t,consumerid,bro
-00001b90: 6b65 7268 6f73 743d 2727 2c62 726f 6b65  kerhost='',broke
-00001ba0: 7270 6f72 743d 2d39 3939 2c6d 6963 726f  rport=-999,micro
-00001bb0: 7365 7276 6963 6569 643d 2727 293a 0d0a  serviceid=''):..
-00001bc0: 2020 2020 676c 6f62 616c 2063 6f6e 6e65      global conne
-00001bd0: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
-00001be0: 2020 6966 206c 656e 2876 6970 6572 746f    if len(viperto
-00001bf0: 6b65 6e29 3d3d 3020 6f72 206c 656e 2863  ken)==0 or len(c
-00001c00: 6f6e 7375 6d65 7269 6429 3d3d 3020 6f72  onsumerid)==0 or
-00001c10: 206c 656e 2868 6f73 7429 3d3d 303a 0d0a   len(host)==0:..
-00001c20: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00001c30: 2250 6c65 6173 6520 656e 7465 7220 7669  "Please enter vi
-00001c40: 7065 7274 6f6b 656e 2c63 6f6e 7375 6d65  pertoken,consume
-00001c50: 7269 642c 686f 7374 2061 6e64 2070 6f72  rid,host and por
-00001c60: 7422 0d0a 2020 2020 2020 2020 0d0a 2020  t"..        ..  
-00001c70: 2020 7661 6c75 653d 2822 756e 7375 6273    value=("unsubs
-00001c80: 6372 6962 6563 6f6e 7375 6d65 723f 7669  cribeconsumer?vi
-00001c90: 7065 7274 6f6b 656e 3d22 2b76 6970 6572  pertoken="+viper
-00001ca0: 746f 6b65 6e20 2b20 2226 636f 6e73 756d  token + "&consum
-00001cb0: 6572 6964 3d22 2b63 6f6e 7375 6d65 7269  erid="+consumeri
-00001cc0: 6420 2b20 2226 6272 6f6b 6572 686f 7374  d + "&brokerhost
-00001cd0: 3d22 2b62 726f 6b65 7268 6f73 7420 2b22  ="+brokerhost +"
-00001ce0: 2662 726f 6b65 7270 6f72 743d 222b 7374  &brokerport="+st
-00001cf0: 7228 6272 6f6b 6572 706f 7274 2929 0d0a  r(brokerport))..
-00001d00: 0d0a 2020 2020 7661 6c3d 6c6f 6f70 2e72  ..    val=loop.r
-00001d10: 756e 5f75 6e74 696c 5f63 6f6d 706c 6574  un_until_complet
-00001d20: 6528 7463 705f 6563 686f 5f63 6c69 656e  e(tcp_echo_clien
-00001d30: 7476 6970 6572 2876 616c 7565 2c20 6c6f  tviper(value, lo
-00001d40: 6f70 2c68 6f73 742c 706f 7274 2c6d 6963  op,host,port,mic
-00001d50: 726f 7365 7276 6963 6569 6429 290d 0a20  roserviceid)).. 
-00001d60: 2020 2069 6620 636f 6e6e 6563 7469 6f6e     if connection
-00001d70: 6572 726f 723a 0d0a 2020 2020 2020 2020  error:..        
-00001d80: 2072 6574 7572 6e20 636f 6e6e 6563 7469   return connecti
-00001d90: 6f6e 6572 726f 720d 0a0d 0a20 2020 2072  onerror....    r
-00001da0: 6574 7572 6e20 7661 6c0d 0a0d 0a0d 0a64  eturn val......d
-00001db0: 6566 2076 6970 6572 6d69 7272 6f72 6272  ef vipermirrorbr
-00001dc0: 6f6b 6572 7328 7669 7065 7274 6f6b 656e  okers(vipertoken
-00001dd0: 2c68 6f73 742c 706f 7274 2c62 726f 6b65  ,host,port,broke
-00001de0: 7263 6c6f 7564 7573 6572 6e61 6d65 7061  rcloudusernamepa
-00001df0: 7373 6672 6f6d 2c62 726f 6b65 7263 6c6f  ssfrom,brokerclo
-00001e00: 7564 7573 6572 6e61 6d65 7061 7373 746f  udusernamepassto
-00001e10: 2c65 6e61 626c 6574 6c73 6672 6f6d 2c65  ,enabletlsfrom,e
-00001e20: 6e61 626c 6574 6c73 746f 2c0d 0a20 2020  nabletlsto,..   
+00000bd0: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
+00000be0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00000bf0: 2323 2323 2323 5649 5045 5220 4675 6e63  ######VIPER Func
+00000c00: 7469 6f6e 730d 0a0d 0a64 6566 2066 6f72  tions....def for
+00000c10: 6d61 7475 726c 7669 7065 7228 6d61 696e  maturlviper(main
+00000c20: 6461 7461 2c68 6f73 742c 6d69 6372 6f73  data,host,micros
+00000c30: 6572 7669 6365 6964 2c70 7265 686f 7374  erviceid,prehost
+00000c40: 2c70 6f72 7429 3a0d 0a0d 0a20 2020 2069  ,port):....    i
+00000c50: 6620 6c65 6e28 6d69 6372 6f73 6572 7669  f len(microservi
+00000c60: 6365 6964 293e 303a 2020 2020 0d0a 2020  ceid)>0:    ..  
+00000c70: 2020 2020 6d61 696e 7572 6c3d 7072 6568      mainurl=preh
+00000c80: 6f73 7420 2b20 223a 2f2f 2220 2b20 686f  ost + "://" + ho
+00000c90: 7374 202b 2020 223a 2220 2b20 7374 7228  st +  ":" + str(
+00000ca0: 706f 7274 2920 2b22 2f22 202b 206d 6963  port) +"/" + mic
+00000cb0: 726f 7365 7276 6963 6569 6420 2b20 222f  roserviceid + "/
+00000cc0: 2220 2b20 6d61 696e 6461 7461 0d0a 2020  " + maindata..  
+00000cd0: 2020 656c 7365 3a0d 0a20 2020 2020 206d    else:..      m
+00000ce0: 6169 6e75 726c 3d70 7265 686f 7374 202b  ainurl=prehost +
+00000cf0: 2022 3a2f 2f22 202b 2068 6f73 7420 2b20   "://" + host + 
+00000d00: 223a 2220 2b20 7374 7228 706f 7274 2920  ":" + str(port) 
+00000d10: 2b22 2f22 202b 206d 6169 6e64 6174 610d  +"/" + maindata.
+00000d20: 0a20 2020 2020 2020 200d 0a20 2020 2072  .        ..    r
+00000d30: 6574 7572 6e20 6d61 696e 7572 6c0d 0a0d  eturn mainurl...
+00000d40: 0a0d 0a61 7379 6e63 2064 6566 2066 6574  ...async def fet
+00000d50: 6368 2863 6c69 656e 742c 7572 6c29 3a0d  ch(client,url):.
+00000d60: 0a20 2020 2061 7379 6e63 2077 6974 6820  .    async with 
+00000d70: 636c 6965 6e74 2e67 6574 2875 726c 2920  client.get(url) 
+00000d80: 6173 2072 6573 703a 0d0a 2020 2020 2020  as resp:..      
+00000d90: 2020 2361 7379 6369 6f2e 656e 7375 7265    #asycio.ensure
+00000da0: 5f66 7574 7572 6528 290d 0a20 2020 2020  _future()..     
+00000db0: 2020 2072 6574 7572 6e20 6177 6169 7420     return await 
+00000dc0: 7265 7370 2e74 6578 7428 290d 0a0d 0a61  resp.text()....a
+00000dd0: 7379 6e63 2064 6566 2066 6574 6368 3228  sync def fetch2(
+00000de0: 636c 6965 6e74 2c75 726c 293a 0d0a 2020  client,url):..  
+00000df0: 2020 7461 736b 7320 3d20 5b5d 0d0a 2020    tasks = []..  
+00000e00: 2020 7461 736b 732e 6170 7065 6e64 2861    tasks.append(a
+00000e10: 7379 6e63 696f 2e65 6e73 7572 655f 6675  syncio.ensure_fu
+00000e20: 7475 7265 2866 6574 6368 2863 6c69 656e  ture(fetch(clien
+00000e30: 742c 2075 726c 2929 290d 0a20 2020 206f  t, url)))..    o
+00000e40: 7269 6769 6e61 6c20 3d20 6177 6169 7420  riginal = await 
+00000e50: 6173 796e 6369 6f2e 6761 7468 6572 282a  asyncio.gather(*
+00000e60: 7461 736b 7329 0d0a 2020 2020 666f 7220  tasks)..    for 
+00000e70: 696e 666f 2069 6e20 6f72 6967 696e 616c  info in original
+00000e80: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
+00000e90: 6e20 696e 666f 0d0a 2020 2020 0d0a 2323  n info..    ..##
+00000ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00000eb0: 2323 2323 2323 2323 2323 2356 4950 4552  ###########VIPER
+00000ec0: 2041 5049 2043 414c 4c53 2023 2323 2323   API CALLS #####
+00000ed0: 2323 2323 2323 2323 2323 2320 2020 200d  ###########    .
+00000ee0: 0a61 7379 6e63 2064 6566 2074 6370 5f65  .async def tcp_e
+00000ef0: 6368 6f5f 636c 6965 6e74 7669 7065 7228  cho_clientviper(
+00000f00: 6d65 7373 6167 652c 206c 6f6f 702c 686f  message, loop,ho
+00000f10: 7374 2c70 6f72 742c 6d69 6372 6f73 6572  st,port,microser
+00000f20: 7669 6365 6964 2c74 696d 656f 7574 3d36  viceid,timeout=6
+00000f30: 3030 293a 0d0a 2020 2020 676c 6f62 616c  00):..    global
+00000f40: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
+00000f50: 0d0a 0d0a 2020 2020 636f 6e6e 6563 7469  ....    connecti
+00000f60: 6f6e 6572 726f 723d 2222 0d0a 2020 2020  onerror=""..    
+00000f70: 686f 7374 6172 723d 686f 7374 2e73 706c  hostarr=host.spl
+00000f80: 6974 2822 3a22 290d 0a20 2020 2068 6275  it(":")..    hbu
+00000f90: 663d 686f 7374 6172 725b 305d 0d0a 2020  f=hostarr[0]..  
+00000fa0: 2020 6862 7566 3d68 6275 662e 6c6f 7765    hbuf=hbuf.lowe
+00000fb0: 7228 290d 0a20 2020 2064 6f6d 6169 6e3d  r()..    domain=
+00000fc0: 2727 0d0a 2020 2020 6966 2068 6275 663d  ''..    if hbuf=
+00000fd0: 3d27 6874 7470 7327 3a0d 0a20 2020 2020  ='https':..     
+00000fe0: 2020 646f 6d61 696e 3d68 6f73 745b 383a    domain=host[8:
+00000ff0: 5d0d 0a20 2020 2065 6c73 653a 0d0a 2020  ]..    else:..  
+00001000: 2020 2020 2064 6f6d 6169 6e3d 686f 7374       domain=host
+00001010: 5b37 3a5d 0d0a 2020 2020 686f 7374 3d64  [7:]..    host=d
+00001020: 6f6d 6169 6e20 200d 0a0d 0a20 2020 2067  omain  ....    g
+00001030: 6574 7572 6c3d 666f 726d 6174 7572 6c76  eturl=formaturlv
+00001040: 6970 6572 286d 6573 7361 6765 2c68 6f73  iper(message,hos
+00001050: 742c 6d69 6372 6f73 6572 7669 6365 6964  t,microserviceid
+00001060: 2c68 6275 662c 706f 7274 2920 2368 6f73  ,hbuf,port) #hos
+00001070: 7420 636f 6e74 6169 6e73 2068 7474 703a  t contains http:
+00001080: 2f2f 206f 7220 6874 7470 733a 2f2f 0d0a  // or https://..
+00001090: 2020 2020 6d65 7373 6167 653d 2225 7322      message="%s"
+000010a0: 2025 2067 6574 7572 6c0d 0a20 2020 2073   % geturl..    s
+000010b0: 7469 6d65 6f75 7420 3d20 436c 6965 6e74  timeout = Client
+000010c0: 5469 6d65 6f75 7428 746f 7461 6c3d 7469  Timeout(total=ti
+000010d0: 6d65 6f75 7429 0d0a 2020 2020 200d 0a20  meout)..     .. 
+000010e0: 2020 2074 7279 3a0d 0a20 2020 2020 7769     try:..     wi
+000010f0: 7468 2061 7379 6e63 5f74 696d 656f 7574  th async_timeout
+00001100: 2e74 696d 656f 7574 2874 696d 656f 7574  .timeout(timeout
+00001110: 293a 0d0a 2020 2020 2020 6173 796e 6320  ):..      async 
+00001120: 7769 7468 2043 6c69 656e 7453 6573 7369  with ClientSessi
+00001130: 6f6e 2863 6f6e 6e65 6374 6f72 203d 2061  on(connector = a
+00001140: 696f 6874 7470 2e54 4350 436f 6e6e 6563  iohttp.TCPConnec
+00001150: 746f 7228 7373 6c3d 4661 6c73 6529 2c74  tor(ssl=False),t
+00001160: 696d 656f 7574 3d73 7469 6d65 6f75 7429  imeout=stimeout)
+00001170: 2061 7320 7365 7373 696f 6e3a 0d0a 2020   as session:..  
+00001180: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+00001190: 2020 2020 2020 6874 6d6c 203d 2061 7761        html = awa
+000011a0: 6974 2066 6574 6368 3228 7365 7373 696f  it fetch2(sessio
+000011b0: 6e2c 6d65 7373 6167 6529 0d0a 2020 2020  n,message)..    
+000011c0: 2020 2020 2020 6177 6169 7420 7365 7373        await sess
+000011d0: 696f 6e2e 636c 6f73 6528 290d 0a20 2020  ion.close()..   
+000011e0: 2020 2020 2020 2072 6574 7572 6e20 6874         return ht
+000011f0: 6d6c 0d0a 2020 2020 2020 2020 6578 6365  ml..        exce
+00001200: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
+00001210: 653a 0d0a 2020 2020 2020 2020 2020 7072  e:..          pr
+00001220: 696e 7428 6529 0d0a 2020 2020 2020 2020  int(e)..        
+00001230: 2020 7061 7373 0d0a 2020 2020 6578 6365    pass..    exce
+00001240: 7074 2028 6169 6f68 7474 702e 5365 7276  pt (aiohttp.Serv
+00001250: 6572 4469 7363 6f6e 6e65 6374 6564 4572  erDisconnectedEr
+00001260: 726f 722c 2061 696f 6874 7470 2e43 6c69  ror, aiohttp.Cli
+00001270: 656e 7452 6573 706f 6e73 6545 7272 6f72  entResponseError
+00001280: 2c61 696f 6874 7470 2e43 6c69 656e 7443  ,aiohttp.ClientC
+00001290: 6f6e 6e65 6374 6f72 4572 726f 7229 2061  onnectorError) a
+000012a0: 7320 653a 2020 2020 2020 200d 0a20 2020  s e:       ..   
+000012b0: 2020 636f 6e6e 6563 7469 6f6e 6572 726f    connectionerro
+000012c0: 723d 7374 7228 6529 2020 200d 0a20 2020  r=str(e)   ..   
+000012d0: 2020 7072 696e 7428 2254 4350 436f 6e6e    print("TCPConn
+000012e0: 6563 7469 6f6e 4572 726f 723d 222c 6529  ectionError=",e)
+000012f0: 2020 200d 0a20 2020 2020 7061 7373 2020     ..     pass  
+00001300: 200d 0a0d 0a0d 0a64 6566 2076 6970 6572   ......def viper
+00001310: 7374 6174 7328 7669 7065 7274 6f6b 656e  stats(vipertoken
+00001320: 2c68 6f73 742c 706f 7274 3d2d 3939 392c  ,host,port=-999,
+00001330: 6272 6f6b 6572 686f 7374 3d27 272c 6272  brokerhost='',br
+00001340: 6f6b 6572 706f 7274 3d2d 3939 392c 6d69  okerport=-999,mi
+00001350: 6372 6f73 6572 7669 6365 6964 3d27 2729  croserviceid='')
+00001360: 3a0d 0a20 2020 2067 6c6f 6261 6c20 636f  :..    global co
+00001370: 6e6e 6563 7469 6f6e 6572 726f 720d 0a0d  nnectionerror...
+00001380: 0a20 2020 2069 6620 6c65 6e28 7669 7065  .    if len(vipe
+00001390: 7274 6f6b 656e 293d 3d30 206f 7220 6c65  rtoken)==0 or le
+000013a0: 6e28 686f 7374 293d 3d30 206f 7220 706f  n(host)==0 or po
+000013b0: 7274 3d3d 2d39 3939 3a0d 0a20 2020 2020  rt==-999:..     
+000013c0: 2020 7265 7475 726e 2022 506c 6561 7365    return "Please
+000013d0: 2065 6e74 6572 2076 6970 6572 746f 6b65   enter vipertoke
+000013e0: 6e2c 686f 7374 2061 6e64 2070 6f72 7422  n,host and port"
+000013f0: 0d0a 0d0a 2020 2020 7661 6c75 653d 2276  ....    value="v
+00001400: 6970 6572 7374 6174 733f 7669 7065 7274  iperstats?vipert
+00001410: 6f6b 656e 3d22 2b76 6970 6572 746f 6b65  oken="+vipertoke
+00001420: 6e20 2b20 2226 6272 6f6b 6572 686f 7374  n + "&brokerhost
+00001430: 3d22 2b62 726f 6b65 7268 6f73 742b 2226  ="+brokerhost+"&
+00001440: 6272 6f6b 6572 706f 7274 3d22 2b73 7472  brokerport="+str
+00001450: 2862 726f 6b65 7270 6f72 7429 0d0a 2020  (brokerport)..  
+00001460: 2020 6c6f 6f70 203d 2061 7379 6e63 696f    loop = asyncio
+00001470: 2e6e 6577 5f65 7665 6e74 5f6c 6f6f 7028  .new_event_loop(
+00001480: 290d 0a20 2020 2076 616c 3d6c 6f6f 702e  )..    val=loop.
+00001490: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
+000014a0: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
+000014b0: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
+000014c0: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
+000014d0: 6372 6f73 6572 7669 6365 6964 2929 0d0a  croserviceid))..
+000014e0: 2020 2020 6c6f 6f70 2e63 6c6f 7365 2829      loop.close()
+000014f0: 0d0a 2020 2020 6966 2063 6f6e 6e65 6374  ..    if connect
+00001500: 696f 6e65 7272 6f72 3a0d 0a20 2020 2020  ionerror:..     
+00001510: 2020 2020 7265 7475 726e 2063 6f6e 6e65      return conne
+00001520: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
+00001530: 2020 7265 7475 726e 2076 616c 0d0a 0d0a    return val....
+00001540: 0d0a 6465 6620 7669 7065 726c 6973 7474  ..def viperlistt
+00001550: 6f70 6963 7328 7669 7065 7274 6f6b 656e  opics(vipertoken
+00001560: 2c68 6f73 742c 706f 7274 3d2d 3939 392c  ,host,port=-999,
+00001570: 6272 6f6b 6572 686f 7374 3d27 272c 6272  brokerhost='',br
+00001580: 6f6b 6572 706f 7274 3d2d 3939 392c 6d69  okerport=-999,mi
+00001590: 6372 6f73 6572 7669 6365 6964 3d27 2729  croserviceid='')
+000015a0: 3a0d 0a20 2020 2067 6c6f 6261 6c20 636f  :..    global co
+000015b0: 6e6e 6563 7469 6f6e 6572 726f 720d 0a0d  nnectionerror...
+000015c0: 0a20 2020 2069 6620 6c65 6e28 7669 7065  .    if len(vipe
+000015d0: 7274 6f6b 656e 293d 3d30 206f 7220 6c65  rtoken)==0 or le
+000015e0: 6e28 686f 7374 293d 3d30 206f 7220 706f  n(host)==0 or po
+000015f0: 7274 3d3d 2d39 3939 3a0d 0a20 2020 2020  rt==-999:..     
+00001600: 2020 7265 7475 726e 2022 506c 6561 7365    return "Please
+00001610: 2065 6e74 6572 2076 6970 6572 746f 6b65   enter vipertoke
+00001620: 6e2c 686f 7374 2061 6e64 2070 6f72 7422  n,host and port"
+00001630: 0d0a 2020 2020 0d0a 2020 2020 7661 6c75  ..    ..    valu
+00001640: 653d 226c 6973 7474 6f70 6963 733f 7669  e="listtopics?vi
+00001650: 7065 7274 6f6b 656e 3d22 2b76 6970 6572  pertoken="+viper
+00001660: 746f 6b65 6e20 2b20 2226 6272 6f6b 6572  token + "&broker
+00001670: 686f 7374 3d22 2b62 726f 6b65 7268 6f73  host="+brokerhos
+00001680: 742b 2226 6272 6f6b 6572 706f 7274 3d22  t+"&brokerport="
+00001690: 2b73 7472 2862 726f 6b65 7270 6f72 7429  +str(brokerport)
+000016a0: 0d0a 0d0a 2020 2020 7661 6c3d 6c6f 6f70  ....    val=loop
+000016b0: 2e72 756e 5f75 6e74 696c 5f63 6f6d 706c  .run_until_compl
+000016c0: 6574 6528 7463 705f 6563 686f 5f63 6c69  ete(tcp_echo_cli
+000016d0: 656e 7476 6970 6572 2876 616c 7565 2c20  entviper(value, 
+000016e0: 6c6f 6f70 2c68 6f73 742c 706f 7274 2c6d  loop,host,port,m
+000016f0: 6963 726f 7365 7276 6963 6569 6429 290d  icroserviceid)).
+00001700: 0a20 2020 2069 6620 636f 6e6e 6563 7469  .    if connecti
+00001710: 6f6e 6572 726f 723a 0d0a 2020 2020 2020  onerror:..      
+00001720: 2020 2072 6574 7572 6e20 636f 6e6e 6563     return connec
+00001730: 7469 6f6e 6572 726f 720d 0a0d 0a20 2020  tionerror....   
+00001740: 2072 6574 7572 6e20 7661 6c0d 0a0d 0a64   return val....d
+00001750: 6566 2076 6970 6572 7375 6273 6372 6962  ef vipersubscrib
+00001760: 6563 6f6e 7375 6d65 7228 7669 7065 7274  econsumer(vipert
+00001770: 6f6b 656e 2c68 6f73 742c 706f 7274 2c74  oken,host,port,t
+00001780: 6f70 6963 2c63 6f6d 7061 6e79 6e61 6d65  opic,companyname
+00001790: 2c63 6f6e 7461 6374 6e61 6d65 2c63 6f6e  ,contactname,con
+000017a0: 7461 6374 656d 6169 6c2c 6c6f 6361 7469  tactemail,locati
+000017b0: 6f6e 2c64 6573 6372 6970 7469 6f6e 2c62  on,description,b
+000017c0: 726f 6b65 7268 6f73 743d 2727 2c62 726f  rokerhost='',bro
+000017d0: 6b65 7270 6f72 743d 2d39 3939 2c67 726f  kerport=-999,gro
+000017e0: 7570 6964 3d27 272c 6d69 6372 6f73 6572  upid='',microser
+000017f0: 7669 6365 6964 3d27 2729 3a0d 0a20 2020  viceid=''):..   
+00001800: 2067 6c6f 6261 6c20 636f 6e6e 6563 7469   global connecti
+00001810: 6f6e 6572 726f 720d 0a0d 0a20 2020 2069  onerror....    i
+00001820: 6620 6c65 6e28 686f 7374 293d 3d30 206f  f len(host)==0 o
+00001830: 7220 6c65 6e28 7669 7065 7274 6f6b 656e  r len(vipertoken
+00001840: 293d 3d30 206f 7220 706f 7274 3d3d 2d39  )==0 or port==-9
+00001850: 3939 206f 7220 6c65 6e28 746f 7069 6329  99 or len(topic)
+00001860: 3d3d 3020 6f72 206c 656e 2863 6f6d 7061  ==0 or len(compa
+00001870: 6e79 6e61 6d65 293d 3d30 206f 7220 6c65  nyname)==0 or le
+00001880: 6e28 636f 6e74 6163 746e 616d 6529 3d3d  n(contactname)==
+00001890: 3020 6f72 206c 656e 2863 6f6e 7461 6374  0 or len(contact
+000018a0: 656d 6169 6c29 3d3d 3020 6f72 206c 656e  email)==0 or len
+000018b0: 286c 6f63 6174 696f 6e29 3d3d 3020 6f72  (location)==0 or
+000018c0: 206c 656e 2864 6573 6372 6970 7469 6f6e   len(description
+000018d0: 293d 3d30 3a0d 0a20 2020 2020 2020 2020  )==0:..         
+000018e0: 7265 7475 726e 2022 506c 6561 7365 2065  return "Please e
+000018f0: 6e74 6572 2068 6f73 742c 706f 7274 2c76  nter host,port,v
+00001900: 6970 6572 746f 6b65 6e2c 746f 7069 632c  ipertoken,topic,
+00001910: 2063 6f6d 7061 6e79 6e61 6d65 2c63 6f6e   companyname,con
+00001920: 7461 6374 6e61 6d65 2c63 6f6e 7461 6374  tactname,contact
+00001930: 656d 6169 6c2c 6c6f 6361 7469 6f6e 2061  email,location a
+00001940: 6e64 2064 6573 6372 6970 7469 6f6e 220d  nd description".
+00001950: 0a20 2020 2020 2020 200d 0a20 2020 2076  .        ..    v
+00001960: 616c 7565 3d28 2273 7562 7363 7269 6265  alue=("subscribe
+00001970: 636f 6e73 756d 6572 3f76 6970 6572 746f  consumer?viperto
+00001980: 6b65 6e3d 222b 7669 7065 7274 6f6b 656e  ken="+vipertoken
+00001990: 202b 2022 2674 6f70 6963 3d22 2b74 6f70   + "&topic="+top
+000019a0: 6963 202b 2022 2663 6f6d 7061 6e79 6e61  ic + "&companyna
+000019b0: 6d65 3d22 202b 2063 6f6d 7061 6e79 6e61  me=" + companyna
+000019c0: 6d65 202b 2022 2663 6f6e 7461 6374 6e61  me + "&contactna
+000019d0: 6d65 3d22 2b63 6f6e 7461 6374 6e61 6d65  me="+contactname
+000019e0: 202b 0d0a 2020 2020 2020 2020 2020 2022   +..           "
+000019f0: 2663 6f6e 7461 6374 656d 6169 6c3d 222b  &contactemail="+
+00001a00: 636f 6e74 6163 7465 6d61 696c 202b 2022  contactemail + "
+00001a10: 266c 6f63 6174 696f 6e3d 222b 6c6f 6361  &location="+loca
+00001a20: 7469 6f6e 2b22 2664 6573 6372 6970 7469  tion+"&descripti
+00001a30: 6f6e 3d22 2b64 6573 6372 6970 7469 6f6e  on="+description
+00001a40: 2b20 2226 6272 6f6b 6572 686f 7374 3d22  + "&brokerhost="
+00001a50: 2b62 726f 6b65 7268 6f73 7420 2b20 2226  +brokerhost + "&
+00001a60: 6272 6f6b 6572 706f 7274 3d22 2b73 7472  brokerport="+str
+00001a70: 2862 726f 6b65 7270 6f72 7429 202b 2022  (brokerport) + "
+00001a80: 2667 726f 7570 6964 3d22 202b 2067 726f  &groupid=" + gro
+00001a90: 7570 6964 290d 0a0d 0a20 2020 2076 616c  upid)....    val
+00001aa0: 3d6c 6f6f 702e 7275 6e5f 756e 7469 6c5f  =loop.run_until_
+00001ab0: 636f 6d70 6c65 7465 2874 6370 5f65 6368  complete(tcp_ech
+00001ac0: 6f5f 636c 6965 6e74 7669 7065 7228 7661  o_clientviper(va
+00001ad0: 6c75 652c 206c 6f6f 702c 686f 7374 2c70  lue, loop,host,p
+00001ae0: 6f72 742c 6d69 6372 6f73 6572 7669 6365  ort,microservice
+00001af0: 6964 2929 0d0a 2020 2020 6966 2063 6f6e  id))..    if con
+00001b00: 6e65 6374 696f 6e65 7272 6f72 3a0d 0a20  nectionerror:.. 
+00001b10: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+00001b20: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
+00001b30: 0d0a 2020 2020 7265 7475 726e 2076 616c  ..    return val
+00001b40: 0d0a 0d0a 0d0a 6465 6620 7669 7065 7275  ......def viperu
+00001b50: 6e73 7562 7363 7269 6265 636f 6e73 756d  nsubscribeconsum
+00001b60: 6572 2876 6970 6572 746f 6b65 6e2c 686f  er(vipertoken,ho
+00001b70: 7374 2c70 6f72 742c 636f 6e73 756d 6572  st,port,consumer
+00001b80: 6964 2c62 726f 6b65 7268 6f73 743d 2727  id,brokerhost=''
+00001b90: 2c62 726f 6b65 7270 6f72 743d 2d39 3939  ,brokerport=-999
+00001ba0: 2c6d 6963 726f 7365 7276 6963 6569 643d  ,microserviceid=
+00001bb0: 2727 293a 0d0a 2020 2020 676c 6f62 616c  ''):..    global
+00001bc0: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
+00001bd0: 0d0a 0d0a 2020 2020 6966 206c 656e 2876  ....    if len(v
+00001be0: 6970 6572 746f 6b65 6e29 3d3d 3020 6f72  ipertoken)==0 or
+00001bf0: 206c 656e 2863 6f6e 7375 6d65 7269 6429   len(consumerid)
+00001c00: 3d3d 3020 6f72 206c 656e 2868 6f73 7429  ==0 or len(host)
+00001c10: 3d3d 303a 0d0a 2020 2020 2020 2020 2072  ==0:..         r
+00001c20: 6574 7572 6e20 2250 6c65 6173 6520 656e  eturn "Please en
+00001c30: 7465 7220 7669 7065 7274 6f6b 656e 2c63  ter vipertoken,c
+00001c40: 6f6e 7375 6d65 7269 642c 686f 7374 2061  onsumerid,host a
+00001c50: 6e64 2070 6f72 7422 0d0a 2020 2020 2020  nd port"..      
+00001c60: 2020 0d0a 2020 2020 7661 6c75 653d 2822    ..    value=("
+00001c70: 756e 7375 6273 6372 6962 6563 6f6e 7375  unsubscribeconsu
+00001c80: 6d65 723f 7669 7065 7274 6f6b 656e 3d22  mer?vipertoken="
+00001c90: 2b76 6970 6572 746f 6b65 6e20 2b20 2226  +vipertoken + "&
+00001ca0: 636f 6e73 756d 6572 6964 3d22 2b63 6f6e  consumerid="+con
+00001cb0: 7375 6d65 7269 6420 2b20 2226 6272 6f6b  sumerid + "&brok
+00001cc0: 6572 686f 7374 3d22 2b62 726f 6b65 7268  erhost="+brokerh
+00001cd0: 6f73 7420 2b22 2662 726f 6b65 7270 6f72  ost +"&brokerpor
+00001ce0: 743d 222b 7374 7228 6272 6f6b 6572 706f  t="+str(brokerpo
+00001cf0: 7274 2929 0d0a 0d0a 2020 2020 7661 6c3d  rt))....    val=
+00001d00: 6c6f 6f70 2e72 756e 5f75 6e74 696c 5f63  loop.run_until_c
+00001d10: 6f6d 706c 6574 6528 7463 705f 6563 686f  omplete(tcp_echo
+00001d20: 5f63 6c69 656e 7476 6970 6572 2876 616c  _clientviper(val
+00001d30: 7565 2c20 6c6f 6f70 2c68 6f73 742c 706f  ue, loop,host,po
+00001d40: 7274 2c6d 6963 726f 7365 7276 6963 6569  rt,microservicei
+00001d50: 6429 290d 0a20 2020 2069 6620 636f 6e6e  d))..    if conn
+00001d60: 6563 7469 6f6e 6572 726f 723a 0d0a 2020  ectionerror:..  
+00001d70: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
+00001d80: 6e6e 6563 7469 6f6e 6572 726f 720d 0a0d  nnectionerror...
+00001d90: 0a20 2020 2072 6574 7572 6e20 7661 6c0d  .    return val.
+00001da0: 0a0d 0a0d 0a64 6566 2076 6970 6572 6d69  .....def vipermi
+00001db0: 7272 6f72 6272 6f6b 6572 7328 7669 7065  rrorbrokers(vipe
+00001dc0: 7274 6f6b 656e 2c68 6f73 742c 706f 7274  rtoken,host,port
+00001dd0: 2c62 726f 6b65 7263 6c6f 7564 7573 6572  ,brokerclouduser
+00001de0: 6e61 6d65 7061 7373 6672 6f6d 2c62 726f  namepassfrom,bro
+00001df0: 6b65 7263 6c6f 7564 7573 6572 6e61 6d65  kercloudusername
+00001e00: 7061 7373 746f 2c65 6e61 626c 6574 6c73  passto,enabletls
+00001e10: 6672 6f6d 2c65 6e61 626c 6574 6c73 746f  from,enabletlsto
+00001e20: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
 00001e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e50: 2020 2020 2020 2072 6570 6c69 6361 7469         replicati
-00001e60: 6f6e 6661 6374 6f72 6672 6f6d 2c72 6570  onfactorfrom,rep
-00001e70: 6c69 6361 7469 6f6e 6661 6374 6f72 746f  licationfactorto
-00001e80: 2c63 6f6d 7072 6573 7369 6f6e 6672 6f6d  ,compressionfrom
-00001e90: 2c63 6f6d 7072 6573 7369 6f6e 746f 2c0d  ,compressionto,.
-00001ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001e40: 2020 2020 2020 2020 2020 2020 2072 6570               rep
+00001e50: 6c69 6361 7469 6f6e 6661 6374 6f72 6672  licationfactorfr
+00001e60: 6f6d 2c72 6570 6c69 6361 7469 6f6e 6661  om,replicationfa
+00001e70: 6374 6f72 746f 2c63 6f6d 7072 6573 7369  ctorto,compressi
+00001e80: 6f6e 6672 6f6d 2c63 6f6d 7072 6573 7369  onfrom,compressi
+00001e90: 6f6e 746f 2c0d 0a20 2020 2020 2020 2020  onto,..         
+00001ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00001eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001ec0: 2020 2020 2020 2020 2020 2073 6173 6c66             saslf
-00001ed0: 726f 6d2c 7361 736c 746f 2c70 6172 7469  rom,saslto,parti
-00001ee0: 7469 6f6e 732c 6272 6f6b 6572 6c69 7374  tions,brokerlist
-00001ef0: 6672 6f6d 2c62 726f 6b65 726c 6973 7474  from,brokerlistt
-00001f00: 6f2c 2020 2020 2020 2020 2020 2020 2020  o,              
+00001ec0: 2073 6173 6c66 726f 6d2c 7361 736c 746f   saslfrom,saslto
+00001ed0: 2c70 6172 7469 7469 6f6e 732c 6272 6f6b  ,partitions,brok
+00001ee0: 6572 6c69 7374 6672 6f6d 2c62 726f 6b65  erlistfrom,broke
+00001ef0: 726c 6973 7474 6f2c 2020 2020 2020 2020  rlistto,        
+00001f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00001f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001f20: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00001f20: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
 00001f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001f50: 2020 2020 2020 2074 6f70 6963 6c69 7374         topiclist
-00001f60: 2c61 7379 6e63 7469 6d65 6f75 743d 3330  ,asynctimeout=30
-00001f70: 302c 6d69 6372 6f73 6572 7669 6365 6964  0,microserviceid
-00001f80: 3d22 222c 7365 7276 6963 656e 616d 6566  ="",servicenamef
-00001f90: 726f 6d3d 2262 726f 6b65 7222 2c73 6572  rom="broker",ser
-00001fa0: 7669 6365 6e61 6d65 746f 3d22 6272 6f6b  vicenameto="brok
-00001fb0: 6572 222c 0d0a 2020 2020 2020 2020 2020  er",..          
+00001f40: 2020 2020 2020 2020 2020 2020 2074 6f70               top
+00001f50: 6963 6c69 7374 2c61 7379 6e63 7469 6d65  iclist,asynctime
+00001f60: 6f75 743d 3330 302c 6d69 6372 6f73 6572  out=300,microser
+00001f70: 7669 6365 6964 3d22 222c 7365 7276 6963  viceid="",servic
+00001f80: 656e 616d 6566 726f 6d3d 2262 726f 6b65  enamefrom="broke
+00001f90: 7222 2c73 6572 7669 6365 6e61 6d65 746f  r",servicenameto
+00001fa0: 3d22 6272 6f6b 6572 222c 0d0a 2020 2020  ="broker",..    
+00001fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00001fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001fe0: 7061 7274 6974 696f 6e63 6861 6e67 653d  partitionchange=
-00001ff0: 302c 7265 706c 6963 6174 696f 6e63 6861  0,replicationcha
-00002000: 6e67 653d 302c 746f 7069 6366 696c 7465  nge=0,topicfilte
-00002010: 723d 2222 2c72 6f6c 6c62 6163 6b6f 6666  r="",rollbackoff
-00002020: 7365 743d 3029 3a0d 0a20 2020 2067 6c6f  set=0):..    glo
-00002030: 6261 6c20 636f 6e6e 6563 7469 6f6e 6572  bal connectioner
-00002040: 726f 720d 0a0d 0a0d 0a20 2020 2069 6620  ror......    if 
-00002050: 286c 656e 2868 6f73 7429 3d3d 3020 6f72  (len(host)==0 or
-00002060: 206c 656e 2876 6970 6572 746f 6b65 6e29   len(vipertoken)
-00002070: 3d3d 3020 6f72 206c 656e 2862 726f 6b65  ==0 or len(broke
-00002080: 7263 6c6f 7564 7573 6572 6e61 6d65 7061  rcloudusernamepa
-00002090: 7373 6672 6f6d 293d 3d30 206f 7220 6c65  ssfrom)==0 or le
-000020a0: 6e28 6272 6f6b 6572 636c 6f75 6475 7365  n(brokerclouduse
-000020b0: 726e 616d 6570 6173 7374 6f29 3d3d 300d  rnamepassto)==0.
-000020c0: 0a20 2020 2020 2020 2020 6f72 206c 656e  .         or len
-000020d0: 2865 6e61 626c 6574 6c73 6672 6f6d 293d  (enabletlsfrom)=
-000020e0: 3d30 206f 7220 6c65 6e28 656e 6162 6c65  =0 or len(enable
-000020f0: 746c 7374 6f29 3d3d 3020 0d0a 2020 2020  tlsto)==0 ..    
-00002100: 2020 2020 206f 7220 6c65 6e28 636f 6d70       or len(comp
-00002110: 7265 7373 696f 6e66 726f 6d29 3d3d 3020  ressionfrom)==0 
-00002120: 6f72 206c 656e 2863 6f6d 7072 6573 7369  or len(compressi
-00002130: 6f6e 746f 293d 3d30 206f 7220 6c65 6e28  onto)==0 or len(
-00002140: 7361 736c 6672 6f6d 293d 3d30 206f 7220  saslfrom)==0 or 
-00002150: 6c65 6e28 7361 736c 746f 293d 3d30 0d0a  len(saslto)==0..
-00002160: 2020 2020 2020 2020 206f 7220 6c65 6e28           or len(
-00002170: 6272 6f6b 6572 6c69 7374 6672 6f6d 293d  brokerlistfrom)=
-00002180: 3d30 206f 7220 206c 656e 2862 726f 6b65  =0 or  len(broke
-00002190: 726c 6973 7474 6f29 3d3d 3020 293a 0d0a  rlistto)==0 ):..
-000021a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000021b0: 2028 2250 6c65 6173 6520 656e 7465 7220   ("Please enter 
-000021c0: 686f 7374 2c70 6f72 742c 7669 7065 7274  host,port,vipert
-000021d0: 6f6b 656e 2c62 726f 6b65 7263 6c6f 7564  oken,brokercloud
-000021e0: 7573 6572 6e61 6d65 7061 7373 6672 6f6d  usernamepassfrom
-000021f0: 2c20 6272 6f6b 6572 636c 6f75 6475 7365  , brokerclouduse
-00002200: 726e 616d 6570 6173 7374 6f2c 2065 6e61  rnamepassto, ena
-00002210: 626c 6574 6c73 6672 6f6d 2c5c 0d0a 656e  bletlsfrom,\..en
-00002220: 6162 6c65 746c 7374 6f2c 636f 6d70 7265  abletlsto,compre
-00002230: 7373 696f 6e66 726f 6d2c 636f 6d70 7265  ssionfrom,compre
-00002240: 7373 696f 6e74 6f2c 7361 736c 6672 6f6d  ssionto,saslfrom
-00002250: 2c73 6173 6c74 6f2c 6272 6f6b 6572 6c69  ,saslto,brokerli
-00002260: 7374 6672 6f6d 2c62 726f 6b65 726c 6973  stfrom,brokerlis
-00002270: 7474 6f22 290d 0a20 2020 200d 0a20 2020  tto")..    ..   
-00002280: 2076 616c 7565 3d28 2277 7269 7465 7374   value=("writest
-00002290: 7265 616d 746f 6272 6f6b 6572 733f 7669  reamtobrokers?vi
-000022a0: 7065 7274 6f6b 656e 3d22 2b76 6970 6572  pertoken="+viper
-000022b0: 746f 6b65 6e20 2b20 2226 656e 6162 6c65  token + "&enable
-000022c0: 746c 7366 726f 6d3d 222b 656e 6162 6c65  tlsfrom="+enable
-000022d0: 746c 7366 726f 6d20 2b20 2226 656e 6162  tlsfrom + "&enab
-000022e0: 6c65 746c 7374 6f3d 2220 2b20 656e 6162  letlsto=" + enab
-000022f0: 6c65 746c 7374 6f0d 0a20 2020 2020 2020  letlsto..       
-00002300: 2020 2020 2b20 2226 7265 706c 6963 6174      + "&replicat
-00002310: 696f 6e66 6163 746f 7266 726f 6d3d 2220  ionfactorfrom=" 
-00002320: 2b20 7265 706c 6963 6174 696f 6e66 6163  + replicationfac
-00002330: 746f 7266 726f 6d20 2b20 2226 7265 706c  torfrom + "&repl
-00002340: 6963 6174 696f 6e66 6163 746f 7274 6f3d  icationfactorto=
-00002350: 2220 2b20 7265 706c 6963 6174 696f 6e66  " + replicationf
-00002360: 6163 746f 7274 6f0d 0a20 2020 2020 2020  actorto..       
-00002370: 2020 2020 2b20 2226 636f 6d70 7265 7373      + "&compress
-00002380: 696f 6e66 726f 6d3d 2220 2b20 636f 6d70  ionfrom=" + comp
-00002390: 7265 7373 696f 6e66 726f 6d20 2b20 2226  ressionfrom + "&
-000023a0: 636f 6d70 7265 7373 696f 6e74 6f3d 2220  compressionto=" 
-000023b0: 2b20 636f 6d70 7265 7373 696f 6e74 6f20  + compressionto 
-000023c0: 2b20 2022 2673 6173 6c66 726f 6d3d 222b  +  "&saslfrom="+
-000023d0: 7361 736c 6672 6f6d 0d0a 2020 2020 2020  saslfrom..      
-000023e0: 2020 2020 202b 2022 2673 6173 6c74 6f3d       + "&saslto=
-000023f0: 222b 7361 736c 746f 2b22 2670 6172 7469  "+saslto+"&parti
-00002400: 7469 6f6e 733d 222b 7061 7274 6974 696f  tions="+partitio
-00002410: 6e73 202b 2022 2673 6572 7669 6365 6e61  ns + "&servicena
-00002420: 6d65 6672 6f6d 3d22 2b73 6572 7669 6365  mefrom="+service
-00002430: 6e61 6d65 6672 6f6d 202b 2022 2673 6572  namefrom + "&ser
-00002440: 7669 6365 6e61 6d65 746f 3d22 202b 2073  vicenameto=" + s
-00002450: 6572 7669 6365 6e61 6d65 746f 200d 0a20  ervicenameto .. 
-00002460: 2020 2020 2020 2020 2020 2b20 2226 6272            + "&br
-00002470: 6f6b 6572 6c69 7374 6672 6f6d 3d22 202b  okerlistfrom=" +
-00002480: 2062 726f 6b65 726c 6973 7466 726f 6d20   brokerlistfrom 
-00002490: 2b20 2226 6272 6f6b 6572 6c69 7374 746f  + "&brokerlistto
-000024a0: 3d22 202b 2062 726f 6b65 726c 6973 7474  =" + brokerlistt
-000024b0: 6f20 2b20 2022 2674 6f70 6963 6c69 7374  o +  "&topiclist
-000024c0: 3d22 202b 2074 6f70 6963 6c69 7374 0d0a  =" + topiclist..
-000024d0: 2020 2020 2020 2020 2020 202b 2022 2662             + "&b
-000024e0: 726f 6b65 7263 6c6f 7564 7573 6572 6e61  rokerclouduserna
-000024f0: 6d65 7061 7373 6672 6f6d 3d22 202b 2075  mepassfrom=" + u
-00002500: 726c 6c69 622e 7061 7273 652e 7175 6f74  rllib.parse.quot
-00002510: 6528 6272 6f6b 6572 636c 6f75 6475 7365  e(brokerclouduse
-00002520: 726e 616d 6570 6173 7366 726f 6d29 202b  rnamepassfrom) +
-00002530: 2022 2662 726f 6b65 7263 6c6f 7564 7573   "&brokercloudus
-00002540: 6572 6e61 6d65 7061 7373 746f 3d22 202b  ernamepassto=" +
-00002550: 2075 726c 6c69 622e 7061 7273 652e 7175   urllib.parse.qu
-00002560: 6f74 6528 6272 6f6b 6572 636c 6f75 6475  ote(brokercloudu
-00002570: 7365 726e 616d 6570 6173 7374 6f29 0d0a  sernamepassto)..
-00002580: 2020 2020 2020 2020 2020 202b 2022 2672             + "&r
-00002590: 6f6c 6c62 6163 6b6f 6666 7365 743d 2220  ollbackoffset=" 
-000025a0: 2b20 7374 7228 726f 6c6c 6261 636b 6f66  + str(rollbackof
-000025b0: 6673 6574 2920 2b20 2226 6368 616e 6765  fset) + "&change
-000025c0: 7061 7274 6974 696f 6e70 6572 633d 2220  partitionperc=" 
-000025d0: 2b20 7374 7228 7061 7274 6974 696f 6e63  + str(partitionc
-000025e0: 6861 6e67 6529 202b 2022 2663 6861 6e67  hange) + "&chang
-000025f0: 6572 6570 6c69 6361 7469 6f6e 3d22 202b  ereplication=" +
-00002600: 2073 7472 2872 6570 6c69 6361 7469 6f6e   str(replication
-00002610: 6368 616e 6765 290d 0a20 2020 2020 2020  change)..       
-00002620: 2020 2020 2b20 2226 6669 6c74 6572 3d22      + "&filter="
-00002630: 202b 2074 6f70 6963 6669 6c74 6572 290d   + topicfilter).
-00002640: 0a0d 0a20 2020 2076 616c 3d6c 6f6f 702e  ...    val=loop.
-00002650: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
-00002660: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
-00002670: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
-00002680: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
-00002690: 6372 6f73 6572 7669 6365 6964 2c61 7379  croserviceid,asy
-000026a0: 6e63 7469 6d65 6f75 7429 290d 0a0d 0a20  nctimeout)).... 
-000026b0: 2020 2069 6620 636f 6e6e 6563 7469 6f6e     if connection
-000026c0: 6572 726f 723a 0d0a 2020 2020 2020 2020  error:..        
-000026d0: 2072 6574 7572 6e20 636f 6e6e 6563 7469   return connecti
-000026e0: 6f6e 6572 726f 720d 0a0d 0a20 2020 2072  onerror....    r
-000026f0: 6574 7572 6e20 7661 6c0d 0a0d 0a64 6566  eturn val....def
-00002700: 2076 6970 6572 7374 7265 616d 7175 6572   viperstreamquer
-00002710: 7962 6174 6368 2876 6970 6572 746f 6b65  ybatch(vipertoke
-00002720: 6e2c 686f 7374 2c70 6f72 742c 746f 7069  n,host,port,topi
-00002730: 632c 7072 6f64 7563 6572 6964 2c6f 6666  c,producerid,off
-00002740: 7365 743d 2d31 2c6d 6178 726f 7773 3d30  set=-1,maxrows=0
-00002750: 2c65 6e61 626c 6574 6c73 3d31 2c64 656c  ,enabletls=1,del
-00002760: 6179 3d31 3030 2c62 726f 6b65 7268 6f73  ay=100,brokerhos
-00002770: 743d 2727 2c0d 0a20 2020 2020 2020 2020  t='',..         
+00001fd0: 2020 2020 2020 7061 7274 6974 696f 6e63        partitionc
+00001fe0: 6861 6e67 653d 302c 7265 706c 6963 6174  hange=0,replicat
+00001ff0: 696f 6e63 6861 6e67 653d 302c 746f 7069  ionchange=0,topi
+00002000: 6366 696c 7465 723d 2222 2c72 6f6c 6c62  cfilter="",rollb
+00002010: 6163 6b6f 6666 7365 743d 3029 3a0d 0a20  ackoffset=0):.. 
+00002020: 2020 2067 6c6f 6261 6c20 636f 6e6e 6563     global connec
+00002030: 7469 6f6e 6572 726f 720d 0a0d 0a0d 0a20  tionerror...... 
+00002040: 2020 2069 6620 286c 656e 2868 6f73 7429     if (len(host)
+00002050: 3d3d 3020 6f72 206c 656e 2876 6970 6572  ==0 or len(viper
+00002060: 746f 6b65 6e29 3d3d 3020 6f72 206c 656e  token)==0 or len
+00002070: 2862 726f 6b65 7263 6c6f 7564 7573 6572  (brokerclouduser
+00002080: 6e61 6d65 7061 7373 6672 6f6d 293d 3d30  namepassfrom)==0
+00002090: 206f 7220 6c65 6e28 6272 6f6b 6572 636c   or len(brokercl
+000020a0: 6f75 6475 7365 726e 616d 6570 6173 7374  oudusernamepasst
+000020b0: 6f29 3d3d 300d 0a20 2020 2020 2020 2020  o)==0..         
+000020c0: 6f72 206c 656e 2865 6e61 626c 6574 6c73  or len(enabletls
+000020d0: 6672 6f6d 293d 3d30 206f 7220 6c65 6e28  from)==0 or len(
+000020e0: 656e 6162 6c65 746c 7374 6f29 3d3d 3020  enabletlsto)==0 
+000020f0: 0d0a 2020 2020 2020 2020 206f 7220 6c65  ..         or le
+00002100: 6e28 636f 6d70 7265 7373 696f 6e66 726f  n(compressionfro
+00002110: 6d29 3d3d 3020 6f72 206c 656e 2863 6f6d  m)==0 or len(com
+00002120: 7072 6573 7369 6f6e 746f 293d 3d30 206f  pressionto)==0 o
+00002130: 7220 6c65 6e28 7361 736c 6672 6f6d 293d  r len(saslfrom)=
+00002140: 3d30 206f 7220 6c65 6e28 7361 736c 746f  =0 or len(saslto
+00002150: 293d 3d30 0d0a 2020 2020 2020 2020 206f  )==0..         o
+00002160: 7220 6c65 6e28 6272 6f6b 6572 6c69 7374  r len(brokerlist
+00002170: 6672 6f6d 293d 3d30 206f 7220 206c 656e  from)==0 or  len
+00002180: 2862 726f 6b65 726c 6973 7474 6f29 3d3d  (brokerlistto)==
+00002190: 3020 293a 0d0a 2020 2020 2020 2020 2020  0 ):..          
+000021a0: 7265 7475 726e 2028 2250 6c65 6173 6520  return ("Please 
+000021b0: 656e 7465 7220 686f 7374 2c70 6f72 742c  enter host,port,
+000021c0: 7669 7065 7274 6f6b 656e 2c62 726f 6b65  vipertoken,broke
+000021d0: 7263 6c6f 7564 7573 6572 6e61 6d65 7061  rcloudusernamepa
+000021e0: 7373 6672 6f6d 2c20 6272 6f6b 6572 636c  ssfrom, brokercl
+000021f0: 6f75 6475 7365 726e 616d 6570 6173 7374  oudusernamepasst
+00002200: 6f2c 2065 6e61 626c 6574 6c73 6672 6f6d  o, enabletlsfrom
+00002210: 2c5c 0d0a 656e 6162 6c65 746c 7374 6f2c  ,\..enabletlsto,
+00002220: 636f 6d70 7265 7373 696f 6e66 726f 6d2c  compressionfrom,
+00002230: 636f 6d70 7265 7373 696f 6e74 6f2c 7361  compressionto,sa
+00002240: 736c 6672 6f6d 2c73 6173 6c74 6f2c 6272  slfrom,saslto,br
+00002250: 6f6b 6572 6c69 7374 6672 6f6d 2c62 726f  okerlistfrom,bro
+00002260: 6b65 726c 6973 7474 6f22 290d 0a20 2020  kerlistto")..   
+00002270: 200d 0a20 2020 2076 616c 7565 3d28 2277   ..    value=("w
+00002280: 7269 7465 7374 7265 616d 746f 6272 6f6b  ritestreamtobrok
+00002290: 6572 733f 7669 7065 7274 6f6b 656e 3d22  ers?vipertoken="
+000022a0: 2b76 6970 6572 746f 6b65 6e20 2b20 2226  +vipertoken + "&
+000022b0: 656e 6162 6c65 746c 7366 726f 6d3d 222b  enabletlsfrom="+
+000022c0: 656e 6162 6c65 746c 7366 726f 6d20 2b20  enabletlsfrom + 
+000022d0: 2226 656e 6162 6c65 746c 7374 6f3d 2220  "&enabletlsto=" 
+000022e0: 2b20 656e 6162 6c65 746c 7374 6f0d 0a20  + enabletlsto.. 
+000022f0: 2020 2020 2020 2020 2020 2b20 2226 7265            + "&re
+00002300: 706c 6963 6174 696f 6e66 6163 746f 7266  plicationfactorf
+00002310: 726f 6d3d 2220 2b20 7265 706c 6963 6174  rom=" + replicat
+00002320: 696f 6e66 6163 746f 7266 726f 6d20 2b20  ionfactorfrom + 
+00002330: 2226 7265 706c 6963 6174 696f 6e66 6163  "&replicationfac
+00002340: 746f 7274 6f3d 2220 2b20 7265 706c 6963  torto=" + replic
+00002350: 6174 696f 6e66 6163 746f 7274 6f0d 0a20  ationfactorto.. 
+00002360: 2020 2020 2020 2020 2020 2b20 2226 636f            + "&co
+00002370: 6d70 7265 7373 696f 6e66 726f 6d3d 2220  mpressionfrom=" 
+00002380: 2b20 636f 6d70 7265 7373 696f 6e66 726f  + compressionfro
+00002390: 6d20 2b20 2226 636f 6d70 7265 7373 696f  m + "&compressio
+000023a0: 6e74 6f3d 2220 2b20 636f 6d70 7265 7373  nto=" + compress
+000023b0: 696f 6e74 6f20 2b20 2022 2673 6173 6c66  ionto +  "&saslf
+000023c0: 726f 6d3d 222b 7361 736c 6672 6f6d 0d0a  rom="+saslfrom..
+000023d0: 2020 2020 2020 2020 2020 202b 2022 2673             + "&s
+000023e0: 6173 6c74 6f3d 222b 7361 736c 746f 2b22  aslto="+saslto+"
+000023f0: 2670 6172 7469 7469 6f6e 733d 222b 7061  &partitions="+pa
+00002400: 7274 6974 696f 6e73 202b 2022 2673 6572  rtitions + "&ser
+00002410: 7669 6365 6e61 6d65 6672 6f6d 3d22 2b73  vicenamefrom="+s
+00002420: 6572 7669 6365 6e61 6d65 6672 6f6d 202b  ervicenamefrom +
+00002430: 2022 2673 6572 7669 6365 6e61 6d65 746f   "&servicenameto
+00002440: 3d22 202b 2073 6572 7669 6365 6e61 6d65  =" + servicename
+00002450: 746f 200d 0a20 2020 2020 2020 2020 2020  to ..           
+00002460: 2b20 2226 6272 6f6b 6572 6c69 7374 6672  + "&brokerlistfr
+00002470: 6f6d 3d22 202b 2062 726f 6b65 726c 6973  om=" + brokerlis
+00002480: 7466 726f 6d20 2b20 2226 6272 6f6b 6572  tfrom + "&broker
+00002490: 6c69 7374 746f 3d22 202b 2062 726f 6b65  listto=" + broke
+000024a0: 726c 6973 7474 6f20 2b20 2022 2674 6f70  rlistto +  "&top
+000024b0: 6963 6c69 7374 3d22 202b 2074 6f70 6963  iclist=" + topic
+000024c0: 6c69 7374 0d0a 2020 2020 2020 2020 2020  list..          
+000024d0: 202b 2022 2662 726f 6b65 7263 6c6f 7564   + "&brokercloud
+000024e0: 7573 6572 6e61 6d65 7061 7373 6672 6f6d  usernamepassfrom
+000024f0: 3d22 202b 2075 726c 6c69 622e 7061 7273  =" + urllib.pars
+00002500: 652e 7175 6f74 6528 6272 6f6b 6572 636c  e.quote(brokercl
+00002510: 6f75 6475 7365 726e 616d 6570 6173 7366  oudusernamepassf
+00002520: 726f 6d29 202b 2022 2662 726f 6b65 7263  rom) + "&brokerc
+00002530: 6c6f 7564 7573 6572 6e61 6d65 7061 7373  loudusernamepass
+00002540: 746f 3d22 202b 2075 726c 6c69 622e 7061  to=" + urllib.pa
+00002550: 7273 652e 7175 6f74 6528 6272 6f6b 6572  rse.quote(broker
+00002560: 636c 6f75 6475 7365 726e 616d 6570 6173  cloudusernamepas
+00002570: 7374 6f29 0d0a 2020 2020 2020 2020 2020  sto)..          
+00002580: 202b 2022 2672 6f6c 6c62 6163 6b6f 6666   + "&rollbackoff
+00002590: 7365 743d 2220 2b20 7374 7228 726f 6c6c  set=" + str(roll
+000025a0: 6261 636b 6f66 6673 6574 2920 2b20 2226  backoffset) + "&
+000025b0: 6368 616e 6765 7061 7274 6974 696f 6e70  changepartitionp
+000025c0: 6572 633d 2220 2b20 7374 7228 7061 7274  erc=" + str(part
+000025d0: 6974 696f 6e63 6861 6e67 6529 202b 2022  itionchange) + "
+000025e0: 2663 6861 6e67 6572 6570 6c69 6361 7469  &changereplicati
+000025f0: 6f6e 3d22 202b 2073 7472 2872 6570 6c69  on=" + str(repli
+00002600: 6361 7469 6f6e 6368 616e 6765 290d 0a20  cationchange).. 
+00002610: 2020 2020 2020 2020 2020 2b20 2226 6669            + "&fi
+00002620: 6c74 6572 3d22 202b 2074 6f70 6963 6669  lter=" + topicfi
+00002630: 6c74 6572 290d 0a0d 0a20 2020 2076 616c  lter)....    val
+00002640: 3d6c 6f6f 702e 7275 6e5f 756e 7469 6c5f  =loop.run_until_
+00002650: 636f 6d70 6c65 7465 2874 6370 5f65 6368  complete(tcp_ech
+00002660: 6f5f 636c 6965 6e74 7669 7065 7228 7661  o_clientviper(va
+00002670: 6c75 652c 206c 6f6f 702c 686f 7374 2c70  lue, loop,host,p
+00002680: 6f72 742c 6d69 6372 6f73 6572 7669 6365  ort,microservice
+00002690: 6964 2c61 7379 6e63 7469 6d65 6f75 7429  id,asynctimeout)
+000026a0: 290d 0a0d 0a20 2020 2069 6620 636f 6e6e  )....    if conn
+000026b0: 6563 7469 6f6e 6572 726f 723a 0d0a 2020  ectionerror:..  
+000026c0: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
+000026d0: 6e6e 6563 7469 6f6e 6572 726f 720d 0a0d  nnectionerror...
+000026e0: 0a20 2020 2072 6574 7572 6e20 7661 6c0d  .    return val.
+000026f0: 0a0d 0a64 6566 2076 6970 6572 7374 7265  ...def viperstre
+00002700: 616d 7175 6572 7962 6174 6368 2876 6970  amquerybatch(vip
+00002710: 6572 746f 6b65 6e2c 686f 7374 2c70 6f72  ertoken,host,por
+00002720: 742c 746f 7069 632c 7072 6f64 7563 6572  t,topic,producer
+00002730: 6964 2c6f 6666 7365 743d 2d31 2c6d 6178  id,offset=-1,max
+00002740: 726f 7773 3d30 2c65 6e61 626c 6574 6c73  rows=0,enabletls
+00002750: 3d31 2c64 656c 6179 3d31 3030 2c62 726f  =1,delay=100,bro
+00002760: 6b65 7268 6f73 743d 2727 2c0d 0a20 2020  kerhost='',..   
+00002770: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00002780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000027a0: 2062 726f 6b65 7270 6f72 743d 2d39 3939   brokerport=-999
-000027b0: 2c6d 6963 726f 7365 7276 6963 6569 643d  ,microserviceid=
-000027c0: 2727 2c74 6f70 6963 6964 3d22 2d39 3939  '',topicid="-999
-000027d0: 222c 7374 7265 616d 7374 6f6a 6f69 6e3d  ",streamstojoin=
-000027e0: 2727 2c70 7265 7072 6f63 6573 7363 6f6e  '',preprocesscon
-000027f0: 6469 7469 6f6e 733d 2727 2c0d 0a20 2020  ditions='',..   
+00002790: 2020 2020 2020 2062 726f 6b65 7270 6f72         brokerpor
+000027a0: 743d 2d39 3939 2c6d 6963 726f 7365 7276  t=-999,microserv
+000027b0: 6963 6569 643d 2727 2c74 6f70 6963 6964  iceid='',topicid
+000027c0: 3d22 2d39 3939 222c 7374 7265 616d 7374  ="-999",streamst
+000027d0: 6f6a 6f69 6e3d 2727 2c70 7265 7072 6f63  ojoin='',preproc
+000027e0: 6573 7363 6f6e 6469 7469 6f6e 733d 2727  essconditions=''
+000027f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
 00002800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002820: 2020 2020 2020 2069 6465 6e74 6966 6965         identifie
-00002830: 723d 2727 2c70 7265 7072 6f63 6573 7374  r='',preprocesst
-00002840: 6f70 6963 3d27 272c 6465 7363 7269 7074  opic='',descript
-00002850: 696f 6e3d 2727 2c61 7272 6179 3d30 2c74  ion='',array=0,t
-00002860: 696d 6564 656c 6179 3d30 2c61 7379 6e63  imedelay=0,async
-00002870: 7469 6d65 6f75 743d 3132 302c 0d0a 2020  timeout=120,..  
+00002810: 2020 2020 2020 2020 2020 2020 2069 6465               ide
+00002820: 6e74 6966 6965 723d 2727 2c70 7265 7072  ntifier='',prepr
+00002830: 6f63 6573 7374 6f70 6963 3d27 272c 6465  ocesstopic='',de
+00002840: 7363 7269 7074 696f 6e3d 2727 2c61 7272  scription='',arr
+00002850: 6179 3d30 2c74 696d 6564 656c 6179 3d30  ay=0,timedelay=0
+00002860: 2c61 7379 6e63 7469 6d65 6f75 743d 3132  ,asynctimeout=12
+00002870: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
 00002880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000028a0: 2020 2020 2020 2020 7768 6572 6563 6f6e          wherecon
-000028b0: 6469 7469 6f6e 3d27 272c 7768 6572 6573  dition='',wheres
-000028c0: 6561 7263 686b 6579 3d27 5072 6570 726f  earchkey='Prepro
-000028d0: 6365 7373 4964 656e 7469 6669 6572 272c  cessIdentifier',
-000028e0: 7261 7764 6174 616f 7574 7075 743d 3129  rawdataoutput=1)
-000028f0: 3a0d 0a20 2020 2067 6c6f 6261 6c20 636f  :..    global co
-00002900: 6e6e 6563 7469 6f6e 6572 726f 720d 0a0d  nnectionerror...
-00002910: 0a20 2020 2069 6620 6c65 6e28 686f 7374  .    if len(host
-00002920: 293d 3d30 206f 7220 6c65 6e28 7669 7065  )==0 or len(vipe
-00002930: 7274 6f6b 656e 293d 3d30 206f 7220 706f  rtoken)==0 or po
-00002940: 7274 3d3d 2d39 3939 206f 7220 6c65 6e28  rt==-999 or len(
-00002950: 746f 7069 6329 3d3d 3020 6f72 206c 656e  topic)==0 or len
-00002960: 2870 726f 6475 6365 7269 6429 3d3d 3020  (producerid)==0 
-00002970: 6f72 206c 656e 2873 7472 6561 6d73 746f  or len(streamsto
-00002980: 6a6f 696e 293d 3d30 206f 7220 6c65 6e28  join)==0 or len(
-00002990: 7072 6570 726f 6365 7373 636f 6e64 6974  preprocesscondit
-000029a0: 696f 6e73 293d 3d30 3a0d 0a20 2020 2020  ions)==0:..     
-000029b0: 2020 2020 7265 7475 726e 2022 506c 6561      return "Plea
-000029c0: 7365 2065 6e74 6572 2068 6f73 742c 706f  se enter host,po
-000029d0: 7274 2c76 6970 6572 746f 6b65 6e2c 746f  rt,vipertoken,to
-000029e0: 7069 632c 2070 726f 6475 6365 7269 642c  pic, producerid,
-000029f0: 2073 7472 6561 6d73 746f 6a6f 696e 2c20   streamstojoin, 
-00002a00: 7072 6570 726f 6365 7373 636f 6e64 6974  preprocesscondit
-00002a10: 696f 6e73 220d 0a20 2020 200d 0a20 2020  ions"..    ..   
-00002a20: 2076 616c 7565 3d28 2273 7472 6561 6d71   value=("streamq
-00002a30: 7565 7279 6261 7463 683f 7669 7065 7274  uerybatch?vipert
-00002a40: 6f6b 656e 3d22 2b76 6970 6572 746f 6b65  oken="+vipertoke
-00002a50: 6e20 2b20 2226 746f 7069 636e 616d 653d  n + "&topicname=
-00002a60: 222b 746f 7069 6320 2b20 2226 7072 6f64  "+topic + "&prod
-00002a70: 7563 6572 6964 3d22 202b 2070 726f 6475  ucerid=" + produ
-00002a80: 6365 7269 6420 2b20 2226 6f66 6673 6574  cerid + "&offset
-00002a90: 3d22 202b 2073 7472 286f 6666 7365 7429  =" + str(offset)
-00002aa0: 0d0a 2020 2020 2020 2020 2020 202b 2022  ..           + "
-00002ab0: 266d 6178 726f 7773 3d22 202b 2073 7472  &maxrows=" + str
-00002ac0: 286d 6178 726f 7773 2920 2b20 2226 6465  (maxrows) + "&de
-00002ad0: 6c61 793d 2220 2b20 7374 7228 6465 6c61  lay=" + str(dela
-00002ae0: 7929 202b 2020 2226 656e 6162 6c65 746c  y) +  "&enabletl
-00002af0: 733d 222b 7374 7228 656e 6162 6c65 746c  s="+str(enabletl
-00002b00: 7329 0d0a 2020 2020 2020 2020 2020 202b  s)..           +
-00002b10: 2022 2662 726f 6b65 7268 6f73 743d 222b   "&brokerhost="+
-00002b20: 6272 6f6b 6572 686f 7374 2b22 2662 726f  brokerhost+"&bro
-00002b30: 6b65 7270 6f72 743d 222b 7374 7228 6272  kerport="+str(br
-00002b40: 6f6b 6572 706f 7274 2920 2b20 2226 7374  okerport) + "&st
-00002b50: 7265 616d 7374 6f6a 6f69 6e3d 222b 7374  reamstojoin="+st
-00002b60: 7265 616d 7374 6f6a 6f69 6e20 2b20 2226  reamstojoin + "&
-00002b70: 746f 7069 6369 643d 2220 2b20 746f 7069  topicid=" + topi
-00002b80: 6369 6420 0d0a 2020 2020 2020 2020 2020  cid ..          
-00002b90: 202b 2022 2669 6465 6e74 6966 6965 723d   + "&identifier=
-00002ba0: 2220 2b20 6964 656e 7469 6669 6572 202b  " + identifier +
-00002bb0: 2022 2670 7265 7072 6f63 6573 7374 6f70   "&preprocesstop
-00002bc0: 6963 3d22 202b 2073 7472 2870 7265 7072  ic=" + str(prepr
-00002bd0: 6f63 6573 7374 6f70 6963 2920 2b20 2022  ocesstopic) +  "
-00002be0: 2664 6573 6372 6970 7469 6f6e 3d22 202b  &description=" +
-00002bf0: 2073 7472 2864 6573 6372 6970 7469 6f6e   str(description
-00002c00: 290d 0a20 2020 2020 2020 2020 2020 2b20  )..           + 
-00002c10: 2226 7072 6570 726f 6365 7373 636f 6e64  "&preprocesscond
-00002c20: 6974 696f 6e73 3d22 202b 2070 7265 7072  itions=" + prepr
-00002c30: 6f63 6573 7363 6f6e 6469 7469 6f6e 7320  ocessconditions 
-00002c40: 2b20 2226 6172 7261 793d 2220 2b20 7374  + "&array=" + st
-00002c50: 7228 6172 7261 7929 2b20 2226 7469 6d65  r(array)+ "&time
-00002c60: 6465 6c61 793d 2220 2b20 7374 7228 7469  delay=" + str(ti
-00002c70: 6d65 6465 6c61 7929 2b20 2226 7768 6572  medelay)+ "&wher
-00002c80: 6563 6f6e 6469 7469 6f6e 3d22 202b 2077  econdition=" + w
-00002c90: 6865 7265 636f 6e64 6974 696f 6e0d 0a20  herecondition.. 
-00002ca0: 2020 2020 2020 2020 2020 2b20 2226 7768            + "&wh
-00002cb0: 6572 6573 6561 7263 686b 6579 3d22 202b  eresearchkey=" +
-00002cc0: 2077 6865 7265 7365 6172 6368 6b65 7920   wheresearchkey 
-00002cd0: 2b20 2226 7261 7764 6174 616f 7574 7075  + "&rawdataoutpu
-00002ce0: 743d 2220 2b20 7374 7228 7261 7764 6174  t=" + str(rawdat
-00002cf0: 616f 7574 7075 7429 290d 0a0d 0a20 2020  aoutput))....   
-00002d00: 2076 616c 3d6c 6f6f 702e 7275 6e5f 756e   val=loop.run_un
-00002d10: 7469 6c5f 636f 6d70 6c65 7465 2874 6370  til_complete(tcp
-00002d20: 5f65 6368 6f5f 636c 6965 6e74 7669 7065  _echo_clientvipe
-00002d30: 7228 7661 6c75 652c 206c 6f6f 702c 686f  r(value, loop,ho
-00002d40: 7374 2c70 6f72 742c 6d69 6372 6f73 6572  st,port,microser
-00002d50: 7669 6365 6964 2c61 7379 6e63 7469 6d65  viceid,asynctime
-00002d60: 6f75 7429 290d 0a0d 0a20 2020 2069 6620  out))....    if 
-00002d70: 636f 6e6e 6563 7469 6f6e 6572 726f 723a  connectionerror:
-00002d80: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
-00002d90: 6e20 636f 6e6e 6563 7469 6f6e 6572 726f  n connectionerro
-00002da0: 720d 0a0d 0a20 2020 2072 6574 7572 6e20  r....    return 
-00002db0: 7661 6c0d 0a0d 0a64 6566 2076 6970 6572  val....def viper
-00002dc0: 7374 7265 616d 7175 6572 7928 7669 7065  streamquery(vipe
-00002dd0: 7274 6f6b 656e 2c68 6f73 742c 706f 7274  rtoken,host,port
-00002de0: 2c74 6f70 6963 2c70 726f 6475 6365 7269  ,topic,produceri
-00002df0: 642c 6f66 6673 6574 3d2d 312c 6d61 7872  d,offset=-1,maxr
-00002e00: 6f77 733d 302c 656e 6162 6c65 746c 733d  ows=0,enabletls=
-00002e10: 312c 6465 6c61 793d 3130 302c 6272 6f6b  1,delay=100,brok
-00002e20: 6572 686f 7374 3d27 272c 0d0a 2020 2020  erhost='',..    
+00002890: 2020 2020 2020 2020 2020 2020 2020 7768                wh
+000028a0: 6572 6563 6f6e 6469 7469 6f6e 3d27 272c  erecondition='',
+000028b0: 7768 6572 6573 6561 7263 686b 6579 3d27  wheresearchkey='
+000028c0: 5072 6570 726f 6365 7373 4964 656e 7469  PreprocessIdenti
+000028d0: 6669 6572 272c 7261 7764 6174 616f 7574  fier',rawdataout
+000028e0: 7075 743d 3129 3a0d 0a20 2020 2067 6c6f  put=1):..    glo
+000028f0: 6261 6c20 636f 6e6e 6563 7469 6f6e 6572  bal connectioner
+00002900: 726f 720d 0a0d 0a20 2020 2069 6620 6c65  ror....    if le
+00002910: 6e28 686f 7374 293d 3d30 206f 7220 6c65  n(host)==0 or le
+00002920: 6e28 7669 7065 7274 6f6b 656e 293d 3d30  n(vipertoken)==0
+00002930: 206f 7220 706f 7274 3d3d 2d39 3939 206f   or port==-999 o
+00002940: 7220 6c65 6e28 746f 7069 6329 3d3d 3020  r len(topic)==0 
+00002950: 6f72 206c 656e 2870 726f 6475 6365 7269  or len(produceri
+00002960: 6429 3d3d 3020 6f72 206c 656e 2873 7472  d)==0 or len(str
+00002970: 6561 6d73 746f 6a6f 696e 293d 3d30 206f  eamstojoin)==0 o
+00002980: 7220 6c65 6e28 7072 6570 726f 6365 7373  r len(preprocess
+00002990: 636f 6e64 6974 696f 6e73 293d 3d30 3a0d  conditions)==0:.
+000029a0: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
+000029b0: 2022 506c 6561 7365 2065 6e74 6572 2068   "Please enter h
+000029c0: 6f73 742c 706f 7274 2c76 6970 6572 746f  ost,port,viperto
+000029d0: 6b65 6e2c 746f 7069 632c 2070 726f 6475  ken,topic, produ
+000029e0: 6365 7269 642c 2073 7472 6561 6d73 746f  cerid, streamsto
+000029f0: 6a6f 696e 2c20 7072 6570 726f 6365 7373  join, preprocess
+00002a00: 636f 6e64 6974 696f 6e73 220d 0a20 2020  conditions"..   
+00002a10: 200d 0a20 2020 2076 616c 7565 3d28 2273   ..    value=("s
+00002a20: 7472 6561 6d71 7565 7279 6261 7463 683f  treamquerybatch?
+00002a30: 7669 7065 7274 6f6b 656e 3d22 2b76 6970  vipertoken="+vip
+00002a40: 6572 746f 6b65 6e20 2b20 2226 746f 7069  ertoken + "&topi
+00002a50: 636e 616d 653d 222b 746f 7069 6320 2b20  cname="+topic + 
+00002a60: 2226 7072 6f64 7563 6572 6964 3d22 202b  "&producerid=" +
+00002a70: 2070 726f 6475 6365 7269 6420 2b20 2226   producerid + "&
+00002a80: 6f66 6673 6574 3d22 202b 2073 7472 286f  offset=" + str(o
+00002a90: 6666 7365 7429 0d0a 2020 2020 2020 2020  ffset)..        
+00002aa0: 2020 202b 2022 266d 6178 726f 7773 3d22     + "&maxrows="
+00002ab0: 202b 2073 7472 286d 6178 726f 7773 2920   + str(maxrows) 
+00002ac0: 2b20 2226 6465 6c61 793d 2220 2b20 7374  + "&delay=" + st
+00002ad0: 7228 6465 6c61 7929 202b 2020 2226 656e  r(delay) +  "&en
+00002ae0: 6162 6c65 746c 733d 222b 7374 7228 656e  abletls="+str(en
+00002af0: 6162 6c65 746c 7329 0d0a 2020 2020 2020  abletls)..      
+00002b00: 2020 2020 202b 2022 2662 726f 6b65 7268       + "&brokerh
+00002b10: 6f73 743d 222b 6272 6f6b 6572 686f 7374  ost="+brokerhost
+00002b20: 2b22 2662 726f 6b65 7270 6f72 743d 222b  +"&brokerport="+
+00002b30: 7374 7228 6272 6f6b 6572 706f 7274 2920  str(brokerport) 
+00002b40: 2b20 2226 7374 7265 616d 7374 6f6a 6f69  + "&streamstojoi
+00002b50: 6e3d 222b 7374 7265 616d 7374 6f6a 6f69  n="+streamstojoi
+00002b60: 6e20 2b20 2226 746f 7069 6369 643d 2220  n + "&topicid=" 
+00002b70: 2b20 746f 7069 6369 6420 0d0a 2020 2020  + topicid ..    
+00002b80: 2020 2020 2020 202b 2022 2669 6465 6e74         + "&ident
+00002b90: 6966 6965 723d 2220 2b20 6964 656e 7469  ifier=" + identi
+00002ba0: 6669 6572 202b 2022 2670 7265 7072 6f63  fier + "&preproc
+00002bb0: 6573 7374 6f70 6963 3d22 202b 2073 7472  esstopic=" + str
+00002bc0: 2870 7265 7072 6f63 6573 7374 6f70 6963  (preprocesstopic
+00002bd0: 2920 2b20 2022 2664 6573 6372 6970 7469  ) +  "&descripti
+00002be0: 6f6e 3d22 202b 2073 7472 2864 6573 6372  on=" + str(descr
+00002bf0: 6970 7469 6f6e 290d 0a20 2020 2020 2020  iption)..       
+00002c00: 2020 2020 2b20 2226 7072 6570 726f 6365      + "&preproce
+00002c10: 7373 636f 6e64 6974 696f 6e73 3d22 202b  ssconditions=" +
+00002c20: 2070 7265 7072 6f63 6573 7363 6f6e 6469   preprocesscondi
+00002c30: 7469 6f6e 7320 2b20 2226 6172 7261 793d  tions + "&array=
+00002c40: 2220 2b20 7374 7228 6172 7261 7929 2b20  " + str(array)+ 
+00002c50: 2226 7469 6d65 6465 6c61 793d 2220 2b20  "&timedelay=" + 
+00002c60: 7374 7228 7469 6d65 6465 6c61 7929 2b20  str(timedelay)+ 
+00002c70: 2226 7768 6572 6563 6f6e 6469 7469 6f6e  "&wherecondition
+00002c80: 3d22 202b 2077 6865 7265 636f 6e64 6974  =" + wherecondit
+00002c90: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
+00002ca0: 2b20 2226 7768 6572 6573 6561 7263 686b  + "&wheresearchk
+00002cb0: 6579 3d22 202b 2077 6865 7265 7365 6172  ey=" + wheresear
+00002cc0: 6368 6b65 7920 2b20 2226 7261 7764 6174  chkey + "&rawdat
+00002cd0: 616f 7574 7075 743d 2220 2b20 7374 7228  aoutput=" + str(
+00002ce0: 7261 7764 6174 616f 7574 7075 7429 290d  rawdataoutput)).
+00002cf0: 0a0d 0a20 2020 2076 616c 3d6c 6f6f 702e  ...    val=loop.
+00002d00: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
+00002d10: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
+00002d20: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
+00002d30: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
+00002d40: 6372 6f73 6572 7669 6365 6964 2c61 7379  croserviceid,asy
+00002d50: 6e63 7469 6d65 6f75 7429 290d 0a0d 0a20  nctimeout)).... 
+00002d60: 2020 2069 6620 636f 6e6e 6563 7469 6f6e     if connection
+00002d70: 6572 726f 723a 0d0a 2020 2020 2020 2020  error:..        
+00002d80: 2072 6574 7572 6e20 636f 6e6e 6563 7469   return connecti
+00002d90: 6f6e 6572 726f 720d 0a0d 0a20 2020 2072  onerror....    r
+00002da0: 6574 7572 6e20 7661 6c0d 0a0d 0a64 6566  eturn val....def
+00002db0: 2076 6970 6572 7374 7265 616d 7175 6572   viperstreamquer
+00002dc0: 7928 7669 7065 7274 6f6b 656e 2c68 6f73  y(vipertoken,hos
+00002dd0: 742c 706f 7274 2c74 6f70 6963 2c70 726f  t,port,topic,pro
+00002de0: 6475 6365 7269 642c 6f66 6673 6574 3d2d  ducerid,offset=-
+00002df0: 312c 6d61 7872 6f77 733d 302c 656e 6162  1,maxrows=0,enab
+00002e00: 6c65 746c 733d 312c 6465 6c61 793d 3130  letls=1,delay=10
+00002e10: 302c 6272 6f6b 6572 686f 7374 3d27 272c  0,brokerhost='',
+00002e20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00002e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e50: 2020 2020 2020 6272 6f6b 6572 706f 7274        brokerport
-00002e60: 3d2d 3939 392c 6d69 6372 6f73 6572 7669  =-999,microservi
-00002e70: 6365 6964 3d27 272c 746f 7069 6369 643d  ceid='',topicid=
-00002e80: 2d39 3939 2c73 7472 6561 6d73 746f 6a6f  -999,streamstojo
-00002e90: 696e 3d27 272c 7072 6570 726f 6365 7373  in='',preprocess
-00002ea0: 636f 6e64 6974 696f 6e73 3d27 272c 0d0a  conditions='',..
+00002e40: 2020 2020 2020 2020 2020 2020 6272 6f6b              brok
+00002e50: 6572 706f 7274 3d2d 3939 392c 6d69 6372  erport=-999,micr
+00002e60: 6f73 6572 7669 6365 6964 3d27 272c 746f  oserviceid='',to
+00002e70: 7069 6369 643d 2d39 3939 2c73 7472 6561  picid=-999,strea
+00002e80: 6d73 746f 6a6f 696e 3d27 272c 7072 6570  mstojoin='',prep
+00002e90: 726f 6365 7373 636f 6e64 6974 696f 6e73  rocessconditions
+00002ea0: 3d27 272c 0d0a 2020 2020 2020 2020 2020  ='',..          
 00002eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00002ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ed0: 2020 2020 2020 2020 2020 6964 656e 7469            identi
-00002ee0: 6669 6572 3d27 272c 7072 6570 726f 6365  fier='',preproce
-00002ef0: 7373 746f 7069 633d 2727 2c64 6573 6372  sstopic='',descr
-00002f00: 6970 7469 6f6e 3d27 272c 6172 7261 793d  iption='',array=
-00002f10: 302c 2077 6865 7265 636f 6e64 6974 696f  0, whereconditio
-00002f20: 6e3d 2727 2c0d 0a20 2020 2020 2020 2020  n='',..         
+00002ed0: 6964 656e 7469 6669 6572 3d27 272c 7072  identifier='',pr
+00002ee0: 6570 726f 6365 7373 746f 7069 633d 2727  eprocesstopic=''
+00002ef0: 2c64 6573 6372 6970 7469 6f6e 3d27 272c  ,description='',
+00002f00: 6172 7261 793d 302c 2077 6865 7265 636f  array=0, whereco
+00002f10: 6e64 6974 696f 6e3d 2727 2c0d 0a20 2020  ndition='',..   
+00002f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00002f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f50: 2077 6865 7265 7365 6172 6368 6b65 793d   wheresearchkey=
-00002f60: 2750 7265 7072 6f63 6573 7349 6465 6e74  'PreprocessIdent
-00002f70: 6966 6965 7227 2c72 6177 6461 7461 6f75  ifier',rawdataou
-00002f80: 7470 7574 3d31 293a 0d0a 2020 2020 676c  tput=1):..    gl
-00002f90: 6f62 616c 2063 6f6e 6e65 6374 696f 6e65  obal connectione
-00002fa0: 7272 6f72 0d0a 0d0a 2020 2020 6966 206c  rror....    if l
-00002fb0: 656e 2868 6f73 7429 3d3d 3020 6f72 206c  en(host)==0 or l
-00002fc0: 656e 2876 6970 6572 746f 6b65 6e29 3d3d  en(vipertoken)==
-00002fd0: 3020 6f72 2070 6f72 743d 3d2d 3939 3920  0 or port==-999 
-00002fe0: 6f72 206c 656e 2874 6f70 6963 293d 3d30  or len(topic)==0
-00002ff0: 206f 7220 6c65 6e28 7072 6f64 7563 6572   or len(producer
-00003000: 6964 293d 3d30 206f 7220 6c65 6e28 7374  id)==0 or len(st
-00003010: 7265 616d 7374 6f6a 6f69 6e29 3d3d 3020  reamstojoin)==0 
-00003020: 6f72 206c 656e 2870 7265 7072 6f63 6573  or len(preproces
-00003030: 7363 6f6e 6469 7469 6f6e 7329 3d3d 303a  sconditions)==0:
-00003040: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
-00003050: 6e20 2250 6c65 6173 6520 656e 7465 7220  n "Please enter 
-00003060: 686f 7374 2c70 6f72 742c 7669 7065 7274  host,port,vipert
-00003070: 6f6b 656e 2c74 6f70 6963 2c20 7072 6f64  oken,topic, prod
-00003080: 7563 6572 6964 2c20 7374 7265 616d 7374  ucerid, streamst
-00003090: 6f6a 6f69 6e2c 2070 7265 7072 6f63 6573  ojoin, preproces
-000030a0: 7363 6f6e 6469 7469 6f6e 7322 0d0a 2020  sconditions"..  
-000030b0: 2020 0d0a 2020 2020 7661 6c75 653d 2822    ..    value=("
-000030c0: 7374 7265 616d 7175 6572 793f 7669 7065  streamquery?vipe
-000030d0: 7274 6f6b 656e 3d22 2b76 6970 6572 746f  rtoken="+viperto
-000030e0: 6b65 6e20 2b20 2226 746f 7069 636e 616d  ken + "&topicnam
-000030f0: 653d 222b 746f 7069 6320 2b20 2226 7072  e="+topic + "&pr
-00003100: 6f64 7563 6572 6964 3d22 202b 2070 726f  oducerid=" + pro
-00003110: 6475 6365 7269 6420 2b20 2226 6f66 6673  ducerid + "&offs
-00003120: 6574 3d22 202b 2073 7472 286f 6666 7365  et=" + str(offse
-00003130: 7429 0d0a 2020 2020 2020 2020 2020 202b  t)..           +
-00003140: 2022 266d 6178 726f 7773 3d22 202b 2073   "&maxrows=" + s
-00003150: 7472 286d 6178 726f 7773 2920 2b20 2226  tr(maxrows) + "&
-00003160: 6465 6c61 793d 2220 2b20 7374 7228 6465  delay=" + str(de
-00003170: 6c61 7929 202b 2020 2226 656e 6162 6c65  lay) +  "&enable
-00003180: 746c 733d 222b 7374 7228 656e 6162 6c65  tls="+str(enable
-00003190: 746c 7329 0d0a 2020 2020 2020 2020 2020  tls)..          
-000031a0: 202b 2022 2662 726f 6b65 7268 6f73 743d   + "&brokerhost=
-000031b0: 222b 6272 6f6b 6572 686f 7374 2b22 2662  "+brokerhost+"&b
-000031c0: 726f 6b65 7270 6f72 743d 222b 7374 7228  rokerport="+str(
-000031d0: 6272 6f6b 6572 706f 7274 2920 2b20 2226  brokerport) + "&
-000031e0: 7374 7265 616d 7374 6f6a 6f69 6e3d 222b  streamstojoin="+
-000031f0: 7374 7265 616d 7374 6f6a 6f69 6e20 2b20  streamstojoin + 
-00003200: 2226 746f 7069 6369 643d 2220 2b20 7374  "&topicid=" + st
-00003210: 7228 746f 7069 6369 6429 200d 0a20 2020  r(topicid) ..   
-00003220: 2020 2020 2020 2020 2b20 2226 6964 656e          + "&iden
-00003230: 7469 6669 6572 3d22 202b 2069 6465 6e74  tifier=" + ident
-00003240: 6966 6965 7220 2b20 2226 7072 6570 726f  ifier + "&prepro
-00003250: 6365 7373 746f 7069 633d 2220 2b20 7374  cesstopic=" + st
-00003260: 7228 7072 6570 726f 6365 7373 746f 7069  r(preprocesstopi
-00003270: 6329 202b 2020 2226 6465 7363 7269 7074  c) +  "&descript
-00003280: 696f 6e3d 2220 2b20 7374 7228 6465 7363  ion=" + str(desc
-00003290: 7269 7074 696f 6e29 0d0a 2020 2020 2020  ription)..      
-000032a0: 2020 2020 202b 2022 2670 7265 7072 6f63       + "&preproc
-000032b0: 6573 7363 6f6e 6469 7469 6f6e 733d 2220  essconditions=" 
-000032c0: 2b20 7072 6570 726f 6365 7373 636f 6e64  + preprocesscond
-000032d0: 6974 696f 6e73 202b 2022 2661 7272 6179  itions + "&array
-000032e0: 3d22 202b 2073 7472 2861 7272 6179 2920  =" + str(array) 
-000032f0: 2b20 2226 7768 6572 6563 6f6e 6469 7469  + "&whereconditi
-00003300: 6f6e 3d22 202b 2077 6865 7265 636f 6e64  on=" + wherecond
-00003310: 6974 696f 6e0d 0a20 2020 2020 2020 2020  ition..         
-00003320: 2020 2b20 2226 7768 6572 6573 6561 7263    + "&wheresearc
-00003330: 686b 6579 3d22 202b 2077 6865 7265 7365  hkey=" + wherese
-00003340: 6172 6368 6b65 7920 2b20 2226 7261 7764  archkey + "&rawd
-00003350: 6174 616f 7574 7075 743d 2220 2b20 7374  ataoutput=" + st
-00003360: 7228 7261 7764 6174 616f 7574 7075 7429  r(rawdataoutput)
-00003370: 290d 0a0d 0a20 2020 2076 616c 3d6c 6f6f  )....    val=loo
-00003380: 702e 7275 6e5f 756e 7469 6c5f 636f 6d70  p.run_until_comp
-00003390: 6c65 7465 2874 6370 5f65 6368 6f5f 636c  lete(tcp_echo_cl
-000033a0: 6965 6e74 7669 7065 7228 7661 6c75 652c  ientviper(value,
-000033b0: 206c 6f6f 702c 686f 7374 2c70 6f72 742c   loop,host,port,
-000033c0: 6d69 6372 6f73 6572 7669 6365 6964 2929  microserviceid))
-000033d0: 0d0a 0d0a 2020 2020 6966 2063 6f6e 6e65  ....    if conne
-000033e0: 6374 696f 6e65 7272 6f72 3a0d 0a20 2020  ctionerror:..   
-000033f0: 2020 2020 2020 7265 7475 726e 2063 6f6e        return con
-00003400: 6e65 6374 696f 6e65 7272 6f72 0d0a 0d0a  nectionerror....
-00003410: 2020 2020 7265 7475 726e 2076 616c 0d0a      return val..
-00003420: 0d0a 0d0a 6465 6620 7669 7065 7273 7472  ....def viperstr
-00003430: 6561 6d63 6c75 7374 6572 2876 6970 6572  eamcluster(viper
-00003440: 746f 6b65 6e2c 686f 7374 2c70 6f72 742c  token,host,port,
-00003450: 746f 7069 632c 7072 6f64 7563 6572 6964  topic,producerid
-00003460: 2c6f 6666 7365 743d 2d31 2c6d 6178 726f  ,offset=-1,maxro
-00003470: 7773 3d30 2c65 6e61 626c 6574 6c73 3d31  ws=0,enabletls=1
-00003480: 2c64 656c 6179 3d31 3030 2c62 726f 6b65  ,delay=100,broke
-00003490: 7268 6f73 743d 2727 2c0d 0a20 2020 2020  rhost='',..     
+00002f40: 2020 2020 2020 2077 6865 7265 7365 6172         wheresear
+00002f50: 6368 6b65 793d 2750 7265 7072 6f63 6573  chkey='Preproces
+00002f60: 7349 6465 6e74 6966 6965 7227 2c72 6177  sIdentifier',raw
+00002f70: 6461 7461 6f75 7470 7574 3d31 293a 0d0a  dataoutput=1):..
+00002f80: 2020 2020 676c 6f62 616c 2063 6f6e 6e65      global conne
+00002f90: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
+00002fa0: 2020 6966 206c 656e 2868 6f73 7429 3d3d    if len(host)==
+00002fb0: 3020 6f72 206c 656e 2876 6970 6572 746f  0 or len(viperto
+00002fc0: 6b65 6e29 3d3d 3020 6f72 2070 6f72 743d  ken)==0 or port=
+00002fd0: 3d2d 3939 3920 6f72 206c 656e 2874 6f70  =-999 or len(top
+00002fe0: 6963 293d 3d30 206f 7220 6c65 6e28 7072  ic)==0 or len(pr
+00002ff0: 6f64 7563 6572 6964 293d 3d30 206f 7220  oducerid)==0 or 
+00003000: 6c65 6e28 7374 7265 616d 7374 6f6a 6f69  len(streamstojoi
+00003010: 6e29 3d3d 3020 6f72 206c 656e 2870 7265  n)==0 or len(pre
+00003020: 7072 6f63 6573 7363 6f6e 6469 7469 6f6e  processcondition
+00003030: 7329 3d3d 303a 0d0a 2020 2020 2020 2020  s)==0:..        
+00003040: 2072 6574 7572 6e20 2250 6c65 6173 6520   return "Please 
+00003050: 656e 7465 7220 686f 7374 2c70 6f72 742c  enter host,port,
+00003060: 7669 7065 7274 6f6b 656e 2c74 6f70 6963  vipertoken,topic
+00003070: 2c20 7072 6f64 7563 6572 6964 2c20 7374  , producerid, st
+00003080: 7265 616d 7374 6f6a 6f69 6e2c 2070 7265  reamstojoin, pre
+00003090: 7072 6f63 6573 7363 6f6e 6469 7469 6f6e  processcondition
+000030a0: 7322 0d0a 2020 2020 0d0a 2020 2020 7661  s"..    ..    va
+000030b0: 6c75 653d 2822 7374 7265 616d 7175 6572  lue=("streamquer
+000030c0: 793f 7669 7065 7274 6f6b 656e 3d22 2b76  y?vipertoken="+v
+000030d0: 6970 6572 746f 6b65 6e20 2b20 2226 746f  ipertoken + "&to
+000030e0: 7069 636e 616d 653d 222b 746f 7069 6320  picname="+topic 
+000030f0: 2b20 2226 7072 6f64 7563 6572 6964 3d22  + "&producerid="
+00003100: 202b 2070 726f 6475 6365 7269 6420 2b20   + producerid + 
+00003110: 2226 6f66 6673 6574 3d22 202b 2073 7472  "&offset=" + str
+00003120: 286f 6666 7365 7429 0d0a 2020 2020 2020  (offset)..      
+00003130: 2020 2020 202b 2022 266d 6178 726f 7773       + "&maxrows
+00003140: 3d22 202b 2073 7472 286d 6178 726f 7773  =" + str(maxrows
+00003150: 2920 2b20 2226 6465 6c61 793d 2220 2b20  ) + "&delay=" + 
+00003160: 7374 7228 6465 6c61 7929 202b 2020 2226  str(delay) +  "&
+00003170: 656e 6162 6c65 746c 733d 222b 7374 7228  enabletls="+str(
+00003180: 656e 6162 6c65 746c 7329 0d0a 2020 2020  enabletls)..    
+00003190: 2020 2020 2020 202b 2022 2662 726f 6b65         + "&broke
+000031a0: 7268 6f73 743d 222b 6272 6f6b 6572 686f  rhost="+brokerho
+000031b0: 7374 2b22 2662 726f 6b65 7270 6f72 743d  st+"&brokerport=
+000031c0: 222b 7374 7228 6272 6f6b 6572 706f 7274  "+str(brokerport
+000031d0: 2920 2b20 2226 7374 7265 616d 7374 6f6a  ) + "&streamstoj
+000031e0: 6f69 6e3d 222b 7374 7265 616d 7374 6f6a  oin="+streamstoj
+000031f0: 6f69 6e20 2b20 2226 746f 7069 6369 643d  oin + "&topicid=
+00003200: 2220 2b20 7374 7228 746f 7069 6369 6429  " + str(topicid)
+00003210: 200d 0a20 2020 2020 2020 2020 2020 2b20   ..           + 
+00003220: 2226 6964 656e 7469 6669 6572 3d22 202b  "&identifier=" +
+00003230: 2069 6465 6e74 6966 6965 7220 2b20 2226   identifier + "&
+00003240: 7072 6570 726f 6365 7373 746f 7069 633d  preprocesstopic=
+00003250: 2220 2b20 7374 7228 7072 6570 726f 6365  " + str(preproce
+00003260: 7373 746f 7069 6329 202b 2020 2226 6465  sstopic) +  "&de
+00003270: 7363 7269 7074 696f 6e3d 2220 2b20 7374  scription=" + st
+00003280: 7228 6465 7363 7269 7074 696f 6e29 0d0a  r(description)..
+00003290: 2020 2020 2020 2020 2020 202b 2022 2670             + "&p
+000032a0: 7265 7072 6f63 6573 7363 6f6e 6469 7469  reprocessconditi
+000032b0: 6f6e 733d 2220 2b20 7072 6570 726f 6365  ons=" + preproce
+000032c0: 7373 636f 6e64 6974 696f 6e73 202b 2022  ssconditions + "
+000032d0: 2661 7272 6179 3d22 202b 2073 7472 2861  &array=" + str(a
+000032e0: 7272 6179 2920 2b20 2226 7768 6572 6563  rray) + "&wherec
+000032f0: 6f6e 6469 7469 6f6e 3d22 202b 2077 6865  ondition=" + whe
+00003300: 7265 636f 6e64 6974 696f 6e0d 0a20 2020  recondition..   
+00003310: 2020 2020 2020 2020 2b20 2226 7768 6572          + "&wher
+00003320: 6573 6561 7263 686b 6579 3d22 202b 2077  esearchkey=" + w
+00003330: 6865 7265 7365 6172 6368 6b65 7920 2b20  heresearchkey + 
+00003340: 2226 7261 7764 6174 616f 7574 7075 743d  "&rawdataoutput=
+00003350: 2220 2b20 7374 7228 7261 7764 6174 616f  " + str(rawdatao
+00003360: 7574 7075 7429 290d 0a0d 0a20 2020 2076  utput))....    v
+00003370: 616c 3d6c 6f6f 702e 7275 6e5f 756e 7469  al=loop.run_unti
+00003380: 6c5f 636f 6d70 6c65 7465 2874 6370 5f65  l_complete(tcp_e
+00003390: 6368 6f5f 636c 6965 6e74 7669 7065 7228  cho_clientviper(
+000033a0: 7661 6c75 652c 206c 6f6f 702c 686f 7374  value, loop,host
+000033b0: 2c70 6f72 742c 6d69 6372 6f73 6572 7669  ,port,microservi
+000033c0: 6365 6964 2929 0d0a 0d0a 2020 2020 6966  ceid))....    if
+000033d0: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
+000033e0: 3a0d 0a20 2020 2020 2020 2020 7265 7475  :..         retu
+000033f0: 726e 2063 6f6e 6e65 6374 696f 6e65 7272  rn connectionerr
+00003400: 6f72 0d0a 0d0a 2020 2020 7265 7475 726e  or....    return
+00003410: 2076 616c 0d0a 0d0a 0d0a 6465 6620 7669   val......def vi
+00003420: 7065 7273 7472 6561 6d63 6c75 7374 6572  perstreamcluster
+00003430: 2876 6970 6572 746f 6b65 6e2c 686f 7374  (vipertoken,host
+00003440: 2c70 6f72 742c 746f 7069 632c 7072 6f64  ,port,topic,prod
+00003450: 7563 6572 6964 2c6f 6666 7365 743d 2d31  ucerid,offset=-1
+00003460: 2c6d 6178 726f 7773 3d30 2c65 6e61 626c  ,maxrows=0,enabl
+00003470: 6574 6c73 3d31 2c64 656c 6179 3d31 3030  etls=1,delay=100
+00003480: 2c62 726f 6b65 7268 6f73 743d 2727 2c0d  ,brokerhost='',.
+00003490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000034a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000034b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000034c0: 2020 2020 2062 726f 6b65 7270 6f72 743d       brokerport=
-000034d0: 2d39 3939 2c6d 6963 726f 7365 7276 6963  -999,microservic
-000034e0: 6569 643d 2727 2c74 6f70 6963 6964 3d2d  eid='',topicid=-
-000034f0: 3939 392c 6974 6572 6174 696f 6e73 3d31  999,iterations=1
-00003500: 3030 302c 206e 756d 636c 7573 7465 7273  000, numclusters
-00003510: 3d38 2c0d 0a20 2020 2020 2020 2020 2020  =8,..           
+000034b0: 2020 2020 2020 2020 2020 2062 726f 6b65             broke
+000034c0: 7270 6f72 743d 2d39 3939 2c6d 6963 726f  rport=-999,micro
+000034d0: 7365 7276 6963 6569 643d 2727 2c74 6f70  serviceid='',top
+000034e0: 6963 6964 3d2d 3939 392c 6974 6572 6174  icid=-999,iterat
+000034f0: 696f 6e73 3d31 3030 302c 206e 756d 636c  ions=1000, numcl
+00003500: 7573 7465 7273 3d38 2c0d 0a20 2020 2020  usters=8,..     
+00003510: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00003520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003530: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00003540: 6973 7461 6e63 6561 6c67 6f3d 312c 6465  istancealgo=1,de
-00003550: 7363 7269 7074 696f 6e3d 2727 2c72 6177  scription='',raw
-00003560: 6461 7461 6f75 7470 7574 3d30 2c76 616c  dataoutput=0,val
-00003570: 7565 6b65 793d 2727 2c66 696c 7465 726b  uekey='',filterk
-00003580: 6579 3d27 272c 6772 6f75 706b 6579 3d27  ey='',groupkey='
-00003590: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
+00003530: 2020 2020 2064 6973 7461 6e63 6561 6c67       distancealg
+00003540: 6f3d 312c 6465 7363 7269 7074 696f 6e3d  o=1,description=
+00003550: 2727 2c72 6177 6461 7461 6f75 7470 7574  '',rawdataoutput
+00003560: 3d30 2c76 616c 7565 6b65 793d 2727 2c66  =0,valuekey='',f
+00003570: 696c 7465 726b 6579 3d27 272c 6772 6f75  ilterkey='',grou
+00003580: 706b 6579 3d27 272c 0d0a 2020 2020 2020  pkey='',..      
+00003590: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000035a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000035b0: 2020 2020 2020 2020 2020 2020 2020 6964                id
-000035c0: 656e 7469 6669 6572 3d27 272c 6461 7465  entifier='',date
-000035d0: 7469 6d65 6b65 793d 2727 2c76 616c 7565  timekey='',value
-000035e0: 6964 656e 7469 6669 6572 3d27 272c 6d73  identifier='',ms
-000035f0: 6769 643d 2727 2c76 616c 7565 636f 6e64  gid='',valuecond
-00003600: 6974 696f 6e3d 2727 2c0d 0a20 2020 2020  ition='',..     
+000035b0: 2020 2020 6964 656e 7469 6669 6572 3d27      identifier='
+000035c0: 272c 6461 7465 7469 6d65 6b65 793d 2727  ',datetimekey=''
+000035d0: 2c76 616c 7565 6964 656e 7469 6669 6572  ,valueidentifier
+000035e0: 3d27 272c 6d73 6769 643d 2727 2c76 616c  ='',msgid='',val
+000035f0: 7565 636f 6e64 6974 696f 6e3d 2727 2c0d  uecondition='',.
+00003600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00003610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003630: 2020 2020 2069 6465 6e74 6966 6965 7265       identifiere
-00003640: 7874 7261 6374 706f 733d 2727 2c70 7265  xtractpos='',pre
-00003650: 7072 6f63 6573 7374 6f70 6963 3d27 272c  processtopic='',
-00003660: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003620: 2020 2020 2020 2020 2020 2069 6465 6e74             ident
+00003630: 6966 6965 7265 7874 7261 6374 706f 733d  ifierextractpos=
+00003640: 2727 2c70 7265 7072 6f63 6573 7374 6f70  '',preprocesstop
+00003650: 6963 3d27 272c 0d0a 2020 2020 2020 2020  ic='',..        
+00003660: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00003670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003680: 2020 2020 2020 2020 2020 2020 616c 6572              aler
-00003690: 746f 6e63 6c75 7374 6572 7369 7a65 3d30  tonclustersize=0
-000036a0: 2c61 6c65 7274 6f6e 7375 626a 6563 7470  ,alertonsubjectp
-000036b0: 6572 6365 6e74 6167 653d 3530 2c73 656e  ercentage=50,sen
-000036c0: 6461 6c65 7274 656d 6169 6c73 746f 3d27  dalertemailsto='
-000036d0: 272c 656d 6169 6c66 7265 7175 656e 6379  ',emailfrequency
-000036e0: 696e 7365 636f 6e64 733d 302c 0d0a 2020  inseconds=0,..  
+00003680: 2020 616c 6572 746f 6e63 6c75 7374 6572    alertoncluster
+00003690: 7369 7a65 3d30 2c61 6c65 7274 6f6e 7375  size=0,alertonsu
+000036a0: 626a 6563 7470 6572 6365 6e74 6167 653d  bjectpercentage=
+000036b0: 3530 2c73 656e 6461 6c65 7274 656d 6169  50,sendalertemai
+000036c0: 6c73 746f 3d27 272c 656d 6169 6c66 7265  lsto='',emailfre
+000036d0: 7175 656e 6379 696e 7365 636f 6e64 733d  quencyinseconds=
+000036e0: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
 000036f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003710: 2020 2020 2020 2020 636f 6d70 616e 796e          companyn
-00003720: 616d 653d 2727 2c61 6e61 6c79 7369 7364  ame='',analysisd
-00003730: 6573 6372 6970 7469 6f6e 3d27 272c 6964  escription='',id
-00003740: 656e 7469 6669 6572 6578 7472 6163 7470  entifierextractp
-00003750: 6f73 6c61 7469 7475 6465 3d2d 312c 0d0a  oslatitude=-1,..
+00003700: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00003710: 6d70 616e 796e 616d 653d 2727 2c61 6e61  mpanyname='',ana
+00003720: 6c79 7369 7364 6573 6372 6970 7469 6f6e  lysisdescription
+00003730: 3d27 272c 6964 656e 7469 6669 6572 6578  ='',identifierex
+00003740: 7472 6163 7470 6f73 6c61 7469 7475 6465  tractposlatitude
+00003750: 3d2d 312c 0d0a 2020 2020 2020 2020 2020  =-1,..          
 00003760: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00003770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003780: 2020 2020 2020 2020 2020 6964 656e 7469            identi
-00003790: 6669 6572 6578 7472 6163 7470 6f73 6c6f  fierextractposlo
-000037a0: 6e67 6974 7564 653d 2d31 2c69 6465 6e74  ngitude=-1,ident
-000037b0: 6966 6965 7265 7874 7261 6374 706f 736c  ifierextractposl
-000037c0: 6f63 6174 696f 6e3d 2d31 2c0d 0a20 2020  ocation=-1,..   
+00003780: 6964 656e 7469 6669 6572 6578 7472 6163  identifierextrac
+00003790: 7470 6f73 6c6f 6e67 6974 7564 653d 2d31  tposlongitude=-1
+000037a0: 2c69 6465 6e74 6966 6965 7265 7874 7261  ,identifierextra
+000037b0: 6374 706f 736c 6f63 6174 696f 6e3d 2d31  ctposlocation=-1
+000037c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
 000037d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000037e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000037f0: 2020 2020 2020 2069 6465 6e74 6966 6965         identifie
-00003800: 7265 7874 7261 6374 6a6f 696e 6564 6964  rextractjoinedid
-00003810: 656e 7469 6669 6572 733d 2d31 2c70 6466  entifiers=-1,pdf
-00003820: 666f 726d 6174 3d27 272c 6d69 6e69 6d75  format='',minimu
-00003830: 6d73 7562 6a65 6374 733d 3229 3a0d 0a0d  msubjects=2):...
-00003840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000037e0: 2020 2020 2020 2020 2020 2020 2069 6465               ide
+000037f0: 6e74 6966 6965 7265 7874 7261 6374 6a6f  ntifierextractjo
+00003800: 696e 6564 6964 656e 7469 6669 6572 733d  inedidentifiers=
+00003810: 2d31 2c70 6466 666f 726d 6174 3d27 272c  -1,pdfformat='',
+00003820: 6d69 6e69 6d75 6d73 7562 6a65 6374 733d  minimumsubjects=
+00003830: 3229 3a0d 0a0d 0a20 2020 2020 2020 2020  2):....         
+00003840: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00003850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003860: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00003870: 2067 6c6f 6261 6c20 636f 6e6e 6563 7469   global connecti
-00003880: 6f6e 6572 726f 720d 0a0d 0a20 2020 2069  onerror....    i
-00003890: 6620 6c65 6e28 686f 7374 293d 3d30 206f  f len(host)==0 o
-000038a0: 7220 6c65 6e28 7669 7065 7274 6f6b 656e  r len(vipertoken
-000038b0: 293d 3d30 206f 7220 706f 7274 3d3d 2d39  )==0 or port==-9
-000038c0: 3939 206f 7220 6c65 6e28 746f 7069 6329  99 or len(topic)
-000038d0: 3d3d 3020 206f 7220 6c65 6e28 7661 6c75  ==0  or len(valu
-000038e0: 656b 6579 293d 3d30 206f 7220 6c65 6e28  ekey)==0 or len(
-000038f0: 6d73 6769 6429 3d3d 3020 6f72 206c 656e  msgid)==0 or len
-00003900: 2864 6174 6574 696d 656b 6579 293d 3d30  (datetimekey)==0
-00003910: 3a0d 0a20 2020 2020 2020 2020 7265 7475  :..         retu
-00003920: 726e 2022 506c 6561 7365 2065 6e74 6572  rn "Please enter
-00003930: 2068 6f73 742c 706f 7274 2c76 6970 6572   host,port,viper
-00003940: 746f 6b65 6e2c 746f 7069 632c 7661 6c75  token,topic,valu
-00003950: 656b 6579 2c20 6d73 6769 642c 6461 7465  ekey, msgid,date
-00003960: 7469 6d65 6b65 7922 0d0a 2020 2020 0d0a  timekey"..    ..
-00003970: 2020 2020 7661 6c75 653d 2822 7374 7265      value=("stre
-00003980: 616d 636c 7573 7465 723f 7669 7065 7274  amcluster?vipert
-00003990: 6f6b 656e 3d22 2b76 6970 6572 746f 6b65  oken="+vipertoke
-000039a0: 6e20 2b20 2226 746f 7069 636e 616d 653d  n + "&topicname=
-000039b0: 222b 746f 7069 6320 2b20 2226 7072 6f64  "+topic + "&prod
-000039c0: 7563 6572 6964 3d22 202b 2070 726f 6475  ucerid=" + produ
-000039d0: 6365 7269 6420 2b20 2226 6f66 6673 6574  cerid + "&offset
-000039e0: 3d22 202b 2073 7472 286f 6666 7365 7429  =" + str(offset)
-000039f0: 0d0a 2020 2020 2020 2020 2020 202b 2022  ..           + "
-00003a00: 266d 6178 726f 7773 3d22 202b 2073 7472  &maxrows=" + str
-00003a10: 286d 6178 726f 7773 2920 2b20 2226 6465  (maxrows) + "&de
-00003a20: 6c61 793d 2220 2b20 7374 7228 6465 6c61  lay=" + str(dela
-00003a30: 7929 202b 2020 2226 656e 6162 6c65 746c  y) +  "&enabletl
-00003a40: 733d 222b 7374 7228 656e 6162 6c65 746c  s="+str(enabletl
-00003a50: 7329 0d0a 2020 2020 2020 2020 2020 202b  s)..           +
-00003a60: 2022 2662 726f 6b65 7268 6f73 743d 222b   "&brokerhost="+
-00003a70: 6272 6f6b 6572 686f 7374 2b22 2662 726f  brokerhost+"&bro
-00003a80: 6b65 7270 6f72 743d 222b 7374 7228 6272  kerport="+str(br
-00003a90: 6f6b 6572 706f 7274 2920 2b20 2226 6974  okerport) + "&it
-00003aa0: 6572 6174 696f 6e73 3d22 2b20 7374 7228  erations="+ str(
-00003ab0: 6974 6572 6174 696f 6e73 2920 2b20 2226  iterations) + "&
-00003ac0: 6e75 6d63 6c75 7374 6572 733d 2220 2b20  numclusters=" + 
-00003ad0: 7374 7228 6e75 6d63 6c75 7374 6572 7329  str(numclusters)
-00003ae0: 200d 0a20 2020 2020 2020 2020 2020 2b20   ..           + 
-00003af0: 2226 6469 7374 616e 6365 616c 676f 3d22  "&distancealgo="
-00003b00: 202b 2073 7472 2864 6973 7461 6e63 6561   + str(distancea
-00003b10: 6c67 6f29 202b 2022 2672 6177 6461 7461  lgo) + "&rawdata
-00003b20: 6f75 7470 7574 3d22 202b 2073 7472 2872  output=" + str(r
-00003b30: 6177 6461 7461 6f75 7470 7574 290d 0a20  awdataoutput).. 
-00003b40: 2020 2020 2020 2020 2020 2b20 2226 7661            + "&va
-00003b50: 6c75 656b 6579 3d22 202b 2076 616c 7565  luekey=" + value
-00003b60: 6b65 7920 2b20 2226 6669 6c74 6572 6b65  key + "&filterke
-00003b70: 793d 2220 2b20 6669 6c74 6572 6b65 792b  y=" + filterkey+
-00003b80: 2022 2667 726f 7570 6b65 793d 2220 2b20   "&groupkey=" + 
-00003b90: 6772 6f75 706b 6579 2b20 2226 6964 656e  groupkey+ "&iden
-00003ba0: 7469 6669 6572 3d22 202b 2069 6465 6e74  tifier=" + ident
-00003bb0: 6966 6965 720d 0a20 2020 2020 2020 2020  ifier..         
-00003bc0: 2020 2b20 2226 6461 7465 7469 6d65 6b65    + "&datetimeke
-00003bd0: 793d 2220 2b20 6461 7465 7469 6d65 6b65  y=" + datetimeke
-00003be0: 7920 2b20 2226 7661 6c75 6569 6465 6e74  y + "&valueident
-00003bf0: 6966 6965 723d 2220 2b20 7661 6c75 6569  ifier=" + valuei
-00003c00: 6465 6e74 6966 6965 7220 2b20 2226 6d73  dentifier + "&ms
-00003c10: 6769 643d 2220 2b20 6d73 6769 640d 0a20  gid=" + msgid.. 
-00003c20: 2020 2020 2020 2020 2020 2b20 2226 7661            + "&va
-00003c30: 6c75 6563 6f6e 6469 7469 6f6e 3d22 202b  luecondition=" +
-00003c40: 2076 616c 7565 636f 6e64 6974 696f 6e20   valuecondition 
-00003c50: 2b20 2226 6964 656e 7469 6669 6572 6578  + "&identifierex
-00003c60: 7472 6163 7470 6f73 3d22 202b 2069 6465  tractpos=" + ide
-00003c70: 6e74 6966 6965 7265 7874 7261 6374 706f  ntifierextractpo
-00003c80: 730d 0a20 2020 2020 2020 2020 2020 2b20  s..           + 
-00003c90: 2226 616c 6572 746f 6e63 6c75 7374 6572  "&alertoncluster
-00003ca0: 7369 7a65 3d22 202b 2073 7472 2861 6c65  size=" + str(ale
-00003cb0: 7274 6f6e 636c 7573 7465 7273 697a 6529  rtonclustersize)
-00003cc0: 202b 2226 7365 6e64 616c 6572 7465 6d61   +"&sendalertema
-00003cd0: 696c 7374 6f3d 2220 2b20 7365 6e64 616c  ilsto=" + sendal
-00003ce0: 6572 7465 6d61 696c 7374 6f0d 0a20 2020  ertemailsto..   
-00003cf0: 2020 2020 2020 2020 2b20 2226 656d 6169          + "&emai
-00003d00: 6c66 7265 7175 656e 6379 696e 7365 636f  lfrequencyinseco
-00003d10: 6e64 733d 2220 2b20 7374 7228 656d 6169  nds=" + str(emai
-00003d20: 6c66 7265 7175 656e 6379 696e 7365 636f  lfrequencyinseco
-00003d30: 6e64 7329 0d0a 2020 2020 2020 2020 2020  nds)..          
-00003d40: 202b 2022 2670 7265 7072 6f63 6573 7374   + "&preprocesst
-00003d50: 6f70 6963 3d22 202b 2070 7265 7072 6f63  opic=" + preproc
-00003d60: 6573 7374 6f70 6963 202b 2022 2663 6f6d  esstopic + "&com
-00003d70: 7061 6e79 6e61 6d65 3d22 202b 2063 6f6d  panyname=" + com
-00003d80: 7061 6e79 6e61 6d65 0d0a 2020 2020 2020  panyname..      
-00003d90: 2020 2020 202b 2022 2664 6573 6372 6970       + "&descrip
-00003da0: 7469 6f6e 3d22 202b 2064 6573 6372 6970  tion=" + descrip
-00003db0: 7469 6f6e 202b 2022 2661 6e61 6c79 7369  tion + "&analysi
-00003dc0: 7364 6573 6372 6970 7469 6f6e 3d22 202b  sdescription=" +
-00003dd0: 2061 6e61 6c79 7369 7364 6573 6372 6970   analysisdescrip
-00003de0: 7469 6f6e 0d0a 2020 2020 2020 2020 2020  tion..          
-00003df0: 202b 2022 2669 6465 6e74 6966 6965 7265   + "&identifiere
-00003e00: 7874 7261 6374 706f 736c 6174 6974 7564  xtractposlatitud
-00003e10: 653d 2220 2b20 7374 7228 6964 656e 7469  e=" + str(identi
-00003e20: 6669 6572 6578 7472 6163 7470 6f73 6c61  fierextractposla
-00003e30: 7469 7475 6465 2920 2b20 2226 6964 656e  titude) + "&iden
-00003e40: 7469 6669 6572 6578 7472 6163 7470 6f73  tifierextractpos
-00003e50: 6c6f 6e67 6974 7564 653d 2220 2b20 7374  longitude=" + st
-00003e60: 7228 6964 656e 7469 6669 6572 6578 7472  r(identifierextr
-00003e70: 6163 7470 6f73 6c6f 6e67 6974 7564 6529  actposlongitude)
-00003e80: 0d0a 2020 2020 2020 2020 2020 202b 2022  ..           + "
-00003e90: 2669 6465 6e74 6966 6965 7265 7874 7261  &identifierextra
-00003ea0: 6374 706f 736c 6f63 6174 696f 6e3d 2220  ctposlocation=" 
-00003eb0: 2b20 7374 7228 6964 656e 7469 6669 6572  + str(identifier
-00003ec0: 6578 7472 6163 7470 6f73 6c6f 6361 7469  extractposlocati
-00003ed0: 6f6e 290d 0a20 2020 2020 2020 2020 2020  on)..           
-00003ee0: 2b20 2226 6964 656e 7469 6669 6572 6578  + "&identifierex
-00003ef0: 7472 6163 746a 6f69 6e65 6469 6465 6e74  tractjoinedident
-00003f00: 6966 6965 7273 3d22 202b 2073 7472 2869  ifiers=" + str(i
-00003f10: 6465 6e74 6966 6965 7265 7874 7261 6374  dentifierextract
-00003f20: 6a6f 696e 6564 6964 656e 7469 6669 6572  joinedidentifier
-00003f30: 7329 0d0a 2020 2020 2020 2020 2020 202b  s)..           +
-00003f40: 2022 2670 6466 666f 726d 6174 3d22 202b   "&pdfformat=" +
-00003f50: 2070 6466 666f 726d 6174 202b 2022 2661   pdfformat + "&a
-00003f60: 6c65 7274 6f6e 7375 626a 6563 7470 6572  lertonsubjectper
-00003f70: 6365 6e74 6167 653d 2220 2b20 7374 7228  centage=" + str(
-00003f80: 616c 6572 746f 6e73 7562 6a65 6374 7065  alertonsubjectpe
-00003f90: 7263 656e 7461 6765 2920 2b20 2226 6d69  rcentage) + "&mi
-00003fa0: 6e69 6d75 6d73 7562 6a65 6374 733d 2220  nimumsubjects=" 
-00003fb0: 2b20 7374 7228 6d69 6e69 6d75 6d73 7562  + str(minimumsub
-00003fc0: 6a65 6374 7329 290d 0a0d 0a20 2020 2076  jects))....    v
-00003fd0: 616c 3d6c 6f6f 702e 7275 6e5f 756e 7469  al=loop.run_unti
-00003fe0: 6c5f 636f 6d70 6c65 7465 2874 6370 5f65  l_complete(tcp_e
-00003ff0: 6368 6f5f 636c 6965 6e74 7669 7065 7228  cho_clientviper(
-00004000: 7661 6c75 652c 206c 6f6f 702c 686f 7374  value, loop,host
-00004010: 2c70 6f72 742c 6d69 6372 6f73 6572 7669  ,port,microservi
-00004020: 6365 6964 2929 0d0a 0d0a 2020 2020 6966  ceid))....    if
-00004030: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
-00004040: 3a0d 0a20 2020 2020 2020 2020 7265 7475  :..         retu
-00004050: 726e 2063 6f6e 6e65 6374 696f 6e65 7272  rn connectionerr
-00004060: 6f72 0d0a 0d0a 2020 2020 7265 7475 726e  or....    return
-00004070: 2076 616c 0d0a 0d0a 6465 6620 7669 7065   val....def vipe
-00004080: 7273 7472 6561 6d63 6f72 7228 7669 7065  rstreamcorr(vipe
-00004090: 7274 6f6b 656e 2c68 6f73 742c 706f 7274  rtoken,host,port
-000040a0: 2c74 6f70 6963 2c70 726f 6475 6365 7269  ,topic,produceri
-000040b0: 642c 6f66 6673 6574 3d2d 312c 6d61 7872  d,offset=-1,maxr
-000040c0: 6f77 733d 302c 656e 6162 6c65 746c 733d  ows=0,enabletls=
-000040d0: 312c 6465 6c61 793d 3130 302c 6272 6f6b  1,delay=100,brok
-000040e0: 6572 686f 7374 3d27 272c 0d0a 2020 2020  erhost='',..    
+00003860: 200d 0a20 2020 2067 6c6f 6261 6c20 636f   ..    global co
+00003870: 6e6e 6563 7469 6f6e 6572 726f 720d 0a0d  nnectionerror...
+00003880: 0a20 2020 2069 6620 6c65 6e28 686f 7374  .    if len(host
+00003890: 293d 3d30 206f 7220 6c65 6e28 7669 7065  )==0 or len(vipe
+000038a0: 7274 6f6b 656e 293d 3d30 206f 7220 706f  rtoken)==0 or po
+000038b0: 7274 3d3d 2d39 3939 206f 7220 6c65 6e28  rt==-999 or len(
+000038c0: 746f 7069 6329 3d3d 3020 206f 7220 6c65  topic)==0  or le
+000038d0: 6e28 7661 6c75 656b 6579 293d 3d30 206f  n(valuekey)==0 o
+000038e0: 7220 6c65 6e28 6d73 6769 6429 3d3d 3020  r len(msgid)==0 
+000038f0: 6f72 206c 656e 2864 6174 6574 696d 656b  or len(datetimek
+00003900: 6579 293d 3d30 3a0d 0a20 2020 2020 2020  ey)==0:..       
+00003910: 2020 7265 7475 726e 2022 506c 6561 7365    return "Please
+00003920: 2065 6e74 6572 2068 6f73 742c 706f 7274   enter host,port
+00003930: 2c76 6970 6572 746f 6b65 6e2c 746f 7069  ,vipertoken,topi
+00003940: 632c 7661 6c75 656b 6579 2c20 6d73 6769  c,valuekey, msgi
+00003950: 642c 6461 7465 7469 6d65 6b65 7922 0d0a  d,datetimekey"..
+00003960: 2020 2020 0d0a 2020 2020 7661 6c75 653d      ..    value=
+00003970: 2822 7374 7265 616d 636c 7573 7465 723f  ("streamcluster?
+00003980: 7669 7065 7274 6f6b 656e 3d22 2b76 6970  vipertoken="+vip
+00003990: 6572 746f 6b65 6e20 2b20 2226 746f 7069  ertoken + "&topi
+000039a0: 636e 616d 653d 222b 746f 7069 6320 2b20  cname="+topic + 
+000039b0: 2226 7072 6f64 7563 6572 6964 3d22 202b  "&producerid=" +
+000039c0: 2070 726f 6475 6365 7269 6420 2b20 2226   producerid + "&
+000039d0: 6f66 6673 6574 3d22 202b 2073 7472 286f  offset=" + str(o
+000039e0: 6666 7365 7429 0d0a 2020 2020 2020 2020  ffset)..        
+000039f0: 2020 202b 2022 266d 6178 726f 7773 3d22     + "&maxrows="
+00003a00: 202b 2073 7472 286d 6178 726f 7773 2920   + str(maxrows) 
+00003a10: 2b20 2226 6465 6c61 793d 2220 2b20 7374  + "&delay=" + st
+00003a20: 7228 6465 6c61 7929 202b 2020 2226 656e  r(delay) +  "&en
+00003a30: 6162 6c65 746c 733d 222b 7374 7228 656e  abletls="+str(en
+00003a40: 6162 6c65 746c 7329 0d0a 2020 2020 2020  abletls)..      
+00003a50: 2020 2020 202b 2022 2662 726f 6b65 7268       + "&brokerh
+00003a60: 6f73 743d 222b 6272 6f6b 6572 686f 7374  ost="+brokerhost
+00003a70: 2b22 2662 726f 6b65 7270 6f72 743d 222b  +"&brokerport="+
+00003a80: 7374 7228 6272 6f6b 6572 706f 7274 2920  str(brokerport) 
+00003a90: 2b20 2226 6974 6572 6174 696f 6e73 3d22  + "&iterations="
+00003aa0: 2b20 7374 7228 6974 6572 6174 696f 6e73  + str(iterations
+00003ab0: 2920 2b20 2226 6e75 6d63 6c75 7374 6572  ) + "&numcluster
+00003ac0: 733d 2220 2b20 7374 7228 6e75 6d63 6c75  s=" + str(numclu
+00003ad0: 7374 6572 7329 200d 0a20 2020 2020 2020  sters) ..       
+00003ae0: 2020 2020 2b20 2226 6469 7374 616e 6365      + "&distance
+00003af0: 616c 676f 3d22 202b 2073 7472 2864 6973  algo=" + str(dis
+00003b00: 7461 6e63 6561 6c67 6f29 202b 2022 2672  tancealgo) + "&r
+00003b10: 6177 6461 7461 6f75 7470 7574 3d22 202b  awdataoutput=" +
+00003b20: 2073 7472 2872 6177 6461 7461 6f75 7470   str(rawdataoutp
+00003b30: 7574 290d 0a20 2020 2020 2020 2020 2020  ut)..           
+00003b40: 2b20 2226 7661 6c75 656b 6579 3d22 202b  + "&valuekey=" +
+00003b50: 2076 616c 7565 6b65 7920 2b20 2226 6669   valuekey + "&fi
+00003b60: 6c74 6572 6b65 793d 2220 2b20 6669 6c74  lterkey=" + filt
+00003b70: 6572 6b65 792b 2022 2667 726f 7570 6b65  erkey+ "&groupke
+00003b80: 793d 2220 2b20 6772 6f75 706b 6579 2b20  y=" + groupkey+ 
+00003b90: 2226 6964 656e 7469 6669 6572 3d22 202b  "&identifier=" +
+00003ba0: 2069 6465 6e74 6966 6965 720d 0a20 2020   identifier..   
+00003bb0: 2020 2020 2020 2020 2b20 2226 6461 7465          + "&date
+00003bc0: 7469 6d65 6b65 793d 2220 2b20 6461 7465  timekey=" + date
+00003bd0: 7469 6d65 6b65 7920 2b20 2226 7661 6c75  timekey + "&valu
+00003be0: 6569 6465 6e74 6966 6965 723d 2220 2b20  eidentifier=" + 
+00003bf0: 7661 6c75 6569 6465 6e74 6966 6965 7220  valueidentifier 
+00003c00: 2b20 2226 6d73 6769 643d 2220 2b20 6d73  + "&msgid=" + ms
+00003c10: 6769 640d 0a20 2020 2020 2020 2020 2020  gid..           
+00003c20: 2b20 2226 7661 6c75 6563 6f6e 6469 7469  + "&valueconditi
+00003c30: 6f6e 3d22 202b 2076 616c 7565 636f 6e64  on=" + valuecond
+00003c40: 6974 696f 6e20 2b20 2226 6964 656e 7469  ition + "&identi
+00003c50: 6669 6572 6578 7472 6163 7470 6f73 3d22  fierextractpos="
+00003c60: 202b 2069 6465 6e74 6966 6965 7265 7874   + identifierext
+00003c70: 7261 6374 706f 730d 0a20 2020 2020 2020  ractpos..       
+00003c80: 2020 2020 2b20 2226 616c 6572 746f 6e63      + "&alertonc
+00003c90: 6c75 7374 6572 7369 7a65 3d22 202b 2073  lustersize=" + s
+00003ca0: 7472 2861 6c65 7274 6f6e 636c 7573 7465  tr(alertoncluste
+00003cb0: 7273 697a 6529 202b 2226 7365 6e64 616c  rsize) +"&sendal
+00003cc0: 6572 7465 6d61 696c 7374 6f3d 2220 2b20  ertemailsto=" + 
+00003cd0: 7365 6e64 616c 6572 7465 6d61 696c 7374  sendalertemailst
+00003ce0: 6f0d 0a20 2020 2020 2020 2020 2020 2b20  o..           + 
+00003cf0: 2226 656d 6169 6c66 7265 7175 656e 6379  "&emailfrequency
+00003d00: 696e 7365 636f 6e64 733d 2220 2b20 7374  inseconds=" + st
+00003d10: 7228 656d 6169 6c66 7265 7175 656e 6379  r(emailfrequency
+00003d20: 696e 7365 636f 6e64 7329 0d0a 2020 2020  inseconds)..    
+00003d30: 2020 2020 2020 202b 2022 2670 7265 7072         + "&prepr
+00003d40: 6f63 6573 7374 6f70 6963 3d22 202b 2070  ocesstopic=" + p
+00003d50: 7265 7072 6f63 6573 7374 6f70 6963 202b  reprocesstopic +
+00003d60: 2022 2663 6f6d 7061 6e79 6e61 6d65 3d22   "&companyname="
+00003d70: 202b 2063 6f6d 7061 6e79 6e61 6d65 0d0a   + companyname..
+00003d80: 2020 2020 2020 2020 2020 202b 2022 2664             + "&d
+00003d90: 6573 6372 6970 7469 6f6e 3d22 202b 2064  escription=" + d
+00003da0: 6573 6372 6970 7469 6f6e 202b 2022 2661  escription + "&a
+00003db0: 6e61 6c79 7369 7364 6573 6372 6970 7469  nalysisdescripti
+00003dc0: 6f6e 3d22 202b 2061 6e61 6c79 7369 7364  on=" + analysisd
+00003dd0: 6573 6372 6970 7469 6f6e 0d0a 2020 2020  escription..    
+00003de0: 2020 2020 2020 202b 2022 2669 6465 6e74         + "&ident
+00003df0: 6966 6965 7265 7874 7261 6374 706f 736c  ifierextractposl
+00003e00: 6174 6974 7564 653d 2220 2b20 7374 7228  atitude=" + str(
+00003e10: 6964 656e 7469 6669 6572 6578 7472 6163  identifierextrac
+00003e20: 7470 6f73 6c61 7469 7475 6465 2920 2b20  tposlatitude) + 
+00003e30: 2226 6964 656e 7469 6669 6572 6578 7472  "&identifierextr
+00003e40: 6163 7470 6f73 6c6f 6e67 6974 7564 653d  actposlongitude=
+00003e50: 2220 2b20 7374 7228 6964 656e 7469 6669  " + str(identifi
+00003e60: 6572 6578 7472 6163 7470 6f73 6c6f 6e67  erextractposlong
+00003e70: 6974 7564 6529 0d0a 2020 2020 2020 2020  itude)..        
+00003e80: 2020 202b 2022 2669 6465 6e74 6966 6965     + "&identifie
+00003e90: 7265 7874 7261 6374 706f 736c 6f63 6174  rextractposlocat
+00003ea0: 696f 6e3d 2220 2b20 7374 7228 6964 656e  ion=" + str(iden
+00003eb0: 7469 6669 6572 6578 7472 6163 7470 6f73  tifierextractpos
+00003ec0: 6c6f 6361 7469 6f6e 290d 0a20 2020 2020  location)..     
+00003ed0: 2020 2020 2020 2b20 2226 6964 656e 7469        + "&identi
+00003ee0: 6669 6572 6578 7472 6163 746a 6f69 6e65  fierextractjoine
+00003ef0: 6469 6465 6e74 6966 6965 7273 3d22 202b  didentifiers=" +
+00003f00: 2073 7472 2869 6465 6e74 6966 6965 7265   str(identifiere
+00003f10: 7874 7261 6374 6a6f 696e 6564 6964 656e  xtractjoinediden
+00003f20: 7469 6669 6572 7329 0d0a 2020 2020 2020  tifiers)..      
+00003f30: 2020 2020 202b 2022 2670 6466 666f 726d       + "&pdfform
+00003f40: 6174 3d22 202b 2070 6466 666f 726d 6174  at=" + pdfformat
+00003f50: 202b 2022 2661 6c65 7274 6f6e 7375 626a   + "&alertonsubj
+00003f60: 6563 7470 6572 6365 6e74 6167 653d 2220  ectpercentage=" 
+00003f70: 2b20 7374 7228 616c 6572 746f 6e73 7562  + str(alertonsub
+00003f80: 6a65 6374 7065 7263 656e 7461 6765 2920  jectpercentage) 
+00003f90: 2b20 2226 6d69 6e69 6d75 6d73 7562 6a65  + "&minimumsubje
+00003fa0: 6374 733d 2220 2b20 7374 7228 6d69 6e69  cts=" + str(mini
+00003fb0: 6d75 6d73 7562 6a65 6374 7329 290d 0a0d  mumsubjects))...
+00003fc0: 0a20 2020 2076 616c 3d6c 6f6f 702e 7275  .    val=loop.ru
+00003fd0: 6e5f 756e 7469 6c5f 636f 6d70 6c65 7465  n_until_complete
+00003fe0: 2874 6370 5f65 6368 6f5f 636c 6965 6e74  (tcp_echo_client
+00003ff0: 7669 7065 7228 7661 6c75 652c 206c 6f6f  viper(value, loo
+00004000: 702c 686f 7374 2c70 6f72 742c 6d69 6372  p,host,port,micr
+00004010: 6f73 6572 7669 6365 6964 2929 0d0a 0d0a  oserviceid))....
+00004020: 2020 2020 6966 2063 6f6e 6e65 6374 696f      if connectio
+00004030: 6e65 7272 6f72 3a0d 0a20 2020 2020 2020  nerror:..       
+00004040: 2020 7265 7475 726e 2063 6f6e 6e65 6374    return connect
+00004050: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
+00004060: 7265 7475 726e 2076 616c 0d0a 0d0a 6465  return val....de
+00004070: 6620 7669 7065 7273 7472 6561 6d63 6f72  f viperstreamcor
+00004080: 7228 7669 7065 7274 6f6b 656e 2c68 6f73  r(vipertoken,hos
+00004090: 742c 706f 7274 2c74 6f70 6963 2c70 726f  t,port,topic,pro
+000040a0: 6475 6365 7269 642c 6f66 6673 6574 3d2d  ducerid,offset=-
+000040b0: 312c 6d61 7872 6f77 733d 302c 656e 6162  1,maxrows=0,enab
+000040c0: 6c65 746c 733d 312c 6465 6c61 793d 3130  letls=1,delay=10
+000040d0: 302c 6272 6f6b 6572 686f 7374 3d27 272c  0,brokerhost='',
+000040e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 000040f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004110: 2020 2020 2020 6272 6f6b 6572 706f 7274        brokerport
-00004120: 3d2d 3939 392c 6d69 6372 6f73 6572 7669  =-999,microservi
-00004130: 6365 6964 3d27 272c 746f 7069 6369 643d  ceid='',topicid=
-00004140: 2d39 3939 2c73 7472 6561 6d73 746f 6a6f  -999,streamstojo
-00004150: 696e 3d27 272c 0d0a 2020 2020 2020 2020  in='',..        
+00004100: 2020 2020 2020 2020 2020 2020 6272 6f6b              brok
+00004110: 6572 706f 7274 3d2d 3939 392c 6d69 6372  erport=-999,micr
+00004120: 6f73 6572 7669 6365 6964 3d27 272c 746f  oserviceid='',to
+00004130: 7069 6369 643d 2d39 3939 2c73 7472 6561  picid=-999,strea
+00004140: 6d73 746f 6a6f 696e 3d27 272c 0d0a 2020  mstojoin='',..  
+00004150: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00004160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004180: 2020 6964 656e 7469 6669 6572 3d27 272c    identifier='',
-00004190: 7072 6570 726f 6365 7373 746f 7069 633d  preprocesstopic=
-000041a0: 2727 2c64 6573 6372 6970 7469 6f6e 3d27  '',description='
-000041b0: 272c 6172 7261 793d 302c 2077 6865 7265  ',array=0, where
-000041c0: 636f 6e64 6974 696f 6e3d 2727 2c0d 0a20  condition='',.. 
+00004170: 2020 2020 2020 2020 6964 656e 7469 6669          identifi
+00004180: 6572 3d27 272c 7072 6570 726f 6365 7373  er='',preprocess
+00004190: 746f 7069 633d 2727 2c64 6573 6372 6970  topic='',descrip
+000041a0: 7469 6f6e 3d27 272c 6172 7261 793d 302c  tion='',array=0,
+000041b0: 2077 6865 7265 636f 6e64 6974 696f 6e3d   wherecondition=
+000041c0: 2727 2c0d 0a20 2020 2020 2020 2020 2020  '',..           
 000041d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000041e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000041f0: 2020 2020 2020 2020 2077 6865 7265 7365           wherese
-00004200: 6172 6368 6b65 793d 2750 7265 7072 6f63  archkey='Preproc
-00004210: 6573 7349 6465 6e74 6966 6965 7227 2c72  essIdentifier',r
-00004220: 6177 6461 7461 6f75 7470 7574 3d30 2c74  awdataoutput=0,t
-00004230: 6872 6573 6868 6f6c 643d 302c 7076 616c  hreshhold=0,pval
-00004240: 7565 3d30 2c0d 0a20 2020 2020 2020 2020  ue=0,..         
+000041e0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+000041f0: 6865 7265 7365 6172 6368 6b65 793d 2750  heresearchkey='P
+00004200: 7265 7072 6f63 6573 7349 6465 6e74 6966  reprocessIdentif
+00004210: 6965 7227 2c72 6177 6461 7461 6f75 7470  ier',rawdataoutp
+00004220: 7574 3d30 2c74 6872 6573 6868 6f6c 643d  ut=0,threshhold=
+00004230: 302c 7076 616c 7565 3d30 2c0d 0a20 2020  0,pvalue=0,..   
+00004240: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00004250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004270: 2069 6465 6e74 6966 6965 7265 7874 7261   identifierextra
-00004280: 6374 706f 733d 2222 2c74 6f70 636f 7272  ctpos="",topcorr
-00004290: 6e75 6d3d 352c 6a73 6f6e 6372 6974 6572  num=5,jsoncriter
-000042a0: 6961 3d27 272c 746d 6c66 696c 6570 6174  ia='',tmlfilepat
-000042b0: 683d 2727 2c75 7365 6d79 7371 6c3d 302c  h='',usemysql=0,
-000042c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004260: 2020 2020 2020 2069 6465 6e74 6966 6965         identifie
+00004270: 7265 7874 7261 6374 706f 733d 2222 2c74  rextractpos="",t
+00004280: 6f70 636f 7272 6e75 6d3d 352c 6a73 6f6e  opcorrnum=5,json
+00004290: 6372 6974 6572 6961 3d27 272c 746d 6c66  criteria='',tmlf
+000042a0: 696c 6570 6174 683d 2727 2c75 7365 6d79  ilepath='',usemy
+000042b0: 7371 6c3d 302c 0d0a 2020 2020 2020 2020  sql=0,..        
+000042c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000042d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000042e0: 2020 2020 2020 2020 2020 2020 7061 7468              path
-000042f0: 746f 746d 6c61 7474 7273 3d27 272c 6d69  totmlattrs='',mi
-00004300: 6e63 6f72 7276 6563 746f 726c 656e 3d35  ncorrvectorlen=5
-00004310: 2c77 7269 7465 636f 7272 7374 6f74 6f70  ,writecorrstotop
-00004320: 6963 3d27 272c 0d0a 2020 2020 2020 2020  ic='',..        
+000042e0: 2020 7061 7468 746f 746d 6c61 7474 7273    pathtotmlattrs
+000042f0: 3d27 272c 6d69 6e63 6f72 7276 6563 746f  ='',mincorrvecto
+00004300: 726c 656e 3d35 2c77 7269 7465 636f 7272  rlen=5,writecorr
+00004310: 7374 6f74 6f70 6963 3d27 272c 0d0a 2020  stotopic='',..  
+00004320: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00004330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004350: 2020 6f75 7470 7574 746f 7069 636e 616d    outputtopicnam
-00004360: 6573 3d30 2c6e 6c70 3d30 2c63 6f72 7265  es=0,nlp=0,corre
-00004370: 6c61 7469 6f6e 7479 7065 3d27 272c 646f  lationtype='',do
-00004380: 6372 6f73 7363 6f72 723d 3020 293a 0d0a  crosscorr=0 ):..
-00004390: 2020 2020 676c 6f62 616c 2063 6f6e 6e65      global conne
-000043a0: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
-000043b0: 2020 6966 206c 656e 2868 6f73 7429 3d3d    if len(host)==
-000043c0: 3020 6f72 206c 656e 2876 6970 6572 746f  0 or len(viperto
-000043d0: 6b65 6e29 3d3d 3020 6f72 2070 6f72 743d  ken)==0 or port=
-000043e0: 3d2d 3939 3920 6f72 206c 656e 2874 6f70  =-999 or len(top
-000043f0: 6963 293d 3d30 3a0d 0a20 2020 2020 2020  ic)==0:..       
-00004400: 2020 7265 7475 726e 2022 506c 6561 7365    return "Please
-00004410: 2065 6e74 6572 2068 6f73 742c 706f 7274   enter host,port
-00004420: 2c76 6970 6572 746f 6b65 6e2c 746f 7069  ,vipertoken,topi
-00004430: 6322 0d0a 2020 2020 0d0a 2020 2020 7661  c"..    ..    va
-00004440: 6c75 653d 2822 7374 7265 616d 636f 7272  lue=("streamcorr
-00004450: 3f76 6970 6572 746f 6b65 6e3d 222b 7669  ?vipertoken="+vi
-00004460: 7065 7274 6f6b 656e 202b 2022 2674 6f70  pertoken + "&top
-00004470: 6963 6e61 6d65 3d22 2b74 6f70 6963 202b  icname="+topic +
-00004480: 2022 2670 726f 6475 6365 7269 643d 2220   "&producerid=" 
-00004490: 2b20 7072 6f64 7563 6572 6964 202b 2022  + producerid + "
-000044a0: 266f 6666 7365 743d 2220 2b20 7374 7228  &offset=" + str(
-000044b0: 6f66 6673 6574 290d 0a20 2020 2020 2020  offset)..       
-000044c0: 2020 2020 2b20 2226 6d61 7872 6f77 733d      + "&maxrows=
-000044d0: 2220 2b20 7374 7228 6d61 7872 6f77 7329  " + str(maxrows)
-000044e0: 202b 2022 2664 656c 6179 3d22 202b 2073   + "&delay=" + s
-000044f0: 7472 2864 656c 6179 2920 2b20 2022 2665  tr(delay) +  "&e
-00004500: 6e61 626c 6574 6c73 3d22 2b73 7472 2865  nabletls="+str(e
-00004510: 6e61 626c 6574 6c73 290d 0a20 2020 2020  nabletls)..     
-00004520: 2020 2020 2020 2b20 2226 6272 6f6b 6572        + "&broker
-00004530: 686f 7374 3d22 2b62 726f 6b65 7268 6f73  host="+brokerhos
-00004540: 742b 2226 6272 6f6b 6572 706f 7274 3d22  t+"&brokerport="
-00004550: 2b73 7472 2862 726f 6b65 7270 6f72 7429  +str(brokerport)
-00004560: 202b 2022 2673 7472 6561 6d73 746f 6a6f   + "&streamstojo
-00004570: 696e 3d22 2b73 7472 6561 6d73 746f 6a6f  in="+streamstojo
-00004580: 696e 202b 2022 2674 6f70 6963 6964 3d22  in + "&topicid="
-00004590: 202b 2073 7472 2874 6f70 6963 6964 2920   + str(topicid) 
-000045a0: 0d0a 2020 2020 2020 2020 2020 202b 2022  ..           + "
-000045b0: 2669 6465 6e74 6966 6965 723d 2220 2b20  &identifier=" + 
-000045c0: 6964 656e 7469 6669 6572 202b 2022 2670  identifier + "&p
-000045d0: 7265 7072 6f63 6573 7374 6f70 6963 3d22  reprocesstopic="
-000045e0: 202b 2073 7472 2870 7265 7072 6f63 6573   + str(preproces
-000045f0: 7374 6f70 6963 2920 2b20 2022 2664 6573  stopic) +  "&des
-00004600: 6372 6970 7469 6f6e 3d22 202b 2073 7472  cription=" + str
-00004610: 2864 6573 6372 6970 7469 6f6e 290d 0a20  (description).. 
-00004620: 2020 2020 2020 2020 2020 2b20 2226 6172            + "&ar
-00004630: 7261 793d 2220 2b20 7374 7228 6172 7261  ray=" + str(arra
-00004640: 7929 202b 2022 2677 6865 7265 636f 6e64  y) + "&wherecond
-00004650: 6974 696f 6e3d 2220 2b20 7768 6572 6563  ition=" + wherec
-00004660: 6f6e 6469 7469 6f6e 0d0a 2020 2020 2020  ondition..      
-00004670: 2020 2020 202b 2022 2677 6865 7265 7365       + "&wherese
-00004680: 6172 6368 6b65 793d 2220 2b20 7768 6572  archkey=" + wher
-00004690: 6573 6561 7263 686b 6579 202b 2022 2672  esearchkey + "&r
-000046a0: 6177 6461 7461 6f75 7470 7574 3d22 202b  awdataoutput=" +
-000046b0: 2073 7472 2872 6177 6461 7461 6f75 7470   str(rawdataoutp
-000046c0: 7574 2920 2b20 2226 7468 7265 7368 686f  ut) + "&threshho
-000046d0: 6c64 3d22 202b 2073 7472 2874 6872 6573  ld=" + str(thres
-000046e0: 6868 6f6c 6429 0d0a 2020 2020 2020 2020  hhold)..        
-000046f0: 2020 202b 2022 2670 7661 6c75 653d 2220     + "&pvalue=" 
-00004700: 2b20 7374 7228 7076 616c 7565 2920 2b20  + str(pvalue) + 
-00004710: 2226 6964 656e 7469 6669 6572 6578 7472  "&identifierextr
-00004720: 6163 7470 6f73 3d22 202b 2069 6465 6e74  actpos=" + ident
-00004730: 6966 6965 7265 7874 7261 6374 706f 732b  ifierextractpos+
-00004740: 2022 2674 6f70 636f 7272 6e75 6d3d 220d   "&topcorrnum=".
-00004750: 0a20 2020 2020 2020 2020 2020 2b20 7374  .           + st
-00004760: 7228 746f 7063 6f72 726e 756d 2920 2b20  r(topcorrnum) + 
-00004770: 2226 6a73 6f6e 6372 6974 6572 6961 3d22  "&jsoncriteria="
-00004780: 202b 206a 736f 6e63 7269 7465 7269 6120   + jsoncriteria 
-00004790: 2b20 2226 746d 6c66 696c 6570 6174 683d  + "&tmlfilepath=
-000047a0: 2220 2b20 746d 6c66 696c 6570 6174 6820  " + tmlfilepath 
-000047b0: 2b20 2226 7573 656d 7973 716c 3d22 202b  + "&usemysql=" +
-000047c0: 2073 7472 2875 7365 6d79 7371 6c29 0d0a   str(usemysql)..
-000047d0: 2020 2020 2020 2020 2020 202b 2020 2226             +  "&
-000047e0: 7061 7468 746f 746d 6c61 7474 7273 3d22  pathtotmlattrs="
-000047f0: 202b 2070 6174 6874 6f74 6d6c 6174 7472   + pathtotmlattr
-00004800: 7320 2b20 2226 6d69 6e63 6f72 7276 6563  s + "&mincorrvec
-00004810: 746f 726c 656e 3d22 202b 2073 7472 286d  torlen=" + str(m
-00004820: 696e 636f 7272 7665 6374 6f72 6c65 6e29  incorrvectorlen)
-00004830: 0d0a 2020 2020 2020 2020 2020 202b 2022  ..           + "
-00004840: 2677 7269 7465 636f 7272 7374 6f74 6f70  &writecorrstotop
-00004850: 6963 3d22 202b 2077 7269 7465 636f 7272  ic=" + writecorr
-00004860: 7374 6f74 6f70 6963 202b 2022 266f 7574  stotopic + "&out
-00004870: 7075 7474 6f70 6963 6e61 6d65 733d 2220  puttopicnames=" 
-00004880: 2b20 7374 7228 6f75 7470 7574 746f 7069  + str(outputtopi
-00004890: 636e 616d 6573 290d 0a20 2020 2020 2020  cnames)..       
-000048a0: 2020 2020 2b20 2226 6e6c 703d 2220 2b20      + "&nlp=" + 
-000048b0: 7374 7228 6e6c 7029 202b 2022 2663 6f72  str(nlp) + "&cor
-000048c0: 7265 6c61 7469 6f6e 7479 7065 3d22 202b  relationtype=" +
-000048d0: 2063 6f72 7265 6c61 7469 6f6e 7479 7065   correlationtype
-000048e0: 202b 2022 2664 6f63 726f 7373 636f 7272   + "&docrosscorr
-000048f0: 3d22 202b 2073 7472 2864 6f63 726f 7373  =" + str(docross
-00004900: 636f 7272 2929 0d0a 0d0a 2020 2020 7661  corr))....    va
-00004910: 6c3d 6c6f 6f70 2e72 756e 5f75 6e74 696c  l=loop.run_until
-00004920: 5f63 6f6d 706c 6574 6528 7463 705f 6563  _complete(tcp_ec
-00004930: 686f 5f63 6c69 656e 7476 6970 6572 2876  ho_clientviper(v
-00004940: 616c 7565 2c20 6c6f 6f70 2c68 6f73 742c  alue, loop,host,
-00004950: 706f 7274 2c6d 6963 726f 7365 7276 6963  port,microservic
-00004960: 6569 6429 290d 0a0d 0a20 2020 2069 6620  eid))....    if 
-00004970: 636f 6e6e 6563 7469 6f6e 6572 726f 723a  connectionerror:
-00004980: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
-00004990: 6e20 636f 6e6e 6563 7469 6f6e 6572 726f  n connectionerro
-000049a0: 720d 0a0d 0a20 2020 2072 6574 7572 6e20  r....    return 
-000049b0: 7661 6c0d 0a20 2020 2020 2020 200d 0a64  val..        ..d
-000049c0: 6566 2076 6970 6572 7072 6f64 7563 6574  ef viperproducet
-000049d0: 6f74 6f70 6963 2876 6970 6572 746f 6b65  otopic(vipertoke
-000049e0: 6e2c 686f 7374 2c70 6f72 742c 746f 7069  n,host,port,topi
-000049f0: 632c 7072 6f64 7563 6572 6964 2c65 6e61  c,producerid,ena
-00004a00: 626c 6574 6c73 3d31 2c64 656c 6179 3d31  bletls=1,delay=1
-00004a10: 3030 2c69 6e70 7574 6461 7461 3d27 272c  00,inputdata='',
-00004a20: 6d61 6164 7361 6c67 6f6b 6579 3d27 272c  maadsalgokey='',
-00004a30: 6d61 6164 7374 6f6b 656e 3d27 272c 0d0a  maadstoken='',..
-00004a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a50: 2020 2020 2020 2020 6765 746f 7074 696d          getoptim
-00004a60: 616c 3d30 2c65 7874 6572 6e61 6c70 7265  al=0,externalpre
-00004a70: 6469 6374 696f 6e3d 2727 2c73 7562 746f  diction='',subto
-00004a80: 7069 6373 3d27 272c 746f 7069 6369 643d  pics='',topicid=
-00004a90: 2d39 3939 2c69 6465 6e74 6966 6965 723d  -999,identifier=
-00004aa0: 2727 2c61 7272 6179 3d30 2c0d 0a20 2020  '',array=0,..   
-00004ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ac0: 2020 2020 2062 726f 6b65 7268 6f73 743d       brokerhost=
-00004ad0: 2727 2c62 726f 6b65 7270 6f72 743d 2d39  '',brokerport=-9
-00004ae0: 3939 2c6d 6963 726f 7365 7276 6963 6569  99,microservicei
-00004af0: 643d 2727 293a 0d0a 2020 2020 676c 6f62  d=''):..    glob
-00004b00: 616c 2063 6f6e 6e65 6374 696f 6e65 7272  al connectionerr
-00004b10: 6f72 0d0a 0d0a 2020 2020 6966 206c 656e  or....    if len
-00004b20: 2868 6f73 7429 3d3d 3020 6f72 206c 656e  (host)==0 or len
-00004b30: 2876 6970 6572 746f 6b65 6e29 3d3d 3020  (vipertoken)==0 
-00004b40: 6f72 2070 6f72 743d 3d2d 3939 3920 6f72  or port==-999 or
-00004b50: 206c 656e 2874 6f70 6963 293d 3d30 206f   len(topic)==0 o
-00004b60: 7220 6c65 6e28 7072 6f64 7563 6572 6964  r len(producerid
-00004b70: 293d 3d30 3a0d 0a20 2020 2020 2020 2020  )==0:..         
-00004b80: 7265 7475 726e 2022 506c 6561 7365 2065  return "Please e
-00004b90: 6e74 6572 2068 6f73 742c 706f 7274 2c76  nter host,port,v
-00004ba0: 6970 6572 746f 6b65 6e2c 746f 7069 632c  ipertoken,topic,
-00004bb0: 2070 726f 6475 6365 7269 6422 0d0a 0d0a   producerid"....
-00004bc0: 2020 2020 0d0a 2020 2020 7661 6c75 653d      ..    value=
-00004bd0: 2822 7072 6f64 7563 6574 6f74 6f70 6963  ("producetotopic
-00004be0: 3f76 6970 6572 746f 6b65 6e3d 222b 7669  ?vipertoken="+vi
-00004bf0: 7065 7274 6f6b 656e 202b 2022 2674 6f70  pertoken + "&top
-00004c00: 6963 3d22 2b74 6f70 6963 202b 2022 2670  ic="+topic + "&p
-00004c10: 726f 6475 6365 7269 643d 2220 2b20 7072  roducerid=" + pr
-00004c20: 6f64 7563 6572 6964 202b 2022 2667 6574  oducerid + "&get
-00004c30: 6f70 7469 6d61 6c3d 222b 7374 7228 6765  optimal="+str(ge
-00004c40: 746f 7074 696d 616c 2920 2b0d 0a20 2020  toptimal) +..   
-00004c50: 2020 2020 2020 2022 2664 656c 6179 3d22         "&delay="
-00004c60: 202b 2073 7472 2864 656c 6179 2920 2b20   + str(delay) + 
-00004c70: 2022 2665 6e61 626c 6574 6c73 3d22 2b73   "&enabletls="+s
-00004c80: 7472 2865 6e61 626c 6574 6c73 292b 2022  tr(enabletls)+ "
-00004c90: 2665 7874 6572 6e61 6c70 7265 6469 6374  &externalpredict
-00004ca0: 696f 6e3d 222b 6578 7465 726e 616c 7072  ion="+externalpr
-00004cb0: 6564 6963 7469 6f6e 202b 2022 2669 6e70  ediction + "&inp
-00004cc0: 7574 6461 7461 3d22 2b69 6e70 7574 6461  utdata="+inputda
-00004cd0: 7461 202b 0d0a 2020 2020 2020 2020 2020  ta +..          
-00004ce0: 2022 266d 6161 6473 616c 676f 6b65 793d   "&maadsalgokey=
-00004cf0: 222b 6d61 6164 7361 6c67 6f6b 6579 202b  "+maadsalgokey +
-00004d00: 2226 6d61 6164 7374 6f6b 656e 3d22 2b6d  "&maadstoken="+m
-00004d10: 6161 6473 746f 6b65 6e20 2b20 2226 6272  aadstoken + "&br
-00004d20: 6f6b 6572 686f 7374 3d22 2b62 726f 6b65  okerhost="+broke
-00004d30: 7268 6f73 742b 2226 6272 6f6b 6572 706f  rhost+"&brokerpo
-00004d40: 7274 3d22 2b73 7472 2862 726f 6b65 7270  rt="+str(brokerp
-00004d50: 6f72 7429 0d0a 2020 2020 2020 2020 2020  ort)..          
-00004d60: 202b 2022 2673 7562 746f 7069 6373 3d22   + "&subtopics="
-00004d70: 2b73 7562 746f 7069 6373 202b 2022 2674  +subtopics + "&t
-00004d80: 6f70 6963 6964 3d22 202b 2073 7472 2874  opicid=" + str(t
-00004d90: 6f70 6963 6964 2920 2b20 2226 6964 656e  opicid) + "&iden
-00004da0: 7469 6669 6572 3d22 202b 2069 6465 6e74  tifier=" + ident
-00004db0: 6966 6965 7220 2b20 2226 6172 7261 793d  ifier + "&array=
-00004dc0: 2220 2b20 7374 7228 6172 7261 7929 290d  " + str(array)).
-00004dd0: 0a0d 0a20 2020 2020 2020 2020 2020 0d0a  ...           ..
-00004de0: 2020 2020 7661 6c3d 6c6f 6f70 2e72 756e      val=loop.run
-00004df0: 5f75 6e74 696c 5f63 6f6d 706c 6574 6528  _until_complete(
-00004e00: 7463 705f 6563 686f 5f63 6c69 656e 7476  tcp_echo_clientv
-00004e10: 6970 6572 2876 616c 7565 2c20 6c6f 6f70  iper(value, loop
-00004e20: 2c68 6f73 742c 706f 7274 2c6d 6963 726f  ,host,port,micro
-00004e30: 7365 7276 6963 6569 6429 290d 0a20 2020  serviceid))..   
-00004e40: 2069 6620 636f 6e6e 6563 7469 6f6e 6572   if connectioner
-00004e50: 726f 723a 0d0a 2020 2020 2020 2020 2072  ror:..         r
-00004e60: 6574 7572 6e20 636f 6e6e 6563 7469 6f6e  eturn connection
-00004e70: 6572 726f 720d 0a0d 0a20 2020 2072 6574  error....    ret
-00004e80: 7572 6e20 7661 6c0d 0a0d 0a0d 0a64 6566  urn val......def
-00004e90: 2076 6970 6572 7072 6f64 7563 6574 6f74   viperproducetot
-00004ea0: 6f70 6963 6275 6c6b 2876 6970 6572 746f  opicbulk(viperto
-00004eb0: 6b65 6e2c 686f 7374 2c70 6f72 742c 746f  ken,host,port,to
-00004ec0: 7069 632c 7072 6f64 7563 6572 6964 2c69  pic,producerid,i
-00004ed0: 6e70 7574 6461 7461 2c70 6172 7469 7469  nputdata,partiti
-00004ee0: 6f6e 7369 7a65 3d31 3030 2c65 6e61 626c  onsize=100,enabl
-00004ef0: 6574 6c73 3d31 2c64 656c 6179 3d31 3030  etls=1,delay=100
-00004f00: 2c62 726f 6b65 7268 6f73 743d 2727 2c62  ,brokerhost='',b
-00004f10: 726f 6b65 7270 6f72 743d 2d39 3939 2c6d  rokerport=-999,m
-00004f20: 6963 726f 7365 7276 6963 6569 643d 2727  icroserviceid=''
-00004f30: 293a 0d0a 2020 2020 676c 6f62 616c 2063  ):..    global c
-00004f40: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
-00004f50: 0d0a 2020 2020 6966 206c 656e 2868 6f73  ..    if len(hos
-00004f60: 7429 3d3d 3020 6f72 206c 656e 2876 6970  t)==0 or len(vip
-00004f70: 6572 746f 6b65 6e29 3d3d 3020 6f72 2070  ertoken)==0 or p
-00004f80: 6f72 743d 3d2d 3939 3920 6f72 206c 656e  ort==-999 or len
-00004f90: 2874 6f70 6963 293d 3d30 206f 7220 6c65  (topic)==0 or le
-00004fa0: 6e28 7072 6f64 7563 6572 6964 293d 3d30  n(producerid)==0
-00004fb0: 206f 7220 6c65 6e28 696e 7075 7464 6174   or len(inputdat
-00004fc0: 6129 3d3d 303a 0d0a 2020 2020 2020 2020  a)==0:..        
-00004fd0: 2072 6574 7572 6e20 2250 6c65 6173 6520   return "Please 
-00004fe0: 656e 7465 7220 686f 7374 2c70 6f72 742c  enter host,port,
-00004ff0: 7669 7065 7274 6f6b 656e 2c74 6f70 6963  vipertoken,topic
-00005000: 2c20 7072 6f64 7563 6572 6964 2c69 6e70  , producerid,inp
-00005010: 7574 6461 7461 220d 0a20 2020 2020 2020  utdata"..       
-00005020: 200d 0a20 2020 2076 616c 7565 3d28 2270   ..    value=("p
-00005030: 726f 6475 6365 746f 746f 7069 6362 756c  roducetotopicbul
-00005040: 6b3f 7669 7065 7274 6f6b 656e 3d22 2b76  k?vipertoken="+v
-00005050: 6970 6572 746f 6b65 6e20 2b20 2226 746f  ipertoken + "&to
-00005060: 7069 633d 222b 746f 7069 6320 2b20 2226  pic="+topic + "&
-00005070: 7072 6f64 7563 6572 6964 3d22 202b 2070  producerid=" + p
-00005080: 726f 6475 6365 7269 6420 2b20 0d0a 2020  roducerid + ..  
-00005090: 2020 2020 2020 2020 2226 6465 6c61 793d          "&delay=
-000050a0: 2220 2b20 7374 7228 6465 6c61 7929 202b  " + str(delay) +
-000050b0: 2020 2226 656e 6162 6c65 746c 733d 222b    "&enabletls="+
-000050c0: 7374 7228 656e 6162 6c65 746c 7329 2b20  str(enabletls)+ 
-000050d0: 2226 6578 7465 726e 616c 7072 6564 6963  "&externalpredic
-000050e0: 7469 6f6e 3d22 2b69 6e70 7574 6461 7461  tion="+inputdata
-000050f0: 202b 0d0a 2020 2020 2020 2020 2020 2226   +..          "&
-00005100: 6272 6f6b 6572 686f 7374 3d22 2b62 726f  brokerhost="+bro
-00005110: 6b65 7268 6f73 742b 2226 6272 6f6b 6572  kerhost+"&broker
-00005120: 706f 7274 3d22 2b73 7472 2862 726f 6b65  port="+str(broke
-00005130: 7270 6f72 7429 202b 2022 2670 6172 7469  rport) + "&parti
-00005140: 7469 6f6e 7369 7a65 3d22 2b73 7472 2870  tionsize="+str(p
-00005150: 6172 7469 7469 6f6e 7369 7a65 2929 200d  artitionsize)) .
-00005160: 0a0d 0a20 2020 2076 616c 3d6c 6f6f 702e  ...    val=loop.
-00005170: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
-00005180: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
-00005190: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
-000051a0: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
-000051b0: 6372 6f73 6572 7669 6365 6964 2929 0d0a  croserviceid))..
-000051c0: 2020 2020 6966 2063 6f6e 6e65 6374 696f      if connectio
-000051d0: 6e65 7272 6f72 3a0d 0a20 2020 2020 2020  nerror:..       
-000051e0: 2020 7265 7475 726e 2063 6f6e 6e65 6374    return connect
-000051f0: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
-00005200: 7265 7475 726e 2076 616c 0d0a 0d0a 6465  return val....de
-00005210: 6620 7669 7065 7263 6f6e 7375 6d65 6672  f viperconsumefr
-00005220: 6f6d 746f 7069 6362 6174 6368 2876 6970  omtopicbatch(vip
-00005230: 6572 746f 6b65 6e2c 686f 7374 2c70 6f72  ertoken,host,por
-00005240: 742c 746f 7069 632c 636f 6e73 756d 6572  t,topic,consumer
-00005250: 6964 2c63 6f6d 7061 6e79 6e61 6d65 2c70  id,companyname,p
-00005260: 6172 7469 7469 6f6e 3d2d 312c 656e 6162  artition=-1,enab
-00005270: 6c65 746c 733d 302c 6465 6c61 793d 3130  letls=0,delay=10
-00005280: 302c 6f66 6673 6574 3d30 2c62 726f 6b65  0,offset=0,broke
-00005290: 7268 6f73 743d 2727 2c0d 0a20 2020 2020  rhost='',..     
-000052a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000052b0: 2020 2020 2062 726f 6b65 7270 6f72 743d       brokerport=
-000052c0: 2d39 3939 2c6d 6963 726f 7365 7276 6963  -999,microservic
-000052d0: 6569 643d 2727 2c74 6f70 6963 6964 3d27  eid='',topicid='
-000052e0: 2d39 3939 272c 726f 6c6c 6261 636b 6f66  -999',rollbackof
-000052f0: 6673 6574 733d 302c 7072 6570 726f 6365  fsets=0,preproce
-00005300: 7373 7479 7065 3d27 272c 7469 6d65 6465  sstype='',timede
-00005310: 6c61 793d 302c 6173 796e 6374 696d 656f  lay=0,asynctimeo
-00005320: 7574 3d31 3230 293a 0d0a 2020 2020 676c  ut=120):..    gl
-00005330: 6f62 616c 2063 6f6e 6e65 6374 696f 6e65  obal connectione
-00005340: 7272 6f72 0d0a 0d0a 2020 2020 6966 206c  rror....    if l
-00005350: 656e 2868 6f73 7429 3d3d 3020 6f72 206c  en(host)==0 or l
-00005360: 656e 2876 6970 6572 746f 6b65 6e29 3d3d  en(vipertoken)==
-00005370: 3020 6f72 2070 6f72 743d 3d2d 3939 3920  0 or port==-999 
-00005380: 6f72 206c 656e 2874 6f70 6963 293d 3d30  or len(topic)==0
-00005390: 2020 6f72 206c 656e 2863 6f6d 7061 6e79    or len(company
-000053a0: 6e61 6d65 293d 3d30 3a0d 0a20 2020 2020  name)==0:..     
-000053b0: 2020 2020 7265 7475 726e 2022 506c 6561      return "Plea
-000053c0: 7365 2065 6e74 6572 2068 6f73 742c 706f  se enter host,po
-000053d0: 7274 2c76 6970 6572 746f 6b65 6e2c 746f  rt,vipertoken,to
-000053e0: 7069 632c 636f 6d70 616e 796e 616d 6522  pic,companyname"
-000053f0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00005400: 7661 6c75 653d 2822 636f 6e73 756d 6566  value=("consumef
-00005410: 726f 6d74 6f70 6963 6261 7463 683f 7669  romtopicbatch?vi
-00005420: 7065 7274 6f6b 656e 3d22 2b76 6970 6572  pertoken="+viper
-00005430: 746f 6b65 6e20 2b20 2226 746f 7069 633d  token + "&topic=
-00005440: 222b 746f 7069 6320 2b20 2226 636f 6e73  "+topic + "&cons
-00005450: 756d 6572 6964 3d22 202b 2063 6f6e 7375  umerid=" + consu
-00005460: 6d65 7269 6420 2b20 2226 6f66 6673 6574  merid + "&offset
-00005470: 3d22 2b73 7472 286f 6666 7365 7429 202b  ="+str(offset) +
-00005480: 0d0a 2020 2020 2020 2226 7061 7274 6974  ..      "&partit
-00005490: 696f 6e3d 2220 2b20 7374 7228 7061 7274  ion=" + str(part
-000054a0: 6974 696f 6e29 202b 2020 2226 6465 6c61  ition) +  "&dela
-000054b0: 793d 2220 2b20 7374 7228 6465 6c61 7929  y=" + str(delay)
-000054c0: 202b 2020 2226 656e 6162 6c65 746c 733d   +  "&enabletls=
-000054d0: 2220 2b20 7374 7228 656e 6162 6c65 746c  " + str(enabletl
-000054e0: 7329 202b 2022 2662 726f 6b65 7268 6f73  s) + "&brokerhos
-000054f0: 743d 222b 6272 6f6b 6572 686f 7374 0d0a  t="+brokerhost..
-00005500: 2020 2020 2020 2020 2020 202b 2022 2662             + "&b
-00005510: 726f 6b65 7270 6f72 743d 222b 7374 7228  rokerport="+str(
-00005520: 6272 6f6b 6572 706f 7274 292b 2226 636f  brokerport)+"&co
-00005530: 6d70 616e 796e 616d 653d 222b 636f 6d70  mpanyname="+comp
-00005540: 616e 796e 616d 6520 2b20 2226 746f 7069  anyname + "&topi
-00005550: 6369 643d 2220 2b20 746f 7069 6369 6420  cid=" + topicid 
-00005560: 2b0d 0a20 2020 2020 2020 2020 2020 2226  +..           "&
-00005570: 726f 6c6c 6261 636b 6f66 6673 6574 733d  rollbackoffsets=
-00005580: 2220 2b20 7374 7228 726f 6c6c 6261 636b  " + str(rollback
-00005590: 6f66 6673 6574 7329 202b 2022 2670 7265  offsets) + "&pre
-000055a0: 7072 6f63 6573 7374 7970 653d 2220 2b20  processtype=" + 
-000055b0: 7072 6570 726f 6365 7373 7479 7065 2b20  preprocesstype+ 
-000055c0: 2226 7469 6d65 6465 6c61 793d 2220 2b20  "&timedelay=" + 
-000055d0: 7374 7228 7469 6d65 6465 6c61 7929 290d  str(timedelay)).
-000055e0: 0a0d 0a20 2020 2076 616c 3d6c 6f6f 702e  ...    val=loop.
-000055f0: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
-00005600: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
-00005610: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
-00005620: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
-00005630: 6372 6f73 6572 7669 6365 6964 2c61 7379  croserviceid,asy
-00005640: 6e63 7469 6d65 6f75 7429 290d 0a20 2020  nctimeout))..   
-00005650: 2069 6620 636f 6e6e 6563 7469 6f6e 6572   if connectioner
-00005660: 726f 723a 0d0a 2020 2020 2020 2020 2072  ror:..         r
-00005670: 6574 7572 6e20 636f 6e6e 6563 7469 6f6e  eturn connection
-00005680: 6572 726f 720d 0a0d 0a20 2020 2072 6574  error....    ret
-00005690: 7572 6e20 7661 6c0d 0a0d 0a64 6566 2076  urn val....def v
-000056a0: 6970 6572 636f 6e73 756d 6566 726f 6d74  iperconsumefromt
-000056b0: 6f70 6963 2876 6970 6572 746f 6b65 6e2c  opic(vipertoken,
-000056c0: 686f 7374 2c70 6f72 742c 746f 7069 632c  host,port,topic,
-000056d0: 636f 6e73 756d 6572 6964 2c63 6f6d 7061  consumerid,compa
-000056e0: 6e79 6e61 6d65 2c70 6172 7469 7469 6f6e  nyname,partition
-000056f0: 3d2d 312c 656e 6162 6c65 746c 733d 302c  =-1,enabletls=0,
-00005700: 6465 6c61 793d 3130 302c 6f66 6673 6574  delay=100,offset
-00005710: 3d30 2c62 726f 6b65 7268 6f73 743d 2727  =0,brokerhost=''
-00005720: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00005730: 2020 2020 2020 2020 2020 2020 2062 726f               bro
-00005740: 6b65 7270 6f72 743d 2d39 3939 2c6d 6963  kerport=-999,mic
-00005750: 726f 7365 7276 6963 6569 643d 2727 2c74  roserviceid='',t
-00005760: 6f70 6963 6964 3d27 2d39 3939 272c 726f  opicid='-999',ro
-00005770: 6c6c 6261 636b 6f66 6673 6574 733d 302c  llbackoffsets=0,
-00005780: 7072 6570 726f 6365 7373 7479 7065 3d27  preprocesstype='
-00005790: 2729 3a0d 0a20 2020 2067 6c6f 6261 6c20  '):..    global 
-000057a0: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
-000057b0: 0a0d 0a20 2020 2069 6620 6c65 6e28 686f  ...    if len(ho
-000057c0: 7374 293d 3d30 206f 7220 6c65 6e28 7669  st)==0 or len(vi
-000057d0: 7065 7274 6f6b 656e 293d 3d30 206f 7220  pertoken)==0 or 
-000057e0: 706f 7274 3d3d 2d39 3939 206f 7220 6c65  port==-999 or le
-000057f0: 6e28 746f 7069 6329 3d3d 3020 206f 7220  n(topic)==0  or 
-00005800: 6c65 6e28 636f 6d70 616e 796e 616d 6529  len(companyname)
-00005810: 3d3d 303a 0d0a 2020 2020 2020 2020 2072  ==0:..         r
-00005820: 6574 7572 6e20 2250 6c65 6173 6520 656e  eturn "Please en
-00005830: 7465 7220 686f 7374 2c70 6f72 742c 7669  ter host,port,vi
-00005840: 7065 7274 6f6b 656e 2c74 6f70 6963 2c63  pertoken,topic,c
-00005850: 6f6d 7061 6e79 6e61 6d65 220d 0a20 2020  ompanyname"..   
-00005860: 2020 2020 200d 0a20 2020 2076 616c 7565       ..    value
-00005870: 3d28 2263 6f6e 7375 6d65 6672 6f6d 746f  =("consumefromto
-00005880: 7069 633f 7669 7065 7274 6f6b 656e 3d22  pic?vipertoken="
-00005890: 2b76 6970 6572 746f 6b65 6e20 2b20 2226  +vipertoken + "&
-000058a0: 746f 7069 633d 222b 746f 7069 6320 2b20  topic="+topic + 
-000058b0: 2226 636f 6e73 756d 6572 6964 3d22 202b  "&consumerid=" +
-000058c0: 2063 6f6e 7375 6d65 7269 6420 2b20 2226   consumerid + "&
-000058d0: 6f66 6673 6574 3d22 2b73 7472 286f 6666  offset="+str(off
-000058e0: 7365 7429 202b 0d0a 2020 2020 2020 2226  set) +..      "&
-000058f0: 7061 7274 6974 696f 6e3d 2220 2b20 7374  partition=" + st
-00005900: 7228 7061 7274 6974 696f 6e29 202b 2020  r(partition) +  
-00005910: 2226 6465 6c61 793d 2220 2b20 7374 7228  "&delay=" + str(
-00005920: 6465 6c61 7929 202b 2020 2226 656e 6162  delay) +  "&enab
-00005930: 6c65 746c 733d 2220 2b20 7374 7228 656e  letls=" + str(en
-00005940: 6162 6c65 746c 7329 202b 2022 2662 726f  abletls) + "&bro
-00005950: 6b65 7268 6f73 743d 222b 6272 6f6b 6572  kerhost="+broker
-00005960: 686f 7374 0d0a 2020 2020 2020 2020 2020  host..          
-00005970: 202b 2022 2662 726f 6b65 7270 6f72 743d   + "&brokerport=
-00005980: 222b 7374 7228 6272 6f6b 6572 706f 7274  "+str(brokerport
-00005990: 292b 2226 636f 6d70 616e 796e 616d 653d  )+"&companyname=
-000059a0: 222b 636f 6d70 616e 796e 616d 6520 2b20  "+companyname + 
-000059b0: 2226 746f 7069 6369 643d 2220 2b20 746f  "&topicid=" + to
-000059c0: 7069 6369 6420 2b0d 0a20 2020 2020 2020  picid +..       
-000059d0: 2020 2020 2226 726f 6c6c 6261 636b 6f66      "&rollbackof
-000059e0: 6673 6574 733d 2220 2b20 7374 7228 726f  fsets=" + str(ro
-000059f0: 6c6c 6261 636b 6f66 6673 6574 7329 202b  llbackoffsets) +
-00005a00: 2022 2670 7265 7072 6f63 6573 7374 7970   "&preprocesstyp
-00005a10: 653d 2220 2b20 7072 6570 726f 6365 7373  e=" + preprocess
-00005a20: 7479 7065 290d 0a0d 0a20 2020 2076 616c  type)....    val
-00005a30: 3d6c 6f6f 702e 7275 6e5f 756e 7469 6c5f  =loop.run_until_
-00005a40: 636f 6d70 6c65 7465 2874 6370 5f65 6368  complete(tcp_ech
-00005a50: 6f5f 636c 6965 6e74 7669 7065 7228 7661  o_clientviper(va
-00005a60: 6c75 652c 206c 6f6f 702c 686f 7374 2c70  lue, loop,host,p
-00005a70: 6f72 742c 6d69 6372 6f73 6572 7669 6365  ort,microservice
-00005a80: 6964 2929 0d0a 2020 2020 6966 2063 6f6e  id))..    if con
-00005a90: 6e65 6374 696f 6e65 7272 6f72 3a0d 0a20  nectionerror:.. 
-00005aa0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-00005ab0: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
-00005ac0: 0d0a 2020 2020 7265 7475 726e 2076 616c  ..    return val
-00005ad0: 0d0a 0d0a 6465 6620 7669 7065 7268 7064  ....def viperhpd
-00005ae0: 6570 7265 6469 6374 6261 7463 6828 7669  epredictbatch(vi
-00005af0: 7065 7274 6f6b 656e 2c68 6f73 742c 706f  pertoken,host,po
-00005b00: 7274 2c63 6f6e 7375 6d65 6672 6f6d 2c70  rt,consumefrom,p
-00005b10: 726f 6475 6365 746f 2c63 6f6d 7061 6e79  roduceto,company
-00005b20: 6e61 6d65 2c63 6f6e 7375 6d65 7269 642c  name,consumerid,
-00005b30: 7072 6f64 7563 6572 6964 2c68 7064 6568  producerid,hpdeh
-00005b40: 6f73 742c 696e 7075 7464 6174 612c 6d61  ost,inputdata,ma
-00005b50: 7872 6f77 733d 302c 616c 676f 6b65 793d  xrows=0,algokey=
-00005b60: 2727 2c70 6172 7469 7469 6f6e 3d2d 312c  '',partition=-1,
-00005b70: 6f66 6673 6574 3d2d 312c 0d0a 2020 2020  offset=-1,..    
-00005b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b90: 2065 6e61 626c 6574 6c73 3d31 2c64 656c   enabletls=1,del
-00005ba0: 6179 3d31 3030 2c68 7064 6570 6f72 743d  ay=100,hpdeport=
-00005bb0: 2d39 3939 2c62 726f 6b65 7268 6f73 743d  -999,brokerhost=
-00005bc0: 2727 2c62 726f 6b65 7270 6f72 743d 3930  '',brokerport=90
-00005bd0: 3932 2c0d 0a20 2020 2020 2020 2020 2020  92,..           
-00005be0: 2020 2020 2020 2020 2020 7469 6d65 6f75            timeou
-00005bf0: 743d 3132 302c 7573 6564 6570 6c6f 793d  t=120,usedeploy=
-00005c00: 302c 6d69 6372 6f73 6572 7669 6365 6964  0,microserviceid
-00005c10: 3d27 272c 746f 7069 6369 643d 222d 3939  ='',topicid="-99
-00005c20: 3922 2c20 6d61 696e 746f 7069 633d 2727  9", maintopic=''
-00005c30: 2c20 7374 7265 616d 7374 6f6a 6f69 6e3d  , streamstojoin=
-00005c40: 2727 2c61 7272 6179 3d30 2c74 696d 6564  '',array=0,timed
-00005c50: 656c 6179 3d30 2c0d 0a20 2020 2020 2020  elay=0,..       
-00005c60: 2020 2020 2020 2020 2020 2020 2020 6173                as
-00005c70: 796e 6374 696d 656f 7574 3d31 3230 2c70  ynctimeout=120,p
-00005c80: 6174 6874 6f61 6c67 6f73 3d27 2729 3a0d  athtoalgos=''):.
-00005c90: 0a0d 0a20 2020 2023 7265 6164 7320 7468  ...    #reads th
-00005ca0: 6520 6669 656c 646e 616d 6573 2061 6e64  e fieldnames and
-00005cb0: 2067 6574 7320 6c61 7465 7374 2064 6174   gets latest dat
-00005cc0: 6120 6672 6f6d 2065 6163 6820 7374 7265  a from each stre
-00005cd0: 616d 2028 6f72 2066 6965 6c64 6e61 6d65  am (or fieldname
-00005ce0: 290d 0a20 2020 2067 6c6f 6261 6c20 636f  )..    global co
-00005cf0: 6e6e 6563 7469 6f6e 6572 726f 720d 0a20  nnectionerror.. 
-00005d00: 2020 200d 0a20 2020 2069 6620 286c 656e     ..    if (len
-00005d10: 2868 6f73 7429 3d3d 3020 6f72 206c 656e  (host)==0 or len
-00005d20: 2876 6970 6572 746f 6b65 6e29 3d3d 3020  (vipertoken)==0 
-00005d30: 6f72 2070 6f72 743d 3d2d 3939 3920 6f72  or port==-999 or
-00005d40: 206c 656e 2863 6f6e 7375 6d65 6672 6f6d   len(consumefrom
-00005d50: 293d 3d30 206f 7220 6c65 6e28 7072 6f64  )==0 or len(prod
-00005d60: 7563 6574 6f29 3d3d 3020 6f72 0d0a 2020  uceto)==0 or..  
-00005d70: 2020 2020 2020 6c65 6e28 636f 6d70 616e        len(compan
-00005d80: 796e 616d 6529 3d3d 3020 6f72 206c 656e  yname)==0 or len
-00005d90: 2868 7064 6568 6f73 7429 3d3d 3020 6f72  (hpdehost)==0 or
-00005da0: 2068 7064 6570 6f72 743d 3d2d 3939 3920   hpdeport==-999 
-00005db0: 6f72 206c 656e 2870 6174 6874 6f61 6c67  or len(pathtoalg
-00005dc0: 6f73 293d 3d30 293a 0d0a 2020 2020 2020  os)==0):..      
-00005dd0: 2020 2072 6574 7572 6e20 2250 6c65 6173     return "Pleas
-00005de0: 6520 656e 7465 7220 686f 7374 2c70 6f72  e enter host,por
-00005df0: 742c 7669 7065 7274 6f6b 656e 2c63 6f6e  t,vipertoken,con
-00005e00: 7375 6d65 6672 6f6d 2c69 6e70 7574 6461  sumefrom,inputda
-00005e10: 7461 2c70 726f 6475 6365 746f 2c63 6f6d  ta,produceto,com
-00005e20: 7061 6e79 6e61 6d65 2c68 7064 6568 6f73  panyname,hpdehos
-00005e30: 742c 6870 6465 706f 7274 2c70 6174 6874  t,hpdeport,patht
-00005e40: 6f61 6c67 6f73 220d 0a20 2020 2020 2020  oalgos"..       
-00005e50: 200d 0a20 2020 2076 616c 7565 3d28 2276   ..    value=("v
-00005e60: 6970 6572 6870 6465 7072 6564 6963 7462  iperhpdepredictb
-00005e70: 6174 6368 3f76 6970 6572 746f 6b65 6e3d  atch?vipertoken=
-00005e80: 222b 7669 7065 7274 6f6b 656e 202b 2022  "+vipertoken + "
-00005e90: 2663 6f6e 7375 6d65 6672 6f6d 3d22 2b63  &consumefrom="+c
-00005ea0: 6f6e 7375 6d65 6672 6f6d 202b 2022 2670  onsumefrom + "&p
-00005eb0: 726f 6475 6365 746f 3d22 202b 2070 726f  roduceto=" + pro
-00005ec0: 6475 6365 746f 202b 2022 2663 6f6e 7375  duceto + "&consu
-00005ed0: 6d65 7269 643d 222b 636f 6e73 756d 6572  merid="+consumer
-00005ee0: 6964 202b 0d0a 2020 2020 2020 2020 2020  id +..          
-00005ef0: 2022 2664 656c 6179 3d22 202b 2073 7472   "&delay=" + str
-00005f00: 2864 656c 6179 2920 2b20 2226 696e 7075  (delay) + "&inpu
-00005f10: 7464 6174 613d 222b 2069 6e70 7574 6461  tdata="+ inputda
-00005f20: 7461 202b 2022 2661 6c67 6f6b 6579 3d22  ta + "&algokey="
-00005f30: 2b61 6c67 6f6b 6579 202b 2022 266d 6178  +algokey + "&max
-00005f40: 726f 7773 3d22 202b 0d0a 2020 2020 2020  rows=" +..      
-00005f50: 2020 2020 2073 7472 286d 6178 726f 7773       str(maxrows
-00005f60: 2920 2b20 2226 7061 7274 6974 696f 6e3d  ) + "&partition=
-00005f70: 222b 7374 7228 7061 7274 6974 696f 6e29  "+str(partition)
-00005f80: 2b22 266f 6666 7365 743d 222b 7374 7228  +"&offset="+str(
-00005f90: 6f66 6673 6574 292b 2022 2665 6e61 626c  offset)+ "&enabl
-00005fa0: 6574 6c73 3d22 202b 2073 7472 2865 6e61  etls=" + str(ena
-00005fb0: 626c 6574 6c73 290d 0a20 2020 2020 2020  bletls)..       
-00005fc0: 2020 2020 2b20 2226 7072 6f64 7563 6572      + "&producer
-00005fd0: 6964 3d22 2b70 726f 6475 6365 7269 6420  id="+producerid 
-00005fe0: 2b20 2226 7573 6564 6570 6c6f 793d 2220  + "&usedeploy=" 
-00005ff0: 2b73 7472 2875 7365 6465 706c 6f79 2920  +str(usedeploy) 
-00006000: 2b22 2663 6f6d 7061 6e79 6e61 6d65 3d22  +"&companyname="
-00006010: 2b63 6f6d 7061 6e79 6e61 6d65 202b 2022  +companyname + "
-00006020: 2668 7064 6568 6f73 743d 220d 0a20 2020  &hpdehost="..   
-00006030: 2020 2020 2020 2020 2b68 7064 6568 6f73          +hpdehos
-00006040: 7420 2b22 2668 7064 6570 6f72 743d 222b  t +"&hpdeport="+
-00006050: 7374 7228 6870 6465 706f 7274 292b 2226  str(hpdeport)+"&
-00006060: 6272 6f6b 6572 686f 7374 3d22 2b62 726f  brokerhost="+bro
-00006070: 6b65 7268 6f73 7420 2b20 2226 6272 6f6b  kerhost + "&brok
-00006080: 6572 706f 7274 3d22 2b73 7472 2862 726f  erport="+str(bro
-00006090: 6b65 7270 6f72 7429 202b 0d0a 2020 2020  kerport) +..    
-000060a0: 2020 2020 2020 2022 2674 6f70 6963 6964         "&topicid
-000060b0: 3d22 202b 2074 6f70 6963 6964 202b 2022  =" + topicid + "
-000060c0: 266d 6169 6e74 6f70 6963 3d22 202b 206d  &maintopic=" + m
-000060d0: 6169 6e74 6f70 6963 202b 2022 2673 7472  aintopic + "&str
-000060e0: 6561 6d73 746f 6a6f 696e 3d22 202b 2073  eamstojoin=" + s
-000060f0: 7472 6561 6d73 746f 6a6f 696e 202b 2022  treamstojoin + "
-00006100: 2661 7272 6179 3d22 202b 0d0a 2020 2020  &array=" +..    
-00006110: 2020 2020 2020 2073 7472 2861 7272 6179         str(array
-00006120: 292b 2022 2674 696d 6564 656c 6179 3d22  )+ "&timedelay="
-00006130: 202b 2073 7472 2874 696d 6564 656c 6179   + str(timedelay
-00006140: 2920 2b20 2226 7061 7468 746f 616c 676f  ) + "&pathtoalgo
-00006150: 733d 222b 7061 7468 746f 616c 676f 7329  s="+pathtoalgos)
-00006160: 0d0a 0d0a 2020 2020 7661 6c3d 6c6f 6f70  ....    val=loop
-00006170: 2e72 756e 5f75 6e74 696c 5f63 6f6d 706c  .run_until_compl
-00006180: 6574 6528 7463 705f 6563 686f 5f63 6c69  ete(tcp_echo_cli
-00006190: 656e 7476 6970 6572 2876 616c 7565 2c20  entviper(value, 
-000061a0: 6c6f 6f70 2c68 6f73 742c 706f 7274 2c6d  loop,host,port,m
-000061b0: 6963 726f 7365 7276 6963 6569 642c 6173  icroserviceid,as
-000061c0: 796e 6374 696d 656f 7574 2929 0d0a 2020  ynctimeout))..  
-000061d0: 2020 6966 2063 6f6e 6e65 6374 696f 6e65    if connectione
-000061e0: 7272 6f72 3a0d 0a20 2020 2020 2020 2020  rror:..         
-000061f0: 7265 7475 726e 2063 6f6e 6e65 6374 696f  return connectio
-00006200: 6e65 7272 6f72 0d0a 2020 2020 0d0a 2020  nerror..    ..  
-00006210: 2020 7265 7475 726e 2076 616c 0d0a 0d0a    return val....
-00006220: 6465 6620 7669 7065 7268 7064 6570 7265  def viperhpdepre
-00006230: 6469 6374 2876 6970 6572 746f 6b65 6e2c  dict(vipertoken,
-00006240: 686f 7374 2c70 6f72 742c 636f 6e73 756d  host,port,consum
-00006250: 6566 726f 6d2c 7072 6f64 7563 6574 6f2c  efrom,produceto,
-00006260: 636f 6d70 616e 796e 616d 652c 636f 6e73  companyname,cons
-00006270: 756d 6572 6964 2c70 726f 6475 6365 7269  umerid,produceri
-00006280: 642c 6870 6465 686f 7374 2c69 6e70 7574  d,hpdehost,input
-00006290: 6461 7461 2c6d 6178 726f 7773 3d30 2c61  data,maxrows=0,a
-000062a0: 6c67 6f6b 6579 3d27 272c 7061 7274 6974  lgokey='',partit
-000062b0: 696f 6e3d 2d31 2c6f 6666 7365 743d 2d31  ion=-1,offset=-1
-000062c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000062d0: 2020 2020 2020 2020 656e 6162 6c65 746c          enabletl
-000062e0: 733d 312c 6465 6c61 793d 3130 3030 2c68  s=1,delay=1000,h
-000062f0: 7064 6570 6f72 743d 2d39 3939 2c62 726f  pdeport=-999,bro
-00006300: 6b65 7268 6f73 743d 2727 2c62 726f 6b65  kerhost='',broke
-00006310: 7270 6f72 743d 3930 3932 2c0d 0a20 2020  rport=9092,..   
-00006320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006330: 2020 7469 6d65 6f75 743d 3132 302c 7573    timeout=120,us
-00006340: 6564 6570 6c6f 793d 302c 6d69 6372 6f73  edeploy=0,micros
-00006350: 6572 7669 6365 6964 3d27 272c 746f 7069  erviceid='',topi
-00006360: 6369 643d 2d39 3939 2c20 6d61 696e 746f  cid=-999, mainto
-00006370: 7069 633d 2727 2c0d 0a20 2020 2020 2020  pic='',..       
-00006380: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00006390: 7265 616d 7374 6f6a 6f69 6e3d 2727 2c61  reamstojoin='',a
-000063a0: 7272 6179 3d30 2c70 6174 6874 6f61 6c67  rray=0,pathtoalg
-000063b0: 6f73 3d27 2729 3a0d 0a0d 0a20 2020 2023  os=''):....    #
-000063c0: 7265 6164 7320 7468 6520 6669 656c 646e  reads the fieldn
-000063d0: 616d 6573 2061 6e64 2067 6574 7320 6c61  ames and gets la
-000063e0: 7465 7374 2064 6174 6120 6672 6f6d 2065  test data from e
-000063f0: 6163 6820 7374 7265 616d 2028 6f72 2066  ach stream (or f
-00006400: 6965 6c64 6e61 6d65 290d 0a20 2020 2067  ieldname)..    g
-00006410: 6c6f 6261 6c20 636f 6e6e 6563 7469 6f6e  lobal connection
-00006420: 6572 726f 720d 0a20 2020 200d 0a20 2020  error..    ..   
-00006430: 2069 6620 286c 656e 2868 6f73 7429 3d3d   if (len(host)==
-00006440: 3020 6f72 206c 656e 2876 6970 6572 746f  0 or len(viperto
-00006450: 6b65 6e29 3d3d 3020 6f72 2070 6f72 743d  ken)==0 or port=
-00006460: 3d2d 3939 3920 6f72 206c 656e 2863 6f6e  =-999 or len(con
-00006470: 7375 6d65 6672 6f6d 293d 3d30 206f 7220  sumefrom)==0 or 
-00006480: 6c65 6e28 7072 6f64 7563 6574 6f29 3d3d  len(produceto)==
-00006490: 3020 6f72 0d0a 2020 2020 2020 2020 6c65  0 or..        le
-000064a0: 6e28 636f 6d70 616e 796e 616d 6529 3d3d  n(companyname)==
-000064b0: 3020 6f72 206c 656e 2868 7064 6568 6f73  0 or len(hpdehos
-000064c0: 7429 3d3d 3020 6f72 2068 7064 6570 6f72  t)==0 or hpdepor
-000064d0: 743d 3d2d 3939 3920 6f72 206c 656e 2870  t==-999 or len(p
-000064e0: 6174 6874 6f61 6c67 6f73 293d 3d30 293a  athtoalgos)==0):
-000064f0: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
-00006500: 6e20 2250 6c65 6173 6520 656e 7465 7220  n "Please enter 
-00006510: 686f 7374 2c70 6f72 742c 7669 7065 7274  host,port,vipert
-00006520: 6f6b 656e 2c63 6f6e 7375 6d65 6672 6f6d  oken,consumefrom
-00006530: 2c69 6e70 7574 6461 7461 2c70 726f 6475  ,inputdata,produ
-00006540: 6365 746f 2c63 6f6d 7061 6e79 6e61 6d65  ceto,companyname
-00006550: 2c68 7064 6568 6f73 742c 6870 6465 706f  ,hpdehost,hpdepo
-00006560: 7274 2c70 6174 6874 6f61 6c67 6f73 220d  rt,pathtoalgos".
-00006570: 0a20 2020 2020 2020 200d 0a20 2020 2076  .        ..    v
-00006580: 616c 7565 3d28 2276 6970 6572 6870 6465  alue=("viperhpde
-00006590: 7072 6564 6963 743f 7669 7065 7274 6f6b  predict?vipertok
-000065a0: 656e 3d22 2b76 6970 6572 746f 6b65 6e20  en="+vipertoken 
-000065b0: 2b20 2226 636f 6e73 756d 6566 726f 6d3d  + "&consumefrom=
-000065c0: 222b 636f 6e73 756d 6566 726f 6d20 2b20  "+consumefrom + 
-000065d0: 2226 7072 6f64 7563 6574 6f3d 2220 2b20  "&produceto=" + 
-000065e0: 7072 6f64 7563 6574 6f20 2b20 2226 636f  produceto + "&co
-000065f0: 6e73 756d 6572 6964 3d22 2b63 6f6e 7375  nsumerid="+consu
-00006600: 6d65 7269 6420 2b0d 0a20 2020 2020 2020  merid +..       
-00006610: 2020 2020 2226 6465 6c61 793d 2220 2b20      "&delay=" + 
-00006620: 7374 7228 6465 6c61 7929 202b 2022 2669  str(delay) + "&i
-00006630: 6e70 7574 6461 7461 3d22 2b20 696e 7075  nputdata="+ inpu
-00006640: 7464 6174 6120 2b20 2226 616c 676f 6b65  tdata + "&algoke
-00006650: 793d 222b 616c 676f 6b65 7920 2b20 2226  y="+algokey + "&
-00006660: 6d61 7872 6f77 733d 2220 2b0d 0a20 2020  maxrows=" +..   
-00006670: 2020 2020 2020 2020 7374 7228 6d61 7872          str(maxr
-00006680: 6f77 7329 202b 2022 2670 6172 7469 7469  ows) + "&partiti
-00006690: 6f6e 3d22 2b73 7472 2870 6172 7469 7469  on="+str(partiti
-000066a0: 6f6e 292b 2226 6f66 6673 6574 3d22 2b73  on)+"&offset="+s
-000066b0: 7472 286f 6666 7365 7429 2b20 2226 656e  tr(offset)+ "&en
-000066c0: 6162 6c65 746c 733d 2220 2b20 7374 7228  abletls=" + str(
-000066d0: 656e 6162 6c65 746c 7329 0d0a 2020 2020  enabletls)..    
-000066e0: 2020 2020 2020 202b 2022 2670 726f 6475         + "&produ
-000066f0: 6365 7269 643d 222b 7072 6f64 7563 6572  cerid="+producer
-00006700: 6964 202b 2022 2675 7365 6465 706c 6f79  id + "&usedeploy
-00006710: 3d22 202b 7374 7228 7573 6564 6570 6c6f  =" +str(usedeplo
-00006720: 7929 202b 2226 636f 6d70 616e 796e 616d  y) +"&companynam
-00006730: 653d 222b 636f 6d70 616e 796e 616d 6520  e="+companyname 
-00006740: 2b20 2226 6870 6465 686f 7374 3d22 0d0a  + "&hpdehost="..
-00006750: 2020 2020 2020 2020 2020 202b 6870 6465             +hpde
-00006760: 686f 7374 202b 2226 6870 6465 706f 7274  host +"&hpdeport
-00006770: 3d22 2b73 7472 2868 7064 6570 6f72 7429  ="+str(hpdeport)
-00006780: 2b22 2662 726f 6b65 7268 6f73 743d 222b  +"&brokerhost="+
-00006790: 6272 6f6b 6572 686f 7374 202b 2022 2662  brokerhost + "&b
-000067a0: 726f 6b65 7270 6f72 743d 222b 7374 7228  rokerport="+str(
-000067b0: 6272 6f6b 6572 706f 7274 2920 2b0d 0a20  brokerport) +.. 
-000067c0: 2020 2020 2020 2020 2020 2226 746f 7069            "&topi
-000067d0: 6369 643d 2220 2b20 7374 7228 746f 7069  cid=" + str(topi
-000067e0: 6369 6429 202b 2022 266d 6169 6e74 6f70  cid) + "&maintop
-000067f0: 6963 3d22 202b 206d 6169 6e74 6f70 6963  ic=" + maintopic
-00006800: 202b 2022 2673 7472 6561 6d73 746f 6a6f   + "&streamstojo
-00006810: 696e 3d22 202b 2073 7472 6561 6d73 746f  in=" + streamsto
-00006820: 6a6f 696e 202b 2022 2661 7272 6179 3d22  join + "&array="
-00006830: 202b 2073 7472 2861 7272 6179 2920 2b0d   + str(array) +.
-00006840: 0a20 2020 2020 2020 2020 2020 2226 7061  .           "&pa
-00006850: 7468 746f 616c 676f 733d 222b 7061 7468  thtoalgos="+path
-00006860: 746f 616c 676f 7329 0d0a 0d0a 2020 2020  toalgos)....    
-00006870: 7661 6c3d 6c6f 6f70 2e72 756e 5f75 6e74  val=loop.run_unt
-00006880: 696c 5f63 6f6d 706c 6574 6528 7463 705f  il_complete(tcp_
-00006890: 6563 686f 5f63 6c69 656e 7476 6970 6572  echo_clientviper
-000068a0: 2876 616c 7565 2c20 6c6f 6f70 2c68 6f73  (value, loop,hos
-000068b0: 742c 706f 7274 2c6d 6963 726f 7365 7276  t,port,microserv
-000068c0: 6963 6569 642c 7469 6d65 6f75 7429 290d  iceid,timeout)).
-000068d0: 0a20 2020 2069 6620 636f 6e6e 6563 7469  .    if connecti
-000068e0: 6f6e 6572 726f 723a 0d0a 2020 2020 2020  onerror:..      
-000068f0: 2020 2072 6574 7572 6e20 636f 6e6e 6563     return connec
-00006900: 7469 6f6e 6572 726f 720d 0a20 2020 200d  tionerror..    .
-00006910: 0a20 2020 2072 6574 7572 6e20 7661 6c0d  .    return val.
-00006920: 0a0d 0a64 6566 2076 6970 6572 6870 6465  ...def viperhpde
-00006930: 7072 6564 6963 7470 726f 6365 7373 2876  predictprocess(v
-00006940: 6970 6572 746f 6b65 6e2c 686f 7374 2c70  ipertoken,host,p
-00006950: 6f72 742c 636f 6e73 756d 6566 726f 6d2c  ort,consumefrom,
-00006960: 7072 6f64 7563 6574 6f2c 636f 6d70 616e  produceto,compan
-00006970: 796e 616d 652c 636f 6e73 756d 6572 6964  yname,consumerid
-00006980: 2c70 726f 6475 6365 7269 642c 6870 6465  ,producerid,hpde
-00006990: 686f 7374 2c69 6e70 7574 6461 7461 2c70  host,inputdata,p
-000069a0: 726f 6365 7373 7479 7065 2c6d 6178 726f  rocesstype,maxro
-000069b0: 7773 3d30 2c61 6c67 6f6b 6579 3d27 272c  ws=0,algokey='',
-000069c0: 7061 7274 6974 696f 6e3d 2d31 2c6f 6666  partition=-1,off
-000069d0: 7365 743d 2d31 2c0d 0a20 2020 2020 2020  set=-1,..       
-000069e0: 2020 2020 2020 2020 2020 2020 2020 656e                en
-000069f0: 6162 6c65 746c 733d 312c 6465 6c61 793d  abletls=1,delay=
-00006a00: 3130 3030 2c68 7064 6570 6f72 743d 2d39  1000,hpdeport=-9
-00006a10: 3939 2c62 726f 6b65 7268 6f73 743d 2727  99,brokerhost=''
-00006a20: 2c62 726f 6b65 7270 6f72 743d 3930 3932  ,brokerport=9092
-00006a30: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00006a40: 2020 2020 2020 2020 7469 6d65 6f75 743d          timeout=
-00006a50: 3132 302c 7573 6564 6570 6c6f 793d 302c  120,usedeploy=0,
-00006a60: 6d69 6372 6f73 6572 7669 6365 6964 3d27  microserviceid='
-00006a70: 272c 746f 7069 6369 643d 2d39 3939 2c20  ',topicid=-999, 
-00006a80: 6d61 696e 746f 7069 633d 2727 2c0d 0a20  maintopic='',.. 
-00006a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006aa0: 2020 2020 7374 7265 616d 7374 6f6a 6f69      streamstojoi
-00006ab0: 6e3d 2727 2c61 7272 6179 3d30 2c70 6174  n='',array=0,pat
-00006ac0: 6874 6f61 6c67 6f73 3d27 2729 3a0d 0a0d  htoalgos=''):...
-00006ad0: 0a20 2020 2023 7265 6164 7320 7468 6520  .    #reads the 
-00006ae0: 6669 656c 646e 616d 6573 2061 6e64 2067  fieldnames and g
-00006af0: 6574 7320 6c61 7465 7374 2064 6174 6120  ets latest data 
-00006b00: 6672 6f6d 2065 6163 6820 7374 7265 616d  from each stream
-00006b10: 2028 6f72 2066 6965 6c64 6e61 6d65 290d   (or fieldname).
-00006b20: 0a20 2020 2067 6c6f 6261 6c20 636f 6e6e  .    global conn
-00006b30: 6563 7469 6f6e 6572 726f 720d 0a20 2020  ectionerror..   
-00006b40: 200d 0a20 2020 2069 6620 286c 656e 2868   ..    if (len(h
-00006b50: 6f73 7429 3d3d 3020 6f72 206c 656e 2876  ost)==0 or len(v
-00006b60: 6970 6572 746f 6b65 6e29 3d3d 3020 6f72  ipertoken)==0 or
-00006b70: 2070 6f72 743d 3d2d 3939 3920 6f72 206c   port==-999 or l
-00006b80: 656e 2863 6f6e 7375 6d65 6672 6f6d 293d  en(consumefrom)=
-00006b90: 3d30 206f 7220 6c65 6e28 7072 6f64 7563  =0 or len(produc
-00006ba0: 6574 6f29 3d3d 3020 6f72 0d0a 2020 2020  eto)==0 or..    
-00006bb0: 2020 2020 6c65 6e28 636f 6d70 616e 796e      len(companyn
-00006bc0: 616d 6529 3d3d 3020 6f72 206c 656e 2868  ame)==0 or len(h
-00006bd0: 7064 6568 6f73 7429 3d3d 3020 6f72 2068  pdehost)==0 or h
-00006be0: 7064 6570 6f72 743d 3d2d 3939 3920 6f72  pdeport==-999 or
-00006bf0: 206c 656e 2870 6174 6874 6f61 6c67 6f73   len(pathtoalgos
-00006c00: 293d 3d30 206f 7220 6c65 6e28 7072 6f63  )==0 or len(proc
-00006c10: 6573 7374 7970 6529 3d3d 3029 3a0d 0a20  esstype)==0):.. 
-00006c20: 2020 2020 2020 2020 7265 7475 726e 2022          return "
-00006c30: 506c 6561 7365 2065 6e74 6572 2068 6f73  Please enter hos
-00006c40: 742c 706f 7274 2c76 6970 6572 746f 6b65  t,port,vipertoke
-00006c50: 6e2c 636f 6e73 756d 6566 726f 6d2c 696e  n,consumefrom,in
-00006c60: 7075 7464 6174 612c 7072 6f64 7563 6574  putdata,producet
-00006c70: 6f2c 636f 6d70 616e 796e 616d 652c 6870  o,companyname,hp
-00006c80: 6465 686f 7374 2c68 7064 6570 6f72 742c  dehost,hpdeport,
-00006c90: 7061 7468 746f 616c 676f 732c 7072 6f63  pathtoalgos,proc
-00006ca0: 6573 7374 7970 6522 0d0a 2020 2020 2020  esstype"..      
-00006cb0: 2020 0d0a 2020 2020 7661 6c75 653d 2822    ..    value=("
-00006cc0: 7669 7065 7268 7064 6570 7265 6469 6374  viperhpdepredict
-00006cd0: 7072 6f63 6573 733f 7669 7065 7274 6f6b  process?vipertok
-00006ce0: 656e 3d22 2b76 6970 6572 746f 6b65 6e20  en="+vipertoken 
-00006cf0: 2b20 2226 636f 6e73 756d 6566 726f 6d3d  + "&consumefrom=
-00006d00: 222b 636f 6e73 756d 6566 726f 6d20 2b20  "+consumefrom + 
-00006d10: 2226 7072 6f64 7563 6574 6f3d 2220 2b20  "&produceto=" + 
-00006d20: 7072 6f64 7563 6574 6f20 2b20 2226 636f  produceto + "&co
-00006d30: 6e73 756d 6572 6964 3d22 2b63 6f6e 7375  nsumerid="+consu
-00006d40: 6d65 7269 6420 2b0d 0a20 2020 2020 2020  merid +..       
-00006d50: 2020 2020 2226 6465 6c61 793d 2220 2b20      "&delay=" + 
-00006d60: 7374 7228 6465 6c61 7929 202b 2022 2669  str(delay) + "&i
-00006d70: 6e70 7574 6461 7461 3d22 2b20 696e 7075  nputdata="+ inpu
-00006d80: 7464 6174 6120 2b20 2226 616c 676f 6b65  tdata + "&algoke
-00006d90: 793d 222b 616c 676f 6b65 7920 2b20 2226  y="+algokey + "&
-00006da0: 6d61 7872 6f77 733d 2220 2b0d 0a20 2020  maxrows=" +..   
-00006db0: 2020 2020 2020 2020 7374 7228 6d61 7872          str(maxr
-00006dc0: 6f77 7329 202b 2022 2670 6172 7469 7469  ows) + "&partiti
-00006dd0: 6f6e 3d22 2b73 7472 2870 6172 7469 7469  on="+str(partiti
-00006de0: 6f6e 292b 2226 6f66 6673 6574 3d22 2b73  on)+"&offset="+s
-00006df0: 7472 286f 6666 7365 7429 2b20 2226 656e  tr(offset)+ "&en
-00006e00: 6162 6c65 746c 733d 2220 2b20 7374 7228  abletls=" + str(
-00006e10: 656e 6162 6c65 746c 7329 0d0a 2020 2020  enabletls)..    
-00006e20: 2020 2020 2020 202b 2022 2670 726f 6475         + "&produ
-00006e30: 6365 7269 643d 222b 7072 6f64 7563 6572  cerid="+producer
-00006e40: 6964 202b 2022 2675 7365 6465 706c 6f79  id + "&usedeploy
-00006e50: 3d22 202b 7374 7228 7573 6564 6570 6c6f  =" +str(usedeplo
-00006e60: 7929 202b 2226 636f 6d70 616e 796e 616d  y) +"&companynam
-00006e70: 653d 222b 636f 6d70 616e 796e 616d 6520  e="+companyname 
-00006e80: 2b20 2226 6870 6465 686f 7374 3d22 0d0a  + "&hpdehost="..
-00006e90: 2020 2020 2020 2020 2020 202b 6870 6465             +hpde
-00006ea0: 686f 7374 202b 2226 6870 6465 706f 7274  host +"&hpdeport
-00006eb0: 3d22 2b73 7472 2868 7064 6570 6f72 7429  ="+str(hpdeport)
-00006ec0: 2b22 2662 726f 6b65 7268 6f73 743d 222b  +"&brokerhost="+
-00006ed0: 6272 6f6b 6572 686f 7374 202b 2022 2662  brokerhost + "&b
-00006ee0: 726f 6b65 7270 6f72 743d 222b 7374 7228  rokerport="+str(
-00006ef0: 6272 6f6b 6572 706f 7274 2920 2b0d 0a20  brokerport) +.. 
-00006f00: 2020 2020 2020 2020 2020 2226 746f 7069            "&topi
-00006f10: 6369 643d 2220 2b20 7374 7228 746f 7069  cid=" + str(topi
-00006f20: 6369 6429 202b 2022 266d 6169 6e74 6f70  cid) + "&maintop
-00006f30: 6963 3d22 202b 206d 6169 6e74 6f70 6963  ic=" + maintopic
-00006f40: 202b 2022 2673 7472 6561 6d73 746f 6a6f   + "&streamstojo
-00006f50: 696e 3d22 202b 2073 7472 6561 6d73 746f  in=" + streamsto
-00006f60: 6a6f 696e 202b 2022 2661 7272 6179 3d22  join + "&array="
-00006f70: 202b 2073 7472 2861 7272 6179 2920 2b0d   + str(array) +.
-00006f80: 0a20 2020 2020 2020 2020 2020 2226 7061  .           "&pa
-00006f90: 7468 746f 616c 676f 733d 222b 7061 7468  thtoalgos="+path
-00006fa0: 746f 616c 676f 7320 2b20 2226 7072 6f63  toalgos + "&proc
-00006fb0: 6573 7374 7970 653d 222b 7072 6f63 6573  esstype="+proces
-00006fc0: 7374 7970 6529 0d0a 0d0a 2020 2020 7661  stype)....    va
-00006fd0: 6c3d 6c6f 6f70 2e72 756e 5f75 6e74 696c  l=loop.run_until
-00006fe0: 5f63 6f6d 706c 6574 6528 7463 705f 6563  _complete(tcp_ec
-00006ff0: 686f 5f63 6c69 656e 7476 6970 6572 2876  ho_clientviper(v
-00007000: 616c 7565 2c20 6c6f 6f70 2c68 6f73 742c  alue, loop,host,
-00007010: 706f 7274 2c6d 6963 726f 7365 7276 6963  port,microservic
-00007020: 6569 642c 7469 6d65 6f75 7429 290d 0a20  eid,timeout)).. 
-00007030: 2020 2069 6620 636f 6e6e 6563 7469 6f6e     if connection
-00007040: 6572 726f 723a 0d0a 2020 2020 2020 2020  error:..        
-00007050: 2072 6574 7572 6e20 636f 6e6e 6563 7469   return connecti
-00007060: 6f6e 6572 726f 720d 0a20 2020 200d 0a20  onerror..    .. 
-00007070: 2020 2072 6574 7572 6e20 7661 6c0d 0a0d     return val...
-00007080: 0a64 6566 2076 6970 6572 6870 6465 6f70  .def viperhpdeop
-00007090: 7469 6d69 7a65 6261 7463 6828 7669 7065  timizebatch(vipe
-000070a0: 7274 6f6b 656e 2c68 6f73 742c 706f 7274  rtoken,host,port
-000070b0: 2c63 6f6e 7375 6d65 6672 6f6d 2c70 726f  ,consumefrom,pro
-000070c0: 6475 6365 746f 2c63 6f6d 7061 6e79 6e61  duceto,companyna
-000070d0: 6d65 2c63 6f6e 7375 6d65 7269 642c 7072  me,consumerid,pr
-000070e0: 6f64 7563 6572 6964 2c68 7064 6568 6f73  oducerid,hpdehos
-000070f0: 742c 7061 7274 6974 696f 6e3d 2d31 2c6f  t,partition=-1,o
-00007100: 6666 7365 743d 2d31 2c0d 0a20 2020 2020  ffset=-1,..     
-00007110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007120: 2065 6e61 626c 6574 6c73 3d31 2c64 656c   enabletls=1,del
-00007130: 6179 3d31 3030 2c68 7064 6570 6f72 743d  ay=100,hpdeport=
-00007140: 2d39 3939 2c75 7365 6465 706c 6f79 3d30  -999,usedeploy=0
-00007150: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00007160: 2020 2020 2020 2020 2069 736d 696e 3d31           ismin=1
-00007170: 2c63 6f6e 7374 7261 696e 7473 3d27 6265  ,constraints='be
-00007180: 7374 272c 7374 7265 7463 6862 6f75 6e64  st',stretchbound
-00007190: 733d 3230 2c63 6f6e 7374 7261 696e 7474  s=20,constraintt
-000071a0: 7970 653d 312c 6570 7369 6c6f 6e3d 3130  ype=1,epsilon=10
-000071b0: 2c62 726f 6b65 7268 6f73 743d 2727 2c62  ,brokerhost='',b
-000071c0: 726f 6b65 7270 6f72 743d 3930 3932 2c0d  rokerport=9092,.
-000071d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000071e0: 2020 2020 2020 2074 696d 656f 7574 3d31         timeout=1
-000071f0: 3230 2c6d 6963 726f 7365 7276 6963 6569  20,microservicei
-00007200: 643d 2727 2c74 6f70 6963 6964 3d22 2d39  d='',topicid="-9
-00007210: 3939 222c 7469 6d65 6465 6c61 793d 302c  99",timedelay=0,
-00007220: 6173 796e 6374 696d 656f 7574 3d31 3230  asynctimeout=120
-00007230: 293a 0d0a 0d0a 2020 2020 2372 6561 6473  ):....    #reads
-00007240: 2074 6865 2066 6965 6c64 6e61 6d65 7320   the fieldnames 
-00007250: 616e 6420 6765 7473 206c 6174 6573 7420  and gets latest 
-00007260: 6461 7461 2066 726f 6d20 6561 6368 2073  data from each s
-00007270: 7472 6561 6d20 286f 7220 6669 656c 646e  tream (or fieldn
-00007280: 616d 6529 0d0a 2020 2020 676c 6f62 616c  ame)..    global
-00007290: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
-000072a0: 0d0a 2020 2020 0d0a 2020 2020 6966 2028  ..    ..    if (
-000072b0: 6c65 6e28 686f 7374 293d 3d30 206f 7220  len(host)==0 or 
-000072c0: 6c65 6e28 7669 7065 7274 6f6b 656e 293d  len(vipertoken)=
-000072d0: 3d30 206f 7220 706f 7274 3d3d 2d39 3939  =0 or port==-999
-000072e0: 206f 7220 6c65 6e28 636f 6e73 756d 6566   or len(consumef
-000072f0: 726f 6d29 3d3d 3020 6f72 206c 656e 2870  rom)==0 or len(p
-00007300: 726f 6475 6365 746f 293d 3d30 206f 7220  roduceto)==0 or 
-00007310: 6c65 6e28 636f 6d70 616e 796e 616d 6529  len(companyname)
-00007320: 3d3d 300d 0a20 2020 2020 2020 206f 7220  ==0..        or 
-00007330: 6c65 6e28 6870 6465 686f 7374 293d 3d30  len(hpdehost)==0
-00007340: 206f 7220 6870 6465 706f 7274 3d3d 2d39   or hpdeport==-9
-00007350: 3939 293a 0d0a 2020 2020 2020 2020 2072  99):..         r
-00007360: 6574 7572 6e20 2250 6c65 6173 6520 656e  eturn "Please en
-00007370: 7465 7220 686f 7374 2c70 6f72 742c 7669  ter host,port,vi
-00007380: 7065 7274 6f6b 656e 2c63 6f6e 7375 6d65  pertoken,consume
-00007390: 6672 6f6d 2c70 726f 6475 6365 746f 2c63  from,produceto,c
-000073a0: 6f6d 7061 6e79 6e61 6d65 2c68 7064 6568  ompanyname,hpdeh
-000073b0: 6f73 742c 6870 6465 706f 7274 220d 0a20  ost,hpdeport".. 
-000073c0: 2020 2020 2020 200d 0a20 2020 2076 616c         ..    val
-000073d0: 7565 3d28 2276 6970 6572 6870 6465 6f70  ue=("viperhpdeop
-000073e0: 7469 6d69 7a65 6261 7463 683f 7669 7065  timizebatch?vipe
-000073f0: 7274 6f6b 656e 3d22 2b76 6970 6572 746f  rtoken="+viperto
-00007400: 6b65 6e20 2b20 2226 636f 6e73 756d 6566  ken + "&consumef
-00007410: 726f 6d3d 222b 636f 6e73 756d 6566 726f  rom="+consumefro
-00007420: 6d20 2b20 2226 7072 6f64 7563 6574 6f3d  m + "&produceto=
-00007430: 2220 2b20 7072 6f64 7563 6574 6f20 2b20  " + produceto + 
-00007440: 2226 636f 6e73 756d 6572 6964 3d22 2b63  "&consumerid="+c
-00007450: 6f6e 7375 6d65 7269 6420 2b0d 0a20 2020  onsumerid +..   
-00007460: 2020 2020 2020 2226 6465 6c61 793d 2220        "&delay=" 
-00007470: 2b20 7374 7228 6465 6c61 7929 202b 2022  + str(delay) + "
-00007480: 2665 6e61 626c 6574 6c73 3d22 202b 2073  &enabletls=" + s
-00007490: 7472 2865 6e61 626c 6574 6c73 2920 2b20  tr(enabletls) + 
-000074a0: 2226 7072 6f64 7563 6572 6964 3d22 2b70  "&producerid="+p
-000074b0: 726f 6475 6365 7269 6420 2b20 2226 636f  roducerid + "&co
-000074c0: 6d70 616e 796e 616d 653d 222b 636f 6d70  mpanyname="+comp
-000074d0: 616e 796e 616d 6520 2b0d 0a20 2020 2020  anyname +..     
-000074e0: 2020 2020 2226 7061 7274 6974 696f 6e3d      "&partition=
-000074f0: 222b 7374 7228 7061 7274 6974 696f 6e29  "+str(partition)
-00007500: 2b22 266f 6666 7365 743d 222b 7374 7228  +"&offset="+str(
-00007510: 6f66 6673 6574 292b 2226 6973 6d69 6e3d  offset)+"&ismin=
-00007520: 222b 7374 7228 6973 6d69 6e29 2b22 2663  "+str(ismin)+"&c
-00007530: 6f6e 7374 7261 696e 7473 3d22 2b63 6f6e  onstraints="+con
-00007540: 7374 7261 696e 7473 2b22 2673 7472 6574  straints+"&stret
-00007550: 6368 626f 756e 6473 3d22 2b73 7472 2873  chbounds="+str(s
-00007560: 7472 6574 6368 626f 756e 6473 292b 0d0a  tretchbounds)+..
-00007570: 2020 2020 2020 2020 2022 2668 7064 6568           "&hpdeh
-00007580: 6f73 743d 2220 2b68 7064 6568 6f73 7420  ost=" +hpdehost 
-00007590: 2b22 2668 7064 6570 6f72 743d 222b 7374  +"&hpdeport="+st
-000075a0: 7228 6870 6465 706f 7274 2920 2b20 2226  r(hpdeport) + "&
-000075b0: 7573 6564 6570 6c6f 793d 2220 2b73 7472  usedeploy=" +str
-000075c0: 2875 7365 6465 706c 6f79 2920 2b20 2226  (usedeploy) + "&
-000075d0: 636f 6e73 7472 6169 6e74 7479 7065 3d22  constrainttype="
-000075e0: 202b 7374 7228 636f 6e73 7472 6169 6e74   +str(constraint
-000075f0: 7479 7065 2920 2b22 2665 7073 696c 6f6e  type) +"&epsilon
-00007600: 3d22 202b 0d0a 2020 2020 2020 2020 2020  =" +..          
-00007610: 2073 7472 2865 7073 696c 6f6e 2920 2b20   str(epsilon) + 
-00007620: 2226 746f 7069 6369 643d 2220 2b20 746f  "&topicid=" + to
-00007630: 7069 6369 6420 2b20 2226 7469 6d65 6465  picid + "&timede
-00007640: 6c61 793d 2220 2b20 7374 7228 7469 6d65  lay=" + str(time
-00007650: 6465 6c61 7929 290d 0a0d 0a20 2020 2076  delay))....    v
-00007660: 616c 3d6c 6f6f 702e 7275 6e5f 756e 7469  al=loop.run_unti
-00007670: 6c5f 636f 6d70 6c65 7465 2874 6370 5f65  l_complete(tcp_e
-00007680: 6368 6f5f 636c 6965 6e74 7669 7065 7228  cho_clientviper(
-00007690: 7661 6c75 652c 206c 6f6f 702c 686f 7374  value, loop,host
-000076a0: 2c70 6f72 742c 6d69 6372 6f73 6572 7669  ,port,microservi
-000076b0: 6365 6964 2c61 7379 6e63 7469 6d65 6f75  ceid,asynctimeou
-000076c0: 7429 290d 0a20 2020 2069 6620 636f 6e6e  t))..    if conn
-000076d0: 6563 7469 6f6e 6572 726f 723a 0d0a 2020  ectionerror:..  
-000076e0: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
-000076f0: 6e6e 6563 7469 6f6e 6572 726f 720d 0a0d  nnectionerror...
-00007700: 0a20 2020 2072 6574 7572 6e20 7661 6c0d  .    return val.
-00007710: 0a0d 0a64 6566 2076 6970 6572 6870 6465  ...def viperhpde
-00007720: 6f70 7469 6d69 7a65 2876 6970 6572 746f  optimize(viperto
-00007730: 6b65 6e2c 686f 7374 2c70 6f72 742c 636f  ken,host,port,co
-00007740: 6e73 756d 6566 726f 6d2c 7072 6f64 7563  nsumefrom,produc
-00007750: 6574 6f2c 636f 6d70 616e 796e 616d 652c  eto,companyname,
-00007760: 636f 6e73 756d 6572 6964 2c70 726f 6475  consumerid,produ
-00007770: 6365 7269 642c 6870 6465 686f 7374 2c70  cerid,hpdehost,p
-00007780: 6172 7469 7469 6f6e 3d2d 312c 6f66 6673  artition=-1,offs
-00007790: 6574 3d2d 312c 0d0a 2020 2020 2020 2020  et=-1,..        
-000077a0: 2020 2020 2020 2020 2020 2020 2020 656e                en
-000077b0: 6162 6c65 746c 733d 312c 6465 6c61 793d  abletls=1,delay=
-000077c0: 3130 3030 2c68 7064 6570 6f72 743d 2d39  1000,hpdeport=-9
-000077d0: 3939 2c75 7365 6465 706c 6f79 3d30 2c0d  99,usedeploy=0,.
-000077e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000077f0: 2020 2020 2020 2069 736d 696e 3d31 2c63         ismin=1,c
-00007800: 6f6e 7374 7261 696e 7473 3d27 6265 7374  onstraints='best
-00007810: 272c 7374 7265 7463 6862 6f75 6e64 733d  ',stretchbounds=
-00007820: 3230 2c63 6f6e 7374 7261 696e 7474 7970  20,constrainttyp
-00007830: 653d 312c 6570 7369 6c6f 6e3d 3130 2c62  e=1,epsilon=10,b
-00007840: 726f 6b65 7268 6f73 743d 2727 2c62 726f  rokerhost='',bro
-00007850: 6b65 7270 6f72 743d 3930 3932 2c0d 0a20  kerport=9092,.. 
-00007860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007870: 2020 2020 2074 696d 656f 7574 3d31 3230       timeout=120
-00007880: 2c6d 6963 726f 7365 7276 6963 6569 643d  ,microserviceid=
-00007890: 2727 2c74 6f70 6963 6964 3d2d 3939 3929  '',topicid=-999)
-000078a0: 3a0d 0a0d 0a20 2020 2023 7265 6164 7320  :....    #reads 
-000078b0: 7468 6520 6669 656c 646e 616d 6573 2061  the fieldnames a
-000078c0: 6e64 2067 6574 7320 6c61 7465 7374 2064  nd gets latest d
-000078d0: 6174 6120 6672 6f6d 2065 6163 6820 7374  ata from each st
-000078e0: 7265 616d 2028 6f72 2066 6965 6c64 6e61  ream (or fieldna
-000078f0: 6d65 290d 0a20 2020 2067 6c6f 6261 6c20  me)..    global 
-00007900: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
-00007910: 0a20 2020 200d 0a20 2020 2069 6620 286c  .    ..    if (l
-00007920: 656e 2868 6f73 7429 3d3d 3020 6f72 206c  en(host)==0 or l
-00007930: 656e 2876 6970 6572 746f 6b65 6e29 3d3d  en(vipertoken)==
-00007940: 3020 6f72 2070 6f72 743d 3d2d 3939 3920  0 or port==-999 
-00007950: 6f72 206c 656e 2863 6f6e 7375 6d65 6672  or len(consumefr
-00007960: 6f6d 293d 3d30 206f 7220 6c65 6e28 7072  om)==0 or len(pr
-00007970: 6f64 7563 6574 6f29 3d3d 3020 6f72 206c  oduceto)==0 or l
-00007980: 656e 2863 6f6d 7061 6e79 6e61 6d65 293d  en(companyname)=
-00007990: 3d30 0d0a 2020 2020 2020 2020 6f72 206c  =0..        or l
-000079a0: 656e 2868 7064 6568 6f73 7429 3d3d 3020  en(hpdehost)==0 
-000079b0: 6f72 2068 7064 6570 6f72 743d 3d2d 3939  or hpdeport==-99
-000079c0: 3929 3a0d 0a20 2020 2020 2020 2020 7265  9):..         re
-000079d0: 7475 726e 2022 506c 6561 7365 2065 6e74  turn "Please ent
-000079e0: 6572 2068 6f73 742c 706f 7274 2c76 6970  er host,port,vip
-000079f0: 6572 746f 6b65 6e2c 636f 6e73 756d 6566  ertoken,consumef
-00007a00: 726f 6d2c 7072 6f64 7563 6574 6f2c 636f  rom,produceto,co
-00007a10: 6d70 616e 796e 616d 652c 6870 6465 686f  mpanyname,hpdeho
-00007a20: 7374 2c68 7064 6570 6f72 7422 0d0a 2020  st,hpdeport"..  
-00007a30: 2020 2020 2020 0d0a 2020 2020 7661 6c75        ..    valu
-00007a40: 653d 2822 7669 7065 7268 7064 656f 7074  e=("viperhpdeopt
-00007a50: 696d 697a 653f 7669 7065 7274 6f6b 656e  imize?vipertoken
-00007a60: 3d22 2b76 6970 6572 746f 6b65 6e20 2b20  ="+vipertoken + 
-00007a70: 2226 636f 6e73 756d 6566 726f 6d3d 222b  "&consumefrom="+
-00007a80: 636f 6e73 756d 6566 726f 6d20 2b20 2226  consumefrom + "&
-00007a90: 7072 6f64 7563 6574 6f3d 2220 2b20 7072  produceto=" + pr
-00007aa0: 6f64 7563 6574 6f20 2b20 2226 636f 6e73  oduceto + "&cons
-00007ab0: 756d 6572 6964 3d22 2b63 6f6e 7375 6d65  umerid="+consume
-00007ac0: 7269 6420 2b0d 0a20 2020 2020 2020 2020  rid +..         
-00007ad0: 2226 6465 6c61 793d 2220 2b20 7374 7228  "&delay=" + str(
-00007ae0: 6465 6c61 7929 202b 2022 2665 6e61 626c  delay) + "&enabl
-00007af0: 6574 6c73 3d22 202b 2073 7472 2865 6e61  etls=" + str(ena
-00007b00: 626c 6574 6c73 2920 2b20 2226 7072 6f64  bletls) + "&prod
-00007b10: 7563 6572 6964 3d22 2b70 726f 6475 6365  ucerid="+produce
-00007b20: 7269 6420 2b20 2226 636f 6d70 616e 796e  rid + "&companyn
-00007b30: 616d 653d 222b 636f 6d70 616e 796e 616d  ame="+companynam
-00007b40: 6520 2b0d 0a20 2020 2020 2020 2020 2226  e +..         "&
-00007b50: 7061 7274 6974 696f 6e3d 222b 7374 7228  partition="+str(
-00007b60: 7061 7274 6974 696f 6e29 2b22 266f 6666  partition)+"&off
-00007b70: 7365 743d 222b 7374 7228 6f66 6673 6574  set="+str(offset
-00007b80: 292b 2226 6973 6d69 6e3d 222b 7374 7228  )+"&ismin="+str(
-00007b90: 6973 6d69 6e29 2b22 2663 6f6e 7374 7261  ismin)+"&constra
-00007ba0: 696e 7473 3d22 2b63 6f6e 7374 7261 696e  ints="+constrain
-00007bb0: 7473 2b22 2673 7472 6574 6368 626f 756e  ts+"&stretchboun
-00007bc0: 6473 3d22 2b73 7472 2873 7472 6574 6368  ds="+str(stretch
-00007bd0: 626f 756e 6473 292b 0d0a 2020 2020 2020  bounds)+..      
-00007be0: 2020 2022 2668 7064 6568 6f73 743d 2220     "&hpdehost=" 
-00007bf0: 2b68 7064 6568 6f73 7420 2b22 2668 7064  +hpdehost +"&hpd
-00007c00: 6570 6f72 743d 222b 7374 7228 6870 6465  eport="+str(hpde
-00007c10: 706f 7274 2920 2b20 2226 7573 6564 6570  port) + "&usedep
-00007c20: 6c6f 793d 2220 2b73 7472 2875 7365 6465  loy=" +str(usede
-00007c30: 706c 6f79 2920 2b20 2226 636f 6e73 7472  ploy) + "&constr
-00007c40: 6169 6e74 7479 7065 3d22 202b 7374 7228  ainttype=" +str(
-00007c50: 636f 6e73 7472 6169 6e74 7479 7065 2920  constrainttype) 
-00007c60: 2b22 2665 7073 696c 6f6e 3d22 202b 7374  +"&epsilon=" +st
-00007c70: 7228 6570 7369 6c6f 6e29 202b 2022 2674  r(epsilon) + "&t
-00007c80: 6f70 6963 6964 3d22 202b 2073 7472 2874  opicid=" + str(t
-00007c90: 6f70 6963 6964 2920 290d 0a0d 0a20 2020  opicid) )....   
-00007ca0: 2076 616c 3d6c 6f6f 702e 7275 6e5f 756e   val=loop.run_un
-00007cb0: 7469 6c5f 636f 6d70 6c65 7465 2874 6370  til_complete(tcp
-00007cc0: 5f65 6368 6f5f 636c 6965 6e74 7669 7065  _echo_clientvipe
-00007cd0: 7228 7661 6c75 652c 206c 6f6f 702c 686f  r(value, loop,ho
-00007ce0: 7374 2c70 6f72 742c 6d69 6372 6f73 6572  st,port,microser
-00007cf0: 7669 6365 6964 2c74 696d 656f 7574 2929  viceid,timeout))
-00007d00: 0d0a 2020 2020 6966 2063 6f6e 6e65 6374  ..    if connect
-00007d10: 696f 6e65 7272 6f72 3a0d 0a20 2020 2020  ionerror:..     
-00007d20: 2020 2020 7265 7475 726e 2063 6f6e 6e65      return conne
-00007d30: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
-00007d40: 2020 7265 7475 726e 2076 616c 0d0a 0d0a    return val....
-00007d50: 6465 6620 7669 7065 7268 7064 6574 7261  def viperhpdetra
-00007d60: 696e 696e 6728 7669 7065 7274 6f6b 656e  ining(vipertoken
-00007d70: 2c68 6f73 742c 706f 7274 2c63 6f6e 7375  ,host,port,consu
-00007d80: 6d65 6672 6f6d 2c70 726f 6475 6365 746f  mefrom,produceto
-00007d90: 2c63 6f6d 7061 6e79 6e61 6d65 2c63 6f6e  ,companyname,con
-00007da0: 7375 6d65 7269 642c 7072 6f64 7563 6572  sumerid,producer
-00007db0: 6964 2c68 7064 6568 6f73 742c 7669 7065  id,hpdehost,vipe
-00007dc0: 7263 6f6e 6669 6766 696c 652c 0d0a 2020  rconfigfile,..  
-00007dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007de0: 2020 2020 656e 6162 6c65 746c 733d 312c      enabletls=1,
-00007df0: 7061 7274 6974 696f 6e3d 2d31 2c64 6570  partition=-1,dep
-00007e00: 6c6f 793d 302c 6d6f 6465 6c72 756e 733d  loy=0,modelruns=
-00007e10: 3130 2c6d 6f64 656c 7365 6172 6368 7475  10,modelsearchtu
-00007e20: 6e65 723d 3830 2c68 7064 6570 6f72 743d  ner=80,hpdeport=
-00007e30: 2d39 3939 2c6f 6666 7365 743d 2d31 2c69  -999,offset=-1,i
-00007e40: 736c 6f67 6973 7469 633d 302c 0d0a 2020  slogistic=0,..  
-00007e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e60: 2020 2020 6272 6f6b 6572 686f 7374 3d27      brokerhost='
-00007e70: 272c 6272 6f6b 6572 706f 7274 3d39 3039  ',brokerport=909
-00007e80: 322c 7469 6d65 6f75 743d 3132 302c 6d69  2,timeout=120,mi
-00007e90: 6372 6f73 6572 7669 6365 6964 3d27 272c  croserviceid='',
-00007ea0: 746f 7069 6369 643d 2d39 3939 2c6d 6169  topicid=-999,mai
-00007eb0: 6e74 6f70 6963 3d27 272c 0d0a 2020 2020  ntopic='',..    
-00007ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ed0: 2020 696e 6465 7065 6e64 656e 7476 6172    independentvar
-00007ee0: 6961 626c 6573 3d27 272c 6465 7065 6e64  iables='',depend
-00007ef0: 656e 7476 6172 6961 626c 653d 2727 2c72  entvariable='',r
-00007f00: 6f6c 6c62 6163 6b6f 6666 7365 7473 3d30  ollbackoffsets=0
-00007f10: 2c66 756c 6c70 6174 6874 6f74 7261 696e  ,fullpathtotrain
-00007f20: 696e 6764 6174 613d 2727 2c70 726f 6365  ingdata='',proce
-00007f30: 7373 6c6f 6769 633d 2727 2c0d 0a20 2020  sslogic='',..   
-00007f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f50: 2020 2069 6465 6e74 6966 6965 723d 2727     identifier=''
-00007f60: 2c61 7272 6179 3d30 2c74 7261 6e73 666f  ,array=0,transfo
-00007f70: 726d 7479 7065 3d27 272c 7365 6e64 636f  rmtype='',sendco
-00007f80: 6566 746f 3d27 272c 636f 6566 746f 7072  efto='',coeftopr
-00007f90: 6f63 6573 733d 2727 2c63 6f65 6673 7562  ocess='',coefsub
-00007fa0: 746f 7069 636e 616d 6573 3d27 2729 3a0d  topicnames=''):.
-00007fb0: 0a0d 0a20 2020 2023 7265 6164 7320 7468  ...    #reads th
-00007fc0: 6520 6669 656c 646e 616d 6573 2061 6e64  e fieldnames and
-00007fd0: 2067 6574 7320 6c61 7465 7374 2064 6174   gets latest dat
-00007fe0: 6120 6672 6f6d 2065 6163 6820 7374 7265  a from each stre
-00007ff0: 616d 2028 6f72 2066 6965 6c64 6e61 6d65  am (or fieldname
-00008000: 290d 0a20 2020 2067 6c6f 6261 6c20 636f  )..    global co
-00008010: 6e6e 6563 7469 6f6e 6572 726f 720d 0a20  nnectionerror.. 
-00008020: 2020 200d 0a20 2020 2069 6620 286c 656e     ..    if (len
-00008030: 2868 6f73 7429 3d3d 3020 6f72 206c 656e  (host)==0 or len
-00008040: 2876 6970 6572 746f 6b65 6e29 3d3d 3020  (vipertoken)==0 
-00008050: 6f72 2070 6f72 743d 3d2d 3939 3920 206f  or port==-999  o
-00008060: 7220 6c65 6e28 7072 6f64 7563 6574 6f29  r len(produceto)
-00008070: 3d3d 3020 6f72 206c 656e 2863 6f6d 7061  ==0 or len(compa
-00008080: 6e79 6e61 6d65 293d 3d30 206f 720d 0a20  nyname)==0 or.. 
-00008090: 2020 2020 2020 206c 656e 2868 7064 6568         len(hpdeh
-000080a0: 6f73 7429 3d3d 3020 6f72 2068 7064 6570  ost)==0 or hpdep
-000080b0: 6f72 743d 3d2d 3939 3929 3a0d 0a20 2020  ort==-999):..   
-000080c0: 2020 2020 2020 7265 7475 726e 2022 506c        return "Pl
-000080d0: 6561 7365 2065 6e74 6572 2068 6f73 742c  ease enter host,
-000080e0: 706f 7274 2c76 6970 6572 746f 6b65 6e2c  port,vipertoken,
-000080f0: 636f 6e73 756d 6566 726f 6d2c 7072 6f64  consumefrom,prod
-00008100: 7563 6574 6f2c 636f 6d70 616e 796e 616d  uceto,companynam
-00008110: 652c 6870 6465 686f 7374 2c68 7064 6570  e,hpdehost,hpdep
-00008120: 6f72 7422 0d0a 2020 2020 6966 2028 6973  ort"..    if (is
-00008130: 6c6f 6769 7374 6963 3d3d 3120 616e 6420  logistic==1 and 
-00008140: 7072 6f63 6573 736c 6f67 6963 3d3d 2727  processlogic==''
-00008150: 293a 0d0a 2020 2020 2020 2020 2072 6574  ):..         ret
-00008160: 7572 6e20 2253 696e 6365 2079 6f75 2061  urn "Since you a
-00008170: 7265 2064 6f69 6e67 206c 6f67 6973 7469  re doing logisti
-00008180: 632c 2070 6c65 6173 6520 656e 7465 7220  c, please enter 
-00008190: 7072 6f63 6573 736c 6f67 6963 220d 0a20  processlogic".. 
-000081a0: 2020 2020 2020 200d 0a20 2020 2076 616c         ..    val
-000081b0: 7565 3d28 2276 6970 6572 6870 6465 7472  ue=("viperhpdetr
-000081c0: 6169 6e69 6e67 3f76 6970 6572 746f 6b65  aining?vipertoke
-000081d0: 6e3d 222b 7669 7065 7274 6f6b 656e 202b  n="+vipertoken +
-000081e0: 2022 2663 6f6e 7375 6d65 6672 6f6d 3d22   "&consumefrom="
-000081f0: 2b63 6f6e 7375 6d65 6672 6f6d 202b 2022  +consumefrom + "
-00008200: 2670 726f 6475 6365 746f 3d22 202b 2070  &produceto=" + p
-00008210: 726f 6475 6365 746f 202b 2022 2663 6f6e  roduceto + "&con
-00008220: 7375 6d65 7269 643d 222b 636f 6e73 756d  sumerid="+consum
-00008230: 6572 6964 202b 0d0a 2020 2020 2020 2020  erid +..        
-00008240: 2020 2022 2670 726f 6475 6365 7269 643d     "&producerid=
-00008250: 222b 7072 6f64 7563 6572 6964 202b 2022  "+producerid + "
-00008260: 2663 6f6d 7061 6e79 6e61 6d65 3d22 2b63  &companyname="+c
-00008270: 6f6d 7061 6e79 6e61 6d65 202b 2022 2670  ompanyname + "&p
-00008280: 6172 7469 7469 6f6e 3d22 2b73 7472 2870  artition="+str(p
-00008290: 6172 7469 7469 6f6e 292b 2226 6d6f 6465  artition)+"&mode
-000082a0: 6c72 756e 733d 222b 7374 7228 6d6f 6465  lruns="+str(mode
-000082b0: 6c72 756e 7329 202b 2226 6870 6465 686f  lruns) +"&hpdeho
-000082c0: 7374 3d22 202b 6870 6465 686f 7374 202b  st=" +hpdehost +
-000082d0: 0d0a 2020 2020 2020 2020 2020 2022 2668  ..           "&h
-000082e0: 7064 6570 6f72 743d 222b 7374 7228 6870  pdeport="+str(hp
-000082f0: 6465 706f 7274 292b 2226 6272 6f6b 6572  deport)+"&broker
-00008300: 686f 7374 3d22 2b62 726f 6b65 7268 6f73  host="+brokerhos
-00008310: 742b 2022 266d 6f64 656c 7365 6172 6368  t+ "&modelsearch
-00008320: 7475 6e65 723d 222b 7374 7228 6d6f 6465  tuner="+str(mode
-00008330: 6c73 6561 7263 6874 756e 6572 292b 2022  lsearchtuner)+ "
-00008340: 266f 6666 7365 743d 222b 7374 7228 6f66  &offset="+str(of
-00008350: 6673 6574 2920 2b20 2226 7669 7065 7263  fset) + "&viperc
-00008360: 6f6e 6669 6766 696c 653d 222b 7669 7065  onfigfile="+vipe
-00008370: 7263 6f6e 6669 6766 696c 6520 2b0d 0a20  rconfigfile +.. 
-00008380: 2020 2020 2020 2020 2020 2226 6272 6f6b            "&brok
-00008390: 6572 706f 7274 3d22 2b73 7472 2862 726f  erport="+str(bro
-000083a0: 6b65 7270 6f72 7429 2b22 2665 6e61 626c  kerport)+"&enabl
-000083b0: 6574 6c73 3d22 2b73 7472 2865 6e61 626c  etls="+str(enabl
-000083c0: 6574 6c73 2920 2b22 2664 6570 6c6f 793d  etls) +"&deploy=
-000083d0: 222b 7374 7228 6465 706c 6f79 2920 2b20  "+str(deploy) + 
-000083e0: 2226 6973 6c6f 6769 7374 6963 3d22 202b  "&islogistic=" +
-000083f0: 2073 7472 2869 736c 6f67 6973 7469 6329   str(islogistic)
-00008400: 202b 0d0a 2020 2020 2020 2020 2020 2022   +..           "
-00008410: 2674 696d 656f 7574 3d22 2b73 7472 2874  &timeout="+str(t
-00008420: 696d 656f 7574 2920 2b20 2226 746f 7069  imeout) + "&topi
-00008430: 6369 643d 2220 2b20 7374 7228 746f 7069  cid=" + str(topi
-00008440: 6369 6429 202b 2022 266d 6169 6e74 6f70  cid) + "&maintop
-00008450: 6963 3d22 202b 206d 6169 6e74 6f70 6963  ic=" + maintopic
-00008460: 202b 2022 2669 6e64 6570 656e 6465 6e74   + "&independent
-00008470: 7661 7269 6162 6c65 733d 2220 2b20 696e  variables=" + in
-00008480: 6465 7065 6e64 656e 7476 6172 6961 626c  dependentvariabl
-00008490: 6573 202b 0d0a 2020 2020 2020 2020 2020  es +..          
-000084a0: 2022 2664 6570 656e 6465 6e74 7661 7269   "&dependentvari
-000084b0: 6162 6c65 3d22 202b 2064 6570 656e 6465  able=" + depende
-000084c0: 6e74 7661 7269 6162 6c65 202b 2022 2672  ntvariable + "&r
-000084d0: 6f6c 6c62 6163 6b6f 6666 7365 7473 3d22  ollbackoffsets="
-000084e0: 202b 2073 7472 2872 6f6c 6c62 6163 6b6f   + str(rollbacko
-000084f0: 6666 7365 7473 292b 0d0a 2020 2020 2020  ffsets)+..      
-00008500: 2020 2020 2022 2666 756c 6c70 6174 6874       "&fullpatht
-00008510: 6f74 7261 696e 696e 6764 6174 613d 222b  otrainingdata="+
-00008520: 6675 6c6c 7061 7468 746f 7472 6169 6e69  fullpathtotraini
-00008530: 6e67 6461 7461 202b 2022 2670 726f 6365  ngdata + "&proce
-00008540: 7373 6c6f 6769 633d 2220 2b20 7072 6f63  sslogic=" + proc
-00008550: 6573 736c 6f67 6963 2b20 2226 6964 656e  esslogic+ "&iden
-00008560: 7469 6669 6572 3d22 202b 2069 6465 6e74  tifier=" + ident
-00008570: 6966 6965 7220 2b0d 0a20 2020 2020 2020  ifier +..       
-00008580: 2020 2020 2226 6172 7261 793d 2220 2b20      "&array=" + 
-00008590: 7374 7228 6172 7261 7929 202b 2022 2674  str(array) + "&t
-000085a0: 7261 6e73 666f 726d 7479 7065 3d22 202b  ransformtype=" +
-000085b0: 2074 7261 6e73 666f 726d 7479 7065 202b   transformtype +
-000085c0: 2022 2673 656e 6463 6f65 6674 6f3d 2220   "&sendcoefto=" 
-000085d0: 2b20 7365 6e64 636f 6566 746f 202b 2022  + sendcoefto + "
-000085e0: 2663 6f65 6674 6f70 726f 6365 7373 3d22  &coeftoprocess="
-000085f0: 202b 2063 6f65 6674 6f70 726f 6365 7373   + coeftoprocess
-00008600: 202b 0d0a 2020 2020 2020 2020 2020 2022   +..           "
-00008610: 2663 6f65 6673 7562 746f 7069 636e 616d  &coefsubtopicnam
-00008620: 6573 3d22 202b 2063 6f65 6673 7562 746f  es=" + coefsubto
-00008630: 7069 636e 616d 6573 290d 0a0d 0a20 2020  picnames)....   
-00008640: 2076 616c 3d6c 6f6f 702e 7275 6e5f 756e   val=loop.run_un
-00008650: 7469 6c5f 636f 6d70 6c65 7465 2874 6370  til_complete(tcp
-00008660: 5f65 6368 6f5f 636c 6965 6e74 7669 7065  _echo_clientvipe
-00008670: 7228 7661 6c75 652c 206c 6f6f 702c 686f  r(value, loop,ho
-00008680: 7374 2c70 6f72 742c 6d69 6372 6f73 6572  st,port,microser
-00008690: 7669 6365 6964 2c74 696d 656f 7574 2929  viceid,timeout))
-000086a0: 0d0a 2020 2020 6966 2063 6f6e 6e65 6374  ..    if connect
-000086b0: 696f 6e65 7272 6f72 3a0d 0a20 2020 2020  ionerror:..     
-000086c0: 2020 2020 7265 7475 726e 2063 6f6e 6e65      return conne
-000086d0: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
-000086e0: 2020 7265 7475 726e 2076 616c 0d0a 0d0a    return val....
-000086f0: 6465 6620 7669 7065 7268 7064 6574 7261  def viperhpdetra
-00008700: 696e 696e 6762 6174 6368 2876 6970 6572  iningbatch(viper
-00008710: 746f 6b65 6e2c 686f 7374 2c70 6f72 742c  token,host,port,
-00008720: 636f 6e73 756d 6566 726f 6d2c 7072 6f64  consumefrom,prod
-00008730: 7563 6574 6f2c 636f 6d70 616e 796e 616d  uceto,companynam
-00008740: 652c 636f 6e73 756d 6572 6964 2c70 726f  e,consumerid,pro
-00008750: 6475 6365 7269 642c 6870 6465 686f 7374  ducerid,hpdehost
-00008760: 2c76 6970 6572 636f 6e66 6967 6669 6c65  ,viperconfigfile
-00008770: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00008780: 2020 2020 2020 2020 2065 6e61 626c 6574           enablet
-00008790: 6c73 3d31 2c70 6172 7469 7469 6f6e 3d2d  ls=1,partition=-
-000087a0: 312c 6465 706c 6f79 3d30 2c6d 6f64 656c  1,deploy=0,model
-000087b0: 7275 6e73 3d31 302c 6d6f 6465 6c73 6561  runs=10,modelsea
-000087c0: 7263 6874 756e 6572 3d38 302c 6870 6465  rchtuner=80,hpde
-000087d0: 706f 7274 3d2d 3939 392c 6f66 6673 6574  port=-999,offset
-000087e0: 3d2d 312c 6973 6c6f 6769 7374 6963 3d30  =-1,islogistic=0
-000087f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00008800: 2020 2020 2020 2020 2062 726f 6b65 7268           brokerh
-00008810: 6f73 743d 2727 2c62 726f 6b65 7270 6f72  ost='',brokerpor
-00008820: 743d 3930 3932 2c74 696d 656f 7574 3d31  t=9092,timeout=1
-00008830: 3230 2c6d 6963 726f 7365 7276 6963 6569  20,microservicei
-00008840: 643d 2727 2c74 6f70 6963 6964 3d22 2d39  d='',topicid="-9
-00008850: 3939 222c 6d61 696e 746f 7069 633d 2727  99",maintopic=''
-00008860: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00008870: 2020 2020 2020 2020 2069 6e64 6570 656e           indepen
-00008880: 6465 6e74 7661 7269 6162 6c65 733d 2727  dentvariables=''
-00008890: 2c64 6570 656e 6465 6e74 7661 7269 6162  ,dependentvariab
-000088a0: 6c65 3d27 272c 726f 6c6c 6261 636b 6f66  le='',rollbackof
-000088b0: 6673 6574 733d 302c 6675 6c6c 7061 7468  fsets=0,fullpath
-000088c0: 746f 7472 6169 6e69 6e67 6461 7461 3d27  totrainingdata='
-000088d0: 272c 7072 6f63 6573 736c 6f67 6963 3d27  ',processlogic='
-000088e0: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
-000088f0: 2020 2020 2020 2020 2020 6964 656e 7469            identi
-00008900: 6669 6572 3d27 272c 6172 7261 793d 302c  fier='',array=0,
-00008910: 7469 6d65 6465 6c61 793d 302c 6173 796e  timedelay=0,asyn
-00008920: 6374 696d 656f 7574 3d31 3230 293a 0d0a  ctimeout=120):..
-00008930: 0d0a 2020 2020 2372 6561 6473 2074 6865  ..    #reads the
-00008940: 2066 6965 6c64 6e61 6d65 7320 616e 6420   fieldnames and 
-00008950: 6765 7473 206c 6174 6573 7420 6461 7461  gets latest data
-00008960: 2066 726f 6d20 6561 6368 2073 7472 6561   from each strea
-00008970: 6d20 286f 7220 6669 656c 646e 616d 6529  m (or fieldname)
-00008980: 0d0a 2020 2020 676c 6f62 616c 2063 6f6e  ..    global con
-00008990: 6e65 6374 696f 6e65 7272 6f72 0d0a 2020  nectionerror..  
-000089a0: 2020 0d0a 2020 2020 6966 2028 6c65 6e28    ..    if (len(
-000089b0: 686f 7374 293d 3d30 206f 7220 6c65 6e28  host)==0 or len(
-000089c0: 7669 7065 7274 6f6b 656e 293d 3d30 206f  vipertoken)==0 o
-000089d0: 7220 706f 7274 3d3d 2d39 3939 2020 6f72  r port==-999  or
-000089e0: 206c 656e 2870 726f 6475 6365 746f 293d   len(produceto)=
-000089f0: 3d30 206f 7220 6c65 6e28 636f 6d70 616e  =0 or len(compan
-00008a00: 796e 616d 6529 3d3d 3020 6f72 0d0a 2020  yname)==0 or..  
-00008a10: 2020 2020 2020 6c65 6e28 6870 6465 686f        len(hpdeho
-00008a20: 7374 293d 3d30 206f 7220 6870 6465 706f  st)==0 or hpdepo
-00008a30: 7274 3d3d 2d39 3939 293a 0d0a 2020 2020  rt==-999):..    
-00008a40: 2020 2020 2072 6574 7572 6e20 2250 6c65       return "Ple
-00008a50: 6173 6520 656e 7465 7220 686f 7374 2c70  ase enter host,p
-00008a60: 6f72 742c 7669 7065 7274 6f6b 656e 2c63  ort,vipertoken,c
-00008a70: 6f6e 7375 6d65 6672 6f6d 2c70 726f 6475  onsumefrom,produ
-00008a80: 6365 746f 2c63 6f6d 7061 6e79 6e61 6d65  ceto,companyname
-00008a90: 2c68 7064 6568 6f73 742c 6870 6465 706f  ,hpdehost,hpdepo
-00008aa0: 7274 220d 0a20 2020 2069 6620 2869 736c  rt"..    if (isl
-00008ab0: 6f67 6973 7469 633d 3d31 2061 6e64 2070  ogistic==1 and p
-00008ac0: 726f 6365 7373 6c6f 6769 633d 3d27 2729  rocesslogic=='')
-00008ad0: 3a0d 0a20 2020 2020 2020 2020 7265 7475  :..         retu
-00008ae0: 726e 2022 5369 6e63 6520 796f 7520 6172  rn "Since you ar
-00008af0: 6520 646f 696e 6720 6c6f 6769 7374 6963  e doing logistic
-00008b00: 2c20 706c 6561 7365 2065 6e74 6572 2070  , please enter p
-00008b10: 726f 6365 7373 6c6f 6769 6322 0d0a 2020  rocesslogic"..  
-00008b20: 2020 2020 2020 0d0a 2020 2020 7661 6c75        ..    valu
-00008b30: 653d 2822 7669 7065 7268 7064 6574 7261  e=("viperhpdetra
-00008b40: 696e 696e 6762 6174 6368 3f76 6970 6572  iningbatch?viper
-00008b50: 746f 6b65 6e3d 222b 7669 7065 7274 6f6b  token="+vipertok
-00008b60: 656e 202b 2022 2663 6f6e 7375 6d65 6672  en + "&consumefr
-00008b70: 6f6d 3d22 2b63 6f6e 7375 6d65 6672 6f6d  om="+consumefrom
-00008b80: 202b 2022 2670 726f 6475 6365 746f 3d22   + "&produceto="
-00008b90: 202b 2070 726f 6475 6365 746f 202b 2022   + produceto + "
-00008ba0: 2663 6f6e 7375 6d65 7269 643d 222b 636f  &consumerid="+co
-00008bb0: 6e73 756d 6572 6964 202b 0d0a 2020 2020  nsumerid +..    
-00008bc0: 2020 2020 2020 2022 2670 726f 6475 6365         "&produce
-00008bd0: 7269 643d 222b 7072 6f64 7563 6572 6964  rid="+producerid
-00008be0: 202b 2022 2663 6f6d 7061 6e79 6e61 6d65   + "&companyname
-00008bf0: 3d22 2b63 6f6d 7061 6e79 6e61 6d65 202b  ="+companyname +
-00008c00: 2022 2670 6172 7469 7469 6f6e 3d22 2b73   "&partition="+s
-00008c10: 7472 2870 6172 7469 7469 6f6e 292b 2226  tr(partition)+"&
-00008c20: 6d6f 6465 6c72 756e 733d 222b 7374 7228  modelruns="+str(
-00008c30: 6d6f 6465 6c72 756e 7329 202b 2226 6870  modelruns) +"&hp
-00008c40: 6465 686f 7374 3d22 202b 6870 6465 686f  dehost=" +hpdeho
-00008c50: 7374 202b 0d0a 2020 2020 2020 2020 2020  st +..          
-00008c60: 2022 2668 7064 6570 6f72 743d 222b 7374   "&hpdeport="+st
-00008c70: 7228 6870 6465 706f 7274 292b 2226 6272  r(hpdeport)+"&br
-00008c80: 6f6b 6572 686f 7374 3d22 2b62 726f 6b65  okerhost="+broke
-00008c90: 7268 6f73 742b 2022 266d 6f64 656c 7365  rhost+ "&modelse
-00008ca0: 6172 6368 7475 6e65 723d 222b 7374 7228  archtuner="+str(
-00008cb0: 6d6f 6465 6c73 6561 7263 6874 756e 6572  modelsearchtuner
-00008cc0: 292b 2022 266f 6666 7365 743d 222b 7374  )+ "&offset="+st
-00008cd0: 7228 6f66 6673 6574 2920 2b20 2226 7669  r(offset) + "&vi
-00008ce0: 7065 7263 6f6e 6669 6766 696c 653d 222b  perconfigfile="+
-00008cf0: 7669 7065 7263 6f6e 6669 6766 696c 6520  viperconfigfile 
-00008d00: 2b0d 0a20 2020 2020 2020 2020 2020 2226  +..           "&
-00008d10: 6272 6f6b 6572 706f 7274 3d22 2b73 7472  brokerport="+str
-00008d20: 2862 726f 6b65 7270 6f72 7429 2b22 2665  (brokerport)+"&e
-00008d30: 6e61 626c 6574 6c73 3d22 2b73 7472 2865  nabletls="+str(e
-00008d40: 6e61 626c 6574 6c73 2920 2b22 2664 6570  nabletls) +"&dep
-00008d50: 6c6f 793d 222b 7374 7228 6465 706c 6f79  loy="+str(deploy
-00008d60: 2920 2b20 2226 6973 6c6f 6769 7374 6963  ) + "&islogistic
-00008d70: 3d22 202b 2073 7472 2869 736c 6f67 6973  =" + str(islogis
-00008d80: 7469 6329 202b 0d0a 2020 2020 2020 2020  tic) +..        
-00008d90: 2020 2022 2674 696d 656f 7574 3d22 2b73     "&timeout="+s
-00008da0: 7472 2874 696d 656f 7574 2920 2b20 2226  tr(timeout) + "&
-00008db0: 746f 7069 6369 643d 2220 2b20 746f 7069  topicid=" + topi
-00008dc0: 6369 6420 2b20 2226 6d61 696e 746f 7069  cid + "&maintopi
-00008dd0: 633d 2220 2b20 6d61 696e 746f 7069 6320  c=" + maintopic 
-00008de0: 2b20 2226 696e 6465 7065 6e64 656e 7476  + "&independentv
-00008df0: 6172 6961 626c 6573 3d22 202b 2069 6e64  ariables=" + ind
-00008e00: 6570 656e 6465 6e74 7661 7269 6162 6c65  ependentvariable
-00008e10: 7320 2b0d 0a20 2020 2020 2020 2020 2020  s +..           
-00008e20: 2226 6465 7065 6e64 656e 7476 6172 6961  "&dependentvaria
-00008e30: 626c 653d 2220 2b20 6465 7065 6e64 656e  ble=" + dependen
-00008e40: 7476 6172 6961 626c 6520 2b20 2226 726f  tvariable + "&ro
-00008e50: 6c6c 6261 636b 6f66 6673 6574 733d 2220  llbackoffsets=" 
-00008e60: 2b20 7374 7228 726f 6c6c 6261 636b 6f66  + str(rollbackof
-00008e70: 6673 6574 7329 2b0d 0a20 2020 2020 2020  fsets)+..       
-00008e80: 2020 2020 2226 6675 6c6c 7061 7468 746f      "&fullpathto
-00008e90: 7472 6169 6e69 6e67 6461 7461 3d22 2b66  trainingdata="+f
-00008ea0: 756c 6c70 6174 6874 6f74 7261 696e 696e  ullpathtotrainin
-00008eb0: 6764 6174 6120 2b20 2226 7072 6f63 6573  gdata + "&proces
-00008ec0: 736c 6f67 6963 3d22 202b 2070 726f 6365  slogic=" + proce
-00008ed0: 7373 6c6f 6769 632b 2022 2669 6465 6e74  sslogic+ "&ident
-00008ee0: 6966 6965 723d 2220 2b20 6964 656e 7469  ifier=" + identi
-00008ef0: 6669 6572 202b 2022 2661 7272 6179 3d22  fier + "&array="
-00008f00: 0d0a 2020 2020 2020 2020 2020 202b 2073  ..           + s
-00008f10: 7472 2861 7272 6179 292b 2022 2674 696d  tr(array)+ "&tim
-00008f20: 6564 656c 6179 3d22 202b 2073 7472 2874  edelay=" + str(t
-00008f30: 696d 6564 656c 6179 2929 0d0a 0d0a 2020  imedelay))....  
-00008f40: 2020 7661 6c3d 6c6f 6f70 2e72 756e 5f75    val=loop.run_u
-00008f50: 6e74 696c 5f63 6f6d 706c 6574 6528 7463  ntil_complete(tc
-00008f60: 705f 6563 686f 5f63 6c69 656e 7476 6970  p_echo_clientvip
-00008f70: 6572 2876 616c 7565 2c20 6c6f 6f70 2c68  er(value, loop,h
-00008f80: 6f73 742c 706f 7274 2c6d 6963 726f 7365  ost,port,microse
-00008f90: 7276 6963 6569 642c 6173 796e 6374 696d  rviceid,asynctim
-00008fa0: 656f 7574 2929 0d0a 2020 2020 6966 2063  eout))..    if c
-00008fb0: 6f6e 6e65 6374 696f 6e65 7272 6f72 3a0d  onnectionerror:.
-00008fc0: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
-00008fd0: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
-00008fe0: 0d0a 0d0a 2020 2020 7265 7475 726e 2076  ....    return v
-00008ff0: 616c 0d0a 0d0a 6465 6620 7669 7065 7261  al....def vipera
-00009000: 6e6f 6d61 6c79 7472 6169 6e62 6174 6368  nomalytrainbatch
-00009010: 2876 6970 6572 746f 6b65 6e2c 686f 7374  (vipertoken,host
-00009020: 2c70 6f72 742c 636f 6e73 756d 6566 726f  ,port,consumefro
-00009030: 6d2c 7072 6f64 7563 6574 6f2c 7072 6f64  m,produceto,prod
-00009040: 7563 6570 6565 7267 726f 7570 746f 2c70  ucepeergroupto,p
-00009050: 726f 6475 6365 7269 6470 6565 7267 726f  roduceridpeergro
-00009060: 7570 2c63 6f6e 7375 6d65 7269 6470 726f  up,consumeridpro
-00009070: 6475 6365 746f 2c0d 0a20 2020 2020 2020  duceto,..       
-00009080: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00009090: 7472 6561 6d73 746f 616e 616c 7973 652c  treamstoanalyse,
-000090a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000090b0: 2020 2020 2020 2020 636f 6d70 616e 796e          companyn
-000090c0: 616d 652c 636f 6e73 756d 6572 6964 2c70  ame,consumerid,p
-000090d0: 726f 6475 6365 7269 642c 666c 6167 732c  roducerid,flags,
-000090e0: 6870 6465 686f 7374 2c76 6970 6572 636f  hpdehost,viperco
-000090f0: 6e66 6967 6669 6c65 2c0d 0a20 2020 2020  nfigfile,..     
-00009100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009110: 2065 6e61 626c 6574 6c73 3d31 2c70 6172   enabletls=1,par
-00009120: 7469 7469 6f6e 3d2d 312c 6870 6465 706f  tition=-1,hpdepo
-00009130: 7274 3d2d 3939 392c 746f 7069 6369 643d  rt=-999,topicid=
-00009140: 222d 3939 3922 2c6d 6169 6e74 6f70 6963  "-999",maintopic
-00009150: 3d27 272c 726f 6c6c 6261 636b 6f66 6673  ='',rollbackoffs
-00009160: 6574 733d 302c 6675 6c6c 7061 7468 746f  ets=0,fullpathto
-00009170: 7472 6169 6e69 6e67 6461 7461 3d27 272c  trainingdata='',
-00009180: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009190: 2020 2020 2020 2020 6272 6f6b 6572 686f          brokerho
-000091a0: 7374 3d27 272c 6272 6f6b 6572 706f 7274  st='',brokerport
-000091b0: 3d39 3039 322c 6465 6c61 793d 3130 3030  =9092,delay=1000
-000091c0: 2c74 696d 656f 7574 3d31 3230 2c6d 6963  ,timeout=120,mic
-000091d0: 726f 7365 7276 6963 6569 643d 2727 2c74  roserviceid='',t
-000091e0: 696d 6564 656c 6179 3d30 2c61 7379 6e63  imedelay=0,async
-000091f0: 7469 6d65 6f75 743d 3132 3029 3a0d 0a20  timeout=120):.. 
-00009200: 2020 2067 6c6f 6261 6c20 636f 6e6e 6563     global connec
-00009210: 7469 6f6e 6572 726f 720d 0a0d 0a20 2020  tionerror....   
-00009220: 2023 7265 6164 7320 7468 6520 6669 656c   #reads the fiel
-00009230: 646e 616d 6573 2061 6e64 2067 6574 7320  dnames and gets 
-00009240: 6c61 7465 7374 2064 6174 6120 6672 6f6d  latest data from
-00009250: 2065 6163 6820 7374 7265 616d 2028 6f72   each stream (or
-00009260: 2066 6965 6c64 6e61 6d65 290d 0a20 2020   fieldname)..   
-00009270: 2069 6620 286c 656e 2868 6f73 7429 3d3d   if (len(host)==
-00009280: 3020 6f72 206c 656e 2876 6970 6572 746f  0 or len(viperto
-00009290: 6b65 6e29 3d3d 3020 6f72 2070 6f72 743d  ken)==0 or port=
-000092a0: 3d2d 3939 3920 6f72 206c 656e 2870 726f  =-999 or len(pro
-000092b0: 6475 6365 746f 293d 3d30 206f 7220 6c65  duceto)==0 or le
-000092c0: 6e28 636f 6d70 616e 796e 616d 6529 3d3d  n(companyname)==
-000092d0: 300d 0a20 2020 2020 2020 2020 2020 2020  0..             
-000092e0: 2020 206f 7220 6c65 6e28 6870 6465 686f     or len(hpdeho
-000092f0: 7374 293d 3d30 206f 7220 6870 6465 706f  st)==0 or hpdepo
-00009300: 7274 3d3d 2d39 3939 206f 7220 6c65 6e28  rt==-999 or len(
-00009310: 7374 7265 616d 7374 6f61 6e61 6c79 7365  streamstoanalyse
-00009320: 293d 3d30 206f 7220 6c65 6e28 7072 6f64  )==0 or len(prod
-00009330: 7563 6570 6565 7267 726f 7570 746f 293d  ucepeergroupto)=
-00009340: 3d30 0d0a 2020 2020 2020 2020 2020 2020  =0..            
-00009350: 2020 2020 6f72 206c 656e 2866 6c61 6773      or len(flags
-00009360: 293d 3d30 206f 7220 6c65 6e28 7669 7065  )==0 or len(vipe
-00009370: 7263 6f6e 6669 6766 696c 6529 3d3d 3029  rconfigfile)==0)
-00009380: 3a0d 0a20 2020 2020 2020 2020 7265 7475  :..         retu
-00009390: 726e 2022 506c 6561 7365 2065 6e74 6572  rn "Please enter
-000093a0: 2068 6f73 742c 706f 7274 2c76 6970 6572   host,port,viper
-000093b0: 746f 6b65 6e2c 7072 6f64 7563 6574 6f2c  token,produceto,
-000093c0: 636f 6d70 616e 796e 616d 652c 7374 7265  companyname,stre
-000093d0: 616d 7374 6f61 6e61 6c79 7365 2c66 6c61  amstoanalyse,fla
-000093e0: 6773 2c70 726f 6475 6365 7065 6572 6772  gs,producepeergr
-000093f0: 6f75 7074 6f2c 6870 6465 686f 7374 2c68  oupto,hpdehost,h
-00009400: 7064 6570 6f72 7422 0d0a 2020 2020 0d0a  pdeport"..    ..
-00009410: 2020 2020 7661 6c75 653d 2822 7669 7065      value=("vipe
-00009420: 7261 6e6f 6d61 6c79 7472 6169 6e62 6174  ranomalytrainbat
-00009430: 6368 3f76 6970 6572 746f 6b65 6e3d 222b  ch?vipertoken="+
-00009440: 7669 7065 7274 6f6b 656e 202b 2022 2663  vipertoken + "&c
-00009450: 6f6e 7375 6d65 6672 6f6d 3d22 2b63 6f6e  onsumefrom="+con
-00009460: 7375 6d65 6672 6f6d 202b 2022 2670 726f  sumefrom + "&pro
-00009470: 6475 6365 746f 3d22 202b 2070 726f 6475  duceto=" + produ
-00009480: 6365 746f 202b 2022 2663 6f6e 7375 6d65  ceto + "&consume
-00009490: 7269 643d 222b 636f 6e73 756d 6572 6964  rid="+consumerid
-000094a0: 202b 0d0a 2020 2020 2020 2020 2020 2022   +..           "
-000094b0: 2670 726f 6475 6365 7065 6572 6772 6f75  &producepeergrou
-000094c0: 7074 6f3d 2220 2b20 7072 6f64 7563 6570  pto=" + producep
-000094d0: 6565 7267 726f 7570 746f 202b 2022 2670  eergroupto + "&p
-000094e0: 726f 6475 6365 7269 6470 6565 7267 726f  roduceridpeergro
-000094f0: 7570 3d22 202b 2070 726f 6475 6365 7269  up=" + produceri
-00009500: 6470 6565 7267 726f 7570 202b 2022 2663  dpeergroup + "&c
-00009510: 6f6e 7375 6d65 7269 6470 726f 6475 6365  onsumeridproduce
-00009520: 746f 3d22 2b63 6f6e 7375 6d65 7269 6470  to="+consumeridp
-00009530: 726f 6475 6365 746f 202b 0d0a 2020 2020  roduceto +..    
-00009540: 2020 2020 2020 2022 2673 7472 6561 6d73         "&streams
-00009550: 746f 616e 616c 7973 653d 222b 7374 7265  toanalyse="+stre
-00009560: 616d 7374 6f61 6e61 6c79 7365 202b 2022  amstoanalyse + "
-00009570: 2666 6c61 6773 3d22 2b66 6c61 6773 202b  &flags="+flags +
-00009580: 2022 2664 656c 6179 3d22 202b 7374 7228   "&delay=" +str(
-00009590: 6465 6c61 7929 202b 2022 2674 696d 656f  delay) + "&timeo
-000095a0: 7574 3d22 202b 2073 7472 2874 696d 656f  ut=" + str(timeo
-000095b0: 7574 2920 2b0d 0a20 2020 2020 2020 2020  ut) +..         
-000095c0: 2020 2226 7072 6f64 7563 6572 6964 3d22    "&producerid="
-000095d0: 2b70 726f 6475 6365 7269 6420 2b20 2226  +producerid + "&
-000095e0: 636f 6d70 616e 796e 616d 653d 222b 636f  companyname="+co
-000095f0: 6d70 616e 796e 616d 6520 2b20 2226 7061  mpanyname + "&pa
-00009600: 7274 6974 696f 6e3d 222b 7374 7228 7061  rtition="+str(pa
-00009610: 7274 6974 696f 6e29 202b 2226 6870 6465  rtition) +"&hpde
-00009620: 686f 7374 3d22 202b 6870 6465 686f 7374  host=" +hpdehost
-00009630: 202b 0d0a 2020 2020 2020 2020 2020 2022   +..           "
-00009640: 2668 7064 6570 6f72 743d 222b 7374 7228  &hpdeport="+str(
-00009650: 6870 6465 706f 7274 292b 2226 6272 6f6b  hpdeport)+"&brok
-00009660: 6572 686f 7374 3d22 2b62 726f 6b65 7268  erhost="+brokerh
-00009670: 6f73 7420 2b20 2226 7669 7065 7263 6f6e  ost + "&vipercon
-00009680: 6669 6766 696c 653d 222b 7669 7065 7263  figfile="+viperc
-00009690: 6f6e 6669 6766 696c 6520 2b0d 0a20 2020  onfigfile +..   
-000096a0: 2020 2020 2020 2020 2226 6272 6f6b 6572          "&broker
-000096b0: 706f 7274 3d22 2b73 7472 2862 726f 6b65  port="+str(broke
-000096c0: 7270 6f72 7429 2b22 2665 6e61 626c 6574  rport)+"&enablet
-000096d0: 6c73 3d22 2b73 7472 2865 6e61 626c 6574  ls="+str(enablet
-000096e0: 6c73 2920 2b22 2674 6f70 6963 6964 3d22  ls) +"&topicid="
-000096f0: 202b 2074 6f70 6963 6964 202b 2022 266d   + topicid + "&m
-00009700: 6169 6e74 6f70 6963 3d22 202b 206d 6169  aintopic=" + mai
-00009710: 6e74 6f70 6963 202b 0d0a 2020 2020 2020  ntopic +..      
-00009720: 2020 2020 2022 2672 6f6c 6c62 6163 6b6f       "&rollbacko
-00009730: 6666 7365 7473 3d22 202b 2073 7472 2872  ffsets=" + str(r
-00009740: 6f6c 6c62 6163 6b6f 6666 7365 7473 2920  ollbackoffsets) 
-00009750: 2b20 2226 6675 6c6c 7061 7468 746f 7472  + "&fullpathtotr
-00009760: 6169 6e69 6e67 6461 7461 3d22 2b66 756c  ainingdata="+ful
-00009770: 6c70 6174 6874 6f74 7261 696e 696e 6764  lpathtotrainingd
-00009780: 6174 612b 2022 2674 696d 6564 656c 6179  ata+ "&timedelay
-00009790: 3d22 202b 2073 7472 2874 696d 6564 656c  =" + str(timedel
-000097a0: 6179 2929 0d0a 0d0a 2020 2020 7661 6c3d  ay))....    val=
-000097b0: 6c6f 6f70 2e72 756e 5f75 6e74 696c 5f63  loop.run_until_c
-000097c0: 6f6d 706c 6574 6528 7463 705f 6563 686f  omplete(tcp_echo
-000097d0: 5f63 6c69 656e 7476 6970 6572 2876 616c  _clientviper(val
-000097e0: 7565 2c20 6c6f 6f70 2c68 6f73 742c 706f  ue, loop,host,po
-000097f0: 7274 2c6d 6963 726f 7365 7276 6963 6569  rt,microservicei
-00009800: 642c 6173 796e 6374 696d 656f 7574 2929  d,asynctimeout))
-00009810: 0d0a 2020 2020 6966 2063 6f6e 6e65 6374  ..    if connect
-00009820: 696f 6e65 7272 6f72 3a0d 0a20 2020 2020  ionerror:..     
-00009830: 2020 2020 7265 7475 726e 2063 6f6e 6e65      return conne
-00009840: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
-00009850: 2020 7265 7475 726e 2076 616c 0d0a 0d0a    return val....
-00009860: 6465 6620 7669 7065 7261 6e6f 6d61 6c79  def viperanomaly
-00009870: 7472 6169 6e28 7669 7065 7274 6f6b 656e  train(vipertoken
-00009880: 2c68 6f73 742c 706f 7274 2c63 6f6e 7375  ,host,port,consu
-00009890: 6d65 6672 6f6d 2c70 726f 6475 6365 746f  mefrom,produceto
-000098a0: 2c70 726f 6475 6365 7065 6572 6772 6f75  ,producepeergrou
-000098b0: 7074 6f2c 7072 6f64 7563 6572 6964 7065  pto,produceridpe
-000098c0: 6572 6772 6f75 702c 636f 6e73 756d 6572  ergroup,consumer
-000098d0: 6964 7072 6f64 7563 6574 6f2c 0d0a 2020  idproduceto,..  
-000098e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000098f0: 2020 2020 7374 7265 616d 7374 6f61 6e61      streamstoana
-00009900: 6c79 7365 2c0d 0a20 2020 2020 2020 2020  lyse,..         
-00009910: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-00009920: 7061 6e79 6e61 6d65 2c63 6f6e 7375 6d65  panyname,consume
-00009930: 7269 642c 7072 6f64 7563 6572 6964 2c66  rid,producerid,f
-00009940: 6c61 6773 2c68 7064 6568 6f73 742c 7669  lags,hpdehost,vi
-00009950: 7065 7263 6f6e 6669 6766 696c 652c 0d0a  perconfigfile,..
-00009960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009970: 2020 2020 2020 656e 6162 6c65 746c 733d        enabletls=
-00009980: 312c 7061 7274 6974 696f 6e3d 2d31 2c68  1,partition=-1,h
-00009990: 7064 6570 6f72 743d 2d39 3939 2c74 6f70  pdeport=-999,top
-000099a0: 6963 6964 3d2d 3939 392c 6d61 696e 746f  icid=-999,mainto
-000099b0: 7069 633d 2727 2c72 6f6c 6c62 6163 6b6f  pic='',rollbacko
-000099c0: 6666 7365 7473 3d30 2c66 756c 6c70 6174  ffsets=0,fullpat
-000099d0: 6874 6f74 7261 696e 696e 6764 6174 613d  htotrainingdata=
-000099e0: 2727 2c0d 0a20 2020 2020 2020 2020 2020  '',..           
-000099f0: 2020 2020 2020 2020 2020 2062 726f 6b65             broke
-00009a00: 7268 6f73 743d 2727 2c62 726f 6b65 7270  rhost='',brokerp
-00009a10: 6f72 743d 3930 3932 2c64 656c 6179 3d31  ort=9092,delay=1
-00009a20: 3030 302c 7469 6d65 6f75 743d 3132 302c  000,timeout=120,
-00009a30: 6d69 6372 6f73 6572 7669 6365 6964 3d27  microserviceid='
-00009a40: 2729 3a0d 0a20 2020 2067 6c6f 6261 6c20  '):..    global 
-00009a50: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
-00009a60: 0a0d 0a20 2020 2023 7265 6164 7320 7468  ...    #reads th
-00009a70: 6520 6669 656c 646e 616d 6573 2061 6e64  e fieldnames and
-00009a80: 2067 6574 7320 6c61 7465 7374 2064 6174   gets latest dat
-00009a90: 6120 6672 6f6d 2065 6163 6820 7374 7265  a from each stre
-00009aa0: 616d 2028 6f72 2066 6965 6c64 6e61 6d65  am (or fieldname
-00009ab0: 290d 0a20 2020 2069 6620 286c 656e 2868  )..    if (len(h
-00009ac0: 6f73 7429 3d3d 3020 6f72 206c 656e 2876  ost)==0 or len(v
-00009ad0: 6970 6572 746f 6b65 6e29 3d3d 3020 6f72  ipertoken)==0 or
-00009ae0: 2070 6f72 743d 3d2d 3939 3920 6f72 206c   port==-999 or l
-00009af0: 656e 2870 726f 6475 6365 746f 293d 3d30  en(produceto)==0
-00009b00: 206f 7220 6c65 6e28 636f 6d70 616e 796e   or len(companyn
-00009b10: 616d 6529 3d3d 300d 0a20 2020 2020 2020  ame)==0..       
-00009b20: 2020 2020 2020 2020 206f 7220 6c65 6e28           or len(
-00009b30: 6870 6465 686f 7374 293d 3d30 206f 7220  hpdehost)==0 or 
-00009b40: 6870 6465 706f 7274 3d3d 2d39 3939 206f  hpdeport==-999 o
-00009b50: 7220 6c65 6e28 7374 7265 616d 7374 6f61  r len(streamstoa
-00009b60: 6e61 6c79 7365 293d 3d30 206f 7220 6c65  nalyse)==0 or le
-00009b70: 6e28 7072 6f64 7563 6570 6565 7267 726f  n(producepeergro
-00009b80: 7570 746f 293d 3d30 0d0a 2020 2020 2020  upto)==0..      
-00009b90: 2020 2020 2020 2020 2020 6f72 206c 656e            or len
-00009ba0: 2866 6c61 6773 293d 3d30 206f 7220 6c65  (flags)==0 or le
-00009bb0: 6e28 7669 7065 7263 6f6e 6669 6766 696c  n(viperconfigfil
-00009bc0: 6529 3d3d 3029 3a0d 0a20 2020 2020 2020  e)==0):..       
-00009bd0: 2020 7265 7475 726e 2022 506c 6561 7365    return "Please
-00009be0: 2065 6e74 6572 2068 6f73 742c 706f 7274   enter host,port
-00009bf0: 2c76 6970 6572 746f 6b65 6e2c 7072 6f64  ,vipertoken,prod
-00009c00: 7563 6574 6f2c 636f 6d70 616e 796e 616d  uceto,companynam
-00009c10: 652c 7374 7265 616d 7374 6f61 6e61 6c79  e,streamstoanaly
-00009c20: 7365 2c66 6c61 6773 2c70 726f 6475 6365  se,flags,produce
-00009c30: 7065 6572 6772 6f75 7074 6f2c 6870 6465  peergroupto,hpde
-00009c40: 686f 7374 2c68 7064 6570 6f72 7422 0d0a  host,hpdeport"..
-00009c50: 2020 2020 0d0a 2020 2020 7661 6c75 653d      ..    value=
-00009c60: 2822 7669 7065 7261 6e6f 6d61 6c79 7472  ("viperanomalytr
-00009c70: 6169 6e3f 7669 7065 7274 6f6b 656e 3d22  ain?vipertoken="
-00009c80: 2b76 6970 6572 746f 6b65 6e20 2b20 2226  +vipertoken + "&
-00009c90: 636f 6e73 756d 6566 726f 6d3d 222b 636f  consumefrom="+co
-00009ca0: 6e73 756d 6566 726f 6d20 2b20 2226 7072  nsumefrom + "&pr
-00009cb0: 6f64 7563 6574 6f3d 2220 2b20 7072 6f64  oduceto=" + prod
-00009cc0: 7563 6574 6f20 2b20 2226 636f 6e73 756d  uceto + "&consum
-00009cd0: 6572 6964 3d22 2b63 6f6e 7375 6d65 7269  erid="+consumeri
-00009ce0: 6420 2b0d 0a20 2020 2020 2020 2020 2020  d +..           
-00009cf0: 2226 7072 6f64 7563 6570 6565 7267 726f  "&producepeergro
-00009d00: 7570 746f 3d22 202b 2070 726f 6475 6365  upto=" + produce
-00009d10: 7065 6572 6772 6f75 7074 6f20 2b20 2226  peergroupto + "&
-00009d20: 7072 6f64 7563 6572 6964 7065 6572 6772  produceridpeergr
-00009d30: 6f75 703d 2220 2b20 7072 6f64 7563 6572  oup=" + producer
-00009d40: 6964 7065 6572 6772 6f75 7020 2b20 2226  idpeergroup + "&
-00009d50: 636f 6e73 756d 6572 6964 7072 6f64 7563  consumeridproduc
-00009d60: 6574 6f3d 222b 636f 6e73 756d 6572 6964  eto="+consumerid
-00009d70: 7072 6f64 7563 6574 6f20 2b0d 0a20 2020  produceto +..   
-00009d80: 2020 2020 2020 2020 2226 7374 7265 616d          "&stream
-00009d90: 7374 6f61 6e61 6c79 7365 3d22 2b73 7472  stoanalyse="+str
-00009da0: 6561 6d73 746f 616e 616c 7973 6520 2b20  eamstoanalyse + 
-00009db0: 2226 666c 6167 733d 222b 666c 6167 7320  "&flags="+flags 
-00009dc0: 2b20 2226 6465 6c61 793d 2220 2b73 7472  + "&delay=" +str
-00009dd0: 2864 656c 6179 2920 2b20 2226 7469 6d65  (delay) + "&time
-00009de0: 6f75 743d 2220 2b20 7374 7228 7469 6d65  out=" + str(time
-00009df0: 6f75 7429 202b 0d0a 2020 2020 2020 2020  out) +..        
-00009e00: 2020 2022 2670 726f 6475 6365 7269 643d     "&producerid=
-00009e10: 222b 7072 6f64 7563 6572 6964 202b 2022  "+producerid + "
-00009e20: 2663 6f6d 7061 6e79 6e61 6d65 3d22 2b63  &companyname="+c
-00009e30: 6f6d 7061 6e79 6e61 6d65 202b 2022 2670  ompanyname + "&p
-00009e40: 6172 7469 7469 6f6e 3d22 2b73 7472 2870  artition="+str(p
-00009e50: 6172 7469 7469 6f6e 2920 2b22 2668 7064  artition) +"&hpd
-00009e60: 6568 6f73 743d 2220 2b68 7064 6568 6f73  ehost=" +hpdehos
-00009e70: 7420 2b0d 0a20 2020 2020 2020 2020 2020  t +..           
-00009e80: 2226 6870 6465 706f 7274 3d22 2b73 7472  "&hpdeport="+str
-00009e90: 2868 7064 6570 6f72 7429 2b22 2662 726f  (hpdeport)+"&bro
-00009ea0: 6b65 7268 6f73 743d 222b 6272 6f6b 6572  kerhost="+broker
-00009eb0: 686f 7374 202b 2022 2676 6970 6572 636f  host + "&viperco
-00009ec0: 6e66 6967 6669 6c65 3d22 2b76 6970 6572  nfigfile="+viper
-00009ed0: 636f 6e66 6967 6669 6c65 202b 0d0a 2020  configfile +..  
-00009ee0: 2020 2020 2020 2020 2022 2662 726f 6b65           "&broke
-00009ef0: 7270 6f72 743d 222b 7374 7228 6272 6f6b  rport="+str(brok
-00009f00: 6572 706f 7274 292b 2226 656e 6162 6c65  erport)+"&enable
-00009f10: 746c 733d 222b 7374 7228 656e 6162 6c65  tls="+str(enable
-00009f20: 746c 7329 202b 2226 746f 7069 6369 643d  tls) +"&topicid=
-00009f30: 222b 7374 7228 746f 7069 6369 6429 202b  "+str(topicid) +
-00009f40: 2022 266d 6169 6e74 6f70 6963 3d22 202b   "&maintopic=" +
-00009f50: 206d 6169 6e74 6f70 6963 202b 0d0a 2020   maintopic +..  
-00009f60: 2020 2020 2020 2020 2022 2672 6f6c 6c62           "&rollb
-00009f70: 6163 6b6f 6666 7365 7473 3d22 202b 2073  ackoffsets=" + s
-00009f80: 7472 2872 6f6c 6c62 6163 6b6f 6666 7365  tr(rollbackoffse
-00009f90: 7473 2920 2b20 2226 6675 6c6c 7061 7468  ts) + "&fullpath
-00009fa0: 746f 7472 6169 6e69 6e67 6461 7461 3d22  totrainingdata="
-00009fb0: 2b66 756c 6c70 6174 6874 6f74 7261 696e  +fullpathtotrain
-00009fc0: 696e 6764 6174 6129 0d0a 0d0a 2020 2020  ingdata)....    
-00009fd0: 7661 6c3d 6c6f 6f70 2e72 756e 5f75 6e74  val=loop.run_unt
-00009fe0: 696c 5f63 6f6d 706c 6574 6528 7463 705f  il_complete(tcp_
-00009ff0: 6563 686f 5f63 6c69 656e 7476 6970 6572  echo_clientviper
-0000a000: 2876 616c 7565 2c20 6c6f 6f70 2c68 6f73  (value, loop,hos
-0000a010: 742c 706f 7274 2c6d 6963 726f 7365 7276  t,port,microserv
-0000a020: 6963 6569 642c 7469 6d65 6f75 7429 290d  iceid,timeout)).
-0000a030: 0a20 2020 2069 6620 636f 6e6e 6563 7469  .    if connecti
-0000a040: 6f6e 6572 726f 723a 0d0a 2020 2020 2020  onerror:..      
-0000a050: 2020 2072 6574 7572 6e20 636f 6e6e 6563     return connec
-0000a060: 7469 6f6e 6572 726f 720d 0a0d 0a20 2020  tionerror....   
-0000a070: 2072 6574 7572 6e20 7661 6c0d 0a0d 0a64   return val....d
-0000a080: 6566 2076 6970 6572 616e 6f6d 616c 7970  ef viperanomalyp
-0000a090: 7265 6469 6374 6261 7463 6828 7669 7065  redictbatch(vipe
-0000a0a0: 7274 6f6b 656e 2c68 6f73 742c 706f 7274  rtoken,host,port
-0000a0b0: 2c63 6f6e 7375 6d65 6672 6f6d 2c70 726f  ,consumefrom,pro
-0000a0c0: 6475 6365 746f 2c63 6f6e 7375 6d65 696e  duceto,consumein
-0000a0d0: 7075 7473 7472 6561 6d2c 7072 6f64 7563  putstream,produc
-0000a0e0: 6569 6e70 7574 7374 7265 616d 7465 7374  einputstreamtest
-0000a0f0: 2c70 726f 6475 6365 7269 6469 6e70 7574  ,produceridinput
-0000a100: 7374 7265 616d 7465 7374 2c0d 0a20 2020  streamtest,..   
-0000a110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a120: 2020 2073 7472 6561 6d73 746f 616e 616c     streamstoanal
-0000a130: 7973 652c 636f 6e73 756d 6572 6964 696e  yse,consumeridin
-0000a140: 7075 7473 7472 6561 6d2c 0d0a 2020 2020  putstream,..    
-0000a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a160: 2020 636f 6d70 616e 796e 616d 652c 636f    companyname,co
-0000a170: 6e73 756d 6572 6964 2c70 726f 6475 6365  nsumerid,produce
-0000a180: 7269 642c 666c 6167 732c 6870 6465 686f  rid,flags,hpdeho
-0000a190: 7374 2c76 6970 6572 636f 6e66 6967 6669  st,viperconfigfi
-0000a1a0: 6c65 2c0d 0a20 2020 2020 2020 2020 2020  le,..           
-0000a1b0: 2020 2020 2020 2020 2020 2065 6e61 626c             enabl
-0000a1c0: 6574 6c73 3d31 2c70 6172 7469 7469 6f6e  etls=1,partition
-0000a1d0: 3d2d 312c 6870 6465 706f 7274 3d2d 3939  =-1,hpdeport=-99
-0000a1e0: 392c 746f 7069 6369 643d 222d 3939 3922  9,topicid="-999"
-0000a1f0: 2c6d 6169 6e74 6f70 6963 3d27 272c 726f  ,maintopic='',ro
-0000a200: 6c6c 6261 636b 6f66 6673 6574 733d 302c  llbackoffsets=0,
-0000a210: 6675 6c6c 7061 7468 746f 7065 6572 6772  fullpathtopeergr
-0000a220: 6f75 7064 6174 613d 2727 2c0d 0a20 2020  oupdata='',..   
-0000a230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a240: 2020 2062 726f 6b65 7268 6f73 743d 2727     brokerhost=''
-0000a250: 2c62 726f 6b65 7270 6f72 743d 3930 3932  ,brokerport=9092
-0000a260: 2c64 656c 6179 3d31 3030 302c 7469 6d65  ,delay=1000,time
-0000a270: 6f75 743d 3132 302c 6d69 6372 6f73 6572  out=120,microser
-0000a280: 7669 6365 6964 3d27 272c 7469 6d65 6465  viceid='',timede
-0000a290: 6c61 793d 302c 6173 796e 6374 696d 656f  lay=0,asynctimeo
-0000a2a0: 7574 3d31 3230 293a 0d0a 0d0a 2020 2020  ut=120):....    
-0000a2b0: 2372 6561 6473 2074 6865 2066 6965 6c64  #reads the field
-0000a2c0: 6e61 6d65 7320 616e 6420 6765 7473 206c  names and gets l
-0000a2d0: 6174 6573 7420 6461 7461 2066 726f 6d20  atest data from 
-0000a2e0: 6561 6368 2073 7472 6561 6d20 286f 7220  each stream (or 
-0000a2f0: 6669 656c 646e 616d 6529 0d0a 2020 2020  fieldname)..    
-0000a300: 676c 6f62 616c 2063 6f6e 6e65 6374 696f  global connectio
-0000a310: 6e65 7272 6f72 0d0a 2020 2020 0d0a 2020  nerror..    ..  
-0000a320: 2020 6966 2028 6c65 6e28 686f 7374 293d    if (len(host)=
-0000a330: 3d30 206f 7220 6c65 6e28 7669 7065 7274  =0 or len(vipert
-0000a340: 6f6b 656e 293d 3d30 206f 7220 706f 7274  oken)==0 or port
-0000a350: 3d3d 2d39 3939 206f 7220 6c65 6e28 7072  ==-999 or len(pr
-0000a360: 6f64 7563 6574 6f29 3d3d 3020 6f72 206c  oduceto)==0 or l
-0000a370: 656e 2863 6f6d 7061 6e79 6e61 6d65 293d  en(companyname)=
-0000a380: 3d30 200d 0a20 2020 2020 2020 2020 2020  =0 ..           
-0000a390: 2020 2020 2020 6f72 206c 656e 2868 7064        or len(hpd
-0000a3a0: 6568 6f73 7429 3d3d 3020 6f72 2068 7064  ehost)==0 or hpd
-0000a3b0: 6570 6f72 743d 3d2d 3939 3920 6f72 206c  eport==-999 or l
-0000a3c0: 656e 2873 7472 6561 6d73 746f 616e 616c  en(streamstoanal
-0000a3d0: 7973 6529 3d3d 3020 0d0a 2020 2020 2020  yse)==0 ..      
-0000a3e0: 2020 2020 2020 2020 2020 206f 7220 6c65             or le
-0000a3f0: 6e28 666c 6167 7329 3d3d 3020 6f72 206c  n(flags)==0 or l
-0000a400: 656e 2876 6970 6572 636f 6e66 6967 6669  en(viperconfigfi
-0000a410: 6c65 293d 3d30 293a 0d0a 2020 2020 2020  le)==0):..      
-0000a420: 2020 2072 6574 7572 6e20 2250 6c65 6173     return "Pleas
-0000a430: 6520 656e 7465 7220 686f 7374 2c70 6f72  e enter host,por
-0000a440: 742c 7669 7065 7274 6f6b 656e 2c70 726f  t,vipertoken,pro
-0000a450: 6475 6365 746f 2c63 6f6d 7061 6e79 6e61  duceto,companyna
-0000a460: 6d65 2c73 7472 6561 6d73 746f 616e 616c  me,streamstoanal
-0000a470: 7973 652c 666c 6167 732c 636f 6e73 756d  yse,flags,consum
-0000a480: 6572 6964 2c68 7064 6568 6f73 742c 6870  erid,hpdehost,hp
-0000a490: 6465 706f 7274 220d 0a20 2020 2020 2020  deport"..       
-0000a4a0: 200d 0a20 2020 2076 616c 7565 3d28 2276   ..    value=("v
-0000a4b0: 6970 6572 616e 6f6d 616c 7970 7265 6469  iperanomalypredi
-0000a4c0: 6374 6261 7463 683f 7669 7065 7274 6f6b  ctbatch?vipertok
-0000a4d0: 656e 3d22 2b76 6970 6572 746f 6b65 6e20  en="+vipertoken 
-0000a4e0: 2b20 2226 636f 6e73 756d 6566 726f 6d3d  + "&consumefrom=
-0000a4f0: 222b 636f 6e73 756d 6566 726f 6d20 2b20  "+consumefrom + 
-0000a500: 2226 7072 6f64 7563 6574 6f3d 2220 2b20  "&produceto=" + 
-0000a510: 7072 6f64 7563 6574 6f20 2b20 2226 636f  produceto + "&co
-0000a520: 6e73 756d 6572 6964 3d22 2b63 6f6e 7375  nsumerid="+consu
-0000a530: 6d65 7269 6420 2b0d 0a20 2020 2020 2020  merid +..       
-0000a540: 2020 2020 2226 7072 6f64 7563 6569 6e70      "&produceinp
-0000a550: 7574 7374 7265 616d 7465 7374 3d22 2b70  utstreamtest="+p
-0000a560: 726f 6475 6365 696e 7075 7473 7472 6561  roduceinputstrea
-0000a570: 6d74 6573 7420 2b20 2226 7072 6f64 7563  mtest + "&produc
-0000a580: 6572 6964 696e 7075 7473 7472 6561 6d74  eridinputstreamt
-0000a590: 6573 743d 222b 7072 6f64 7563 6572 6964  est="+producerid
-0000a5a0: 696e 7075 7473 7472 6561 6d74 6573 7420  inputstreamtest 
-0000a5b0: 2b20 2226 636f 6e73 756d 6572 6964 696e  + "&consumeridin
-0000a5c0: 7075 7473 7472 6561 6d3d 222b 636f 6e73  putstream="+cons
-0000a5d0: 756d 6572 6964 696e 7075 7473 7472 6561  umeridinputstrea
-0000a5e0: 6d2b 0d0a 2020 2020 2020 2020 2020 2022  m+..           "
-0000a5f0: 2673 7472 6561 6d73 746f 616e 616c 7973  &streamstoanalys
-0000a600: 653d 222b 7374 7265 616d 7374 6f61 6e61  e="+streamstoana
-0000a610: 6c79 7365 202b 2022 2666 6c61 6773 3d22  lyse + "&flags="
-0000a620: 2b66 6c61 6773 202b 2022 2664 656c 6179  +flags + "&delay
-0000a630: 3d22 202b 7374 7228 6465 6c61 7929 202b  =" +str(delay) +
-0000a640: 2022 2674 696d 656f 7574 3d22 202b 2073   "&timeout=" + s
-0000a650: 7472 2874 696d 656f 7574 2920 2b0d 0a20  tr(timeout) +.. 
-0000a660: 2020 2020 2020 2020 2020 2226 7072 6f64            "&prod
-0000a670: 7563 6572 6964 3d22 2b70 726f 6475 6365  ucerid="+produce
-0000a680: 7269 6420 2b20 2226 636f 6d70 616e 796e  rid + "&companyn
-0000a690: 616d 653d 222b 636f 6d70 616e 796e 616d  ame="+companynam
-0000a6a0: 6520 2b20 2226 7061 7274 6974 696f 6e3d  e + "&partition=
-0000a6b0: 222b 7374 7228 7061 7274 6974 696f 6e29  "+str(partition)
-0000a6c0: 202b 2226 6870 6465 686f 7374 3d22 202b   +"&hpdehost=" +
-0000a6d0: 6870 6465 686f 7374 202b 0d0a 2020 2020  hpdehost +..    
-0000a6e0: 2020 2020 2020 2022 2668 7064 6570 6f72         "&hpdepor
-0000a6f0: 743d 222b 7374 7228 6870 6465 706f 7274  t="+str(hpdeport
-0000a700: 292b 2226 6272 6f6b 6572 686f 7374 3d22  )+"&brokerhost="
-0000a710: 2b62 726f 6b65 7268 6f73 7420 2b20 2226  +brokerhost + "&
-0000a720: 7669 7065 7263 6f6e 6669 6766 696c 653d  viperconfigfile=
-0000a730: 222b 7669 7065 7263 6f6e 6669 6766 696c  "+viperconfigfil
-0000a740: 6520 2b20 2226 636f 6e73 756d 6569 6e70  e + "&consumeinp
-0000a750: 7574 7374 7265 616d 3d22 2b63 6f6e 7375  utstream="+consu
-0000a760: 6d65 696e 7075 7473 7472 6561 6d2b 0d0a  meinputstream+..
-0000a770: 2020 2020 2020 2020 2020 2022 2662 726f             "&bro
-0000a780: 6b65 7270 6f72 743d 222b 7374 7228 6272  kerport="+str(br
-0000a790: 6f6b 6572 706f 7274 292b 2226 656e 6162  okerport)+"&enab
-0000a7a0: 6c65 746c 733d 222b 7374 7228 656e 6162  letls="+str(enab
-0000a7b0: 6c65 746c 7329 202b 2022 2674 6f70 6963  letls) + "&topic
-0000a7c0: 6964 3d22 202b 2074 6f70 6963 6964 202b  id=" + topicid +
-0000a7d0: 2022 266d 6169 6e74 6f70 6963 3d22 202b   "&maintopic=" +
-0000a7e0: 6d61 696e 746f 7069 630d 0a20 2020 2020  maintopic..     
-0000a7f0: 2020 2020 2020 2b20 2226 726f 6c6c 6261        + "&rollba
-0000a800: 636b 6f66 6673 6574 733d 2220 2b73 7472  ckoffsets=" +str
-0000a810: 2872 6f6c 6c62 6163 6b6f 6666 7365 7473  (rollbackoffsets
-0000a820: 292b 2022 2666 756c 6c70 6174 6874 6f70  )+ "&fullpathtop
-0000a830: 6565 7267 726f 7570 6461 7461 3d22 2b66  eergroupdata="+f
-0000a840: 756c 6c70 6174 6874 6f70 6565 7267 726f  ullpathtopeergro
-0000a850: 7570 6461 7461 2b20 2226 7469 6d65 6465  updata+ "&timede
-0000a860: 6c61 793d 2220 2b20 7374 7228 7469 6d65  lay=" + str(time
-0000a870: 6465 6c61 7929 290d 0a0d 0a20 2020 2076  delay))....    v
-0000a880: 616c 3d6c 6f6f 702e 7275 6e5f 756e 7469  al=loop.run_unti
-0000a890: 6c5f 636f 6d70 6c65 7465 2874 6370 5f65  l_complete(tcp_e
-0000a8a0: 6368 6f5f 636c 6965 6e74 7669 7065 7228  cho_clientviper(
-0000a8b0: 7661 6c75 652c 206c 6f6f 702c 686f 7374  value, loop,host
-0000a8c0: 2c70 6f72 742c 6d69 6372 6f73 6572 7669  ,port,microservi
-0000a8d0: 6365 6964 2c61 7379 6e63 7469 6d65 6f75  ceid,asynctimeou
-0000a8e0: 7429 290d 0a20 2020 2069 6620 636f 6e6e  t))..    if conn
-0000a8f0: 6563 7469 6f6e 6572 726f 723a 0d0a 2020  ectionerror:..  
-0000a900: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
-0000a910: 6e6e 6563 7469 6f6e 6572 726f 720d 0a0d  nnectionerror...
-0000a920: 0a20 2020 2072 6574 7572 6e20 7661 6c0d  .    return val.
-0000a930: 0a0d 0a0d 0a64 6566 2076 6970 6572 616e  .....def viperan
-0000a940: 6f6d 616c 7970 7265 6469 6374 2876 6970  omalypredict(vip
-0000a950: 6572 746f 6b65 6e2c 686f 7374 2c70 6f72  ertoken,host,por
-0000a960: 742c 636f 6e73 756d 6566 726f 6d2c 7072  t,consumefrom,pr
-0000a970: 6f64 7563 6574 6f2c 636f 6e73 756d 6569  oduceto,consumei
-0000a980: 6e70 7574 7374 7265 616d 2c70 726f 6475  nputstream,produ
-0000a990: 6365 696e 7075 7473 7472 6561 6d74 6573  ceinputstreamtes
-0000a9a0: 742c 7072 6f64 7563 6572 6964 696e 7075  t,produceridinpu
-0000a9b0: 7473 7472 6561 6d74 6573 742c 0d0a 2020  tstreamtest,..  
-0000a9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a9d0: 2020 2020 7374 7265 616d 7374 6f61 6e61      streamstoana
-0000a9e0: 6c79 7365 2c63 6f6e 7375 6d65 7269 6469  lyse,consumeridi
-0000a9f0: 6e70 7574 7374 7265 616d 2c0d 0a20 2020  nputstream,..   
-0000aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aa10: 2020 2063 6f6d 7061 6e79 6e61 6d65 2c63     companyname,c
-0000aa20: 6f6e 7375 6d65 7269 642c 7072 6f64 7563  onsumerid,produc
-0000aa30: 6572 6964 2c66 6c61 6773 2c68 7064 6568  erid,flags,hpdeh
-0000aa40: 6f73 742c 7669 7065 7263 6f6e 6669 6766  ost,viperconfigf
-0000aa50: 696c 652c 0d0a 2020 2020 2020 2020 2020  ile,..          
-0000aa60: 2020 2020 2020 2020 2020 2020 656e 6162              enab
-0000aa70: 6c65 746c 733d 312c 7061 7274 6974 696f  letls=1,partitio
-0000aa80: 6e3d 2d31 2c68 7064 6570 6f72 743d 2d39  n=-1,hpdeport=-9
-0000aa90: 3939 2c74 6f70 6963 6964 3d2d 3939 392c  99,topicid=-999,
-0000aaa0: 6d61 696e 746f 7069 633d 2727 2c72 6f6c  maintopic='',rol
-0000aab0: 6c62 6163 6b6f 6666 7365 7473 3d30 2c66  lbackoffsets=0,f
-0000aac0: 756c 6c70 6174 6874 6f70 6565 7267 726f  ullpathtopeergro
-0000aad0: 7570 6461 7461 3d27 272c 0d0a 2020 2020  updata='',..    
-0000aae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aaf0: 2020 6272 6f6b 6572 686f 7374 3d27 272c    brokerhost='',
-0000ab00: 6272 6f6b 6572 706f 7274 3d39 3039 322c  brokerport=9092,
-0000ab10: 6465 6c61 793d 3130 3030 2c74 696d 656f  delay=1000,timeo
-0000ab20: 7574 3d31 3230 2c6d 6963 726f 7365 7276  ut=120,microserv
-0000ab30: 6963 6569 643d 2727 293a 0d0a 0d0a 2020  iceid=''):....  
-0000ab40: 2020 2372 6561 6473 2074 6865 2066 6965    #reads the fie
-0000ab50: 6c64 6e61 6d65 7320 616e 6420 6765 7473  ldnames and gets
-0000ab60: 206c 6174 6573 7420 6461 7461 2066 726f   latest data fro
-0000ab70: 6d20 6561 6368 2073 7472 6561 6d20 286f  m each stream (o
-0000ab80: 7220 6669 656c 646e 616d 6529 0d0a 2020  r fieldname)..  
-0000ab90: 2020 676c 6f62 616c 2063 6f6e 6e65 6374    global connect
-0000aba0: 696f 6e65 7272 6f72 0d0a 2020 2020 0d0a  ionerror..    ..
-0000abb0: 2020 2020 6966 2028 6c65 6e28 686f 7374      if (len(host
-0000abc0: 293d 3d30 206f 7220 6c65 6e28 7669 7065  )==0 or len(vipe
-0000abd0: 7274 6f6b 656e 293d 3d30 206f 7220 706f  rtoken)==0 or po
-0000abe0: 7274 3d3d 2d39 3939 206f 7220 6c65 6e28  rt==-999 or len(
-0000abf0: 7072 6f64 7563 6574 6f29 3d3d 3020 6f72  produceto)==0 or
-0000ac00: 206c 656e 2863 6f6d 7061 6e79 6e61 6d65   len(companyname
-0000ac10: 293d 3d30 200d 0a20 2020 2020 2020 2020  )==0 ..         
-0000ac20: 2020 2020 2020 2020 6f72 206c 656e 2868          or len(h
-0000ac30: 7064 6568 6f73 7429 3d3d 3020 6f72 2068  pdehost)==0 or h
-0000ac40: 7064 6570 6f72 743d 3d2d 3939 3920 6f72  pdeport==-999 or
-0000ac50: 206c 656e 2873 7472 6561 6d73 746f 616e   len(streamstoan
-0000ac60: 616c 7973 6529 3d3d 3020 0d0a 2020 2020  alyse)==0 ..    
-0000ac70: 2020 2020 2020 2020 2020 2020 206f 7220               or 
-0000ac80: 6c65 6e28 666c 6167 7329 3d3d 3020 6f72  len(flags)==0 or
-0000ac90: 206c 656e 2876 6970 6572 636f 6e66 6967   len(viperconfig
-0000aca0: 6669 6c65 293d 3d30 293a 0d0a 2020 2020  file)==0):..    
-0000acb0: 2020 2020 2072 6574 7572 6e20 2250 6c65       return "Ple
-0000acc0: 6173 6520 656e 7465 7220 686f 7374 2c70  ase enter host,p
-0000acd0: 6f72 742c 7669 7065 7274 6f6b 656e 2c70  ort,vipertoken,p
-0000ace0: 726f 6475 6365 746f 2c63 6f6d 7061 6e79  roduceto,company
-0000acf0: 6e61 6d65 2c73 7472 6561 6d73 746f 616e  name,streamstoan
-0000ad00: 616c 7973 652c 666c 6167 732c 636f 6e73  alyse,flags,cons
-0000ad10: 756d 6572 6964 2c68 7064 6568 6f73 742c  umerid,hpdehost,
-0000ad20: 6870 6465 706f 7274 220d 0a20 2020 2020  hpdeport"..     
-0000ad30: 2020 200d 0a20 2020 2076 616c 7565 3d28     ..    value=(
-0000ad40: 2276 6970 6572 616e 6f6d 616c 7970 7265  "viperanomalypre
-0000ad50: 6469 6374 3f76 6970 6572 746f 6b65 6e3d  dict?vipertoken=
-0000ad60: 222b 7669 7065 7274 6f6b 656e 202b 2022  "+vipertoken + "
-0000ad70: 2663 6f6e 7375 6d65 6672 6f6d 3d22 2b63  &consumefrom="+c
-0000ad80: 6f6e 7375 6d65 6672 6f6d 202b 2022 2670  onsumefrom + "&p
-0000ad90: 726f 6475 6365 746f 3d22 202b 2070 726f  roduceto=" + pro
-0000ada0: 6475 6365 746f 202b 2022 2663 6f6e 7375  duceto + "&consu
-0000adb0: 6d65 7269 643d 222b 636f 6e73 756d 6572  merid="+consumer
-0000adc0: 6964 202b 0d0a 2020 2020 2020 2020 2020  id +..          
-0000add0: 2022 2670 726f 6475 6365 696e 7075 7473   "&produceinputs
-0000ade0: 7472 6561 6d74 6573 743d 222b 7072 6f64  treamtest="+prod
-0000adf0: 7563 6569 6e70 7574 7374 7265 616d 7465  uceinputstreamte
-0000ae00: 7374 202b 2022 2670 726f 6475 6365 7269  st + "&produceri
-0000ae10: 6469 6e70 7574 7374 7265 616d 7465 7374  dinputstreamtest
-0000ae20: 3d22 2b70 726f 6475 6365 7269 6469 6e70  ="+produceridinp
-0000ae30: 7574 7374 7265 616d 7465 7374 202b 2022  utstreamtest + "
-0000ae40: 2663 6f6e 7375 6d65 7269 6469 6e70 7574  &consumeridinput
-0000ae50: 7374 7265 616d 3d22 2b63 6f6e 7375 6d65  stream="+consume
-0000ae60: 7269 6469 6e70 7574 7374 7265 616d 2b0d  ridinputstream+.
-0000ae70: 0a20 2020 2020 2020 2020 2020 2226 7374  .           "&st
-0000ae80: 7265 616d 7374 6f61 6e61 6c79 7365 3d22  reamstoanalyse="
-0000ae90: 2b73 7472 6561 6d73 746f 616e 616c 7973  +streamstoanalys
-0000aea0: 6520 2b20 2226 666c 6167 733d 222b 666c  e + "&flags="+fl
-0000aeb0: 6167 7320 2b20 2226 6465 6c61 793d 2220  ags + "&delay=" 
-0000aec0: 2b73 7472 2864 656c 6179 2920 2b20 2226  +str(delay) + "&
-0000aed0: 7469 6d65 6f75 743d 2220 2b20 7374 7228  timeout=" + str(
-0000aee0: 7469 6d65 6f75 7429 202b 0d0a 2020 2020  timeout) +..    
-0000aef0: 2020 2020 2020 2022 2670 726f 6475 6365         "&produce
-0000af00: 7269 643d 222b 7072 6f64 7563 6572 6964  rid="+producerid
-0000af10: 202b 2022 2663 6f6d 7061 6e79 6e61 6d65   + "&companyname
-0000af20: 3d22 2b63 6f6d 7061 6e79 6e61 6d65 202b  ="+companyname +
-0000af30: 2022 2670 6172 7469 7469 6f6e 3d22 2b73   "&partition="+s
-0000af40: 7472 2870 6172 7469 7469 6f6e 2920 2b22  tr(partition) +"
-0000af50: 2668 7064 6568 6f73 743d 2220 2b68 7064  &hpdehost=" +hpd
-0000af60: 6568 6f73 7420 2b0d 0a20 2020 2020 2020  ehost +..       
-0000af70: 2020 2020 2226 6870 6465 706f 7274 3d22      "&hpdeport="
-0000af80: 2b73 7472 2868 7064 6570 6f72 7429 2b22  +str(hpdeport)+"
-0000af90: 2662 726f 6b65 7268 6f73 743d 222b 6272  &brokerhost="+br
-0000afa0: 6f6b 6572 686f 7374 202b 2022 2676 6970  okerhost + "&vip
-0000afb0: 6572 636f 6e66 6967 6669 6c65 3d22 2b76  erconfigfile="+v
-0000afc0: 6970 6572 636f 6e66 6967 6669 6c65 202b  iperconfigfile +
-0000afd0: 2022 2663 6f6e 7375 6d65 696e 7075 7473   "&consumeinputs
-0000afe0: 7472 6561 6d3d 222b 636f 6e73 756d 6569  tream="+consumei
-0000aff0: 6e70 7574 7374 7265 616d 2b0d 0a20 2020  nputstream+..   
-0000b000: 2020 2020 2020 2020 2226 6272 6f6b 6572          "&broker
-0000b010: 706f 7274 3d22 2b73 7472 2862 726f 6b65  port="+str(broke
-0000b020: 7270 6f72 7429 2b22 2665 6e61 626c 6574  rport)+"&enablet
-0000b030: 6c73 3d22 2b73 7472 2865 6e61 626c 6574  ls="+str(enablet
-0000b040: 6c73 2920 2b20 2226 746f 7069 6369 643d  ls) + "&topicid=
-0000b050: 2220 2b20 7374 7228 746f 7069 6369 6429  " + str(topicid)
-0000b060: 202b 2022 266d 6169 6e74 6f70 6963 3d22   + "&maintopic="
-0000b070: 202b 6d61 696e 746f 7069 630d 0a20 2020   +maintopic..   
-0000b080: 2020 2020 2020 2020 2b20 2226 726f 6c6c          + "&roll
-0000b090: 6261 636b 6f66 6673 6574 733d 2220 2b73  backoffsets=" +s
-0000b0a0: 7472 2872 6f6c 6c62 6163 6b6f 6666 7365  tr(rollbackoffse
-0000b0b0: 7473 292b 2022 2666 756c 6c70 6174 6874  ts)+ "&fullpatht
-0000b0c0: 6f70 6565 7267 726f 7570 6461 7461 3d22  opeergroupdata="
-0000b0d0: 2b66 756c 6c70 6174 6874 6f70 6565 7267  +fullpathtopeerg
-0000b0e0: 726f 7570 6461 7461 290d 0a0d 0a20 2020  roupdata)....   
-0000b0f0: 2076 616c 3d6c 6f6f 702e 7275 6e5f 756e   val=loop.run_un
-0000b100: 7469 6c5f 636f 6d70 6c65 7465 2874 6370  til_complete(tcp
-0000b110: 5f65 6368 6f5f 636c 6965 6e74 7669 7065  _echo_clientvipe
-0000b120: 7228 7661 6c75 652c 206c 6f6f 702c 686f  r(value, loop,ho
-0000b130: 7374 2c70 6f72 742c 6d69 6372 6f73 6572  st,port,microser
-0000b140: 7669 6365 6964 2c74 696d 656f 7574 2929  viceid,timeout))
-0000b150: 0d0a 2020 2020 6966 2063 6f6e 6e65 6374  ..    if connect
-0000b160: 696f 6e65 7272 6f72 3a0d 0a20 2020 2020  ionerror:..     
-0000b170: 2020 2020 7265 7475 726e 2063 6f6e 6e65      return conne
-0000b180: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
-0000b190: 2020 7265 7475 726e 2076 616c 0d0a 0d0a    return val....
-0000b1a0: 6465 6620 7669 7065 7270 726f 6475 6365  def viperproduce
-0000b1b0: 746f 746f 7069 6373 7472 6561 6d28 7669  totopicstream(vi
-0000b1c0: 7065 7274 6f6b 656e 2c68 6f73 742c 706f  pertoken,host,po
-0000b1d0: 7274 2c74 6f70 6963 2c70 726f 6475 6365  rt,topic,produce
-0000b1e0: 7269 642c 6f66 6673 6574 2c6d 6178 726f  rid,offset,maxro
-0000b1f0: 7773 3d30 2c65 6e61 626c 6574 6c73 3d30  ws=0,enabletls=0
-0000b200: 2c64 656c 6179 3d31 3030 2c62 726f 6b65  ,delay=100,broke
-0000b210: 7268 6f73 743d 2727 2c62 726f 6b65 7270  rhost='',brokerp
-0000b220: 6f72 743d 2d39 3939 2c6d 6963 726f 7365  ort=-999,microse
-0000b230: 7276 6963 6569 643d 2727 2c0d 0a20 2020  rviceid='',..   
+00004340: 2020 2020 2020 2020 6f75 7470 7574 746f          outputto
+00004350: 7069 636e 616d 6573 3d30 2c6e 6c70 3d30  picnames=0,nlp=0
+00004360: 2c63 6f72 7265 6c61 7469 6f6e 7479 7065  ,correlationtype
+00004370: 3d27 272c 646f 6372 6f73 7363 6f72 723d  ='',docrosscorr=
+00004380: 3020 293a 0d0a 2020 2020 676c 6f62 616c  0 ):..    global
+00004390: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
+000043a0: 0d0a 0d0a 2020 2020 6966 206c 656e 2868  ....    if len(h
+000043b0: 6f73 7429 3d3d 3020 6f72 206c 656e 2876  ost)==0 or len(v
+000043c0: 6970 6572 746f 6b65 6e29 3d3d 3020 6f72  ipertoken)==0 or
+000043d0: 2070 6f72 743d 3d2d 3939 3920 6f72 206c   port==-999 or l
+000043e0: 656e 2874 6f70 6963 293d 3d30 3a0d 0a20  en(topic)==0:.. 
+000043f0: 2020 2020 2020 2020 7265 7475 726e 2022          return "
+00004400: 506c 6561 7365 2065 6e74 6572 2068 6f73  Please enter hos
+00004410: 742c 706f 7274 2c76 6970 6572 746f 6b65  t,port,vipertoke
+00004420: 6e2c 746f 7069 6322 0d0a 2020 2020 0d0a  n,topic"..    ..
+00004430: 2020 2020 7661 6c75 653d 2822 7374 7265      value=("stre
+00004440: 616d 636f 7272 3f76 6970 6572 746f 6b65  amcorr?vipertoke
+00004450: 6e3d 222b 7669 7065 7274 6f6b 656e 202b  n="+vipertoken +
+00004460: 2022 2674 6f70 6963 6e61 6d65 3d22 2b74   "&topicname="+t
+00004470: 6f70 6963 202b 2022 2670 726f 6475 6365  opic + "&produce
+00004480: 7269 643d 2220 2b20 7072 6f64 7563 6572  rid=" + producer
+00004490: 6964 202b 2022 266f 6666 7365 743d 2220  id + "&offset=" 
+000044a0: 2b20 7374 7228 6f66 6673 6574 290d 0a20  + str(offset).. 
+000044b0: 2020 2020 2020 2020 2020 2b20 2226 6d61            + "&ma
+000044c0: 7872 6f77 733d 2220 2b20 7374 7228 6d61  xrows=" + str(ma
+000044d0: 7872 6f77 7329 202b 2022 2664 656c 6179  xrows) + "&delay
+000044e0: 3d22 202b 2073 7472 2864 656c 6179 2920  =" + str(delay) 
+000044f0: 2b20 2022 2665 6e61 626c 6574 6c73 3d22  +  "&enabletls="
+00004500: 2b73 7472 2865 6e61 626c 6574 6c73 290d  +str(enabletls).
+00004510: 0a20 2020 2020 2020 2020 2020 2b20 2226  .           + "&
+00004520: 6272 6f6b 6572 686f 7374 3d22 2b62 726f  brokerhost="+bro
+00004530: 6b65 7268 6f73 742b 2226 6272 6f6b 6572  kerhost+"&broker
+00004540: 706f 7274 3d22 2b73 7472 2862 726f 6b65  port="+str(broke
+00004550: 7270 6f72 7429 202b 2022 2673 7472 6561  rport) + "&strea
+00004560: 6d73 746f 6a6f 696e 3d22 2b73 7472 6561  mstojoin="+strea
+00004570: 6d73 746f 6a6f 696e 202b 2022 2674 6f70  mstojoin + "&top
+00004580: 6963 6964 3d22 202b 2073 7472 2874 6f70  icid=" + str(top
+00004590: 6963 6964 2920 0d0a 2020 2020 2020 2020  icid) ..        
+000045a0: 2020 202b 2022 2669 6465 6e74 6966 6965     + "&identifie
+000045b0: 723d 2220 2b20 6964 656e 7469 6669 6572  r=" + identifier
+000045c0: 202b 2022 2670 7265 7072 6f63 6573 7374   + "&preprocesst
+000045d0: 6f70 6963 3d22 202b 2073 7472 2870 7265  opic=" + str(pre
+000045e0: 7072 6f63 6573 7374 6f70 6963 2920 2b20  processtopic) + 
+000045f0: 2022 2664 6573 6372 6970 7469 6f6e 3d22   "&description="
+00004600: 202b 2073 7472 2864 6573 6372 6970 7469   + str(descripti
+00004610: 6f6e 290d 0a20 2020 2020 2020 2020 2020  on)..           
+00004620: 2b20 2226 6172 7261 793d 2220 2b20 7374  + "&array=" + st
+00004630: 7228 6172 7261 7929 202b 2022 2677 6865  r(array) + "&whe
+00004640: 7265 636f 6e64 6974 696f 6e3d 2220 2b20  recondition=" + 
+00004650: 7768 6572 6563 6f6e 6469 7469 6f6e 0d0a  wherecondition..
+00004660: 2020 2020 2020 2020 2020 202b 2022 2677             + "&w
+00004670: 6865 7265 7365 6172 6368 6b65 793d 2220  heresearchkey=" 
+00004680: 2b20 7768 6572 6573 6561 7263 686b 6579  + wheresearchkey
+00004690: 202b 2022 2672 6177 6461 7461 6f75 7470   + "&rawdataoutp
+000046a0: 7574 3d22 202b 2073 7472 2872 6177 6461  ut=" + str(rawda
+000046b0: 7461 6f75 7470 7574 2920 2b20 2226 7468  taoutput) + "&th
+000046c0: 7265 7368 686f 6c64 3d22 202b 2073 7472  reshhold=" + str
+000046d0: 2874 6872 6573 6868 6f6c 6429 0d0a 2020  (threshhold)..  
+000046e0: 2020 2020 2020 2020 202b 2022 2670 7661           + "&pva
+000046f0: 6c75 653d 2220 2b20 7374 7228 7076 616c  lue=" + str(pval
+00004700: 7565 2920 2b20 2226 6964 656e 7469 6669  ue) + "&identifi
+00004710: 6572 6578 7472 6163 7470 6f73 3d22 202b  erextractpos=" +
+00004720: 2069 6465 6e74 6966 6965 7265 7874 7261   identifierextra
+00004730: 6374 706f 732b 2022 2674 6f70 636f 7272  ctpos+ "&topcorr
+00004740: 6e75 6d3d 220d 0a20 2020 2020 2020 2020  num="..         
+00004750: 2020 2b20 7374 7228 746f 7063 6f72 726e    + str(topcorrn
+00004760: 756d 2920 2b20 2226 6a73 6f6e 6372 6974  um) + "&jsoncrit
+00004770: 6572 6961 3d22 202b 206a 736f 6e63 7269  eria=" + jsoncri
+00004780: 7465 7269 6120 2b20 2226 746d 6c66 696c  teria + "&tmlfil
+00004790: 6570 6174 683d 2220 2b20 746d 6c66 696c  epath=" + tmlfil
+000047a0: 6570 6174 6820 2b20 2226 7573 656d 7973  epath + "&usemys
+000047b0: 716c 3d22 202b 2073 7472 2875 7365 6d79  ql=" + str(usemy
+000047c0: 7371 6c29 0d0a 2020 2020 2020 2020 2020  sql)..          
+000047d0: 202b 2020 2226 7061 7468 746f 746d 6c61   +  "&pathtotmla
+000047e0: 7474 7273 3d22 202b 2070 6174 6874 6f74  ttrs=" + pathtot
+000047f0: 6d6c 6174 7472 7320 2b20 2226 6d69 6e63  mlattrs + "&minc
+00004800: 6f72 7276 6563 746f 726c 656e 3d22 202b  orrvectorlen=" +
+00004810: 2073 7472 286d 696e 636f 7272 7665 6374   str(mincorrvect
+00004820: 6f72 6c65 6e29 0d0a 2020 2020 2020 2020  orlen)..        
+00004830: 2020 202b 2022 2677 7269 7465 636f 7272     + "&writecorr
+00004840: 7374 6f74 6f70 6963 3d22 202b 2077 7269  stotopic=" + wri
+00004850: 7465 636f 7272 7374 6f74 6f70 6963 202b  tecorrstotopic +
+00004860: 2022 266f 7574 7075 7474 6f70 6963 6e61   "&outputtopicna
+00004870: 6d65 733d 2220 2b20 7374 7228 6f75 7470  mes=" + str(outp
+00004880: 7574 746f 7069 636e 616d 6573 290d 0a20  uttopicnames).. 
+00004890: 2020 2020 2020 2020 2020 2b20 2226 6e6c            + "&nl
+000048a0: 703d 2220 2b20 7374 7228 6e6c 7029 202b  p=" + str(nlp) +
+000048b0: 2022 2663 6f72 7265 6c61 7469 6f6e 7479   "&correlationty
+000048c0: 7065 3d22 202b 2063 6f72 7265 6c61 7469  pe=" + correlati
+000048d0: 6f6e 7479 7065 202b 2022 2664 6f63 726f  ontype + "&docro
+000048e0: 7373 636f 7272 3d22 202b 2073 7472 2864  sscorr=" + str(d
+000048f0: 6f63 726f 7373 636f 7272 2929 0d0a 0d0a  ocrosscorr))....
+00004900: 2020 2020 7661 6c3d 6c6f 6f70 2e72 756e      val=loop.run
+00004910: 5f75 6e74 696c 5f63 6f6d 706c 6574 6528  _until_complete(
+00004920: 7463 705f 6563 686f 5f63 6c69 656e 7476  tcp_echo_clientv
+00004930: 6970 6572 2876 616c 7565 2c20 6c6f 6f70  iper(value, loop
+00004940: 2c68 6f73 742c 706f 7274 2c6d 6963 726f  ,host,port,micro
+00004950: 7365 7276 6963 6569 6429 290d 0a0d 0a20  serviceid)).... 
+00004960: 2020 2069 6620 636f 6e6e 6563 7469 6f6e     if connection
+00004970: 6572 726f 723a 0d0a 2020 2020 2020 2020  error:..        
+00004980: 2072 6574 7572 6e20 636f 6e6e 6563 7469   return connecti
+00004990: 6f6e 6572 726f 720d 0a0d 0a20 2020 2072  onerror....    r
+000049a0: 6574 7572 6e20 7661 6c0d 0a20 2020 2020  eturn val..     
+000049b0: 2020 200d 0a64 6566 2076 6970 6572 7072     ..def viperpr
+000049c0: 6f64 7563 6574 6f74 6f70 6963 2876 6970  oducetotopic(vip
+000049d0: 6572 746f 6b65 6e2c 686f 7374 2c70 6f72  ertoken,host,por
+000049e0: 742c 746f 7069 632c 7072 6f64 7563 6572  t,topic,producer
+000049f0: 6964 2c65 6e61 626c 6574 6c73 3d31 2c64  id,enabletls=1,d
+00004a00: 656c 6179 3d31 3030 2c69 6e70 7574 6461  elay=100,inputda
+00004a10: 7461 3d27 272c 6d61 6164 7361 6c67 6f6b  ta='',maadsalgok
+00004a20: 6579 3d27 272c 6d61 6164 7374 6f6b 656e  ey='',maadstoken
+00004a30: 3d27 272c 0d0a 2020 2020 2020 2020 2020  ='',..          
+00004a40: 2020 2020 2020 2020 2020 2020 2020 6765                ge
+00004a50: 746f 7074 696d 616c 3d30 2c65 7874 6572  toptimal=0,exter
+00004a60: 6e61 6c70 7265 6469 6374 696f 6e3d 2727  nalprediction=''
+00004a70: 2c73 7562 746f 7069 6373 3d27 272c 746f  ,subtopics='',to
+00004a80: 7069 6369 643d 2d39 3939 2c69 6465 6e74  picid=-999,ident
+00004a90: 6966 6965 723d 2727 2c61 7272 6179 3d30  ifier='',array=0
+00004aa0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00004ab0: 2020 2020 2020 2020 2020 2062 726f 6b65             broke
+00004ac0: 7268 6f73 743d 2727 2c62 726f 6b65 7270  rhost='',brokerp
+00004ad0: 6f72 743d 2d39 3939 2c6d 6963 726f 7365  ort=-999,microse
+00004ae0: 7276 6963 6569 643d 2727 293a 0d0a 2020  rviceid=''):..  
+00004af0: 2020 676c 6f62 616c 2063 6f6e 6e65 6374    global connect
+00004b00: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
+00004b10: 6966 206c 656e 2868 6f73 7429 3d3d 3020  if len(host)==0 
+00004b20: 6f72 206c 656e 2876 6970 6572 746f 6b65  or len(vipertoke
+00004b30: 6e29 3d3d 3020 6f72 2070 6f72 743d 3d2d  n)==0 or port==-
+00004b40: 3939 3920 6f72 206c 656e 2874 6f70 6963  999 or len(topic
+00004b50: 293d 3d30 206f 7220 6c65 6e28 7072 6f64  )==0 or len(prod
+00004b60: 7563 6572 6964 293d 3d30 3a0d 0a20 2020  ucerid)==0:..   
+00004b70: 2020 2020 2020 7265 7475 726e 2022 506c        return "Pl
+00004b80: 6561 7365 2065 6e74 6572 2068 6f73 742c  ease enter host,
+00004b90: 706f 7274 2c76 6970 6572 746f 6b65 6e2c  port,vipertoken,
+00004ba0: 746f 7069 632c 2070 726f 6475 6365 7269  topic, produceri
+00004bb0: 6422 0d0a 0d0a 2020 2020 0d0a 2020 2020  d"....    ..    
+00004bc0: 7661 6c75 653d 2822 7072 6f64 7563 6574  value=("producet
+00004bd0: 6f74 6f70 6963 3f76 6970 6572 746f 6b65  otopic?vipertoke
+00004be0: 6e3d 222b 7669 7065 7274 6f6b 656e 202b  n="+vipertoken +
+00004bf0: 2022 2674 6f70 6963 3d22 2b74 6f70 6963   "&topic="+topic
+00004c00: 202b 2022 2670 726f 6475 6365 7269 643d   + "&producerid=
+00004c10: 2220 2b20 7072 6f64 7563 6572 6964 202b  " + producerid +
+00004c20: 2022 2667 6574 6f70 7469 6d61 6c3d 222b   "&getoptimal="+
+00004c30: 7374 7228 6765 746f 7074 696d 616c 2920  str(getoptimal) 
+00004c40: 2b0d 0a20 2020 2020 2020 2020 2022 2664  +..          "&d
+00004c50: 656c 6179 3d22 202b 2073 7472 2864 656c  elay=" + str(del
+00004c60: 6179 2920 2b20 2022 2665 6e61 626c 6574  ay) +  "&enablet
+00004c70: 6c73 3d22 2b73 7472 2865 6e61 626c 6574  ls="+str(enablet
+00004c80: 6c73 292b 2022 2665 7874 6572 6e61 6c70  ls)+ "&externalp
+00004c90: 7265 6469 6374 696f 6e3d 222b 6578 7465  rediction="+exte
+00004ca0: 726e 616c 7072 6564 6963 7469 6f6e 202b  rnalprediction +
+00004cb0: 2022 2669 6e70 7574 6461 7461 3d22 2b69   "&inputdata="+i
+00004cc0: 6e70 7574 6461 7461 202b 0d0a 2020 2020  nputdata +..    
+00004cd0: 2020 2020 2020 2022 266d 6161 6473 616c         "&maadsal
+00004ce0: 676f 6b65 793d 222b 6d61 6164 7361 6c67  gokey="+maadsalg
+00004cf0: 6f6b 6579 202b 2226 6d61 6164 7374 6f6b  okey +"&maadstok
+00004d00: 656e 3d22 2b6d 6161 6473 746f 6b65 6e20  en="+maadstoken 
+00004d10: 2b20 2226 6272 6f6b 6572 686f 7374 3d22  + "&brokerhost="
+00004d20: 2b62 726f 6b65 7268 6f73 742b 2226 6272  +brokerhost+"&br
+00004d30: 6f6b 6572 706f 7274 3d22 2b73 7472 2862  okerport="+str(b
+00004d40: 726f 6b65 7270 6f72 7429 0d0a 2020 2020  rokerport)..    
+00004d50: 2020 2020 2020 202b 2022 2673 7562 746f         + "&subto
+00004d60: 7069 6373 3d22 2b73 7562 746f 7069 6373  pics="+subtopics
+00004d70: 202b 2022 2674 6f70 6963 6964 3d22 202b   + "&topicid=" +
+00004d80: 2073 7472 2874 6f70 6963 6964 2920 2b20   str(topicid) + 
+00004d90: 2226 6964 656e 7469 6669 6572 3d22 202b  "&identifier=" +
+00004da0: 2069 6465 6e74 6966 6965 7220 2b20 2226   identifier + "&
+00004db0: 6172 7261 793d 2220 2b20 7374 7228 6172  array=" + str(ar
+00004dc0: 7261 7929 290d 0a0d 0a20 2020 2020 2020  ray))....       
+00004dd0: 2020 2020 0d0a 2020 2020 7661 6c3d 6c6f      ..    val=lo
+00004de0: 6f70 2e72 756e 5f75 6e74 696c 5f63 6f6d  op.run_until_com
+00004df0: 706c 6574 6528 7463 705f 6563 686f 5f63  plete(tcp_echo_c
+00004e00: 6c69 656e 7476 6970 6572 2876 616c 7565  lientviper(value
+00004e10: 2c20 6c6f 6f70 2c68 6f73 742c 706f 7274  , loop,host,port
+00004e20: 2c6d 6963 726f 7365 7276 6963 6569 6429  ,microserviceid)
+00004e30: 290d 0a20 2020 2069 6620 636f 6e6e 6563  )..    if connec
+00004e40: 7469 6f6e 6572 726f 723a 0d0a 2020 2020  tionerror:..    
+00004e50: 2020 2020 2072 6574 7572 6e20 636f 6e6e       return conn
+00004e60: 6563 7469 6f6e 6572 726f 720d 0a0d 0a20  ectionerror.... 
+00004e70: 2020 2072 6574 7572 6e20 7661 6c0d 0a0d     return val...
+00004e80: 0a0d 0a64 6566 2076 6970 6572 7072 6f64  ...def viperprod
+00004e90: 7563 6574 6f74 6f70 6963 6275 6c6b 2876  ucetotopicbulk(v
+00004ea0: 6970 6572 746f 6b65 6e2c 686f 7374 2c70  ipertoken,host,p
+00004eb0: 6f72 742c 746f 7069 632c 7072 6f64 7563  ort,topic,produc
+00004ec0: 6572 6964 2c69 6e70 7574 6461 7461 2c70  erid,inputdata,p
+00004ed0: 6172 7469 7469 6f6e 7369 7a65 3d31 3030  artitionsize=100
+00004ee0: 2c65 6e61 626c 6574 6c73 3d31 2c64 656c  ,enabletls=1,del
+00004ef0: 6179 3d31 3030 2c62 726f 6b65 7268 6f73  ay=100,brokerhos
+00004f00: 743d 2727 2c62 726f 6b65 7270 6f72 743d  t='',brokerport=
+00004f10: 2d39 3939 2c6d 6963 726f 7365 7276 6963  -999,microservic
+00004f20: 6569 643d 2727 293a 0d0a 2020 2020 676c  eid=''):..    gl
+00004f30: 6f62 616c 2063 6f6e 6e65 6374 696f 6e65  obal connectione
+00004f40: 7272 6f72 0d0a 0d0a 2020 2020 6966 206c  rror....    if l
+00004f50: 656e 2868 6f73 7429 3d3d 3020 6f72 206c  en(host)==0 or l
+00004f60: 656e 2876 6970 6572 746f 6b65 6e29 3d3d  en(vipertoken)==
+00004f70: 3020 6f72 2070 6f72 743d 3d2d 3939 3920  0 or port==-999 
+00004f80: 6f72 206c 656e 2874 6f70 6963 293d 3d30  or len(topic)==0
+00004f90: 206f 7220 6c65 6e28 7072 6f64 7563 6572   or len(producer
+00004fa0: 6964 293d 3d30 206f 7220 6c65 6e28 696e  id)==0 or len(in
+00004fb0: 7075 7464 6174 6129 3d3d 303a 0d0a 2020  putdata)==0:..  
+00004fc0: 2020 2020 2020 2072 6574 7572 6e20 2250         return "P
+00004fd0: 6c65 6173 6520 656e 7465 7220 686f 7374  lease enter host
+00004fe0: 2c70 6f72 742c 7669 7065 7274 6f6b 656e  ,port,vipertoken
+00004ff0: 2c74 6f70 6963 2c20 7072 6f64 7563 6572  ,topic, producer
+00005000: 6964 2c69 6e70 7574 6461 7461 220d 0a20  id,inputdata".. 
+00005010: 2020 2020 2020 200d 0a20 2020 2076 616c         ..    val
+00005020: 7565 3d28 2270 726f 6475 6365 746f 746f  ue=("producetoto
+00005030: 7069 6362 756c 6b3f 7669 7065 7274 6f6b  picbulk?vipertok
+00005040: 656e 3d22 2b76 6970 6572 746f 6b65 6e20  en="+vipertoken 
+00005050: 2b20 2226 746f 7069 633d 222b 746f 7069  + "&topic="+topi
+00005060: 6320 2b20 2226 7072 6f64 7563 6572 6964  c + "&producerid
+00005070: 3d22 202b 2070 726f 6475 6365 7269 6420  =" + producerid 
+00005080: 2b20 0d0a 2020 2020 2020 2020 2020 2226  + ..          "&
+00005090: 6465 6c61 793d 2220 2b20 7374 7228 6465  delay=" + str(de
+000050a0: 6c61 7929 202b 2020 2226 656e 6162 6c65  lay) +  "&enable
+000050b0: 746c 733d 222b 7374 7228 656e 6162 6c65  tls="+str(enable
+000050c0: 746c 7329 2b20 2226 6578 7465 726e 616c  tls)+ "&external
+000050d0: 7072 6564 6963 7469 6f6e 3d22 2b69 6e70  prediction="+inp
+000050e0: 7574 6461 7461 202b 0d0a 2020 2020 2020  utdata +..      
+000050f0: 2020 2020 2226 6272 6f6b 6572 686f 7374      "&brokerhost
+00005100: 3d22 2b62 726f 6b65 7268 6f73 742b 2226  ="+brokerhost+"&
+00005110: 6272 6f6b 6572 706f 7274 3d22 2b73 7472  brokerport="+str
+00005120: 2862 726f 6b65 7270 6f72 7429 202b 2022  (brokerport) + "
+00005130: 2670 6172 7469 7469 6f6e 7369 7a65 3d22  &partitionsize="
+00005140: 2b73 7472 2870 6172 7469 7469 6f6e 7369  +str(partitionsi
+00005150: 7a65 2929 200d 0a0d 0a20 2020 2076 616c  ze)) ....    val
+00005160: 3d6c 6f6f 702e 7275 6e5f 756e 7469 6c5f  =loop.run_until_
+00005170: 636f 6d70 6c65 7465 2874 6370 5f65 6368  complete(tcp_ech
+00005180: 6f5f 636c 6965 6e74 7669 7065 7228 7661  o_clientviper(va
+00005190: 6c75 652c 206c 6f6f 702c 686f 7374 2c70  lue, loop,host,p
+000051a0: 6f72 742c 6d69 6372 6f73 6572 7669 6365  ort,microservice
+000051b0: 6964 2929 0d0a 2020 2020 6966 2063 6f6e  id))..    if con
+000051c0: 6e65 6374 696f 6e65 7272 6f72 3a0d 0a20  nectionerror:.. 
+000051d0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+000051e0: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
+000051f0: 0d0a 2020 2020 7265 7475 726e 2076 616c  ..    return val
+00005200: 0d0a 0d0a 6465 6620 7669 7065 7263 6f6e  ....def vipercon
+00005210: 7375 6d65 6672 6f6d 746f 7069 6362 6174  sumefromtopicbat
+00005220: 6368 2876 6970 6572 746f 6b65 6e2c 686f  ch(vipertoken,ho
+00005230: 7374 2c70 6f72 742c 746f 7069 632c 636f  st,port,topic,co
+00005240: 6e73 756d 6572 6964 2c63 6f6d 7061 6e79  nsumerid,company
+00005250: 6e61 6d65 2c70 6172 7469 7469 6f6e 3d2d  name,partition=-
+00005260: 312c 656e 6162 6c65 746c 733d 302c 6465  1,enabletls=0,de
+00005270: 6c61 793d 3130 302c 6f66 6673 6574 3d30  lay=100,offset=0
+00005280: 2c62 726f 6b65 7268 6f73 743d 2727 2c0d  ,brokerhost='',.
+00005290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000052a0: 2020 2020 2020 2020 2020 2062 726f 6b65             broke
+000052b0: 7270 6f72 743d 2d39 3939 2c6d 6963 726f  rport=-999,micro
+000052c0: 7365 7276 6963 6569 643d 2727 2c74 6f70  serviceid='',top
+000052d0: 6963 6964 3d27 2d39 3939 272c 726f 6c6c  icid='-999',roll
+000052e0: 6261 636b 6f66 6673 6574 733d 302c 7072  backoffsets=0,pr
+000052f0: 6570 726f 6365 7373 7479 7065 3d27 272c  eprocesstype='',
+00005300: 7469 6d65 6465 6c61 793d 302c 6173 796e  timedelay=0,asyn
+00005310: 6374 696d 656f 7574 3d31 3230 293a 0d0a  ctimeout=120):..
+00005320: 2020 2020 676c 6f62 616c 2063 6f6e 6e65      global conne
+00005330: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
+00005340: 2020 6966 206c 656e 2868 6f73 7429 3d3d    if len(host)==
+00005350: 3020 6f72 206c 656e 2876 6970 6572 746f  0 or len(viperto
+00005360: 6b65 6e29 3d3d 3020 6f72 2070 6f72 743d  ken)==0 or port=
+00005370: 3d2d 3939 3920 6f72 206c 656e 2874 6f70  =-999 or len(top
+00005380: 6963 293d 3d30 2020 6f72 206c 656e 2863  ic)==0  or len(c
+00005390: 6f6d 7061 6e79 6e61 6d65 293d 3d30 3a0d  ompanyname)==0:.
+000053a0: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
+000053b0: 2022 506c 6561 7365 2065 6e74 6572 2068   "Please enter h
+000053c0: 6f73 742c 706f 7274 2c76 6970 6572 746f  ost,port,viperto
+000053d0: 6b65 6e2c 746f 7069 632c 636f 6d70 616e  ken,topic,compan
+000053e0: 796e 616d 6522 0d0a 2020 2020 2020 2020  yname"..        
+000053f0: 0d0a 2020 2020 7661 6c75 653d 2822 636f  ..    value=("co
+00005400: 6e73 756d 6566 726f 6d74 6f70 6963 6261  nsumefromtopicba
+00005410: 7463 683f 7669 7065 7274 6f6b 656e 3d22  tch?vipertoken="
+00005420: 2b76 6970 6572 746f 6b65 6e20 2b20 2226  +vipertoken + "&
+00005430: 746f 7069 633d 222b 746f 7069 6320 2b20  topic="+topic + 
+00005440: 2226 636f 6e73 756d 6572 6964 3d22 202b  "&consumerid=" +
+00005450: 2063 6f6e 7375 6d65 7269 6420 2b20 2226   consumerid + "&
+00005460: 6f66 6673 6574 3d22 2b73 7472 286f 6666  offset="+str(off
+00005470: 7365 7429 202b 0d0a 2020 2020 2020 2226  set) +..      "&
+00005480: 7061 7274 6974 696f 6e3d 2220 2b20 7374  partition=" + st
+00005490: 7228 7061 7274 6974 696f 6e29 202b 2020  r(partition) +  
+000054a0: 2226 6465 6c61 793d 2220 2b20 7374 7228  "&delay=" + str(
+000054b0: 6465 6c61 7929 202b 2020 2226 656e 6162  delay) +  "&enab
+000054c0: 6c65 746c 733d 2220 2b20 7374 7228 656e  letls=" + str(en
+000054d0: 6162 6c65 746c 7329 202b 2022 2662 726f  abletls) + "&bro
+000054e0: 6b65 7268 6f73 743d 222b 6272 6f6b 6572  kerhost="+broker
+000054f0: 686f 7374 0d0a 2020 2020 2020 2020 2020  host..          
+00005500: 202b 2022 2662 726f 6b65 7270 6f72 743d   + "&brokerport=
+00005510: 222b 7374 7228 6272 6f6b 6572 706f 7274  "+str(brokerport
+00005520: 292b 2226 636f 6d70 616e 796e 616d 653d  )+"&companyname=
+00005530: 222b 636f 6d70 616e 796e 616d 6520 2b20  "+companyname + 
+00005540: 2226 746f 7069 6369 643d 2220 2b20 746f  "&topicid=" + to
+00005550: 7069 6369 6420 2b0d 0a20 2020 2020 2020  picid +..       
+00005560: 2020 2020 2226 726f 6c6c 6261 636b 6f66      "&rollbackof
+00005570: 6673 6574 733d 2220 2b20 7374 7228 726f  fsets=" + str(ro
+00005580: 6c6c 6261 636b 6f66 6673 6574 7329 202b  llbackoffsets) +
+00005590: 2022 2670 7265 7072 6f63 6573 7374 7970   "&preprocesstyp
+000055a0: 653d 2220 2b20 7072 6570 726f 6365 7373  e=" + preprocess
+000055b0: 7479 7065 2b20 2226 7469 6d65 6465 6c61  type+ "&timedela
+000055c0: 793d 2220 2b20 7374 7228 7469 6d65 6465  y=" + str(timede
+000055d0: 6c61 7929 290d 0a0d 0a20 2020 2076 616c  lay))....    val
+000055e0: 3d6c 6f6f 702e 7275 6e5f 756e 7469 6c5f  =loop.run_until_
+000055f0: 636f 6d70 6c65 7465 2874 6370 5f65 6368  complete(tcp_ech
+00005600: 6f5f 636c 6965 6e74 7669 7065 7228 7661  o_clientviper(va
+00005610: 6c75 652c 206c 6f6f 702c 686f 7374 2c70  lue, loop,host,p
+00005620: 6f72 742c 6d69 6372 6f73 6572 7669 6365  ort,microservice
+00005630: 6964 2c61 7379 6e63 7469 6d65 6f75 7429  id,asynctimeout)
+00005640: 290d 0a20 2020 2069 6620 636f 6e6e 6563  )..    if connec
+00005650: 7469 6f6e 6572 726f 723a 0d0a 2020 2020  tionerror:..    
+00005660: 2020 2020 2072 6574 7572 6e20 636f 6e6e       return conn
+00005670: 6563 7469 6f6e 6572 726f 720d 0a0d 0a20  ectionerror.... 
+00005680: 2020 2072 6574 7572 6e20 7661 6c0d 0a0d     return val...
+00005690: 0a64 6566 2076 6970 6572 636f 6e73 756d  .def viperconsum
+000056a0: 6566 726f 6d74 6f70 6963 2876 6970 6572  efromtopic(viper
+000056b0: 746f 6b65 6e2c 686f 7374 2c70 6f72 742c  token,host,port,
+000056c0: 746f 7069 632c 636f 6e73 756d 6572 6964  topic,consumerid
+000056d0: 2c63 6f6d 7061 6e79 6e61 6d65 2c70 6172  ,companyname,par
+000056e0: 7469 7469 6f6e 3d2d 312c 656e 6162 6c65  tition=-1,enable
+000056f0: 746c 733d 302c 6465 6c61 793d 3130 302c  tls=0,delay=100,
+00005700: 6f66 6673 6574 3d30 2c62 726f 6b65 7268  offset=0,brokerh
+00005710: 6f73 743d 2727 2c0d 0a20 2020 2020 2020  ost='',..       
+00005720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005730: 2020 2062 726f 6b65 7270 6f72 743d 2d39     brokerport=-9
+00005740: 3939 2c6d 6963 726f 7365 7276 6963 6569  99,microservicei
+00005750: 643d 2727 2c74 6f70 6963 6964 3d27 2d39  d='',topicid='-9
+00005760: 3939 272c 726f 6c6c 6261 636b 6f66 6673  99',rollbackoffs
+00005770: 6574 733d 302c 7072 6570 726f 6365 7373  ets=0,preprocess
+00005780: 7479 7065 3d27 2729 3a0d 0a20 2020 2067  type=''):..    g
+00005790: 6c6f 6261 6c20 636f 6e6e 6563 7469 6f6e  lobal connection
+000057a0: 6572 726f 720d 0a0d 0a20 2020 2069 6620  error....    if 
+000057b0: 6c65 6e28 686f 7374 293d 3d30 206f 7220  len(host)==0 or 
+000057c0: 6c65 6e28 7669 7065 7274 6f6b 656e 293d  len(vipertoken)=
+000057d0: 3d30 206f 7220 706f 7274 3d3d 2d39 3939  =0 or port==-999
+000057e0: 206f 7220 6c65 6e28 746f 7069 6329 3d3d   or len(topic)==
+000057f0: 3020 206f 7220 6c65 6e28 636f 6d70 616e  0  or len(compan
+00005800: 796e 616d 6529 3d3d 303a 0d0a 2020 2020  yname)==0:..    
+00005810: 2020 2020 2072 6574 7572 6e20 2250 6c65       return "Ple
+00005820: 6173 6520 656e 7465 7220 686f 7374 2c70  ase enter host,p
+00005830: 6f72 742c 7669 7065 7274 6f6b 656e 2c74  ort,vipertoken,t
+00005840: 6f70 6963 2c63 6f6d 7061 6e79 6e61 6d65  opic,companyname
+00005850: 220d 0a20 2020 2020 2020 200d 0a20 2020  "..        ..   
+00005860: 2076 616c 7565 3d28 2263 6f6e 7375 6d65   value=("consume
+00005870: 6672 6f6d 746f 7069 633f 7669 7065 7274  fromtopic?vipert
+00005880: 6f6b 656e 3d22 2b76 6970 6572 746f 6b65  oken="+vipertoke
+00005890: 6e20 2b20 2226 746f 7069 633d 222b 746f  n + "&topic="+to
+000058a0: 7069 6320 2b20 2226 636f 6e73 756d 6572  pic + "&consumer
+000058b0: 6964 3d22 202b 2063 6f6e 7375 6d65 7269  id=" + consumeri
+000058c0: 6420 2b20 2226 6f66 6673 6574 3d22 2b73  d + "&offset="+s
+000058d0: 7472 286f 6666 7365 7429 202b 0d0a 2020  tr(offset) +..  
+000058e0: 2020 2020 2226 7061 7274 6974 696f 6e3d      "&partition=
+000058f0: 2220 2b20 7374 7228 7061 7274 6974 696f  " + str(partitio
+00005900: 6e29 202b 2020 2226 6465 6c61 793d 2220  n) +  "&delay=" 
+00005910: 2b20 7374 7228 6465 6c61 7929 202b 2020  + str(delay) +  
+00005920: 2226 656e 6162 6c65 746c 733d 2220 2b20  "&enabletls=" + 
+00005930: 7374 7228 656e 6162 6c65 746c 7329 202b  str(enabletls) +
+00005940: 2022 2662 726f 6b65 7268 6f73 743d 222b   "&brokerhost="+
+00005950: 6272 6f6b 6572 686f 7374 0d0a 2020 2020  brokerhost..    
+00005960: 2020 2020 2020 202b 2022 2662 726f 6b65         + "&broke
+00005970: 7270 6f72 743d 222b 7374 7228 6272 6f6b  rport="+str(brok
+00005980: 6572 706f 7274 292b 2226 636f 6d70 616e  erport)+"&compan
+00005990: 796e 616d 653d 222b 636f 6d70 616e 796e  yname="+companyn
+000059a0: 616d 6520 2b20 2226 746f 7069 6369 643d  ame + "&topicid=
+000059b0: 2220 2b20 746f 7069 6369 6420 2b0d 0a20  " + topicid +.. 
+000059c0: 2020 2020 2020 2020 2020 2226 726f 6c6c            "&roll
+000059d0: 6261 636b 6f66 6673 6574 733d 2220 2b20  backoffsets=" + 
+000059e0: 7374 7228 726f 6c6c 6261 636b 6f66 6673  str(rollbackoffs
+000059f0: 6574 7329 202b 2022 2670 7265 7072 6f63  ets) + "&preproc
+00005a00: 6573 7374 7970 653d 2220 2b20 7072 6570  esstype=" + prep
+00005a10: 726f 6365 7373 7479 7065 290d 0a0d 0a20  rocesstype).... 
+00005a20: 2020 2076 616c 3d6c 6f6f 702e 7275 6e5f     val=loop.run_
+00005a30: 756e 7469 6c5f 636f 6d70 6c65 7465 2874  until_complete(t
+00005a40: 6370 5f65 6368 6f5f 636c 6965 6e74 7669  cp_echo_clientvi
+00005a50: 7065 7228 7661 6c75 652c 206c 6f6f 702c  per(value, loop,
+00005a60: 686f 7374 2c70 6f72 742c 6d69 6372 6f73  host,port,micros
+00005a70: 6572 7669 6365 6964 2929 0d0a 2020 2020  erviceid))..    
+00005a80: 6966 2063 6f6e 6e65 6374 696f 6e65 7272  if connectionerr
+00005a90: 6f72 3a0d 0a20 2020 2020 2020 2020 7265  or:..         re
+00005aa0: 7475 726e 2063 6f6e 6e65 6374 696f 6e65  turn connectione
+00005ab0: 7272 6f72 0d0a 0d0a 2020 2020 7265 7475  rror....    retu
+00005ac0: 726e 2076 616c 0d0a 0d0a 6465 6620 7669  rn val....def vi
+00005ad0: 7065 7268 7064 6570 7265 6469 6374 6261  perhpdepredictba
+00005ae0: 7463 6828 7669 7065 7274 6f6b 656e 2c68  tch(vipertoken,h
+00005af0: 6f73 742c 706f 7274 2c63 6f6e 7375 6d65  ost,port,consume
+00005b00: 6672 6f6d 2c70 726f 6475 6365 746f 2c63  from,produceto,c
+00005b10: 6f6d 7061 6e79 6e61 6d65 2c63 6f6e 7375  ompanyname,consu
+00005b20: 6d65 7269 642c 7072 6f64 7563 6572 6964  merid,producerid
+00005b30: 2c68 7064 6568 6f73 742c 696e 7075 7464  ,hpdehost,inputd
+00005b40: 6174 612c 6d61 7872 6f77 733d 302c 616c  ata,maxrows=0,al
+00005b50: 676f 6b65 793d 2727 2c70 6172 7469 7469  gokey='',partiti
+00005b60: 6f6e 3d2d 312c 6f66 6673 6574 3d2d 312c  on=-1,offset=-1,
+00005b70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005b80: 2020 2020 2020 2065 6e61 626c 6574 6c73         enabletls
+00005b90: 3d31 2c64 656c 6179 3d31 3030 2c68 7064  =1,delay=100,hpd
+00005ba0: 6570 6f72 743d 2d39 3939 2c62 726f 6b65  eport=-999,broke
+00005bb0: 7268 6f73 743d 2727 2c62 726f 6b65 7270  rhost='',brokerp
+00005bc0: 6f72 743d 3930 3932 2c0d 0a20 2020 2020  ort=9092,..     
+00005bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005be0: 7469 6d65 6f75 743d 3132 302c 7573 6564  timeout=120,used
+00005bf0: 6570 6c6f 793d 302c 6d69 6372 6f73 6572  eploy=0,microser
+00005c00: 7669 6365 6964 3d27 272c 746f 7069 6369  viceid='',topici
+00005c10: 643d 222d 3939 3922 2c20 6d61 696e 746f  d="-999", mainto
+00005c20: 7069 633d 2727 2c20 7374 7265 616d 7374  pic='', streamst
+00005c30: 6f6a 6f69 6e3d 2727 2c61 7272 6179 3d30  ojoin='',array=0
+00005c40: 2c74 696d 6564 656c 6179 3d30 2c0d 0a20  ,timedelay=0,.. 
+00005c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005c60: 2020 2020 6173 796e 6374 696d 656f 7574      asynctimeout
+00005c70: 3d31 3230 2c70 6174 6874 6f61 6c67 6f73  =120,pathtoalgos
+00005c80: 3d27 2729 3a0d 0a0d 0a20 2020 2023 7265  =''):....    #re
+00005c90: 6164 7320 7468 6520 6669 656c 646e 616d  ads the fieldnam
+00005ca0: 6573 2061 6e64 2067 6574 7320 6c61 7465  es and gets late
+00005cb0: 7374 2064 6174 6120 6672 6f6d 2065 6163  st data from eac
+00005cc0: 6820 7374 7265 616d 2028 6f72 2066 6965  h stream (or fie
+00005cd0: 6c64 6e61 6d65 290d 0a20 2020 2067 6c6f  ldname)..    glo
+00005ce0: 6261 6c20 636f 6e6e 6563 7469 6f6e 6572  bal connectioner
+00005cf0: 726f 720d 0a20 2020 200d 0a20 2020 2069  ror..    ..    i
+00005d00: 6620 286c 656e 2868 6f73 7429 3d3d 3020  f (len(host)==0 
+00005d10: 6f72 206c 656e 2876 6970 6572 746f 6b65  or len(vipertoke
+00005d20: 6e29 3d3d 3020 6f72 2070 6f72 743d 3d2d  n)==0 or port==-
+00005d30: 3939 3920 6f72 206c 656e 2863 6f6e 7375  999 or len(consu
+00005d40: 6d65 6672 6f6d 293d 3d30 206f 7220 6c65  mefrom)==0 or le
+00005d50: 6e28 7072 6f64 7563 6574 6f29 3d3d 3020  n(produceto)==0 
+00005d60: 6f72 0d0a 2020 2020 2020 2020 6c65 6e28  or..        len(
+00005d70: 636f 6d70 616e 796e 616d 6529 3d3d 3020  companyname)==0 
+00005d80: 6f72 206c 656e 2868 7064 6568 6f73 7429  or len(hpdehost)
+00005d90: 3d3d 3020 6f72 2068 7064 6570 6f72 743d  ==0 or hpdeport=
+00005da0: 3d2d 3939 3920 6f72 206c 656e 2870 6174  =-999 or len(pat
+00005db0: 6874 6f61 6c67 6f73 293d 3d30 293a 0d0a  htoalgos)==0):..
+00005dc0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00005dd0: 2250 6c65 6173 6520 656e 7465 7220 686f  "Please enter ho
+00005de0: 7374 2c70 6f72 742c 7669 7065 7274 6f6b  st,port,vipertok
+00005df0: 656e 2c63 6f6e 7375 6d65 6672 6f6d 2c69  en,consumefrom,i
+00005e00: 6e70 7574 6461 7461 2c70 726f 6475 6365  nputdata,produce
+00005e10: 746f 2c63 6f6d 7061 6e79 6e61 6d65 2c68  to,companyname,h
+00005e20: 7064 6568 6f73 742c 6870 6465 706f 7274  pdehost,hpdeport
+00005e30: 2c70 6174 6874 6f61 6c67 6f73 220d 0a20  ,pathtoalgos".. 
+00005e40: 2020 2020 2020 200d 0a20 2020 2076 616c         ..    val
+00005e50: 7565 3d28 2276 6970 6572 6870 6465 7072  ue=("viperhpdepr
+00005e60: 6564 6963 7462 6174 6368 3f76 6970 6572  edictbatch?viper
+00005e70: 746f 6b65 6e3d 222b 7669 7065 7274 6f6b  token="+vipertok
+00005e80: 656e 202b 2022 2663 6f6e 7375 6d65 6672  en + "&consumefr
+00005e90: 6f6d 3d22 2b63 6f6e 7375 6d65 6672 6f6d  om="+consumefrom
+00005ea0: 202b 2022 2670 726f 6475 6365 746f 3d22   + "&produceto="
+00005eb0: 202b 2070 726f 6475 6365 746f 202b 2022   + produceto + "
+00005ec0: 2663 6f6e 7375 6d65 7269 643d 222b 636f  &consumerid="+co
+00005ed0: 6e73 756d 6572 6964 202b 0d0a 2020 2020  nsumerid +..    
+00005ee0: 2020 2020 2020 2022 2664 656c 6179 3d22         "&delay="
+00005ef0: 202b 2073 7472 2864 656c 6179 2920 2b20   + str(delay) + 
+00005f00: 2226 696e 7075 7464 6174 613d 222b 2069  "&inputdata="+ i
+00005f10: 6e70 7574 6461 7461 202b 2022 2661 6c67  nputdata + "&alg
+00005f20: 6f6b 6579 3d22 2b61 6c67 6f6b 6579 202b  okey="+algokey +
+00005f30: 2022 266d 6178 726f 7773 3d22 202b 0d0a   "&maxrows=" +..
+00005f40: 2020 2020 2020 2020 2020 2073 7472 286d             str(m
+00005f50: 6178 726f 7773 2920 2b20 2226 7061 7274  axrows) + "&part
+00005f60: 6974 696f 6e3d 222b 7374 7228 7061 7274  ition="+str(part
+00005f70: 6974 696f 6e29 2b22 266f 6666 7365 743d  ition)+"&offset=
+00005f80: 222b 7374 7228 6f66 6673 6574 292b 2022  "+str(offset)+ "
+00005f90: 2665 6e61 626c 6574 6c73 3d22 202b 2073  &enabletls=" + s
+00005fa0: 7472 2865 6e61 626c 6574 6c73 290d 0a20  tr(enabletls).. 
+00005fb0: 2020 2020 2020 2020 2020 2b20 2226 7072            + "&pr
+00005fc0: 6f64 7563 6572 6964 3d22 2b70 726f 6475  oducerid="+produ
+00005fd0: 6365 7269 6420 2b20 2226 7573 6564 6570  cerid + "&usedep
+00005fe0: 6c6f 793d 2220 2b73 7472 2875 7365 6465  loy=" +str(usede
+00005ff0: 706c 6f79 2920 2b22 2663 6f6d 7061 6e79  ploy) +"&company
+00006000: 6e61 6d65 3d22 2b63 6f6d 7061 6e79 6e61  name="+companyna
+00006010: 6d65 202b 2022 2668 7064 6568 6f73 743d  me + "&hpdehost=
+00006020: 220d 0a20 2020 2020 2020 2020 2020 2b68  "..           +h
+00006030: 7064 6568 6f73 7420 2b22 2668 7064 6570  pdehost +"&hpdep
+00006040: 6f72 743d 222b 7374 7228 6870 6465 706f  ort="+str(hpdepo
+00006050: 7274 292b 2226 6272 6f6b 6572 686f 7374  rt)+"&brokerhost
+00006060: 3d22 2b62 726f 6b65 7268 6f73 7420 2b20  ="+brokerhost + 
+00006070: 2226 6272 6f6b 6572 706f 7274 3d22 2b73  "&brokerport="+s
+00006080: 7472 2862 726f 6b65 7270 6f72 7429 202b  tr(brokerport) +
+00006090: 0d0a 2020 2020 2020 2020 2020 2022 2674  ..           "&t
+000060a0: 6f70 6963 6964 3d22 202b 2074 6f70 6963  opicid=" + topic
+000060b0: 6964 202b 2022 266d 6169 6e74 6f70 6963  id + "&maintopic
+000060c0: 3d22 202b 206d 6169 6e74 6f70 6963 202b  =" + maintopic +
+000060d0: 2022 2673 7472 6561 6d73 746f 6a6f 696e   "&streamstojoin
+000060e0: 3d22 202b 2073 7472 6561 6d73 746f 6a6f  =" + streamstojo
+000060f0: 696e 202b 2022 2661 7272 6179 3d22 202b  in + "&array=" +
+00006100: 0d0a 2020 2020 2020 2020 2020 2073 7472  ..           str
+00006110: 2861 7272 6179 292b 2022 2674 696d 6564  (array)+ "&timed
+00006120: 656c 6179 3d22 202b 2073 7472 2874 696d  elay=" + str(tim
+00006130: 6564 656c 6179 2920 2b20 2226 7061 7468  edelay) + "&path
+00006140: 746f 616c 676f 733d 222b 7061 7468 746f  toalgos="+pathto
+00006150: 616c 676f 7329 0d0a 0d0a 2020 2020 7661  algos)....    va
+00006160: 6c3d 6c6f 6f70 2e72 756e 5f75 6e74 696c  l=loop.run_until
+00006170: 5f63 6f6d 706c 6574 6528 7463 705f 6563  _complete(tcp_ec
+00006180: 686f 5f63 6c69 656e 7476 6970 6572 2876  ho_clientviper(v
+00006190: 616c 7565 2c20 6c6f 6f70 2c68 6f73 742c  alue, loop,host,
+000061a0: 706f 7274 2c6d 6963 726f 7365 7276 6963  port,microservic
+000061b0: 6569 642c 6173 796e 6374 696d 656f 7574  eid,asynctimeout
+000061c0: 2929 0d0a 2020 2020 6966 2063 6f6e 6e65  ))..    if conne
+000061d0: 6374 696f 6e65 7272 6f72 3a0d 0a20 2020  ctionerror:..   
+000061e0: 2020 2020 2020 7265 7475 726e 2063 6f6e        return con
+000061f0: 6e65 6374 696f 6e65 7272 6f72 0d0a 2020  nectionerror..  
+00006200: 2020 0d0a 2020 2020 7265 7475 726e 2076    ..    return v
+00006210: 616c 0d0a 0d0a 6465 6620 7669 7065 7268  al....def viperh
+00006220: 7064 6570 7265 6469 6374 2876 6970 6572  pdepredict(viper
+00006230: 746f 6b65 6e2c 686f 7374 2c70 6f72 742c  token,host,port,
+00006240: 636f 6e73 756d 6566 726f 6d2c 7072 6f64  consumefrom,prod
+00006250: 7563 6574 6f2c 636f 6d70 616e 796e 616d  uceto,companynam
+00006260: 652c 636f 6e73 756d 6572 6964 2c70 726f  e,consumerid,pro
+00006270: 6475 6365 7269 642c 6870 6465 686f 7374  ducerid,hpdehost
+00006280: 2c69 6e70 7574 6461 7461 2c6d 6178 726f  ,inputdata,maxro
+00006290: 7773 3d30 2c61 6c67 6f6b 6579 3d27 272c  ws=0,algokey='',
+000062a0: 7061 7274 6974 696f 6e3d 2d31 2c6f 6666  partition=-1,off
+000062b0: 7365 743d 2d31 2c0d 0a20 2020 2020 2020  set=-1,..       
+000062c0: 2020 2020 2020 2020 2020 2020 2020 656e                en
+000062d0: 6162 6c65 746c 733d 312c 6465 6c61 793d  abletls=1,delay=
+000062e0: 3130 3030 2c68 7064 6570 6f72 743d 2d39  1000,hpdeport=-9
+000062f0: 3939 2c62 726f 6b65 7268 6f73 743d 2727  99,brokerhost=''
+00006300: 2c62 726f 6b65 7270 6f72 743d 3930 3932  ,brokerport=9092
+00006310: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00006320: 2020 2020 2020 2020 7469 6d65 6f75 743d          timeout=
+00006330: 3132 302c 7573 6564 6570 6c6f 793d 302c  120,usedeploy=0,
+00006340: 6d69 6372 6f73 6572 7669 6365 6964 3d27  microserviceid='
+00006350: 272c 746f 7069 6369 643d 2d39 3939 2c20  ',topicid=-999, 
+00006360: 6d61 696e 746f 7069 633d 2727 2c0d 0a20  maintopic='',.. 
+00006370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006380: 2020 2020 7374 7265 616d 7374 6f6a 6f69      streamstojoi
+00006390: 6e3d 2727 2c61 7272 6179 3d30 2c70 6174  n='',array=0,pat
+000063a0: 6874 6f61 6c67 6f73 3d27 2729 3a0d 0a0d  htoalgos=''):...
+000063b0: 0a20 2020 2023 7265 6164 7320 7468 6520  .    #reads the 
+000063c0: 6669 656c 646e 616d 6573 2061 6e64 2067  fieldnames and g
+000063d0: 6574 7320 6c61 7465 7374 2064 6174 6120  ets latest data 
+000063e0: 6672 6f6d 2065 6163 6820 7374 7265 616d  from each stream
+000063f0: 2028 6f72 2066 6965 6c64 6e61 6d65 290d   (or fieldname).
+00006400: 0a20 2020 2067 6c6f 6261 6c20 636f 6e6e  .    global conn
+00006410: 6563 7469 6f6e 6572 726f 720d 0a20 2020  ectionerror..   
+00006420: 200d 0a20 2020 2069 6620 286c 656e 2868   ..    if (len(h
+00006430: 6f73 7429 3d3d 3020 6f72 206c 656e 2876  ost)==0 or len(v
+00006440: 6970 6572 746f 6b65 6e29 3d3d 3020 6f72  ipertoken)==0 or
+00006450: 2070 6f72 743d 3d2d 3939 3920 6f72 206c   port==-999 or l
+00006460: 656e 2863 6f6e 7375 6d65 6672 6f6d 293d  en(consumefrom)=
+00006470: 3d30 206f 7220 6c65 6e28 7072 6f64 7563  =0 or len(produc
+00006480: 6574 6f29 3d3d 3020 6f72 0d0a 2020 2020  eto)==0 or..    
+00006490: 2020 2020 6c65 6e28 636f 6d70 616e 796e      len(companyn
+000064a0: 616d 6529 3d3d 3020 6f72 206c 656e 2868  ame)==0 or len(h
+000064b0: 7064 6568 6f73 7429 3d3d 3020 6f72 2068  pdehost)==0 or h
+000064c0: 7064 6570 6f72 743d 3d2d 3939 3920 6f72  pdeport==-999 or
+000064d0: 206c 656e 2870 6174 6874 6f61 6c67 6f73   len(pathtoalgos
+000064e0: 293d 3d30 293a 0d0a 2020 2020 2020 2020  )==0):..        
+000064f0: 2072 6574 7572 6e20 2250 6c65 6173 6520   return "Please 
+00006500: 656e 7465 7220 686f 7374 2c70 6f72 742c  enter host,port,
+00006510: 7669 7065 7274 6f6b 656e 2c63 6f6e 7375  vipertoken,consu
+00006520: 6d65 6672 6f6d 2c69 6e70 7574 6461 7461  mefrom,inputdata
+00006530: 2c70 726f 6475 6365 746f 2c63 6f6d 7061  ,produceto,compa
+00006540: 6e79 6e61 6d65 2c68 7064 6568 6f73 742c  nyname,hpdehost,
+00006550: 6870 6465 706f 7274 2c70 6174 6874 6f61  hpdeport,pathtoa
+00006560: 6c67 6f73 220d 0a20 2020 2020 2020 200d  lgos"..        .
+00006570: 0a20 2020 2076 616c 7565 3d28 2276 6970  .    value=("vip
+00006580: 6572 6870 6465 7072 6564 6963 743f 7669  erhpdepredict?vi
+00006590: 7065 7274 6f6b 656e 3d22 2b76 6970 6572  pertoken="+viper
+000065a0: 746f 6b65 6e20 2b20 2226 636f 6e73 756d  token + "&consum
+000065b0: 6566 726f 6d3d 222b 636f 6e73 756d 6566  efrom="+consumef
+000065c0: 726f 6d20 2b20 2226 7072 6f64 7563 6574  rom + "&producet
+000065d0: 6f3d 2220 2b20 7072 6f64 7563 6574 6f20  o=" + produceto 
+000065e0: 2b20 2226 636f 6e73 756d 6572 6964 3d22  + "&consumerid="
+000065f0: 2b63 6f6e 7375 6d65 7269 6420 2b0d 0a20  +consumerid +.. 
+00006600: 2020 2020 2020 2020 2020 2226 6465 6c61            "&dela
+00006610: 793d 2220 2b20 7374 7228 6465 6c61 7929  y=" + str(delay)
+00006620: 202b 2022 2669 6e70 7574 6461 7461 3d22   + "&inputdata="
+00006630: 2b20 696e 7075 7464 6174 6120 2b20 2226  + inputdata + "&
+00006640: 616c 676f 6b65 793d 222b 616c 676f 6b65  algokey="+algoke
+00006650: 7920 2b20 2226 6d61 7872 6f77 733d 2220  y + "&maxrows=" 
+00006660: 2b0d 0a20 2020 2020 2020 2020 2020 7374  +..           st
+00006670: 7228 6d61 7872 6f77 7329 202b 2022 2670  r(maxrows) + "&p
+00006680: 6172 7469 7469 6f6e 3d22 2b73 7472 2870  artition="+str(p
+00006690: 6172 7469 7469 6f6e 292b 2226 6f66 6673  artition)+"&offs
+000066a0: 6574 3d22 2b73 7472 286f 6666 7365 7429  et="+str(offset)
+000066b0: 2b20 2226 656e 6162 6c65 746c 733d 2220  + "&enabletls=" 
+000066c0: 2b20 7374 7228 656e 6162 6c65 746c 7329  + str(enabletls)
+000066d0: 0d0a 2020 2020 2020 2020 2020 202b 2022  ..           + "
+000066e0: 2670 726f 6475 6365 7269 643d 222b 7072  &producerid="+pr
+000066f0: 6f64 7563 6572 6964 202b 2022 2675 7365  oducerid + "&use
+00006700: 6465 706c 6f79 3d22 202b 7374 7228 7573  deploy=" +str(us
+00006710: 6564 6570 6c6f 7929 202b 2226 636f 6d70  edeploy) +"&comp
+00006720: 616e 796e 616d 653d 222b 636f 6d70 616e  anyname="+compan
+00006730: 796e 616d 6520 2b20 2226 6870 6465 686f  yname + "&hpdeho
+00006740: 7374 3d22 0d0a 2020 2020 2020 2020 2020  st="..          
+00006750: 202b 6870 6465 686f 7374 202b 2226 6870   +hpdehost +"&hp
+00006760: 6465 706f 7274 3d22 2b73 7472 2868 7064  deport="+str(hpd
+00006770: 6570 6f72 7429 2b22 2662 726f 6b65 7268  eport)+"&brokerh
+00006780: 6f73 743d 222b 6272 6f6b 6572 686f 7374  ost="+brokerhost
+00006790: 202b 2022 2662 726f 6b65 7270 6f72 743d   + "&brokerport=
+000067a0: 222b 7374 7228 6272 6f6b 6572 706f 7274  "+str(brokerport
+000067b0: 2920 2b0d 0a20 2020 2020 2020 2020 2020  ) +..           
+000067c0: 2226 746f 7069 6369 643d 2220 2b20 7374  "&topicid=" + st
+000067d0: 7228 746f 7069 6369 6429 202b 2022 266d  r(topicid) + "&m
+000067e0: 6169 6e74 6f70 6963 3d22 202b 206d 6169  aintopic=" + mai
+000067f0: 6e74 6f70 6963 202b 2022 2673 7472 6561  ntopic + "&strea
+00006800: 6d73 746f 6a6f 696e 3d22 202b 2073 7472  mstojoin=" + str
+00006810: 6561 6d73 746f 6a6f 696e 202b 2022 2661  eamstojoin + "&a
+00006820: 7272 6179 3d22 202b 2073 7472 2861 7272  rray=" + str(arr
+00006830: 6179 2920 2b0d 0a20 2020 2020 2020 2020  ay) +..         
+00006840: 2020 2226 7061 7468 746f 616c 676f 733d    "&pathtoalgos=
+00006850: 222b 7061 7468 746f 616c 676f 7329 0d0a  "+pathtoalgos)..
+00006860: 0d0a 2020 2020 7661 6c3d 6c6f 6f70 2e72  ..    val=loop.r
+00006870: 756e 5f75 6e74 696c 5f63 6f6d 706c 6574  un_until_complet
+00006880: 6528 7463 705f 6563 686f 5f63 6c69 656e  e(tcp_echo_clien
+00006890: 7476 6970 6572 2876 616c 7565 2c20 6c6f  tviper(value, lo
+000068a0: 6f70 2c68 6f73 742c 706f 7274 2c6d 6963  op,host,port,mic
+000068b0: 726f 7365 7276 6963 6569 642c 7469 6d65  roserviceid,time
+000068c0: 6f75 7429 290d 0a20 2020 2069 6620 636f  out))..    if co
+000068d0: 6e6e 6563 7469 6f6e 6572 726f 723a 0d0a  nnectionerror:..
+000068e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000068f0: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
+00006900: 0a20 2020 200d 0a20 2020 2072 6574 7572  .    ..    retur
+00006910: 6e20 7661 6c0d 0a0d 0a64 6566 2076 6970  n val....def vip
+00006920: 6572 6870 6465 7072 6564 6963 7470 726f  erhpdepredictpro
+00006930: 6365 7373 2876 6970 6572 746f 6b65 6e2c  cess(vipertoken,
+00006940: 686f 7374 2c70 6f72 742c 636f 6e73 756d  host,port,consum
+00006950: 6566 726f 6d2c 7072 6f64 7563 6574 6f2c  efrom,produceto,
+00006960: 636f 6d70 616e 796e 616d 652c 636f 6e73  companyname,cons
+00006970: 756d 6572 6964 2c70 726f 6475 6365 7269  umerid,produceri
+00006980: 642c 6870 6465 686f 7374 2c69 6e70 7574  d,hpdehost,input
+00006990: 6461 7461 2c70 726f 6365 7373 7479 7065  data,processtype
+000069a0: 2c6d 6178 726f 7773 3d30 2c61 6c67 6f6b  ,maxrows=0,algok
+000069b0: 6579 3d27 272c 7061 7274 6974 696f 6e3d  ey='',partition=
+000069c0: 2d31 2c6f 6666 7365 743d 2d31 2c0d 0a20  -1,offset=-1,.. 
+000069d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000069e0: 2020 2020 656e 6162 6c65 746c 733d 312c      enabletls=1,
+000069f0: 6465 6c61 793d 3130 3030 2c68 7064 6570  delay=1000,hpdep
+00006a00: 6f72 743d 2d39 3939 2c62 726f 6b65 7268  ort=-999,brokerh
+00006a10: 6f73 743d 2727 2c62 726f 6b65 7270 6f72  ost='',brokerpor
+00006a20: 743d 3930 3932 2c0d 0a20 2020 2020 2020  t=9092,..       
+00006a30: 2020 2020 2020 2020 2020 2020 2020 7469                ti
+00006a40: 6d65 6f75 743d 3132 302c 7573 6564 6570  meout=120,usedep
+00006a50: 6c6f 793d 302c 6d69 6372 6f73 6572 7669  loy=0,microservi
+00006a60: 6365 6964 3d27 272c 746f 7069 6369 643d  ceid='',topicid=
+00006a70: 2d39 3939 2c20 6d61 696e 746f 7069 633d  -999, maintopic=
+00006a80: 2727 2c0d 0a20 2020 2020 2020 2020 2020  '',..           
+00006a90: 2020 2020 2020 2020 2020 7374 7265 616d            stream
+00006aa0: 7374 6f6a 6f69 6e3d 2727 2c61 7272 6179  stojoin='',array
+00006ab0: 3d30 2c70 6174 6874 6f61 6c67 6f73 3d27  =0,pathtoalgos='
+00006ac0: 2729 3a0d 0a0d 0a20 2020 2023 7265 6164  '):....    #read
+00006ad0: 7320 7468 6520 6669 656c 646e 616d 6573  s the fieldnames
+00006ae0: 2061 6e64 2067 6574 7320 6c61 7465 7374   and gets latest
+00006af0: 2064 6174 6120 6672 6f6d 2065 6163 6820   data from each 
+00006b00: 7374 7265 616d 2028 6f72 2066 6965 6c64  stream (or field
+00006b10: 6e61 6d65 290d 0a20 2020 2067 6c6f 6261  name)..    globa
+00006b20: 6c20 636f 6e6e 6563 7469 6f6e 6572 726f  l connectionerro
+00006b30: 720d 0a20 2020 200d 0a20 2020 2069 6620  r..    ..    if 
+00006b40: 286c 656e 2868 6f73 7429 3d3d 3020 6f72  (len(host)==0 or
+00006b50: 206c 656e 2876 6970 6572 746f 6b65 6e29   len(vipertoken)
+00006b60: 3d3d 3020 6f72 2070 6f72 743d 3d2d 3939  ==0 or port==-99
+00006b70: 3920 6f72 206c 656e 2863 6f6e 7375 6d65  9 or len(consume
+00006b80: 6672 6f6d 293d 3d30 206f 7220 6c65 6e28  from)==0 or len(
+00006b90: 7072 6f64 7563 6574 6f29 3d3d 3020 6f72  produceto)==0 or
+00006ba0: 0d0a 2020 2020 2020 2020 6c65 6e28 636f  ..        len(co
+00006bb0: 6d70 616e 796e 616d 6529 3d3d 3020 6f72  mpanyname)==0 or
+00006bc0: 206c 656e 2868 7064 6568 6f73 7429 3d3d   len(hpdehost)==
+00006bd0: 3020 6f72 2068 7064 6570 6f72 743d 3d2d  0 or hpdeport==-
+00006be0: 3939 3920 6f72 206c 656e 2870 6174 6874  999 or len(patht
+00006bf0: 6f61 6c67 6f73 293d 3d30 206f 7220 6c65  oalgos)==0 or le
+00006c00: 6e28 7072 6f63 6573 7374 7970 6529 3d3d  n(processtype)==
+00006c10: 3029 3a0d 0a20 2020 2020 2020 2020 7265  0):..         re
+00006c20: 7475 726e 2022 506c 6561 7365 2065 6e74  turn "Please ent
+00006c30: 6572 2068 6f73 742c 706f 7274 2c76 6970  er host,port,vip
+00006c40: 6572 746f 6b65 6e2c 636f 6e73 756d 6566  ertoken,consumef
+00006c50: 726f 6d2c 696e 7075 7464 6174 612c 7072  rom,inputdata,pr
+00006c60: 6f64 7563 6574 6f2c 636f 6d70 616e 796e  oduceto,companyn
+00006c70: 616d 652c 6870 6465 686f 7374 2c68 7064  ame,hpdehost,hpd
+00006c80: 6570 6f72 742c 7061 7468 746f 616c 676f  eport,pathtoalgo
+00006c90: 732c 7072 6f63 6573 7374 7970 6522 0d0a  s,processtype"..
+00006ca0: 2020 2020 2020 2020 0d0a 2020 2020 7661          ..    va
+00006cb0: 6c75 653d 2822 7669 7065 7268 7064 6570  lue=("viperhpdep
+00006cc0: 7265 6469 6374 7072 6f63 6573 733f 7669  redictprocess?vi
+00006cd0: 7065 7274 6f6b 656e 3d22 2b76 6970 6572  pertoken="+viper
+00006ce0: 746f 6b65 6e20 2b20 2226 636f 6e73 756d  token + "&consum
+00006cf0: 6566 726f 6d3d 222b 636f 6e73 756d 6566  efrom="+consumef
+00006d00: 726f 6d20 2b20 2226 7072 6f64 7563 6574  rom + "&producet
+00006d10: 6f3d 2220 2b20 7072 6f64 7563 6574 6f20  o=" + produceto 
+00006d20: 2b20 2226 636f 6e73 756d 6572 6964 3d22  + "&consumerid="
+00006d30: 2b63 6f6e 7375 6d65 7269 6420 2b0d 0a20  +consumerid +.. 
+00006d40: 2020 2020 2020 2020 2020 2226 6465 6c61            "&dela
+00006d50: 793d 2220 2b20 7374 7228 6465 6c61 7929  y=" + str(delay)
+00006d60: 202b 2022 2669 6e70 7574 6461 7461 3d22   + "&inputdata="
+00006d70: 2b20 696e 7075 7464 6174 6120 2b20 2226  + inputdata + "&
+00006d80: 616c 676f 6b65 793d 222b 616c 676f 6b65  algokey="+algoke
+00006d90: 7920 2b20 2226 6d61 7872 6f77 733d 2220  y + "&maxrows=" 
+00006da0: 2b0d 0a20 2020 2020 2020 2020 2020 7374  +..           st
+00006db0: 7228 6d61 7872 6f77 7329 202b 2022 2670  r(maxrows) + "&p
+00006dc0: 6172 7469 7469 6f6e 3d22 2b73 7472 2870  artition="+str(p
+00006dd0: 6172 7469 7469 6f6e 292b 2226 6f66 6673  artition)+"&offs
+00006de0: 6574 3d22 2b73 7472 286f 6666 7365 7429  et="+str(offset)
+00006df0: 2b20 2226 656e 6162 6c65 746c 733d 2220  + "&enabletls=" 
+00006e00: 2b20 7374 7228 656e 6162 6c65 746c 7329  + str(enabletls)
+00006e10: 0d0a 2020 2020 2020 2020 2020 202b 2022  ..           + "
+00006e20: 2670 726f 6475 6365 7269 643d 222b 7072  &producerid="+pr
+00006e30: 6f64 7563 6572 6964 202b 2022 2675 7365  oducerid + "&use
+00006e40: 6465 706c 6f79 3d22 202b 7374 7228 7573  deploy=" +str(us
+00006e50: 6564 6570 6c6f 7929 202b 2226 636f 6d70  edeploy) +"&comp
+00006e60: 616e 796e 616d 653d 222b 636f 6d70 616e  anyname="+compan
+00006e70: 796e 616d 6520 2b20 2226 6870 6465 686f  yname + "&hpdeho
+00006e80: 7374 3d22 0d0a 2020 2020 2020 2020 2020  st="..          
+00006e90: 202b 6870 6465 686f 7374 202b 2226 6870   +hpdehost +"&hp
+00006ea0: 6465 706f 7274 3d22 2b73 7472 2868 7064  deport="+str(hpd
+00006eb0: 6570 6f72 7429 2b22 2662 726f 6b65 7268  eport)+"&brokerh
+00006ec0: 6f73 743d 222b 6272 6f6b 6572 686f 7374  ost="+brokerhost
+00006ed0: 202b 2022 2662 726f 6b65 7270 6f72 743d   + "&brokerport=
+00006ee0: 222b 7374 7228 6272 6f6b 6572 706f 7274  "+str(brokerport
+00006ef0: 2920 2b0d 0a20 2020 2020 2020 2020 2020  ) +..           
+00006f00: 2226 746f 7069 6369 643d 2220 2b20 7374  "&topicid=" + st
+00006f10: 7228 746f 7069 6369 6429 202b 2022 266d  r(topicid) + "&m
+00006f20: 6169 6e74 6f70 6963 3d22 202b 206d 6169  aintopic=" + mai
+00006f30: 6e74 6f70 6963 202b 2022 2673 7472 6561  ntopic + "&strea
+00006f40: 6d73 746f 6a6f 696e 3d22 202b 2073 7472  mstojoin=" + str
+00006f50: 6561 6d73 746f 6a6f 696e 202b 2022 2661  eamstojoin + "&a
+00006f60: 7272 6179 3d22 202b 2073 7472 2861 7272  rray=" + str(arr
+00006f70: 6179 2920 2b0d 0a20 2020 2020 2020 2020  ay) +..         
+00006f80: 2020 2226 7061 7468 746f 616c 676f 733d    "&pathtoalgos=
+00006f90: 222b 7061 7468 746f 616c 676f 7320 2b20  "+pathtoalgos + 
+00006fa0: 2226 7072 6f63 6573 7374 7970 653d 222b  "&processtype="+
+00006fb0: 7072 6f63 6573 7374 7970 6529 0d0a 0d0a  processtype)....
+00006fc0: 2020 2020 7661 6c3d 6c6f 6f70 2e72 756e      val=loop.run
+00006fd0: 5f75 6e74 696c 5f63 6f6d 706c 6574 6528  _until_complete(
+00006fe0: 7463 705f 6563 686f 5f63 6c69 656e 7476  tcp_echo_clientv
+00006ff0: 6970 6572 2876 616c 7565 2c20 6c6f 6f70  iper(value, loop
+00007000: 2c68 6f73 742c 706f 7274 2c6d 6963 726f  ,host,port,micro
+00007010: 7365 7276 6963 6569 642c 7469 6d65 6f75  serviceid,timeou
+00007020: 7429 290d 0a20 2020 2069 6620 636f 6e6e  t))..    if conn
+00007030: 6563 7469 6f6e 6572 726f 723a 0d0a 2020  ectionerror:..  
+00007040: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
+00007050: 6e6e 6563 7469 6f6e 6572 726f 720d 0a20  nnectionerror.. 
+00007060: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
+00007070: 7661 6c0d 0a0d 0a64 6566 2076 6970 6572  val....def viper
+00007080: 6870 6465 6f70 7469 6d69 7a65 6261 7463  hpdeoptimizebatc
+00007090: 6828 7669 7065 7274 6f6b 656e 2c68 6f73  h(vipertoken,hos
+000070a0: 742c 706f 7274 2c63 6f6e 7375 6d65 6672  t,port,consumefr
+000070b0: 6f6d 2c70 726f 6475 6365 746f 2c63 6f6d  om,produceto,com
+000070c0: 7061 6e79 6e61 6d65 2c63 6f6e 7375 6d65  panyname,consume
+000070d0: 7269 642c 7072 6f64 7563 6572 6964 2c68  rid,producerid,h
+000070e0: 7064 6568 6f73 742c 7061 7274 6974 696f  pdehost,partitio
+000070f0: 6e3d 2d31 2c6f 6666 7365 743d 2d31 2c0d  n=-1,offset=-1,.
+00007100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007110: 2020 2020 2020 2065 6e61 626c 6574 6c73         enabletls
+00007120: 3d31 2c64 656c 6179 3d31 3030 2c68 7064  =1,delay=100,hpd
+00007130: 6570 6f72 743d 2d39 3939 2c75 7365 6465  eport=-999,usede
+00007140: 706c 6f79 3d30 2c0d 0a20 2020 2020 2020  ploy=0,..       
+00007150: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00007160: 736d 696e 3d31 2c63 6f6e 7374 7261 696e  smin=1,constrain
+00007170: 7473 3d27 6265 7374 272c 7374 7265 7463  ts='best',stretc
+00007180: 6862 6f75 6e64 733d 3230 2c63 6f6e 7374  hbounds=20,const
+00007190: 7261 696e 7474 7970 653d 312c 6570 7369  rainttype=1,epsi
+000071a0: 6c6f 6e3d 3130 2c62 726f 6b65 7268 6f73  lon=10,brokerhos
+000071b0: 743d 2727 2c62 726f 6b65 7270 6f72 743d  t='',brokerport=
+000071c0: 3930 3932 2c0d 0a20 2020 2020 2020 2020  9092,..         
+000071d0: 2020 2020 2020 2020 2020 2020 2074 696d               tim
+000071e0: 656f 7574 3d31 3230 2c6d 6963 726f 7365  eout=120,microse
+000071f0: 7276 6963 6569 643d 2727 2c74 6f70 6963  rviceid='',topic
+00007200: 6964 3d22 2d39 3939 222c 7469 6d65 6465  id="-999",timede
+00007210: 6c61 793d 302c 6173 796e 6374 696d 656f  lay=0,asynctimeo
+00007220: 7574 3d31 3230 293a 0d0a 0d0a 2020 2020  ut=120):....    
+00007230: 2372 6561 6473 2074 6865 2066 6965 6c64  #reads the field
+00007240: 6e61 6d65 7320 616e 6420 6765 7473 206c  names and gets l
+00007250: 6174 6573 7420 6461 7461 2066 726f 6d20  atest data from 
+00007260: 6561 6368 2073 7472 6561 6d20 286f 7220  each stream (or 
+00007270: 6669 656c 646e 616d 6529 0d0a 2020 2020  fieldname)..    
+00007280: 676c 6f62 616c 2063 6f6e 6e65 6374 696f  global connectio
+00007290: 6e65 7272 6f72 0d0a 2020 2020 0d0a 2020  nerror..    ..  
+000072a0: 2020 6966 2028 6c65 6e28 686f 7374 293d    if (len(host)=
+000072b0: 3d30 206f 7220 6c65 6e28 7669 7065 7274  =0 or len(vipert
+000072c0: 6f6b 656e 293d 3d30 206f 7220 706f 7274  oken)==0 or port
+000072d0: 3d3d 2d39 3939 206f 7220 6c65 6e28 636f  ==-999 or len(co
+000072e0: 6e73 756d 6566 726f 6d29 3d3d 3020 6f72  nsumefrom)==0 or
+000072f0: 206c 656e 2870 726f 6475 6365 746f 293d   len(produceto)=
+00007300: 3d30 206f 7220 6c65 6e28 636f 6d70 616e  =0 or len(compan
+00007310: 796e 616d 6529 3d3d 300d 0a20 2020 2020  yname)==0..     
+00007320: 2020 206f 7220 6c65 6e28 6870 6465 686f     or len(hpdeho
+00007330: 7374 293d 3d30 206f 7220 6870 6465 706f  st)==0 or hpdepo
+00007340: 7274 3d3d 2d39 3939 293a 0d0a 2020 2020  rt==-999):..    
+00007350: 2020 2020 2072 6574 7572 6e20 2250 6c65       return "Ple
+00007360: 6173 6520 656e 7465 7220 686f 7374 2c70  ase enter host,p
+00007370: 6f72 742c 7669 7065 7274 6f6b 656e 2c63  ort,vipertoken,c
+00007380: 6f6e 7375 6d65 6672 6f6d 2c70 726f 6475  onsumefrom,produ
+00007390: 6365 746f 2c63 6f6d 7061 6e79 6e61 6d65  ceto,companyname
+000073a0: 2c68 7064 6568 6f73 742c 6870 6465 706f  ,hpdehost,hpdepo
+000073b0: 7274 220d 0a20 2020 2020 2020 200d 0a20  rt"..        .. 
+000073c0: 2020 2076 616c 7565 3d28 2276 6970 6572     value=("viper
+000073d0: 6870 6465 6f70 7469 6d69 7a65 6261 7463  hpdeoptimizebatc
+000073e0: 683f 7669 7065 7274 6f6b 656e 3d22 2b76  h?vipertoken="+v
+000073f0: 6970 6572 746f 6b65 6e20 2b20 2226 636f  ipertoken + "&co
+00007400: 6e73 756d 6566 726f 6d3d 222b 636f 6e73  nsumefrom="+cons
+00007410: 756d 6566 726f 6d20 2b20 2226 7072 6f64  umefrom + "&prod
+00007420: 7563 6574 6f3d 2220 2b20 7072 6f64 7563  uceto=" + produc
+00007430: 6574 6f20 2b20 2226 636f 6e73 756d 6572  eto + "&consumer
+00007440: 6964 3d22 2b63 6f6e 7375 6d65 7269 6420  id="+consumerid 
+00007450: 2b0d 0a20 2020 2020 2020 2020 2226 6465  +..         "&de
+00007460: 6c61 793d 2220 2b20 7374 7228 6465 6c61  lay=" + str(dela
+00007470: 7929 202b 2022 2665 6e61 626c 6574 6c73  y) + "&enabletls
+00007480: 3d22 202b 2073 7472 2865 6e61 626c 6574  =" + str(enablet
+00007490: 6c73 2920 2b20 2226 7072 6f64 7563 6572  ls) + "&producer
+000074a0: 6964 3d22 2b70 726f 6475 6365 7269 6420  id="+producerid 
+000074b0: 2b20 2226 636f 6d70 616e 796e 616d 653d  + "&companyname=
+000074c0: 222b 636f 6d70 616e 796e 616d 6520 2b0d  "+companyname +.
+000074d0: 0a20 2020 2020 2020 2020 2226 7061 7274  .         "&part
+000074e0: 6974 696f 6e3d 222b 7374 7228 7061 7274  ition="+str(part
+000074f0: 6974 696f 6e29 2b22 266f 6666 7365 743d  ition)+"&offset=
+00007500: 222b 7374 7228 6f66 6673 6574 292b 2226  "+str(offset)+"&
+00007510: 6973 6d69 6e3d 222b 7374 7228 6973 6d69  ismin="+str(ismi
+00007520: 6e29 2b22 2663 6f6e 7374 7261 696e 7473  n)+"&constraints
+00007530: 3d22 2b63 6f6e 7374 7261 696e 7473 2b22  ="+constraints+"
+00007540: 2673 7472 6574 6368 626f 756e 6473 3d22  &stretchbounds="
+00007550: 2b73 7472 2873 7472 6574 6368 626f 756e  +str(stretchboun
+00007560: 6473 292b 0d0a 2020 2020 2020 2020 2022  ds)+..         "
+00007570: 2668 7064 6568 6f73 743d 2220 2b68 7064  &hpdehost=" +hpd
+00007580: 6568 6f73 7420 2b22 2668 7064 6570 6f72  ehost +"&hpdepor
+00007590: 743d 222b 7374 7228 6870 6465 706f 7274  t="+str(hpdeport
+000075a0: 2920 2b20 2226 7573 6564 6570 6c6f 793d  ) + "&usedeploy=
+000075b0: 2220 2b73 7472 2875 7365 6465 706c 6f79  " +str(usedeploy
+000075c0: 2920 2b20 2226 636f 6e73 7472 6169 6e74  ) + "&constraint
+000075d0: 7479 7065 3d22 202b 7374 7228 636f 6e73  type=" +str(cons
+000075e0: 7472 6169 6e74 7479 7065 2920 2b22 2665  trainttype) +"&e
+000075f0: 7073 696c 6f6e 3d22 202b 0d0a 2020 2020  psilon=" +..    
+00007600: 2020 2020 2020 2073 7472 2865 7073 696c         str(epsil
+00007610: 6f6e 2920 2b20 2226 746f 7069 6369 643d  on) + "&topicid=
+00007620: 2220 2b20 746f 7069 6369 6420 2b20 2226  " + topicid + "&
+00007630: 7469 6d65 6465 6c61 793d 2220 2b20 7374  timedelay=" + st
+00007640: 7228 7469 6d65 6465 6c61 7929 290d 0a0d  r(timedelay))...
+00007650: 0a20 2020 2076 616c 3d6c 6f6f 702e 7275  .    val=loop.ru
+00007660: 6e5f 756e 7469 6c5f 636f 6d70 6c65 7465  n_until_complete
+00007670: 2874 6370 5f65 6368 6f5f 636c 6965 6e74  (tcp_echo_client
+00007680: 7669 7065 7228 7661 6c75 652c 206c 6f6f  viper(value, loo
+00007690: 702c 686f 7374 2c70 6f72 742c 6d69 6372  p,host,port,micr
+000076a0: 6f73 6572 7669 6365 6964 2c61 7379 6e63  oserviceid,async
+000076b0: 7469 6d65 6f75 7429 290d 0a20 2020 2069  timeout))..    i
+000076c0: 6620 636f 6e6e 6563 7469 6f6e 6572 726f  f connectionerro
+000076d0: 723a 0d0a 2020 2020 2020 2020 2072 6574  r:..         ret
+000076e0: 7572 6e20 636f 6e6e 6563 7469 6f6e 6572  urn connectioner
+000076f0: 726f 720d 0a0d 0a20 2020 2072 6574 7572  ror....    retur
+00007700: 6e20 7661 6c0d 0a0d 0a64 6566 2076 6970  n val....def vip
+00007710: 6572 6870 6465 6f70 7469 6d69 7a65 2876  erhpdeoptimize(v
+00007720: 6970 6572 746f 6b65 6e2c 686f 7374 2c70  ipertoken,host,p
+00007730: 6f72 742c 636f 6e73 756d 6566 726f 6d2c  ort,consumefrom,
+00007740: 7072 6f64 7563 6574 6f2c 636f 6d70 616e  produceto,compan
+00007750: 796e 616d 652c 636f 6e73 756d 6572 6964  yname,consumerid
+00007760: 2c70 726f 6475 6365 7269 642c 6870 6465  ,producerid,hpde
+00007770: 686f 7374 2c70 6172 7469 7469 6f6e 3d2d  host,partition=-
+00007780: 312c 6f66 6673 6574 3d2d 312c 0d0a 2020  1,offset=-1,..  
+00007790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000077a0: 2020 2020 656e 6162 6c65 746c 733d 312c      enabletls=1,
+000077b0: 6465 6c61 793d 3130 3030 2c68 7064 6570  delay=1000,hpdep
+000077c0: 6f72 743d 2d39 3939 2c75 7365 6465 706c  ort=-999,usedepl
+000077d0: 6f79 3d30 2c0d 0a20 2020 2020 2020 2020  oy=0,..         
+000077e0: 2020 2020 2020 2020 2020 2020 2069 736d               ism
+000077f0: 696e 3d31 2c63 6f6e 7374 7261 696e 7473  in=1,constraints
+00007800: 3d27 6265 7374 272c 7374 7265 7463 6862  ='best',stretchb
+00007810: 6f75 6e64 733d 3230 2c63 6f6e 7374 7261  ounds=20,constra
+00007820: 696e 7474 7970 653d 312c 6570 7369 6c6f  inttype=1,epsilo
+00007830: 6e3d 3130 2c62 726f 6b65 7268 6f73 743d  n=10,brokerhost=
+00007840: 2727 2c62 726f 6b65 7270 6f72 743d 3930  '',brokerport=90
+00007850: 3932 2c0d 0a20 2020 2020 2020 2020 2020  92,..           
+00007860: 2020 2020 2020 2020 2020 2074 696d 656f             timeo
+00007870: 7574 3d31 3230 2c6d 6963 726f 7365 7276  ut=120,microserv
+00007880: 6963 6569 643d 2727 2c74 6f70 6963 6964  iceid='',topicid
+00007890: 3d2d 3939 3929 3a0d 0a0d 0a20 2020 2023  =-999):....    #
+000078a0: 7265 6164 7320 7468 6520 6669 656c 646e  reads the fieldn
+000078b0: 616d 6573 2061 6e64 2067 6574 7320 6c61  ames and gets la
+000078c0: 7465 7374 2064 6174 6120 6672 6f6d 2065  test data from e
+000078d0: 6163 6820 7374 7265 616d 2028 6f72 2066  ach stream (or f
+000078e0: 6965 6c64 6e61 6d65 290d 0a20 2020 2067  ieldname)..    g
+000078f0: 6c6f 6261 6c20 636f 6e6e 6563 7469 6f6e  lobal connection
+00007900: 6572 726f 720d 0a20 2020 200d 0a20 2020  error..    ..   
+00007910: 2069 6620 286c 656e 2868 6f73 7429 3d3d   if (len(host)==
+00007920: 3020 6f72 206c 656e 2876 6970 6572 746f  0 or len(viperto
+00007930: 6b65 6e29 3d3d 3020 6f72 2070 6f72 743d  ken)==0 or port=
+00007940: 3d2d 3939 3920 6f72 206c 656e 2863 6f6e  =-999 or len(con
+00007950: 7375 6d65 6672 6f6d 293d 3d30 206f 7220  sumefrom)==0 or 
+00007960: 6c65 6e28 7072 6f64 7563 6574 6f29 3d3d  len(produceto)==
+00007970: 3020 6f72 206c 656e 2863 6f6d 7061 6e79  0 or len(company
+00007980: 6e61 6d65 293d 3d30 0d0a 2020 2020 2020  name)==0..      
+00007990: 2020 6f72 206c 656e 2868 7064 6568 6f73    or len(hpdehos
+000079a0: 7429 3d3d 3020 6f72 2068 7064 6570 6f72  t)==0 or hpdepor
+000079b0: 743d 3d2d 3939 3929 3a0d 0a20 2020 2020  t==-999):..     
+000079c0: 2020 2020 7265 7475 726e 2022 506c 6561      return "Plea
+000079d0: 7365 2065 6e74 6572 2068 6f73 742c 706f  se enter host,po
+000079e0: 7274 2c76 6970 6572 746f 6b65 6e2c 636f  rt,vipertoken,co
+000079f0: 6e73 756d 6566 726f 6d2c 7072 6f64 7563  nsumefrom,produc
+00007a00: 6574 6f2c 636f 6d70 616e 796e 616d 652c  eto,companyname,
+00007a10: 6870 6465 686f 7374 2c68 7064 6570 6f72  hpdehost,hpdepor
+00007a20: 7422 0d0a 2020 2020 2020 2020 0d0a 2020  t"..        ..  
+00007a30: 2020 7661 6c75 653d 2822 7669 7065 7268    value=("viperh
+00007a40: 7064 656f 7074 696d 697a 653f 7669 7065  pdeoptimize?vipe
+00007a50: 7274 6f6b 656e 3d22 2b76 6970 6572 746f  rtoken="+viperto
+00007a60: 6b65 6e20 2b20 2226 636f 6e73 756d 6566  ken + "&consumef
+00007a70: 726f 6d3d 222b 636f 6e73 756d 6566 726f  rom="+consumefro
+00007a80: 6d20 2b20 2226 7072 6f64 7563 6574 6f3d  m + "&produceto=
+00007a90: 2220 2b20 7072 6f64 7563 6574 6f20 2b20  " + produceto + 
+00007aa0: 2226 636f 6e73 756d 6572 6964 3d22 2b63  "&consumerid="+c
+00007ab0: 6f6e 7375 6d65 7269 6420 2b0d 0a20 2020  onsumerid +..   
+00007ac0: 2020 2020 2020 2226 6465 6c61 793d 2220        "&delay=" 
+00007ad0: 2b20 7374 7228 6465 6c61 7929 202b 2022  + str(delay) + "
+00007ae0: 2665 6e61 626c 6574 6c73 3d22 202b 2073  &enabletls=" + s
+00007af0: 7472 2865 6e61 626c 6574 6c73 2920 2b20  tr(enabletls) + 
+00007b00: 2226 7072 6f64 7563 6572 6964 3d22 2b70  "&producerid="+p
+00007b10: 726f 6475 6365 7269 6420 2b20 2226 636f  roducerid + "&co
+00007b20: 6d70 616e 796e 616d 653d 222b 636f 6d70  mpanyname="+comp
+00007b30: 616e 796e 616d 6520 2b0d 0a20 2020 2020  anyname +..     
+00007b40: 2020 2020 2226 7061 7274 6974 696f 6e3d      "&partition=
+00007b50: 222b 7374 7228 7061 7274 6974 696f 6e29  "+str(partition)
+00007b60: 2b22 266f 6666 7365 743d 222b 7374 7228  +"&offset="+str(
+00007b70: 6f66 6673 6574 292b 2226 6973 6d69 6e3d  offset)+"&ismin=
+00007b80: 222b 7374 7228 6973 6d69 6e29 2b22 2663  "+str(ismin)+"&c
+00007b90: 6f6e 7374 7261 696e 7473 3d22 2b63 6f6e  onstraints="+con
+00007ba0: 7374 7261 696e 7473 2b22 2673 7472 6574  straints+"&stret
+00007bb0: 6368 626f 756e 6473 3d22 2b73 7472 2873  chbounds="+str(s
+00007bc0: 7472 6574 6368 626f 756e 6473 292b 0d0a  tretchbounds)+..
+00007bd0: 2020 2020 2020 2020 2022 2668 7064 6568           "&hpdeh
+00007be0: 6f73 743d 2220 2b68 7064 6568 6f73 7420  ost=" +hpdehost 
+00007bf0: 2b22 2668 7064 6570 6f72 743d 222b 7374  +"&hpdeport="+st
+00007c00: 7228 6870 6465 706f 7274 2920 2b20 2226  r(hpdeport) + "&
+00007c10: 7573 6564 6570 6c6f 793d 2220 2b73 7472  usedeploy=" +str
+00007c20: 2875 7365 6465 706c 6f79 2920 2b20 2226  (usedeploy) + "&
+00007c30: 636f 6e73 7472 6169 6e74 7479 7065 3d22  constrainttype="
+00007c40: 202b 7374 7228 636f 6e73 7472 6169 6e74   +str(constraint
+00007c50: 7479 7065 2920 2b22 2665 7073 696c 6f6e  type) +"&epsilon
+00007c60: 3d22 202b 7374 7228 6570 7369 6c6f 6e29  =" +str(epsilon)
+00007c70: 202b 2022 2674 6f70 6963 6964 3d22 202b   + "&topicid=" +
+00007c80: 2073 7472 2874 6f70 6963 6964 2920 290d   str(topicid) ).
+00007c90: 0a0d 0a20 2020 2076 616c 3d6c 6f6f 702e  ...    val=loop.
+00007ca0: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
+00007cb0: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
+00007cc0: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
+00007cd0: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
+00007ce0: 6372 6f73 6572 7669 6365 6964 2c74 696d  croserviceid,tim
+00007cf0: 656f 7574 2929 0d0a 2020 2020 6966 2063  eout))..    if c
+00007d00: 6f6e 6e65 6374 696f 6e65 7272 6f72 3a0d  onnectionerror:.
+00007d10: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
+00007d20: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
+00007d30: 0d0a 0d0a 2020 2020 7265 7475 726e 2076  ....    return v
+00007d40: 616c 0d0a 0d0a 6465 6620 7669 7065 7268  al....def viperh
+00007d50: 7064 6574 7261 696e 696e 6728 7669 7065  pdetraining(vipe
+00007d60: 7274 6f6b 656e 2c68 6f73 742c 706f 7274  rtoken,host,port
+00007d70: 2c63 6f6e 7375 6d65 6672 6f6d 2c70 726f  ,consumefrom,pro
+00007d80: 6475 6365 746f 2c63 6f6d 7061 6e79 6e61  duceto,companyna
+00007d90: 6d65 2c63 6f6e 7375 6d65 7269 642c 7072  me,consumerid,pr
+00007da0: 6f64 7563 6572 6964 2c68 7064 6568 6f73  oducerid,hpdehos
+00007db0: 742c 7669 7065 7263 6f6e 6669 6766 696c  t,viperconfigfil
+00007dc0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00007dd0: 2020 2020 2020 2020 2020 656e 6162 6c65            enable
+00007de0: 746c 733d 312c 7061 7274 6974 696f 6e3d  tls=1,partition=
+00007df0: 2d31 2c64 6570 6c6f 793d 302c 6d6f 6465  -1,deploy=0,mode
+00007e00: 6c72 756e 733d 3130 2c6d 6f64 656c 7365  lruns=10,modelse
+00007e10: 6172 6368 7475 6e65 723d 3830 2c68 7064  archtuner=80,hpd
+00007e20: 6570 6f72 743d 2d39 3939 2c6f 6666 7365  eport=-999,offse
+00007e30: 743d 2d31 2c69 736c 6f67 6973 7469 633d  t=-1,islogistic=
+00007e40: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
+00007e50: 2020 2020 2020 2020 2020 6272 6f6b 6572            broker
+00007e60: 686f 7374 3d27 272c 6272 6f6b 6572 706f  host='',brokerpo
+00007e70: 7274 3d39 3039 322c 7469 6d65 6f75 743d  rt=9092,timeout=
+00007e80: 3132 302c 6d69 6372 6f73 6572 7669 6365  120,microservice
+00007e90: 6964 3d27 272c 746f 7069 6369 643d 2d39  id='',topicid=-9
+00007ea0: 3939 2c6d 6169 6e74 6f70 6963 3d27 272c  99,maintopic='',
+00007eb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007ec0: 2020 2020 2020 2020 696e 6465 7065 6e64          independ
+00007ed0: 656e 7476 6172 6961 626c 6573 3d27 272c  entvariables='',
+00007ee0: 6465 7065 6e64 656e 7476 6172 6961 626c  dependentvariabl
+00007ef0: 653d 2727 2c72 6f6c 6c62 6163 6b6f 6666  e='',rollbackoff
+00007f00: 7365 7473 3d30 2c66 756c 6c70 6174 6874  sets=0,fullpatht
+00007f10: 6f74 7261 696e 696e 6764 6174 613d 2727  otrainingdata=''
+00007f20: 2c70 726f 6365 7373 6c6f 6769 633d 2727  ,processlogic=''
+00007f30: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00007f40: 2020 2020 2020 2020 2069 6465 6e74 6966           identif
+00007f50: 6965 723d 2727 2c61 7272 6179 3d30 2c74  ier='',array=0,t
+00007f60: 7261 6e73 666f 726d 7479 7065 3d27 272c  ransformtype='',
+00007f70: 7365 6e64 636f 6566 746f 3d27 272c 636f  sendcoefto='',co
+00007f80: 6566 746f 7072 6f63 6573 733d 2727 2c63  eftoprocess='',c
+00007f90: 6f65 6673 7562 746f 7069 636e 616d 6573  oefsubtopicnames
+00007fa0: 3d27 2729 3a0d 0a0d 0a20 2020 2023 7265  =''):....    #re
+00007fb0: 6164 7320 7468 6520 6669 656c 646e 616d  ads the fieldnam
+00007fc0: 6573 2061 6e64 2067 6574 7320 6c61 7465  es and gets late
+00007fd0: 7374 2064 6174 6120 6672 6f6d 2065 6163  st data from eac
+00007fe0: 6820 7374 7265 616d 2028 6f72 2066 6965  h stream (or fie
+00007ff0: 6c64 6e61 6d65 290d 0a20 2020 2067 6c6f  ldname)..    glo
+00008000: 6261 6c20 636f 6e6e 6563 7469 6f6e 6572  bal connectioner
+00008010: 726f 720d 0a20 2020 200d 0a20 2020 2069  ror..    ..    i
+00008020: 6620 286c 656e 2868 6f73 7429 3d3d 3020  f (len(host)==0 
+00008030: 6f72 206c 656e 2876 6970 6572 746f 6b65  or len(vipertoke
+00008040: 6e29 3d3d 3020 6f72 2070 6f72 743d 3d2d  n)==0 or port==-
+00008050: 3939 3920 206f 7220 6c65 6e28 7072 6f64  999  or len(prod
+00008060: 7563 6574 6f29 3d3d 3020 6f72 206c 656e  uceto)==0 or len
+00008070: 2863 6f6d 7061 6e79 6e61 6d65 293d 3d30  (companyname)==0
+00008080: 206f 720d 0a20 2020 2020 2020 206c 656e   or..        len
+00008090: 2868 7064 6568 6f73 7429 3d3d 3020 6f72  (hpdehost)==0 or
+000080a0: 2068 7064 6570 6f72 743d 3d2d 3939 3929   hpdeport==-999)
+000080b0: 3a0d 0a20 2020 2020 2020 2020 7265 7475  :..         retu
+000080c0: 726e 2022 506c 6561 7365 2065 6e74 6572  rn "Please enter
+000080d0: 2068 6f73 742c 706f 7274 2c76 6970 6572   host,port,viper
+000080e0: 746f 6b65 6e2c 636f 6e73 756d 6566 726f  token,consumefro
+000080f0: 6d2c 7072 6f64 7563 6574 6f2c 636f 6d70  m,produceto,comp
+00008100: 616e 796e 616d 652c 6870 6465 686f 7374  anyname,hpdehost
+00008110: 2c68 7064 6570 6f72 7422 0d0a 2020 2020  ,hpdeport"..    
+00008120: 6966 2028 6973 6c6f 6769 7374 6963 3d3d  if (islogistic==
+00008130: 3120 616e 6420 7072 6f63 6573 736c 6f67  1 and processlog
+00008140: 6963 3d3d 2727 293a 0d0a 2020 2020 2020  ic==''):..      
+00008150: 2020 2072 6574 7572 6e20 2253 696e 6365     return "Since
+00008160: 2079 6f75 2061 7265 2064 6f69 6e67 206c   you are doing l
+00008170: 6f67 6973 7469 632c 2070 6c65 6173 6520  ogistic, please 
+00008180: 656e 7465 7220 7072 6f63 6573 736c 6f67  enter processlog
+00008190: 6963 220d 0a20 2020 2020 2020 200d 0a20  ic"..        .. 
+000081a0: 2020 2076 616c 7565 3d28 2276 6970 6572     value=("viper
+000081b0: 6870 6465 7472 6169 6e69 6e67 3f76 6970  hpdetraining?vip
+000081c0: 6572 746f 6b65 6e3d 222b 7669 7065 7274  ertoken="+vipert
+000081d0: 6f6b 656e 202b 2022 2663 6f6e 7375 6d65  oken + "&consume
+000081e0: 6672 6f6d 3d22 2b63 6f6e 7375 6d65 6672  from="+consumefr
+000081f0: 6f6d 202b 2022 2670 726f 6475 6365 746f  om + "&produceto
+00008200: 3d22 202b 2070 726f 6475 6365 746f 202b  =" + produceto +
+00008210: 2022 2663 6f6e 7375 6d65 7269 643d 222b   "&consumerid="+
+00008220: 636f 6e73 756d 6572 6964 202b 0d0a 2020  consumerid +..  
+00008230: 2020 2020 2020 2020 2022 2670 726f 6475           "&produ
+00008240: 6365 7269 643d 222b 7072 6f64 7563 6572  cerid="+producer
+00008250: 6964 202b 2022 2663 6f6d 7061 6e79 6e61  id + "&companyna
+00008260: 6d65 3d22 2b63 6f6d 7061 6e79 6e61 6d65  me="+companyname
+00008270: 202b 2022 2670 6172 7469 7469 6f6e 3d22   + "&partition="
+00008280: 2b73 7472 2870 6172 7469 7469 6f6e 292b  +str(partition)+
+00008290: 2226 6d6f 6465 6c72 756e 733d 222b 7374  "&modelruns="+st
+000082a0: 7228 6d6f 6465 6c72 756e 7329 202b 2226  r(modelruns) +"&
+000082b0: 6870 6465 686f 7374 3d22 202b 6870 6465  hpdehost=" +hpde
+000082c0: 686f 7374 202b 0d0a 2020 2020 2020 2020  host +..        
+000082d0: 2020 2022 2668 7064 6570 6f72 743d 222b     "&hpdeport="+
+000082e0: 7374 7228 6870 6465 706f 7274 292b 2226  str(hpdeport)+"&
+000082f0: 6272 6f6b 6572 686f 7374 3d22 2b62 726f  brokerhost="+bro
+00008300: 6b65 7268 6f73 742b 2022 266d 6f64 656c  kerhost+ "&model
+00008310: 7365 6172 6368 7475 6e65 723d 222b 7374  searchtuner="+st
+00008320: 7228 6d6f 6465 6c73 6561 7263 6874 756e  r(modelsearchtun
+00008330: 6572 292b 2022 266f 6666 7365 743d 222b  er)+ "&offset="+
+00008340: 7374 7228 6f66 6673 6574 2920 2b20 2226  str(offset) + "&
+00008350: 7669 7065 7263 6f6e 6669 6766 696c 653d  viperconfigfile=
+00008360: 222b 7669 7065 7263 6f6e 6669 6766 696c  "+viperconfigfil
+00008370: 6520 2b0d 0a20 2020 2020 2020 2020 2020  e +..           
+00008380: 2226 6272 6f6b 6572 706f 7274 3d22 2b73  "&brokerport="+s
+00008390: 7472 2862 726f 6b65 7270 6f72 7429 2b22  tr(brokerport)+"
+000083a0: 2665 6e61 626c 6574 6c73 3d22 2b73 7472  &enabletls="+str
+000083b0: 2865 6e61 626c 6574 6c73 2920 2b22 2664  (enabletls) +"&d
+000083c0: 6570 6c6f 793d 222b 7374 7228 6465 706c  eploy="+str(depl
+000083d0: 6f79 2920 2b20 2226 6973 6c6f 6769 7374  oy) + "&islogist
+000083e0: 6963 3d22 202b 2073 7472 2869 736c 6f67  ic=" + str(islog
+000083f0: 6973 7469 6329 202b 0d0a 2020 2020 2020  istic) +..      
+00008400: 2020 2020 2022 2674 696d 656f 7574 3d22       "&timeout="
+00008410: 2b73 7472 2874 696d 656f 7574 2920 2b20  +str(timeout) + 
+00008420: 2226 746f 7069 6369 643d 2220 2b20 7374  "&topicid=" + st
+00008430: 7228 746f 7069 6369 6429 202b 2022 266d  r(topicid) + "&m
+00008440: 6169 6e74 6f70 6963 3d22 202b 206d 6169  aintopic=" + mai
+00008450: 6e74 6f70 6963 202b 2022 2669 6e64 6570  ntopic + "&indep
+00008460: 656e 6465 6e74 7661 7269 6162 6c65 733d  endentvariables=
+00008470: 2220 2b20 696e 6465 7065 6e64 656e 7476  " + independentv
+00008480: 6172 6961 626c 6573 202b 0d0a 2020 2020  ariables +..    
+00008490: 2020 2020 2020 2022 2664 6570 656e 6465         "&depende
+000084a0: 6e74 7661 7269 6162 6c65 3d22 202b 2064  ntvariable=" + d
+000084b0: 6570 656e 6465 6e74 7661 7269 6162 6c65  ependentvariable
+000084c0: 202b 2022 2672 6f6c 6c62 6163 6b6f 6666   + "&rollbackoff
+000084d0: 7365 7473 3d22 202b 2073 7472 2872 6f6c  sets=" + str(rol
+000084e0: 6c62 6163 6b6f 6666 7365 7473 292b 0d0a  lbackoffsets)+..
+000084f0: 2020 2020 2020 2020 2020 2022 2666 756c             "&ful
+00008500: 6c70 6174 6874 6f74 7261 696e 696e 6764  lpathtotrainingd
+00008510: 6174 613d 222b 6675 6c6c 7061 7468 746f  ata="+fullpathto
+00008520: 7472 6169 6e69 6e67 6461 7461 202b 2022  trainingdata + "
+00008530: 2670 726f 6365 7373 6c6f 6769 633d 2220  &processlogic=" 
+00008540: 2b20 7072 6f63 6573 736c 6f67 6963 2b20  + processlogic+ 
+00008550: 2226 6964 656e 7469 6669 6572 3d22 202b  "&identifier=" +
+00008560: 2069 6465 6e74 6966 6965 7220 2b0d 0a20   identifier +.. 
+00008570: 2020 2020 2020 2020 2020 2226 6172 7261            "&arra
+00008580: 793d 2220 2b20 7374 7228 6172 7261 7929  y=" + str(array)
+00008590: 202b 2022 2674 7261 6e73 666f 726d 7479   + "&transformty
+000085a0: 7065 3d22 202b 2074 7261 6e73 666f 726d  pe=" + transform
+000085b0: 7479 7065 202b 2022 2673 656e 6463 6f65  type + "&sendcoe
+000085c0: 6674 6f3d 2220 2b20 7365 6e64 636f 6566  fto=" + sendcoef
+000085d0: 746f 202b 2022 2663 6f65 6674 6f70 726f  to + "&coeftopro
+000085e0: 6365 7373 3d22 202b 2063 6f65 6674 6f70  cess=" + coeftop
+000085f0: 726f 6365 7373 202b 0d0a 2020 2020 2020  rocess +..      
+00008600: 2020 2020 2022 2663 6f65 6673 7562 746f       "&coefsubto
+00008610: 7069 636e 616d 6573 3d22 202b 2063 6f65  picnames=" + coe
+00008620: 6673 7562 746f 7069 636e 616d 6573 290d  fsubtopicnames).
+00008630: 0a0d 0a20 2020 2076 616c 3d6c 6f6f 702e  ...    val=loop.
+00008640: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
+00008650: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
+00008660: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
+00008670: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
+00008680: 6372 6f73 6572 7669 6365 6964 2c74 696d  croserviceid,tim
+00008690: 656f 7574 2929 0d0a 2020 2020 6966 2063  eout))..    if c
+000086a0: 6f6e 6e65 6374 696f 6e65 7272 6f72 3a0d  onnectionerror:.
+000086b0: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
+000086c0: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
+000086d0: 0d0a 0d0a 2020 2020 7265 7475 726e 2076  ....    return v
+000086e0: 616c 0d0a 0d0a 6465 6620 7669 7065 7268  al....def viperh
+000086f0: 7064 6574 7261 696e 696e 6762 6174 6368  pdetrainingbatch
+00008700: 2876 6970 6572 746f 6b65 6e2c 686f 7374  (vipertoken,host
+00008710: 2c70 6f72 742c 636f 6e73 756d 6566 726f  ,port,consumefro
+00008720: 6d2c 7072 6f64 7563 6574 6f2c 636f 6d70  m,produceto,comp
+00008730: 616e 796e 616d 652c 636f 6e73 756d 6572  anyname,consumer
+00008740: 6964 2c70 726f 6475 6365 7269 642c 6870  id,producerid,hp
+00008750: 6465 686f 7374 2c76 6970 6572 636f 6e66  dehost,viperconf
+00008760: 6967 6669 6c65 2c0d 0a20 2020 2020 2020  igfile,..       
+00008770: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00008780: 6e61 626c 6574 6c73 3d31 2c70 6172 7469  nabletls=1,parti
+00008790: 7469 6f6e 3d2d 312c 6465 706c 6f79 3d30  tion=-1,deploy=0
+000087a0: 2c6d 6f64 656c 7275 6e73 3d31 302c 6d6f  ,modelruns=10,mo
+000087b0: 6465 6c73 6561 7263 6874 756e 6572 3d38  delsearchtuner=8
+000087c0: 302c 6870 6465 706f 7274 3d2d 3939 392c  0,hpdeport=-999,
+000087d0: 6f66 6673 6574 3d2d 312c 6973 6c6f 6769  offset=-1,islogi
+000087e0: 7374 6963 3d30 2c0d 0a20 2020 2020 2020  stic=0,..       
+000087f0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00008800: 726f 6b65 7268 6f73 743d 2727 2c62 726f  rokerhost='',bro
+00008810: 6b65 7270 6f72 743d 3930 3932 2c74 696d  kerport=9092,tim
+00008820: 656f 7574 3d31 3230 2c6d 6963 726f 7365  eout=120,microse
+00008830: 7276 6963 6569 643d 2727 2c74 6f70 6963  rviceid='',topic
+00008840: 6964 3d22 2d39 3939 222c 6d61 696e 746f  id="-999",mainto
+00008850: 7069 633d 2727 2c0d 0a20 2020 2020 2020  pic='',..       
+00008860: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00008870: 6e64 6570 656e 6465 6e74 7661 7269 6162  ndependentvariab
+00008880: 6c65 733d 2727 2c64 6570 656e 6465 6e74  les='',dependent
+00008890: 7661 7269 6162 6c65 3d27 272c 726f 6c6c  variable='',roll
+000088a0: 6261 636b 6f66 6673 6574 733d 302c 6675  backoffsets=0,fu
+000088b0: 6c6c 7061 7468 746f 7472 6169 6e69 6e67  llpathtotraining
+000088c0: 6461 7461 3d27 272c 7072 6f63 6573 736c  data='',processl
+000088d0: 6f67 6963 3d27 272c 0d0a 2020 2020 2020  ogic='',..      
+000088e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000088f0: 6964 656e 7469 6669 6572 3d27 272c 6172  identifier='',ar
+00008900: 7261 793d 302c 7469 6d65 6465 6c61 793d  ray=0,timedelay=
+00008910: 302c 6173 796e 6374 696d 656f 7574 3d31  0,asynctimeout=1
+00008920: 3230 293a 0d0a 0d0a 2020 2020 2372 6561  20):....    #rea
+00008930: 6473 2074 6865 2066 6965 6c64 6e61 6d65  ds the fieldname
+00008940: 7320 616e 6420 6765 7473 206c 6174 6573  s and gets lates
+00008950: 7420 6461 7461 2066 726f 6d20 6561 6368  t data from each
+00008960: 2073 7472 6561 6d20 286f 7220 6669 656c   stream (or fiel
+00008970: 646e 616d 6529 0d0a 2020 2020 676c 6f62  dname)..    glob
+00008980: 616c 2063 6f6e 6e65 6374 696f 6e65 7272  al connectionerr
+00008990: 6f72 0d0a 2020 2020 0d0a 2020 2020 6966  or..    ..    if
+000089a0: 2028 6c65 6e28 686f 7374 293d 3d30 206f   (len(host)==0 o
+000089b0: 7220 6c65 6e28 7669 7065 7274 6f6b 656e  r len(vipertoken
+000089c0: 293d 3d30 206f 7220 706f 7274 3d3d 2d39  )==0 or port==-9
+000089d0: 3939 2020 6f72 206c 656e 2870 726f 6475  99  or len(produ
+000089e0: 6365 746f 293d 3d30 206f 7220 6c65 6e28  ceto)==0 or len(
+000089f0: 636f 6d70 616e 796e 616d 6529 3d3d 3020  companyname)==0 
+00008a00: 6f72 0d0a 2020 2020 2020 2020 6c65 6e28  or..        len(
+00008a10: 6870 6465 686f 7374 293d 3d30 206f 7220  hpdehost)==0 or 
+00008a20: 6870 6465 706f 7274 3d3d 2d39 3939 293a  hpdeport==-999):
+00008a30: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
+00008a40: 6e20 2250 6c65 6173 6520 656e 7465 7220  n "Please enter 
+00008a50: 686f 7374 2c70 6f72 742c 7669 7065 7274  host,port,vipert
+00008a60: 6f6b 656e 2c63 6f6e 7375 6d65 6672 6f6d  oken,consumefrom
+00008a70: 2c70 726f 6475 6365 746f 2c63 6f6d 7061  ,produceto,compa
+00008a80: 6e79 6e61 6d65 2c68 7064 6568 6f73 742c  nyname,hpdehost,
+00008a90: 6870 6465 706f 7274 220d 0a20 2020 2069  hpdeport"..    i
+00008aa0: 6620 2869 736c 6f67 6973 7469 633d 3d31  f (islogistic==1
+00008ab0: 2061 6e64 2070 726f 6365 7373 6c6f 6769   and processlogi
+00008ac0: 633d 3d27 2729 3a0d 0a20 2020 2020 2020  c==''):..       
+00008ad0: 2020 7265 7475 726e 2022 5369 6e63 6520    return "Since 
+00008ae0: 796f 7520 6172 6520 646f 696e 6720 6c6f  you are doing lo
+00008af0: 6769 7374 6963 2c20 706c 6561 7365 2065  gistic, please e
+00008b00: 6e74 6572 2070 726f 6365 7373 6c6f 6769  nter processlogi
+00008b10: 6322 0d0a 2020 2020 2020 2020 0d0a 2020  c"..        ..  
+00008b20: 2020 7661 6c75 653d 2822 7669 7065 7268    value=("viperh
+00008b30: 7064 6574 7261 696e 696e 6762 6174 6368  pdetrainingbatch
+00008b40: 3f76 6970 6572 746f 6b65 6e3d 222b 7669  ?vipertoken="+vi
+00008b50: 7065 7274 6f6b 656e 202b 2022 2663 6f6e  pertoken + "&con
+00008b60: 7375 6d65 6672 6f6d 3d22 2b63 6f6e 7375  sumefrom="+consu
+00008b70: 6d65 6672 6f6d 202b 2022 2670 726f 6475  mefrom + "&produ
+00008b80: 6365 746f 3d22 202b 2070 726f 6475 6365  ceto=" + produce
+00008b90: 746f 202b 2022 2663 6f6e 7375 6d65 7269  to + "&consumeri
+00008ba0: 643d 222b 636f 6e73 756d 6572 6964 202b  d="+consumerid +
+00008bb0: 0d0a 2020 2020 2020 2020 2020 2022 2670  ..           "&p
+00008bc0: 726f 6475 6365 7269 643d 222b 7072 6f64  roducerid="+prod
+00008bd0: 7563 6572 6964 202b 2022 2663 6f6d 7061  ucerid + "&compa
+00008be0: 6e79 6e61 6d65 3d22 2b63 6f6d 7061 6e79  nyname="+company
+00008bf0: 6e61 6d65 202b 2022 2670 6172 7469 7469  name + "&partiti
+00008c00: 6f6e 3d22 2b73 7472 2870 6172 7469 7469  on="+str(partiti
+00008c10: 6f6e 292b 2226 6d6f 6465 6c72 756e 733d  on)+"&modelruns=
+00008c20: 222b 7374 7228 6d6f 6465 6c72 756e 7329  "+str(modelruns)
+00008c30: 202b 2226 6870 6465 686f 7374 3d22 202b   +"&hpdehost=" +
+00008c40: 6870 6465 686f 7374 202b 0d0a 2020 2020  hpdehost +..    
+00008c50: 2020 2020 2020 2022 2668 7064 6570 6f72         "&hpdepor
+00008c60: 743d 222b 7374 7228 6870 6465 706f 7274  t="+str(hpdeport
+00008c70: 292b 2226 6272 6f6b 6572 686f 7374 3d22  )+"&brokerhost="
+00008c80: 2b62 726f 6b65 7268 6f73 742b 2022 266d  +brokerhost+ "&m
+00008c90: 6f64 656c 7365 6172 6368 7475 6e65 723d  odelsearchtuner=
+00008ca0: 222b 7374 7228 6d6f 6465 6c73 6561 7263  "+str(modelsearc
+00008cb0: 6874 756e 6572 292b 2022 266f 6666 7365  htuner)+ "&offse
+00008cc0: 743d 222b 7374 7228 6f66 6673 6574 2920  t="+str(offset) 
+00008cd0: 2b20 2226 7669 7065 7263 6f6e 6669 6766  + "&viperconfigf
+00008ce0: 696c 653d 222b 7669 7065 7263 6f6e 6669  ile="+viperconfi
+00008cf0: 6766 696c 6520 2b0d 0a20 2020 2020 2020  gfile +..       
+00008d00: 2020 2020 2226 6272 6f6b 6572 706f 7274      "&brokerport
+00008d10: 3d22 2b73 7472 2862 726f 6b65 7270 6f72  ="+str(brokerpor
+00008d20: 7429 2b22 2665 6e61 626c 6574 6c73 3d22  t)+"&enabletls="
+00008d30: 2b73 7472 2865 6e61 626c 6574 6c73 2920  +str(enabletls) 
+00008d40: 2b22 2664 6570 6c6f 793d 222b 7374 7228  +"&deploy="+str(
+00008d50: 6465 706c 6f79 2920 2b20 2226 6973 6c6f  deploy) + "&islo
+00008d60: 6769 7374 6963 3d22 202b 2073 7472 2869  gistic=" + str(i
+00008d70: 736c 6f67 6973 7469 6329 202b 0d0a 2020  slogistic) +..  
+00008d80: 2020 2020 2020 2020 2022 2674 696d 656f           "&timeo
+00008d90: 7574 3d22 2b73 7472 2874 696d 656f 7574  ut="+str(timeout
+00008da0: 2920 2b20 2226 746f 7069 6369 643d 2220  ) + "&topicid=" 
+00008db0: 2b20 746f 7069 6369 6420 2b20 2226 6d61  + topicid + "&ma
+00008dc0: 696e 746f 7069 633d 2220 2b20 6d61 696e  intopic=" + main
+00008dd0: 746f 7069 6320 2b20 2226 696e 6465 7065  topic + "&indepe
+00008de0: 6e64 656e 7476 6172 6961 626c 6573 3d22  ndentvariables="
+00008df0: 202b 2069 6e64 6570 656e 6465 6e74 7661   + independentva
+00008e00: 7269 6162 6c65 7320 2b0d 0a20 2020 2020  riables +..     
+00008e10: 2020 2020 2020 2226 6465 7065 6e64 656e        "&dependen
+00008e20: 7476 6172 6961 626c 653d 2220 2b20 6465  tvariable=" + de
+00008e30: 7065 6e64 656e 7476 6172 6961 626c 6520  pendentvariable 
+00008e40: 2b20 2226 726f 6c6c 6261 636b 6f66 6673  + "&rollbackoffs
+00008e50: 6574 733d 2220 2b20 7374 7228 726f 6c6c  ets=" + str(roll
+00008e60: 6261 636b 6f66 6673 6574 7329 2b0d 0a20  backoffsets)+.. 
+00008e70: 2020 2020 2020 2020 2020 2226 6675 6c6c            "&full
+00008e80: 7061 7468 746f 7472 6169 6e69 6e67 6461  pathtotrainingda
+00008e90: 7461 3d22 2b66 756c 6c70 6174 6874 6f74  ta="+fullpathtot
+00008ea0: 7261 696e 696e 6764 6174 6120 2b20 2226  rainingdata + "&
+00008eb0: 7072 6f63 6573 736c 6f67 6963 3d22 202b  processlogic=" +
+00008ec0: 2070 726f 6365 7373 6c6f 6769 632b 2022   processlogic+ "
+00008ed0: 2669 6465 6e74 6966 6965 723d 2220 2b20  &identifier=" + 
+00008ee0: 6964 656e 7469 6669 6572 202b 2022 2661  identifier + "&a
+00008ef0: 7272 6179 3d22 0d0a 2020 2020 2020 2020  rray="..        
+00008f00: 2020 202b 2073 7472 2861 7272 6179 292b     + str(array)+
+00008f10: 2022 2674 696d 6564 656c 6179 3d22 202b   "&timedelay=" +
+00008f20: 2073 7472 2874 696d 6564 656c 6179 2929   str(timedelay))
+00008f30: 0d0a 0d0a 2020 2020 7661 6c3d 6c6f 6f70  ....    val=loop
+00008f40: 2e72 756e 5f75 6e74 696c 5f63 6f6d 706c  .run_until_compl
+00008f50: 6574 6528 7463 705f 6563 686f 5f63 6c69  ete(tcp_echo_cli
+00008f60: 656e 7476 6970 6572 2876 616c 7565 2c20  entviper(value, 
+00008f70: 6c6f 6f70 2c68 6f73 742c 706f 7274 2c6d  loop,host,port,m
+00008f80: 6963 726f 7365 7276 6963 6569 642c 6173  icroserviceid,as
+00008f90: 796e 6374 696d 656f 7574 2929 0d0a 2020  ynctimeout))..  
+00008fa0: 2020 6966 2063 6f6e 6e65 6374 696f 6e65    if connectione
+00008fb0: 7272 6f72 3a0d 0a20 2020 2020 2020 2020  rror:..         
+00008fc0: 7265 7475 726e 2063 6f6e 6e65 6374 696f  return connectio
+00008fd0: 6e65 7272 6f72 0d0a 0d0a 2020 2020 7265  nerror....    re
+00008fe0: 7475 726e 2076 616c 0d0a 0d0a 6465 6620  turn val....def 
+00008ff0: 7669 7065 7261 6e6f 6d61 6c79 7472 6169  viperanomalytrai
+00009000: 6e62 6174 6368 2876 6970 6572 746f 6b65  nbatch(vipertoke
+00009010: 6e2c 686f 7374 2c70 6f72 742c 636f 6e73  n,host,port,cons
+00009020: 756d 6566 726f 6d2c 7072 6f64 7563 6574  umefrom,producet
+00009030: 6f2c 7072 6f64 7563 6570 6565 7267 726f  o,producepeergro
+00009040: 7570 746f 2c70 726f 6475 6365 7269 6470  upto,produceridp
+00009050: 6565 7267 726f 7570 2c63 6f6e 7375 6d65  eergroup,consume
+00009060: 7269 6470 726f 6475 6365 746f 2c0d 0a20  ridproduceto,.. 
+00009070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009080: 2020 2020 2073 7472 6561 6d73 746f 616e       streamstoan
+00009090: 616c 7973 652c 0d0a 2020 2020 2020 2020  alyse,..        
+000090a0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+000090b0: 6d70 616e 796e 616d 652c 636f 6e73 756d  mpanyname,consum
+000090c0: 6572 6964 2c70 726f 6475 6365 7269 642c  erid,producerid,
+000090d0: 666c 6167 732c 6870 6465 686f 7374 2c76  flags,hpdehost,v
+000090e0: 6970 6572 636f 6e66 6967 6669 6c65 2c0d  iperconfigfile,.
+000090f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009100: 2020 2020 2020 2065 6e61 626c 6574 6c73         enabletls
+00009110: 3d31 2c70 6172 7469 7469 6f6e 3d2d 312c  =1,partition=-1,
+00009120: 6870 6465 706f 7274 3d2d 3939 392c 746f  hpdeport=-999,to
+00009130: 7069 6369 643d 222d 3939 3922 2c6d 6169  picid="-999",mai
+00009140: 6e74 6f70 6963 3d27 272c 726f 6c6c 6261  ntopic='',rollba
+00009150: 636b 6f66 6673 6574 733d 302c 6675 6c6c  ckoffsets=0,full
+00009160: 7061 7468 746f 7472 6169 6e69 6e67 6461  pathtotrainingda
+00009170: 7461 3d27 272c 0d0a 2020 2020 2020 2020  ta='',..        
+00009180: 2020 2020 2020 2020 2020 2020 2020 6272                br
+00009190: 6f6b 6572 686f 7374 3d27 272c 6272 6f6b  okerhost='',brok
+000091a0: 6572 706f 7274 3d39 3039 322c 6465 6c61  erport=9092,dela
+000091b0: 793d 3130 3030 2c74 696d 656f 7574 3d31  y=1000,timeout=1
+000091c0: 3230 2c6d 6963 726f 7365 7276 6963 6569  20,microservicei
+000091d0: 643d 2727 2c74 696d 6564 656c 6179 3d30  d='',timedelay=0
+000091e0: 2c61 7379 6e63 7469 6d65 6f75 743d 3132  ,asynctimeout=12
+000091f0: 3029 3a0d 0a20 2020 2067 6c6f 6261 6c20  0):..    global 
+00009200: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
+00009210: 0a0d 0a20 2020 2023 7265 6164 7320 7468  ...    #reads th
+00009220: 6520 6669 656c 646e 616d 6573 2061 6e64  e fieldnames and
+00009230: 2067 6574 7320 6c61 7465 7374 2064 6174   gets latest dat
+00009240: 6120 6672 6f6d 2065 6163 6820 7374 7265  a from each stre
+00009250: 616d 2028 6f72 2066 6965 6c64 6e61 6d65  am (or fieldname
+00009260: 290d 0a20 2020 2069 6620 286c 656e 2868  )..    if (len(h
+00009270: 6f73 7429 3d3d 3020 6f72 206c 656e 2876  ost)==0 or len(v
+00009280: 6970 6572 746f 6b65 6e29 3d3d 3020 6f72  ipertoken)==0 or
+00009290: 2070 6f72 743d 3d2d 3939 3920 6f72 206c   port==-999 or l
+000092a0: 656e 2870 726f 6475 6365 746f 293d 3d30  en(produceto)==0
+000092b0: 206f 7220 6c65 6e28 636f 6d70 616e 796e   or len(companyn
+000092c0: 616d 6529 3d3d 300d 0a20 2020 2020 2020  ame)==0..       
+000092d0: 2020 2020 2020 2020 206f 7220 6c65 6e28           or len(
+000092e0: 6870 6465 686f 7374 293d 3d30 206f 7220  hpdehost)==0 or 
+000092f0: 6870 6465 706f 7274 3d3d 2d39 3939 206f  hpdeport==-999 o
+00009300: 7220 6c65 6e28 7374 7265 616d 7374 6f61  r len(streamstoa
+00009310: 6e61 6c79 7365 293d 3d30 206f 7220 6c65  nalyse)==0 or le
+00009320: 6e28 7072 6f64 7563 6570 6565 7267 726f  n(producepeergro
+00009330: 7570 746f 293d 3d30 0d0a 2020 2020 2020  upto)==0..      
+00009340: 2020 2020 2020 2020 2020 6f72 206c 656e            or len
+00009350: 2866 6c61 6773 293d 3d30 206f 7220 6c65  (flags)==0 or le
+00009360: 6e28 7669 7065 7263 6f6e 6669 6766 696c  n(viperconfigfil
+00009370: 6529 3d3d 3029 3a0d 0a20 2020 2020 2020  e)==0):..       
+00009380: 2020 7265 7475 726e 2022 506c 6561 7365    return "Please
+00009390: 2065 6e74 6572 2068 6f73 742c 706f 7274   enter host,port
+000093a0: 2c76 6970 6572 746f 6b65 6e2c 7072 6f64  ,vipertoken,prod
+000093b0: 7563 6574 6f2c 636f 6d70 616e 796e 616d  uceto,companynam
+000093c0: 652c 7374 7265 616d 7374 6f61 6e61 6c79  e,streamstoanaly
+000093d0: 7365 2c66 6c61 6773 2c70 726f 6475 6365  se,flags,produce
+000093e0: 7065 6572 6772 6f75 7074 6f2c 6870 6465  peergroupto,hpde
+000093f0: 686f 7374 2c68 7064 6570 6f72 7422 0d0a  host,hpdeport"..
+00009400: 2020 2020 0d0a 2020 2020 7661 6c75 653d      ..    value=
+00009410: 2822 7669 7065 7261 6e6f 6d61 6c79 7472  ("viperanomalytr
+00009420: 6169 6e62 6174 6368 3f76 6970 6572 746f  ainbatch?viperto
+00009430: 6b65 6e3d 222b 7669 7065 7274 6f6b 656e  ken="+vipertoken
+00009440: 202b 2022 2663 6f6e 7375 6d65 6672 6f6d   + "&consumefrom
+00009450: 3d22 2b63 6f6e 7375 6d65 6672 6f6d 202b  ="+consumefrom +
+00009460: 2022 2670 726f 6475 6365 746f 3d22 202b   "&produceto=" +
+00009470: 2070 726f 6475 6365 746f 202b 2022 2663   produceto + "&c
+00009480: 6f6e 7375 6d65 7269 643d 222b 636f 6e73  onsumerid="+cons
+00009490: 756d 6572 6964 202b 0d0a 2020 2020 2020  umerid +..      
+000094a0: 2020 2020 2022 2670 726f 6475 6365 7065       "&producepe
+000094b0: 6572 6772 6f75 7074 6f3d 2220 2b20 7072  ergroupto=" + pr
+000094c0: 6f64 7563 6570 6565 7267 726f 7570 746f  oducepeergroupto
+000094d0: 202b 2022 2670 726f 6475 6365 7269 6470   + "&produceridp
+000094e0: 6565 7267 726f 7570 3d22 202b 2070 726f  eergroup=" + pro
+000094f0: 6475 6365 7269 6470 6565 7267 726f 7570  duceridpeergroup
+00009500: 202b 2022 2663 6f6e 7375 6d65 7269 6470   + "&consumeridp
+00009510: 726f 6475 6365 746f 3d22 2b63 6f6e 7375  roduceto="+consu
+00009520: 6d65 7269 6470 726f 6475 6365 746f 202b  meridproduceto +
+00009530: 0d0a 2020 2020 2020 2020 2020 2022 2673  ..           "&s
+00009540: 7472 6561 6d73 746f 616e 616c 7973 653d  treamstoanalyse=
+00009550: 222b 7374 7265 616d 7374 6f61 6e61 6c79  "+streamstoanaly
+00009560: 7365 202b 2022 2666 6c61 6773 3d22 2b66  se + "&flags="+f
+00009570: 6c61 6773 202b 2022 2664 656c 6179 3d22  lags + "&delay="
+00009580: 202b 7374 7228 6465 6c61 7929 202b 2022   +str(delay) + "
+00009590: 2674 696d 656f 7574 3d22 202b 2073 7472  &timeout=" + str
+000095a0: 2874 696d 656f 7574 2920 2b0d 0a20 2020  (timeout) +..   
+000095b0: 2020 2020 2020 2020 2226 7072 6f64 7563          "&produc
+000095c0: 6572 6964 3d22 2b70 726f 6475 6365 7269  erid="+produceri
+000095d0: 6420 2b20 2226 636f 6d70 616e 796e 616d  d + "&companynam
+000095e0: 653d 222b 636f 6d70 616e 796e 616d 6520  e="+companyname 
+000095f0: 2b20 2226 7061 7274 6974 696f 6e3d 222b  + "&partition="+
+00009600: 7374 7228 7061 7274 6974 696f 6e29 202b  str(partition) +
+00009610: 2226 6870 6465 686f 7374 3d22 202b 6870  "&hpdehost=" +hp
+00009620: 6465 686f 7374 202b 0d0a 2020 2020 2020  dehost +..      
+00009630: 2020 2020 2022 2668 7064 6570 6f72 743d       "&hpdeport=
+00009640: 222b 7374 7228 6870 6465 706f 7274 292b  "+str(hpdeport)+
+00009650: 2226 6272 6f6b 6572 686f 7374 3d22 2b62  "&brokerhost="+b
+00009660: 726f 6b65 7268 6f73 7420 2b20 2226 7669  rokerhost + "&vi
+00009670: 7065 7263 6f6e 6669 6766 696c 653d 222b  perconfigfile="+
+00009680: 7669 7065 7263 6f6e 6669 6766 696c 6520  viperconfigfile 
+00009690: 2b0d 0a20 2020 2020 2020 2020 2020 2226  +..           "&
+000096a0: 6272 6f6b 6572 706f 7274 3d22 2b73 7472  brokerport="+str
+000096b0: 2862 726f 6b65 7270 6f72 7429 2b22 2665  (brokerport)+"&e
+000096c0: 6e61 626c 6574 6c73 3d22 2b73 7472 2865  nabletls="+str(e
+000096d0: 6e61 626c 6574 6c73 2920 2b22 2674 6f70  nabletls) +"&top
+000096e0: 6963 6964 3d22 202b 2074 6f70 6963 6964  icid=" + topicid
+000096f0: 202b 2022 266d 6169 6e74 6f70 6963 3d22   + "&maintopic="
+00009700: 202b 206d 6169 6e74 6f70 6963 202b 0d0a   + maintopic +..
+00009710: 2020 2020 2020 2020 2020 2022 2672 6f6c             "&rol
+00009720: 6c62 6163 6b6f 6666 7365 7473 3d22 202b  lbackoffsets=" +
+00009730: 2073 7472 2872 6f6c 6c62 6163 6b6f 6666   str(rollbackoff
+00009740: 7365 7473 2920 2b20 2226 6675 6c6c 7061  sets) + "&fullpa
+00009750: 7468 746f 7472 6169 6e69 6e67 6461 7461  thtotrainingdata
+00009760: 3d22 2b66 756c 6c70 6174 6874 6f74 7261  ="+fullpathtotra
+00009770: 696e 696e 6764 6174 612b 2022 2674 696d  iningdata+ "&tim
+00009780: 6564 656c 6179 3d22 202b 2073 7472 2874  edelay=" + str(t
+00009790: 696d 6564 656c 6179 2929 0d0a 0d0a 2020  imedelay))....  
+000097a0: 2020 7661 6c3d 6c6f 6f70 2e72 756e 5f75    val=loop.run_u
+000097b0: 6e74 696c 5f63 6f6d 706c 6574 6528 7463  ntil_complete(tc
+000097c0: 705f 6563 686f 5f63 6c69 656e 7476 6970  p_echo_clientvip
+000097d0: 6572 2876 616c 7565 2c20 6c6f 6f70 2c68  er(value, loop,h
+000097e0: 6f73 742c 706f 7274 2c6d 6963 726f 7365  ost,port,microse
+000097f0: 7276 6963 6569 642c 6173 796e 6374 696d  rviceid,asynctim
+00009800: 656f 7574 2929 0d0a 2020 2020 6966 2063  eout))..    if c
+00009810: 6f6e 6e65 6374 696f 6e65 7272 6f72 3a0d  onnectionerror:.
+00009820: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
+00009830: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
+00009840: 0d0a 0d0a 2020 2020 7265 7475 726e 2076  ....    return v
+00009850: 616c 0d0a 0d0a 6465 6620 7669 7065 7261  al....def vipera
+00009860: 6e6f 6d61 6c79 7472 6169 6e28 7669 7065  nomalytrain(vipe
+00009870: 7274 6f6b 656e 2c68 6f73 742c 706f 7274  rtoken,host,port
+00009880: 2c63 6f6e 7375 6d65 6672 6f6d 2c70 726f  ,consumefrom,pro
+00009890: 6475 6365 746f 2c70 726f 6475 6365 7065  duceto,producepe
+000098a0: 6572 6772 6f75 7074 6f2c 7072 6f64 7563  ergroupto,produc
+000098b0: 6572 6964 7065 6572 6772 6f75 702c 636f  eridpeergroup,co
+000098c0: 6e73 756d 6572 6964 7072 6f64 7563 6574  nsumeridproducet
+000098d0: 6f2c 0d0a 2020 2020 2020 2020 2020 2020  o,..            
+000098e0: 2020 2020 2020 2020 2020 7374 7265 616d            stream
+000098f0: 7374 6f61 6e61 6c79 7365 2c0d 0a20 2020  stoanalyse,..   
+00009900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009910: 2020 2063 6f6d 7061 6e79 6e61 6d65 2c63     companyname,c
+00009920: 6f6e 7375 6d65 7269 642c 7072 6f64 7563  onsumerid,produc
+00009930: 6572 6964 2c66 6c61 6773 2c68 7064 6568  erid,flags,hpdeh
+00009940: 6f73 742c 7669 7065 7263 6f6e 6669 6766  ost,viperconfigf
+00009950: 696c 652c 0d0a 2020 2020 2020 2020 2020  ile,..          
+00009960: 2020 2020 2020 2020 2020 2020 656e 6162              enab
+00009970: 6c65 746c 733d 312c 7061 7274 6974 696f  letls=1,partitio
+00009980: 6e3d 2d31 2c68 7064 6570 6f72 743d 2d39  n=-1,hpdeport=-9
+00009990: 3939 2c74 6f70 6963 6964 3d2d 3939 392c  99,topicid=-999,
+000099a0: 6d61 696e 746f 7069 633d 2727 2c72 6f6c  maintopic='',rol
+000099b0: 6c62 6163 6b6f 6666 7365 7473 3d30 2c66  lbackoffsets=0,f
+000099c0: 756c 6c70 6174 6874 6f74 7261 696e 696e  ullpathtotrainin
+000099d0: 6764 6174 613d 2727 2c0d 0a20 2020 2020  gdata='',..     
+000099e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000099f0: 2062 726f 6b65 7268 6f73 743d 2727 2c62   brokerhost='',b
+00009a00: 726f 6b65 7270 6f72 743d 3930 3932 2c64  rokerport=9092,d
+00009a10: 656c 6179 3d31 3030 302c 7469 6d65 6f75  elay=1000,timeou
+00009a20: 743d 3132 302c 6d69 6372 6f73 6572 7669  t=120,microservi
+00009a30: 6365 6964 3d27 2729 3a0d 0a20 2020 2067  ceid=''):..    g
+00009a40: 6c6f 6261 6c20 636f 6e6e 6563 7469 6f6e  lobal connection
+00009a50: 6572 726f 720d 0a0d 0a20 2020 2023 7265  error....    #re
+00009a60: 6164 7320 7468 6520 6669 656c 646e 616d  ads the fieldnam
+00009a70: 6573 2061 6e64 2067 6574 7320 6c61 7465  es and gets late
+00009a80: 7374 2064 6174 6120 6672 6f6d 2065 6163  st data from eac
+00009a90: 6820 7374 7265 616d 2028 6f72 2066 6965  h stream (or fie
+00009aa0: 6c64 6e61 6d65 290d 0a20 2020 2069 6620  ldname)..    if 
+00009ab0: 286c 656e 2868 6f73 7429 3d3d 3020 6f72  (len(host)==0 or
+00009ac0: 206c 656e 2876 6970 6572 746f 6b65 6e29   len(vipertoken)
+00009ad0: 3d3d 3020 6f72 2070 6f72 743d 3d2d 3939  ==0 or port==-99
+00009ae0: 3920 6f72 206c 656e 2870 726f 6475 6365  9 or len(produce
+00009af0: 746f 293d 3d30 206f 7220 6c65 6e28 636f  to)==0 or len(co
+00009b00: 6d70 616e 796e 616d 6529 3d3d 300d 0a20  mpanyname)==0.. 
+00009b10: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00009b20: 7220 6c65 6e28 6870 6465 686f 7374 293d  r len(hpdehost)=
+00009b30: 3d30 206f 7220 6870 6465 706f 7274 3d3d  =0 or hpdeport==
+00009b40: 2d39 3939 206f 7220 6c65 6e28 7374 7265  -999 or len(stre
+00009b50: 616d 7374 6f61 6e61 6c79 7365 293d 3d30  amstoanalyse)==0
+00009b60: 206f 7220 6c65 6e28 7072 6f64 7563 6570   or len(producep
+00009b70: 6565 7267 726f 7570 746f 293d 3d30 0d0a  eergroupto)==0..
+00009b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b90: 6f72 206c 656e 2866 6c61 6773 293d 3d30  or len(flags)==0
+00009ba0: 206f 7220 6c65 6e28 7669 7065 7263 6f6e   or len(vipercon
+00009bb0: 6669 6766 696c 6529 3d3d 3029 3a0d 0a20  figfile)==0):.. 
+00009bc0: 2020 2020 2020 2020 7265 7475 726e 2022          return "
+00009bd0: 506c 6561 7365 2065 6e74 6572 2068 6f73  Please enter hos
+00009be0: 742c 706f 7274 2c76 6970 6572 746f 6b65  t,port,vipertoke
+00009bf0: 6e2c 7072 6f64 7563 6574 6f2c 636f 6d70  n,produceto,comp
+00009c00: 616e 796e 616d 652c 7374 7265 616d 7374  anyname,streamst
+00009c10: 6f61 6e61 6c79 7365 2c66 6c61 6773 2c70  oanalyse,flags,p
+00009c20: 726f 6475 6365 7065 6572 6772 6f75 7074  roducepeergroupt
+00009c30: 6f2c 6870 6465 686f 7374 2c68 7064 6570  o,hpdehost,hpdep
+00009c40: 6f72 7422 0d0a 2020 2020 0d0a 2020 2020  ort"..    ..    
+00009c50: 7661 6c75 653d 2822 7669 7065 7261 6e6f  value=("viperano
+00009c60: 6d61 6c79 7472 6169 6e3f 7669 7065 7274  malytrain?vipert
+00009c70: 6f6b 656e 3d22 2b76 6970 6572 746f 6b65  oken="+vipertoke
+00009c80: 6e20 2b20 2226 636f 6e73 756d 6566 726f  n + "&consumefro
+00009c90: 6d3d 222b 636f 6e73 756d 6566 726f 6d20  m="+consumefrom 
+00009ca0: 2b20 2226 7072 6f64 7563 6574 6f3d 2220  + "&produceto=" 
+00009cb0: 2b20 7072 6f64 7563 6574 6f20 2b20 2226  + produceto + "&
+00009cc0: 636f 6e73 756d 6572 6964 3d22 2b63 6f6e  consumerid="+con
+00009cd0: 7375 6d65 7269 6420 2b0d 0a20 2020 2020  sumerid +..     
+00009ce0: 2020 2020 2020 2226 7072 6f64 7563 6570        "&producep
+00009cf0: 6565 7267 726f 7570 746f 3d22 202b 2070  eergroupto=" + p
+00009d00: 726f 6475 6365 7065 6572 6772 6f75 7074  roducepeergroupt
+00009d10: 6f20 2b20 2226 7072 6f64 7563 6572 6964  o + "&producerid
+00009d20: 7065 6572 6772 6f75 703d 2220 2b20 7072  peergroup=" + pr
+00009d30: 6f64 7563 6572 6964 7065 6572 6772 6f75  oduceridpeergrou
+00009d40: 7020 2b20 2226 636f 6e73 756d 6572 6964  p + "&consumerid
+00009d50: 7072 6f64 7563 6574 6f3d 222b 636f 6e73  produceto="+cons
+00009d60: 756d 6572 6964 7072 6f64 7563 6574 6f20  umeridproduceto 
+00009d70: 2b0d 0a20 2020 2020 2020 2020 2020 2226  +..           "&
+00009d80: 7374 7265 616d 7374 6f61 6e61 6c79 7365  streamstoanalyse
+00009d90: 3d22 2b73 7472 6561 6d73 746f 616e 616c  ="+streamstoanal
+00009da0: 7973 6520 2b20 2226 666c 6167 733d 222b  yse + "&flags="+
+00009db0: 666c 6167 7320 2b20 2226 6465 6c61 793d  flags + "&delay=
+00009dc0: 2220 2b73 7472 2864 656c 6179 2920 2b20  " +str(delay) + 
+00009dd0: 2226 7469 6d65 6f75 743d 2220 2b20 7374  "&timeout=" + st
+00009de0: 7228 7469 6d65 6f75 7429 202b 0d0a 2020  r(timeout) +..  
+00009df0: 2020 2020 2020 2020 2022 2670 726f 6475           "&produ
+00009e00: 6365 7269 643d 222b 7072 6f64 7563 6572  cerid="+producer
+00009e10: 6964 202b 2022 2663 6f6d 7061 6e79 6e61  id + "&companyna
+00009e20: 6d65 3d22 2b63 6f6d 7061 6e79 6e61 6d65  me="+companyname
+00009e30: 202b 2022 2670 6172 7469 7469 6f6e 3d22   + "&partition="
+00009e40: 2b73 7472 2870 6172 7469 7469 6f6e 2920  +str(partition) 
+00009e50: 2b22 2668 7064 6568 6f73 743d 2220 2b68  +"&hpdehost=" +h
+00009e60: 7064 6568 6f73 7420 2b0d 0a20 2020 2020  pdehost +..     
+00009e70: 2020 2020 2020 2226 6870 6465 706f 7274        "&hpdeport
+00009e80: 3d22 2b73 7472 2868 7064 6570 6f72 7429  ="+str(hpdeport)
+00009e90: 2b22 2662 726f 6b65 7268 6f73 743d 222b  +"&brokerhost="+
+00009ea0: 6272 6f6b 6572 686f 7374 202b 2022 2676  brokerhost + "&v
+00009eb0: 6970 6572 636f 6e66 6967 6669 6c65 3d22  iperconfigfile="
+00009ec0: 2b76 6970 6572 636f 6e66 6967 6669 6c65  +viperconfigfile
+00009ed0: 202b 0d0a 2020 2020 2020 2020 2020 2022   +..           "
+00009ee0: 2662 726f 6b65 7270 6f72 743d 222b 7374  &brokerport="+st
+00009ef0: 7228 6272 6f6b 6572 706f 7274 292b 2226  r(brokerport)+"&
+00009f00: 656e 6162 6c65 746c 733d 222b 7374 7228  enabletls="+str(
+00009f10: 656e 6162 6c65 746c 7329 202b 2226 746f  enabletls) +"&to
+00009f20: 7069 6369 643d 222b 7374 7228 746f 7069  picid="+str(topi
+00009f30: 6369 6429 202b 2022 266d 6169 6e74 6f70  cid) + "&maintop
+00009f40: 6963 3d22 202b 206d 6169 6e74 6f70 6963  ic=" + maintopic
+00009f50: 202b 0d0a 2020 2020 2020 2020 2020 2022   +..           "
+00009f60: 2672 6f6c 6c62 6163 6b6f 6666 7365 7473  &rollbackoffsets
+00009f70: 3d22 202b 2073 7472 2872 6f6c 6c62 6163  =" + str(rollbac
+00009f80: 6b6f 6666 7365 7473 2920 2b20 2226 6675  koffsets) + "&fu
+00009f90: 6c6c 7061 7468 746f 7472 6169 6e69 6e67  llpathtotraining
+00009fa0: 6461 7461 3d22 2b66 756c 6c70 6174 6874  data="+fullpatht
+00009fb0: 6f74 7261 696e 696e 6764 6174 6129 0d0a  otrainingdata)..
+00009fc0: 0d0a 2020 2020 7661 6c3d 6c6f 6f70 2e72  ..    val=loop.r
+00009fd0: 756e 5f75 6e74 696c 5f63 6f6d 706c 6574  un_until_complet
+00009fe0: 6528 7463 705f 6563 686f 5f63 6c69 656e  e(tcp_echo_clien
+00009ff0: 7476 6970 6572 2876 616c 7565 2c20 6c6f  tviper(value, lo
+0000a000: 6f70 2c68 6f73 742c 706f 7274 2c6d 6963  op,host,port,mic
+0000a010: 726f 7365 7276 6963 6569 642c 7469 6d65  roserviceid,time
+0000a020: 6f75 7429 290d 0a20 2020 2069 6620 636f  out))..    if co
+0000a030: 6e6e 6563 7469 6f6e 6572 726f 723a 0d0a  nnectionerror:..
+0000a040: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000a050: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
+0000a060: 0a0d 0a20 2020 2072 6574 7572 6e20 7661  ...    return va
+0000a070: 6c0d 0a0d 0a64 6566 2076 6970 6572 616e  l....def viperan
+0000a080: 6f6d 616c 7970 7265 6469 6374 6261 7463  omalypredictbatc
+0000a090: 6828 7669 7065 7274 6f6b 656e 2c68 6f73  h(vipertoken,hos
+0000a0a0: 742c 706f 7274 2c63 6f6e 7375 6d65 6672  t,port,consumefr
+0000a0b0: 6f6d 2c70 726f 6475 6365 746f 2c63 6f6e  om,produceto,con
+0000a0c0: 7375 6d65 696e 7075 7473 7472 6561 6d2c  sumeinputstream,
+0000a0d0: 7072 6f64 7563 6569 6e70 7574 7374 7265  produceinputstre
+0000a0e0: 616d 7465 7374 2c70 726f 6475 6365 7269  amtest,produceri
+0000a0f0: 6469 6e70 7574 7374 7265 616d 7465 7374  dinputstreamtest
+0000a100: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000a110: 2020 2020 2020 2020 2073 7472 6561 6d73           streams
+0000a120: 746f 616e 616c 7973 652c 636f 6e73 756d  toanalyse,consum
+0000a130: 6572 6964 696e 7075 7473 7472 6561 6d2c  eridinputstream,
+0000a140: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a150: 2020 2020 2020 2020 636f 6d70 616e 796e          companyn
+0000a160: 616d 652c 636f 6e73 756d 6572 6964 2c70  ame,consumerid,p
+0000a170: 726f 6475 6365 7269 642c 666c 6167 732c  roducerid,flags,
+0000a180: 6870 6465 686f 7374 2c76 6970 6572 636f  hpdehost,viperco
+0000a190: 6e66 6967 6669 6c65 2c0d 0a20 2020 2020  nfigfile,..     
+0000a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a1b0: 2065 6e61 626c 6574 6c73 3d31 2c70 6172   enabletls=1,par
+0000a1c0: 7469 7469 6f6e 3d2d 312c 6870 6465 706f  tition=-1,hpdepo
+0000a1d0: 7274 3d2d 3939 392c 746f 7069 6369 643d  rt=-999,topicid=
+0000a1e0: 222d 3939 3922 2c6d 6169 6e74 6f70 6963  "-999",maintopic
+0000a1f0: 3d27 272c 726f 6c6c 6261 636b 6f66 6673  ='',rollbackoffs
+0000a200: 6574 733d 302c 6675 6c6c 7061 7468 746f  ets=0,fullpathto
+0000a210: 7065 6572 6772 6f75 7064 6174 613d 2727  peergroupdata=''
+0000a220: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000a230: 2020 2020 2020 2020 2062 726f 6b65 7268           brokerh
+0000a240: 6f73 743d 2727 2c62 726f 6b65 7270 6f72  ost='',brokerpor
+0000a250: 743d 3930 3932 2c64 656c 6179 3d31 3030  t=9092,delay=100
+0000a260: 302c 7469 6d65 6f75 743d 3132 302c 6d69  0,timeout=120,mi
+0000a270: 6372 6f73 6572 7669 6365 6964 3d27 272c  croserviceid='',
+0000a280: 7469 6d65 6465 6c61 793d 302c 6173 796e  timedelay=0,asyn
+0000a290: 6374 696d 656f 7574 3d31 3230 293a 0d0a  ctimeout=120):..
+0000a2a0: 0d0a 2020 2020 2372 6561 6473 2074 6865  ..    #reads the
+0000a2b0: 2066 6965 6c64 6e61 6d65 7320 616e 6420   fieldnames and 
+0000a2c0: 6765 7473 206c 6174 6573 7420 6461 7461  gets latest data
+0000a2d0: 2066 726f 6d20 6561 6368 2073 7472 6561   from each strea
+0000a2e0: 6d20 286f 7220 6669 656c 646e 616d 6529  m (or fieldname)
+0000a2f0: 0d0a 2020 2020 676c 6f62 616c 2063 6f6e  ..    global con
+0000a300: 6e65 6374 696f 6e65 7272 6f72 0d0a 2020  nectionerror..  
+0000a310: 2020 0d0a 2020 2020 6966 2028 6c65 6e28    ..    if (len(
+0000a320: 686f 7374 293d 3d30 206f 7220 6c65 6e28  host)==0 or len(
+0000a330: 7669 7065 7274 6f6b 656e 293d 3d30 206f  vipertoken)==0 o
+0000a340: 7220 706f 7274 3d3d 2d39 3939 206f 7220  r port==-999 or 
+0000a350: 6c65 6e28 7072 6f64 7563 6574 6f29 3d3d  len(produceto)==
+0000a360: 3020 6f72 206c 656e 2863 6f6d 7061 6e79  0 or len(company
+0000a370: 6e61 6d65 293d 3d30 200d 0a20 2020 2020  name)==0 ..     
+0000a380: 2020 2020 2020 2020 2020 2020 6f72 206c              or l
+0000a390: 656e 2868 7064 6568 6f73 7429 3d3d 3020  en(hpdehost)==0 
+0000a3a0: 6f72 2068 7064 6570 6f72 743d 3d2d 3939  or hpdeport==-99
+0000a3b0: 3920 6f72 206c 656e 2873 7472 6561 6d73  9 or len(streams
+0000a3c0: 746f 616e 616c 7973 6529 3d3d 3020 0d0a  toanalyse)==0 ..
+0000a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3e0: 206f 7220 6c65 6e28 666c 6167 7329 3d3d   or len(flags)==
+0000a3f0: 3020 6f72 206c 656e 2876 6970 6572 636f  0 or len(viperco
+0000a400: 6e66 6967 6669 6c65 293d 3d30 293a 0d0a  nfigfile)==0):..
+0000a410: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000a420: 2250 6c65 6173 6520 656e 7465 7220 686f  "Please enter ho
+0000a430: 7374 2c70 6f72 742c 7669 7065 7274 6f6b  st,port,vipertok
+0000a440: 656e 2c70 726f 6475 6365 746f 2c63 6f6d  en,produceto,com
+0000a450: 7061 6e79 6e61 6d65 2c73 7472 6561 6d73  panyname,streams
+0000a460: 746f 616e 616c 7973 652c 666c 6167 732c  toanalyse,flags,
+0000a470: 636f 6e73 756d 6572 6964 2c68 7064 6568  consumerid,hpdeh
+0000a480: 6f73 742c 6870 6465 706f 7274 220d 0a20  ost,hpdeport".. 
+0000a490: 2020 2020 2020 200d 0a20 2020 2076 616c         ..    val
+0000a4a0: 7565 3d28 2276 6970 6572 616e 6f6d 616c  ue=("viperanomal
+0000a4b0: 7970 7265 6469 6374 6261 7463 683f 7669  ypredictbatch?vi
+0000a4c0: 7065 7274 6f6b 656e 3d22 2b76 6970 6572  pertoken="+viper
+0000a4d0: 746f 6b65 6e20 2b20 2226 636f 6e73 756d  token + "&consum
+0000a4e0: 6566 726f 6d3d 222b 636f 6e73 756d 6566  efrom="+consumef
+0000a4f0: 726f 6d20 2b20 2226 7072 6f64 7563 6574  rom + "&producet
+0000a500: 6f3d 2220 2b20 7072 6f64 7563 6574 6f20  o=" + produceto 
+0000a510: 2b20 2226 636f 6e73 756d 6572 6964 3d22  + "&consumerid="
+0000a520: 2b63 6f6e 7375 6d65 7269 6420 2b0d 0a20  +consumerid +.. 
+0000a530: 2020 2020 2020 2020 2020 2226 7072 6f64            "&prod
+0000a540: 7563 6569 6e70 7574 7374 7265 616d 7465  uceinputstreamte
+0000a550: 7374 3d22 2b70 726f 6475 6365 696e 7075  st="+produceinpu
+0000a560: 7473 7472 6561 6d74 6573 7420 2b20 2226  tstreamtest + "&
+0000a570: 7072 6f64 7563 6572 6964 696e 7075 7473  produceridinputs
+0000a580: 7472 6561 6d74 6573 743d 222b 7072 6f64  treamtest="+prod
+0000a590: 7563 6572 6964 696e 7075 7473 7472 6561  uceridinputstrea
+0000a5a0: 6d74 6573 7420 2b20 2226 636f 6e73 756d  mtest + "&consum
+0000a5b0: 6572 6964 696e 7075 7473 7472 6561 6d3d  eridinputstream=
+0000a5c0: 222b 636f 6e73 756d 6572 6964 696e 7075  "+consumeridinpu
+0000a5d0: 7473 7472 6561 6d2b 0d0a 2020 2020 2020  tstream+..      
+0000a5e0: 2020 2020 2022 2673 7472 6561 6d73 746f       "&streamsto
+0000a5f0: 616e 616c 7973 653d 222b 7374 7265 616d  analyse="+stream
+0000a600: 7374 6f61 6e61 6c79 7365 202b 2022 2666  stoanalyse + "&f
+0000a610: 6c61 6773 3d22 2b66 6c61 6773 202b 2022  lags="+flags + "
+0000a620: 2664 656c 6179 3d22 202b 7374 7228 6465  &delay=" +str(de
+0000a630: 6c61 7929 202b 2022 2674 696d 656f 7574  lay) + "&timeout
+0000a640: 3d22 202b 2073 7472 2874 696d 656f 7574  =" + str(timeout
+0000a650: 2920 2b0d 0a20 2020 2020 2020 2020 2020  ) +..           
+0000a660: 2226 7072 6f64 7563 6572 6964 3d22 2b70  "&producerid="+p
+0000a670: 726f 6475 6365 7269 6420 2b20 2226 636f  roducerid + "&co
+0000a680: 6d70 616e 796e 616d 653d 222b 636f 6d70  mpanyname="+comp
+0000a690: 616e 796e 616d 6520 2b20 2226 7061 7274  anyname + "&part
+0000a6a0: 6974 696f 6e3d 222b 7374 7228 7061 7274  ition="+str(part
+0000a6b0: 6974 696f 6e29 202b 2226 6870 6465 686f  ition) +"&hpdeho
+0000a6c0: 7374 3d22 202b 6870 6465 686f 7374 202b  st=" +hpdehost +
+0000a6d0: 0d0a 2020 2020 2020 2020 2020 2022 2668  ..           "&h
+0000a6e0: 7064 6570 6f72 743d 222b 7374 7228 6870  pdeport="+str(hp
+0000a6f0: 6465 706f 7274 292b 2226 6272 6f6b 6572  deport)+"&broker
+0000a700: 686f 7374 3d22 2b62 726f 6b65 7268 6f73  host="+brokerhos
+0000a710: 7420 2b20 2226 7669 7065 7263 6f6e 6669  t + "&viperconfi
+0000a720: 6766 696c 653d 222b 7669 7065 7263 6f6e  gfile="+vipercon
+0000a730: 6669 6766 696c 6520 2b20 2226 636f 6e73  figfile + "&cons
+0000a740: 756d 6569 6e70 7574 7374 7265 616d 3d22  umeinputstream="
+0000a750: 2b63 6f6e 7375 6d65 696e 7075 7473 7472  +consumeinputstr
+0000a760: 6561 6d2b 0d0a 2020 2020 2020 2020 2020  eam+..          
+0000a770: 2022 2662 726f 6b65 7270 6f72 743d 222b   "&brokerport="+
+0000a780: 7374 7228 6272 6f6b 6572 706f 7274 292b  str(brokerport)+
+0000a790: 2226 656e 6162 6c65 746c 733d 222b 7374  "&enabletls="+st
+0000a7a0: 7228 656e 6162 6c65 746c 7329 202b 2022  r(enabletls) + "
+0000a7b0: 2674 6f70 6963 6964 3d22 202b 2074 6f70  &topicid=" + top
+0000a7c0: 6963 6964 202b 2022 266d 6169 6e74 6f70  icid + "&maintop
+0000a7d0: 6963 3d22 202b 6d61 696e 746f 7069 630d  ic=" +maintopic.
+0000a7e0: 0a20 2020 2020 2020 2020 2020 2b20 2226  .           + "&
+0000a7f0: 726f 6c6c 6261 636b 6f66 6673 6574 733d  rollbackoffsets=
+0000a800: 2220 2b73 7472 2872 6f6c 6c62 6163 6b6f  " +str(rollbacko
+0000a810: 6666 7365 7473 292b 2022 2666 756c 6c70  ffsets)+ "&fullp
+0000a820: 6174 6874 6f70 6565 7267 726f 7570 6461  athtopeergroupda
+0000a830: 7461 3d22 2b66 756c 6c70 6174 6874 6f70  ta="+fullpathtop
+0000a840: 6565 7267 726f 7570 6461 7461 2b20 2226  eergroupdata+ "&
+0000a850: 7469 6d65 6465 6c61 793d 2220 2b20 7374  timedelay=" + st
+0000a860: 7228 7469 6d65 6465 6c61 7929 290d 0a0d  r(timedelay))...
+0000a870: 0a20 2020 2076 616c 3d6c 6f6f 702e 7275  .    val=loop.ru
+0000a880: 6e5f 756e 7469 6c5f 636f 6d70 6c65 7465  n_until_complete
+0000a890: 2874 6370 5f65 6368 6f5f 636c 6965 6e74  (tcp_echo_client
+0000a8a0: 7669 7065 7228 7661 6c75 652c 206c 6f6f  viper(value, loo
+0000a8b0: 702c 686f 7374 2c70 6f72 742c 6d69 6372  p,host,port,micr
+0000a8c0: 6f73 6572 7669 6365 6964 2c61 7379 6e63  oserviceid,async
+0000a8d0: 7469 6d65 6f75 7429 290d 0a20 2020 2069  timeout))..    i
+0000a8e0: 6620 636f 6e6e 6563 7469 6f6e 6572 726f  f connectionerro
+0000a8f0: 723a 0d0a 2020 2020 2020 2020 2072 6574  r:..         ret
+0000a900: 7572 6e20 636f 6e6e 6563 7469 6f6e 6572  urn connectioner
+0000a910: 726f 720d 0a0d 0a20 2020 2072 6574 7572  ror....    retur
+0000a920: 6e20 7661 6c0d 0a0d 0a0d 0a64 6566 2076  n val......def v
+0000a930: 6970 6572 616e 6f6d 616c 7970 7265 6469  iperanomalypredi
+0000a940: 6374 2876 6970 6572 746f 6b65 6e2c 686f  ct(vipertoken,ho
+0000a950: 7374 2c70 6f72 742c 636f 6e73 756d 6566  st,port,consumef
+0000a960: 726f 6d2c 7072 6f64 7563 6574 6f2c 636f  rom,produceto,co
+0000a970: 6e73 756d 6569 6e70 7574 7374 7265 616d  nsumeinputstream
+0000a980: 2c70 726f 6475 6365 696e 7075 7473 7472  ,produceinputstr
+0000a990: 6561 6d74 6573 742c 7072 6f64 7563 6572  eamtest,producer
+0000a9a0: 6964 696e 7075 7473 7472 6561 6d74 6573  idinputstreamtes
+0000a9b0: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
+0000a9c0: 2020 2020 2020 2020 2020 7374 7265 616d            stream
+0000a9d0: 7374 6f61 6e61 6c79 7365 2c63 6f6e 7375  stoanalyse,consu
+0000a9e0: 6d65 7269 6469 6e70 7574 7374 7265 616d  meridinputstream
+0000a9f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000aa00: 2020 2020 2020 2020 2063 6f6d 7061 6e79           company
+0000aa10: 6e61 6d65 2c63 6f6e 7375 6d65 7269 642c  name,consumerid,
+0000aa20: 7072 6f64 7563 6572 6964 2c66 6c61 6773  producerid,flags
+0000aa30: 2c68 7064 6568 6f73 742c 7669 7065 7263  ,hpdehost,viperc
+0000aa40: 6f6e 6669 6766 696c 652c 0d0a 2020 2020  onfigfile,..    
+0000aa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aa60: 2020 656e 6162 6c65 746c 733d 312c 7061    enabletls=1,pa
+0000aa70: 7274 6974 696f 6e3d 2d31 2c68 7064 6570  rtition=-1,hpdep
+0000aa80: 6f72 743d 2d39 3939 2c74 6f70 6963 6964  ort=-999,topicid
+0000aa90: 3d2d 3939 392c 6d61 696e 746f 7069 633d  =-999,maintopic=
+0000aaa0: 2727 2c72 6f6c 6c62 6163 6b6f 6666 7365  '',rollbackoffse
+0000aab0: 7473 3d30 2c66 756c 6c70 6174 6874 6f70  ts=0,fullpathtop
+0000aac0: 6565 7267 726f 7570 6461 7461 3d27 272c  eergroupdata='',
+0000aad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000aae0: 2020 2020 2020 2020 6272 6f6b 6572 686f          brokerho
+0000aaf0: 7374 3d27 272c 6272 6f6b 6572 706f 7274  st='',brokerport
+0000ab00: 3d39 3039 322c 6465 6c61 793d 3130 3030  =9092,delay=1000
+0000ab10: 2c74 696d 656f 7574 3d31 3230 2c6d 6963  ,timeout=120,mic
+0000ab20: 726f 7365 7276 6963 6569 643d 2727 293a  roserviceid=''):
+0000ab30: 0d0a 0d0a 2020 2020 2372 6561 6473 2074  ....    #reads t
+0000ab40: 6865 2066 6965 6c64 6e61 6d65 7320 616e  he fieldnames an
+0000ab50: 6420 6765 7473 206c 6174 6573 7420 6461  d gets latest da
+0000ab60: 7461 2066 726f 6d20 6561 6368 2073 7472  ta from each str
+0000ab70: 6561 6d20 286f 7220 6669 656c 646e 616d  eam (or fieldnam
+0000ab80: 6529 0d0a 2020 2020 676c 6f62 616c 2063  e)..    global c
+0000ab90: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
+0000aba0: 2020 2020 0d0a 2020 2020 6966 2028 6c65      ..    if (le
+0000abb0: 6e28 686f 7374 293d 3d30 206f 7220 6c65  n(host)==0 or le
+0000abc0: 6e28 7669 7065 7274 6f6b 656e 293d 3d30  n(vipertoken)==0
+0000abd0: 206f 7220 706f 7274 3d3d 2d39 3939 206f   or port==-999 o
+0000abe0: 7220 6c65 6e28 7072 6f64 7563 6574 6f29  r len(produceto)
+0000abf0: 3d3d 3020 6f72 206c 656e 2863 6f6d 7061  ==0 or len(compa
+0000ac00: 6e79 6e61 6d65 293d 3d30 200d 0a20 2020  nyname)==0 ..   
+0000ac10: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+0000ac20: 206c 656e 2868 7064 6568 6f73 7429 3d3d   len(hpdehost)==
+0000ac30: 3020 6f72 2068 7064 6570 6f72 743d 3d2d  0 or hpdeport==-
+0000ac40: 3939 3920 6f72 206c 656e 2873 7472 6561  999 or len(strea
+0000ac50: 6d73 746f 616e 616c 7973 6529 3d3d 3020  mstoanalyse)==0 
+0000ac60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000ac70: 2020 206f 7220 6c65 6e28 666c 6167 7329     or len(flags)
+0000ac80: 3d3d 3020 6f72 206c 656e 2876 6970 6572  ==0 or len(viper
+0000ac90: 636f 6e66 6967 6669 6c65 293d 3d30 293a  configfile)==0):
+0000aca0: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
+0000acb0: 6e20 2250 6c65 6173 6520 656e 7465 7220  n "Please enter 
+0000acc0: 686f 7374 2c70 6f72 742c 7669 7065 7274  host,port,vipert
+0000acd0: 6f6b 656e 2c70 726f 6475 6365 746f 2c63  oken,produceto,c
+0000ace0: 6f6d 7061 6e79 6e61 6d65 2c73 7472 6561  ompanyname,strea
+0000acf0: 6d73 746f 616e 616c 7973 652c 666c 6167  mstoanalyse,flag
+0000ad00: 732c 636f 6e73 756d 6572 6964 2c68 7064  s,consumerid,hpd
+0000ad10: 6568 6f73 742c 6870 6465 706f 7274 220d  ehost,hpdeport".
+0000ad20: 0a20 2020 2020 2020 200d 0a20 2020 2076  .        ..    v
+0000ad30: 616c 7565 3d28 2276 6970 6572 616e 6f6d  alue=("viperanom
+0000ad40: 616c 7970 7265 6469 6374 3f76 6970 6572  alypredict?viper
+0000ad50: 746f 6b65 6e3d 222b 7669 7065 7274 6f6b  token="+vipertok
+0000ad60: 656e 202b 2022 2663 6f6e 7375 6d65 6672  en + "&consumefr
+0000ad70: 6f6d 3d22 2b63 6f6e 7375 6d65 6672 6f6d  om="+consumefrom
+0000ad80: 202b 2022 2670 726f 6475 6365 746f 3d22   + "&produceto="
+0000ad90: 202b 2070 726f 6475 6365 746f 202b 2022   + produceto + "
+0000ada0: 2663 6f6e 7375 6d65 7269 643d 222b 636f  &consumerid="+co
+0000adb0: 6e73 756d 6572 6964 202b 0d0a 2020 2020  nsumerid +..    
+0000adc0: 2020 2020 2020 2022 2670 726f 6475 6365         "&produce
+0000add0: 696e 7075 7473 7472 6561 6d74 6573 743d  inputstreamtest=
+0000ade0: 222b 7072 6f64 7563 6569 6e70 7574 7374  "+produceinputst
+0000adf0: 7265 616d 7465 7374 202b 2022 2670 726f  reamtest + "&pro
+0000ae00: 6475 6365 7269 6469 6e70 7574 7374 7265  duceridinputstre
+0000ae10: 616d 7465 7374 3d22 2b70 726f 6475 6365  amtest="+produce
+0000ae20: 7269 6469 6e70 7574 7374 7265 616d 7465  ridinputstreamte
+0000ae30: 7374 202b 2022 2663 6f6e 7375 6d65 7269  st + "&consumeri
+0000ae40: 6469 6e70 7574 7374 7265 616d 3d22 2b63  dinputstream="+c
+0000ae50: 6f6e 7375 6d65 7269 6469 6e70 7574 7374  onsumeridinputst
+0000ae60: 7265 616d 2b0d 0a20 2020 2020 2020 2020  ream+..         
+0000ae70: 2020 2226 7374 7265 616d 7374 6f61 6e61    "&streamstoana
+0000ae80: 6c79 7365 3d22 2b73 7472 6561 6d73 746f  lyse="+streamsto
+0000ae90: 616e 616c 7973 6520 2b20 2226 666c 6167  analyse + "&flag
+0000aea0: 733d 222b 666c 6167 7320 2b20 2226 6465  s="+flags + "&de
+0000aeb0: 6c61 793d 2220 2b73 7472 2864 656c 6179  lay=" +str(delay
+0000aec0: 2920 2b20 2226 7469 6d65 6f75 743d 2220  ) + "&timeout=" 
+0000aed0: 2b20 7374 7228 7469 6d65 6f75 7429 202b  + str(timeout) +
+0000aee0: 0d0a 2020 2020 2020 2020 2020 2022 2670  ..           "&p
+0000aef0: 726f 6475 6365 7269 643d 222b 7072 6f64  roducerid="+prod
+0000af00: 7563 6572 6964 202b 2022 2663 6f6d 7061  ucerid + "&compa
+0000af10: 6e79 6e61 6d65 3d22 2b63 6f6d 7061 6e79  nyname="+company
+0000af20: 6e61 6d65 202b 2022 2670 6172 7469 7469  name + "&partiti
+0000af30: 6f6e 3d22 2b73 7472 2870 6172 7469 7469  on="+str(partiti
+0000af40: 6f6e 2920 2b22 2668 7064 6568 6f73 743d  on) +"&hpdehost=
+0000af50: 2220 2b68 7064 6568 6f73 7420 2b0d 0a20  " +hpdehost +.. 
+0000af60: 2020 2020 2020 2020 2020 2226 6870 6465            "&hpde
+0000af70: 706f 7274 3d22 2b73 7472 2868 7064 6570  port="+str(hpdep
+0000af80: 6f72 7429 2b22 2662 726f 6b65 7268 6f73  ort)+"&brokerhos
+0000af90: 743d 222b 6272 6f6b 6572 686f 7374 202b  t="+brokerhost +
+0000afa0: 2022 2676 6970 6572 636f 6e66 6967 6669   "&viperconfigfi
+0000afb0: 6c65 3d22 2b76 6970 6572 636f 6e66 6967  le="+viperconfig
+0000afc0: 6669 6c65 202b 2022 2663 6f6e 7375 6d65  file + "&consume
+0000afd0: 696e 7075 7473 7472 6561 6d3d 222b 636f  inputstream="+co
+0000afe0: 6e73 756d 6569 6e70 7574 7374 7265 616d  nsumeinputstream
+0000aff0: 2b0d 0a20 2020 2020 2020 2020 2020 2226  +..           "&
+0000b000: 6272 6f6b 6572 706f 7274 3d22 2b73 7472  brokerport="+str
+0000b010: 2862 726f 6b65 7270 6f72 7429 2b22 2665  (brokerport)+"&e
+0000b020: 6e61 626c 6574 6c73 3d22 2b73 7472 2865  nabletls="+str(e
+0000b030: 6e61 626c 6574 6c73 2920 2b20 2226 746f  nabletls) + "&to
+0000b040: 7069 6369 643d 2220 2b20 7374 7228 746f  picid=" + str(to
+0000b050: 7069 6369 6429 202b 2022 266d 6169 6e74  picid) + "&maint
+0000b060: 6f70 6963 3d22 202b 6d61 696e 746f 7069  opic=" +maintopi
+0000b070: 630d 0a20 2020 2020 2020 2020 2020 2b20  c..           + 
+0000b080: 2226 726f 6c6c 6261 636b 6f66 6673 6574  "&rollbackoffset
+0000b090: 733d 2220 2b73 7472 2872 6f6c 6c62 6163  s=" +str(rollbac
+0000b0a0: 6b6f 6666 7365 7473 292b 2022 2666 756c  koffsets)+ "&ful
+0000b0b0: 6c70 6174 6874 6f70 6565 7267 726f 7570  lpathtopeergroup
+0000b0c0: 6461 7461 3d22 2b66 756c 6c70 6174 6874  data="+fullpatht
+0000b0d0: 6f70 6565 7267 726f 7570 6461 7461 290d  opeergroupdata).
+0000b0e0: 0a0d 0a20 2020 2076 616c 3d6c 6f6f 702e  ...    val=loop.
+0000b0f0: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
+0000b100: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
+0000b110: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
+0000b120: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
+0000b130: 6372 6f73 6572 7669 6365 6964 2c74 696d  croserviceid,tim
+0000b140: 656f 7574 2929 0d0a 2020 2020 6966 2063  eout))..    if c
+0000b150: 6f6e 6e65 6374 696f 6e65 7272 6f72 3a0d  onnectionerror:.
+0000b160: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
+0000b170: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
+0000b180: 0d0a 0d0a 2020 2020 7265 7475 726e 2076  ....    return v
+0000b190: 616c 0d0a 0d0a 6465 6620 7669 7065 7270  al....def viperp
+0000b1a0: 726f 6475 6365 746f 746f 7069 6373 7472  roducetotopicstr
+0000b1b0: 6561 6d28 7669 7065 7274 6f6b 656e 2c68  eam(vipertoken,h
+0000b1c0: 6f73 742c 706f 7274 2c74 6f70 6963 2c70  ost,port,topic,p
+0000b1d0: 726f 6475 6365 7269 642c 6f66 6673 6574  roducerid,offset
+0000b1e0: 2c6d 6178 726f 7773 3d30 2c65 6e61 626c  ,maxrows=0,enabl
+0000b1f0: 6574 6c73 3d30 2c64 656c 6179 3d31 3030  etls=0,delay=100
+0000b200: 2c62 726f 6b65 7268 6f73 743d 2727 2c62  ,brokerhost='',b
+0000b210: 726f 6b65 7270 6f72 743d 2d39 3939 2c6d  rokerport=-999,m
+0000b220: 6963 726f 7365 7276 6963 6569 643d 2727  icroserviceid=''
+0000b230: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
 0000b240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b250: 2020 2020 2020 2020 2020 2074 6f70 6963             topic
-0000b260: 6964 3d2d 3939 392c 6d61 696e 7374 7265  id=-999,mainstre
-0000b270: 616d 746f 7069 633d 2727 2c73 7472 6561  amtopic='',strea
-0000b280: 6d73 746f 6a6f 696e 3d27 2729 3a0d 0a20  mstojoin=''):.. 
-0000b290: 2020 2067 6c6f 6261 6c20 636f 6e6e 6563     global connec
-0000b2a0: 7469 6f6e 6572 726f 720d 0a0d 0a20 2020  tionerror....   
-0000b2b0: 2069 6620 286c 656e 2868 6f73 7429 3d3d   if (len(host)==
-0000b2c0: 3020 6f72 206c 656e 2876 6970 6572 746f  0 or len(viperto
-0000b2d0: 6b65 6e29 3d3d 3020 6f72 2070 6f72 743d  ken)==0 or port=
-0000b2e0: 3d2d 3939 3920 6f72 206c 656e 2874 6f70  =-999 or len(top
-0000b2f0: 6963 293d 3d30 206f 7220 6c65 6e28 7072  ic)==0 or len(pr
-0000b300: 6f64 7563 6572 6964 293d 3d30 293a 0d0a  oducerid)==0):..
-0000b310: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000b320: 2250 6c65 6173 6520 656e 7465 7220 686f  "Please enter ho
-0000b330: 7374 2c70 6f72 742c 7669 7065 7274 6f6b  st,port,vipertok
-0000b340: 656e 2c74 6f70 6963 2c70 726f 6475 6365  en,topic,produce
-0000b350: 7269 6422 0d0a 2020 2020 2020 2020 0d0a  rid"..        ..
-0000b360: 2020 2020 7661 6c75 653d 2822 7072 6f64      value=("prod
-0000b370: 7563 6574 6f74 6f70 6963 7374 7265 616d  ucetotopicstream
-0000b380: 3f76 6970 6572 746f 6b65 6e3d 222b 7669  ?vipertoken="+vi
-0000b390: 7065 7274 6f6b 656e 202b 2022 2674 6f70  pertoken + "&top
-0000b3a0: 6963 6e61 6d65 3d22 2b74 6f70 6963 202b  icname="+topic +
-0000b3b0: 2022 2664 656c 6179 3d22 202b 2073 7472   "&delay=" + str
-0000b3c0: 2864 656c 6179 2920 2b20 2226 6d61 7872  (delay) + "&maxr
-0000b3d0: 6f77 733d 2220 2b73 7472 286d 6178 726f  ows=" +str(maxro
-0000b3e0: 7773 2920 2b0d 0a20 2020 2020 2020 2020  ws) +..         
-0000b3f0: 2020 2226 656e 6162 6c65 746c 733d 222b    "&enabletls="+
-0000b400: 7374 7228 656e 6162 6c65 746c 7329 202b  str(enabletls) +
-0000b410: 2226 6272 6f6b 6572 686f 7374 3d22 2b62  "&brokerhost="+b
-0000b420: 726f 6b65 7268 6f73 7420 2b20 2226 6272  rokerhost + "&br
-0000b430: 6f6b 6572 706f 7274 3d22 2b73 7472 2862  okerport="+str(b
-0000b440: 726f 6b65 7270 6f72 7429 202b 2022 2670  rokerport) + "&p
-0000b450: 726f 6475 6365 7269 643d 222b 7072 6f64  roducerid="+prod
-0000b460: 7563 6572 6964 202b 0d0a 2020 2020 2020  ucerid +..      
-0000b470: 2020 2020 2022 266f 6666 7365 743d 222b       "&offset="+
-0000b480: 7374 7228 6f66 6673 6574 2920 2b20 2226  str(offset) + "&
-0000b490: 746f 7069 6369 643d 2220 2b20 7374 7228  topicid=" + str(
-0000b4a0: 746f 7069 6369 6429 202b 2022 266d 6169  topicid) + "&mai
-0000b4b0: 6e73 7472 6561 6d74 6f70 6963 3d22 2b6d  nstreamtopic="+m
-0000b4c0: 6169 6e73 7472 6561 6d74 6f70 6963 202b  ainstreamtopic +
-0000b4d0: 2022 2673 7472 6561 6d73 746f 6a6f 696e   "&streamstojoin
-0000b4e0: 3d22 2b73 7472 6561 6d73 746f 6a6f 696e  ="+streamstojoin
-0000b4f0: 290d 0a0d 0a20 2020 2076 616c 3d6c 6f6f  )....    val=loo
-0000b500: 702e 7275 6e5f 756e 7469 6c5f 636f 6d70  p.run_until_comp
-0000b510: 6c65 7465 2874 6370 5f65 6368 6f5f 636c  lete(tcp_echo_cl
-0000b520: 6965 6e74 7669 7065 7228 7661 6c75 652c  ientviper(value,
-0000b530: 206c 6f6f 702c 686f 7374 2c70 6f72 742c   loop,host,port,
-0000b540: 6d69 6372 6f73 6572 7669 6365 6964 2929  microserviceid))
-0000b550: 0d0a 2020 2020 6966 2063 6f6e 6e65 6374  ..    if connect
-0000b560: 696f 6e65 7272 6f72 3a0d 0a20 2020 2020  ionerror:..     
-0000b570: 2020 2020 7265 7475 726e 2063 6f6e 6e65      return conne
-0000b580: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
-0000b590: 2020 7265 7475 726e 2076 616c 0d0a 0d0a    return val....
-0000b5a0: 2020 2020 0d0a 6465 6620 7669 7065 7270      ..def viperp
-0000b5b0: 7265 7072 6f63 6573 7370 726f 6475 6365  reprocessproduce
-0000b5c0: 746f 746f 7069 6373 7472 6561 6d28 7669  totopicstream(vi
-0000b5d0: 7065 7274 6f6b 656e 2c68 6f73 742c 706f  pertoken,host,po
-0000b5e0: 7274 2c74 6f70 6963 2c70 726f 6475 6365  rt,topic,produce
-0000b5f0: 7269 642c 6f66 6673 6574 2c6d 6178 726f  rid,offset,maxro
-0000b600: 7773 3d30 2c65 6e61 626c 6574 6c73 3d30  ws=0,enabletls=0
-0000b610: 2c64 656c 6179 3d31 3030 2c62 726f 6b65  ,delay=100,broke
-0000b620: 7268 6f73 743d 2727 2c62 726f 6b65 7270  rhost='',brokerp
-0000b630: 6f72 743d 2d39 3939 2c6d 6963 726f 7365  ort=-999,microse
-0000b640: 7276 6963 6569 643d 2727 2c0d 0a20 2020  rviceid='',..   
+0000b250: 2074 6f70 6963 6964 3d2d 3939 392c 6d61   topicid=-999,ma
+0000b260: 696e 7374 7265 616d 746f 7069 633d 2727  instreamtopic=''
+0000b270: 2c73 7472 6561 6d73 746f 6a6f 696e 3d27  ,streamstojoin='
+0000b280: 2729 3a0d 0a20 2020 2067 6c6f 6261 6c20  '):..    global 
+0000b290: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
+0000b2a0: 0a0d 0a20 2020 2069 6620 286c 656e 2868  ...    if (len(h
+0000b2b0: 6f73 7429 3d3d 3020 6f72 206c 656e 2876  ost)==0 or len(v
+0000b2c0: 6970 6572 746f 6b65 6e29 3d3d 3020 6f72  ipertoken)==0 or
+0000b2d0: 2070 6f72 743d 3d2d 3939 3920 6f72 206c   port==-999 or l
+0000b2e0: 656e 2874 6f70 6963 293d 3d30 206f 7220  en(topic)==0 or 
+0000b2f0: 6c65 6e28 7072 6f64 7563 6572 6964 293d  len(producerid)=
+0000b300: 3d30 293a 0d0a 2020 2020 2020 2020 2072  =0):..         r
+0000b310: 6574 7572 6e20 2250 6c65 6173 6520 656e  eturn "Please en
+0000b320: 7465 7220 686f 7374 2c70 6f72 742c 7669  ter host,port,vi
+0000b330: 7065 7274 6f6b 656e 2c74 6f70 6963 2c70  pertoken,topic,p
+0000b340: 726f 6475 6365 7269 6422 0d0a 2020 2020  roducerid"..    
+0000b350: 2020 2020 0d0a 2020 2020 7661 6c75 653d      ..    value=
+0000b360: 2822 7072 6f64 7563 6574 6f74 6f70 6963  ("producetotopic
+0000b370: 7374 7265 616d 3f76 6970 6572 746f 6b65  stream?vipertoke
+0000b380: 6e3d 222b 7669 7065 7274 6f6b 656e 202b  n="+vipertoken +
+0000b390: 2022 2674 6f70 6963 6e61 6d65 3d22 2b74   "&topicname="+t
+0000b3a0: 6f70 6963 202b 2022 2664 656c 6179 3d22  opic + "&delay="
+0000b3b0: 202b 2073 7472 2864 656c 6179 2920 2b20   + str(delay) + 
+0000b3c0: 2226 6d61 7872 6f77 733d 2220 2b73 7472  "&maxrows=" +str
+0000b3d0: 286d 6178 726f 7773 2920 2b0d 0a20 2020  (maxrows) +..   
+0000b3e0: 2020 2020 2020 2020 2226 656e 6162 6c65          "&enable
+0000b3f0: 746c 733d 222b 7374 7228 656e 6162 6c65  tls="+str(enable
+0000b400: 746c 7329 202b 2226 6272 6f6b 6572 686f  tls) +"&brokerho
+0000b410: 7374 3d22 2b62 726f 6b65 7268 6f73 7420  st="+brokerhost 
+0000b420: 2b20 2226 6272 6f6b 6572 706f 7274 3d22  + "&brokerport="
+0000b430: 2b73 7472 2862 726f 6b65 7270 6f72 7429  +str(brokerport)
+0000b440: 202b 2022 2670 726f 6475 6365 7269 643d   + "&producerid=
+0000b450: 222b 7072 6f64 7563 6572 6964 202b 0d0a  "+producerid +..
+0000b460: 2020 2020 2020 2020 2020 2022 266f 6666             "&off
+0000b470: 7365 743d 222b 7374 7228 6f66 6673 6574  set="+str(offset
+0000b480: 2920 2b20 2226 746f 7069 6369 643d 2220  ) + "&topicid=" 
+0000b490: 2b20 7374 7228 746f 7069 6369 6429 202b  + str(topicid) +
+0000b4a0: 2022 266d 6169 6e73 7472 6561 6d74 6f70   "&mainstreamtop
+0000b4b0: 6963 3d22 2b6d 6169 6e73 7472 6561 6d74  ic="+mainstreamt
+0000b4c0: 6f70 6963 202b 2022 2673 7472 6561 6d73  opic + "&streams
+0000b4d0: 746f 6a6f 696e 3d22 2b73 7472 6561 6d73  tojoin="+streams
+0000b4e0: 746f 6a6f 696e 290d 0a0d 0a20 2020 2076  tojoin)....    v
+0000b4f0: 616c 3d6c 6f6f 702e 7275 6e5f 756e 7469  al=loop.run_unti
+0000b500: 6c5f 636f 6d70 6c65 7465 2874 6370 5f65  l_complete(tcp_e
+0000b510: 6368 6f5f 636c 6965 6e74 7669 7065 7228  cho_clientviper(
+0000b520: 7661 6c75 652c 206c 6f6f 702c 686f 7374  value, loop,host
+0000b530: 2c70 6f72 742c 6d69 6372 6f73 6572 7669  ,port,microservi
+0000b540: 6365 6964 2929 0d0a 2020 2020 6966 2063  ceid))..    if c
+0000b550: 6f6e 6e65 6374 696f 6e65 7272 6f72 3a0d  onnectionerror:.
+0000b560: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
+0000b570: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
+0000b580: 0d0a 0d0a 2020 2020 7265 7475 726e 2076  ....    return v
+0000b590: 616c 0d0a 0d0a 2020 2020 0d0a 6465 6620  al....    ..def 
+0000b5a0: 7669 7065 7270 7265 7072 6f63 6573 7370  viperpreprocessp
+0000b5b0: 726f 6475 6365 746f 746f 7069 6373 7472  roducetotopicstr
+0000b5c0: 6561 6d28 7669 7065 7274 6f6b 656e 2c68  eam(vipertoken,h
+0000b5d0: 6f73 742c 706f 7274 2c74 6f70 6963 2c70  ost,port,topic,p
+0000b5e0: 726f 6475 6365 7269 642c 6f66 6673 6574  roducerid,offset
+0000b5f0: 2c6d 6178 726f 7773 3d30 2c65 6e61 626c  ,maxrows=0,enabl
+0000b600: 6574 6c73 3d30 2c64 656c 6179 3d31 3030  etls=0,delay=100
+0000b610: 2c62 726f 6b65 7268 6f73 743d 2727 2c62  ,brokerhost='',b
+0000b620: 726f 6b65 7270 6f72 743d 2d39 3939 2c6d  rokerport=-999,m
+0000b630: 6963 726f 7365 7276 6963 6569 643d 2727  icroserviceid=''
+0000b640: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
 0000b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b660: 2020 2020 2020 2020 2020 2074 6f70 6963             topic
-0000b670: 6964 3d2d 3939 392c 7374 7265 616d 7374  id=-999,streamst
-0000b680: 6f6a 6f69 6e3d 2727 2c70 7265 7072 6f63  ojoin='',preproc
-0000b690: 6573 736c 6f67 6963 3d27 272c 7072 6570  esslogic='',prep
-0000b6a0: 726f 6365 7373 636f 6e64 6974 696f 6e73  rocessconditions
-0000b6b0: 3d27 272c 6964 656e 7469 6669 6572 3d27  ='',identifier='
-0000b6c0: 272c 7072 6570 726f 6365 7373 746f 7069  ',preprocesstopi
-0000b6d0: 633d 2727 2c61 7272 6179 3d30 2c73 6176  c='',array=0,sav
-0000b6e0: 6561 7361 7272 6179 3d30 2c72 6177 6461  easarray=0,rawda
-0000b6f0: 7461 6f75 7470 7574 3d30 293a 0d0a 2020  taoutput=0):..  
-0000b700: 2020 676c 6f62 616c 2063 6f6e 6e65 6374    global connect
-0000b710: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
-0000b720: 6966 2028 6c65 6e28 686f 7374 293d 3d30  if (len(host)==0
-0000b730: 206f 7220 6c65 6e28 7669 7065 7274 6f6b   or len(vipertok
-0000b740: 656e 293d 3d30 206f 7220 706f 7274 3d3d  en)==0 or port==
-0000b750: 2d39 3939 206f 7220 6c65 6e28 746f 7069  -999 or len(topi
-0000b760: 6329 3d3d 3020 6f72 206c 656e 2870 726f  c)==0 or len(pro
-0000b770: 6475 6365 7269 6429 3d3d 3020 6f72 206c  ducerid)==0 or l
-0000b780: 656e 2870 7265 7072 6f63 6573 736c 6f67  en(preprocesslog
-0000b790: 6963 293d 3d30 293a 0d0a 2020 2020 2020  ic)==0):..      
-0000b7a0: 2020 2072 6574 7572 6e20 2250 6c65 6173     return "Pleas
-0000b7b0: 6520 656e 7465 7220 686f 7374 2c70 6f72  e enter host,por
-0000b7c0: 742c 7669 7065 7274 6f6b 656e 2c74 6f70  t,vipertoken,top
-0000b7d0: 6963 2c70 726f 6475 6365 7269 642c 7072  ic,producerid,pr
-0000b7e0: 6570 726f 6365 7373 6c6f 6769 6322 0d0a  eprocesslogic"..
-0000b7f0: 2020 2020 2020 2020 0d0a 2020 2020 7661          ..    va
-0000b800: 6c75 653d 2822 7072 6570 726f 6365 7373  lue=("preprocess
-0000b810: 7072 6f64 7563 6574 6f74 6f70 6963 7374  producetotopicst
-0000b820: 7265 616d 3f76 6970 6572 746f 6b65 6e3d  ream?vipertoken=
-0000b830: 222b 7669 7065 7274 6f6b 656e 202b 2022  "+vipertoken + "
-0000b840: 2674 6f70 6963 6e61 6d65 3d22 2b74 6f70  &topicname="+top
-0000b850: 6963 202b 2022 2664 656c 6179 3d22 202b  ic + "&delay=" +
-0000b860: 2073 7472 2864 656c 6179 2920 2b20 2226   str(delay) + "&
-0000b870: 6d61 7872 6f77 733d 2220 2b73 7472 286d  maxrows=" +str(m
-0000b880: 6178 726f 7773 2920 2b0d 0a20 2020 2020  axrows) +..     
-0000b890: 2020 2020 2020 2226 656e 6162 6c65 746c        "&enabletl
-0000b8a0: 733d 222b 7374 7228 656e 6162 6c65 746c  s="+str(enabletl
-0000b8b0: 7329 202b 2226 6272 6f6b 6572 686f 7374  s) +"&brokerhost
-0000b8c0: 3d22 2b62 726f 6b65 7268 6f73 7420 2b20  ="+brokerhost + 
-0000b8d0: 2226 6272 6f6b 6572 706f 7274 3d22 2b73  "&brokerport="+s
-0000b8e0: 7472 2862 726f 6b65 7270 6f72 7429 202b  tr(brokerport) +
-0000b8f0: 2022 2670 726f 6475 6365 7269 643d 222b   "&producerid="+
-0000b900: 7072 6f64 7563 6572 6964 202b 0d0a 2020  producerid +..  
-0000b910: 2020 2020 2020 2020 2022 266f 6666 7365           "&offse
-0000b920: 743d 222b 7374 7228 6f66 6673 6574 2920  t="+str(offset) 
-0000b930: 2b20 2226 746f 7069 6369 643d 2220 2b20  + "&topicid=" + 
-0000b940: 7374 7228 746f 7069 6369 6429 202b 2022  str(topicid) + "
-0000b950: 2673 7472 6561 6d73 746f 6a6f 696e 3d22  &streamstojoin="
-0000b960: 2b73 7472 6561 6d73 746f 6a6f 696e 0d0a  +streamstojoin..
-0000b970: 2020 2020 2020 2020 2020 202b 2022 2670             + "&p
-0000b980: 7265 7072 6f63 6573 736c 6f67 6963 3d22  reprocesslogic="
-0000b990: 2b70 7265 7072 6f63 6573 736c 6f67 6963  +preprocesslogic
-0000b9a0: 202b 2022 2670 7265 7072 6f63 6573 7363   + "&preprocessc
-0000b9b0: 6f6e 6469 7469 6f6e 733d 2220 2b20 7072  onditions=" + pr
-0000b9c0: 6570 726f 6365 7373 636f 6e64 6974 696f  eprocessconditio
-0000b9d0: 6e73 0d0a 2020 2020 2020 2020 2020 202b  ns..           +
-0000b9e0: 2022 2669 6465 6e74 6966 6965 723d 2220   "&identifier=" 
-0000b9f0: 2b20 6964 656e 7469 6669 6572 202b 2022  + identifier + "
-0000ba00: 2670 7265 7072 6f63 6573 7374 6f70 6963  &preprocesstopic
-0000ba10: 3d22 202b 2070 7265 7072 6f63 6573 7374  =" + preprocesst
-0000ba20: 6f70 6963 202b 2022 2661 7272 6179 3d22  opic + "&array="
-0000ba30: 202b 2073 7472 2861 7272 6179 292b 0d0a   + str(array)+..
-0000ba40: 2020 2020 2020 2020 2020 2022 2673 6176             "&sav
-0000ba50: 6561 7361 7272 6179 3d22 202b 2073 7472  easarray=" + str
-0000ba60: 2873 6176 6561 7361 7272 6179 2920 2b20  (saveasarray) + 
-0000ba70: 2226 7261 7764 6174 616f 7574 7075 743d  "&rawdataoutput=
-0000ba80: 2220 2b20 7374 7228 7261 7764 6174 616f  " + str(rawdatao
-0000ba90: 7574 7075 7429 2029 0d0a 0d0a 2020 2020  utput) )....    
-0000baa0: 7661 6c3d 6c6f 6f70 2e72 756e 5f75 6e74  val=loop.run_unt
-0000bab0: 696c 5f63 6f6d 706c 6574 6528 7463 705f  il_complete(tcp_
-0000bac0: 6563 686f 5f63 6c69 656e 7476 6970 6572  echo_clientviper
-0000bad0: 2876 616c 7565 2c20 6c6f 6f70 2c68 6f73  (value, loop,hos
-0000bae0: 742c 706f 7274 2c6d 6963 726f 7365 7276  t,port,microserv
-0000baf0: 6963 6569 6429 290d 0a0d 0a20 2020 2069  iceid))....    i
-0000bb00: 6620 636f 6e6e 6563 7469 6f6e 6572 726f  f connectionerro
-0000bb10: 723a 0d0a 2020 2020 2020 2020 2072 6574  r:..         ret
-0000bb20: 7572 6e20 636f 6e6e 6563 7469 6f6e 6572  urn connectioner
-0000bb30: 726f 720d 0a0d 0a20 2020 2072 6574 7572  ror....    retur
-0000bb40: 6e20 7661 6c0d 0a0d 0a20 2020 2020 2020  n val....       
-0000bb50: 200d 0a64 6566 2076 6970 6572 7365 6172   ..def vipersear
-0000bb60: 6368 616e 6f6d 616c 7928 7669 7065 7274  chanomaly(vipert
-0000bb70: 6f6b 656e 2c68 6f73 742c 706f 7274 2c74  oken,host,port,t
-0000bb80: 6f70 6963 2c70 726f 6475 6365 7269 642c  opic,producerid,
-0000bb90: 6f66 6673 6574 2c6a 736f 6e63 7269 7465  offset,jsoncrite
-0000bba0: 7269 613d 2727 2c72 6177 6461 7461 6f75  ria='',rawdataou
-0000bbb0: 7470 7574 3d30 2c6d 6178 726f 7773 3d30  tput=0,maxrows=0
-0000bbc0: 2c65 6e61 626c 6574 6c73 3d30 2c64 656c  ,enabletls=0,del
-0000bbd0: 6179 3d31 3030 2c0d 0a20 2020 2020 2020  ay=100,..       
-0000bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bbf0: 6272 6f6b 6572 686f 7374 3d27 272c 6272  brokerhost='',br
-0000bc00: 6f6b 6572 706f 7274 3d2d 3939 392c 6d69  okerport=-999,mi
-0000bc10: 6372 6f73 6572 7669 6365 6964 3d27 272c  croserviceid='',
-0000bc20: 746f 7069 6369 643d 2d39 3939 2c69 6465  topicid=-999,ide
-0000bc30: 6e74 6966 6965 723d 2727 2c70 7265 7072  ntifier='',prepr
-0000bc40: 6f63 6573 7374 6f70 6963 3d27 272c 0d0a  ocesstopic='',..
-0000bc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bc60: 2020 2020 2020 2074 696d 6564 656c 6179         timedelay
-0000bc70: 3d30 2c61 7379 6e63 7469 6d65 6f75 743d  =0,asynctimeout=
-0000bc80: 3132 302c 7365 6172 6368 7465 726d 733d  120,searchterms=
-0000bc90: 2727 2c65 6e74 6974 7973 6561 7263 683d  '',entitysearch=
-0000bca0: 2727 2c74 6167 7365 6172 6368 3d27 272c  '',tagsearch='',
-0000bcb0: 6368 6563 6b61 6e6f 6d61 6c79 3d31 2c74  checkanomaly=1,t
-0000bcc0: 6573 7474 6f70 6963 3d27 272c 0d0a 2020  esttopic='',..  
-0000bcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bce0: 2020 2020 2069 6e63 6c75 6465 6578 636c       includeexcl
-0000bcf0: 7564 653d 312c 616e 6f6d 616c 7974 6872  ude=1,anomalythr
-0000bd00: 6573 686f 6c64 3d30 2c73 656e 6461 6e6f  eshold=0,sendano
-0000bd10: 6d61 6c79 616c 6572 7465 6d61 696c 3d27  malyalertemail='
-0000bd20: 272c 656d 6169 6c66 7265 7175 656e 6379  ',emailfrequency
-0000bd30: 3d33 3630 3029 3a0d 0a20 2020 2067 6c6f  =3600):..    glo
-0000bd40: 6261 6c20 636f 6e6e 6563 7469 6f6e 6572  bal connectioner
-0000bd50: 726f 720d 0a0d 0a20 2020 2069 6620 286c  ror....    if (l
-0000bd60: 656e 2868 6f73 7429 3d3d 3020 6f72 206c  en(host)==0 or l
-0000bd70: 656e 2876 6970 6572 746f 6b65 6e29 3d3d  en(vipertoken)==
-0000bd80: 3020 6f72 2070 6f72 743d 3d2d 3939 3920  0 or port==-999 
-0000bd90: 6f72 206c 656e 2874 6f70 6963 293d 3d30  or len(topic)==0
-0000bda0: 206f 7220 6c65 6e28 6a73 6f6e 6372 6974   or len(jsoncrit
-0000bdb0: 6572 6961 293d 3d30 206f 7220 6c65 6e28  eria)==0 or len(
-0000bdc0: 7072 6f64 7563 6572 6964 293d 3d30 293a  producerid)==0):
-0000bdd0: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
-0000bde0: 6e20 2250 6c65 6173 6520 656e 7465 7220  n "Please enter 
-0000bdf0: 686f 7374 2c70 6f72 742c 7669 7065 7274  host,port,vipert
-0000be00: 6f6b 656e 2c74 6f70 6963 2c70 726f 6475  oken,topic,produ
-0000be10: 6365 7269 642c 206a 736f 6e63 7269 7465  cerid, jsoncrite
-0000be20: 7269 6122 0d0a 2020 2020 2020 2020 2020  ria"..          
-0000be30: 2020 0d0a 2020 2020 7661 6c75 653d 2822    ..    value=("
-0000be40: 6e6c 7073 6561 7263 6861 6e6f 6d61 6c79  nlpsearchanomaly
-0000be50: 3f76 6970 6572 746f 6b65 6e3d 222b 7669  ?vipertoken="+vi
-0000be60: 7065 7274 6f6b 656e 202b 2022 2674 6f70  pertoken + "&top
-0000be70: 6963 6e61 6d65 3d22 2b74 6f70 6963 202b  icname="+topic +
-0000be80: 2022 2664 656c 6179 3d22 202b 2073 7472   "&delay=" + str
-0000be90: 2864 656c 6179 2920 2b20 2226 6d61 7872  (delay) + "&maxr
-0000bea0: 6f77 733d 2220 2b73 7472 286d 6178 726f  ows=" +str(maxro
-0000beb0: 7773 2920 2b0d 0a20 2020 2020 2020 2020  ws) +..         
-0000bec0: 2020 2226 656e 6162 6c65 746c 733d 222b    "&enabletls="+
-0000bed0: 7374 7228 656e 6162 6c65 746c 7329 202b  str(enabletls) +
-0000bee0: 2226 6272 6f6b 6572 686f 7374 3d22 2b62  "&brokerhost="+b
-0000bef0: 726f 6b65 7268 6f73 7420 2b20 2226 6272  rokerhost + "&br
-0000bf00: 6f6b 6572 706f 7274 3d22 2b73 7472 2862  okerport="+str(b
-0000bf10: 726f 6b65 7270 6f72 7429 202b 2022 2670  rokerport) + "&p
-0000bf20: 726f 6475 6365 7269 643d 222b 7072 6f64  roducerid="+prod
-0000bf30: 7563 6572 6964 202b 0d0a 2020 2020 2020  ucerid +..      
-0000bf40: 2020 2020 2022 266f 6666 7365 743d 222b       "&offset="+
-0000bf50: 7374 7228 6f66 6673 6574 2920 2b20 2226  str(offset) + "&
-0000bf60: 746f 7069 6369 643d 2220 2b20 7374 7228  topicid=" + str(
-0000bf70: 746f 7069 6369 6429 202b 2022 2670 7265  topicid) + "&pre
-0000bf80: 7072 6f63 6573 7374 6f70 6963 3d22 202b  processtopic=" +
-0000bf90: 2070 7265 7072 6f63 6573 7374 6f70 6963   preprocesstopic
-0000bfa0: 202b 2022 2674 696d 6564 656c 6179 3d22   + "&timedelay="
-0000bfb0: 202b 2073 7472 2874 696d 6564 656c 6179   + str(timedelay
-0000bfc0: 2920 2b20 2226 6a73 6f6e 6372 6974 6572  ) + "&jsoncriter
-0000bfd0: 6961 3d22 202b 206a 736f 6e63 7269 7465  ia=" + jsoncrite
-0000bfe0: 7269 610d 0a20 2020 2020 2020 2020 2020  ria..           
-0000bff0: 2b20 2226 7261 7764 6174 616f 7574 7075  + "&rawdataoutpu
-0000c000: 743d 2220 2b20 7374 7228 7261 7764 6174  t=" + str(rawdat
-0000c010: 616f 7574 7075 7429 202b 2022 2673 6561  aoutput) + "&sea
-0000c020: 7263 6874 6572 6d73 3d22 202b 2073 6561  rchterms=" + sea
-0000c030: 7263 6874 6572 6d73 202b 2022 2665 6e74  rchterms + "&ent
-0000c040: 6974 7973 6561 7263 683d 2220 2b20 656e  itysearch=" + en
-0000c050: 7469 7479 7365 6172 6368 0d0a 2020 2020  titysearch..    
-0000c060: 2020 2020 2020 202b 2022 2674 6167 7365         + "&tagse
-0000c070: 6172 6368 3d22 202b 2074 6167 7365 6172  arch=" + tagsear
-0000c080: 6368 202b 2022 2663 6865 636b 616e 6f6d  ch + "&checkanom
-0000c090: 616c 793d 2220 2b20 7374 7228 6368 6563  aly=" + str(chec
-0000c0a0: 6b61 6e6f 6d61 6c79 2920 2b20 2226 7465  kanomaly) + "&te
-0000c0b0: 7374 746f 7069 633d 2220 2b20 7465 7374  sttopic=" + test
-0000c0c0: 746f 7069 630d 0a20 2020 2020 2020 2020  topic..         
-0000c0d0: 2020 2b20 2226 696e 636c 7564 6565 7863    + "&includeexc
-0000c0e0: 6c75 6465 3d22 202b 2073 7472 2869 6e63  lude=" + str(inc
-0000c0f0: 6c75 6465 6578 636c 7564 6529 202b 2022  ludeexclude) + "
-0000c100: 2661 6e6f 6d61 6c79 7468 7265 7368 6f6c  &anomalythreshol
-0000c110: 643d 2220 2b20 7374 7228 616e 6f6d 616c  d=" + str(anomal
-0000c120: 7974 6872 6573 686f 6c64 290d 0a20 2020  ythreshold)..   
-0000c130: 2020 2020 2020 2020 2b20 2226 7365 6e64          + "&send
-0000c140: 616e 6f6d 616c 7961 6c65 7274 656d 6169  anomalyalertemai
-0000c150: 6c3d 2220 2b20 7365 6e64 616e 6f6d 616c  l=" + sendanomal
-0000c160: 7961 6c65 7274 656d 6169 6c20 2b20 2226  yalertemail + "&
-0000c170: 656d 6169 6c66 7265 7175 656e 6379 3d22  emailfrequency="
-0000c180: 202b 2073 7472 2865 6d61 696c 6672 6571   + str(emailfreq
-0000c190: 7565 6e63 7929 290d 0a0d 0a20 2020 2076  uency))....    v
-0000c1a0: 616c 3d6c 6f6f 702e 7275 6e5f 756e 7469  al=loop.run_unti
-0000c1b0: 6c5f 636f 6d70 6c65 7465 2874 6370 5f65  l_complete(tcp_e
-0000c1c0: 6368 6f5f 636c 6965 6e74 7669 7065 7228  cho_clientviper(
-0000c1d0: 7661 6c75 652c 206c 6f6f 702c 686f 7374  value, loop,host
-0000c1e0: 2c70 6f72 742c 6d69 6372 6f73 6572 7669  ,port,microservi
-0000c1f0: 6365 6964 2c61 7379 6e63 7469 6d65 6f75  ceid,asynctimeou
-0000c200: 7429 290d 0a0d 0a20 2020 2069 6620 636f  t))....    if co
-0000c210: 6e6e 6563 7469 6f6e 6572 726f 723a 0d0a  nnectionerror:..
-0000c220: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000c230: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
-0000c240: 0a0d 0a20 2020 2072 6574 7572 6e20 7661  ...    return va
-0000c250: 6c0d 0a0d 0a64 6566 2076 6970 6572 7072  l....def viperpr
-0000c260: 6570 726f 6365 7373 6375 7374 6f6d 6a73  eprocesscustomjs
-0000c270: 6f6e 2876 6970 6572 746f 6b65 6e2c 686f  on(vipertoken,ho
-0000c280: 7374 2c70 6f72 742c 746f 7069 632c 7072  st,port,topic,pr
-0000c290: 6f64 7563 6572 6964 2c6f 6666 7365 742c  oducerid,offset,
-0000c2a0: 6a73 6f6e 6372 6974 6572 6961 3d27 272c  jsoncriteria='',
-0000c2b0: 7261 7764 6174 616f 7574 7075 743d 302c  rawdataoutput=0,
-0000c2c0: 6d61 7872 6f77 733d 302c 656e 6162 6c65  maxrows=0,enable
-0000c2d0: 746c 733d 302c 6465 6c61 793d 3130 302c  tls=0,delay=100,
-0000c2e0: 6272 6f6b 6572 686f 7374 3d27 272c 6272  brokerhost='',br
-0000c2f0: 6f6b 6572 706f 7274 3d2d 3939 392c 6d69  okerport=-999,mi
-0000c300: 6372 6f73 6572 7669 6365 6964 3d27 272c  croserviceid='',
-0000c310: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c330: 746f 7069 6369 643d 2d39 3939 2c73 7472  topicid=-999,str
-0000c340: 6561 6d73 746f 6a6f 696e 3d27 272c 7072  eamstojoin='',pr
-0000c350: 6570 726f 6365 7373 6c6f 6769 633d 2727  eprocesslogic=''
-0000c360: 2c70 7265 7072 6f63 6573 7363 6f6e 6469  ,preprocesscondi
-0000c370: 7469 6f6e 733d 2727 2c69 6465 6e74 6966  tions='',identif
-0000c380: 6965 723d 2727 2c70 7265 7072 6f63 6573  ier='',preproces
-0000c390: 7374 6f70 6963 3d27 272c 0d0a 2020 2020  stopic='',..    
+0000b660: 2074 6f70 6963 6964 3d2d 3939 392c 7374   topicid=-999,st
+0000b670: 7265 616d 7374 6f6a 6f69 6e3d 2727 2c70  reamstojoin='',p
+0000b680: 7265 7072 6f63 6573 736c 6f67 6963 3d27  reprocesslogic='
+0000b690: 272c 7072 6570 726f 6365 7373 636f 6e64  ',preprocesscond
+0000b6a0: 6974 696f 6e73 3d27 272c 6964 656e 7469  itions='',identi
+0000b6b0: 6669 6572 3d27 272c 7072 6570 726f 6365  fier='',preproce
+0000b6c0: 7373 746f 7069 633d 2727 2c61 7272 6179  sstopic='',array
+0000b6d0: 3d30 2c73 6176 6561 7361 7272 6179 3d30  =0,saveasarray=0
+0000b6e0: 2c72 6177 6461 7461 6f75 7470 7574 3d30  ,rawdataoutput=0
+0000b6f0: 293a 0d0a 2020 2020 676c 6f62 616c 2063  ):..    global c
+0000b700: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
+0000b710: 0d0a 2020 2020 6966 2028 6c65 6e28 686f  ..    if (len(ho
+0000b720: 7374 293d 3d30 206f 7220 6c65 6e28 7669  st)==0 or len(vi
+0000b730: 7065 7274 6f6b 656e 293d 3d30 206f 7220  pertoken)==0 or 
+0000b740: 706f 7274 3d3d 2d39 3939 206f 7220 6c65  port==-999 or le
+0000b750: 6e28 746f 7069 6329 3d3d 3020 6f72 206c  n(topic)==0 or l
+0000b760: 656e 2870 726f 6475 6365 7269 6429 3d3d  en(producerid)==
+0000b770: 3020 6f72 206c 656e 2870 7265 7072 6f63  0 or len(preproc
+0000b780: 6573 736c 6f67 6963 293d 3d30 293a 0d0a  esslogic)==0):..
+0000b790: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000b7a0: 2250 6c65 6173 6520 656e 7465 7220 686f  "Please enter ho
+0000b7b0: 7374 2c70 6f72 742c 7669 7065 7274 6f6b  st,port,vipertok
+0000b7c0: 656e 2c74 6f70 6963 2c70 726f 6475 6365  en,topic,produce
+0000b7d0: 7269 642c 7072 6570 726f 6365 7373 6c6f  rid,preprocesslo
+0000b7e0: 6769 6322 0d0a 2020 2020 2020 2020 0d0a  gic"..        ..
+0000b7f0: 2020 2020 7661 6c75 653d 2822 7072 6570      value=("prep
+0000b800: 726f 6365 7373 7072 6f64 7563 6574 6f74  rocessproducetot
+0000b810: 6f70 6963 7374 7265 616d 3f76 6970 6572  opicstream?viper
+0000b820: 746f 6b65 6e3d 222b 7669 7065 7274 6f6b  token="+vipertok
+0000b830: 656e 202b 2022 2674 6f70 6963 6e61 6d65  en + "&topicname
+0000b840: 3d22 2b74 6f70 6963 202b 2022 2664 656c  ="+topic + "&del
+0000b850: 6179 3d22 202b 2073 7472 2864 656c 6179  ay=" + str(delay
+0000b860: 2920 2b20 2226 6d61 7872 6f77 733d 2220  ) + "&maxrows=" 
+0000b870: 2b73 7472 286d 6178 726f 7773 2920 2b0d  +str(maxrows) +.
+0000b880: 0a20 2020 2020 2020 2020 2020 2226 656e  .           "&en
+0000b890: 6162 6c65 746c 733d 222b 7374 7228 656e  abletls="+str(en
+0000b8a0: 6162 6c65 746c 7329 202b 2226 6272 6f6b  abletls) +"&brok
+0000b8b0: 6572 686f 7374 3d22 2b62 726f 6b65 7268  erhost="+brokerh
+0000b8c0: 6f73 7420 2b20 2226 6272 6f6b 6572 706f  ost + "&brokerpo
+0000b8d0: 7274 3d22 2b73 7472 2862 726f 6b65 7270  rt="+str(brokerp
+0000b8e0: 6f72 7429 202b 2022 2670 726f 6475 6365  ort) + "&produce
+0000b8f0: 7269 643d 222b 7072 6f64 7563 6572 6964  rid="+producerid
+0000b900: 202b 0d0a 2020 2020 2020 2020 2020 2022   +..           "
+0000b910: 266f 6666 7365 743d 222b 7374 7228 6f66  &offset="+str(of
+0000b920: 6673 6574 2920 2b20 2226 746f 7069 6369  fset) + "&topici
+0000b930: 643d 2220 2b20 7374 7228 746f 7069 6369  d=" + str(topici
+0000b940: 6429 202b 2022 2673 7472 6561 6d73 746f  d) + "&streamsto
+0000b950: 6a6f 696e 3d22 2b73 7472 6561 6d73 746f  join="+streamsto
+0000b960: 6a6f 696e 0d0a 2020 2020 2020 2020 2020  join..          
+0000b970: 202b 2022 2670 7265 7072 6f63 6573 736c   + "&preprocessl
+0000b980: 6f67 6963 3d22 2b70 7265 7072 6f63 6573  ogic="+preproces
+0000b990: 736c 6f67 6963 202b 2022 2670 7265 7072  slogic + "&prepr
+0000b9a0: 6f63 6573 7363 6f6e 6469 7469 6f6e 733d  ocessconditions=
+0000b9b0: 2220 2b20 7072 6570 726f 6365 7373 636f  " + preprocessco
+0000b9c0: 6e64 6974 696f 6e73 0d0a 2020 2020 2020  nditions..      
+0000b9d0: 2020 2020 202b 2022 2669 6465 6e74 6966       + "&identif
+0000b9e0: 6965 723d 2220 2b20 6964 656e 7469 6669  ier=" + identifi
+0000b9f0: 6572 202b 2022 2670 7265 7072 6f63 6573  er + "&preproces
+0000ba00: 7374 6f70 6963 3d22 202b 2070 7265 7072  stopic=" + prepr
+0000ba10: 6f63 6573 7374 6f70 6963 202b 2022 2661  ocesstopic + "&a
+0000ba20: 7272 6179 3d22 202b 2073 7472 2861 7272  rray=" + str(arr
+0000ba30: 6179 292b 0d0a 2020 2020 2020 2020 2020  ay)+..          
+0000ba40: 2022 2673 6176 6561 7361 7272 6179 3d22   "&saveasarray="
+0000ba50: 202b 2073 7472 2873 6176 6561 7361 7272   + str(saveasarr
+0000ba60: 6179 2920 2b20 2226 7261 7764 6174 616f  ay) + "&rawdatao
+0000ba70: 7574 7075 743d 2220 2b20 7374 7228 7261  utput=" + str(ra
+0000ba80: 7764 6174 616f 7574 7075 7429 2029 0d0a  wdataoutput) )..
+0000ba90: 0d0a 2020 2020 7661 6c3d 6c6f 6f70 2e72  ..    val=loop.r
+0000baa0: 756e 5f75 6e74 696c 5f63 6f6d 706c 6574  un_until_complet
+0000bab0: 6528 7463 705f 6563 686f 5f63 6c69 656e  e(tcp_echo_clien
+0000bac0: 7476 6970 6572 2876 616c 7565 2c20 6c6f  tviper(value, lo
+0000bad0: 6f70 2c68 6f73 742c 706f 7274 2c6d 6963  op,host,port,mic
+0000bae0: 726f 7365 7276 6963 6569 6429 290d 0a0d  roserviceid))...
+0000baf0: 0a20 2020 2069 6620 636f 6e6e 6563 7469  .    if connecti
+0000bb00: 6f6e 6572 726f 723a 0d0a 2020 2020 2020  onerror:..      
+0000bb10: 2020 2072 6574 7572 6e20 636f 6e6e 6563     return connec
+0000bb20: 7469 6f6e 6572 726f 720d 0a0d 0a20 2020  tionerror....   
+0000bb30: 2072 6574 7572 6e20 7661 6c0d 0a0d 0a20   return val.... 
+0000bb40: 2020 2020 2020 200d 0a64 6566 2076 6970         ..def vip
+0000bb50: 6572 7365 6172 6368 616e 6f6d 616c 7928  ersearchanomaly(
+0000bb60: 7669 7065 7274 6f6b 656e 2c68 6f73 742c  vipertoken,host,
+0000bb70: 706f 7274 2c74 6f70 6963 2c70 726f 6475  port,topic,produ
+0000bb80: 6365 7269 642c 6f66 6673 6574 2c6a 736f  cerid,offset,jso
+0000bb90: 6e63 7269 7465 7269 613d 2727 2c72 6177  ncriteria='',raw
+0000bba0: 6461 7461 6f75 7470 7574 3d30 2c6d 6178  dataoutput=0,max
+0000bbb0: 726f 7773 3d30 2c65 6e61 626c 6574 6c73  rows=0,enabletls
+0000bbc0: 3d30 2c64 656c 6179 3d31 3030 2c0d 0a20  =0,delay=100,.. 
+0000bbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bbe0: 2020 2020 2020 6272 6f6b 6572 686f 7374        brokerhost
+0000bbf0: 3d27 272c 6272 6f6b 6572 706f 7274 3d2d  ='',brokerport=-
+0000bc00: 3939 392c 6d69 6372 6f73 6572 7669 6365  999,microservice
+0000bc10: 6964 3d27 272c 746f 7069 6369 643d 2d39  id='',topicid=-9
+0000bc20: 3939 2c69 6465 6e74 6966 6965 723d 2727  99,identifier=''
+0000bc30: 2c70 7265 7072 6f63 6573 7374 6f70 6963  ,preprocesstopic
+0000bc40: 3d27 272c 0d0a 2020 2020 2020 2020 2020  ='',..          
+0000bc50: 2020 2020 2020 2020 2020 2020 2074 696d               tim
+0000bc60: 6564 656c 6179 3d30 2c61 7379 6e63 7469  edelay=0,asyncti
+0000bc70: 6d65 6f75 743d 3132 302c 7365 6172 6368  meout=120,search
+0000bc80: 7465 726d 733d 2727 2c65 6e74 6974 7973  terms='',entitys
+0000bc90: 6561 7263 683d 2727 2c74 6167 7365 6172  earch='',tagsear
+0000bca0: 6368 3d27 272c 6368 6563 6b61 6e6f 6d61  ch='',checkanoma
+0000bcb0: 6c79 3d31 2c74 6573 7474 6f70 6963 3d27  ly=1,testtopic='
+0000bcc0: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
+0000bcd0: 2020 2020 2020 2020 2020 2069 6e63 6c75             inclu
+0000bce0: 6465 6578 636c 7564 653d 312c 616e 6f6d  deexclude=1,anom
+0000bcf0: 616c 7974 6872 6573 686f 6c64 3d30 2c73  alythreshold=0,s
+0000bd00: 656e 6461 6e6f 6d61 6c79 616c 6572 7465  endanomalyalerte
+0000bd10: 6d61 696c 3d27 272c 656d 6169 6c66 7265  mail='',emailfre
+0000bd20: 7175 656e 6379 3d33 3630 3029 3a0d 0a20  quency=3600):.. 
+0000bd30: 2020 2067 6c6f 6261 6c20 636f 6e6e 6563     global connec
+0000bd40: 7469 6f6e 6572 726f 720d 0a0d 0a20 2020  tionerror....   
+0000bd50: 2069 6620 286c 656e 2868 6f73 7429 3d3d   if (len(host)==
+0000bd60: 3020 6f72 206c 656e 2876 6970 6572 746f  0 or len(viperto
+0000bd70: 6b65 6e29 3d3d 3020 6f72 2070 6f72 743d  ken)==0 or port=
+0000bd80: 3d2d 3939 3920 6f72 206c 656e 2874 6f70  =-999 or len(top
+0000bd90: 6963 293d 3d30 206f 7220 6c65 6e28 6a73  ic)==0 or len(js
+0000bda0: 6f6e 6372 6974 6572 6961 293d 3d30 206f  oncriteria)==0 o
+0000bdb0: 7220 6c65 6e28 7072 6f64 7563 6572 6964  r len(producerid
+0000bdc0: 293d 3d30 293a 0d0a 2020 2020 2020 2020  )==0):..        
+0000bdd0: 2072 6574 7572 6e20 2250 6c65 6173 6520   return "Please 
+0000bde0: 656e 7465 7220 686f 7374 2c70 6f72 742c  enter host,port,
+0000bdf0: 7669 7065 7274 6f6b 656e 2c74 6f70 6963  vipertoken,topic
+0000be00: 2c70 726f 6475 6365 7269 642c 206a 736f  ,producerid, jso
+0000be10: 6e63 7269 7465 7269 6122 0d0a 2020 2020  ncriteria"..    
+0000be20: 2020 2020 2020 2020 0d0a 2020 2020 7661          ..    va
+0000be30: 6c75 653d 2822 6e6c 7073 6561 7263 6861  lue=("nlpsearcha
+0000be40: 6e6f 6d61 6c79 3f76 6970 6572 746f 6b65  nomaly?vipertoke
+0000be50: 6e3d 222b 7669 7065 7274 6f6b 656e 202b  n="+vipertoken +
+0000be60: 2022 2674 6f70 6963 6e61 6d65 3d22 2b74   "&topicname="+t
+0000be70: 6f70 6963 202b 2022 2664 656c 6179 3d22  opic + "&delay="
+0000be80: 202b 2073 7472 2864 656c 6179 2920 2b20   + str(delay) + 
+0000be90: 2226 6d61 7872 6f77 733d 2220 2b73 7472  "&maxrows=" +str
+0000bea0: 286d 6178 726f 7773 2920 2b0d 0a20 2020  (maxrows) +..   
+0000beb0: 2020 2020 2020 2020 2226 656e 6162 6c65          "&enable
+0000bec0: 746c 733d 222b 7374 7228 656e 6162 6c65  tls="+str(enable
+0000bed0: 746c 7329 202b 2226 6272 6f6b 6572 686f  tls) +"&brokerho
+0000bee0: 7374 3d22 2b62 726f 6b65 7268 6f73 7420  st="+brokerhost 
+0000bef0: 2b20 2226 6272 6f6b 6572 706f 7274 3d22  + "&brokerport="
+0000bf00: 2b73 7472 2862 726f 6b65 7270 6f72 7429  +str(brokerport)
+0000bf10: 202b 2022 2670 726f 6475 6365 7269 643d   + "&producerid=
+0000bf20: 222b 7072 6f64 7563 6572 6964 202b 0d0a  "+producerid +..
+0000bf30: 2020 2020 2020 2020 2020 2022 266f 6666             "&off
+0000bf40: 7365 743d 222b 7374 7228 6f66 6673 6574  set="+str(offset
+0000bf50: 2920 2b20 2226 746f 7069 6369 643d 2220  ) + "&topicid=" 
+0000bf60: 2b20 7374 7228 746f 7069 6369 6429 202b  + str(topicid) +
+0000bf70: 2022 2670 7265 7072 6f63 6573 7374 6f70   "&preprocesstop
+0000bf80: 6963 3d22 202b 2070 7265 7072 6f63 6573  ic=" + preproces
+0000bf90: 7374 6f70 6963 202b 2022 2674 696d 6564  stopic + "&timed
+0000bfa0: 656c 6179 3d22 202b 2073 7472 2874 696d  elay=" + str(tim
+0000bfb0: 6564 656c 6179 2920 2b20 2226 6a73 6f6e  edelay) + "&json
+0000bfc0: 6372 6974 6572 6961 3d22 202b 206a 736f  criteria=" + jso
+0000bfd0: 6e63 7269 7465 7269 610d 0a20 2020 2020  ncriteria..     
+0000bfe0: 2020 2020 2020 2b20 2226 7261 7764 6174        + "&rawdat
+0000bff0: 616f 7574 7075 743d 2220 2b20 7374 7228  aoutput=" + str(
+0000c000: 7261 7764 6174 616f 7574 7075 7429 202b  rawdataoutput) +
+0000c010: 2022 2673 6561 7263 6874 6572 6d73 3d22   "&searchterms="
+0000c020: 202b 2073 6561 7263 6874 6572 6d73 202b   + searchterms +
+0000c030: 2022 2665 6e74 6974 7973 6561 7263 683d   "&entitysearch=
+0000c040: 2220 2b20 656e 7469 7479 7365 6172 6368  " + entitysearch
+0000c050: 0d0a 2020 2020 2020 2020 2020 202b 2022  ..           + "
+0000c060: 2674 6167 7365 6172 6368 3d22 202b 2074  &tagsearch=" + t
+0000c070: 6167 7365 6172 6368 202b 2022 2663 6865  agsearch + "&che
+0000c080: 636b 616e 6f6d 616c 793d 2220 2b20 7374  ckanomaly=" + st
+0000c090: 7228 6368 6563 6b61 6e6f 6d61 6c79 2920  r(checkanomaly) 
+0000c0a0: 2b20 2226 7465 7374 746f 7069 633d 2220  + "&testtopic=" 
+0000c0b0: 2b20 7465 7374 746f 7069 630d 0a20 2020  + testtopic..   
+0000c0c0: 2020 2020 2020 2020 2b20 2226 696e 636c          + "&incl
+0000c0d0: 7564 6565 7863 6c75 6465 3d22 202b 2073  udeexclude=" + s
+0000c0e0: 7472 2869 6e63 6c75 6465 6578 636c 7564  tr(includeexclud
+0000c0f0: 6529 202b 2022 2661 6e6f 6d61 6c79 7468  e) + "&anomalyth
+0000c100: 7265 7368 6f6c 643d 2220 2b20 7374 7228  reshold=" + str(
+0000c110: 616e 6f6d 616c 7974 6872 6573 686f 6c64  anomalythreshold
+0000c120: 290d 0a20 2020 2020 2020 2020 2020 2b20  )..           + 
+0000c130: 2226 7365 6e64 616e 6f6d 616c 7961 6c65  "&sendanomalyale
+0000c140: 7274 656d 6169 6c3d 2220 2b20 7365 6e64  rtemail=" + send
+0000c150: 616e 6f6d 616c 7961 6c65 7274 656d 6169  anomalyalertemai
+0000c160: 6c20 2b20 2226 656d 6169 6c66 7265 7175  l + "&emailfrequ
+0000c170: 656e 6379 3d22 202b 2073 7472 2865 6d61  ency=" + str(ema
+0000c180: 696c 6672 6571 7565 6e63 7929 290d 0a0d  ilfrequency))...
+0000c190: 0a20 2020 2076 616c 3d6c 6f6f 702e 7275  .    val=loop.ru
+0000c1a0: 6e5f 756e 7469 6c5f 636f 6d70 6c65 7465  n_until_complete
+0000c1b0: 2874 6370 5f65 6368 6f5f 636c 6965 6e74  (tcp_echo_client
+0000c1c0: 7669 7065 7228 7661 6c75 652c 206c 6f6f  viper(value, loo
+0000c1d0: 702c 686f 7374 2c70 6f72 742c 6d69 6372  p,host,port,micr
+0000c1e0: 6f73 6572 7669 6365 6964 2c61 7379 6e63  oserviceid,async
+0000c1f0: 7469 6d65 6f75 7429 290d 0a0d 0a20 2020  timeout))....   
+0000c200: 2069 6620 636f 6e6e 6563 7469 6f6e 6572   if connectioner
+0000c210: 726f 723a 0d0a 2020 2020 2020 2020 2072  ror:..         r
+0000c220: 6574 7572 6e20 636f 6e6e 6563 7469 6f6e  eturn connection
+0000c230: 6572 726f 720d 0a0d 0a20 2020 2072 6574  error....    ret
+0000c240: 7572 6e20 7661 6c0d 0a0d 0a64 6566 2076  urn val....def v
+0000c250: 6970 6572 7072 6570 726f 6365 7373 6375  iperpreprocesscu
+0000c260: 7374 6f6d 6a73 6f6e 2876 6970 6572 746f  stomjson(viperto
+0000c270: 6b65 6e2c 686f 7374 2c70 6f72 742c 746f  ken,host,port,to
+0000c280: 7069 632c 7072 6f64 7563 6572 6964 2c6f  pic,producerid,o
+0000c290: 6666 7365 742c 6a73 6f6e 6372 6974 6572  ffset,jsoncriter
+0000c2a0: 6961 3d27 272c 7261 7764 6174 616f 7574  ia='',rawdataout
+0000c2b0: 7075 743d 302c 6d61 7872 6f77 733d 302c  put=0,maxrows=0,
+0000c2c0: 656e 6162 6c65 746c 733d 302c 6465 6c61  enabletls=0,dela
+0000c2d0: 793d 3130 302c 6272 6f6b 6572 686f 7374  y=100,brokerhost
+0000c2e0: 3d27 272c 6272 6f6b 6572 706f 7274 3d2d  ='',brokerport=-
+0000c2f0: 3939 392c 6d69 6372 6f73 6572 7669 6365  999,microservice
+0000c300: 6964 3d27 272c 0d0a 2020 2020 2020 2020  id='',..        
+0000c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c320: 2020 2020 2020 746f 7069 6369 643d 2d39        topicid=-9
+0000c330: 3939 2c73 7472 6561 6d73 746f 6a6f 696e  99,streamstojoin
+0000c340: 3d27 272c 7072 6570 726f 6365 7373 6c6f  ='',preprocesslo
+0000c350: 6769 633d 2727 2c70 7265 7072 6f63 6573  gic='',preproces
+0000c360: 7363 6f6e 6469 7469 6f6e 733d 2727 2c69  sconditions='',i
+0000c370: 6465 6e74 6966 6965 723d 2727 2c70 7265  dentifier='',pre
+0000c380: 7072 6f63 6573 7374 6f70 6963 3d27 272c  processtopic='',
+0000c390: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 0000c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c3b0: 2020 2020 2020 2020 2020 6172 7261 793d            array=
-0000c3c0: 302c 7361 7665 6173 6172 7261 793d 302c  0,saveasarray=0,
-0000c3d0: 7469 6d65 6465 6c61 793d 302c 6173 796e  timedelay=0,asyn
-0000c3e0: 6374 696d 656f 7574 3d31 3230 2c75 7365  ctimeout=120,use
-0000c3f0: 6d79 7371 6c3d 302c 746d 6c66 696c 6570  mysql=0,tmlfilep
-0000c400: 6174 683d 2727 2c70 6174 6874 6f74 6d6c  ath='',pathtotml
-0000c410: 6174 7472 733d 2727 293a 0d0a 2020 2020  attrs=''):..    
-0000c420: 676c 6f62 616c 2063 6f6e 6e65 6374 696f  global connectio
-0000c430: 6e65 7272 6f72 0d0a 0d0a 2020 2020 6966  nerror....    if
-0000c440: 2028 6c65 6e28 686f 7374 293d 3d30 206f   (len(host)==0 o
-0000c450: 7220 6c65 6e28 7669 7065 7274 6f6b 656e  r len(vipertoken
-0000c460: 293d 3d30 206f 7220 706f 7274 3d3d 2d39  )==0 or port==-9
-0000c470: 3939 206f 7220 6c65 6e28 746f 7069 6329  99 or len(topic)
-0000c480: 3d3d 3020 6f72 206c 656e 286a 736f 6e63  ==0 or len(jsonc
-0000c490: 7269 7465 7269 6129 3d3d 3020 6f72 206c  riteria)==0 or l
-0000c4a0: 656e 2870 726f 6475 6365 7269 6429 3d3d  en(producerid)==
-0000c4b0: 3020 6f72 206c 656e 2870 7265 7072 6f63  0 or len(preproc
-0000c4c0: 6573 736c 6f67 6963 293d 3d30 293a 0d0a  esslogic)==0):..
-0000c4d0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000c4e0: 2250 6c65 6173 6520 656e 7465 7220 686f  "Please enter ho
-0000c4f0: 7374 2c70 6f72 742c 7669 7065 7274 6f6b  st,port,vipertok
-0000c500: 656e 2c74 6f70 6963 2c70 726f 6475 6365  en,topic,produce
-0000c510: 7269 642c 7072 6570 726f 6365 7373 6c6f  rid,preprocesslo
-0000c520: 6769 632c 206a 736f 6e63 7269 7465 7269  gic, jsoncriteri
-0000c530: 6122 0d0a 2020 2020 2020 2020 2020 2020  a"..            
-0000c540: 0d0a 2020 2020 7661 6c75 653d 2822 7072  ..    value=("pr
-0000c550: 6570 726f 6365 7373 6375 7374 6f6d 6a73  eprocesscustomjs
-0000c560: 6f6e 3f76 6970 6572 746f 6b65 6e3d 222b  on?vipertoken="+
-0000c570: 7669 7065 7274 6f6b 656e 202b 2022 2674  vipertoken + "&t
-0000c580: 6f70 6963 6e61 6d65 3d22 2b74 6f70 6963  opicname="+topic
-0000c590: 202b 2022 2664 656c 6179 3d22 202b 2073   + "&delay=" + s
-0000c5a0: 7472 2864 656c 6179 2920 2b20 2226 6d61  tr(delay) + "&ma
-0000c5b0: 7872 6f77 733d 2220 2b73 7472 286d 6178  xrows=" +str(max
-0000c5c0: 726f 7773 2920 2b0d 0a20 2020 2020 2020  rows) +..       
-0000c5d0: 2020 2020 2226 656e 6162 6c65 746c 733d      "&enabletls=
-0000c5e0: 222b 7374 7228 656e 6162 6c65 746c 7329  "+str(enabletls)
-0000c5f0: 202b 2226 6272 6f6b 6572 686f 7374 3d22   +"&brokerhost="
-0000c600: 2b62 726f 6b65 7268 6f73 7420 2b20 2226  +brokerhost + "&
-0000c610: 6272 6f6b 6572 706f 7274 3d22 2b73 7472  brokerport="+str
-0000c620: 2862 726f 6b65 7270 6f72 7429 202b 2022  (brokerport) + "
-0000c630: 2670 726f 6475 6365 7269 643d 222b 7072  &producerid="+pr
-0000c640: 6f64 7563 6572 6964 202b 0d0a 2020 2020  oducerid +..    
-0000c650: 2020 2020 2020 2022 266f 6666 7365 743d         "&offset=
-0000c660: 222b 7374 7228 6f66 6673 6574 2920 2b20  "+str(offset) + 
-0000c670: 2226 746f 7069 6369 643d 2220 2b20 7374  "&topicid=" + st
-0000c680: 7228 746f 7069 6369 6429 202b 2022 2673  r(topicid) + "&s
-0000c690: 7472 6561 6d73 746f 6a6f 696e 3d22 2b73  treamstojoin="+s
-0000c6a0: 7472 6561 6d73 746f 6a6f 696e 0d0a 2020  treamstojoin..  
-0000c6b0: 2020 2020 2020 2020 202b 2022 2670 7265           + "&pre
-0000c6c0: 7072 6f63 6573 736c 6f67 6963 3d22 2b70  processlogic="+p
-0000c6d0: 7265 7072 6f63 6573 736c 6f67 6963 202b  reprocesslogic +
-0000c6e0: 2022 2670 7265 7072 6f63 6573 7363 6f6e   "&preprocesscon
-0000c6f0: 6469 7469 6f6e 733d 2220 2b20 7072 6570  ditions=" + prep
-0000c700: 726f 6365 7373 636f 6e64 6974 696f 6e73  rocessconditions
-0000c710: 0d0a 2020 2020 2020 2020 2020 202b 2022  ..           + "
-0000c720: 2669 6465 6e74 6966 6965 723d 2220 2b20  &identifier=" + 
-0000c730: 6964 656e 7469 6669 6572 202b 2022 2670  identifier + "&p
-0000c740: 7265 7072 6f63 6573 7374 6f70 6963 3d22  reprocesstopic="
-0000c750: 202b 2070 7265 7072 6f63 6573 7374 6f70   + preprocesstop
-0000c760: 6963 202b 2022 2661 7272 6179 3d22 202b  ic + "&array=" +
-0000c770: 2073 7472 2861 7272 6179 292b 0d0a 2020   str(array)+..  
-0000c780: 2020 2020 2020 2020 2022 2673 6176 6561           "&savea
-0000c790: 7361 7272 6179 3d22 202b 2073 7472 2873  sarray=" + str(s
-0000c7a0: 6176 6561 7361 7272 6179 2920 2b20 2226  aveasarray) + "&
-0000c7b0: 7469 6d65 6465 6c61 793d 2220 2b20 7374  timedelay=" + st
-0000c7c0: 7228 7469 6d65 6465 6c61 7929 202b 2022  r(timedelay) + "
-0000c7d0: 266a 736f 6e63 7269 7465 7269 613d 2220  &jsoncriteria=" 
-0000c7e0: 2b20 6a73 6f6e 6372 6974 6572 6961 0d0a  + jsoncriteria..
-0000c7f0: 2020 2020 2020 2020 2020 202b 2022 2672             + "&r
-0000c800: 6177 6461 7461 6f75 7470 7574 3d22 202b  awdataoutput=" +
-0000c810: 2073 7472 2872 6177 6461 7461 6f75 7470   str(rawdataoutp
-0000c820: 7574 2920 2b20 2226 7573 656d 7973 716c  ut) + "&usemysql
-0000c830: 3d22 202b 2073 7472 2875 7365 6d79 7371  =" + str(usemysq
-0000c840: 6c29 202b 2022 2674 6d6c 6669 6c65 7061  l) + "&tmlfilepa
-0000c850: 7468 3d22 202b 2074 6d6c 6669 6c65 7061  th=" + tmlfilepa
-0000c860: 7468 202b 2022 2670 6174 6874 6f74 6d6c  th + "&pathtotml
-0000c870: 6174 7472 733d 2220 2b20 7061 7468 746f  attrs=" + pathto
-0000c880: 746d 6c61 7474 7273 2029 0d0a 0d0a 2020  tmlattrs )....  
-0000c890: 2020 7661 6c3d 6c6f 6f70 2e72 756e 5f75    val=loop.run_u
-0000c8a0: 6e74 696c 5f63 6f6d 706c 6574 6528 7463  ntil_complete(tc
-0000c8b0: 705f 6563 686f 5f63 6c69 656e 7476 6970  p_echo_clientvip
-0000c8c0: 6572 2876 616c 7565 2c20 6c6f 6f70 2c68  er(value, loop,h
-0000c8d0: 6f73 742c 706f 7274 2c6d 6963 726f 7365  ost,port,microse
-0000c8e0: 7276 6963 6569 642c 6173 796e 6374 696d  rviceid,asynctim
-0000c8f0: 656f 7574 2929 0d0a 0d0a 2020 2020 6966  eout))....    if
-0000c900: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
-0000c910: 3a0d 0a20 2020 2020 2020 2020 7265 7475  :..         retu
-0000c920: 726e 2063 6f6e 6e65 6374 696f 6e65 7272  rn connectionerr
-0000c930: 6f72 0d0a 0d0a 2020 2020 7265 7475 726e  or....    return
-0000c940: 2076 616c 0d0a 0d0a 0d0a 6465 6620 7669   val......def vi
-0000c950: 7065 7270 7265 7072 6f63 6573 7362 6174  perpreprocessbat
-0000c960: 6368 2876 6970 6572 746f 6b65 6e2c 686f  ch(vipertoken,ho
-0000c970: 7374 2c70 6f72 742c 746f 7069 632c 7072  st,port,topic,pr
-0000c980: 6f64 7563 6572 6964 2c6f 6666 7365 742c  oducerid,offset,
-0000c990: 6d61 7872 6f77 733d 302c 656e 6162 6c65  maxrows=0,enable
-0000c9a0: 746c 733d 302c 6465 6c61 793d 3130 302c  tls=0,delay=100,
-0000c9b0: 6272 6f6b 6572 686f 7374 3d27 272c 6272  brokerhost='',br
-0000c9c0: 6f6b 6572 706f 7274 3d2d 3939 392c 6d69  okerport=-999,mi
-0000c9d0: 6372 6f73 6572 7669 6365 6964 3d27 272c  croserviceid='',
-0000c9e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000c9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca00: 746f 7069 6369 643d 222d 3939 3922 2c73  topicid="-999",s
-0000ca10: 7472 6561 6d73 746f 6a6f 696e 3d27 272c  treamstojoin='',
-0000ca20: 7072 6570 726f 6365 7373 6c6f 6769 633d  preprocesslogic=
-0000ca30: 2727 2c70 7265 7072 6f63 6573 7363 6f6e  '',preprocesscon
-0000ca40: 6469 7469 6f6e 733d 2727 2c69 6465 6e74  ditions='',ident
-0000ca50: 6966 6965 723d 2727 2c70 7265 7072 6f63  ifier='',preproc
-0000ca60: 6573 7374 6f70 6963 3d27 272c 0d0a 2020  esstopic='',..  
+0000c3b0: 6172 7261 793d 302c 7361 7665 6173 6172  array=0,saveasar
+0000c3c0: 7261 793d 302c 7469 6d65 6465 6c61 793d  ray=0,timedelay=
+0000c3d0: 302c 6173 796e 6374 696d 656f 7574 3d31  0,asynctimeout=1
+0000c3e0: 3230 2c75 7365 6d79 7371 6c3d 302c 746d  20,usemysql=0,tm
+0000c3f0: 6c66 696c 6570 6174 683d 2727 2c70 6174  lfilepath='',pat
+0000c400: 6874 6f74 6d6c 6174 7472 733d 2727 293a  htotmlattrs=''):
+0000c410: 0d0a 2020 2020 676c 6f62 616c 2063 6f6e  ..    global con
+0000c420: 6e65 6374 696f 6e65 7272 6f72 0d0a 0d0a  nectionerror....
+0000c430: 2020 2020 6966 2028 6c65 6e28 686f 7374      if (len(host
+0000c440: 293d 3d30 206f 7220 6c65 6e28 7669 7065  )==0 or len(vipe
+0000c450: 7274 6f6b 656e 293d 3d30 206f 7220 706f  rtoken)==0 or po
+0000c460: 7274 3d3d 2d39 3939 206f 7220 6c65 6e28  rt==-999 or len(
+0000c470: 746f 7069 6329 3d3d 3020 6f72 206c 656e  topic)==0 or len
+0000c480: 286a 736f 6e63 7269 7465 7269 6129 3d3d  (jsoncriteria)==
+0000c490: 3020 6f72 206c 656e 2870 726f 6475 6365  0 or len(produce
+0000c4a0: 7269 6429 3d3d 3020 6f72 206c 656e 2870  rid)==0 or len(p
+0000c4b0: 7265 7072 6f63 6573 736c 6f67 6963 293d  reprocesslogic)=
+0000c4c0: 3d30 293a 0d0a 2020 2020 2020 2020 2072  =0):..         r
+0000c4d0: 6574 7572 6e20 2250 6c65 6173 6520 656e  eturn "Please en
+0000c4e0: 7465 7220 686f 7374 2c70 6f72 742c 7669  ter host,port,vi
+0000c4f0: 7065 7274 6f6b 656e 2c74 6f70 6963 2c70  pertoken,topic,p
+0000c500: 726f 6475 6365 7269 642c 7072 6570 726f  roducerid,prepro
+0000c510: 6365 7373 6c6f 6769 632c 206a 736f 6e63  cesslogic, jsonc
+0000c520: 7269 7465 7269 6122 0d0a 2020 2020 2020  riteria"..      
+0000c530: 2020 2020 2020 0d0a 2020 2020 7661 6c75        ..    valu
+0000c540: 653d 2822 7072 6570 726f 6365 7373 6375  e=("preprocesscu
+0000c550: 7374 6f6d 6a73 6f6e 3f76 6970 6572 746f  stomjson?viperto
+0000c560: 6b65 6e3d 222b 7669 7065 7274 6f6b 656e  ken="+vipertoken
+0000c570: 202b 2022 2674 6f70 6963 6e61 6d65 3d22   + "&topicname="
+0000c580: 2b74 6f70 6963 202b 2022 2664 656c 6179  +topic + "&delay
+0000c590: 3d22 202b 2073 7472 2864 656c 6179 2920  =" + str(delay) 
+0000c5a0: 2b20 2226 6d61 7872 6f77 733d 2220 2b73  + "&maxrows=" +s
+0000c5b0: 7472 286d 6178 726f 7773 2920 2b0d 0a20  tr(maxrows) +.. 
+0000c5c0: 2020 2020 2020 2020 2020 2226 656e 6162            "&enab
+0000c5d0: 6c65 746c 733d 222b 7374 7228 656e 6162  letls="+str(enab
+0000c5e0: 6c65 746c 7329 202b 2226 6272 6f6b 6572  letls) +"&broker
+0000c5f0: 686f 7374 3d22 2b62 726f 6b65 7268 6f73  host="+brokerhos
+0000c600: 7420 2b20 2226 6272 6f6b 6572 706f 7274  t + "&brokerport
+0000c610: 3d22 2b73 7472 2862 726f 6b65 7270 6f72  ="+str(brokerpor
+0000c620: 7429 202b 2022 2670 726f 6475 6365 7269  t) + "&produceri
+0000c630: 643d 222b 7072 6f64 7563 6572 6964 202b  d="+producerid +
+0000c640: 0d0a 2020 2020 2020 2020 2020 2022 266f  ..           "&o
+0000c650: 6666 7365 743d 222b 7374 7228 6f66 6673  ffset="+str(offs
+0000c660: 6574 2920 2b20 2226 746f 7069 6369 643d  et) + "&topicid=
+0000c670: 2220 2b20 7374 7228 746f 7069 6369 6429  " + str(topicid)
+0000c680: 202b 2022 2673 7472 6561 6d73 746f 6a6f   + "&streamstojo
+0000c690: 696e 3d22 2b73 7472 6561 6d73 746f 6a6f  in="+streamstojo
+0000c6a0: 696e 0d0a 2020 2020 2020 2020 2020 202b  in..           +
+0000c6b0: 2022 2670 7265 7072 6f63 6573 736c 6f67   "&preprocesslog
+0000c6c0: 6963 3d22 2b70 7265 7072 6f63 6573 736c  ic="+preprocessl
+0000c6d0: 6f67 6963 202b 2022 2670 7265 7072 6f63  ogic + "&preproc
+0000c6e0: 6573 7363 6f6e 6469 7469 6f6e 733d 2220  essconditions=" 
+0000c6f0: 2b20 7072 6570 726f 6365 7373 636f 6e64  + preprocesscond
+0000c700: 6974 696f 6e73 0d0a 2020 2020 2020 2020  itions..        
+0000c710: 2020 202b 2022 2669 6465 6e74 6966 6965     + "&identifie
+0000c720: 723d 2220 2b20 6964 656e 7469 6669 6572  r=" + identifier
+0000c730: 202b 2022 2670 7265 7072 6f63 6573 7374   + "&preprocesst
+0000c740: 6f70 6963 3d22 202b 2070 7265 7072 6f63  opic=" + preproc
+0000c750: 6573 7374 6f70 6963 202b 2022 2661 7272  esstopic + "&arr
+0000c760: 6179 3d22 202b 2073 7472 2861 7272 6179  ay=" + str(array
+0000c770: 292b 0d0a 2020 2020 2020 2020 2020 2022  )+..           "
+0000c780: 2673 6176 6561 7361 7272 6179 3d22 202b  &saveasarray=" +
+0000c790: 2073 7472 2873 6176 6561 7361 7272 6179   str(saveasarray
+0000c7a0: 2920 2b20 2226 7469 6d65 6465 6c61 793d  ) + "&timedelay=
+0000c7b0: 2220 2b20 7374 7228 7469 6d65 6465 6c61  " + str(timedela
+0000c7c0: 7929 202b 2022 266a 736f 6e63 7269 7465  y) + "&jsoncrite
+0000c7d0: 7269 613d 2220 2b20 6a73 6f6e 6372 6974  ria=" + jsoncrit
+0000c7e0: 6572 6961 0d0a 2020 2020 2020 2020 2020  eria..          
+0000c7f0: 202b 2022 2672 6177 6461 7461 6f75 7470   + "&rawdataoutp
+0000c800: 7574 3d22 202b 2073 7472 2872 6177 6461  ut=" + str(rawda
+0000c810: 7461 6f75 7470 7574 2920 2b20 2226 7573  taoutput) + "&us
+0000c820: 656d 7973 716c 3d22 202b 2073 7472 2875  emysql=" + str(u
+0000c830: 7365 6d79 7371 6c29 202b 2022 2674 6d6c  semysql) + "&tml
+0000c840: 6669 6c65 7061 7468 3d22 202b 2074 6d6c  filepath=" + tml
+0000c850: 6669 6c65 7061 7468 202b 2022 2670 6174  filepath + "&pat
+0000c860: 6874 6f74 6d6c 6174 7472 733d 2220 2b20  htotmlattrs=" + 
+0000c870: 7061 7468 746f 746d 6c61 7474 7273 2029  pathtotmlattrs )
+0000c880: 0d0a 0d0a 2020 2020 7661 6c3d 6c6f 6f70  ....    val=loop
+0000c890: 2e72 756e 5f75 6e74 696c 5f63 6f6d 706c  .run_until_compl
+0000c8a0: 6574 6528 7463 705f 6563 686f 5f63 6c69  ete(tcp_echo_cli
+0000c8b0: 656e 7476 6970 6572 2876 616c 7565 2c20  entviper(value, 
+0000c8c0: 6c6f 6f70 2c68 6f73 742c 706f 7274 2c6d  loop,host,port,m
+0000c8d0: 6963 726f 7365 7276 6963 6569 642c 6173  icroserviceid,as
+0000c8e0: 796e 6374 696d 656f 7574 2929 0d0a 0d0a  ynctimeout))....
+0000c8f0: 2020 2020 6966 2063 6f6e 6e65 6374 696f      if connectio
+0000c900: 6e65 7272 6f72 3a0d 0a20 2020 2020 2020  nerror:..       
+0000c910: 2020 7265 7475 726e 2063 6f6e 6e65 6374    return connect
+0000c920: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
+0000c930: 7265 7475 726e 2076 616c 0d0a 0d0a 0d0a  return val......
+0000c940: 6465 6620 7669 7065 7270 7265 7072 6f63  def viperpreproc
+0000c950: 6573 7362 6174 6368 2876 6970 6572 746f  essbatch(viperto
+0000c960: 6b65 6e2c 686f 7374 2c70 6f72 742c 746f  ken,host,port,to
+0000c970: 7069 632c 7072 6f64 7563 6572 6964 2c6f  pic,producerid,o
+0000c980: 6666 7365 742c 6d61 7872 6f77 733d 302c  ffset,maxrows=0,
+0000c990: 656e 6162 6c65 746c 733d 302c 6465 6c61  enabletls=0,dela
+0000c9a0: 793d 3130 302c 6272 6f6b 6572 686f 7374  y=100,brokerhost
+0000c9b0: 3d27 272c 6272 6f6b 6572 706f 7274 3d2d  ='',brokerport=-
+0000c9c0: 3939 392c 6d69 6372 6f73 6572 7669 6365  999,microservice
+0000c9d0: 6964 3d27 272c 0d0a 2020 2020 2020 2020  id='',..        
+0000c9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c9f0: 2020 2020 2020 746f 7069 6369 643d 222d        topicid="-
+0000ca00: 3939 3922 2c73 7472 6561 6d73 746f 6a6f  999",streamstojo
+0000ca10: 696e 3d27 272c 7072 6570 726f 6365 7373  in='',preprocess
+0000ca20: 6c6f 6769 633d 2727 2c70 7265 7072 6f63  logic='',preproc
+0000ca30: 6573 7363 6f6e 6469 7469 6f6e 733d 2727  essconditions=''
+0000ca40: 2c69 6465 6e74 6966 6965 723d 2727 2c70  ,identifier='',p
+0000ca50: 7265 7072 6f63 6573 7374 6f70 6963 3d27  reprocesstopic='
+0000ca60: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
 0000ca70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca80: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-0000ca90: 793d 302c 7361 7665 6173 6172 7261 793d  y=0,saveasarray=
-0000caa0: 302c 7469 6d65 6465 6c61 793d 302c 6173  0,timedelay=0,as
-0000cab0: 796e 6374 696d 656f 7574 3d31 3230 2c72  ynctimeout=120,r
-0000cac0: 6177 6461 7461 6f75 7470 7574 3d30 293a  awdataoutput=0):
-0000cad0: 0d0a 2020 2020 676c 6f62 616c 2063 6f6e  ..    global con
-0000cae0: 6e65 6374 696f 6e65 7272 6f72 0d0a 0d0a  nectionerror....
-0000caf0: 2020 2020 6966 2028 6c65 6e28 686f 7374      if (len(host
-0000cb00: 293d 3d30 206f 7220 6c65 6e28 7669 7065  )==0 or len(vipe
-0000cb10: 7274 6f6b 656e 293d 3d30 206f 7220 706f  rtoken)==0 or po
-0000cb20: 7274 3d3d 2d39 3939 206f 7220 6c65 6e28  rt==-999 or len(
-0000cb30: 746f 7069 6329 3d3d 3020 6f72 206c 656e  topic)==0 or len
-0000cb40: 2870 726f 6475 6365 7269 6429 3d3d 3020  (producerid)==0 
-0000cb50: 6f72 206c 656e 2870 7265 7072 6f63 6573  or len(preproces
-0000cb60: 736c 6f67 6963 293d 3d30 293a 0d0a 2020  slogic)==0):..  
-0000cb70: 2020 2020 2020 2072 6574 7572 6e20 2250         return "P
-0000cb80: 6c65 6173 6520 656e 7465 7220 686f 7374  lease enter host
-0000cb90: 2c70 6f72 742c 7669 7065 7274 6f6b 656e  ,port,vipertoken
-0000cba0: 2c74 6f70 6963 2c70 726f 6475 6365 7269  ,topic,produceri
-0000cbb0: 642c 7072 6570 726f 6365 7373 6c6f 6769  d,preprocesslogi
-0000cbc0: 6322 0d0a 2020 2020 2020 2020 0d0a 2020  c"..        ..  
-0000cbd0: 2020 7661 6c75 653d 2822 7072 6570 726f    value=("prepro
-0000cbe0: 6365 7373 6261 7463 683f 7669 7065 7274  cessbatch?vipert
-0000cbf0: 6f6b 656e 3d22 2b76 6970 6572 746f 6b65  oken="+vipertoke
-0000cc00: 6e20 2b20 2226 746f 7069 636e 616d 653d  n + "&topicname=
-0000cc10: 222b 746f 7069 6320 2b20 2226 6465 6c61  "+topic + "&dela
-0000cc20: 793d 2220 2b20 7374 7228 6465 6c61 7929  y=" + str(delay)
-0000cc30: 202b 2022 266d 6178 726f 7773 3d22 202b   + "&maxrows=" +
-0000cc40: 7374 7228 6d61 7872 6f77 7329 202b 0d0a  str(maxrows) +..
-0000cc50: 2020 2020 2020 2020 2020 2022 2665 6e61             "&ena
-0000cc60: 626c 6574 6c73 3d22 2b73 7472 2865 6e61  bletls="+str(ena
-0000cc70: 626c 6574 6c73 2920 2b22 2662 726f 6b65  bletls) +"&broke
-0000cc80: 7268 6f73 743d 222b 6272 6f6b 6572 686f  rhost="+brokerho
-0000cc90: 7374 202b 2022 2662 726f 6b65 7270 6f72  st + "&brokerpor
-0000cca0: 743d 222b 7374 7228 6272 6f6b 6572 706f  t="+str(brokerpo
-0000ccb0: 7274 2920 2b20 2226 7072 6f64 7563 6572  rt) + "&producer
-0000ccc0: 6964 3d22 2b70 726f 6475 6365 7269 6420  id="+producerid 
-0000ccd0: 2b0d 0a20 2020 2020 2020 2020 2020 2226  +..           "&
-0000cce0: 6f66 6673 6574 3d22 2b73 7472 286f 6666  offset="+str(off
-0000ccf0: 7365 7429 202b 2022 2674 6f70 6963 6964  set) + "&topicid
-0000cd00: 3d22 202b 2074 6f70 6963 6964 202b 2022  =" + topicid + "
-0000cd10: 2673 7472 6561 6d73 746f 6a6f 696e 3d22  &streamstojoin="
-0000cd20: 2b73 7472 6561 6d73 746f 6a6f 696e 0d0a  +streamstojoin..
-0000cd30: 2020 2020 2020 2020 2020 202b 2022 2670             + "&p
-0000cd40: 7265 7072 6f63 6573 736c 6f67 6963 3d22  reprocesslogic="
-0000cd50: 2b70 7265 7072 6f63 6573 736c 6f67 6963  +preprocesslogic
-0000cd60: 202b 2022 2670 7265 7072 6f63 6573 7363   + "&preprocessc
-0000cd70: 6f6e 6469 7469 6f6e 733d 2220 2b20 7072  onditions=" + pr
-0000cd80: 6570 726f 6365 7373 636f 6e64 6974 696f  eprocessconditio
-0000cd90: 6e73 0d0a 2020 2020 2020 2020 2020 202b  ns..           +
-0000cda0: 2022 2669 6465 6e74 6966 6965 723d 2220   "&identifier=" 
-0000cdb0: 2b20 6964 656e 7469 6669 6572 202b 2022  + identifier + "
-0000cdc0: 2670 7265 7072 6f63 6573 7374 6f70 6963  &preprocesstopic
-0000cdd0: 3d22 202b 2070 7265 7072 6f63 6573 7374  =" + preprocesst
-0000cde0: 6f70 6963 202b 2022 2661 7272 6179 3d22  opic + "&array="
-0000cdf0: 202b 2073 7472 2861 7272 6179 292b 0d0a   + str(array)+..
-0000ce00: 2020 2020 2020 2020 2020 2022 2673 6176             "&sav
-0000ce10: 6561 7361 7272 6179 3d22 202b 2073 7472  easarray=" + str
-0000ce20: 2873 6176 6561 7361 7272 6179 2920 2b20  (saveasarray) + 
-0000ce30: 2226 7469 6d65 6465 6c61 793d 2220 2b20  "&timedelay=" + 
-0000ce40: 7374 7228 7469 6d65 6465 6c61 7929 202b  str(timedelay) +
-0000ce50: 2022 2672 6177 6461 7461 6f75 7470 7574   "&rawdataoutput
-0000ce60: 3d22 202b 2073 7472 2872 6177 6461 7461  =" + str(rawdata
-0000ce70: 6f75 7470 7574 2929 0d0a 0d0a 2020 2020  output))....    
-0000ce80: 7661 6c3d 6c6f 6f70 2e72 756e 5f75 6e74  val=loop.run_unt
-0000ce90: 696c 5f63 6f6d 706c 6574 6528 7463 705f  il_complete(tcp_
-0000cea0: 6563 686f 5f63 6c69 656e 7476 6970 6572  echo_clientviper
-0000ceb0: 2876 616c 7565 2c20 6c6f 6f70 2c68 6f73  (value, loop,hos
-0000cec0: 742c 706f 7274 2c6d 6963 726f 7365 7276  t,port,microserv
-0000ced0: 6963 6569 642c 6173 796e 6374 696d 656f  iceid,asynctimeo
-0000cee0: 7574 2929 0d0a 2020 2020 6966 2063 6f6e  ut))..    if con
-0000cef0: 6e65 6374 696f 6e65 7272 6f72 3a0d 0a20  nectionerror:.. 
-0000cf00: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-0000cf10: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
-0000cf20: 0d0a 2020 2020 7265 7475 726e 2076 616c  ..    return val
-0000cf30: 0d0a 0d0a 0d0a 6465 6620 7669 7065 7263  ......def viperc
-0000cf40: 7265 6174 6574 7261 696e 696e 6764 6174  reatetrainingdat
-0000cf50: 6128 7669 7065 7274 6f6b 656e 2c68 6f73  a(vipertoken,hos
-0000cf60: 742c 706f 7274 2c63 6f6e 7375 6d65 6672  t,port,consumefr
-0000cf70: 6f6d 2c70 726f 6475 6365 746f 2c64 6570  om,produceto,dep
-0000cf80: 656e 6465 6e74 7661 7269 6162 6c65 2c69  endentvariable,i
-0000cf90: 6e64 6570 656e 6465 6e74 7661 7269 6162  ndependentvariab
-0000cfa0: 6c65 732c 0d0a 2020 2020 2020 2020 2020  les,..          
-0000cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cfc0: 2020 636f 6e73 756d 6572 6964 2c70 726f    consumerid,pro
-0000cfd0: 6475 6365 7269 642c 636f 6d70 616e 796e  ducerid,companyn
-0000cfe0: 616d 652c 7061 7274 6974 696f 6e3d 2d31  ame,partition=-1
-0000cff0: 2c65 6e61 626c 6574 6c73 3d30 2c64 656c  ,enabletls=0,del
-0000d000: 6179 3d31 3030 2c62 726f 6b65 7268 6f73  ay=100,brokerhos
-0000d010: 743d 2727 2c62 726f 6b65 7270 6f72 743d  t='',brokerport=
-0000d020: 2d39 3939 2c0d 0a20 2020 2020 2020 2020  -999,..         
-0000d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d040: 2020 206d 6963 726f 7365 7276 6963 6569     microservicei
-0000d050: 643d 2727 2c74 6f70 6963 6964 3d2d 3939  d='',topicid=-99
-0000d060: 3929 3a0d 0a20 2020 2067 6c6f 6261 6c20  9):..    global 
-0000d070: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
-0000d080: 0a0d 0a20 2020 2069 6620 286c 656e 2868  ...    if (len(h
-0000d090: 6f73 7429 3d3d 3020 6f72 206c 656e 2876  ost)==0 or len(v
-0000d0a0: 6970 6572 746f 6b65 6e29 3d3d 3020 6f72  ipertoken)==0 or
-0000d0b0: 2070 6f72 743d 3d2d 3939 3920 6f72 206c   port==-999 or l
-0000d0c0: 656e 2863 6f6e 7375 6d65 6672 6f6d 293d  en(consumefrom)=
-0000d0d0: 3d30 206f 7220 6c65 6e28 7072 6f64 7563  =0 or len(produc
-0000d0e0: 6574 6f29 3d3d 3020 6f72 206c 656e 2864  eto)==0 or len(d
-0000d0f0: 6570 656e 6465 6e74 7661 7269 6162 6c65  ependentvariable
-0000d100: 293d 3d30 206f 720d 0a20 2020 2020 2020  )==0 or..       
-0000d110: 206c 656e 2869 6e64 6570 656e 6465 6e74   len(independent
-0000d120: 7661 7269 6162 6c65 7329 3d3d 3020 6f72  variables)==0 or
-0000d130: 206c 656e 2863 6f6d 7061 6e79 6e61 6d65   len(companyname
-0000d140: 293d 3d30 206f 7220 6c65 6e28 636f 6e73  )==0 or len(cons
-0000d150: 756d 6572 6964 293d 3d30 206f 7220 6c65  umerid)==0 or le
-0000d160: 6e28 7072 6f64 7563 6572 6964 293d 3d30  n(producerid)==0
-0000d170: 293a 0d0a 2020 2020 2020 2020 2072 6574  ):..         ret
-0000d180: 7572 6e20 2250 6c65 6173 6520 656e 7465  urn "Please ente
-0000d190: 7220 686f 7374 2c70 6f72 742c 7669 7065  r host,port,vipe
-0000d1a0: 7274 6f6b 656e 2c63 6f6e 7375 6d65 6672  rtoken,consumefr
-0000d1b0: 6f6d 2c70 726f 6475 6365 746f 2c63 6f6d  om,produceto,com
-0000d1c0: 7061 6e79 6e61 6d65 2c63 6f6e 7375 6d65  panyname,consume
-0000d1d0: 7269 642c 7072 6f64 7563 6572 6964 220d  rid,producerid".
-0000d1e0: 0a20 2020 2020 2020 200d 0a20 2020 2076  .        ..    v
-0000d1f0: 616c 7565 3d28 2263 7265 6174 6574 7261  alue=("createtra
-0000d200: 696e 696e 6764 6174 613f 7669 7065 7274  iningdata?vipert
-0000d210: 6f6b 656e 3d22 2b76 6970 6572 746f 6b65  oken="+vipertoke
-0000d220: 6e20 2b20 2226 636f 6e73 756d 6566 726f  n + "&consumefro
-0000d230: 6d3d 222b 636f 6e73 756d 6566 726f 6d20  m="+consumefrom 
-0000d240: 2b20 2226 7072 6f64 7563 6574 6f3d 222b  + "&produceto="+
-0000d250: 7072 6f64 7563 6574 6f20 2b0d 0a20 2020  produceto +..   
-0000d260: 2020 2020 2020 2020 2226 6465 7065 6e64          "&depend
-0000d270: 656e 7476 6172 6961 626c 653d 222b 6465  entvariable="+de
-0000d280: 7065 6e64 656e 7476 6172 6961 626c 652b  pendentvariable+
-0000d290: 2226 696e 6465 7065 6e64 656e 7476 6172  "&independentvar
-0000d2a0: 6961 626c 6573 3d22 2b69 6e64 6570 656e  iables="+indepen
-0000d2b0: 6465 6e74 7661 7269 6162 6c65 7320 2b0d  dentvariables +.
-0000d2c0: 0a20 2020 2020 2020 2020 2020 2226 6465  .           "&de
-0000d2d0: 6c61 793d 2220 2b20 7374 7228 6465 6c61  lay=" + str(dela
-0000d2e0: 7929 202b 2022 2665 6e61 626c 6574 6c73  y) + "&enabletls
-0000d2f0: 3d22 202b 2073 7472 2865 6e61 626c 6574  =" + str(enablet
-0000d300: 6c73 2920 2b20 2226 7061 7274 6974 696f  ls) + "&partitio
-0000d310: 6e3d 222b 7374 7228 7061 7274 6974 696f  n="+str(partitio
-0000d320: 6e29 2b22 2663 6f6e 7375 6d65 7269 643d  n)+"&consumerid=
-0000d330: 222b 636f 6e73 756d 6572 6964 202b 0d0a  "+consumerid +..
-0000d340: 2020 2020 2020 2020 2020 2022 2670 726f             "&pro
-0000d350: 6475 6365 7269 643d 222b 7072 6f64 7563  ducerid="+produc
-0000d360: 6572 6964 2b22 2663 6f6d 7061 6e79 6e61  erid+"&companyna
-0000d370: 6d65 3d22 2b63 6f6d 7061 6e79 6e61 6d65  me="+companyname
-0000d380: 202b 2022 2662 726f 6b65 7268 6f73 743d   + "&brokerhost=
-0000d390: 222b 6272 6f6b 6572 686f 7374 202b 0d0a  "+brokerhost +..
-0000d3a0: 2020 2020 2020 2020 2020 2022 2662 726f             "&bro
-0000d3b0: 6b65 7270 6f72 743d 222b 7374 7228 6272  kerport="+str(br
-0000d3c0: 6f6b 6572 706f 7274 2920 2b20 2226 746f  okerport) + "&to
-0000d3d0: 7069 6369 643d 2220 2b20 7374 7228 746f  picid=" + str(to
-0000d3e0: 7069 6369 6429 290d 0a0d 0a20 2020 2076  picid))....    v
-0000d3f0: 616c 3d6c 6f6f 702e 7275 6e5f 756e 7469  al=loop.run_unti
-0000d400: 6c5f 636f 6d70 6c65 7465 2874 6370 5f65  l_complete(tcp_e
-0000d410: 6368 6f5f 636c 6965 6e74 7669 7065 7228  cho_clientviper(
-0000d420: 7661 6c75 652c 206c 6f6f 702c 686f 7374  value, loop,host
-0000d430: 2c70 6f72 742c 6d69 6372 6f73 6572 7669  ,port,microservi
-0000d440: 6365 6964 2929 0d0a 2020 2020 6966 2063  ceid))..    if c
-0000d450: 6f6e 6e65 6374 696f 6e65 7272 6f72 3a0d  onnectionerror:.
-0000d460: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
-0000d470: 2063 6f6e 6e65 6374 696f 6e65 7272 6f72   connectionerror
-0000d480: 0d0a 0d0a 2020 2020 7265 7475 726e 2076  ....    return v
-0000d490: 616c 0d0a 0d0a 6465 6620 7669 7065 7263  al....def viperc
-0000d4a0: 7265 6174 6574 6f70 6963 2876 6970 6572  reatetopic(viper
-0000d4b0: 746f 6b65 6e2c 686f 7374 2c70 6f72 742c  token,host,port,
-0000d4c0: 746f 7069 632c 636f 6d70 616e 796e 616d  topic,companynam
-0000d4d0: 652c 636f 6e74 6163 746e 616d 652c 636f  e,contactname,co
-0000d4e0: 6e74 6163 7465 6d61 696c 2c6c 6f63 6174  ntactemail,locat
-0000d4f0: 696f 6e2c 6465 7363 7269 7074 696f 6e2c  ion,description,
-0000d500: 656e 6162 6c65 746c 733d 302c 6272 6f6b  enabletls=0,brok
-0000d510: 6572 686f 7374 3d27 272c 6272 6f6b 6572  erhost='',broker
-0000d520: 706f 7274 3d2d 3939 392c 6e75 6d70 6172  port=-999,numpar
-0000d530: 7469 7469 6f6e 733d 312c 7265 706c 6963  titions=1,replic
-0000d540: 6174 696f 6e3d 312c 6d69 6372 6f73 6572  ation=1,microser
-0000d550: 7669 6365 6964 3d27 2729 3a0d 0a20 2020  viceid=''):..   
-0000d560: 2067 6c6f 6261 6c20 636f 6e6e 6563 7469   global connecti
-0000d570: 6f6e 6572 726f 720d 0a20 2020 200d 0a20  onerror..    .. 
-0000d580: 2020 2069 6620 6c65 6e28 686f 7374 293d     if len(host)=
-0000d590: 3d30 206f 7220 6c65 6e28 7669 7065 7274  =0 or len(vipert
-0000d5a0: 6f6b 656e 293d 3d30 206f 7220 706f 7274  oken)==0 or port
-0000d5b0: 3d3d 2d39 3939 206f 7220 6c65 6e28 746f  ==-999 or len(to
-0000d5c0: 7069 6329 3d3d 3020 6f72 206c 656e 2863  pic)==0 or len(c
-0000d5d0: 6f6d 7061 6e79 6e61 6d65 293d 3d30 206f  ompanyname)==0 o
-0000d5e0: 7220 6c65 6e28 636f 6e74 6163 746e 616d  r len(contactnam
-0000d5f0: 6529 3d3d 3020 6f72 206c 656e 2863 6f6e  e)==0 or len(con
-0000d600: 7461 6374 656d 6169 6c29 3d3d 3020 6f72  tactemail)==0 or
-0000d610: 206c 656e 286c 6f63 6174 696f 6e29 3d3d   len(location)==
-0000d620: 3020 6f72 206c 656e 2864 6573 6372 6970  0 or len(descrip
-0000d630: 7469 6f6e 293d 3d30 3a0d 0a20 2020 2020  tion)==0:..     
-0000d640: 2020 2020 7265 7475 726e 2022 506c 6561      return "Plea
-0000d650: 7365 2065 6e74 6572 2068 6f73 742c 706f  se enter host,po
-0000d660: 7274 2c76 6970 6572 746f 6b65 6e2c 746f  rt,vipertoken,to
-0000d670: 7069 632c 2063 6f6d 7061 6e79 6e61 6d65  pic, companyname
-0000d680: 2c63 6f6e 7461 6374 6e61 6d65 2c63 6f6e  ,contactname,con
-0000d690: 7461 6374 656d 6169 6c2c 6c6f 6361 7469  tactemail,locati
-0000d6a0: 6f6e 2061 6e64 2064 6573 6372 6970 7469  on and descripti
-0000d6b0: 6f6e 220d 0a20 2020 2020 2020 200d 0a20  on"..        .. 
-0000d6c0: 2020 2076 616c 7565 3d28 2263 7265 6174     value=("creat
-0000d6d0: 6574 6f70 6963 733f 7669 7065 7274 6f6b  etopics?vipertok
-0000d6e0: 656e 3d22 2b76 6970 6572 746f 6b65 6e20  en="+vipertoken 
-0000d6f0: 2b20 2226 746f 7069 633d 222b 746f 7069  + "&topic="+topi
-0000d700: 6320 2b20 2226 636f 6d70 616e 796e 616d  c + "&companynam
-0000d710: 653d 2220 2b20 636f 6d70 616e 796e 616d  e=" + companynam
-0000d720: 6520 2b20 2226 636f 6e74 6163 746e 616d  e + "&contactnam
-0000d730: 653d 222b 636f 6e74 6163 746e 616d 6520  e="+contactname 
-0000d740: 2b0d 0a20 2020 2020 2020 2020 2020 2226  +..           "&
-0000d750: 636f 6e74 6163 7465 6d61 696c 3d22 2b63  contactemail="+c
-0000d760: 6f6e 7461 6374 656d 6169 6c20 2b20 2226  ontactemail + "&
-0000d770: 6c6f 6361 7469 6f6e 3d22 2b6c 6f63 6174  location="+locat
-0000d780: 696f 6e2b 2226 6465 7363 7269 7074 696f  ion+"&descriptio
-0000d790: 6e3d 222b 6465 7363 7269 7074 696f 6e2b  n="+description+
-0000d7a0: 2022 2665 6e61 626c 6574 6c73 3d22 2b73   "&enabletls="+s
-0000d7b0: 7472 2865 6e61 626c 6574 6c73 2920 2b20  tr(enabletls) + 
-0000d7c0: 2226 6e75 6d70 6172 7469 7469 6f6e 733d  "&numpartitions=
-0000d7d0: 222b 7374 7228 6e75 6d70 6172 7469 7469  "+str(numpartiti
-0000d7e0: 6f6e 7329 2b0d 0a20 2020 2020 2020 2020  ons)+..         
-0000d7f0: 2020 2226 7265 706c 6963 6174 696f 6e66    "&replicationf
-0000d800: 6163 746f 723d 222b 7374 7228 7265 706c  actor="+str(repl
-0000d810: 6963 6174 696f 6e29 202b 2022 2662 726f  ication) + "&bro
-0000d820: 6b65 7268 6f73 743d 222b 6272 6f6b 6572  kerhost="+broker
-0000d830: 686f 7374 202b 2022 2662 726f 6b65 7270  host + "&brokerp
-0000d840: 6f72 743d 2220 2b20 7374 7228 6272 6f6b  ort=" + str(brok
-0000d850: 6572 706f 7274 2920 290d 0a0d 0a0d 0a20  erport) )...... 
-0000d860: 2020 2076 616c 3d6c 6f6f 702e 7275 6e5f     val=loop.run_
-0000d870: 756e 7469 6c5f 636f 6d70 6c65 7465 2874  until_complete(t
-0000d880: 6370 5f65 6368 6f5f 636c 6965 6e74 7669  cp_echo_clientvi
-0000d890: 7065 7228 7661 6c75 652c 206c 6f6f 702c  per(value, loop,
-0000d8a0: 686f 7374 2c70 6f72 742c 6d69 6372 6f73  host,port,micros
-0000d8b0: 6572 7669 6365 6964 2929 0d0a 2020 2020  erviceid))..    
-0000d8c0: 6966 2063 6f6e 6e65 6374 696f 6e65 7272  if connectionerr
-0000d8d0: 6f72 3a0d 0a20 2020 2020 2020 2020 7265  or:..         re
-0000d8e0: 7475 726e 2063 6f6e 6e65 6374 696f 6e65  turn connectione
-0000d8f0: 7272 6f72 0d0a 0d0a 2020 2020 7265 7475  rror....    retu
-0000d900: 726e 2076 616c 0d0a 0d0a 6465 6620 7669  rn val....def vi
-0000d910: 7065 7263 6f6e 7375 6d65 6672 6f6d 7374  perconsumefromst
-0000d920: 7265 616d 746f 7069 6328 7669 7065 7274  reamtopic(vipert
-0000d930: 6f6b 656e 2c68 6f73 742c 706f 7274 2c74  oken,host,port,t
-0000d940: 6f70 6963 2c63 6f6e 7375 6d65 7269 642c  opic,consumerid,
-0000d950: 636f 6d70 616e 796e 616d 652c 7061 7274  companyname,part
-0000d960: 6974 696f 6e3d 2d31 2c65 6e61 626c 6574  ition=-1,enablet
-0000d970: 6c73 3d30 2c64 656c 6179 3d31 3030 2c6f  ls=0,delay=100,o
-0000d980: 6666 7365 743d 302c 0d0a 2020 2020 2020  ffset=0,..      
+0000ca80: 2020 6172 7261 793d 302c 7361 7665 6173    array=0,saveas
+0000ca90: 6172 7261 793d 302c 7469 6d65 6465 6c61  array=0,timedela
+0000caa0: 793d 302c 6173 796e 6374 696d 656f 7574  y=0,asynctimeout
+0000cab0: 3d31 3230 2c72 6177 6461 7461 6f75 7470  =120,rawdataoutp
+0000cac0: 7574 3d30 293a 0d0a 2020 2020 676c 6f62  ut=0):..    glob
+0000cad0: 616c 2063 6f6e 6e65 6374 696f 6e65 7272  al connectionerr
+0000cae0: 6f72 0d0a 0d0a 2020 2020 6966 2028 6c65  or....    if (le
+0000caf0: 6e28 686f 7374 293d 3d30 206f 7220 6c65  n(host)==0 or le
+0000cb00: 6e28 7669 7065 7274 6f6b 656e 293d 3d30  n(vipertoken)==0
+0000cb10: 206f 7220 706f 7274 3d3d 2d39 3939 206f   or port==-999 o
+0000cb20: 7220 6c65 6e28 746f 7069 6329 3d3d 3020  r len(topic)==0 
+0000cb30: 6f72 206c 656e 2870 726f 6475 6365 7269  or len(produceri
+0000cb40: 6429 3d3d 3020 6f72 206c 656e 2870 7265  d)==0 or len(pre
+0000cb50: 7072 6f63 6573 736c 6f67 6963 293d 3d30  processlogic)==0
+0000cb60: 293a 0d0a 2020 2020 2020 2020 2072 6574  ):..         ret
+0000cb70: 7572 6e20 2250 6c65 6173 6520 656e 7465  urn "Please ente
+0000cb80: 7220 686f 7374 2c70 6f72 742c 7669 7065  r host,port,vipe
+0000cb90: 7274 6f6b 656e 2c74 6f70 6963 2c70 726f  rtoken,topic,pro
+0000cba0: 6475 6365 7269 642c 7072 6570 726f 6365  ducerid,preproce
+0000cbb0: 7373 6c6f 6769 6322 0d0a 2020 2020 2020  sslogic"..      
+0000cbc0: 2020 0d0a 2020 2020 7661 6c75 653d 2822    ..    value=("
+0000cbd0: 7072 6570 726f 6365 7373 6261 7463 683f  preprocessbatch?
+0000cbe0: 7669 7065 7274 6f6b 656e 3d22 2b76 6970  vipertoken="+vip
+0000cbf0: 6572 746f 6b65 6e20 2b20 2226 746f 7069  ertoken + "&topi
+0000cc00: 636e 616d 653d 222b 746f 7069 6320 2b20  cname="+topic + 
+0000cc10: 2226 6465 6c61 793d 2220 2b20 7374 7228  "&delay=" + str(
+0000cc20: 6465 6c61 7929 202b 2022 266d 6178 726f  delay) + "&maxro
+0000cc30: 7773 3d22 202b 7374 7228 6d61 7872 6f77  ws=" +str(maxrow
+0000cc40: 7329 202b 0d0a 2020 2020 2020 2020 2020  s) +..          
+0000cc50: 2022 2665 6e61 626c 6574 6c73 3d22 2b73   "&enabletls="+s
+0000cc60: 7472 2865 6e61 626c 6574 6c73 2920 2b22  tr(enabletls) +"
+0000cc70: 2662 726f 6b65 7268 6f73 743d 222b 6272  &brokerhost="+br
+0000cc80: 6f6b 6572 686f 7374 202b 2022 2662 726f  okerhost + "&bro
+0000cc90: 6b65 7270 6f72 743d 222b 7374 7228 6272  kerport="+str(br
+0000cca0: 6f6b 6572 706f 7274 2920 2b20 2226 7072  okerport) + "&pr
+0000ccb0: 6f64 7563 6572 6964 3d22 2b70 726f 6475  oducerid="+produ
+0000ccc0: 6365 7269 6420 2b0d 0a20 2020 2020 2020  cerid +..       
+0000ccd0: 2020 2020 2226 6f66 6673 6574 3d22 2b73      "&offset="+s
+0000cce0: 7472 286f 6666 7365 7429 202b 2022 2674  tr(offset) + "&t
+0000ccf0: 6f70 6963 6964 3d22 202b 2074 6f70 6963  opicid=" + topic
+0000cd00: 6964 202b 2022 2673 7472 6561 6d73 746f  id + "&streamsto
+0000cd10: 6a6f 696e 3d22 2b73 7472 6561 6d73 746f  join="+streamsto
+0000cd20: 6a6f 696e 0d0a 2020 2020 2020 2020 2020  join..          
+0000cd30: 202b 2022 2670 7265 7072 6f63 6573 736c   + "&preprocessl
+0000cd40: 6f67 6963 3d22 2b70 7265 7072 6f63 6573  ogic="+preproces
+0000cd50: 736c 6f67 6963 202b 2022 2670 7265 7072  slogic + "&prepr
+0000cd60: 6f63 6573 7363 6f6e 6469 7469 6f6e 733d  ocessconditions=
+0000cd70: 2220 2b20 7072 6570 726f 6365 7373 636f  " + preprocessco
+0000cd80: 6e64 6974 696f 6e73 0d0a 2020 2020 2020  nditions..      
+0000cd90: 2020 2020 202b 2022 2669 6465 6e74 6966       + "&identif
+0000cda0: 6965 723d 2220 2b20 6964 656e 7469 6669  ier=" + identifi
+0000cdb0: 6572 202b 2022 2670 7265 7072 6f63 6573  er + "&preproces
+0000cdc0: 7374 6f70 6963 3d22 202b 2070 7265 7072  stopic=" + prepr
+0000cdd0: 6f63 6573 7374 6f70 6963 202b 2022 2661  ocesstopic + "&a
+0000cde0: 7272 6179 3d22 202b 2073 7472 2861 7272  rray=" + str(arr
+0000cdf0: 6179 292b 0d0a 2020 2020 2020 2020 2020  ay)+..          
+0000ce00: 2022 2673 6176 6561 7361 7272 6179 3d22   "&saveasarray="
+0000ce10: 202b 2073 7472 2873 6176 6561 7361 7272   + str(saveasarr
+0000ce20: 6179 2920 2b20 2226 7469 6d65 6465 6c61  ay) + "&timedela
+0000ce30: 793d 2220 2b20 7374 7228 7469 6d65 6465  y=" + str(timede
+0000ce40: 6c61 7929 202b 2022 2672 6177 6461 7461  lay) + "&rawdata
+0000ce50: 6f75 7470 7574 3d22 202b 2073 7472 2872  output=" + str(r
+0000ce60: 6177 6461 7461 6f75 7470 7574 2929 0d0a  awdataoutput))..
+0000ce70: 0d0a 2020 2020 7661 6c3d 6c6f 6f70 2e72  ..    val=loop.r
+0000ce80: 756e 5f75 6e74 696c 5f63 6f6d 706c 6574  un_until_complet
+0000ce90: 6528 7463 705f 6563 686f 5f63 6c69 656e  e(tcp_echo_clien
+0000cea0: 7476 6970 6572 2876 616c 7565 2c20 6c6f  tviper(value, lo
+0000ceb0: 6f70 2c68 6f73 742c 706f 7274 2c6d 6963  op,host,port,mic
+0000cec0: 726f 7365 7276 6963 6569 642c 6173 796e  roserviceid,asyn
+0000ced0: 6374 696d 656f 7574 2929 0d0a 2020 2020  ctimeout))..    
+0000cee0: 6966 2063 6f6e 6e65 6374 696f 6e65 7272  if connectionerr
+0000cef0: 6f72 3a0d 0a20 2020 2020 2020 2020 7265  or:..         re
+0000cf00: 7475 726e 2063 6f6e 6e65 6374 696f 6e65  turn connectione
+0000cf10: 7272 6f72 0d0a 0d0a 2020 2020 7265 7475  rror....    retu
+0000cf20: 726e 2076 616c 0d0a 0d0a 0d0a 6465 6620  rn val......def 
+0000cf30: 7669 7065 7263 7265 6174 6574 7261 696e  vipercreatetrain
+0000cf40: 696e 6764 6174 6128 7669 7065 7274 6f6b  ingdata(vipertok
+0000cf50: 656e 2c68 6f73 742c 706f 7274 2c63 6f6e  en,host,port,con
+0000cf60: 7375 6d65 6672 6f6d 2c70 726f 6475 6365  sumefrom,produce
+0000cf70: 746f 2c64 6570 656e 6465 6e74 7661 7269  to,dependentvari
+0000cf80: 6162 6c65 2c69 6e64 6570 656e 6465 6e74  able,independent
+0000cf90: 7661 7269 6162 6c65 732c 0d0a 2020 2020  variables,..    
+0000cfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cfb0: 2020 2020 2020 2020 636f 6e73 756d 6572          consumer
+0000cfc0: 6964 2c70 726f 6475 6365 7269 642c 636f  id,producerid,co
+0000cfd0: 6d70 616e 796e 616d 652c 7061 7274 6974  mpanyname,partit
+0000cfe0: 696f 6e3d 2d31 2c65 6e61 626c 6574 6c73  ion=-1,enabletls
+0000cff0: 3d30 2c64 656c 6179 3d31 3030 2c62 726f  =0,delay=100,bro
+0000d000: 6b65 7268 6f73 743d 2727 2c62 726f 6b65  kerhost='',broke
+0000d010: 7270 6f72 743d 2d39 3939 2c0d 0a20 2020  rport=-999,..   
+0000d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d030: 2020 2020 2020 2020 206d 6963 726f 7365           microse
+0000d040: 7276 6963 6569 643d 2727 2c74 6f70 6963  rviceid='',topic
+0000d050: 6964 3d2d 3939 3929 3a0d 0a20 2020 2067  id=-999):..    g
+0000d060: 6c6f 6261 6c20 636f 6e6e 6563 7469 6f6e  lobal connection
+0000d070: 6572 726f 720d 0a0d 0a20 2020 2069 6620  error....    if 
+0000d080: 286c 656e 2868 6f73 7429 3d3d 3020 6f72  (len(host)==0 or
+0000d090: 206c 656e 2876 6970 6572 746f 6b65 6e29   len(vipertoken)
+0000d0a0: 3d3d 3020 6f72 2070 6f72 743d 3d2d 3939  ==0 or port==-99
+0000d0b0: 3920 6f72 206c 656e 2863 6f6e 7375 6d65  9 or len(consume
+0000d0c0: 6672 6f6d 293d 3d30 206f 7220 6c65 6e28  from)==0 or len(
+0000d0d0: 7072 6f64 7563 6574 6f29 3d3d 3020 6f72  produceto)==0 or
+0000d0e0: 206c 656e 2864 6570 656e 6465 6e74 7661   len(dependentva
+0000d0f0: 7269 6162 6c65 293d 3d30 206f 720d 0a20  riable)==0 or.. 
+0000d100: 2020 2020 2020 206c 656e 2869 6e64 6570         len(indep
+0000d110: 656e 6465 6e74 7661 7269 6162 6c65 7329  endentvariables)
+0000d120: 3d3d 3020 6f72 206c 656e 2863 6f6d 7061  ==0 or len(compa
+0000d130: 6e79 6e61 6d65 293d 3d30 206f 7220 6c65  nyname)==0 or le
+0000d140: 6e28 636f 6e73 756d 6572 6964 293d 3d30  n(consumerid)==0
+0000d150: 206f 7220 6c65 6e28 7072 6f64 7563 6572   or len(producer
+0000d160: 6964 293d 3d30 293a 0d0a 2020 2020 2020  id)==0):..      
+0000d170: 2020 2072 6574 7572 6e20 2250 6c65 6173     return "Pleas
+0000d180: 6520 656e 7465 7220 686f 7374 2c70 6f72  e enter host,por
+0000d190: 742c 7669 7065 7274 6f6b 656e 2c63 6f6e  t,vipertoken,con
+0000d1a0: 7375 6d65 6672 6f6d 2c70 726f 6475 6365  sumefrom,produce
+0000d1b0: 746f 2c63 6f6d 7061 6e79 6e61 6d65 2c63  to,companyname,c
+0000d1c0: 6f6e 7375 6d65 7269 642c 7072 6f64 7563  onsumerid,produc
+0000d1d0: 6572 6964 220d 0a20 2020 2020 2020 200d  erid"..        .
+0000d1e0: 0a20 2020 2076 616c 7565 3d28 2263 7265  .    value=("cre
+0000d1f0: 6174 6574 7261 696e 696e 6764 6174 613f  atetrainingdata?
+0000d200: 7669 7065 7274 6f6b 656e 3d22 2b76 6970  vipertoken="+vip
+0000d210: 6572 746f 6b65 6e20 2b20 2226 636f 6e73  ertoken + "&cons
+0000d220: 756d 6566 726f 6d3d 222b 636f 6e73 756d  umefrom="+consum
+0000d230: 6566 726f 6d20 2b20 2226 7072 6f64 7563  efrom + "&produc
+0000d240: 6574 6f3d 222b 7072 6f64 7563 6574 6f20  eto="+produceto 
+0000d250: 2b0d 0a20 2020 2020 2020 2020 2020 2226  +..           "&
+0000d260: 6465 7065 6e64 656e 7476 6172 6961 626c  dependentvariabl
+0000d270: 653d 222b 6465 7065 6e64 656e 7476 6172  e="+dependentvar
+0000d280: 6961 626c 652b 2226 696e 6465 7065 6e64  iable+"&independ
+0000d290: 656e 7476 6172 6961 626c 6573 3d22 2b69  entvariables="+i
+0000d2a0: 6e64 6570 656e 6465 6e74 7661 7269 6162  ndependentvariab
+0000d2b0: 6c65 7320 2b0d 0a20 2020 2020 2020 2020  les +..         
+0000d2c0: 2020 2226 6465 6c61 793d 2220 2b20 7374    "&delay=" + st
+0000d2d0: 7228 6465 6c61 7929 202b 2022 2665 6e61  r(delay) + "&ena
+0000d2e0: 626c 6574 6c73 3d22 202b 2073 7472 2865  bletls=" + str(e
+0000d2f0: 6e61 626c 6574 6c73 2920 2b20 2226 7061  nabletls) + "&pa
+0000d300: 7274 6974 696f 6e3d 222b 7374 7228 7061  rtition="+str(pa
+0000d310: 7274 6974 696f 6e29 2b22 2663 6f6e 7375  rtition)+"&consu
+0000d320: 6d65 7269 643d 222b 636f 6e73 756d 6572  merid="+consumer
+0000d330: 6964 202b 0d0a 2020 2020 2020 2020 2020  id +..          
+0000d340: 2022 2670 726f 6475 6365 7269 643d 222b   "&producerid="+
+0000d350: 7072 6f64 7563 6572 6964 2b22 2663 6f6d  producerid+"&com
+0000d360: 7061 6e79 6e61 6d65 3d22 2b63 6f6d 7061  panyname="+compa
+0000d370: 6e79 6e61 6d65 202b 2022 2662 726f 6b65  nyname + "&broke
+0000d380: 7268 6f73 743d 222b 6272 6f6b 6572 686f  rhost="+brokerho
+0000d390: 7374 202b 0d0a 2020 2020 2020 2020 2020  st +..          
+0000d3a0: 2022 2662 726f 6b65 7270 6f72 743d 222b   "&brokerport="+
+0000d3b0: 7374 7228 6272 6f6b 6572 706f 7274 2920  str(brokerport) 
+0000d3c0: 2b20 2226 746f 7069 6369 643d 2220 2b20  + "&topicid=" + 
+0000d3d0: 7374 7228 746f 7069 6369 6429 290d 0a0d  str(topicid))...
+0000d3e0: 0a20 2020 2076 616c 3d6c 6f6f 702e 7275  .    val=loop.ru
+0000d3f0: 6e5f 756e 7469 6c5f 636f 6d70 6c65 7465  n_until_complete
+0000d400: 2874 6370 5f65 6368 6f5f 636c 6965 6e74  (tcp_echo_client
+0000d410: 7669 7065 7228 7661 6c75 652c 206c 6f6f  viper(value, loo
+0000d420: 702c 686f 7374 2c70 6f72 742c 6d69 6372  p,host,port,micr
+0000d430: 6f73 6572 7669 6365 6964 2929 0d0a 2020  oserviceid))..  
+0000d440: 2020 6966 2063 6f6e 6e65 6374 696f 6e65    if connectione
+0000d450: 7272 6f72 3a0d 0a20 2020 2020 2020 2020  rror:..         
+0000d460: 7265 7475 726e 2063 6f6e 6e65 6374 696f  return connectio
+0000d470: 6e65 7272 6f72 0d0a 0d0a 2020 2020 7265  nerror....    re
+0000d480: 7475 726e 2076 616c 0d0a 0d0a 6465 6620  turn val....def 
+0000d490: 7669 7065 7263 7265 6174 6574 6f70 6963  vipercreatetopic
+0000d4a0: 2876 6970 6572 746f 6b65 6e2c 686f 7374  (vipertoken,host
+0000d4b0: 2c70 6f72 742c 746f 7069 632c 636f 6d70  ,port,topic,comp
+0000d4c0: 616e 796e 616d 652c 636f 6e74 6163 746e  anyname,contactn
+0000d4d0: 616d 652c 636f 6e74 6163 7465 6d61 696c  ame,contactemail
+0000d4e0: 2c6c 6f63 6174 696f 6e2c 6465 7363 7269  ,location,descri
+0000d4f0: 7074 696f 6e2c 656e 6162 6c65 746c 733d  ption,enabletls=
+0000d500: 302c 6272 6f6b 6572 686f 7374 3d27 272c  0,brokerhost='',
+0000d510: 6272 6f6b 6572 706f 7274 3d2d 3939 392c  brokerport=-999,
+0000d520: 6e75 6d70 6172 7469 7469 6f6e 733d 312c  numpartitions=1,
+0000d530: 7265 706c 6963 6174 696f 6e3d 312c 6d69  replication=1,mi
+0000d540: 6372 6f73 6572 7669 6365 6964 3d27 2729  croserviceid='')
+0000d550: 3a0d 0a20 2020 2067 6c6f 6261 6c20 636f  :..    global co
+0000d560: 6e6e 6563 7469 6f6e 6572 726f 720d 0a20  nnectionerror.. 
+0000d570: 2020 200d 0a20 2020 2069 6620 6c65 6e28     ..    if len(
+0000d580: 686f 7374 293d 3d30 206f 7220 6c65 6e28  host)==0 or len(
+0000d590: 7669 7065 7274 6f6b 656e 293d 3d30 206f  vipertoken)==0 o
+0000d5a0: 7220 706f 7274 3d3d 2d39 3939 206f 7220  r port==-999 or 
+0000d5b0: 6c65 6e28 746f 7069 6329 3d3d 3020 6f72  len(topic)==0 or
+0000d5c0: 206c 656e 2863 6f6d 7061 6e79 6e61 6d65   len(companyname
+0000d5d0: 293d 3d30 206f 7220 6c65 6e28 636f 6e74  )==0 or len(cont
+0000d5e0: 6163 746e 616d 6529 3d3d 3020 6f72 206c  actname)==0 or l
+0000d5f0: 656e 2863 6f6e 7461 6374 656d 6169 6c29  en(contactemail)
+0000d600: 3d3d 3020 6f72 206c 656e 286c 6f63 6174  ==0 or len(locat
+0000d610: 696f 6e29 3d3d 3020 6f72 206c 656e 2864  ion)==0 or len(d
+0000d620: 6573 6372 6970 7469 6f6e 293d 3d30 3a0d  escription)==0:.
+0000d630: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
+0000d640: 2022 506c 6561 7365 2065 6e74 6572 2068   "Please enter h
+0000d650: 6f73 742c 706f 7274 2c76 6970 6572 746f  ost,port,viperto
+0000d660: 6b65 6e2c 746f 7069 632c 2063 6f6d 7061  ken,topic, compa
+0000d670: 6e79 6e61 6d65 2c63 6f6e 7461 6374 6e61  nyname,contactna
+0000d680: 6d65 2c63 6f6e 7461 6374 656d 6169 6c2c  me,contactemail,
+0000d690: 6c6f 6361 7469 6f6e 2061 6e64 2064 6573  location and des
+0000d6a0: 6372 6970 7469 6f6e 220d 0a20 2020 2020  cription"..     
+0000d6b0: 2020 200d 0a20 2020 2076 616c 7565 3d28     ..    value=(
+0000d6c0: 2263 7265 6174 6574 6f70 6963 733f 7669  "createtopics?vi
+0000d6d0: 7065 7274 6f6b 656e 3d22 2b76 6970 6572  pertoken="+viper
+0000d6e0: 746f 6b65 6e20 2b20 2226 746f 7069 633d  token + "&topic=
+0000d6f0: 222b 746f 7069 6320 2b20 2226 636f 6d70  "+topic + "&comp
+0000d700: 616e 796e 616d 653d 2220 2b20 636f 6d70  anyname=" + comp
+0000d710: 616e 796e 616d 6520 2b20 2226 636f 6e74  anyname + "&cont
+0000d720: 6163 746e 616d 653d 222b 636f 6e74 6163  actname="+contac
+0000d730: 746e 616d 6520 2b0d 0a20 2020 2020 2020  tname +..       
+0000d740: 2020 2020 2226 636f 6e74 6163 7465 6d61      "&contactema
+0000d750: 696c 3d22 2b63 6f6e 7461 6374 656d 6169  il="+contactemai
+0000d760: 6c20 2b20 2226 6c6f 6361 7469 6f6e 3d22  l + "&location="
+0000d770: 2b6c 6f63 6174 696f 6e2b 2226 6465 7363  +location+"&desc
+0000d780: 7269 7074 696f 6e3d 222b 6465 7363 7269  ription="+descri
+0000d790: 7074 696f 6e2b 2022 2665 6e61 626c 6574  ption+ "&enablet
+0000d7a0: 6c73 3d22 2b73 7472 2865 6e61 626c 6574  ls="+str(enablet
+0000d7b0: 6c73 2920 2b20 2226 6e75 6d70 6172 7469  ls) + "&numparti
+0000d7c0: 7469 6f6e 733d 222b 7374 7228 6e75 6d70  tions="+str(nump
+0000d7d0: 6172 7469 7469 6f6e 7329 2b0d 0a20 2020  artitions)+..   
+0000d7e0: 2020 2020 2020 2020 2226 7265 706c 6963          "&replic
+0000d7f0: 6174 696f 6e66 6163 746f 723d 222b 7374  ationfactor="+st
+0000d800: 7228 7265 706c 6963 6174 696f 6e29 202b  r(replication) +
+0000d810: 2022 2662 726f 6b65 7268 6f73 743d 222b   "&brokerhost="+
+0000d820: 6272 6f6b 6572 686f 7374 202b 2022 2662  brokerhost + "&b
+0000d830: 726f 6b65 7270 6f72 743d 2220 2b20 7374  rokerport=" + st
+0000d840: 7228 6272 6f6b 6572 706f 7274 2920 290d  r(brokerport) ).
+0000d850: 0a0d 0a0d 0a20 2020 2076 616c 3d6c 6f6f  .....    val=loo
+0000d860: 702e 7275 6e5f 756e 7469 6c5f 636f 6d70  p.run_until_comp
+0000d870: 6c65 7465 2874 6370 5f65 6368 6f5f 636c  lete(tcp_echo_cl
+0000d880: 6965 6e74 7669 7065 7228 7661 6c75 652c  ientviper(value,
+0000d890: 206c 6f6f 702c 686f 7374 2c70 6f72 742c   loop,host,port,
+0000d8a0: 6d69 6372 6f73 6572 7669 6365 6964 2929  microserviceid))
+0000d8b0: 0d0a 2020 2020 6966 2063 6f6e 6e65 6374  ..    if connect
+0000d8c0: 696f 6e65 7272 6f72 3a0d 0a20 2020 2020  ionerror:..     
+0000d8d0: 2020 2020 7265 7475 726e 2063 6f6e 6e65      return conne
+0000d8e0: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
+0000d8f0: 2020 7265 7475 726e 2076 616c 0d0a 0d0a    return val....
+0000d900: 6465 6620 7669 7065 7263 6f6e 7375 6d65  def viperconsume
+0000d910: 6672 6f6d 7374 7265 616d 746f 7069 6328  fromstreamtopic(
+0000d920: 7669 7065 7274 6f6b 656e 2c68 6f73 742c  vipertoken,host,
+0000d930: 706f 7274 2c74 6f70 6963 2c63 6f6e 7375  port,topic,consu
+0000d940: 6d65 7269 642c 636f 6d70 616e 796e 616d  merid,companynam
+0000d950: 652c 7061 7274 6974 696f 6e3d 2d31 2c65  e,partition=-1,e
+0000d960: 6e61 626c 6574 6c73 3d30 2c64 656c 6179  nabletls=0,delay
+0000d970: 3d31 3030 2c6f 6666 7365 743d 302c 0d0a  =100,offset=0,..
+0000d980: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000d990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d9a0: 2020 2020 2020 2020 2020 6272 6f6b 6572            broker
-0000d9b0: 686f 7374 3d27 272c 6272 6f6b 6572 706f  host='',brokerpo
-0000d9c0: 7274 3d2d 3939 392c 6d69 6372 6f73 6572  rt=-999,microser
-0000d9d0: 7669 6365 6964 3d27 272c 746f 7069 6369  viceid='',topici
-0000d9e0: 643d 2d39 3939 293a 0d0a 2020 2020 676c  d=-999):..    gl
-0000d9f0: 6f62 616c 2063 6f6e 6e65 6374 696f 6e65  obal connectione
-0000da00: 7272 6f72 0d0a 0d0a 2020 2020 6966 206c  rror....    if l
-0000da10: 656e 2868 6f73 7429 3d3d 3020 6f72 206c  en(host)==0 or l
-0000da20: 656e 2876 6970 6572 746f 6b65 6e29 3d3d  en(vipertoken)==
-0000da30: 3020 6f72 2070 6f72 743d 3d2d 3939 3920  0 or port==-999 
-0000da40: 6f72 206c 656e 2874 6f70 6963 293d 3d30  or len(topic)==0
-0000da50: 206f 7220 6c65 6e28 636f 6e73 756d 6572   or len(consumer
-0000da60: 6964 293d 3d30 206f 7220 6c65 6e28 636f  id)==0 or len(co
-0000da70: 6d70 616e 796e 616d 6529 3d3d 303a 0d0a  mpanyname)==0:..
-0000da80: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000da90: 2250 6c65 6173 6520 656e 7465 7220 686f  "Please enter ho
-0000daa0: 7374 2c70 6f72 742c 7669 7065 7274 6f6b  st,port,vipertok
-0000dab0: 656e 2c74 6f70 6963 2c20 636f 6e73 756d  en,topic, consum
-0000dac0: 6572 6964 2c63 6f6d 7061 6e79 6e61 6d65  erid,companyname
-0000dad0: 220d 0a20 2020 2020 2020 200d 0a20 2020  "..        ..   
-0000dae0: 2076 616c 7565 3d28 2263 6f6e 7375 6d65   value=("consume
-0000daf0: 6672 6f6d 7374 7265 616d 746f 7069 633f  fromstreamtopic?
-0000db00: 7669 7065 7274 6f6b 656e 3d22 2b76 6970  vipertoken="+vip
-0000db10: 6572 746f 6b65 6e20 2b20 2226 746f 7069  ertoken + "&topi
-0000db20: 633d 222b 746f 7069 6320 2b20 2226 636f  c="+topic + "&co
-0000db30: 6e73 756d 6572 6964 3d22 202b 2063 6f6e  nsumerid=" + con
-0000db40: 7375 6d65 7269 6420 2b20 2226 6f66 6673  sumerid + "&offs
-0000db50: 6574 3d22 2b73 7472 286f 6666 7365 7429  et="+str(offset)
-0000db60: 202b 0d0a 2020 2020 2020 2020 2226 7061   +..        "&pa
-0000db70: 7274 6974 696f 6e3d 2220 2b20 7374 7228  rtition=" + str(
-0000db80: 7061 7274 6974 696f 6e29 202b 2022 2664  partition) + "&d
-0000db90: 656c 6179 3d22 202b 2073 7472 2864 656c  elay=" + str(del
-0000dba0: 6179 2920 2b20 2226 656e 6162 6c65 746c  ay) + "&enabletl
-0000dbb0: 733d 2220 2b20 7374 7228 656e 6162 6c65  s=" + str(enable
-0000dbc0: 746c 7329 202b 2022 2662 726f 6b65 7268  tls) + "&brokerh
-0000dbd0: 6f73 743d 222b 0d0a 2020 2020 2020 2020  ost="+..        
-0000dbe0: 6272 6f6b 6572 686f 7374 202b 2022 2662  brokerhost + "&b
-0000dbf0: 726f 6b65 7270 6f72 743d 222b 7374 7228  rokerport="+str(
-0000dc00: 6272 6f6b 6572 706f 7274 292b 2022 2663  brokerport)+ "&c
-0000dc10: 6f6d 7061 6e79 6e61 6d65 3d22 2b63 6f6d  ompanyname="+com
-0000dc20: 7061 6e79 6e61 6d65 202b 2022 2674 6f70  panyname + "&top
-0000dc30: 6963 6964 3d22 202b 2073 7472 2874 6f70  icid=" + str(top
-0000dc40: 6963 6964 2929 0d0a 0d0a 2020 2020 7661  icid))....    va
-0000dc50: 6c3d 6c6f 6f70 2e72 756e 5f75 6e74 696c  l=loop.run_until
-0000dc60: 5f63 6f6d 706c 6574 6528 7463 705f 6563  _complete(tcp_ec
-0000dc70: 686f 5f63 6c69 656e 7476 6970 6572 2876  ho_clientviper(v
-0000dc80: 616c 7565 2c20 6c6f 6f70 2c68 6f73 742c  alue, loop,host,
-0000dc90: 706f 7274 2c6d 6963 726f 7365 7276 6963  port,microservic
-0000dca0: 6569 6429 290d 0a20 2020 2069 6620 636f  eid))..    if co
-0000dcb0: 6e6e 6563 7469 6f6e 6572 726f 723a 0d0a  nnectionerror:..
-0000dcc0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000dcd0: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
-0000dce0: 0a0d 0a20 2020 2072 6574 7572 6e20 7661  ...    return va
-0000dcf0: 6c0d 0a0d 0a0d 0a64 6566 2076 6970 6572  l......def viper
-0000dd00: 6372 6561 7465 6a6f 696e 746f 7069 6373  createjointopics
-0000dd10: 7472 6561 6d73 2876 6970 6572 746f 6b65  treams(vipertoke
-0000dd20: 6e2c 686f 7374 2c70 6f72 742c 746f 7069  n,host,port,topi
-0000dd30: 632c 746f 7069 6373 746f 6a6f 696e 2c63  c,topicstojoin,c
-0000dd40: 6f6d 7061 6e79 6e61 6d65 2c63 6f6e 7461  ompanyname,conta
-0000dd50: 6374 6e61 6d65 2c63 6f6e 7461 6374 656d  ctname,contactem
-0000dd60: 6169 6c2c 6465 7363 7269 7074 696f 6e2c  ail,description,
-0000dd70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000dd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd90: 2020 6c6f 6361 7469 6f6e 2c65 6e61 626c    location,enabl
-0000dda0: 6574 6c73 3d30 2c62 726f 6b65 7268 6f73  etls=0,brokerhos
-0000ddb0: 743d 2727 2c62 726f 6b65 7270 6f72 743d  t='',brokerport=
-0000ddc0: 2d39 3939 2c72 6570 6c69 6361 7469 6f6e  -999,replication
-0000ddd0: 3d31 2c6e 756d 7061 7274 6974 696f 6e73  =1,numpartitions
-0000dde0: 3d31 2c6d 6963 726f 7365 7276 6963 6569  =1,microservicei
-0000ddf0: 643d 2727 2c74 6f70 6963 6964 3d2d 3939  d='',topicid=-99
-0000de00: 3929 3a0d 0a0d 0a20 2020 2067 6c6f 6261  9):....    globa
-0000de10: 6c20 636f 6e6e 6563 7469 6f6e 6572 726f  l connectionerro
-0000de20: 720d 0a0d 0a20 2020 2069 6620 286c 656e  r....    if (len
-0000de30: 2868 6f73 7429 3d3d 3020 6f72 206c 656e  (host)==0 or len
-0000de40: 2876 6970 6572 746f 6b65 6e29 3d3d 3020  (vipertoken)==0 
-0000de50: 6f72 2070 6f72 743d 3d2d 3939 3920 6f72  or port==-999 or
-0000de60: 206c 656e 2863 6f6e 7461 6374 6e61 6d65   len(contactname
-0000de70: 293d 3d30 206f 7220 6c65 6e28 636f 6e74  )==0 or len(cont
-0000de80: 6163 7465 6d61 696c 293d 3d30 206f 7220  actemail)==0 or 
-0000de90: 6c65 6e28 6465 7363 7269 7074 696f 6e29  len(description)
-0000dea0: 3d3d 3020 6f72 0d0a 2020 2020 2020 2020  ==0 or..        
-0000deb0: 6c65 6e28 6c6f 6361 7469 6f6e 293d 3d30  len(location)==0
-0000dec0: 2029 3a0d 0a20 2020 2020 2020 2020 7265   ):..         re
-0000ded0: 7475 726e 2022 506c 6561 7365 2065 6e74  turn "Please ent
-0000dee0: 6572 2068 6f73 742c 706f 7274 2c76 6970  er host,port,vip
-0000def0: 6572 746f 6b65 6e2c 636f 6e74 6163 746e  ertoken,contactn
-0000df00: 616d 652c 636f 6e74 6163 7465 6d61 696c  ame,contactemail
-0000df10: 2c63 6f6d 7061 6e79 6e61 6d65 2c64 6573  ,companyname,des
-0000df20: 6372 6970 7469 6f6e 2c6c 6f63 6174 696f  cription,locatio
-0000df30: 6e22 0d0a 2020 2020 2020 2020 0d0a 2020  n"..        ..  
-0000df40: 2020 7661 6c75 653d 2822 6372 6561 7465    value=("create
-0000df50: 6a6f 696e 746f 7069 6373 7472 6561 6d73  jointopicstreams
-0000df60: 3f76 6970 6572 746f 6b65 6e3d 222b 7669  ?vipertoken="+vi
-0000df70: 7065 7274 6f6b 656e 202b 2022 2674 6f70  pertoken + "&top
-0000df80: 6963 6e61 6d65 3d22 2b74 6f70 6963 202b  icname="+topic +
-0000df90: 2022 2674 6f70 6963 7374 6f6a 6f69 6e3d   "&topicstojoin=
-0000dfa0: 222b 746f 7069 6373 746f 6a6f 696e 202b  "+topicstojoin +
-0000dfb0: 0d0a 2020 2020 2020 2020 2020 2022 2663  ..           "&c
-0000dfc0: 6f6d 7061 6e79 6e61 6d65 3d22 2b63 6f6d  ompanyname="+com
-0000dfd0: 7061 6e79 6e61 6d65 2b22 2663 6f6e 7461  panyname+"&conta
-0000dfe0: 6374 6e61 6d65 3d22 2b63 6f6e 7461 6374  ctname="+contact
-0000dff0: 6e61 6d65 202b 2226 636f 6e74 6163 7465  name +"&contacte
-0000e000: 6d61 696c 3d22 2b63 6f6e 7461 6374 656d  mail="+contactem
-0000e010: 6169 6c2b 2226 6272 6f6b 6572 686f 7374  ail+"&brokerhost
-0000e020: 3d22 2b62 726f 6b65 7268 6f73 742b 2226  ="+brokerhost+"&
-0000e030: 6272 6f6b 6572 706f 7274 3d22 2b73 7472  brokerport="+str
-0000e040: 2862 726f 6b65 7270 6f72 7429 2b0d 0a20  (brokerport)+.. 
-0000e050: 2020 2020 2020 2020 2020 2226 656e 6162            "&enab
-0000e060: 6c65 746c 733d 2220 2b20 7374 7228 656e  letls=" + str(en
-0000e070: 6162 6c65 746c 7329 202b 2022 2664 6573  abletls) + "&des
-0000e080: 6372 6970 7469 6f6e 3d22 2b64 6573 6372  cription="+descr
-0000e090: 6970 7469 6f6e 202b 2022 266c 6f63 6174  iption + "&locat
-0000e0a0: 696f 6e3d 222b 6c6f 6361 7469 6f6e 2b22  ion="+location+"
-0000e0b0: 2672 6570 6c69 6361 7469 6f6e 6661 6374  &replicationfact
-0000e0c0: 6f72 3d22 2b73 7472 2872 6570 6c69 6361  or="+str(replica
-0000e0d0: 7469 6f6e 292b 0d0a 2020 2020 2020 2020  tion)+..        
-0000e0e0: 2020 2022 266e 756d 7061 7274 6974 696f     "&numpartitio
-0000e0f0: 6e73 3d22 2b73 7472 286e 756d 7061 7274  ns="+str(numpart
-0000e100: 6974 696f 6e73 2920 2b20 2226 746f 7069  itions) + "&topi
-0000e110: 6369 643d 2220 2b20 7374 7228 746f 7069  cid=" + str(topi
-0000e120: 6369 6429 290d 0a0d 0a20 2020 2076 616c  cid))....    val
-0000e130: 3d6c 6f6f 702e 7275 6e5f 756e 7469 6c5f  =loop.run_until_
-0000e140: 636f 6d70 6c65 7465 2874 6370 5f65 6368  complete(tcp_ech
-0000e150: 6f5f 636c 6965 6e74 7669 7065 7228 7661  o_clientviper(va
-0000e160: 6c75 652c 206c 6f6f 702c 686f 7374 2c70  lue, loop,host,p
-0000e170: 6f72 742c 6d69 6372 6f73 6572 7669 6365  ort,microservice
-0000e180: 6964 2929 0d0a 2020 2020 6966 2063 6f6e  id))..    if con
-0000e190: 6e65 6374 696f 6e65 7272 6f72 3a0d 0a20  nectionerror:.. 
-0000e1a0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-0000e1b0: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
-0000e1c0: 0d0a 2020 2020 7265 7475 726e 2076 616c  ..    return val
-0000e1d0: 0d0a 0d0a 6465 6620 7669 7065 7263 7265  ....def vipercre
-0000e1e0: 6174 6563 6f6e 7375 6d65 7267 726f 7570  ateconsumergroup
-0000e1f0: 2876 6970 6572 746f 6b65 6e2c 686f 7374  (vipertoken,host
-0000e200: 2c70 6f72 742c 746f 7069 632c 6772 6f75  ,port,topic,grou
-0000e210: 706e 616d 652c 636f 6d70 616e 796e 616d  pname,companynam
-0000e220: 652c 636f 6e74 6163 746e 616d 652c 636f  e,contactname,co
-0000e230: 6e74 6163 7465 6d61 696c 2c64 6573 6372  ntactemail,descr
-0000e240: 6970 7469 6f6e 2c0d 0a20 2020 2020 2020  iption,..       
-0000e250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e260: 2020 2020 2020 2020 206c 6f63 6174 696f           locatio
-0000e270: 6e2c 656e 6162 6c65 746c 733d 312c 6272  n,enabletls=1,br
-0000e280: 6f6b 6572 686f 7374 3d27 272c 6272 6f6b  okerhost='',brok
-0000e290: 6572 706f 7274 3d2d 3939 392c 6d69 6372  erport=-999,micr
-0000e2a0: 6f73 6572 7669 6365 6964 3d27 2729 3a0d  oserviceid=''):.
-0000e2b0: 0a20 2020 2067 6c6f 6261 6c20 636f 6e6e  .    global conn
-0000e2c0: 6563 7469 6f6e 6572 726f 720d 0a0d 0a20  ectionerror.... 
-0000e2d0: 2020 2069 6620 286c 656e 2868 6f73 7429     if (len(host)
-0000e2e0: 3d3d 3020 6f72 206c 656e 2876 6970 6572  ==0 or len(viper
-0000e2f0: 746f 6b65 6e29 3d3d 3020 6f72 206c 656e  token)==0 or len
-0000e300: 2874 6f70 6963 293d 3d30 206f 7220 6c65  (topic)==0 or le
-0000e310: 6e28 6772 6f75 706e 616d 6529 3d3d 3029  n(groupname)==0)
-0000e320: 206f 7220 6c65 6e28 746f 7069 6329 3d3d   or len(topic)==
-0000e330: 303a 0d0a 2020 2020 2020 2020 2072 6574  0:..         ret
-0000e340: 7572 6e20 2250 6c65 6173 6520 656e 7465  urn "Please ente
-0000e350: 7220 686f 7374 2c70 6f72 742c 7669 7065  r host,port,vipe
-0000e360: 7274 6f6b 656e 2c63 6f6e 7461 6374 6e61  rtoken,contactna
-0000e370: 6d65 2c63 6f6e 7461 6374 656d 6169 6c2c  me,contactemail,
-0000e380: 636f 6d70 616e 796e 616d 652c 6465 7363  companyname,desc
-0000e390: 7269 7074 696f 6e2c 6c6f 6361 7469 6f6e  ription,location
-0000e3a0: 2c67 726f 7570 6e61 6d65 220d 0a20 2020  ,groupname"..   
-0000e3b0: 2020 2020 200d 0a20 2020 2076 616c 7565       ..    value
-0000e3c0: 3d28 2263 7265 6174 6563 6f6e 7375 6d65  =("createconsume
-0000e3d0: 7267 726f 7570 3f76 6970 6572 746f 6b65  rgroup?vipertoke
-0000e3e0: 6e3d 222b 7669 7065 7274 6f6b 656e 202b  n="+vipertoken +
-0000e3f0: 2022 2674 6f70 6963 3d22 2b74 6f70 6963   "&topic="+topic
-0000e400: 202b 2022 2667 726f 7570 6e61 6d65 3d22   + "&groupname="
-0000e410: 2b67 726f 7570 6e61 6d65 202b 0d0a 2020  +groupname +..  
-0000e420: 2020 2020 2020 2020 2022 2663 6f6d 7061           "&compa
-0000e430: 6e79 6e61 6d65 3d22 2b63 6f6d 7061 6e79  nyname="+company
-0000e440: 6e61 6d65 2b22 2663 6f6e 7461 6374 6e61  name+"&contactna
-0000e450: 6d65 3d22 2b63 6f6e 7461 6374 6e61 6d65  me="+contactname
-0000e460: 202b 2226 636f 6e74 6163 7465 6d61 696c   +"&contactemail
-0000e470: 3d22 2b63 6f6e 7461 6374 656d 6169 6c2b  ="+contactemail+
-0000e480: 2022 2665 6e61 626c 6574 6c73 3d22 2b73   "&enabletls="+s
-0000e490: 7472 2865 6e61 626c 6574 6c73 292b 0d0a  tr(enabletls)+..
-0000e4a0: 2020 2020 2020 2020 2020 2022 2664 6573             "&des
-0000e4b0: 6372 6970 7469 6f6e 3d22 2b64 6573 6372  cription="+descr
-0000e4c0: 6970 7469 6f6e 202b 2022 266c 6f63 6174  iption + "&locat
-0000e4d0: 696f 6e3d 222b 6c6f 6361 7469 6f6e 2b22  ion="+location+"
-0000e4e0: 2662 726f 6b65 7268 6f73 743d 222b 6272  &brokerhost="+br
-0000e4f0: 6f6b 6572 686f 7374 2b22 2662 726f 6b65  okerhost+"&broke
-0000e500: 7270 6f72 743d 222b 7374 7228 6272 6f6b  rport="+str(brok
-0000e510: 6572 706f 7274 2929 0d0a 0d0a 2020 2020  erport))....    
-0000e520: 7661 6c3d 6c6f 6f70 2e72 756e 5f75 6e74  val=loop.run_unt
-0000e530: 696c 5f63 6f6d 706c 6574 6528 7463 705f  il_complete(tcp_
-0000e540: 6563 686f 5f63 6c69 656e 7476 6970 6572  echo_clientviper
-0000e550: 2876 616c 7565 2c20 6c6f 6f70 2c68 6f73  (value, loop,hos
-0000e560: 742c 706f 7274 2c6d 6963 726f 7365 7276  t,port,microserv
-0000e570: 6963 6569 6429 290d 0a20 2020 2069 6620  iceid))..    if 
-0000e580: 636f 6e6e 6563 7469 6f6e 6572 726f 723a  connectionerror:
-0000e590: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
-0000e5a0: 6e20 636f 6e6e 6563 7469 6f6e 6572 726f  n connectionerro
-0000e5b0: 720d 0a0d 0a20 2020 2072 6574 7572 6e20  r....    return 
-0000e5c0: 7661 6c0d 0a0d 0a64 6566 2076 6970 6572  val....def viper
-0000e5d0: 636f 6e73 756d 6572 6772 6f75 7063 6f6e  consumergroupcon
-0000e5e0: 7375 6d65 6672 6f6d 746f 7069 6328 7669  sumefromtopic(vi
-0000e5f0: 7065 7274 6f6b 656e 2c68 6f73 742c 706f  pertoken,host,po
-0000e600: 7274 2c74 6f70 6963 2c63 6f6e 7375 6d65  rt,topic,consume
-0000e610: 7269 642c 6772 6f75 7069 642c 636f 6d70  rid,groupid,comp
-0000e620: 616e 796e 616d 652c 7061 7274 6974 696f  anyname,partitio
-0000e630: 6e3d 2d31 2c65 6e61 626c 6574 6c73 3d31  n=-1,enabletls=1
-0000e640: 2c64 656c 6179 3d31 3030 302c 0d0a 2020  ,delay=1000,..  
+0000d9a0: 6272 6f6b 6572 686f 7374 3d27 272c 6272  brokerhost='',br
+0000d9b0: 6f6b 6572 706f 7274 3d2d 3939 392c 6d69  okerport=-999,mi
+0000d9c0: 6372 6f73 6572 7669 6365 6964 3d27 272c  croserviceid='',
+0000d9d0: 746f 7069 6369 643d 2d39 3939 293a 0d0a  topicid=-999):..
+0000d9e0: 2020 2020 676c 6f62 616c 2063 6f6e 6e65      global conne
+0000d9f0: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
+0000da00: 2020 6966 206c 656e 2868 6f73 7429 3d3d    if len(host)==
+0000da10: 3020 6f72 206c 656e 2876 6970 6572 746f  0 or len(viperto
+0000da20: 6b65 6e29 3d3d 3020 6f72 2070 6f72 743d  ken)==0 or port=
+0000da30: 3d2d 3939 3920 6f72 206c 656e 2874 6f70  =-999 or len(top
+0000da40: 6963 293d 3d30 206f 7220 6c65 6e28 636f  ic)==0 or len(co
+0000da50: 6e73 756d 6572 6964 293d 3d30 206f 7220  nsumerid)==0 or 
+0000da60: 6c65 6e28 636f 6d70 616e 796e 616d 6529  len(companyname)
+0000da70: 3d3d 303a 0d0a 2020 2020 2020 2020 2072  ==0:..         r
+0000da80: 6574 7572 6e20 2250 6c65 6173 6520 656e  eturn "Please en
+0000da90: 7465 7220 686f 7374 2c70 6f72 742c 7669  ter host,port,vi
+0000daa0: 7065 7274 6f6b 656e 2c74 6f70 6963 2c20  pertoken,topic, 
+0000dab0: 636f 6e73 756d 6572 6964 2c63 6f6d 7061  consumerid,compa
+0000dac0: 6e79 6e61 6d65 220d 0a20 2020 2020 2020  nyname"..       
+0000dad0: 200d 0a20 2020 2076 616c 7565 3d28 2263   ..    value=("c
+0000dae0: 6f6e 7375 6d65 6672 6f6d 7374 7265 616d  onsumefromstream
+0000daf0: 746f 7069 633f 7669 7065 7274 6f6b 656e  topic?vipertoken
+0000db00: 3d22 2b76 6970 6572 746f 6b65 6e20 2b20  ="+vipertoken + 
+0000db10: 2226 746f 7069 633d 222b 746f 7069 6320  "&topic="+topic 
+0000db20: 2b20 2226 636f 6e73 756d 6572 6964 3d22  + "&consumerid="
+0000db30: 202b 2063 6f6e 7375 6d65 7269 6420 2b20   + consumerid + 
+0000db40: 2226 6f66 6673 6574 3d22 2b73 7472 286f  "&offset="+str(o
+0000db50: 6666 7365 7429 202b 0d0a 2020 2020 2020  ffset) +..      
+0000db60: 2020 2226 7061 7274 6974 696f 6e3d 2220    "&partition=" 
+0000db70: 2b20 7374 7228 7061 7274 6974 696f 6e29  + str(partition)
+0000db80: 202b 2022 2664 656c 6179 3d22 202b 2073   + "&delay=" + s
+0000db90: 7472 2864 656c 6179 2920 2b20 2226 656e  tr(delay) + "&en
+0000dba0: 6162 6c65 746c 733d 2220 2b20 7374 7228  abletls=" + str(
+0000dbb0: 656e 6162 6c65 746c 7329 202b 2022 2662  enabletls) + "&b
+0000dbc0: 726f 6b65 7268 6f73 743d 222b 0d0a 2020  rokerhost="+..  
+0000dbd0: 2020 2020 2020 6272 6f6b 6572 686f 7374        brokerhost
+0000dbe0: 202b 2022 2662 726f 6b65 7270 6f72 743d   + "&brokerport=
+0000dbf0: 222b 7374 7228 6272 6f6b 6572 706f 7274  "+str(brokerport
+0000dc00: 292b 2022 2663 6f6d 7061 6e79 6e61 6d65  )+ "&companyname
+0000dc10: 3d22 2b63 6f6d 7061 6e79 6e61 6d65 202b  ="+companyname +
+0000dc20: 2022 2674 6f70 6963 6964 3d22 202b 2073   "&topicid=" + s
+0000dc30: 7472 2874 6f70 6963 6964 2929 0d0a 0d0a  tr(topicid))....
+0000dc40: 2020 2020 7661 6c3d 6c6f 6f70 2e72 756e      val=loop.run
+0000dc50: 5f75 6e74 696c 5f63 6f6d 706c 6574 6528  _until_complete(
+0000dc60: 7463 705f 6563 686f 5f63 6c69 656e 7476  tcp_echo_clientv
+0000dc70: 6970 6572 2876 616c 7565 2c20 6c6f 6f70  iper(value, loop
+0000dc80: 2c68 6f73 742c 706f 7274 2c6d 6963 726f  ,host,port,micro
+0000dc90: 7365 7276 6963 6569 6429 290d 0a20 2020  serviceid))..   
+0000dca0: 2069 6620 636f 6e6e 6563 7469 6f6e 6572   if connectioner
+0000dcb0: 726f 723a 0d0a 2020 2020 2020 2020 2072  ror:..         r
+0000dcc0: 6574 7572 6e20 636f 6e6e 6563 7469 6f6e  eturn connection
+0000dcd0: 6572 726f 720d 0a0d 0a20 2020 2072 6574  error....    ret
+0000dce0: 7572 6e20 7661 6c0d 0a0d 0a0d 0a64 6566  urn val......def
+0000dcf0: 2076 6970 6572 6372 6561 7465 6a6f 696e   vipercreatejoin
+0000dd00: 746f 7069 6373 7472 6561 6d73 2876 6970  topicstreams(vip
+0000dd10: 6572 746f 6b65 6e2c 686f 7374 2c70 6f72  ertoken,host,por
+0000dd20: 742c 746f 7069 632c 746f 7069 6373 746f  t,topic,topicsto
+0000dd30: 6a6f 696e 2c63 6f6d 7061 6e79 6e61 6d65  join,companyname
+0000dd40: 2c63 6f6e 7461 6374 6e61 6d65 2c63 6f6e  ,contactname,con
+0000dd50: 7461 6374 656d 6169 6c2c 6465 7363 7269  tactemail,descri
+0000dd60: 7074 696f 6e2c 0d0a 2020 2020 2020 2020  ption,..        
+0000dd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd80: 2020 2020 2020 2020 6c6f 6361 7469 6f6e          location
+0000dd90: 2c65 6e61 626c 6574 6c73 3d30 2c62 726f  ,enabletls=0,bro
+0000dda0: 6b65 7268 6f73 743d 2727 2c62 726f 6b65  kerhost='',broke
+0000ddb0: 7270 6f72 743d 2d39 3939 2c72 6570 6c69  rport=-999,repli
+0000ddc0: 6361 7469 6f6e 3d31 2c6e 756d 7061 7274  cation=1,numpart
+0000ddd0: 6974 696f 6e73 3d31 2c6d 6963 726f 7365  itions=1,microse
+0000dde0: 7276 6963 6569 643d 2727 2c74 6f70 6963  rviceid='',topic
+0000ddf0: 6964 3d2d 3939 3929 3a0d 0a0d 0a20 2020  id=-999):....   
+0000de00: 2067 6c6f 6261 6c20 636f 6e6e 6563 7469   global connecti
+0000de10: 6f6e 6572 726f 720d 0a0d 0a20 2020 2069  onerror....    i
+0000de20: 6620 286c 656e 2868 6f73 7429 3d3d 3020  f (len(host)==0 
+0000de30: 6f72 206c 656e 2876 6970 6572 746f 6b65  or len(vipertoke
+0000de40: 6e29 3d3d 3020 6f72 2070 6f72 743d 3d2d  n)==0 or port==-
+0000de50: 3939 3920 6f72 206c 656e 2863 6f6e 7461  999 or len(conta
+0000de60: 6374 6e61 6d65 293d 3d30 206f 7220 6c65  ctname)==0 or le
+0000de70: 6e28 636f 6e74 6163 7465 6d61 696c 293d  n(contactemail)=
+0000de80: 3d30 206f 7220 6c65 6e28 6465 7363 7269  =0 or len(descri
+0000de90: 7074 696f 6e29 3d3d 3020 6f72 0d0a 2020  ption)==0 or..  
+0000dea0: 2020 2020 2020 6c65 6e28 6c6f 6361 7469        len(locati
+0000deb0: 6f6e 293d 3d30 2029 3a0d 0a20 2020 2020  on)==0 ):..     
+0000dec0: 2020 2020 7265 7475 726e 2022 506c 6561      return "Plea
+0000ded0: 7365 2065 6e74 6572 2068 6f73 742c 706f  se enter host,po
+0000dee0: 7274 2c76 6970 6572 746f 6b65 6e2c 636f  rt,vipertoken,co
+0000def0: 6e74 6163 746e 616d 652c 636f 6e74 6163  ntactname,contac
+0000df00: 7465 6d61 696c 2c63 6f6d 7061 6e79 6e61  temail,companyna
+0000df10: 6d65 2c64 6573 6372 6970 7469 6f6e 2c6c  me,description,l
+0000df20: 6f63 6174 696f 6e22 0d0a 2020 2020 2020  ocation"..      
+0000df30: 2020 0d0a 2020 2020 7661 6c75 653d 2822    ..    value=("
+0000df40: 6372 6561 7465 6a6f 696e 746f 7069 6373  createjointopics
+0000df50: 7472 6561 6d73 3f76 6970 6572 746f 6b65  treams?vipertoke
+0000df60: 6e3d 222b 7669 7065 7274 6f6b 656e 202b  n="+vipertoken +
+0000df70: 2022 2674 6f70 6963 6e61 6d65 3d22 2b74   "&topicname="+t
+0000df80: 6f70 6963 202b 2022 2674 6f70 6963 7374  opic + "&topicst
+0000df90: 6f6a 6f69 6e3d 222b 746f 7069 6373 746f  ojoin="+topicsto
+0000dfa0: 6a6f 696e 202b 0d0a 2020 2020 2020 2020  join +..        
+0000dfb0: 2020 2022 2663 6f6d 7061 6e79 6e61 6d65     "&companyname
+0000dfc0: 3d22 2b63 6f6d 7061 6e79 6e61 6d65 2b22  ="+companyname+"
+0000dfd0: 2663 6f6e 7461 6374 6e61 6d65 3d22 2b63  &contactname="+c
+0000dfe0: 6f6e 7461 6374 6e61 6d65 202b 2226 636f  ontactname +"&co
+0000dff0: 6e74 6163 7465 6d61 696c 3d22 2b63 6f6e  ntactemail="+con
+0000e000: 7461 6374 656d 6169 6c2b 2226 6272 6f6b  tactemail+"&brok
+0000e010: 6572 686f 7374 3d22 2b62 726f 6b65 7268  erhost="+brokerh
+0000e020: 6f73 742b 2226 6272 6f6b 6572 706f 7274  ost+"&brokerport
+0000e030: 3d22 2b73 7472 2862 726f 6b65 7270 6f72  ="+str(brokerpor
+0000e040: 7429 2b0d 0a20 2020 2020 2020 2020 2020  t)+..           
+0000e050: 2226 656e 6162 6c65 746c 733d 2220 2b20  "&enabletls=" + 
+0000e060: 7374 7228 656e 6162 6c65 746c 7329 202b  str(enabletls) +
+0000e070: 2022 2664 6573 6372 6970 7469 6f6e 3d22   "&description="
+0000e080: 2b64 6573 6372 6970 7469 6f6e 202b 2022  +description + "
+0000e090: 266c 6f63 6174 696f 6e3d 222b 6c6f 6361  &location="+loca
+0000e0a0: 7469 6f6e 2b22 2672 6570 6c69 6361 7469  tion+"&replicati
+0000e0b0: 6f6e 6661 6374 6f72 3d22 2b73 7472 2872  onfactor="+str(r
+0000e0c0: 6570 6c69 6361 7469 6f6e 292b 0d0a 2020  eplication)+..  
+0000e0d0: 2020 2020 2020 2020 2022 266e 756d 7061           "&numpa
+0000e0e0: 7274 6974 696f 6e73 3d22 2b73 7472 286e  rtitions="+str(n
+0000e0f0: 756d 7061 7274 6974 696f 6e73 2920 2b20  umpartitions) + 
+0000e100: 2226 746f 7069 6369 643d 2220 2b20 7374  "&topicid=" + st
+0000e110: 7228 746f 7069 6369 6429 290d 0a0d 0a20  r(topicid)).... 
+0000e120: 2020 2076 616c 3d6c 6f6f 702e 7275 6e5f     val=loop.run_
+0000e130: 756e 7469 6c5f 636f 6d70 6c65 7465 2874  until_complete(t
+0000e140: 6370 5f65 6368 6f5f 636c 6965 6e74 7669  cp_echo_clientvi
+0000e150: 7065 7228 7661 6c75 652c 206c 6f6f 702c  per(value, loop,
+0000e160: 686f 7374 2c70 6f72 742c 6d69 6372 6f73  host,port,micros
+0000e170: 6572 7669 6365 6964 2929 0d0a 2020 2020  erviceid))..    
+0000e180: 6966 2063 6f6e 6e65 6374 696f 6e65 7272  if connectionerr
+0000e190: 6f72 3a0d 0a20 2020 2020 2020 2020 7265  or:..         re
+0000e1a0: 7475 726e 2063 6f6e 6e65 6374 696f 6e65  turn connectione
+0000e1b0: 7272 6f72 0d0a 0d0a 2020 2020 7265 7475  rror....    retu
+0000e1c0: 726e 2076 616c 0d0a 0d0a 6465 6620 7669  rn val....def vi
+0000e1d0: 7065 7263 7265 6174 6563 6f6e 7375 6d65  percreateconsume
+0000e1e0: 7267 726f 7570 2876 6970 6572 746f 6b65  rgroup(vipertoke
+0000e1f0: 6e2c 686f 7374 2c70 6f72 742c 746f 7069  n,host,port,topi
+0000e200: 632c 6772 6f75 706e 616d 652c 636f 6d70  c,groupname,comp
+0000e210: 616e 796e 616d 652c 636f 6e74 6163 746e  anyname,contactn
+0000e220: 616d 652c 636f 6e74 6163 7465 6d61 696c  ame,contactemail
+0000e230: 2c64 6573 6372 6970 7469 6f6e 2c0d 0a20  ,description,.. 
+0000e240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e250: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0000e260: 6f63 6174 696f 6e2c 656e 6162 6c65 746c  ocation,enabletl
+0000e270: 733d 312c 6272 6f6b 6572 686f 7374 3d27  s=1,brokerhost='
+0000e280: 272c 6272 6f6b 6572 706f 7274 3d2d 3939  ',brokerport=-99
+0000e290: 392c 6d69 6372 6f73 6572 7669 6365 6964  9,microserviceid
+0000e2a0: 3d27 2729 3a0d 0a20 2020 2067 6c6f 6261  =''):..    globa
+0000e2b0: 6c20 636f 6e6e 6563 7469 6f6e 6572 726f  l connectionerro
+0000e2c0: 720d 0a0d 0a20 2020 2069 6620 286c 656e  r....    if (len
+0000e2d0: 2868 6f73 7429 3d3d 3020 6f72 206c 656e  (host)==0 or len
+0000e2e0: 2876 6970 6572 746f 6b65 6e29 3d3d 3020  (vipertoken)==0 
+0000e2f0: 6f72 206c 656e 2874 6f70 6963 293d 3d30  or len(topic)==0
+0000e300: 206f 7220 6c65 6e28 6772 6f75 706e 616d   or len(groupnam
+0000e310: 6529 3d3d 3029 206f 7220 6c65 6e28 746f  e)==0) or len(to
+0000e320: 7069 6329 3d3d 303a 0d0a 2020 2020 2020  pic)==0:..      
+0000e330: 2020 2072 6574 7572 6e20 2250 6c65 6173     return "Pleas
+0000e340: 6520 656e 7465 7220 686f 7374 2c70 6f72  e enter host,por
+0000e350: 742c 7669 7065 7274 6f6b 656e 2c63 6f6e  t,vipertoken,con
+0000e360: 7461 6374 6e61 6d65 2c63 6f6e 7461 6374  tactname,contact
+0000e370: 656d 6169 6c2c 636f 6d70 616e 796e 616d  email,companynam
+0000e380: 652c 6465 7363 7269 7074 696f 6e2c 6c6f  e,description,lo
+0000e390: 6361 7469 6f6e 2c67 726f 7570 6e61 6d65  cation,groupname
+0000e3a0: 220d 0a20 2020 2020 2020 200d 0a20 2020  "..        ..   
+0000e3b0: 2076 616c 7565 3d28 2263 7265 6174 6563   value=("createc
+0000e3c0: 6f6e 7375 6d65 7267 726f 7570 3f76 6970  onsumergroup?vip
+0000e3d0: 6572 746f 6b65 6e3d 222b 7669 7065 7274  ertoken="+vipert
+0000e3e0: 6f6b 656e 202b 2022 2674 6f70 6963 3d22  oken + "&topic="
+0000e3f0: 2b74 6f70 6963 202b 2022 2667 726f 7570  +topic + "&group
+0000e400: 6e61 6d65 3d22 2b67 726f 7570 6e61 6d65  name="+groupname
+0000e410: 202b 0d0a 2020 2020 2020 2020 2020 2022   +..           "
+0000e420: 2663 6f6d 7061 6e79 6e61 6d65 3d22 2b63  &companyname="+c
+0000e430: 6f6d 7061 6e79 6e61 6d65 2b22 2663 6f6e  ompanyname+"&con
+0000e440: 7461 6374 6e61 6d65 3d22 2b63 6f6e 7461  tactname="+conta
+0000e450: 6374 6e61 6d65 202b 2226 636f 6e74 6163  ctname +"&contac
+0000e460: 7465 6d61 696c 3d22 2b63 6f6e 7461 6374  temail="+contact
+0000e470: 656d 6169 6c2b 2022 2665 6e61 626c 6574  email+ "&enablet
+0000e480: 6c73 3d22 2b73 7472 2865 6e61 626c 6574  ls="+str(enablet
+0000e490: 6c73 292b 0d0a 2020 2020 2020 2020 2020  ls)+..          
+0000e4a0: 2022 2664 6573 6372 6970 7469 6f6e 3d22   "&description="
+0000e4b0: 2b64 6573 6372 6970 7469 6f6e 202b 2022  +description + "
+0000e4c0: 266c 6f63 6174 696f 6e3d 222b 6c6f 6361  &location="+loca
+0000e4d0: 7469 6f6e 2b22 2662 726f 6b65 7268 6f73  tion+"&brokerhos
+0000e4e0: 743d 222b 6272 6f6b 6572 686f 7374 2b22  t="+brokerhost+"
+0000e4f0: 2662 726f 6b65 7270 6f72 743d 222b 7374  &brokerport="+st
+0000e500: 7228 6272 6f6b 6572 706f 7274 2929 0d0a  r(brokerport))..
+0000e510: 0d0a 2020 2020 7661 6c3d 6c6f 6f70 2e72  ..    val=loop.r
+0000e520: 756e 5f75 6e74 696c 5f63 6f6d 706c 6574  un_until_complet
+0000e530: 6528 7463 705f 6563 686f 5f63 6c69 656e  e(tcp_echo_clien
+0000e540: 7476 6970 6572 2876 616c 7565 2c20 6c6f  tviper(value, lo
+0000e550: 6f70 2c68 6f73 742c 706f 7274 2c6d 6963  op,host,port,mic
+0000e560: 726f 7365 7276 6963 6569 6429 290d 0a20  roserviceid)).. 
+0000e570: 2020 2069 6620 636f 6e6e 6563 7469 6f6e     if connection
+0000e580: 6572 726f 723a 0d0a 2020 2020 2020 2020  error:..        
+0000e590: 2072 6574 7572 6e20 636f 6e6e 6563 7469   return connecti
+0000e5a0: 6f6e 6572 726f 720d 0a0d 0a20 2020 2072  onerror....    r
+0000e5b0: 6574 7572 6e20 7661 6c0d 0a0d 0a64 6566  eturn val....def
+0000e5c0: 2076 6970 6572 636f 6e73 756d 6572 6772   viperconsumergr
+0000e5d0: 6f75 7063 6f6e 7375 6d65 6672 6f6d 746f  oupconsumefromto
+0000e5e0: 7069 6328 7669 7065 7274 6f6b 656e 2c68  pic(vipertoken,h
+0000e5f0: 6f73 742c 706f 7274 2c74 6f70 6963 2c63  ost,port,topic,c
+0000e600: 6f6e 7375 6d65 7269 642c 6772 6f75 7069  onsumerid,groupi
+0000e610: 642c 636f 6d70 616e 796e 616d 652c 7061  d,companyname,pa
+0000e620: 7274 6974 696f 6e3d 2d31 2c65 6e61 626c  rtition=-1,enabl
+0000e630: 6574 6c73 3d31 2c64 656c 6179 3d31 3030  etls=1,delay=100
+0000e640: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
 0000e650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e670: 2020 2020 206f 6666 7365 743d 2d31 2c72       offset=-1,r
-0000e680: 6f6c 6c62 6163 6b6f 6666 7365 743d 302c  ollbackoffset=0,
-0000e690: 6272 6f6b 6572 686f 7374 3d27 272c 6272  brokerhost='',br
-0000e6a0: 6f6b 6572 706f 7274 3d2d 3939 392c 6d69  okerport=-999,mi
-0000e6b0: 6372 6f73 6572 7669 6365 6964 3d27 272c  croserviceid='',
-0000e6c0: 7072 6570 726f 6365 7373 7479 7065 3d27  preprocesstype='
-0000e6d0: 2729 3a0d 0a20 2020 2067 6c6f 6261 6c20  '):..    global 
-0000e6e0: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
-0000e6f0: 0a0d 0a20 2020 2069 6620 286c 656e 2868  ...    if (len(h
-0000e700: 6f73 7429 3d3d 3020 6f72 206c 656e 2876  ost)==0 or len(v
-0000e710: 6970 6572 746f 6b65 6e29 3d3d 3020 6f72  ipertoken)==0 or
-0000e720: 206c 656e 2867 726f 7570 6964 293d 3d30   len(groupid)==0
-0000e730: 206f 7220 6c65 6e28 636f 6d70 616e 796e   or len(companyn
-0000e740: 616d 6529 3d3d 3029 3a0d 0a20 2020 2020  ame)==0):..     
-0000e750: 2020 2020 7265 7475 726e 2022 506c 6561      return "Plea
-0000e760: 7365 2065 6e74 6572 2068 6f73 742c 706f  se enter host,po
-0000e770: 7274 2c76 6970 6572 746f 6b65 6e2c 636f  rt,vipertoken,co
-0000e780: 6d70 616e 796e 616d 652c 6772 6f75 7069  mpanyname,groupi
-0000e790: 6422 0d0a 2020 2020 2020 2020 0d0a 2020  d"..        ..  
-0000e7a0: 2020 7661 6c75 653d 2822 636f 6e73 756d    value=("consum
-0000e7b0: 6572 6772 6f75 7063 6f6e 7375 6d65 6672  ergroupconsumefr
-0000e7c0: 6f6d 746f 7069 633f 7669 7065 7274 6f6b  omtopic?vipertok
-0000e7d0: 656e 3d22 2b76 6970 6572 746f 6b65 6e20  en="+vipertoken 
-0000e7e0: 2b20 2226 746f 7069 633d 222b 746f 7069  + "&topic="+topi
-0000e7f0: 6320 2b20 2226 636f 6e73 756d 6572 6964  c + "&consumerid
-0000e800: 3d22 2b63 6f6e 7375 6d65 7269 6420 2b0d  ="+consumerid +.
-0000e810: 0a20 2020 2020 2020 2022 2670 6172 7469  .        "&parti
-0000e820: 7469 6f6e 3d22 202b 2073 7472 2870 6172  tion=" + str(par
-0000e830: 7469 7469 6f6e 2920 2b20 2022 2664 656c  tition) +  "&del
-0000e840: 6179 3d22 202b 2073 7472 2864 656c 6179  ay=" + str(delay
-0000e850: 2920 2b20 2226 726f 6c6c 6261 636b 6f66  ) + "&rollbackof
-0000e860: 6673 6574 3d22 202b 2073 7472 2872 6f6c  fset=" + str(rol
-0000e870: 6c62 6163 6b6f 6666 7365 7429 0d0a 2020  lbackoffset)..  
-0000e880: 2020 2020 2020 2020 202b 2022 2665 6e61           + "&ena
-0000e890: 626c 6574 6c73 3d22 202b 2073 7472 2865  bletls=" + str(e
-0000e8a0: 6e61 626c 6574 6c73 2920 2b20 2226 6272  nabletls) + "&br
-0000e8b0: 6f6b 6572 686f 7374 3d22 2b62 726f 6b65  okerhost="+broke
-0000e8c0: 7268 6f73 742b 2226 6272 6f6b 6572 706f  rhost+"&brokerpo
-0000e8d0: 7274 3d22 2b73 7472 2862 726f 6b65 7270  rt="+str(brokerp
-0000e8e0: 6f72 7429 0d0a 2020 2020 2020 2020 2020  ort)..          
-0000e8f0: 202b 2226 6f66 6673 6574 3d22 2b73 7472   +"&offset="+str
-0000e900: 286f 6666 7365 7429 202b 2226 636f 6d70  (offset) +"&comp
-0000e910: 616e 796e 616d 653d 222b 636f 6d70 616e  anyname="+compan
-0000e920: 796e 616d 652b 2226 6772 6f75 7069 643d  yname+"&groupid=
-0000e930: 222b 6772 6f75 7069 6420 2b20 2226 7072  "+groupid + "&pr
-0000e940: 6570 726f 6365 7373 7479 7065 3d22 202b  eprocesstype=" +
-0000e950: 0d0a 2020 2020 2020 2020 2020 2070 7265  ..           pre
-0000e960: 7072 6f63 6573 7374 7970 6529 0d0a 0d0a  processtype)....
-0000e970: 2020 2020 7661 6c3d 6c6f 6f70 2e72 756e      val=loop.run
-0000e980: 5f75 6e74 696c 5f63 6f6d 706c 6574 6528  _until_complete(
-0000e990: 7463 705f 6563 686f 5f63 6c69 656e 7476  tcp_echo_clientv
-0000e9a0: 6970 6572 2876 616c 7565 2c20 6c6f 6f70  iper(value, loop
-0000e9b0: 2c68 6f73 742c 706f 7274 2c6d 6963 726f  ,host,port,micro
-0000e9c0: 7365 7276 6963 6569 6429 290d 0a20 2020  serviceid))..   
-0000e9d0: 2069 6620 636f 6e6e 6563 7469 6f6e 6572   if connectioner
-0000e9e0: 726f 723a 0d0a 2020 2020 2020 2020 2072  ror:..         r
-0000e9f0: 6574 7572 6e20 636f 6e6e 6563 7469 6f6e  eturn connection
-0000ea00: 6572 726f 720d 0a0d 0a20 2020 2072 6574  error....    ret
-0000ea10: 7572 6e20 7661 6c0d 0a0d 0a64 6566 2076  urn val....def v
-0000ea20: 6970 6572 6d6f 6469 6679 636f 6e73 756d  ipermodifyconsum
-0000ea30: 6572 6465 7461 696c 7328 7669 7065 7274  erdetails(vipert
-0000ea40: 6f6b 656e 2c68 6f73 742c 706f 7274 2c74  oken,host,port,t
-0000ea50: 6f70 6963 2c63 6f6d 7061 6e79 6e61 6d65  opic,companyname
-0000ea60: 2c63 6f6e 7375 6d65 7269 642c 636f 6e74  ,consumerid,cont
-0000ea70: 6163 746e 616d 653d 2727 2c63 6f6e 7461  actname='',conta
-0000ea80: 6374 656d 6169 6c3d 2727 2c6c 6f63 6174  ctemail='',locat
-0000ea90: 696f 6e3d 2727 2c62 726f 6b65 7268 6f73  ion='',brokerhos
-0000eaa0: 743d 2727 2c62 726f 6b65 7270 6f72 743d  t='',brokerport=
-0000eab0: 3930 3932 2c6d 6963 726f 7365 7276 6963  9092,microservic
-0000eac0: 6569 643d 2727 293a 0d0a 2020 2020 676c  eid=''):..    gl
-0000ead0: 6f62 616c 2063 6f6e 6e65 6374 696f 6e65  obal connectione
-0000eae0: 7272 6f72 0d0a 0d0a 2020 2020 6966 2028  rror....    if (
-0000eaf0: 6c65 6e28 686f 7374 293d 3d30 206f 7220  len(host)==0 or 
-0000eb00: 6c65 6e28 7669 7065 7274 6f6b 656e 293d  len(vipertoken)=
-0000eb10: 3d30 206f 7220 706f 7274 3d3d 2d39 3939  =0 or port==-999
-0000eb20: 206f 7220 6c65 6e28 636f 6d70 616e 796e   or len(companyn
-0000eb30: 616d 6529 3d3d 3020 6f72 206c 656e 2863  ame)==0 or len(c
-0000eb40: 6f6e 7375 6d65 7269 6429 3d3d 3020 293a  onsumerid)==0 ):
-0000eb50: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
-0000eb60: 6e20 2250 6c65 6173 6520 656e 7465 7220  n "Please enter 
-0000eb70: 686f 7374 2c70 6f72 742c 7669 7065 7274  host,port,vipert
-0000eb80: 6f6b 656e 2c63 6f6e 7375 6d65 7269 642c  oken,consumerid,
-0000eb90: 636f 6d70 616e 796e 616d 652c 636f 6e73  companyname,cons
-0000eba0: 756d 6572 6964 220d 0a20 2020 2020 2020  umerid"..       
-0000ebb0: 200d 0a20 2020 2076 616c 7565 3d28 226d   ..    value=("m
-0000ebc0: 6f64 6966 7963 6f6e 7375 6d65 7264 6574  odifyconsumerdet
-0000ebd0: 6169 6c73 3f76 6970 6572 746f 6b65 6e3d  ails?vipertoken=
-0000ebe0: 222b 7669 7065 7274 6f6b 656e 202b 2022  "+vipertoken + "
-0000ebf0: 2674 6f70 6963 3d22 2b74 6f70 6963 202b  &topic="+topic +
-0000ec00: 2022 2663 6f6e 7375 6d65 7269 643d 222b   "&consumerid="+
-0000ec10: 636f 6e73 756d 6572 6964 202b 2226 6272  consumerid +"&br
-0000ec20: 6f6b 6572 686f 7374 3d22 2b62 726f 6b65  okerhost="+broke
-0000ec30: 7268 6f73 742b 2226 6272 6f6b 6572 706f  rhost+"&brokerpo
-0000ec40: 7274 3d22 2b73 7472 2862 726f 6b65 7270  rt="+str(brokerp
-0000ec50: 6f72 7429 0d0a 2020 2020 2020 2020 2020  ort)..          
-0000ec60: 2020 2b22 2663 6f6d 7061 6e79 6e61 6d65    +"&companyname
-0000ec70: 3d22 2b63 6f6d 7061 6e79 6e61 6d65 2b22  ="+companyname+"
-0000ec80: 2663 6f6e 7461 6374 6e61 6d65 3d22 2b63  &contactname="+c
-0000ec90: 6f6e 7461 6374 6e61 6d65 2b22 2663 6f6e  ontactname+"&con
-0000eca0: 7461 6374 656d 6169 6c3d 222b 636f 6e74  tactemail="+cont
-0000ecb0: 6163 7465 6d61 696c 2b22 266c 6f63 6174  actemail+"&locat
-0000ecc0: 696f 6e3d 222b 6c6f 6361 7469 6f6e 290d  ion="+location).
-0000ecd0: 0a0d 0a20 2020 2076 616c 3d6c 6f6f 702e  ...    val=loop.
-0000ece0: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
-0000ecf0: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
-0000ed00: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
-0000ed10: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
-0000ed20: 6372 6f73 6572 7669 6365 6964 2929 0d0a  croserviceid))..
-0000ed30: 2020 2020 6966 2063 6f6e 6e65 6374 696f      if connectio
-0000ed40: 6e65 7272 6f72 3a0d 0a20 2020 2020 2020  nerror:..       
-0000ed50: 2020 7265 7475 726e 2063 6f6e 6e65 6374    return connect
-0000ed60: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
-0000ed70: 7265 7475 726e 2076 616c 0d0a 0d0a 6465  return val....de
-0000ed80: 6620 7669 7065 726d 6f64 6966 7974 6f70  f vipermodifytop
-0000ed90: 6963 6465 7461 696c 7328 7669 7065 7274  icdetails(vipert
-0000eda0: 6f6b 656e 2c68 6f73 742c 706f 7274 2c74  oken,host,port,t
-0000edb0: 6f70 6963 2c63 6f6d 7061 6e79 6e61 6d65  opic,companyname
-0000edc0: 2c70 6172 7469 7469 6f6e 3d30 2c65 6e61  ,partition=0,ena
-0000edd0: 626c 6574 6c73 3d31 2c69 7367 726f 7570  bletls=1,isgroup
-0000ede0: 3d30 2c63 6f6e 7461 6374 6e61 6d65 3d27  =0,contactname='
-0000edf0: 272c 636f 6e74 6163 7465 6d61 696c 3d27  ',contactemail='
-0000ee00: 272c 6c6f 6361 7469 6f6e 3d27 272c 6272  ',location='',br
-0000ee10: 6f6b 6572 686f 7374 3d27 272c 6272 6f6b  okerhost='',brok
-0000ee20: 6572 706f 7274 3d39 3039 322c 6d69 6372  erport=9092,micr
-0000ee30: 6f73 6572 7669 6365 6964 3d27 2729 3a0d  oserviceid=''):.
-0000ee40: 0a20 2020 2067 6c6f 6261 6c20 636f 6e6e  .    global conn
-0000ee50: 6563 7469 6f6e 6572 726f 720d 0a0d 0a20  ectionerror.... 
-0000ee60: 2020 2069 6620 286c 656e 2868 6f73 7429     if (len(host)
-0000ee70: 3d3d 3020 6f72 206c 656e 2876 6970 6572  ==0 or len(viper
-0000ee80: 746f 6b65 6e29 3d3d 3020 6f72 2070 6f72  token)==0 or por
-0000ee90: 743d 3d2d 3939 3920 6f72 206c 656e 2863  t==-999 or len(c
-0000eea0: 6f6d 7061 6e79 6e61 6d65 293d 3d30 206f  ompanyname)==0 o
-0000eeb0: 7220 6c65 6e28 746f 7069 6329 3d3d 3029  r len(topic)==0)
-0000eec0: 3a0d 0a20 2020 2020 2020 2020 7265 7475  :..         retu
-0000eed0: 726e 2022 506c 6561 7365 2065 6e74 6572  rn "Please enter
-0000eee0: 2068 6f73 742c 706f 7274 2c74 6f70 6963   host,port,topic
-0000eef0: 2c76 6970 6572 746f 6b65 6e2c 636f 6e73  ,vipertoken,cons
-0000ef00: 756d 6572 6964 2c63 6f6d 7061 6e79 6e61  umerid,companyna
-0000ef10: 6d65 220d 0a20 2020 2020 2020 200d 0a20  me"..        .. 
-0000ef20: 2020 2076 616c 7565 3d28 226d 6f64 6966     value=("modif
-0000ef30: 7974 6f70 6963 6465 7461 696c 733f 7669  ytopicdetails?vi
-0000ef40: 7065 7274 6f6b 656e 3d22 2b76 6970 6572  pertoken="+viper
-0000ef50: 746f 6b65 6e20 2b20 2226 746f 7069 633d  token + "&topic=
-0000ef60: 222b 746f 7069 6320 2b22 2662 726f 6b65  "+topic +"&broke
-0000ef70: 7268 6f73 743d 222b 6272 6f6b 6572 686f  rhost="+brokerho
-0000ef80: 7374 2b22 2662 726f 6b65 7270 6f72 743d  st+"&brokerport=
-0000ef90: 222b 7374 7228 6272 6f6b 6572 706f 7274  "+str(brokerport
-0000efa0: 290d 0a20 2020 2020 2020 2020 202b 2022  )..          + "
-0000efb0: 2669 7367 726f 7570 3d22 202b 2073 7472  &isgroup=" + str
-0000efc0: 2869 7367 726f 7570 2920 2b22 2670 6172  (isgroup) +"&par
-0000efd0: 7469 7469 6f6e 3d22 2b73 7472 2870 6172  tition="+str(par
-0000efe0: 7469 7469 6f6e 2920 2b22 2665 6e61 626c  tition) +"&enabl
-0000eff0: 6574 6c73 3d22 2b73 7472 2865 6e61 626c  etls="+str(enabl
-0000f000: 6574 6c73 292b 2226 636f 6d70 616e 796e  etls)+"&companyn
-0000f010: 616d 653d 222b 636f 6d70 616e 796e 616d  ame="+companynam
-0000f020: 652b 2226 636f 6e74 6163 746e 616d 653d  e+"&contactname=
-0000f030: 222b 636f 6e74 6163 746e 616d 652b 2226  "+contactname+"&
-0000f040: 636f 6e74 6163 7465 6d61 696c 3d22 2b63  contactemail="+c
-0000f050: 6f6e 7461 6374 656d 6169 6c2b 2226 6c6f  ontactemail+"&lo
-0000f060: 6361 7469 6f6e 3d22 2b6c 6f63 6174 696f  cation="+locatio
-0000f070: 6e29 0d0a 0d0a 2020 2020 7661 6c3d 6c6f  n)....    val=lo
-0000f080: 6f70 2e72 756e 5f75 6e74 696c 5f63 6f6d  op.run_until_com
-0000f090: 706c 6574 6528 7463 705f 6563 686f 5f63  plete(tcp_echo_c
-0000f0a0: 6c69 656e 7476 6970 6572 2876 616c 7565  lientviper(value
-0000f0b0: 2c20 6c6f 6f70 2c68 6f73 742c 706f 7274  , loop,host,port
-0000f0c0: 2c6d 6963 726f 7365 7276 6963 6569 6429  ,microserviceid)
-0000f0d0: 290d 0a20 2020 2069 6620 636f 6e6e 6563  )..    if connec
-0000f0e0: 7469 6f6e 6572 726f 723a 0d0a 2020 2020  tionerror:..    
-0000f0f0: 2020 2020 2072 6574 7572 6e20 636f 6e6e       return conn
-0000f100: 6563 7469 6f6e 6572 726f 720d 0a0d 0a20  ectionerror.... 
-0000f110: 2020 2072 6574 7572 6e20 7661 6c0d 0a0d     return val...
-0000f120: 0a64 6566 2076 6970 6572 6163 7469 7661  .def viperactiva
-0000f130: 7465 746f 7069 6328 7669 7065 7274 6f6b  tetopic(vipertok
-0000f140: 656e 2c68 6f73 742c 706f 7274 2c74 6f70  en,host,port,top
-0000f150: 6963 2c6d 6963 726f 7365 7276 6963 6569  ic,microservicei
-0000f160: 643d 2727 293a 0d0a 2020 2020 676c 6f62  d=''):..    glob
-0000f170: 616c 2063 6f6e 6e65 6374 696f 6e65 7272  al connectionerr
-0000f180: 6f72 0d0a 0d0a 2020 2020 6966 2028 6c65  or....    if (le
-0000f190: 6e28 686f 7374 293d 3d30 206f 7220 6c65  n(host)==0 or le
-0000f1a0: 6e28 7669 7065 7274 6f6b 656e 293d 3d30  n(vipertoken)==0
-0000f1b0: 206f 7220 706f 7274 3d3d 2d39 3939 206f   or port==-999 o
-0000f1c0: 7220 6c65 6e28 746f 7069 6329 3d3d 3020  r len(topic)==0 
-0000f1d0: 2029 3a0d 0a20 2020 2020 2020 2020 7265   ):..         re
-0000f1e0: 7475 726e 2022 506c 6561 7365 2065 6e74  turn "Please ent
-0000f1f0: 6572 2068 6f73 742c 706f 7274 2c76 6970  er host,port,vip
-0000f200: 6572 746f 6b65 6e2c 746f 7069 6322 0d0a  ertoken,topic"..
-0000f210: 2020 2020 2020 2020 0d0a 2020 2020 7661          ..    va
-0000f220: 6c75 653d 2822 6163 7469 7661 7465 746f  lue=("activateto
-0000f230: 7069 633f 7669 7065 7274 6f6b 656e 3d22  pic?vipertoken="
-0000f240: 2b76 6970 6572 746f 6b65 6e20 2b20 2226  +vipertoken + "&
-0000f250: 746f 7069 633d 222b 746f 7069 6320 290d  topic="+topic ).
-0000f260: 0a0d 0a20 2020 2076 616c 3d6c 6f6f 702e  ...    val=loop.
-0000f270: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
-0000f280: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
-0000f290: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
-0000f2a0: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
-0000f2b0: 6372 6f73 6572 7669 6365 6964 2929 0d0a  croserviceid))..
-0000f2c0: 2020 2020 6966 2063 6f6e 6e65 6374 696f      if connectio
-0000f2d0: 6e65 7272 6f72 3a0d 0a20 2020 2020 2020  nerror:..       
-0000f2e0: 2020 7265 7475 726e 2063 6f6e 6e65 6374    return connect
-0000f2f0: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
-0000f300: 7265 7475 726e 2076 616c 0d0a 0d0a 6465  return val....de
-0000f310: 6620 7669 7065 7264 656c 6574 6574 6f70  f viperdeletetop
-0000f320: 6963 7328 7669 7065 7274 6f6b 656e 2c68  ics(vipertoken,h
-0000f330: 6f73 742c 706f 7274 2c74 6f70 6963 2c65  ost,port,topic,e
-0000f340: 6e61 626c 6574 6c73 3d31 2c62 726f 6b65  nabletls=1,broke
-0000f350: 7268 6f73 743d 2727 2c62 726f 6b65 7270  rhost='',brokerp
-0000f360: 6f72 743d 3930 3932 2c6d 6963 726f 7365  ort=9092,microse
-0000f370: 7276 6963 6569 643d 2727 293a 0d0a 2020  rviceid=''):..  
-0000f380: 2020 676c 6f62 616c 2063 6f6e 6e65 6374    global connect
-0000f390: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
-0000f3a0: 6966 2028 6c65 6e28 686f 7374 293d 3d30  if (len(host)==0
-0000f3b0: 206f 7220 6c65 6e28 7669 7065 7274 6f6b   or len(vipertok
-0000f3c0: 656e 293d 3d30 206f 7220 706f 7274 3d3d  en)==0 or port==
-0000f3d0: 2d39 3939 206f 7220 6c65 6e28 746f 7069  -999 or len(topi
-0000f3e0: 6329 3d3d 3020 2029 3a0d 0a20 2020 2020  c)==0  ):..     
-0000f3f0: 2020 2020 7265 7475 726e 2022 506c 6561      return "Plea
-0000f400: 7365 2065 6e74 6572 2068 6f73 742c 706f  se enter host,po
-0000f410: 7274 2c76 6970 6572 746f 6b65 6e2c 746f  rt,vipertoken,to
-0000f420: 7069 6322 0d0a 2020 2020 2020 2020 0d0a  pic"..        ..
-0000f430: 2020 2020 7661 6c75 653d 2822 6465 6c65      value=("dele
-0000f440: 7465 746f 7069 6373 3f76 6970 6572 746f  tetopics?viperto
-0000f450: 6b65 6e3d 222b 7669 7065 7274 6f6b 656e  ken="+vipertoken
-0000f460: 202b 2022 2674 6f70 6963 3d22 2b74 6f70   + "&topic="+top
-0000f470: 6963 202b 2226 656e 6162 6c65 746c 733d  ic +"&enabletls=
-0000f480: 222b 7374 7228 656e 6162 6c65 746c 7329  "+str(enabletls)
-0000f490: 202b 2226 6272 6f6b 6572 686f 7374 3d22   +"&brokerhost="
-0000f4a0: 2b62 726f 6b65 7268 6f73 742b 2226 6272  +brokerhost+"&br
-0000f4b0: 6f6b 6572 706f 7274 3d22 2b73 7472 2862  okerport="+str(b
-0000f4c0: 726f 6b65 7270 6f72 7429 290d 0a0d 0a20  rokerport)).... 
-0000f4d0: 2020 2076 616c 3d6c 6f6f 702e 7275 6e5f     val=loop.run_
-0000f4e0: 756e 7469 6c5f 636f 6d70 6c65 7465 2874  until_complete(t
-0000f4f0: 6370 5f65 6368 6f5f 636c 6965 6e74 7669  cp_echo_clientvi
-0000f500: 7065 7228 7661 6c75 652c 206c 6f6f 702c  per(value, loop,
-0000f510: 686f 7374 2c70 6f72 742c 6d69 6372 6f73  host,port,micros
-0000f520: 6572 7669 6365 6964 2929 0d0a 2020 2020  erviceid))..    
-0000f530: 6966 2063 6f6e 6e65 6374 696f 6e65 7272  if connectionerr
-0000f540: 6f72 3a0d 0a20 2020 2020 2020 2020 7265  or:..         re
-0000f550: 7475 726e 2063 6f6e 6e65 6374 696f 6e65  turn connectione
-0000f560: 7272 6f72 0d0a 0d0a 2020 2020 7265 7475  rror....    retu
-0000f570: 726e 2076 616c 0d0a 0d0a 6465 6620 7669  rn val....def vi
-0000f580: 7065 7264 6561 6374 6976 6174 6574 6f70  perdeactivatetop
-0000f590: 6963 2876 6970 6572 746f 6b65 6e2c 686f  ic(vipertoken,ho
-0000f5a0: 7374 2c70 6f72 742c 746f 7069 632c 6d69  st,port,topic,mi
-0000f5b0: 6372 6f73 6572 7669 6365 6964 3d27 2729  croserviceid='')
-0000f5c0: 3a0d 0a20 2020 2067 6c6f 6261 6c20 636f  :..    global co
-0000f5d0: 6e6e 6563 7469 6f6e 6572 726f 720d 0a0d  nnectionerror...
-0000f5e0: 0a20 2020 2069 6620 286c 656e 2868 6f73  .    if (len(hos
-0000f5f0: 7429 3d3d 3020 6f72 206c 656e 2876 6970  t)==0 or len(vip
-0000f600: 6572 746f 6b65 6e29 3d3d 3020 6f72 2070  ertoken)==0 or p
-0000f610: 6f72 743d 3d2d 3939 3920 6f72 206c 656e  ort==-999 or len
-0000f620: 2874 6f70 6963 293d 3d30 2020 293a 0d0a  (topic)==0  ):..
-0000f630: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000f640: 2250 6c65 6173 6520 656e 7465 7220 686f  "Please enter ho
-0000f650: 7374 2c70 6f72 742c 7669 7065 7274 6f6b  st,port,vipertok
-0000f660: 656e 2c74 6f70 6963 220d 0a20 2020 2020  en,topic"..     
-0000f670: 2020 200d 0a20 2020 2076 616c 7565 3d28     ..    value=(
-0000f680: 2264 6561 6374 6976 6174 6574 6f70 6963  "deactivatetopic
-0000f690: 3f76 6970 6572 746f 6b65 6e3d 222b 7669  ?vipertoken="+vi
-0000f6a0: 7065 7274 6f6b 656e 202b 2022 2674 6f70  pertoken + "&top
-0000f6b0: 6963 3d22 2b74 6f70 6963 2029 0d0a 0d0a  ic="+topic )....
-0000f6c0: 2020 2020 7661 6c3d 6c6f 6f70 2e72 756e      val=loop.run
-0000f6d0: 5f75 6e74 696c 5f63 6f6d 706c 6574 6528  _until_complete(
-0000f6e0: 7463 705f 6563 686f 5f63 6c69 656e 7476  tcp_echo_clientv
-0000f6f0: 6970 6572 2876 616c 7565 2c20 6c6f 6f70  iper(value, loop
-0000f700: 2c68 6f73 742c 706f 7274 2c6d 6963 726f  ,host,port,micro
-0000f710: 7365 7276 6963 6569 6429 290d 0a20 2020  serviceid))..   
-0000f720: 2069 6620 636f 6e6e 6563 7469 6f6e 6572   if connectioner
-0000f730: 726f 723a 0d0a 2020 2020 2020 2020 2072  ror:..         r
-0000f740: 6574 7572 6e20 636f 6e6e 6563 7469 6f6e  eturn connection
-0000f750: 6572 726f 720d 0a0d 0a20 2020 2072 6574  error....    ret
-0000f760: 7572 6e20 7661 6c0d 0a0d 0a64 6566 2076  urn val....def v
-0000f770: 6970 6572 6772 6f75 7061 6374 6976 6174  ipergroupactivat
-0000f780: 6528 7669 7065 7274 6f6b 656e 2c68 6f73  e(vipertoken,hos
-0000f790: 742c 706f 7274 2c67 726f 7570 6e61 6d65  t,port,groupname
-0000f7a0: 2c67 726f 7570 6964 2c6d 6963 726f 7365  ,groupid,microse
-0000f7b0: 7276 6963 6569 643d 2727 293a 0d0a 2020  rviceid=''):..  
-0000f7c0: 2020 676c 6f62 616c 2063 6f6e 6e65 6374    global connect
-0000f7d0: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
-0000f7e0: 6966 2028 6c65 6e28 686f 7374 293d 3d30  if (len(host)==0
-0000f7f0: 206f 7220 6c65 6e28 7669 7065 7274 6f6b   or len(vipertok
-0000f800: 656e 293d 3d30 206f 7220 706f 7274 3d3d  en)==0 or port==
-0000f810: 2d39 3939 206f 7220 6c65 6e28 6772 6f75  -999 or len(grou
-0000f820: 706e 616d 6529 3d3d 3020 2020 6f72 206c  pname)==0   or l
-0000f830: 656e 2867 726f 7570 6964 293d 3d30 2029  en(groupid)==0 )
-0000f840: 3a0d 0a20 2020 2020 2020 2020 7265 7475  :..         retu
-0000f850: 726e 2022 506c 6561 7365 2065 6e74 6572  rn "Please enter
-0000f860: 2068 6f73 742c 706f 7274 2c76 6970 6572   host,port,viper
-0000f870: 746f 6b65 6e2c 6772 6f75 706e 616d 652c  token,groupname,
-0000f880: 6772 6f75 7069 6422 0d0a 2020 2020 2020  groupid"..      
-0000f890: 2020 0d0a 2020 2020 7661 6c75 653d 2822    ..    value=("
-0000f8a0: 6163 7469 7661 7465 6772 6f75 703f 7669  activategroup?vi
-0000f8b0: 7065 7274 6f6b 656e 3d22 2b76 6970 6572  pertoken="+viper
-0000f8c0: 746f 6b65 6e20 2b20 2226 6772 6f75 706e  token + "&groupn
-0000f8d0: 616d 653d 222b 6772 6f75 706e 616d 6520  ame="+groupname 
-0000f8e0: 2b22 2667 726f 7570 6964 3d22 2b67 726f  +"&groupid="+gro
-0000f8f0: 7570 6964 290d 0a0d 0a20 2020 2076 616c  upid)....    val
-0000f900: 3d6c 6f6f 702e 7275 6e5f 756e 7469 6c5f  =loop.run_until_
-0000f910: 636f 6d70 6c65 7465 2874 6370 5f65 6368  complete(tcp_ech
-0000f920: 6f5f 636c 6965 6e74 7669 7065 7228 7661  o_clientviper(va
-0000f930: 6c75 652c 206c 6f6f 702c 686f 7374 2c70  lue, loop,host,p
-0000f940: 6f72 742c 6d69 6372 6f73 6572 7669 6365  ort,microservice
-0000f950: 6964 2929 0d0a 2020 2020 6966 2063 6f6e  id))..    if con
-0000f960: 6e65 6374 696f 6e65 7272 6f72 3a0d 0a20  nectionerror:.. 
-0000f970: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-0000f980: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
-0000f990: 0d0a 2020 2020 7265 7475 726e 2076 616c  ..    return val
-0000f9a0: 0d0a 0d0a 6465 6620 7669 7065 7267 726f  ....def vipergro
-0000f9b0: 7570 6465 6163 7469 7661 7465 2876 6970  updeactivate(vip
-0000f9c0: 6572 746f 6b65 6e2c 686f 7374 2c70 6f72  ertoken,host,por
-0000f9d0: 742c 6772 6f75 706e 616d 652c 6772 6f75  t,groupname,grou
-0000f9e0: 7069 642c 6d69 6372 6f73 6572 7669 6365  pid,microservice
-0000f9f0: 6964 3d27 2729 3a0d 0a20 2020 2067 6c6f  id=''):..    glo
-0000fa00: 6261 6c20 636f 6e6e 6563 7469 6f6e 6572  bal connectioner
-0000fa10: 726f 720d 0a0d 0a20 2020 2069 6620 286c  ror....    if (l
-0000fa20: 656e 2868 6f73 7429 3d3d 3020 6f72 206c  en(host)==0 or l
-0000fa30: 656e 2876 6970 6572 746f 6b65 6e29 3d3d  en(vipertoken)==
-0000fa40: 3020 6f72 2070 6f72 743d 3d2d 3939 3920  0 or port==-999 
-0000fa50: 6f72 206c 656e 2867 726f 7570 6e61 6d65  or len(groupname
-0000fa60: 293d 3d30 2020 206f 7220 6c65 6e28 6772  )==0   or len(gr
-0000fa70: 6f75 7069 6429 3d3d 3020 293a 0d0a 2020  oupid)==0 ):..  
-0000fa80: 2020 2020 2020 2072 6574 7572 6e20 2250         return "P
-0000fa90: 6c65 6173 6520 656e 7465 7220 686f 7374  lease enter host
-0000faa0: 2c70 6f72 742c 7669 7065 7274 6f6b 656e  ,port,vipertoken
-0000fab0: 2c67 726f 7570 6e61 6d65 2c67 726f 7570  ,groupname,group
-0000fac0: 6964 220d 0a20 2020 2020 2020 200d 0a20  id"..        .. 
-0000fad0: 2020 2076 616c 7565 3d28 2264 6561 6374     value=("deact
-0000fae0: 6976 6174 6567 726f 7570 3f76 6970 6572  ivategroup?viper
-0000faf0: 746f 6b65 6e3d 222b 7669 7065 7274 6f6b  token="+vipertok
-0000fb00: 656e 202b 2022 2667 726f 7570 6e61 6d65  en + "&groupname
-0000fb10: 3d22 2b67 726f 7570 6e61 6d65 202b 2226  ="+groupname +"&
-0000fb20: 6772 6f75 7069 643d 222b 6772 6f75 7069  groupid="+groupi
-0000fb30: 6429 0d0a 0d0a 2020 2020 7661 6c3d 6c6f  d)....    val=lo
-0000fb40: 6f70 2e72 756e 5f75 6e74 696c 5f63 6f6d  op.run_until_com
-0000fb50: 706c 6574 6528 7463 705f 6563 686f 5f63  plete(tcp_echo_c
-0000fb60: 6c69 656e 7476 6970 6572 2876 616c 7565  lientviper(value
-0000fb70: 2c20 6c6f 6f70 2c68 6f73 742c 706f 7274  , loop,host,port
-0000fb80: 2c6d 6963 726f 7365 7276 6963 6569 6429  ,microserviceid)
-0000fb90: 290d 0a20 2020 2069 6620 636f 6e6e 6563  )..    if connec
-0000fba0: 7469 6f6e 6572 726f 723a 0d0a 2020 2020  tionerror:..    
-0000fbb0: 2020 2020 2072 6574 7572 6e20 636f 6e6e       return conn
-0000fbc0: 6563 7469 6f6e 6572 726f 720d 0a0d 0a20  ectionerror.... 
-0000fbd0: 2020 2072 6574 7572 6e20 7661 6c0d 0a0d     return val...
-0000fbe0: 0a0d 0a64 6566 2076 6970 6572 6e6c 7028  ...def vipernlp(
-0000fbf0: 6669 6c65 6e61 6d65 2c66 7661 6c75 652c  filename,fvalue,
-0000fc00: 6b65 7973 293a 0d0a 2020 2020 6966 2066  keys):..    if f
-0000fc10: 696c 656e 616d 653d 3d22 223a 0d0a 2020  ilename=="":..  
-0000fc20: 2020 2020 2020 2072 6574 7572 6e20 2250         return "P
-0000fc30: 6c65 6173 6520 656e 7465 7220 686f 7374  lease enter host
-0000fc40: 2c70 6f72 742c 7669 7065 7274 6f6b 656e  ,port,vipertoken
-0000fc50: 2c67 726f 7570 6e61 6d65 2c67 726f 7570  ,groupname,group
-0000fc60: 6964 220d 0a20 2020 2069 6620 6676 616c  id"..    if fval
-0000fc70: 7565 203e 2031 3030 3030 3a0d 0a20 2020  ue > 10000:..   
-0000fc80: 2020 2020 2072 6574 7572 6e20 2253 756d       return "Sum
-0000fc90: 6d61 7279 2063 6f75 6e74 2074 6f6f 2068  mary count too h
-0000fca0: 6967 682e 204d 7573 7420 6265 2020 3c20  igh. Must be  < 
-0000fcb0: 3130 3030 3022 0d0a 2020 2020 6966 206b  10000"..    if k
-0000fcc0: 6579 7320 3e20 3130 303a 0d0a 2020 2020  eys > 100:..    
-0000fcd0: 2020 2020 7265 7475 726e 2022 4b65 7977      return "Keyw
-0000fce0: 6f72 6420 636f 756e 7420 746f 6f20 6869  ord count too hi
-0000fcf0: 6768 2e20 4d75 7374 2062 6520 203c 2031  gh. Must be  < 1
-0000fd00: 3030 220d 0a20 2020 2020 2020 200d 0a20  00"..        .. 
-0000fd10: 2020 2072 6574 7572 6e20 7374 6172 7470     return startp
-0000fd20: 6466 7265 6164 696e 6728 6669 6c65 6e61  dfreading(filena
-0000fd30: 6d65 2c66 7661 6c75 652c 6b65 7973 290d  me,fvalue,keys).
-0000fd40: 0a0d 0a64 6566 2076 6970 6572 6368 6174  ...def viperchat
-0000fd50: 6770 7428 6f70 656e 6169 6b65 792c 7465  gpt(openaikey,te
-0000fd60: 7874 746f 616e 616c 7973 652c 7175 6572  xttoanalyse,quer
-0000fd70: 792c 2074 656d 7065 7261 7475 7265 2c6d  y, temperature,m
-0000fd80: 6f64 656c 6e61 6d65 293a 0d0a 2020 2020  odelname):..    
-0000fd90: 6966 206f 7065 6e61 696b 6579 3d3d 2222  if openaikey==""
-0000fda0: 3a0d 0a20 2020 2020 2020 2020 7265 7475  :..         retu
-0000fdb0: 726e 2022 506c 6561 7365 2065 6e74 6572  rn "Please enter
-0000fdc0: 204f 7065 6e41 4920 6b65 7922 0d0a 2020   OpenAI key"..  
-0000fdd0: 2020 6966 2074 6578 7474 6f61 6e61 6c79    if texttoanaly
-0000fde0: 7365 203d 3d20 2222 3a0d 0a20 2020 2020  se == "":..     
-0000fdf0: 2020 2072 6574 7572 6e20 2245 6e74 6572     return "Enter
-0000fe00: 2074 6578 7420 746f 2061 6e61 6c79 7365   text to analyse
-0000fe10: 220d 0a20 2020 2069 6620 7175 6572 7920  "..    if query 
-0000fe20: 3d3d 2022 223a 0d0a 2020 2020 2020 2020  == "":..        
-0000fe30: 7265 7475 726e 2022 456e 7465 7220 4368  return "Enter Ch
-0000fe40: 6174 6770 7420 7072 6f6d 7074 7322 0d0a  atgpt prompts"..
-0000fe50: 2020 2020 6966 2074 656d 7065 7261 7475      if temperatu
-0000fe60: 7265 203e 2031 206f 7220 7465 6d70 6572  re > 1 or temper
-0000fe70: 6174 7572 6520 3c20 303a 0d0a 2020 2020  ature < 0:..    
-0000fe80: 2020 2020 7265 7475 726e 2022 496e 7661      return "Inva
-0000fe90: 6c75 6520 7465 6d70 6572 6174 7572 6520  lue temperature 
-0000fea0: 2d20 7368 6f75 6c64 2062 6520 6265 7477  - should be betw
-0000feb0: 6565 6e20 302d 3120 692e 652e 2030 2e37  een 0-1 i.e. 0.7
-0000fec0: 220d 0a20 2020 2069 6620 6d6f 6465 6c6e  "..    if modeln
-0000fed0: 616d 6520 3d3d 2022 223a 0d0a 2020 2020  ame == "":..    
-0000fee0: 2020 2020 7265 7475 726e 2022 5370 6563      return "Spec
-0000fef0: 6966 7920 6d6f 6465 6c20 6e61 6d65 206c  ify model name l
-0000ff00: 696b 6520 2774 6578 742d 6461 7669 6e63  ike 'text-davinc
-0000ff10: 692d 3030 3227 206f 7220 2774 6578 742d  i-002' or 'text-
-0000ff20: 6375 7269 652d 3030 3127 220d 0a0d 0a20  curie-001'".... 
-0000ff30: 2020 206f 732e 656e 7669 726f 6e5b 224f     os.environ["O
-0000ff40: 5045 4e41 495f 4150 495f 4b45 5922 5d20  PENAI_API_KEY"] 
-0000ff50: 3d20 6f70 656e 6169 6b65 790d 0a20 2020  = openaikey..   
-0000ff60: 2020 2020 200d 0a20 2020 2072 6573 203d       ..    res =
-0000ff70: 2073 7461 7274 5f63 6f6e 7665 7273 6174   start_conversat
-0000ff80: 696f 6e28 6f70 656e 6169 6b65 792c 7175  ion(openaikey,qu
-0000ff90: 6572 792c 7465 7874 746f 616e 616c 7973  ery,texttoanalys
-0000ffa0: 652c 7465 6d70 6572 6174 7572 652c 6d6f  e,temperature,mo
-0000ffb0: 6465 6c6e 616d 6529 0d0a 2020 2020 6368  delname)..    ch
-0000ffc0: 6174 6770 7472 6573 706f 6e73 6520 3d20  atgptresponse = 
-0000ffd0: 7265 735b 276f 7574 7075 745f 7465 7874  res['output_text
-0000ffe0: 275d 0d0a 2020 2020 6368 6174 6770 7472  ']..    chatgptr
-0000fff0: 6573 706f 6e73 652e 7265 706c 6163 6528  esponse.replace(
-00010000: 225c 5c6e 222c 2222 292e 7265 706c 6163  "\\n","").replac
-00010010: 6528 225c 5c72 222c 2022 2229 0d0a 2020  e("\\r", "")..  
-00010020: 2020 6368 6174 6770 7472 6573 706f 6e73    chatgptrespons
-00010030: 6520 3d20 6368 6174 6770 7472 6573 706f  e = chatgptrespo
-00010040: 6e73 652e 7265 706c 6163 6528 275c 5c75  nse.replace('\\u
-00010050: 272c 2755 2b27 290d 0a0d 0a20 2020 2063  ','U+')....    c
-00010060: 6861 7467 7074 7265 7370 6f6e 7365 203d  hatgptresponse =
-00010070: 2072 652e 7375 6228 7227 3c55 5c2b 285b   re.sub(r'<U\+([
-00010080: 302d 3961 2d66 412d 465d 7b34 2c36 7d29  0-9a-fA-F]{4,6})
-00010090: 3e27 2c20 6c61 6d62 6461 2078 3a20 6368  >', lambda x: ch
-000100a0: 7228 696e 7428 782e 6772 6f75 7028 3129  r(int(x.group(1)
-000100b0: 2c31 3629 292c 2063 6861 7467 7074 7265  ,16)), chatgptre
-000100c0: 7370 6f6e 7365 290d 0a0d 0a20 2020 2072  sponse)....    r
-000100d0: 6574 7572 6e20 6368 6174 6770 7472 6573  eturn chatgptres
-000100e0: 706f 6e73 650d 0a0d 0a64 6566 2076 6970  ponse....def vip
-000100f0: 6572 6578 7261 6374 7064 6666 6965 6c64  erexractpdffield
-00010100: 7328 6669 6c65 6e61 6d65 293a 0d0a 2020  s(filename):..  
-00010110: 2020 6966 2066 696c 656e 616d 653d 3d22    if filename=="
-00010120: 223a 0d0a 2020 2020 2020 2020 7265 7475  ":..        retu
-00010130: 726e 2022 456e 7465 7220 5044 4620 6669  rn "Enter PDF fi
-00010140: 6c65 6e61 6d65 220d 0a0d 0a20 2020 200d  lename"....    .
-00010150: 0a20 2020 2072 6574 7572 6e20 6578 7472  .    return extr
-00010160: 6163 7466 6965 6c64 7328 6669 6c65 6e61  actfields(filena
-00010170: 6d65 290d 0a0d 0a64 6566 2076 6970 6572  me)....def viper
-00010180: 6578 7261 6374 7064 6666 6965 6c64 6279  exractpdffieldby
-00010190: 6c61 6265 6c28 6669 6c65 6e61 6d65 2c6c  label(filename,l
-000101a0: 6162 656c 6e61 6d65 2c61 6372 6f74 7970  abelname,acrotyp
-000101b0: 6529 3a0d 0a20 2020 2069 6620 6669 6c65  e):..    if file
-000101c0: 6e61 6d65 3d3d 2222 206f 7220 6c61 6265  name=="" or labe
-000101d0: 6c6e 616d 653d 3d22 2220 6f72 2061 6372  lname=="" or acr
-000101e0: 6f74 7970 653d 3d22 223a 0d0a 2020 2020  otype=="":..    
-000101f0: 2020 2020 7265 7475 726e 2022 456e 7465      return "Ente
-00010200: 7220 5044 4620 6669 6c65 6e61 6d65 2c20  r PDF filename, 
-00010210: 6c61 6265 6c6e 616d 6520 616e 6420 6163  labelname and ac
-00010220: 726f 7479 7065 220d 0a20 2020 200d 0a20  rotype"..    .. 
-00010230: 2020 2072 6574 7572 6e20 6c61 6265 6c66     return labelf
-00010240: 6965 6c64 7328 6669 6c65 6e61 6d65 2c6c  ields(filename,l
-00010250: 6162 656c 6e61 6d65 2c61 6372 6f74 7970  abelname,acrotyp
-00010260: 6529 0d0a 0d0a 6465 6620 7669 7065 7263  e)....def viperc
-00010270: 6861 7467 7074 7374 7265 616d 2876 6970  hatgptstream(vip
-00010280: 6572 746f 6b65 6e2c 686f 7374 2c70 6f72  ertoken,host,por
-00010290: 742c 6f70 656e 6169 6b65 792c 746f 7069  t,openaikey,topi
-000102a0: 632c 7465 7874 746f 616e 616c 7973 652c  c,texttoanalyse,
-000102b0: 7175 6572 792c 2074 656d 7065 7261 7475  query, temperatu
-000102c0: 7265 2c6d 6f64 656c 6e61 6d65 2c6a 736f  re,modelname,jso
-000102d0: 6e70 6174 682c 7072 6f64 7563 6574 6f2c  npath,produceto,
-000102e0: 6d61 7872 6f77 732c 0d0a 2020 2020 2020  maxrows,..      
+0000e660: 2020 2020 2020 2020 2020 206f 6666 7365             offse
+0000e670: 743d 2d31 2c72 6f6c 6c62 6163 6b6f 6666  t=-1,rollbackoff
+0000e680: 7365 743d 302c 6272 6f6b 6572 686f 7374  set=0,brokerhost
+0000e690: 3d27 272c 6272 6f6b 6572 706f 7274 3d2d  ='',brokerport=-
+0000e6a0: 3939 392c 6d69 6372 6f73 6572 7669 6365  999,microservice
+0000e6b0: 6964 3d27 272c 7072 6570 726f 6365 7373  id='',preprocess
+0000e6c0: 7479 7065 3d27 2729 3a0d 0a20 2020 2067  type=''):..    g
+0000e6d0: 6c6f 6261 6c20 636f 6e6e 6563 7469 6f6e  lobal connection
+0000e6e0: 6572 726f 720d 0a0d 0a20 2020 2069 6620  error....    if 
+0000e6f0: 286c 656e 2868 6f73 7429 3d3d 3020 6f72  (len(host)==0 or
+0000e700: 206c 656e 2876 6970 6572 746f 6b65 6e29   len(vipertoken)
+0000e710: 3d3d 3020 6f72 206c 656e 2867 726f 7570  ==0 or len(group
+0000e720: 6964 293d 3d30 206f 7220 6c65 6e28 636f  id)==0 or len(co
+0000e730: 6d70 616e 796e 616d 6529 3d3d 3029 3a0d  mpanyname)==0):.
+0000e740: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
+0000e750: 2022 506c 6561 7365 2065 6e74 6572 2068   "Please enter h
+0000e760: 6f73 742c 706f 7274 2c76 6970 6572 746f  ost,port,viperto
+0000e770: 6b65 6e2c 636f 6d70 616e 796e 616d 652c  ken,companyname,
+0000e780: 6772 6f75 7069 6422 0d0a 2020 2020 2020  groupid"..      
+0000e790: 2020 0d0a 2020 2020 7661 6c75 653d 2822    ..    value=("
+0000e7a0: 636f 6e73 756d 6572 6772 6f75 7063 6f6e  consumergroupcon
+0000e7b0: 7375 6d65 6672 6f6d 746f 7069 633f 7669  sumefromtopic?vi
+0000e7c0: 7065 7274 6f6b 656e 3d22 2b76 6970 6572  pertoken="+viper
+0000e7d0: 746f 6b65 6e20 2b20 2226 746f 7069 633d  token + "&topic=
+0000e7e0: 222b 746f 7069 6320 2b20 2226 636f 6e73  "+topic + "&cons
+0000e7f0: 756d 6572 6964 3d22 2b63 6f6e 7375 6d65  umerid="+consume
+0000e800: 7269 6420 2b0d 0a20 2020 2020 2020 2022  rid +..        "
+0000e810: 2670 6172 7469 7469 6f6e 3d22 202b 2073  &partition=" + s
+0000e820: 7472 2870 6172 7469 7469 6f6e 2920 2b20  tr(partition) + 
+0000e830: 2022 2664 656c 6179 3d22 202b 2073 7472   "&delay=" + str
+0000e840: 2864 656c 6179 2920 2b20 2226 726f 6c6c  (delay) + "&roll
+0000e850: 6261 636b 6f66 6673 6574 3d22 202b 2073  backoffset=" + s
+0000e860: 7472 2872 6f6c 6c62 6163 6b6f 6666 7365  tr(rollbackoffse
+0000e870: 7429 0d0a 2020 2020 2020 2020 2020 202b  t)..           +
+0000e880: 2022 2665 6e61 626c 6574 6c73 3d22 202b   "&enabletls=" +
+0000e890: 2073 7472 2865 6e61 626c 6574 6c73 2920   str(enabletls) 
+0000e8a0: 2b20 2226 6272 6f6b 6572 686f 7374 3d22  + "&brokerhost="
+0000e8b0: 2b62 726f 6b65 7268 6f73 742b 2226 6272  +brokerhost+"&br
+0000e8c0: 6f6b 6572 706f 7274 3d22 2b73 7472 2862  okerport="+str(b
+0000e8d0: 726f 6b65 7270 6f72 7429 0d0a 2020 2020  rokerport)..    
+0000e8e0: 2020 2020 2020 202b 2226 6f66 6673 6574         +"&offset
+0000e8f0: 3d22 2b73 7472 286f 6666 7365 7429 202b  ="+str(offset) +
+0000e900: 2226 636f 6d70 616e 796e 616d 653d 222b  "&companyname="+
+0000e910: 636f 6d70 616e 796e 616d 652b 2226 6772  companyname+"&gr
+0000e920: 6f75 7069 643d 222b 6772 6f75 7069 6420  oupid="+groupid 
+0000e930: 2b20 2226 7072 6570 726f 6365 7373 7479  + "&preprocessty
+0000e940: 7065 3d22 202b 0d0a 2020 2020 2020 2020  pe=" +..        
+0000e950: 2020 2070 7265 7072 6f63 6573 7374 7970     preprocesstyp
+0000e960: 6529 0d0a 0d0a 2020 2020 7661 6c3d 6c6f  e)....    val=lo
+0000e970: 6f70 2e72 756e 5f75 6e74 696c 5f63 6f6d  op.run_until_com
+0000e980: 706c 6574 6528 7463 705f 6563 686f 5f63  plete(tcp_echo_c
+0000e990: 6c69 656e 7476 6970 6572 2876 616c 7565  lientviper(value
+0000e9a0: 2c20 6c6f 6f70 2c68 6f73 742c 706f 7274  , loop,host,port
+0000e9b0: 2c6d 6963 726f 7365 7276 6963 6569 6429  ,microserviceid)
+0000e9c0: 290d 0a20 2020 2069 6620 636f 6e6e 6563  )..    if connec
+0000e9d0: 7469 6f6e 6572 726f 723a 0d0a 2020 2020  tionerror:..    
+0000e9e0: 2020 2020 2072 6574 7572 6e20 636f 6e6e       return conn
+0000e9f0: 6563 7469 6f6e 6572 726f 720d 0a0d 0a20  ectionerror.... 
+0000ea00: 2020 2072 6574 7572 6e20 7661 6c0d 0a0d     return val...
+0000ea10: 0a64 6566 2076 6970 6572 6d6f 6469 6679  .def vipermodify
+0000ea20: 636f 6e73 756d 6572 6465 7461 696c 7328  consumerdetails(
+0000ea30: 7669 7065 7274 6f6b 656e 2c68 6f73 742c  vipertoken,host,
+0000ea40: 706f 7274 2c74 6f70 6963 2c63 6f6d 7061  port,topic,compa
+0000ea50: 6e79 6e61 6d65 2c63 6f6e 7375 6d65 7269  nyname,consumeri
+0000ea60: 642c 636f 6e74 6163 746e 616d 653d 2727  d,contactname=''
+0000ea70: 2c63 6f6e 7461 6374 656d 6169 6c3d 2727  ,contactemail=''
+0000ea80: 2c6c 6f63 6174 696f 6e3d 2727 2c62 726f  ,location='',bro
+0000ea90: 6b65 7268 6f73 743d 2727 2c62 726f 6b65  kerhost='',broke
+0000eaa0: 7270 6f72 743d 3930 3932 2c6d 6963 726f  rport=9092,micro
+0000eab0: 7365 7276 6963 6569 643d 2727 293a 0d0a  serviceid=''):..
+0000eac0: 2020 2020 676c 6f62 616c 2063 6f6e 6e65      global conne
+0000ead0: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
+0000eae0: 2020 6966 2028 6c65 6e28 686f 7374 293d    if (len(host)=
+0000eaf0: 3d30 206f 7220 6c65 6e28 7669 7065 7274  =0 or len(vipert
+0000eb00: 6f6b 656e 293d 3d30 206f 7220 706f 7274  oken)==0 or port
+0000eb10: 3d3d 2d39 3939 206f 7220 6c65 6e28 636f  ==-999 or len(co
+0000eb20: 6d70 616e 796e 616d 6529 3d3d 3020 6f72  mpanyname)==0 or
+0000eb30: 206c 656e 2863 6f6e 7375 6d65 7269 6429   len(consumerid)
+0000eb40: 3d3d 3020 293a 0d0a 2020 2020 2020 2020  ==0 ):..        
+0000eb50: 2072 6574 7572 6e20 2250 6c65 6173 6520   return "Please 
+0000eb60: 656e 7465 7220 686f 7374 2c70 6f72 742c  enter host,port,
+0000eb70: 7669 7065 7274 6f6b 656e 2c63 6f6e 7375  vipertoken,consu
+0000eb80: 6d65 7269 642c 636f 6d70 616e 796e 616d  merid,companynam
+0000eb90: 652c 636f 6e73 756d 6572 6964 220d 0a20  e,consumerid".. 
+0000eba0: 2020 2020 2020 200d 0a20 2020 2076 616c         ..    val
+0000ebb0: 7565 3d28 226d 6f64 6966 7963 6f6e 7375  ue=("modifyconsu
+0000ebc0: 6d65 7264 6574 6169 6c73 3f76 6970 6572  merdetails?viper
+0000ebd0: 746f 6b65 6e3d 222b 7669 7065 7274 6f6b  token="+vipertok
+0000ebe0: 656e 202b 2022 2674 6f70 6963 3d22 2b74  en + "&topic="+t
+0000ebf0: 6f70 6963 202b 2022 2663 6f6e 7375 6d65  opic + "&consume
+0000ec00: 7269 643d 222b 636f 6e73 756d 6572 6964  rid="+consumerid
+0000ec10: 202b 2226 6272 6f6b 6572 686f 7374 3d22   +"&brokerhost="
+0000ec20: 2b62 726f 6b65 7268 6f73 742b 2226 6272  +brokerhost+"&br
+0000ec30: 6f6b 6572 706f 7274 3d22 2b73 7472 2862  okerport="+str(b
+0000ec40: 726f 6b65 7270 6f72 7429 0d0a 2020 2020  rokerport)..    
+0000ec50: 2020 2020 2020 2020 2b22 2663 6f6d 7061          +"&compa
+0000ec60: 6e79 6e61 6d65 3d22 2b63 6f6d 7061 6e79  nyname="+company
+0000ec70: 6e61 6d65 2b22 2663 6f6e 7461 6374 6e61  name+"&contactna
+0000ec80: 6d65 3d22 2b63 6f6e 7461 6374 6e61 6d65  me="+contactname
+0000ec90: 2b22 2663 6f6e 7461 6374 656d 6169 6c3d  +"&contactemail=
+0000eca0: 222b 636f 6e74 6163 7465 6d61 696c 2b22  "+contactemail+"
+0000ecb0: 266c 6f63 6174 696f 6e3d 222b 6c6f 6361  &location="+loca
+0000ecc0: 7469 6f6e 290d 0a0d 0a20 2020 2076 616c  tion)....    val
+0000ecd0: 3d6c 6f6f 702e 7275 6e5f 756e 7469 6c5f  =loop.run_until_
+0000ece0: 636f 6d70 6c65 7465 2874 6370 5f65 6368  complete(tcp_ech
+0000ecf0: 6f5f 636c 6965 6e74 7669 7065 7228 7661  o_clientviper(va
+0000ed00: 6c75 652c 206c 6f6f 702c 686f 7374 2c70  lue, loop,host,p
+0000ed10: 6f72 742c 6d69 6372 6f73 6572 7669 6365  ort,microservice
+0000ed20: 6964 2929 0d0a 2020 2020 6966 2063 6f6e  id))..    if con
+0000ed30: 6e65 6374 696f 6e65 7272 6f72 3a0d 0a20  nectionerror:.. 
+0000ed40: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+0000ed50: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
+0000ed60: 0d0a 2020 2020 7265 7475 726e 2076 616c  ..    return val
+0000ed70: 0d0a 0d0a 6465 6620 7669 7065 726d 6f64  ....def vipermod
+0000ed80: 6966 7974 6f70 6963 6465 7461 696c 7328  ifytopicdetails(
+0000ed90: 7669 7065 7274 6f6b 656e 2c68 6f73 742c  vipertoken,host,
+0000eda0: 706f 7274 2c74 6f70 6963 2c63 6f6d 7061  port,topic,compa
+0000edb0: 6e79 6e61 6d65 2c70 6172 7469 7469 6f6e  nyname,partition
+0000edc0: 3d30 2c65 6e61 626c 6574 6c73 3d31 2c69  =0,enabletls=1,i
+0000edd0: 7367 726f 7570 3d30 2c63 6f6e 7461 6374  sgroup=0,contact
+0000ede0: 6e61 6d65 3d27 272c 636f 6e74 6163 7465  name='',contacte
+0000edf0: 6d61 696c 3d27 272c 6c6f 6361 7469 6f6e  mail='',location
+0000ee00: 3d27 272c 6272 6f6b 6572 686f 7374 3d27  ='',brokerhost='
+0000ee10: 272c 6272 6f6b 6572 706f 7274 3d39 3039  ',brokerport=909
+0000ee20: 322c 6d69 6372 6f73 6572 7669 6365 6964  2,microserviceid
+0000ee30: 3d27 2729 3a0d 0a20 2020 2067 6c6f 6261  =''):..    globa
+0000ee40: 6c20 636f 6e6e 6563 7469 6f6e 6572 726f  l connectionerro
+0000ee50: 720d 0a0d 0a20 2020 2069 6620 286c 656e  r....    if (len
+0000ee60: 2868 6f73 7429 3d3d 3020 6f72 206c 656e  (host)==0 or len
+0000ee70: 2876 6970 6572 746f 6b65 6e29 3d3d 3020  (vipertoken)==0 
+0000ee80: 6f72 2070 6f72 743d 3d2d 3939 3920 6f72  or port==-999 or
+0000ee90: 206c 656e 2863 6f6d 7061 6e79 6e61 6d65   len(companyname
+0000eea0: 293d 3d30 206f 7220 6c65 6e28 746f 7069  )==0 or len(topi
+0000eeb0: 6329 3d3d 3029 3a0d 0a20 2020 2020 2020  c)==0):..       
+0000eec0: 2020 7265 7475 726e 2022 506c 6561 7365    return "Please
+0000eed0: 2065 6e74 6572 2068 6f73 742c 706f 7274   enter host,port
+0000eee0: 2c74 6f70 6963 2c76 6970 6572 746f 6b65  ,topic,vipertoke
+0000eef0: 6e2c 636f 6e73 756d 6572 6964 2c63 6f6d  n,consumerid,com
+0000ef00: 7061 6e79 6e61 6d65 220d 0a20 2020 2020  panyname"..     
+0000ef10: 2020 200d 0a20 2020 2076 616c 7565 3d28     ..    value=(
+0000ef20: 226d 6f64 6966 7974 6f70 6963 6465 7461  "modifytopicdeta
+0000ef30: 696c 733f 7669 7065 7274 6f6b 656e 3d22  ils?vipertoken="
+0000ef40: 2b76 6970 6572 746f 6b65 6e20 2b20 2226  +vipertoken + "&
+0000ef50: 746f 7069 633d 222b 746f 7069 6320 2b22  topic="+topic +"
+0000ef60: 2662 726f 6b65 7268 6f73 743d 222b 6272  &brokerhost="+br
+0000ef70: 6f6b 6572 686f 7374 2b22 2662 726f 6b65  okerhost+"&broke
+0000ef80: 7270 6f72 743d 222b 7374 7228 6272 6f6b  rport="+str(brok
+0000ef90: 6572 706f 7274 290d 0a20 2020 2020 2020  erport)..       
+0000efa0: 2020 202b 2022 2669 7367 726f 7570 3d22     + "&isgroup="
+0000efb0: 202b 2073 7472 2869 7367 726f 7570 2920   + str(isgroup) 
+0000efc0: 2b22 2670 6172 7469 7469 6f6e 3d22 2b73  +"&partition="+s
+0000efd0: 7472 2870 6172 7469 7469 6f6e 2920 2b22  tr(partition) +"
+0000efe0: 2665 6e61 626c 6574 6c73 3d22 2b73 7472  &enabletls="+str
+0000eff0: 2865 6e61 626c 6574 6c73 292b 2226 636f  (enabletls)+"&co
+0000f000: 6d70 616e 796e 616d 653d 222b 636f 6d70  mpanyname="+comp
+0000f010: 616e 796e 616d 652b 2226 636f 6e74 6163  anyname+"&contac
+0000f020: 746e 616d 653d 222b 636f 6e74 6163 746e  tname="+contactn
+0000f030: 616d 652b 2226 636f 6e74 6163 7465 6d61  ame+"&contactema
+0000f040: 696c 3d22 2b63 6f6e 7461 6374 656d 6169  il="+contactemai
+0000f050: 6c2b 2226 6c6f 6361 7469 6f6e 3d22 2b6c  l+"&location="+l
+0000f060: 6f63 6174 696f 6e29 0d0a 0d0a 2020 2020  ocation)....    
+0000f070: 7661 6c3d 6c6f 6f70 2e72 756e 5f75 6e74  val=loop.run_unt
+0000f080: 696c 5f63 6f6d 706c 6574 6528 7463 705f  il_complete(tcp_
+0000f090: 6563 686f 5f63 6c69 656e 7476 6970 6572  echo_clientviper
+0000f0a0: 2876 616c 7565 2c20 6c6f 6f70 2c68 6f73  (value, loop,hos
+0000f0b0: 742c 706f 7274 2c6d 6963 726f 7365 7276  t,port,microserv
+0000f0c0: 6963 6569 6429 290d 0a20 2020 2069 6620  iceid))..    if 
+0000f0d0: 636f 6e6e 6563 7469 6f6e 6572 726f 723a  connectionerror:
+0000f0e0: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
+0000f0f0: 6e20 636f 6e6e 6563 7469 6f6e 6572 726f  n connectionerro
+0000f100: 720d 0a0d 0a20 2020 2072 6574 7572 6e20  r....    return 
+0000f110: 7661 6c0d 0a0d 0a64 6566 2076 6970 6572  val....def viper
+0000f120: 6163 7469 7661 7465 746f 7069 6328 7669  activatetopic(vi
+0000f130: 7065 7274 6f6b 656e 2c68 6f73 742c 706f  pertoken,host,po
+0000f140: 7274 2c74 6f70 6963 2c6d 6963 726f 7365  rt,topic,microse
+0000f150: 7276 6963 6569 643d 2727 293a 0d0a 2020  rviceid=''):..  
+0000f160: 2020 676c 6f62 616c 2063 6f6e 6e65 6374    global connect
+0000f170: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
+0000f180: 6966 2028 6c65 6e28 686f 7374 293d 3d30  if (len(host)==0
+0000f190: 206f 7220 6c65 6e28 7669 7065 7274 6f6b   or len(vipertok
+0000f1a0: 656e 293d 3d30 206f 7220 706f 7274 3d3d  en)==0 or port==
+0000f1b0: 2d39 3939 206f 7220 6c65 6e28 746f 7069  -999 or len(topi
+0000f1c0: 6329 3d3d 3020 2029 3a0d 0a20 2020 2020  c)==0  ):..     
+0000f1d0: 2020 2020 7265 7475 726e 2022 506c 6561      return "Plea
+0000f1e0: 7365 2065 6e74 6572 2068 6f73 742c 706f  se enter host,po
+0000f1f0: 7274 2c76 6970 6572 746f 6b65 6e2c 746f  rt,vipertoken,to
+0000f200: 7069 6322 0d0a 2020 2020 2020 2020 0d0a  pic"..        ..
+0000f210: 2020 2020 7661 6c75 653d 2822 6163 7469      value=("acti
+0000f220: 7661 7465 746f 7069 633f 7669 7065 7274  vatetopic?vipert
+0000f230: 6f6b 656e 3d22 2b76 6970 6572 746f 6b65  oken="+vipertoke
+0000f240: 6e20 2b20 2226 746f 7069 633d 222b 746f  n + "&topic="+to
+0000f250: 7069 6320 290d 0a0d 0a20 2020 2076 616c  pic )....    val
+0000f260: 3d6c 6f6f 702e 7275 6e5f 756e 7469 6c5f  =loop.run_until_
+0000f270: 636f 6d70 6c65 7465 2874 6370 5f65 6368  complete(tcp_ech
+0000f280: 6f5f 636c 6965 6e74 7669 7065 7228 7661  o_clientviper(va
+0000f290: 6c75 652c 206c 6f6f 702c 686f 7374 2c70  lue, loop,host,p
+0000f2a0: 6f72 742c 6d69 6372 6f73 6572 7669 6365  ort,microservice
+0000f2b0: 6964 2929 0d0a 2020 2020 6966 2063 6f6e  id))..    if con
+0000f2c0: 6e65 6374 696f 6e65 7272 6f72 3a0d 0a20  nectionerror:.. 
+0000f2d0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+0000f2e0: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
+0000f2f0: 0d0a 2020 2020 7265 7475 726e 2076 616c  ..    return val
+0000f300: 0d0a 0d0a 6465 6620 7669 7065 7264 656c  ....def viperdel
+0000f310: 6574 6574 6f70 6963 7328 7669 7065 7274  etetopics(vipert
+0000f320: 6f6b 656e 2c68 6f73 742c 706f 7274 2c74  oken,host,port,t
+0000f330: 6f70 6963 2c65 6e61 626c 6574 6c73 3d31  opic,enabletls=1
+0000f340: 2c62 726f 6b65 7268 6f73 743d 2727 2c62  ,brokerhost='',b
+0000f350: 726f 6b65 7270 6f72 743d 3930 3932 2c6d  rokerport=9092,m
+0000f360: 6963 726f 7365 7276 6963 6569 643d 2727  icroserviceid=''
+0000f370: 293a 0d0a 2020 2020 676c 6f62 616c 2063  ):..    global c
+0000f380: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
+0000f390: 0d0a 2020 2020 6966 2028 6c65 6e28 686f  ..    if (len(ho
+0000f3a0: 7374 293d 3d30 206f 7220 6c65 6e28 7669  st)==0 or len(vi
+0000f3b0: 7065 7274 6f6b 656e 293d 3d30 206f 7220  pertoken)==0 or 
+0000f3c0: 706f 7274 3d3d 2d39 3939 206f 7220 6c65  port==-999 or le
+0000f3d0: 6e28 746f 7069 6329 3d3d 3020 2029 3a0d  n(topic)==0  ):.
+0000f3e0: 0a20 2020 2020 2020 2020 7265 7475 726e  .         return
+0000f3f0: 2022 506c 6561 7365 2065 6e74 6572 2068   "Please enter h
+0000f400: 6f73 742c 706f 7274 2c76 6970 6572 746f  ost,port,viperto
+0000f410: 6b65 6e2c 746f 7069 6322 0d0a 2020 2020  ken,topic"..    
+0000f420: 2020 2020 0d0a 2020 2020 7661 6c75 653d      ..    value=
+0000f430: 2822 6465 6c65 7465 746f 7069 6373 3f76  ("deletetopics?v
+0000f440: 6970 6572 746f 6b65 6e3d 222b 7669 7065  ipertoken="+vipe
+0000f450: 7274 6f6b 656e 202b 2022 2674 6f70 6963  rtoken + "&topic
+0000f460: 3d22 2b74 6f70 6963 202b 2226 656e 6162  ="+topic +"&enab
+0000f470: 6c65 746c 733d 222b 7374 7228 656e 6162  letls="+str(enab
+0000f480: 6c65 746c 7329 202b 2226 6272 6f6b 6572  letls) +"&broker
+0000f490: 686f 7374 3d22 2b62 726f 6b65 7268 6f73  host="+brokerhos
+0000f4a0: 742b 2226 6272 6f6b 6572 706f 7274 3d22  t+"&brokerport="
+0000f4b0: 2b73 7472 2862 726f 6b65 7270 6f72 7429  +str(brokerport)
+0000f4c0: 290d 0a0d 0a20 2020 2076 616c 3d6c 6f6f  )....    val=loo
+0000f4d0: 702e 7275 6e5f 756e 7469 6c5f 636f 6d70  p.run_until_comp
+0000f4e0: 6c65 7465 2874 6370 5f65 6368 6f5f 636c  lete(tcp_echo_cl
+0000f4f0: 6965 6e74 7669 7065 7228 7661 6c75 652c  ientviper(value,
+0000f500: 206c 6f6f 702c 686f 7374 2c70 6f72 742c   loop,host,port,
+0000f510: 6d69 6372 6f73 6572 7669 6365 6964 2929  microserviceid))
+0000f520: 0d0a 2020 2020 6966 2063 6f6e 6e65 6374  ..    if connect
+0000f530: 696f 6e65 7272 6f72 3a0d 0a20 2020 2020  ionerror:..     
+0000f540: 2020 2020 7265 7475 726e 2063 6f6e 6e65      return conne
+0000f550: 6374 696f 6e65 7272 6f72 0d0a 0d0a 2020  ctionerror....  
+0000f560: 2020 7265 7475 726e 2076 616c 0d0a 0d0a    return val....
+0000f570: 6465 6620 7669 7065 7264 6561 6374 6976  def viperdeactiv
+0000f580: 6174 6574 6f70 6963 2876 6970 6572 746f  atetopic(viperto
+0000f590: 6b65 6e2c 686f 7374 2c70 6f72 742c 746f  ken,host,port,to
+0000f5a0: 7069 632c 6d69 6372 6f73 6572 7669 6365  pic,microservice
+0000f5b0: 6964 3d27 2729 3a0d 0a20 2020 2067 6c6f  id=''):..    glo
+0000f5c0: 6261 6c20 636f 6e6e 6563 7469 6f6e 6572  bal connectioner
+0000f5d0: 726f 720d 0a0d 0a20 2020 2069 6620 286c  ror....    if (l
+0000f5e0: 656e 2868 6f73 7429 3d3d 3020 6f72 206c  en(host)==0 or l
+0000f5f0: 656e 2876 6970 6572 746f 6b65 6e29 3d3d  en(vipertoken)==
+0000f600: 3020 6f72 2070 6f72 743d 3d2d 3939 3920  0 or port==-999 
+0000f610: 6f72 206c 656e 2874 6f70 6963 293d 3d30  or len(topic)==0
+0000f620: 2020 293a 0d0a 2020 2020 2020 2020 2072    ):..         r
+0000f630: 6574 7572 6e20 2250 6c65 6173 6520 656e  eturn "Please en
+0000f640: 7465 7220 686f 7374 2c70 6f72 742c 7669  ter host,port,vi
+0000f650: 7065 7274 6f6b 656e 2c74 6f70 6963 220d  pertoken,topic".
+0000f660: 0a20 2020 2020 2020 200d 0a20 2020 2076  .        ..    v
+0000f670: 616c 7565 3d28 2264 6561 6374 6976 6174  alue=("deactivat
+0000f680: 6574 6f70 6963 3f76 6970 6572 746f 6b65  etopic?vipertoke
+0000f690: 6e3d 222b 7669 7065 7274 6f6b 656e 202b  n="+vipertoken +
+0000f6a0: 2022 2674 6f70 6963 3d22 2b74 6f70 6963   "&topic="+topic
+0000f6b0: 2029 0d0a 0d0a 2020 2020 7661 6c3d 6c6f   )....    val=lo
+0000f6c0: 6f70 2e72 756e 5f75 6e74 696c 5f63 6f6d  op.run_until_com
+0000f6d0: 706c 6574 6528 7463 705f 6563 686f 5f63  plete(tcp_echo_c
+0000f6e0: 6c69 656e 7476 6970 6572 2876 616c 7565  lientviper(value
+0000f6f0: 2c20 6c6f 6f70 2c68 6f73 742c 706f 7274  , loop,host,port
+0000f700: 2c6d 6963 726f 7365 7276 6963 6569 6429  ,microserviceid)
+0000f710: 290d 0a20 2020 2069 6620 636f 6e6e 6563  )..    if connec
+0000f720: 7469 6f6e 6572 726f 723a 0d0a 2020 2020  tionerror:..    
+0000f730: 2020 2020 2072 6574 7572 6e20 636f 6e6e       return conn
+0000f740: 6563 7469 6f6e 6572 726f 720d 0a0d 0a20  ectionerror.... 
+0000f750: 2020 2072 6574 7572 6e20 7661 6c0d 0a0d     return val...
+0000f760: 0a64 6566 2076 6970 6572 6772 6f75 7061  .def vipergroupa
+0000f770: 6374 6976 6174 6528 7669 7065 7274 6f6b  ctivate(vipertok
+0000f780: 656e 2c68 6f73 742c 706f 7274 2c67 726f  en,host,port,gro
+0000f790: 7570 6e61 6d65 2c67 726f 7570 6964 2c6d  upname,groupid,m
+0000f7a0: 6963 726f 7365 7276 6963 6569 643d 2727  icroserviceid=''
+0000f7b0: 293a 0d0a 2020 2020 676c 6f62 616c 2063  ):..    global c
+0000f7c0: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
+0000f7d0: 0d0a 2020 2020 6966 2028 6c65 6e28 686f  ..    if (len(ho
+0000f7e0: 7374 293d 3d30 206f 7220 6c65 6e28 7669  st)==0 or len(vi
+0000f7f0: 7065 7274 6f6b 656e 293d 3d30 206f 7220  pertoken)==0 or 
+0000f800: 706f 7274 3d3d 2d39 3939 206f 7220 6c65  port==-999 or le
+0000f810: 6e28 6772 6f75 706e 616d 6529 3d3d 3020  n(groupname)==0 
+0000f820: 2020 6f72 206c 656e 2867 726f 7570 6964    or len(groupid
+0000f830: 293d 3d30 2029 3a0d 0a20 2020 2020 2020  )==0 ):..       
+0000f840: 2020 7265 7475 726e 2022 506c 6561 7365    return "Please
+0000f850: 2065 6e74 6572 2068 6f73 742c 706f 7274   enter host,port
+0000f860: 2c76 6970 6572 746f 6b65 6e2c 6772 6f75  ,vipertoken,grou
+0000f870: 706e 616d 652c 6772 6f75 7069 6422 0d0a  pname,groupid"..
+0000f880: 2020 2020 2020 2020 0d0a 2020 2020 7661          ..    va
+0000f890: 6c75 653d 2822 6163 7469 7661 7465 6772  lue=("activategr
+0000f8a0: 6f75 703f 7669 7065 7274 6f6b 656e 3d22  oup?vipertoken="
+0000f8b0: 2b76 6970 6572 746f 6b65 6e20 2b20 2226  +vipertoken + "&
+0000f8c0: 6772 6f75 706e 616d 653d 222b 6772 6f75  groupname="+grou
+0000f8d0: 706e 616d 6520 2b22 2667 726f 7570 6964  pname +"&groupid
+0000f8e0: 3d22 2b67 726f 7570 6964 290d 0a0d 0a20  ="+groupid).... 
+0000f8f0: 2020 2076 616c 3d6c 6f6f 702e 7275 6e5f     val=loop.run_
+0000f900: 756e 7469 6c5f 636f 6d70 6c65 7465 2874  until_complete(t
+0000f910: 6370 5f65 6368 6f5f 636c 6965 6e74 7669  cp_echo_clientvi
+0000f920: 7065 7228 7661 6c75 652c 206c 6f6f 702c  per(value, loop,
+0000f930: 686f 7374 2c70 6f72 742c 6d69 6372 6f73  host,port,micros
+0000f940: 6572 7669 6365 6964 2929 0d0a 2020 2020  erviceid))..    
+0000f950: 6966 2063 6f6e 6e65 6374 696f 6e65 7272  if connectionerr
+0000f960: 6f72 3a0d 0a20 2020 2020 2020 2020 7265  or:..         re
+0000f970: 7475 726e 2063 6f6e 6e65 6374 696f 6e65  turn connectione
+0000f980: 7272 6f72 0d0a 0d0a 2020 2020 7265 7475  rror....    retu
+0000f990: 726e 2076 616c 0d0a 0d0a 6465 6620 7669  rn val....def vi
+0000f9a0: 7065 7267 726f 7570 6465 6163 7469 7661  pergroupdeactiva
+0000f9b0: 7465 2876 6970 6572 746f 6b65 6e2c 686f  te(vipertoken,ho
+0000f9c0: 7374 2c70 6f72 742c 6772 6f75 706e 616d  st,port,groupnam
+0000f9d0: 652c 6772 6f75 7069 642c 6d69 6372 6f73  e,groupid,micros
+0000f9e0: 6572 7669 6365 6964 3d27 2729 3a0d 0a20  erviceid=''):.. 
+0000f9f0: 2020 2067 6c6f 6261 6c20 636f 6e6e 6563     global connec
+0000fa00: 7469 6f6e 6572 726f 720d 0a0d 0a20 2020  tionerror....   
+0000fa10: 2069 6620 286c 656e 2868 6f73 7429 3d3d   if (len(host)==
+0000fa20: 3020 6f72 206c 656e 2876 6970 6572 746f  0 or len(viperto
+0000fa30: 6b65 6e29 3d3d 3020 6f72 2070 6f72 743d  ken)==0 or port=
+0000fa40: 3d2d 3939 3920 6f72 206c 656e 2867 726f  =-999 or len(gro
+0000fa50: 7570 6e61 6d65 293d 3d30 2020 206f 7220  upname)==0   or 
+0000fa60: 6c65 6e28 6772 6f75 7069 6429 3d3d 3020  len(groupid)==0 
+0000fa70: 293a 0d0a 2020 2020 2020 2020 2072 6574  ):..         ret
+0000fa80: 7572 6e20 2250 6c65 6173 6520 656e 7465  urn "Please ente
+0000fa90: 7220 686f 7374 2c70 6f72 742c 7669 7065  r host,port,vipe
+0000faa0: 7274 6f6b 656e 2c67 726f 7570 6e61 6d65  rtoken,groupname
+0000fab0: 2c67 726f 7570 6964 220d 0a20 2020 2020  ,groupid"..     
+0000fac0: 2020 200d 0a20 2020 2076 616c 7565 3d28     ..    value=(
+0000fad0: 2264 6561 6374 6976 6174 6567 726f 7570  "deactivategroup
+0000fae0: 3f76 6970 6572 746f 6b65 6e3d 222b 7669  ?vipertoken="+vi
+0000faf0: 7065 7274 6f6b 656e 202b 2022 2667 726f  pertoken + "&gro
+0000fb00: 7570 6e61 6d65 3d22 2b67 726f 7570 6e61  upname="+groupna
+0000fb10: 6d65 202b 2226 6772 6f75 7069 643d 222b  me +"&groupid="+
+0000fb20: 6772 6f75 7069 6429 0d0a 0d0a 2020 2020  groupid)....    
+0000fb30: 7661 6c3d 6c6f 6f70 2e72 756e 5f75 6e74  val=loop.run_unt
+0000fb40: 696c 5f63 6f6d 706c 6574 6528 7463 705f  il_complete(tcp_
+0000fb50: 6563 686f 5f63 6c69 656e 7476 6970 6572  echo_clientviper
+0000fb60: 2876 616c 7565 2c20 6c6f 6f70 2c68 6f73  (value, loop,hos
+0000fb70: 742c 706f 7274 2c6d 6963 726f 7365 7276  t,port,microserv
+0000fb80: 6963 6569 6429 290d 0a20 2020 2069 6620  iceid))..    if 
+0000fb90: 636f 6e6e 6563 7469 6f6e 6572 726f 723a  connectionerror:
+0000fba0: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
+0000fbb0: 6e20 636f 6e6e 6563 7469 6f6e 6572 726f  n connectionerro
+0000fbc0: 720d 0a0d 0a20 2020 2072 6574 7572 6e20  r....    return 
+0000fbd0: 7661 6c0d 0a0d 0a0d 0a64 6566 2076 6970  val......def vip
+0000fbe0: 6572 6e6c 7028 6669 6c65 6e61 6d65 2c66  ernlp(filename,f
+0000fbf0: 7661 6c75 652c 6b65 7973 293a 0d0a 2020  value,keys):..  
+0000fc00: 2020 6966 2066 696c 656e 616d 653d 3d22    if filename=="
+0000fc10: 223a 0d0a 2020 2020 2020 2020 2072 6574  ":..         ret
+0000fc20: 7572 6e20 2250 6c65 6173 6520 656e 7465  urn "Please ente
+0000fc30: 7220 686f 7374 2c70 6f72 742c 7669 7065  r host,port,vipe
+0000fc40: 7274 6f6b 656e 2c67 726f 7570 6e61 6d65  rtoken,groupname
+0000fc50: 2c67 726f 7570 6964 220d 0a20 2020 2069  ,groupid"..    i
+0000fc60: 6620 6676 616c 7565 203e 2031 3030 3030  f fvalue > 10000
+0000fc70: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
+0000fc80: 6e20 2253 756d 6d61 7279 2063 6f75 6e74  n "Summary count
+0000fc90: 2074 6f6f 2068 6967 682e 204d 7573 7420   too high. Must 
+0000fca0: 6265 2020 3c20 3130 3030 3022 0d0a 2020  be  < 10000"..  
+0000fcb0: 2020 6966 206b 6579 7320 3e20 3130 303a    if keys > 100:
+0000fcc0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000fcd0: 2022 4b65 7977 6f72 6420 636f 756e 7420   "Keyword count 
+0000fce0: 746f 6f20 6869 6768 2e20 4d75 7374 2062  too high. Must b
+0000fcf0: 6520 203c 2031 3030 220d 0a20 2020 2020  e  < 100"..     
+0000fd00: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
+0000fd10: 7374 6172 7470 6466 7265 6164 696e 6728  startpdfreading(
+0000fd20: 6669 6c65 6e61 6d65 2c66 7661 6c75 652c  filename,fvalue,
+0000fd30: 6b65 7973 290d 0a0d 0a64 6566 2076 6970  keys)....def vip
+0000fd40: 6572 6368 6174 6770 7428 6f70 656e 6169  erchatgpt(openai
+0000fd50: 6b65 792c 7465 7874 746f 616e 616c 7973  key,texttoanalys
+0000fd60: 652c 7175 6572 792c 2074 656d 7065 7261  e,query, tempera
+0000fd70: 7475 7265 2c6d 6f64 656c 6e61 6d65 293a  ture,modelname):
+0000fd80: 0d0a 2020 2020 6966 206f 7065 6e61 696b  ..    if openaik
+0000fd90: 6579 3d3d 2222 3a0d 0a20 2020 2020 2020  ey=="":..       
+0000fda0: 2020 7265 7475 726e 2022 506c 6561 7365    return "Please
+0000fdb0: 2065 6e74 6572 204f 7065 6e41 4920 6b65   enter OpenAI ke
+0000fdc0: 7922 0d0a 2020 2020 6966 2074 6578 7474  y"..    if textt
+0000fdd0: 6f61 6e61 6c79 7365 203d 3d20 2222 3a0d  oanalyse == "":.
+0000fde0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000fdf0: 2245 6e74 6572 2074 6578 7420 746f 2061  "Enter text to a
+0000fe00: 6e61 6c79 7365 220d 0a20 2020 2069 6620  nalyse"..    if 
+0000fe10: 7175 6572 7920 3d3d 2022 223a 0d0a 2020  query == "":..  
+0000fe20: 2020 2020 2020 7265 7475 726e 2022 456e        return "En
+0000fe30: 7465 7220 4368 6174 6770 7420 7072 6f6d  ter Chatgpt prom
+0000fe40: 7074 7322 0d0a 2020 2020 6966 2074 656d  pts"..    if tem
+0000fe50: 7065 7261 7475 7265 203e 2031 206f 7220  perature > 1 or 
+0000fe60: 7465 6d70 6572 6174 7572 6520 3c20 303a  temperature < 0:
+0000fe70: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000fe80: 2022 496e 7661 6c75 6520 7465 6d70 6572   "Invalue temper
+0000fe90: 6174 7572 6520 2d20 7368 6f75 6c64 2062  ature - should b
+0000fea0: 6520 6265 7477 6565 6e20 302d 3120 692e  e between 0-1 i.
+0000feb0: 652e 2030 2e37 220d 0a20 2020 2069 6620  e. 0.7"..    if 
+0000fec0: 6d6f 6465 6c6e 616d 6520 3d3d 2022 223a  modelname == "":
+0000fed0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000fee0: 2022 5370 6563 6966 7920 6d6f 6465 6c20   "Specify model 
+0000fef0: 6e61 6d65 206c 696b 6520 2774 6578 742d  name like 'text-
+0000ff00: 6461 7669 6e63 692d 3030 3227 206f 7220  davinci-002' or 
+0000ff10: 2774 6578 742d 6375 7269 652d 3030 3127  'text-curie-001'
+0000ff20: 220d 0a0d 0a20 2020 206f 732e 656e 7669  "....    os.envi
+0000ff30: 726f 6e5b 224f 5045 4e41 495f 4150 495f  ron["OPENAI_API_
+0000ff40: 4b45 5922 5d20 3d20 6f70 656e 6169 6b65  KEY"] = openaike
+0000ff50: 790d 0a20 2020 2020 2020 200d 0a20 2020  y..        ..   
+0000ff60: 2072 6573 203d 2073 7461 7274 5f63 6f6e   res = start_con
+0000ff70: 7665 7273 6174 696f 6e28 6f70 656e 6169  versation(openai
+0000ff80: 6b65 792c 7175 6572 792c 7465 7874 746f  key,query,textto
+0000ff90: 616e 616c 7973 652c 7465 6d70 6572 6174  analyse,temperat
+0000ffa0: 7572 652c 6d6f 6465 6c6e 616d 6529 0d0a  ure,modelname)..
+0000ffb0: 2020 2020 6368 6174 6770 7472 6573 706f      chatgptrespo
+0000ffc0: 6e73 6520 3d20 7265 735b 276f 7574 7075  nse = res['outpu
+0000ffd0: 745f 7465 7874 275d 0d0a 2020 2020 6368  t_text']..    ch
+0000ffe0: 6174 6770 7472 6573 706f 6e73 652e 7265  atgptresponse.re
+0000fff0: 706c 6163 6528 225c 5c6e 222c 2222 292e  place("\\n","").
+00010000: 7265 706c 6163 6528 225c 5c72 222c 2022  replace("\\r", "
+00010010: 2229 0d0a 2020 2020 6368 6174 6770 7472  ")..    chatgptr
+00010020: 6573 706f 6e73 6520 3d20 6368 6174 6770  esponse = chatgp
+00010030: 7472 6573 706f 6e73 652e 7265 706c 6163  tresponse.replac
+00010040: 6528 275c 5c75 272c 2755 2b27 290d 0a0d  e('\\u','U+')...
+00010050: 0a20 2020 2063 6861 7467 7074 7265 7370  .    chatgptresp
+00010060: 6f6e 7365 203d 2072 652e 7375 6228 7227  onse = re.sub(r'
+00010070: 3c55 5c2b 285b 302d 3961 2d66 412d 465d  <U\+([0-9a-fA-F]
+00010080: 7b34 2c36 7d29 3e27 2c20 6c61 6d62 6461  {4,6})>', lambda
+00010090: 2078 3a20 6368 7228 696e 7428 782e 6772   x: chr(int(x.gr
+000100a0: 6f75 7028 3129 2c31 3629 292c 2063 6861  oup(1),16)), cha
+000100b0: 7467 7074 7265 7370 6f6e 7365 290d 0a0d  tgptresponse)...
+000100c0: 0a20 2020 2072 6574 7572 6e20 6368 6174  .    return chat
+000100d0: 6770 7472 6573 706f 6e73 650d 0a0d 0a64  gptresponse....d
+000100e0: 6566 2076 6970 6572 6578 7261 6374 7064  ef viperexractpd
+000100f0: 6666 6965 6c64 7328 6669 6c65 6e61 6d65  ffields(filename
+00010100: 293a 0d0a 2020 2020 6966 2066 696c 656e  ):..    if filen
+00010110: 616d 653d 3d22 223a 0d0a 2020 2020 2020  ame=="":..      
+00010120: 2020 7265 7475 726e 2022 456e 7465 7220    return "Enter 
+00010130: 5044 4620 6669 6c65 6e61 6d65 220d 0a0d  PDF filename"...
+00010140: 0a20 2020 200d 0a20 2020 2072 6574 7572  .    ..    retur
+00010150: 6e20 6578 7472 6163 7466 6965 6c64 7328  n extractfields(
+00010160: 6669 6c65 6e61 6d65 290d 0a0d 0a64 6566  filename)....def
+00010170: 2076 6970 6572 6578 7261 6374 7064 6666   viperexractpdff
+00010180: 6965 6c64 6279 6c61 6265 6c28 6669 6c65  ieldbylabel(file
+00010190: 6e61 6d65 2c6c 6162 656c 6e61 6d65 2c61  name,labelname,a
+000101a0: 6372 6f74 7970 6529 3a0d 0a20 2020 2069  crotype):..    i
+000101b0: 6620 6669 6c65 6e61 6d65 3d3d 2222 206f  f filename=="" o
+000101c0: 7220 6c61 6265 6c6e 616d 653d 3d22 2220  r labelname=="" 
+000101d0: 6f72 2061 6372 6f74 7970 653d 3d22 223a  or acrotype=="":
+000101e0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000101f0: 2022 456e 7465 7220 5044 4620 6669 6c65   "Enter PDF file
+00010200: 6e61 6d65 2c20 6c61 6265 6c6e 616d 6520  name, labelname 
+00010210: 616e 6420 6163 726f 7479 7065 220d 0a20  and acrotype".. 
+00010220: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
+00010230: 6c61 6265 6c66 6965 6c64 7328 6669 6c65  labelfields(file
+00010240: 6e61 6d65 2c6c 6162 656c 6e61 6d65 2c61  name,labelname,a
+00010250: 6372 6f74 7970 6529 0d0a 0d0a 6465 6620  crotype)....def 
+00010260: 7669 7065 7263 6861 7467 7074 7374 7265  viperchatgptstre
+00010270: 616d 2876 6970 6572 746f 6b65 6e2c 686f  am(vipertoken,ho
+00010280: 7374 2c70 6f72 742c 6f70 656e 6169 6b65  st,port,openaike
+00010290: 792c 746f 7069 632c 7465 7874 746f 616e  y,topic,texttoan
+000102a0: 616c 7973 652c 7175 6572 792c 2074 656d  alyse,query, tem
+000102b0: 7065 7261 7475 7265 2c6d 6f64 656c 6e61  perature,modelna
+000102c0: 6d65 2c6a 736f 6e70 6174 682c 7072 6f64  me,jsonpath,prod
+000102d0: 7563 6574 6f2c 6d61 7872 6f77 732c 0d0a  uceto,maxrows,..
+000102e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000102f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010310: 2020 2065 6e61 626c 6574 6c73 3d31 2c70     enabletls=1,p
-00010320: 6172 7469 7469 6f6e 3d2d 312c 6f66 6673  artition=-1,offs
-00010330: 6574 3d2d 312c 6465 6c61 793d 3130 302c  et=-1,delay=100,
-00010340: 7469 6d65 6f75 743d 3132 302c 6272 6f6b  timeout=120,brok
-00010350: 6572 686f 7374 3d27 272c 6272 6f6b 6572  erhost='',broker
-00010360: 706f 7274 3d2d 3939 392c 6d69 6372 6f73  port=-999,micros
-00010370: 6572 7669 6365 6964 3d27 2729 3a0d 0a20  erviceid=''):.. 
-00010380: 2020 200d 0a20 2020 2067 6c6f 6261 6c20     ..    global 
-00010390: 636f 6e6e 6563 7469 6f6e 6572 726f 720d  connectionerror.
-000103a0: 0a0d 0a20 2020 2069 6620 286c 656e 2868  ...    if (len(h
-000103b0: 6f73 7429 3d3d 3020 6f72 206c 656e 2876  ost)==0 or len(v
-000103c0: 6970 6572 746f 6b65 6e29 3d3d 3020 6f72  ipertoken)==0 or
-000103d0: 2070 6f72 743d 3d2d 3939 3920 6f72 206c   port==-999 or l
-000103e0: 656e 2874 6f70 6963 293d 3d30 206f 7220  en(topic)==0 or 
-000103f0: 6c65 6e28 7465 7874 746f 616e 616c 7973  len(texttoanalys
-00010400: 6529 3d3d 3020 206f 7220 6c65 6e28 7175  e)==0  or len(qu
-00010410: 6572 7929 3d3d 3020 206f 7220 6c65 6e28  ery)==0  or len(
-00010420: 6d6f 6465 6c6e 616d 6529 3d3d 3020 293a  modelname)==0 ):
-00010430: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
-00010440: 6e20 2250 6c65 6173 6520 656e 7465 7220  n "Please enter 
-00010450: 686f 7374 2c70 6f72 742c 7669 7065 7274  host,port,vipert
-00010460: 6f6b 656e 2c74 6f70 6963 2c6f 7065 6e61  oken,topic,opena
-00010470: 696b 6579 2c74 6578 7474 6f61 6e61 6c79  ikey,texttoanaly
-00010480: 7365 2c20 6d6f 6465 6c6e 616d 652c 2071  se, modelname, q
-00010490: 7565 7279 220d 0a20 2020 2020 2020 2020  uery"..         
-000104a0: 2020 200d 0a20 2020 2076 616c 7565 3d28     ..    value=(
-000104b0: 2263 6861 7467 7074 7374 7265 616d 3f76  "chatgptstream?v
-000104c0: 6970 6572 746f 6b65 6e3d 222b 7669 7065  ipertoken="+vipe
-000104d0: 7274 6f6b 656e 202b 2022 266f 7065 6e61  rtoken + "&opena
-000104e0: 696b 6579 3d22 202b 206f 7065 6e61 696b  ikey=" + openaik
-000104f0: 6579 202b 2022 2674 6f70 6963 3d22 2b74  ey + "&topic="+t
-00010500: 6f70 6963 202b 2022 2664 656c 6179 3d22  opic + "&delay="
-00010510: 202b 2073 7472 2864 656c 6179 2920 2b20   + str(delay) + 
-00010520: 2226 6d61 7872 6f77 733d 2220 2b73 7472  "&maxrows=" +str
-00010530: 286d 6178 726f 7773 2920 2b0d 0a20 2020  (maxrows) +..   
-00010540: 2020 2020 2020 2020 2226 656e 6162 6c65          "&enable
-00010550: 746c 733d 222b 7374 7228 656e 6162 6c65  tls="+str(enable
-00010560: 746c 7329 202b 2226 6272 6f6b 6572 686f  tls) +"&brokerho
-00010570: 7374 3d22 2b62 726f 6b65 7268 6f73 7420  st="+brokerhost 
-00010580: 2b20 2226 6272 6f6b 6572 706f 7274 3d22  + "&brokerport="
-00010590: 2b73 7472 2862 726f 6b65 7270 6f72 7429  +str(brokerport)
-000105a0: 202b 2022 2674 6578 7474 6f61 6e61 6c79   + "&texttoanaly
-000105b0: 7365 3d22 2b74 6578 7474 6f61 6e61 6c79  se="+texttoanaly
-000105c0: 7365 202b 0d0a 2020 2020 2020 2020 2020  se +..          
-000105d0: 2022 266f 6666 7365 743d 222b 7374 7228   "&offset="+str(
-000105e0: 6f66 6673 6574 2920 2b20 2226 7175 6572  offset) + "&quer
-000105f0: 793d 2220 2b20 7175 6572 7920 2b20 2226  y=" + query + "&
-00010600: 7465 6d70 6572 6174 7572 653d 222b 2073  temperature="+ s
-00010610: 7472 2874 656d 7065 7261 7475 7265 290d  tr(temperature).
-00010620: 0a20 2020 2020 2020 2020 2020 2b20 2226  .           + "&
-00010630: 6d6f 6465 6c6e 616d 653d 222b 6d6f 6465  modelname="+mode
-00010640: 6c6e 616d 6520 2b20 2226 6a73 6f6e 7061  lname + "&jsonpa
-00010650: 7468 3d22 202b 206a 736f 6e70 6174 6820  th=" + jsonpath 
-00010660: 2b20 2226 7072 6f64 7563 6574 6f3d 2220  + "&produceto=" 
-00010670: 2b20 7072 6f64 7563 6574 6f20 2b20 0d0a  + produceto + ..
-00010680: 2020 2020 2020 2020 2020 2022 2670 6172             "&par
-00010690: 7469 7469 6f6e 3d22 202b 2073 7472 2870  tition=" + str(p
-000106a0: 6172 7469 7469 6f6e 2920 2b20 2226 7469  artition) + "&ti
-000106b0: 6d65 6f75 743d 2220 2b20 7374 7228 7469  meout=" + str(ti
-000106c0: 6d65 6f75 7429 2029 0d0a 0d0a 2020 2020  meout) )....    
-000106d0: 7661 6c3d 6c6f 6f70 2e72 756e 5f75 6e74  val=loop.run_unt
-000106e0: 696c 5f63 6f6d 706c 6574 6528 7463 705f  il_complete(tcp_
-000106f0: 6563 686f 5f63 6c69 656e 7476 6970 6572  echo_clientviper
-00010700: 2876 616c 7565 2c20 6c6f 6f70 2c68 6f73  (value, loop,hos
-00010710: 742c 706f 7274 2c6d 6963 726f 7365 7276  t,port,microserv
-00010720: 6963 6569 642c 7469 6d65 6f75 7429 290d  iceid,timeout)).
-00010730: 0a0d 0a20 2020 2069 6620 636f 6e6e 6563  ...    if connec
-00010740: 7469 6f6e 6572 726f 723a 0d0a 2020 2020  tionerror:..    
-00010750: 2020 2020 2072 6574 7572 6e20 636f 6e6e       return conn
-00010760: 6563 7469 6f6e 6572 726f 720d 0a0d 0a20  ectionerror.... 
-00010770: 2020 2072 6574 7572 6e20 7661 6c0d 0a20     return val.. 
-00010780: 2020 200d 0a64 6566 2061 7265 796f 7562     ..def areyoub
-00010790: 7573 7928 686f 7374 2c70 6f72 743d 2d39  usy(host,port=-9
-000107a0: 3939 2c6d 6963 726f 7365 7276 6963 6569  99,microservicei
-000107b0: 643d 2727 293a 0d0a 2020 2020 676c 6f62  d=''):..    glob
-000107c0: 616c 2063 6f6e 6e65 6374 696f 6e65 7272  al connectionerr
-000107d0: 6f72 0d0a 0d0a 2020 2020 6966 2028 6c65  or....    if (le
-000107e0: 6e28 686f 7374 293d 3d30 206f 7220 706f  n(host)==0 or po
-000107f0: 7274 3d3d 2d39 3939 2029 3a0d 0a20 2020  rt==-999 ):..   
-00010800: 2020 2020 2020 7265 7475 726e 2022 506c        return "Pl
-00010810: 6561 7365 2065 6e74 6572 2068 6f73 742c  ease enter host,
-00010820: 706f 7274 220d 0a20 2020 2076 616c 7565  port"..    value
-00010830: 3d28 2261 7265 796f 7562 7573 7922 290d  =("areyoubusy").
-00010840: 0a0d 0a20 2020 2076 616c 3d6c 6f6f 702e  ...    val=loop.
-00010850: 7275 6e5f 756e 7469 6c5f 636f 6d70 6c65  run_until_comple
-00010860: 7465 2874 6370 5f65 6368 6f5f 636c 6965  te(tcp_echo_clie
-00010870: 6e74 7669 7065 7228 7661 6c75 652c 206c  ntviper(value, l
-00010880: 6f6f 702c 686f 7374 2c70 6f72 742c 6d69  oop,host,port,mi
-00010890: 6372 6f73 6572 7669 6365 6964 2929 0d0a  croserviceid))..
-000108a0: 2020 2020 6966 2063 6f6e 6e65 6374 696f      if connectio
-000108b0: 6e65 7272 6f72 3a0d 0a20 2020 2020 2020  nerror:..       
-000108c0: 2020 7265 7475 726e 2063 6f6e 6e65 6374    return connect
-000108d0: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
-000108e0: 7265 7475 726e 2076 616c 0d0a 0d0a 6465  return val....de
-000108f0: 6620 7067 7074 696e 6765 7374 646f 6373  f pgptingestdocs
-00010900: 2864 6f63 6e61 6d65 2c64 6f63 7479 7065  (docname,doctype
-00010910: 2c20 7067 7074 6970 2c70 6770 7470 6f72  , pgptip,pgptpor
-00010920: 742c 7067 7074 656e 6470 6f69 6e74 293a  t,pgptendpoint):
-00010930: 0d0a 0d0a 2020 7572 6c3d 7067 7074 6970  ....  url=pgptip
-00010940: 202b 2022 3a22 202b 2070 6770 7470 6f72   + ":" + pgptpor
-00010950: 7420 2b20 7067 7074 656e 6470 6f69 6e74  t + pgptendpoint
-00010960: 0d0a 2020 7472 793a 0d0a 2020 2020 2020  ..  try:..      
-00010970: 6966 2064 6f63 7479 7065 203d 3d20 2762  if doctype == 'b
-00010980: 696e 6172 7927 3a0d 0a20 2020 2020 2020  inary':..       
-00010990: 2066 696c 653d 6f70 656e 2864 6f63 6e61   file=open(docna
-000109a0: 6d65 2c20 2772 6227 290d 0a20 2020 2020  me, 'rb')..     
-000109b0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000109c0: 6669 6c65 3d6f 7065 6e28 646f 636e 616d  file=open(docnam
-000109d0: 652c 2027 7227 2920 200d 0a20 2065 7863  e, 'r')  ..  exc
-000109e0: 6570 7420 494f 4572 726f 723a 0d0a 2020  ept IOError:..  
-000109f0: 2020 2020 7265 7475 726e 2022 4552 524f      return "ERRO
-00010a00: 523a 2046 696c 6520 646f 6573 206e 6f74  R: File does not
-00010a10: 2061 7070 6561 7220 746f 2065 7869 7374   appear to exist
-00010a20: 2e22 0d0a 0d0a 2020 6669 6c65 7320 3d20  ."....  files = 
-00010a30: 7b0d 0a20 2020 2027 6669 6c65 273a 2028  {..    'file': (
-00010a40: 646f 636e 616d 652c 2066 696c 6529 2c0d  docname, file),.
-00010a50: 0a20 207d 0d0a 2020 0d0a 2020 7472 793a  .  }..  ..  try:
-00010a60: 0d0a 2020 2020 6f62 6a3d 7265 7175 6573  ..    obj=reques
-00010a70: 7473 2e70 6f73 7428 7572 6c2c 2066 696c  ts.post(url, fil
-00010a80: 6573 3d66 696c 6573 290d 0a20 2020 2072  es=files)..    r
-00010a90: 6574 7572 6e20 6f62 6a2e 7465 7874 0d0a  eturn obj.text..
-00010aa0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-00010ab0: 6f6e 2061 7320 653a 0d0a 2020 2020 7265  on as e:..    re
-00010ac0: 7475 726e 2022 4552 524f 523a 2220 2b20  turn "ERROR:" + 
-00010ad0: 7374 7228 6529 0d0a 0d0a 6465 6620 7067  str(e)....def pg
-00010ae0: 7074 6765 7469 6e67 6573 7465 6465 6d62  ptgetingestedemb
-00010af0: 6564 6469 6e67 7328 646f 636e 616d 652c  eddings(docname,
-00010b00: 6970 2c70 6f72 742c 656e 6470 6f69 6e74  ip,port,endpoint
-00010b10: 293a 0d0a 2020 7572 6c3d 6970 202b 2022  ):..  url=ip + "
-00010b20: 3a22 202b 2070 6f72 7420 2b20 656e 6470  :" + port + endp
-00010b30: 6f69 6e74 2023 222f 7631 2f69 6e67 6573  oint #"/v1/inges
-00010b40: 742f 6c69 7374 220d 0a20 2064 6f63 6964  t/list"..  docid
-00010b50: 7320 3d20 5b5d 0d0a 2020 646f 6369 6473  s = []..  docids
-00010b60: 7374 7220 3d20 5b5d 0d0a 0d0a 2020 7472  str = []....  tr
-00010b70: 793a 0d0a 2020 2020 6f62 6a3d 7265 7175  y:..    obj=requ
-00010b80: 6573 7473 2e67 6574 2875 726c 290d 0a20  ests.get(url).. 
-00010b90: 2020 206a 7320 3d20 6a73 6f6e 2e6c 6f61     js = json.loa
-00010ba0: 6473 286f 626a 2e74 6578 7429 0d0a 2020  ds(obj.text)..  
-00010bb0: 2020 666f 7220 6a20 696e 206a 735b 2264    for j in js["d
-00010bc0: 6174 6122 5d3a 0d0a 2020 2020 2020 6966  ata"]:..      if
-00010bd0: 206a 5b22 646f 635f 6d65 7461 6461 7461   j["doc_metadata
-00010be0: 225d 5b22 6669 6c65 5f6e 616d 6522 5d3d  "]["file_name"]=
-00010bf0: 3d64 6f63 6e61 6d65 3a0d 0a20 2020 2020  =docname:..     
-00010c00: 2020 2020 2370 7269 6e74 286a 5b22 646f      #print(j["do
-00010c10: 635f 6964 225d 290d 0a20 2020 2020 2020  c_id"])..       
-00010c20: 2020 646f 6369 6473 2e61 7070 656e 6428    docids.append(
-00010c30: 6a5b 2264 6f63 5f69 6422 5d29 0d0a 2020  j["doc_id"])..  
-00010c40: 2020 2020 2020 2064 6f63 6964 7373 7472         docidsstr
-00010c50: 2e61 7070 656e 6428 6a5b 2264 6f63 5f69  .append(j["doc_i
-00010c60: 6422 5d29 0d0a 0d0a 2020 2020 646f 6373  d"])....    docs
-00010c70: 7472 3d20 2827 2c20 272e 6a6f 696e 2827  tr= (', '.join('
-00010c80: 2227 202b 2069 7465 6d20 2b20 2722 2720  "' + item + '"' 
-00010c90: 666f 7220 6974 656d 2069 6e20 646f 6369  for item in doci
-00010ca0: 6473 2929 0d0a 2020 0d0a 2020 2020 7265  ds))..  ..    re
-00010cb0: 7475 726e 2064 6f63 6964 732c 646f 6373  turn docids,docs
-00010cc0: 7472 2c64 6f63 6964 7373 7472 0d0a 2020  tr,docidsstr..  
-00010cd0: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
-00010ce0: 2061 7320 653a 0d0a 2020 2020 7265 7475   as e:..    retu
-00010cf0: 726e 2022 4552 524f 523a 2220 2b20 7374  rn "ERROR:" + st
-00010d00: 7228 6529 2c22 222c 2222 2020 0d0a 2020  r(e),"",""  ..  
-00010d10: 2020 2020 0d0a 0d0a 2020 2020 0d0a 6465      ....    ..de
-00010d20: 6620 7067 7074 6368 6174 2870 726f 6d70  f pgptchat(promp
-00010d30: 742c 636f 6e74 6578 742c 646f 6366 696c  t,context,docfil
-00010d40: 7465 722c 706f 7274 2c69 6e63 6c75 6465  ter,port,include
-00010d50: 736f 7572 6365 732c 6970 2c65 6e64 706f  sources,ip,endpo
-00010d60: 696e 7429 3a0d 0a20 2023 7572 6c3d 2268  int):..  #url="h
-00010d70: 7474 703a 2f2f 3132 372e 302e 302e 313a  ttp://127.0.0.1:
-00010d80: 3830 3031 2f72 756e 2f70 7265 6469 6374  8001/run/predict
-00010d90: 220d 0a20 2075 726c 3d69 7020 2b20 223a  "..  url=ip + ":
-00010da0: 2220 2b20 706f 7274 202b 2065 6e64 706f  " + port + endpo
-00010db0: 696e 740d 0a0d 0a20 200d 0a20 2020 200d  int....  ..    .
-00010dc0: 0a20 2068 6561 6465 7273 203d 207b 2263  .  headers = {"c
-00010dd0: 6f6e 7465 6e74 2d74 7970 6522 3a20 2261  ontent-type": "a
-00010de0: 7070 6c69 6361 7469 6f6e 2f6a 736f 6e22  pplication/json"
-00010df0: 7d0d 0a20 2069 6620 646f 6366 696c 7465  }..  if docfilte
-00010e00: 7220 213d 2022 223a 0d0a 2020 2020 7061  r != "":..    pa
-00010e10: 796c 6f61 6420 3d20 7b0d 0a20 2020 2020  yload = {..     
-00010e20: 2020 2020 2022 696e 636c 7564 655f 736f       "include_so
-00010e30: 7572 6365 7322 3a20 696e 636c 7564 6573  urces": includes
-00010e40: 6f75 7263 6573 2c0d 0a20 2020 2020 2020  ources,..       
-00010e50: 2020 2022 7072 6f6d 7074 223a 2070 726f     "prompt": pro
-00010e60: 6d70 742c 0d0a 2020 2020 2020 2020 2020  mpt,..          
-00010e70: 2273 7472 6561 6d22 3a20 4661 6c73 652c  "stream": False,
-00010e80: 0d0a 2020 2020 2020 2020 2020 2275 7365  ..          "use
-00010e90: 5f63 6f6e 7465 7874 223a 2063 6f6e 7465  _context": conte
-00010ea0: 7874 2c0d 0a20 2020 2020 2020 2020 2022  xt,..          "
-00010eb0: 636f 6e74 6578 745f 6669 6c74 6572 223a  context_filter":
-00010ec0: 207b 2022 646f 6373 5f69 6473 223a 2064   { "docs_ids": d
-00010ed0: 6f63 6669 6c74 6572 207d 0d0a 2020 2020  ocfilter }..    
-00010ee0: 7d0d 0a20 2020 2320 7072 696e 7428 7061  }..   # print(pa
-00010ef0: 796c 6f61 6429 2020 0d0a 2020 656c 7365  yload)  ..  else
-00010f00: 3a0d 0a20 2020 2070 6179 6c6f 6164 203d  :..    payload =
-00010f10: 207b 0d0a 2020 2020 2020 2020 2020 2269   {..          "i
-00010f20: 6e63 6c75 6465 5f73 6f75 7263 6573 223a  nclude_sources":
-00010f30: 2069 6e63 6c75 6465 736f 7572 6365 732c   includesources,
-00010f40: 0d0a 2020 2020 2020 2020 2020 2270 726f  ..          "pro
-00010f50: 6d70 7422 3a20 7072 6f6d 7074 2c0d 0a20  mpt": prompt,.. 
-00010f60: 2020 2020 2020 2020 2022 7374 7265 616d           "stream
-00010f70: 223a 2046 616c 7365 2c0d 0a20 2020 2020  ": False,..     
-00010f80: 2020 2020 2022 7573 655f 636f 6e74 6578       "use_contex
-00010f90: 7422 3a20 636f 6e74 6578 740d 0a20 2020  t": context..   
-00010fa0: 207d 0d0a 2020 7472 793a 2020 200d 0a20   }..  try:   .. 
-00010fb0: 2020 206f 626a 3d72 6571 7565 7374 732e     obj=requests.
-00010fc0: 706f 7374 2875 726c 2c20 6a73 6f6e 3d70  post(url, json=p
-00010fd0: 6179 6c6f 6164 2c68 6561 6465 7273 3d68  ayload,headers=h
-00010fe0: 6561 6465 7273 290d 0a20 2020 2072 6574  eaders)..    ret
-00010ff0: 7572 6e20 6f62 6a2e 7465 7874 0d0a 2020  urn obj.text..  
-00011000: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
-00011010: 2061 7320 653a 0d0a 2020 2020 7265 7475   as e:..    retu
-00011020: 726e 2022 4552 524f 523a 2220 2b20 7374  rn "ERROR:" + st
-00011030: 7228 6529 2020 0d0a 0d0a 0d0a 6465 6620  r(e)  ......def 
-00011040: 7067 7074 6465 6c65 7465 656d 6265 6464  pgptdeleteembedd
-00011050: 696e 6773 2864 6f63 6964 732c 2069 702c  ings(docids, ip,
-00011060: 706f 7274 2c65 6e64 706f 696e 7429 3a0d  port,endpoint):.
-00011070: 0a20 2020 2020 0d0a 2020 7572 6c3d 6970  .     ..  url=ip
-00011080: 202b 2022 3a22 202b 2070 6f72 7420 2b20   + ":" + port + 
-00011090: 656e 6470 6f69 6e74 0d0a 2020 6966 206c  endpoint..  if l
-000110a0: 656e 2864 6f63 6964 7329 3d3d 303a 0d0a  en(docids)==0:..
-000110b0: 2020 2020 2020 7265 7475 726e 2022 4552        return "ER
-000110c0: 524f 523a 646f 6369 6473 2069 7320 656d  ROR:docids is em
-000110d0: 7074 7922 0d0a 2020 7472 793a 0d0a 2020  pty"..  try:..  
-000110e0: 2020 666f 7220 6a20 696e 2064 6f63 6964    for j in docid
-000110f0: 733a 0d0a 2020 2020 2020 6f62 6a3d 7265  s:..      obj=re
-00011100: 7175 6573 7473 2e64 656c 6574 6528 7572  quests.delete(ur
-00011110: 6c2b 6a29 0d0a 2020 2020 2020 7072 696e  l+j)..      prin
-00011120: 7428 2244 454c 4554 4544 3a22 2c6a 290d  t("DELETED:",j).
-00011130: 0a20 2065 7863 6570 7420 4578 6365 7074  .  except Except
-00011140: 696f 6e20 6173 2065 3a0d 0a20 2020 2072  ion as e:..    r
-00011150: 6574 7572 6e20 2245 5252 4f52 3a22 202b  eturn "ERROR:" +
-00011160: 2073 7472 2865 2920 200d 0a20 2020 2020   str(e)  ..     
-00011170: 0d0a 6465 6620 7067 7074 6865 616c 7468  ..def pgpthealth
-00011180: 2869 702c 706f 7274 2c65 6e64 706f 696e  (ip,port,endpoin
-00011190: 7429 3a0d 0a20 2075 726c 3d69 7020 2b20  t):..  url=ip + 
-000111a0: 223a 2220 2b20 706f 7274 202b 2065 6e64  ":" + port + end
-000111b0: 706f 696e 740d 0a0d 0a20 2074 7279 3a0d  point....  try:.
-000111c0: 0a20 2020 206f 626a 3d72 6571 7565 7374  .    obj=request
-000111d0: 732e 6765 7428 7572 6c29 0d0a 2020 2020  s.get(url)..    
-000111e0: 7265 7475 726e 206f 626a 2e74 6578 740d  return obj.text.
-000111f0: 0a20 2065 7863 6570 7420 4578 6365 7074  .  except Except
-00011200: 696f 6e20 6173 2065 3a0d 0a20 2020 2072  ion as e:..    r
-00011210: 6574 7572 6e20 2245 5252 4f52 3a22 202b  eturn "ERROR:" +
-00011220: 2073 7472 2865 290d 0a0d 0a0d 0a23 2323   str(e)......###
-00011230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00011240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00011250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00011260: 230d 0a69 6d70 6f72 7420 7379 730d 0a66  #..import sys..f
-00011270: 726f 6d20 7064 666d 696e 6572 2e70 6466  rom pdfminer.pdf
-00011280: 7061 7273 6572 2069 6d70 6f72 7420 5044  parser import PD
-00011290: 4650 6172 7365 720d 0a66 726f 6d20 7064  FParser..from pd
-000112a0: 666d 696e 6572 2e70 6466 646f 6375 6d65  fminer.pdfdocume
-000112b0: 6e74 2069 6d70 6f72 7420 5044 4644 6f63  nt import PDFDoc
-000112c0: 756d 656e 740d 0a66 726f 6d20 7064 666d  ument..from pdfm
-000112d0: 696e 6572 2e70 6466 7061 6765 2069 6d70  iner.pdfpage imp
-000112e0: 6f72 7420 5044 4650 6167 650d 0a66 726f  ort PDFPage..fro
-000112f0: 6d20 7064 666d 696e 6572 2e70 6466 7061  m pdfminer.pdfpa
-00011300: 6765 2069 6d70 6f72 7420 5044 4654 6578  ge import PDFTex
-00011310: 7445 7874 7261 6374 696f 6e4e 6f74 416c  tExtractionNotAl
-00011320: 6c6f 7765 640d 0a66 726f 6d20 7064 666d  lowed..from pdfm
-00011330: 696e 6572 2e70 6466 696e 7465 7270 2069  iner.pdfinterp i
-00011340: 6d70 6f72 7420 5044 4652 6573 6f75 7263  mport PDFResourc
-00011350: 654d 616e 6167 6572 0d0a 6672 6f6d 2070  eManager..from p
-00011360: 6466 6d69 6e65 722e 7064 6669 6e74 6572  dfminer.pdfinter
-00011370: 7020 696d 706f 7274 2050 4446 5061 6765  p import PDFPage
-00011380: 496e 7465 7270 7265 7465 720d 0a23 6672  Interpreter..#fr
-00011390: 6f6d 2053 7472 696e 6749 4f20 696d 706f  om StringIO impo
-000113a0: 7274 2053 7472 696e 6749 4f0d 0a66 726f  rt StringIO..fro
-000113b0: 6d20 696f 2069 6d70 6f72 7420 5374 7269  m io import Stri
-000113c0: 6e67 494f 0d0a 696d 706f 7274 2075 726c  ngIO..import url
-000113d0: 6c69 622e 7265 7175 6573 7420 200d 0a23  lib.request  ..#
-000113e0: 696d 706f 7274 2074 6d6c 7465 7874 7375  import tmltextsu
-000113f0: 6d6d 6172 790d 0a69 6d70 6f72 7420 6f73  mmary..import os
-00011400: 0d0a 696d 706f 7274 2064 6174 6574 696d  ..import datetim
-00011410: 650d 0a23 696d 706f 7274 2067 6c6f 620d  e..#import glob.
-00011420: 0a0d 0a0d 0a66 726f 6d20 7064 666d 696e  .....from pdfmin
-00011430: 6572 2e6c 6179 6f75 7420 696d 706f 7274  er.layout import
-00011440: 204c 4150 6172 616d 730d 0a66 726f 6d20   LAParams..from 
-00011450: 7064 666d 696e 6572 2e63 6f6e 7665 7274  pdfminer.convert
-00011460: 6572 2069 6d70 6f72 7420 5465 7874 436f  er import TextCo
-00011470: 6e76 6572 7465 720d 0a20 0d0a 636c 6173  nverter.. ..clas
-00011480: 7320 4d79 5061 7273 6572 286f 626a 6563  s MyParser(objec
-00011490: 7429 3a0d 0a20 2020 2064 6566 205f 5f69  t):..    def __i
-000114a0: 6e69 745f 5f28 7365 6c66 2c20 7064 6629  nit__(self, pdf)
-000114b0: 3a0d 0a20 2020 2020 2020 2023 2320 536e  :..        ## Sn
-000114c0: 6970 7065 6420 6164 6170 7465 6420 6672  ipped adapted fr
-000114d0: 6f6d 2059 7573 756b 6520 5368 696e 7961  om Yusuke Shinya
-000114e0: 6d61 7320 0d0a 2020 2020 2020 2020 2350  mas ..        #P
-000114f0: 4446 4d69 6e65 7220 646f 6375 6d65 6e74  DFMiner document
-00011500: 6174 696f 6e0d 0a20 2020 2020 2020 2023  ation..        #
-00011510: 2043 7265 6174 6520 7468 6520 646f 6375   Create the docu
-00011520: 6d65 6e74 206d 6f64 656c 2066 726f 6d20  ment model from 
-00011530: 7468 6520 6669 6c65 0d0a 2020 2020 2020  the file..      
-00011540: 2020 7061 7273 6572 203d 2050 4446 5061    parser = PDFPa
-00011550: 7273 6572 286f 7065 6e28 7064 662c 2027  rser(open(pdf, '
-00011560: 7262 2729 290d 0a20 2020 2020 2020 2064  rb'))..        d
-00011570: 6f63 756d 656e 7420 3d20 5044 4644 6f63  ocument = PDFDoc
-00011580: 756d 656e 7428 7061 7273 6572 290d 0a20  ument(parser).. 
-00011590: 2020 2020 2020 2023 2054 7279 2074 6f20         # Try to 
-000115a0: 7061 7273 6520 7468 6520 646f 6375 6d65  parse the docume
-000115b0: 6e74 0d0a 2020 2020 2020 2020 6966 206e  nt..        if n
-000115c0: 6f74 2064 6f63 756d 656e 742e 6973 5f65  ot document.is_e
-000115d0: 7874 7261 6374 6162 6c65 3a0d 0a20 2020  xtractable:..   
-000115e0: 2020 2020 2020 2020 2072 6169 7365 2050           raise P
-000115f0: 4446 5465 7874 4578 7472 6163 7469 6f6e  DFTextExtraction
-00011600: 4e6f 7441 6c6c 6f77 6564 0d0a 2020 2020  NotAllowed..    
-00011610: 2020 2020 2320 4372 6561 7465 2061 2050      # Create a P
-00011620: 4446 2072 6573 6f75 7263 6520 6d61 6e61  DF resource mana
-00011630: 6765 7220 6f62 6a65 6374 200d 0a20 2020  ger object ..   
-00011640: 2020 2020 2023 2074 6861 7420 7374 6f72       # that stor
-00011650: 6573 2073 6861 7265 6420 7265 736f 7572  es shared resour
-00011660: 6365 732e 0d0a 2020 2020 2020 2020 7273  ces...        rs
-00011670: 7263 6d67 7220 3d20 5044 4652 6573 6f75  rcmgr = PDFResou
-00011680: 7263 654d 616e 6167 6572 2829 0d0a 2020  rceManager()..  
-00011690: 2020 2020 2020 2320 4372 6561 7465 2061        # Create a
-000116a0: 2062 7566 6665 7220 666f 7220 7468 6520   buffer for the 
-000116b0: 7061 7273 6564 2074 6578 740d 0a20 2020  parsed text..   
-000116c0: 2020 2020 2072 6574 7374 7220 3d20 5374       retstr = St
-000116d0: 7269 6e67 494f 2829 0d0a 2020 2020 2020  ringIO()..      
-000116e0: 2020 2320 5370 6163 696e 6720 7061 7261    # Spacing para
-000116f0: 6d65 7465 7273 2066 6f72 2070 6172 7369  meters for parsi
-00011700: 6e67 0d0a 2020 2020 2020 2020 6c61 7061  ng..        lapa
-00011710: 7261 6d73 203d 204c 4150 6172 616d 7328  rams = LAParams(
-00011720: 290d 0a20 2020 2020 2020 2063 6f64 6563  )..        codec
-00011730: 203d 2027 7574 662d 3827 0d0a 200d 0a20   = 'utf-8'.. .. 
-00011740: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
-00011750: 6120 5044 4620 6465 7669 6365 206f 626a  a PDF device obj
-00011760: 6563 740d 0a20 2020 2020 2020 2064 6576  ect..        dev
-00011770: 6963 6520 3d20 5465 7874 436f 6e76 6572  ice = TextConver
-00011780: 7465 7228 7273 7263 6d67 722c 2072 6574  ter(rsrcmgr, ret
-00011790: 7374 722c 0d0a 2020 2020 2020 2020 2020  str,..          
-000117a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000117b0: 2020 2020 206c 6170 6172 616d 7320 3d20       laparams = 
-000117c0: 6c61 7061 7261 6d73 290d 0a20 2020 2020  laparams)..     
-000117d0: 2020 2023 2043 7265 6174 6520 6120 5044     # Create a PD
-000117e0: 4620 696e 7465 7270 7265 7465 7220 6f62  F interpreter ob
-000117f0: 6a65 6374 0d0a 2020 2020 2020 2020 696e  ject..        in
-00011800: 7465 7270 7265 7465 7220 3d20 5044 4650  terpreter = PDFP
-00011810: 6167 6549 6e74 6572 7072 6574 6572 2872  ageInterpreter(r
-00011820: 7372 636d 6772 2c20 6465 7669 6365 290d  srcmgr, device).
-00011830: 0a20 2020 2020 2020 2023 2050 726f 6365  .        # Proce
-00011840: 7373 2065 6163 6820 7061 6765 2063 6f6e  ss each page con
-00011850: 7461 696e 6564 2069 6e20 7468 6520 646f  tained in the do
-00011860: 6375 6d65 6e74 2e0d 0a20 2020 2020 2020  cument...       
-00011870: 2066 6f72 2070 6167 6520 696e 2050 4446   for page in PDF
-00011880: 5061 6765 2e63 7265 6174 655f 7061 6765  Page.create_page
-00011890: 7328 646f 6375 6d65 6e74 293a 0d0a 2020  s(document):..  
-000118a0: 2020 2020 2020 2020 2020 696e 7465 7270            interp
-000118b0: 7265 7465 722e 7072 6f63 6573 735f 7061  reter.process_pa
-000118c0: 6765 2870 6167 6529 0d0a 2020 2020 2020  ge(page)..      
-000118d0: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-000118e0: 662e 7265 636f 7264 7320 2020 2020 2020  f.records       
-000118f0: 2020 2020 203d 205b 5d0d 0a20 2020 2020       = []..     
-00011900: 2020 2020 0d0a 2020 2020 2020 2020 6c69      ..        li
-00011910: 6e65 7320 3d20 7265 7473 7472 2e67 6574  nes = retstr.get
-00011920: 7661 6c75 6528 292e 7370 6c69 746c 696e  value().splitlin
-00011930: 6573 2829 0d0a 2020 2020 2020 2020 666f  es()..        fo
-00011940: 7220 6c69 6e65 2069 6e20 6c69 6e65 733a  r line in lines:
-00011950: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00011960: 6c66 2e68 616e 646c 655f 6c69 6e65 286c  lf.handle_line(l
-00011970: 696e 6529 0d0a 2020 2020 200d 0a20 2020  ine)..     ..   
-00011980: 2064 6566 2068 616e 646c 655f 6c69 6e65   def handle_line
-00011990: 2873 656c 662c 206c 696e 6529 3a0d 0a20  (self, line):.. 
-000119a0: 2020 2020 2020 2023 2043 7573 746f 6d69         # Customi
-000119b0: 7a65 2079 6f75 7220 6c69 6e65 2d62 792d  ze your line-by-
-000119c0: 6c69 6e65 2070 6172 7365 7220 6865 7265  line parser here
-000119d0: 0d0a 2020 2020 2020 2020 7365 6c66 2e72  ..        self.r
-000119e0: 6563 6f72 6473 2e61 7070 656e 6428 6c69  ecords.append(li
-000119f0: 6e65 290d 0a0d 0a64 6566 2073 6372 6170  ne)....def scrap
-00011a00: 6570 6466 2874 6865 7572 6c2c 666e 293a  epdf(theurl,fn):
-00011a10: 0d0a 2020 2020 7363 7261 7065 645f 6461  ..    scraped_da
-00011a20: 7461 203d 2075 726c 6c69 622e 7265 7175  ta = urllib.requ
-00011a30: 6573 742e 7572 6c6f 7065 6e28 7468 6575  est.urlopen(theu
-00011a40: 726c 2920 200d 0a20 2020 2066 696c 6520  rl)  ..    file 
-00011a50: 3d20 6f70 656e 2866 6e2c 2027 7762 2729  = open(fn, 'wb')
-00011a60: 0d0a 2020 2020 6669 6c65 2e77 7269 7465  ..    file.write
-00011a70: 2873 6372 6170 6564 5f64 6174 612e 7265  (scraped_data.re
-00011a80: 6164 2829 290d 0a20 2020 2066 696c 652e  ad())..    file.
-00011a90: 636c 6f73 6528 290d 0a20 2020 2023 7265  close()..    #re
-00011aa0: 7475 726e 2061 7274 6963 6c65 5f74 6578  turn article_tex
-00011ab0: 740d 0a0d 0a64 6566 2073 7461 7274 7064  t....def startpd
-00011ac0: 6672 6561 6469 6e67 2866 696c 656e 616d  freading(filenam
-00011ad0: 652c 6676 616c 7565 2c6b 6579 636f 756e  e,fvalue,keycoun
-00011ae0: 7429 3a0d 0a20 2023 6f73 2e70 6174 682e  t):..  #os.path.
-00011af0: 6162 7370 6174 6828 6f73 2e67 6574 6377  abspath(os.getcw
-00011b00: 6428 2929 0d0a 2020 7468 6573 697a 653d  d())..  thesize=
-00011b10: 726f 756e 6428 6f73 2e70 6174 682e 6765  round(os.path.ge
-00011b20: 7473 697a 6528 6669 6c65 6e61 6d65 292f  tsize(filename)/
-00011b30: 3130 3030 3030 302c 3229 0d0a 2020 6d5f  1000000,2)..  m_
-00011b40: 7469 6d65 203d 206f 732e 7061 7468 2e67  time = os.path.g
-00011b50: 6574 6d74 696d 6528 6669 6c65 6e61 6d65  etmtime(filename
-00011b60: 290d 0a20 2064 745f 6d20 3d20 6461 7465  )..  dt_m = date
-00011b70: 7469 6d65 2e64 6174 6574 696d 652e 6672  time.datetime.fr
-00011b80: 6f6d 7469 6d65 7374 616d 7028 6d5f 7469  omtimestamp(m_ti
-00011b90: 6d65 290d 0a20 2063 5f74 696d 6520 3d20  me)..  c_time = 
-00011ba0: 6f73 2e70 6174 682e 6765 7463 7469 6d65  os.path.getctime
-00011bb0: 2866 696c 656e 616d 6529 0d0a 2020 2320  (filename)..  # 
-00011bc0: 636f 6e76 6572 7420 6372 6561 7469 6f6e  convert creation
-00011bd0: 2074 696d 6573 7461 6d70 2069 6e74 6f20   timestamp into 
-00011be0: 4461 7465 5469 6d65 206f 626a 6563 740d  DateTime object.
-00011bf0: 0a20 2064 745f 6320 3d20 6461 7465 7469  .  dt_c = dateti
-00011c00: 6d65 2e64 6174 6574 696d 652e 6672 6f6d  me.datetime.from
-00011c10: 7469 6d65 7374 616d 7028 635f 7469 6d65  timestamp(c_time
-00011c20: 290d 0a20 2063 6f20 3d20 7374 7228 6474  )..  co = str(dt
-00011c30: 5f63 2920 5b30 3a31 395d 0d0a 2020 6d6f  _c) [0:19]..  mo
-00011c40: 203d 2073 7472 2864 745f 6d29 205b 303a   = str(dt_m) [0:
-00011c50: 3139 5d0d 0a0d 0a20 2070 203d 204d 7950  19]....  p = MyP
-00011c60: 6172 7365 7228 6669 6c65 6e61 6d65 290d  arser(filename).
-00011c70: 0a20 2074 6865 7465 7874 3d27 5c6e 272e  .  thetext='\n'.
-00011c80: 6a6f 696e 2870 2e72 6563 6f72 6473 290d  join(p.records).
-00011c90: 0a20 2061 7274 6963 6c65 5f74 6578 743d  .  article_text=
-00011ca0: 7468 6574 6578 742e 656e 636f 6465 2827  thetext.encode('
-00011cb0: 7574 6638 2729 0d0a 2020 7375 6d6d 6172  utf8')..  summar
-00011cc0: 697a 6564 3d22 7b5c 2266 696c 656e 616d  ized="{\"filenam
-00011cd0: 655c 223a 5c22 2220 2b20 6669 6c65 6e61  e\":\"" + filena
-00011ce0: 6d65 202b 2022 5c22 2c5c 2266 696c 6573  me + "\",\"files
-00011cf0: 697a 6528 4d42 295c 223a 222b 7374 7228  ize(MB)\":"+str(
-00011d00: 7468 6573 697a 6529 2b22 2c5c 2266 696c  thesize)+",\"fil
-00011d10: 6563 7265 6174 6564 6f6e 5c22 3a5c 2222  ecreatedon\":\""
-00011d20: 202b 2063 6f20 2b20 225c 222c 5c22 6669   + co + "\",\"fi
-00011d30: 6c65 6d6f 6469 6669 6564 6f6e 5c22 3a5c  lemodifiedon\":\
-00011d40: 2222 202b 206d 6f20 2b20 225c 222c 5c22  "" + mo + "\",\"
-00011d50: 6b65 7977 6f72 6473 5c22 3a22 202b 2020  keywords\":" +  
-00011d60: 7374 6172 7473 756d 6d61 7279 2874 6865  startsummary(the
-00011d70: 7465 7874 2c66 7661 6c75 652c 6b65 7963  text,fvalue,keyc
-00011d80: 6f75 6e74 290d 0a20 2320 7072 696e 7428  ount).. # print(
-00011d90: 7375 6d6d 6172 697a 6564 290d 0a20 2072  summarized)..  r
-00011da0: 6574 7572 6e20 7375 6d6d 6172 697a 6564  eturn summarized
-00011db0: 0d0a 0d0a 0d0a 6465 6620 7669 6465 6f63  ......def videoc
-00011dc0: 6861 746c 6f61 6472 6573 706f 6e73 6528  hatloadresponse(
-00011dd0: 7572 6c2c 706f 7274 2c66 696c 656e 616d  url,port,filenam
-00011de0: 652c 7072 6f6d 7074 2c72 6573 706f 6e73  e,prompt,respons
-00011df0: 6566 6f6c 6465 723d 2776 6964 656f 6770  efolder='videogp
-00011e00: 745f 7265 7370 6f6e 7365 272c 7465 6d70  t_response',temp
-00011e10: 6572 6174 7572 653d 302e 332c 6d61 785f  erature=0.3,max_
-00011e20: 6f75 7470 7574 5f74 6f6b 656e 733d 3531  output_tokens=51
-00011e30: 3229 3a0d 0a23 2020 7572 6c3d 2768 7474  2):..#  url='htt
-00011e40: 703a 2f2f 3132 372e 302e 302e 313a 3738  p://127.0.0.1:78
-00011e50: 3030 2f3f 7570 6c6f 6164 6669 6c65 3d73  00/?uploadfile=s
-00011e60: 616d 706c 655f 362e 6d70 3426 7465 6d70  ample_6.mp4&temp
-00011e70: 6572 6174 7572 653d 302e 3326 6d61 785f  erature=0.3&max_
-00011e80: 6f75 7470 7574 5f74 6f6b 656e 733d 3531  output_tokens=51
-00011e90: 3226 7072 6f6d 7074 3d57 6861 7425 3230  2&prompt=What%20
-00011ea0: 6973 2532 3076 6964 656f 2532 3061 626f  is%20video%20abo
-00011eb0: 7574 3f26 7265 7370 6f6e 7365 666f 6c64  ut?&responsefold
-00011ec0: 6572 3d6c 6f6e 646f 6e66 6f6c 6465 7227  er=londonfolder'
-00011ed0: 0d0a 0d0a 2020 6d61 696e 7572 6c20 3d20  ....  mainurl = 
-00011ee0: 7572 6c20 2b20 223a 2220 2b20 706f 7274  url + ":" + port
-00011ef0: 202b 2022 2f3f 7570 6c6f 6164 6669 6c65   + "/?uploadfile
-00011f00: 3d22 2b66 696c 656e 616d 6520 2b20 2226  ="+filename + "&
-00011f10: 7465 6d70 6572 6174 7572 653d 2220 2b20  temperature=" + 
-00011f20: 7374 7228 7465 6d70 6572 6174 7572 6529  str(temperature)
-00011f30: 202b 2022 266d 6178 5f6f 7574 7075 745f   + "&max_output_
-00011f40: 746f 6b65 6e73 3d22 202b 2073 7472 286d  tokens=" + str(m
-00011f50: 6178 5f6f 7574 7075 745f 746f 6b65 6e73  ax_output_tokens
-00011f60: 2920 2b20 2226 7072 6f6d 7074 3d22 202b  ) + "&prompt=" +
-00011f70: 7072 6f6d 7074 202b 2022 2672 6573 706f  prompt + "&respo
-00011f80: 6e73 6566 6f6c 6465 723d 2220 2b20 7265  nsefolder=" + re
-00011f90: 7370 6f6e 7365 666f 6c64 6572 0d0a 2020  sponsefolder..  
-00011fa0: 0d0a 2020 6f70 7469 6f6e 7320 3d20 4f70  ..  options = Op
-00011fb0: 7469 6f6e 7328 290d 0a20 206f 7074 696f  tions()..  optio
-00011fc0: 6e73 2e61 6464 5f61 7267 756d 656e 7428  ns.add_argument(
-00011fd0: 222d 2d68 6561 646c 6573 7322 290d 0a20  "--headless").. 
-00011fe0: 2064 7269 7665 7220 3d20 7765 6264 7269   driver = webdri
-00011ff0: 7665 722e 4669 7265 666f 7828 6f70 7469  ver.Firefox(opti
-00012000: 6f6e 733d 6f70 7469 6f6e 7329 0d0a 2020  ons=options)..  
-00012010: 7265 7420 3d20 6472 6976 6572 2e67 6574  ret = driver.get
-00012020: 286d 6169 6e75 726c 2920 2020 2020 2020  (mainurl)       
-00012030: 200d 0a20 2064 7269 7665 722e 7175 6974   ..  driver.quit
-00012040: 2829 0d0a 2020 666d 7367 203d 2072 6573  ()..  fmsg = res
-00012050: 706f 6e73 6566 6f6c 6465 7220 2b20 222f  ponsefolder + "/
-00012060: 2220 2b20 6669 6c65 6e61 6d65 202b 2022  " + filename + "
-00012070: 2e74 7874 220d 0a20 2023 6d73 6720 3d20  .txt"..  #msg = 
-00012080: 2256 6964 656f 2047 5054 2072 6573 706f  "Video GPT respo
-00012090: 6e73 6520 6973 2069 6e20 6669 6c65 3a20  nse is in file: 
-000120a0: 2220 2b20 7265 7370 6f6e 7365 666f 6c64  " + responsefold
-000120b0: 6572 202b 2022 2f22 202b 2066 696c 656e  er + "/" + filen
-000120c0: 616d 6520 2b20 222e 7478 7420 284e 4f54  ame + ".txt (NOT
-000120d0: 453a 2074 6865 2072 6f6f 7420 666f 6c64  E: the root fold
-000120e0: 6572 2069 7320 7468 6520 446f 636b 6572  er is the Docker
-000120f0: 2043 6f6e 7461 696e 6572 2076 6964 656f   Container video
-00012100: 2066 6f6c 6465 722e 2922 0d0a 2020 7265   folder.)"..  re
-00012110: 7475 726e 2066 6d73 670d 0a0d 0a0d 0a23  turn fmsg......#
+00010300: 2020 2020 2020 2020 2065 6e61 626c 6574           enablet
+00010310: 6c73 3d31 2c70 6172 7469 7469 6f6e 3d2d  ls=1,partition=-
+00010320: 312c 6f66 6673 6574 3d2d 312c 6465 6c61  1,offset=-1,dela
+00010330: 793d 3130 302c 7469 6d65 6f75 743d 3132  y=100,timeout=12
+00010340: 302c 6272 6f6b 6572 686f 7374 3d27 272c  0,brokerhost='',
+00010350: 6272 6f6b 6572 706f 7274 3d2d 3939 392c  brokerport=-999,
+00010360: 6d69 6372 6f73 6572 7669 6365 6964 3d27  microserviceid='
+00010370: 2729 3a0d 0a20 2020 200d 0a20 2020 2067  '):..    ..    g
+00010380: 6c6f 6261 6c20 636f 6e6e 6563 7469 6f6e  lobal connection
+00010390: 6572 726f 720d 0a0d 0a20 2020 2069 6620  error....    if 
+000103a0: 286c 656e 2868 6f73 7429 3d3d 3020 6f72  (len(host)==0 or
+000103b0: 206c 656e 2876 6970 6572 746f 6b65 6e29   len(vipertoken)
+000103c0: 3d3d 3020 6f72 2070 6f72 743d 3d2d 3939  ==0 or port==-99
+000103d0: 3920 6f72 206c 656e 2874 6f70 6963 293d  9 or len(topic)=
+000103e0: 3d30 206f 7220 6c65 6e28 7465 7874 746f  =0 or len(textto
+000103f0: 616e 616c 7973 6529 3d3d 3020 206f 7220  analyse)==0  or 
+00010400: 6c65 6e28 7175 6572 7929 3d3d 3020 206f  len(query)==0  o
+00010410: 7220 6c65 6e28 6d6f 6465 6c6e 616d 6529  r len(modelname)
+00010420: 3d3d 3020 293a 0d0a 2020 2020 2020 2020  ==0 ):..        
+00010430: 2072 6574 7572 6e20 2250 6c65 6173 6520   return "Please 
+00010440: 656e 7465 7220 686f 7374 2c70 6f72 742c  enter host,port,
+00010450: 7669 7065 7274 6f6b 656e 2c74 6f70 6963  vipertoken,topic
+00010460: 2c6f 7065 6e61 696b 6579 2c74 6578 7474  ,openaikey,textt
+00010470: 6f61 6e61 6c79 7365 2c20 6d6f 6465 6c6e  oanalyse, modeln
+00010480: 616d 652c 2071 7565 7279 220d 0a20 2020  ame, query"..   
+00010490: 2020 2020 2020 2020 200d 0a20 2020 2076           ..    v
+000104a0: 616c 7565 3d28 2263 6861 7467 7074 7374  alue=("chatgptst
+000104b0: 7265 616d 3f76 6970 6572 746f 6b65 6e3d  ream?vipertoken=
+000104c0: 222b 7669 7065 7274 6f6b 656e 202b 2022  "+vipertoken + "
+000104d0: 266f 7065 6e61 696b 6579 3d22 202b 206f  &openaikey=" + o
+000104e0: 7065 6e61 696b 6579 202b 2022 2674 6f70  penaikey + "&top
+000104f0: 6963 3d22 2b74 6f70 6963 202b 2022 2664  ic="+topic + "&d
+00010500: 656c 6179 3d22 202b 2073 7472 2864 656c  elay=" + str(del
+00010510: 6179 2920 2b20 2226 6d61 7872 6f77 733d  ay) + "&maxrows=
+00010520: 2220 2b73 7472 286d 6178 726f 7773 2920  " +str(maxrows) 
+00010530: 2b0d 0a20 2020 2020 2020 2020 2020 2226  +..           "&
+00010540: 656e 6162 6c65 746c 733d 222b 7374 7228  enabletls="+str(
+00010550: 656e 6162 6c65 746c 7329 202b 2226 6272  enabletls) +"&br
+00010560: 6f6b 6572 686f 7374 3d22 2b62 726f 6b65  okerhost="+broke
+00010570: 7268 6f73 7420 2b20 2226 6272 6f6b 6572  rhost + "&broker
+00010580: 706f 7274 3d22 2b73 7472 2862 726f 6b65  port="+str(broke
+00010590: 7270 6f72 7429 202b 2022 2674 6578 7474  rport) + "&textt
+000105a0: 6f61 6e61 6c79 7365 3d22 2b74 6578 7474  oanalyse="+textt
+000105b0: 6f61 6e61 6c79 7365 202b 0d0a 2020 2020  oanalyse +..    
+000105c0: 2020 2020 2020 2022 266f 6666 7365 743d         "&offset=
+000105d0: 222b 7374 7228 6f66 6673 6574 2920 2b20  "+str(offset) + 
+000105e0: 2226 7175 6572 793d 2220 2b20 7175 6572  "&query=" + quer
+000105f0: 7920 2b20 2226 7465 6d70 6572 6174 7572  y + "&temperatur
+00010600: 653d 222b 2073 7472 2874 656d 7065 7261  e="+ str(tempera
+00010610: 7475 7265 290d 0a20 2020 2020 2020 2020  ture)..         
+00010620: 2020 2b20 2226 6d6f 6465 6c6e 616d 653d    + "&modelname=
+00010630: 222b 6d6f 6465 6c6e 616d 6520 2b20 2226  "+modelname + "&
+00010640: 6a73 6f6e 7061 7468 3d22 202b 206a 736f  jsonpath=" + jso
+00010650: 6e70 6174 6820 2b20 2226 7072 6f64 7563  npath + "&produc
+00010660: 6574 6f3d 2220 2b20 7072 6f64 7563 6574  eto=" + producet
+00010670: 6f20 2b20 0d0a 2020 2020 2020 2020 2020  o + ..          
+00010680: 2022 2670 6172 7469 7469 6f6e 3d22 202b   "&partition=" +
+00010690: 2073 7472 2870 6172 7469 7469 6f6e 2920   str(partition) 
+000106a0: 2b20 2226 7469 6d65 6f75 743d 2220 2b20  + "&timeout=" + 
+000106b0: 7374 7228 7469 6d65 6f75 7429 2029 0d0a  str(timeout) )..
+000106c0: 0d0a 2020 2020 7661 6c3d 6c6f 6f70 2e72  ..    val=loop.r
+000106d0: 756e 5f75 6e74 696c 5f63 6f6d 706c 6574  un_until_complet
+000106e0: 6528 7463 705f 6563 686f 5f63 6c69 656e  e(tcp_echo_clien
+000106f0: 7476 6970 6572 2876 616c 7565 2c20 6c6f  tviper(value, lo
+00010700: 6f70 2c68 6f73 742c 706f 7274 2c6d 6963  op,host,port,mic
+00010710: 726f 7365 7276 6963 6569 642c 7469 6d65  roserviceid,time
+00010720: 6f75 7429 290d 0a0d 0a20 2020 2069 6620  out))....    if 
+00010730: 636f 6e6e 6563 7469 6f6e 6572 726f 723a  connectionerror:
+00010740: 0d0a 2020 2020 2020 2020 2072 6574 7572  ..         retur
+00010750: 6e20 636f 6e6e 6563 7469 6f6e 6572 726f  n connectionerro
+00010760: 720d 0a0d 0a20 2020 2072 6574 7572 6e20  r....    return 
+00010770: 7661 6c0d 0a20 2020 200d 0a64 6566 2061  val..    ..def a
+00010780: 7265 796f 7562 7573 7928 686f 7374 2c70  reyoubusy(host,p
+00010790: 6f72 743d 2d39 3939 2c6d 6963 726f 7365  ort=-999,microse
+000107a0: 7276 6963 6569 643d 2727 293a 0d0a 2020  rviceid=''):..  
+000107b0: 2020 676c 6f62 616c 2063 6f6e 6e65 6374    global connect
+000107c0: 696f 6e65 7272 6f72 0d0a 0d0a 2020 2020  ionerror....    
+000107d0: 6966 2028 6c65 6e28 686f 7374 293d 3d30  if (len(host)==0
+000107e0: 206f 7220 706f 7274 3d3d 2d39 3939 2029   or port==-999 )
+000107f0: 3a0d 0a20 2020 2020 2020 2020 7265 7475  :..         retu
+00010800: 726e 2022 506c 6561 7365 2065 6e74 6572  rn "Please enter
+00010810: 2068 6f73 742c 706f 7274 220d 0a20 2020   host,port"..   
+00010820: 2076 616c 7565 3d28 2261 7265 796f 7562   value=("areyoub
+00010830: 7573 7922 290d 0a0d 0a20 2020 2076 616c  usy")....    val
+00010840: 3d6c 6f6f 702e 7275 6e5f 756e 7469 6c5f  =loop.run_until_
+00010850: 636f 6d70 6c65 7465 2874 6370 5f65 6368  complete(tcp_ech
+00010860: 6f5f 636c 6965 6e74 7669 7065 7228 7661  o_clientviper(va
+00010870: 6c75 652c 206c 6f6f 702c 686f 7374 2c70  lue, loop,host,p
+00010880: 6f72 742c 6d69 6372 6f73 6572 7669 6365  ort,microservice
+00010890: 6964 2929 0d0a 2020 2020 6966 2063 6f6e  id))..    if con
+000108a0: 6e65 6374 696f 6e65 7272 6f72 3a0d 0a20  nectionerror:.. 
+000108b0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+000108c0: 6f6e 6e65 6374 696f 6e65 7272 6f72 0d0a  onnectionerror..
+000108d0: 0d0a 2020 2020 7265 7475 726e 2076 616c  ..    return val
+000108e0: 0d0a 0d0a 6465 6620 7067 7074 696e 6765  ....def pgptinge
+000108f0: 7374 646f 6373 2864 6f63 6e61 6d65 2c64  stdocs(docname,d
+00010900: 6f63 7479 7065 2c20 7067 7074 6970 2c70  octype, pgptip,p
+00010910: 6770 7470 6f72 742c 7067 7074 656e 6470  gptport,pgptendp
+00010920: 6f69 6e74 293a 0d0a 0d0a 2020 7572 6c3d  oint):....  url=
+00010930: 7067 7074 6970 202b 2022 3a22 202b 2070  pgptip + ":" + p
+00010940: 6770 7470 6f72 7420 2b20 7067 7074 656e  gptport + pgpten
+00010950: 6470 6f69 6e74 0d0a 2020 7472 793a 0d0a  dpoint..  try:..
+00010960: 2020 2020 2020 6966 2064 6f63 7479 7065        if doctype
+00010970: 203d 3d20 2762 696e 6172 7927 3a0d 0a20   == 'binary':.. 
+00010980: 2020 2020 2020 2066 696c 653d 6f70 656e         file=open
+00010990: 2864 6f63 6e61 6d65 2c20 2772 6227 290d  (docname, 'rb').
+000109a0: 0a20 2020 2020 2065 6c73 653a 0d0a 2020  .      else:..  
+000109b0: 2020 2020 2020 6669 6c65 3d6f 7065 6e28        file=open(
+000109c0: 646f 636e 616d 652c 2027 7227 2920 200d  docname, 'r')  .
+000109d0: 0a20 2065 7863 6570 7420 494f 4572 726f  .  except IOErro
+000109e0: 723a 0d0a 2020 2020 2020 7265 7475 726e  r:..      return
+000109f0: 2022 4552 524f 523a 2046 696c 6520 646f   "ERROR: File do
+00010a00: 6573 206e 6f74 2061 7070 6561 7220 746f  es not appear to
+00010a10: 2065 7869 7374 2e22 0d0a 0d0a 2020 6669   exist."....  fi
+00010a20: 6c65 7320 3d20 7b0d 0a20 2020 2027 6669  les = {..    'fi
+00010a30: 6c65 273a 2028 646f 636e 616d 652c 2066  le': (docname, f
+00010a40: 696c 6529 2c0d 0a20 207d 0d0a 2020 0d0a  ile),..  }..  ..
+00010a50: 2020 7472 793a 0d0a 2020 2020 6f62 6a3d    try:..    obj=
+00010a60: 7265 7175 6573 7473 2e70 6f73 7428 7572  requests.post(ur
+00010a70: 6c2c 2066 696c 6573 3d66 696c 6573 290d  l, files=files).
+00010a80: 0a20 2020 2072 6574 7572 6e20 6f62 6a2e  .    return obj.
+00010a90: 7465 7874 0d0a 2020 6578 6365 7074 2045  text..  except E
+00010aa0: 7863 6570 7469 6f6e 2061 7320 653a 0d0a  xception as e:..
+00010ab0: 2020 2020 7265 7475 726e 2022 4552 524f      return "ERRO
+00010ac0: 523a 2220 2b20 7374 7228 6529 0d0a 0d0a  R:" + str(e)....
+00010ad0: 6465 6620 7067 7074 6765 7469 6e67 6573  def pgptgetinges
+00010ae0: 7465 6465 6d62 6564 6469 6e67 7328 646f  tedembeddings(do
+00010af0: 636e 616d 652c 6970 2c70 6f72 742c 656e  cname,ip,port,en
+00010b00: 6470 6f69 6e74 293a 0d0a 2020 7572 6c3d  dpoint):..  url=
+00010b10: 6970 202b 2022 3a22 202b 2070 6f72 7420  ip + ":" + port 
+00010b20: 2b20 656e 6470 6f69 6e74 2023 222f 7631  + endpoint #"/v1
+00010b30: 2f69 6e67 6573 742f 6c69 7374 220d 0a20  /ingest/list".. 
+00010b40: 2064 6f63 6964 7320 3d20 5b5d 0d0a 2020   docids = []..  
+00010b50: 646f 6369 6473 7374 7220 3d20 5b5d 0d0a  docidsstr = []..
+00010b60: 0d0a 2020 7472 793a 0d0a 2020 2020 6f62  ..  try:..    ob
+00010b70: 6a3d 7265 7175 6573 7473 2e67 6574 2875  j=requests.get(u
+00010b80: 726c 290d 0a20 2020 206a 7320 3d20 6a73  rl)..    js = js
+00010b90: 6f6e 2e6c 6f61 6473 286f 626a 2e74 6578  on.loads(obj.tex
+00010ba0: 7429 0d0a 2020 2020 666f 7220 6a20 696e  t)..    for j in
+00010bb0: 206a 735b 2264 6174 6122 5d3a 0d0a 2020   js["data"]:..  
+00010bc0: 2020 2020 6966 206a 5b22 646f 635f 6d65      if j["doc_me
+00010bd0: 7461 6461 7461 225d 5b22 6669 6c65 5f6e  tadata"]["file_n
+00010be0: 616d 6522 5d3d 3d64 6f63 6e61 6d65 3a0d  ame"]==docname:.
+00010bf0: 0a20 2020 2020 2020 2020 2370 7269 6e74  .         #print
+00010c00: 286a 5b22 646f 635f 6964 225d 290d 0a20  (j["doc_id"]).. 
+00010c10: 2020 2020 2020 2020 646f 6369 6473 2e61          docids.a
+00010c20: 7070 656e 6428 6a5b 2264 6f63 5f69 6422  ppend(j["doc_id"
+00010c30: 5d29 0d0a 2020 2020 2020 2020 2064 6f63  ])..         doc
+00010c40: 6964 7373 7472 2e61 7070 656e 6428 6a5b  idsstr.append(j[
+00010c50: 2264 6f63 5f69 6422 5d29 0d0a 0d0a 2020  "doc_id"])....  
+00010c60: 2020 646f 6373 7472 3d20 2827 2c20 272e    docstr= (', '.
+00010c70: 6a6f 696e 2827 2227 202b 2069 7465 6d20  join('"' + item 
+00010c80: 2b20 2722 2720 666f 7220 6974 656d 2069  + '"' for item i
+00010c90: 6e20 646f 6369 6473 2929 0d0a 2020 0d0a  n docids))..  ..
+00010ca0: 2020 2020 7265 7475 726e 2064 6f63 6964      return docid
+00010cb0: 732c 646f 6373 7472 2c64 6f63 6964 7373  s,docstr,docidss
+00010cc0: 7472 0d0a 2020 6578 6365 7074 2045 7863  tr..  except Exc
+00010cd0: 6570 7469 6f6e 2061 7320 653a 0d0a 2020  eption as e:..  
+00010ce0: 2020 7265 7475 726e 2022 4552 524f 523a    return "ERROR:
+00010cf0: 2220 2b20 7374 7228 6529 2c22 222c 2222  " + str(e),"",""
+00010d00: 2020 0d0a 2020 2020 2020 0d0a 0d0a 2020    ..      ....  
+00010d10: 2020 0d0a 6465 6620 7067 7074 6368 6174    ..def pgptchat
+00010d20: 2870 726f 6d70 742c 636f 6e74 6578 742c  (prompt,context,
+00010d30: 646f 6366 696c 7465 722c 706f 7274 2c69  docfilter,port,i
+00010d40: 6e63 6c75 6465 736f 7572 6365 732c 6970  ncludesources,ip
+00010d50: 2c65 6e64 706f 696e 7429 3a0d 0a20 2023  ,endpoint):..  #
+00010d60: 7572 6c3d 2268 7474 703a 2f2f 3132 372e  url="http://127.
+00010d70: 302e 302e 313a 3830 3031 2f72 756e 2f70  0.0.1:8001/run/p
+00010d80: 7265 6469 6374 220d 0a20 2075 726c 3d69  redict"..  url=i
+00010d90: 7020 2b20 223a 2220 2b20 706f 7274 202b  p + ":" + port +
+00010da0: 2065 6e64 706f 696e 740d 0a0d 0a20 200d   endpoint....  .
+00010db0: 0a20 2020 200d 0a20 2068 6561 6465 7273  .    ..  headers
+00010dc0: 203d 207b 2263 6f6e 7465 6e74 2d74 7970   = {"content-typ
+00010dd0: 6522 3a20 2261 7070 6c69 6361 7469 6f6e  e": "application
+00010de0: 2f6a 736f 6e22 7d0d 0a20 2069 6620 646f  /json"}..  if do
+00010df0: 6366 696c 7465 7220 213d 2022 223a 0d0a  cfilter != "":..
+00010e00: 2020 2020 7061 796c 6f61 6420 3d20 7b0d      payload = {.
+00010e10: 0a20 2020 2020 2020 2020 2022 696e 636c  .          "incl
+00010e20: 7564 655f 736f 7572 6365 7322 3a20 696e  ude_sources": in
+00010e30: 636c 7564 6573 6f75 7263 6573 2c0d 0a20  cludesources,.. 
+00010e40: 2020 2020 2020 2020 2022 7072 6f6d 7074           "prompt
+00010e50: 223a 2070 726f 6d70 742c 0d0a 2020 2020  ": prompt,..    
+00010e60: 2020 2020 2020 2273 7472 6561 6d22 3a20        "stream": 
+00010e70: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
+00010e80: 2020 2275 7365 5f63 6f6e 7465 7874 223a    "use_context":
+00010e90: 2063 6f6e 7465 7874 2c0d 0a20 2020 2020   context,..     
+00010ea0: 2020 2020 2022 636f 6e74 6578 745f 6669       "context_fi
+00010eb0: 6c74 6572 223a 207b 2022 646f 6373 5f69  lter": { "docs_i
+00010ec0: 6473 223a 2064 6f63 6669 6c74 6572 207d  ds": docfilter }
+00010ed0: 0d0a 2020 2020 7d0d 0a20 2020 2320 7072  ..    }..   # pr
+00010ee0: 696e 7428 7061 796c 6f61 6429 2020 0d0a  int(payload)  ..
+00010ef0: 2020 656c 7365 3a0d 0a20 2020 2070 6179    else:..    pay
+00010f00: 6c6f 6164 203d 207b 0d0a 2020 2020 2020  load = {..      
+00010f10: 2020 2020 2269 6e63 6c75 6465 5f73 6f75      "include_sou
+00010f20: 7263 6573 223a 2069 6e63 6c75 6465 736f  rces": includeso
+00010f30: 7572 6365 732c 0d0a 2020 2020 2020 2020  urces,..        
+00010f40: 2020 2270 726f 6d70 7422 3a20 7072 6f6d    "prompt": prom
+00010f50: 7074 2c0d 0a20 2020 2020 2020 2020 2022  pt,..          "
+00010f60: 7374 7265 616d 223a 2046 616c 7365 2c0d  stream": False,.
+00010f70: 0a20 2020 2020 2020 2020 2022 7573 655f  .          "use_
+00010f80: 636f 6e74 6578 7422 3a20 636f 6e74 6578  context": contex
+00010f90: 740d 0a20 2020 207d 0d0a 2020 7472 793a  t..    }..  try:
+00010fa0: 2020 200d 0a20 2020 206f 626a 3d72 6571     ..    obj=req
+00010fb0: 7565 7374 732e 706f 7374 2875 726c 2c20  uests.post(url, 
+00010fc0: 6a73 6f6e 3d70 6179 6c6f 6164 2c68 6561  json=payload,hea
+00010fd0: 6465 7273 3d68 6561 6465 7273 290d 0a20  ders=headers).. 
+00010fe0: 2020 2072 6574 7572 6e20 6f62 6a2e 7465     return obj.te
+00010ff0: 7874 0d0a 2020 6578 6365 7074 2045 7863  xt..  except Exc
+00011000: 6570 7469 6f6e 2061 7320 653a 0d0a 2020  eption as e:..  
+00011010: 2020 7265 7475 726e 2022 4552 524f 523a    return "ERROR:
+00011020: 2220 2b20 7374 7228 6529 2020 0d0a 0d0a  " + str(e)  ....
+00011030: 0d0a 6465 6620 7067 7074 6465 6c65 7465  ..def pgptdelete
+00011040: 656d 6265 6464 696e 6773 2864 6f63 6964  embeddings(docid
+00011050: 732c 2069 702c 706f 7274 2c65 6e64 706f  s, ip,port,endpo
+00011060: 696e 7429 3a0d 0a20 2020 2020 0d0a 2020  int):..     ..  
+00011070: 7572 6c3d 6970 202b 2022 3a22 202b 2070  url=ip + ":" + p
+00011080: 6f72 7420 2b20 656e 6470 6f69 6e74 0d0a  ort + endpoint..
+00011090: 2020 6966 206c 656e 2864 6f63 6964 7329    if len(docids)
+000110a0: 3d3d 303a 0d0a 2020 2020 2020 7265 7475  ==0:..      retu
+000110b0: 726e 2022 4552 524f 523a 646f 6369 6473  rn "ERROR:docids
+000110c0: 2069 7320 656d 7074 7922 0d0a 2020 7472   is empty"..  tr
+000110d0: 793a 0d0a 2020 2020 666f 7220 6a20 696e  y:..    for j in
+000110e0: 2064 6f63 6964 733a 0d0a 2020 2020 2020   docids:..      
+000110f0: 6f62 6a3d 7265 7175 6573 7473 2e64 656c  obj=requests.del
+00011100: 6574 6528 7572 6c2b 6a29 0d0a 2020 2020  ete(url+j)..    
+00011110: 2020 7072 696e 7428 2244 454c 4554 4544    print("DELETED
+00011120: 3a22 2c6a 290d 0a20 2065 7863 6570 7420  :",j)..  except 
+00011130: 4578 6365 7074 696f 6e20 6173 2065 3a0d  Exception as e:.
+00011140: 0a20 2020 2072 6574 7572 6e20 2245 5252  .    return "ERR
+00011150: 4f52 3a22 202b 2073 7472 2865 2920 200d  OR:" + str(e)  .
+00011160: 0a20 2020 2020 0d0a 6465 6620 7067 7074  .     ..def pgpt
+00011170: 6865 616c 7468 2869 702c 706f 7274 2c65  health(ip,port,e
+00011180: 6e64 706f 696e 7429 3a0d 0a20 2075 726c  ndpoint):..  url
+00011190: 3d69 7020 2b20 223a 2220 2b20 706f 7274  =ip + ":" + port
+000111a0: 202b 2065 6e64 706f 696e 740d 0a0d 0a20   + endpoint.... 
+000111b0: 2074 7279 3a0d 0a20 2020 206f 626a 3d72   try:..    obj=r
+000111c0: 6571 7565 7374 732e 6765 7428 7572 6c29  equests.get(url)
+000111d0: 0d0a 2020 2020 7265 7475 726e 206f 626a  ..    return obj
+000111e0: 2e74 6578 740d 0a20 2065 7863 6570 7420  .text..  except 
+000111f0: 4578 6365 7074 696f 6e20 6173 2065 3a0d  Exception as e:.
+00011200: 0a20 2020 2072 6574 7572 6e20 2245 5252  .    return "ERR
+00011210: 4f52 3a22 202b 2073 7472 2865 290d 0a0d  OR:" + str(e)...
+00011220: 0a0d 0a64 6566 2076 6964 656f 6368 6174  ...def videochat
+00011230: 6c6f 6164 7265 7370 6f6e 7365 2875 726c  loadresponse(url
+00011240: 2c70 6f72 742c 6669 6c65 6e61 6d65 2c70  ,port,filename,p
+00011250: 726f 6d70 742c 7265 7370 6f6e 7365 666f  rompt,responsefo
+00011260: 6c64 6572 3d27 7669 6465 6f67 7074 5f72  lder='videogpt_r
+00011270: 6573 706f 6e73 6527 2c74 656d 7065 7261  esponse',tempera
+00011280: 7475 7265 3d30 2e33 2c6d 6178 5f6f 7574  ture=0.3,max_out
+00011290: 7075 745f 746f 6b65 6e73 3d35 3132 293a  put_tokens=512):
+000112a0: 0d0a 2320 2075 726c 3d27 6874 7470 3a2f  ..#  url='http:/
+000112b0: 2f31 3237 2e30 2e30 2e31 3a37 3830 302f  /127.0.0.1:7800/
+000112c0: 3f75 706c 6f61 6466 696c 653d 7361 6d70  ?uploadfile=samp
+000112d0: 6c65 5f36 2e6d 7034 2674 656d 7065 7261  le_6.mp4&tempera
+000112e0: 7475 7265 3d30 2e33 266d 6178 5f6f 7574  ture=0.3&max_out
+000112f0: 7075 745f 746f 6b65 6e73 3d35 3132 2670  put_tokens=512&p
+00011300: 726f 6d70 743d 5768 6174 2532 3069 7325  rompt=What%20is%
+00011310: 3230 7669 6465 6f25 3230 6162 6f75 743f  20video%20about?
+00011320: 2672 6573 706f 6e73 6566 6f6c 6465 723d  &responsefolder=
+00011330: 6c6f 6e64 6f6e 666f 6c64 6572 270d 0a0d  londonfolder'...
+00011340: 0a20 206d 6169 6e75 726c 203d 2075 726c  .  mainurl = url
+00011350: 202b 2022 3a22 202b 2070 6f72 7420 2b20   + ":" + port + 
+00011360: 222f 3f75 706c 6f61 6466 696c 653d 222b  "/?uploadfile="+
+00011370: 6669 6c65 6e61 6d65 202b 2022 2674 656d  filename + "&tem
+00011380: 7065 7261 7475 7265 3d22 202b 2073 7472  perature=" + str
+00011390: 2874 656d 7065 7261 7475 7265 2920 2b20  (temperature) + 
+000113a0: 2226 6d61 785f 6f75 7470 7574 5f74 6f6b  "&max_output_tok
+000113b0: 656e 733d 2220 2b20 7374 7228 6d61 785f  ens=" + str(max_
+000113c0: 6f75 7470 7574 5f74 6f6b 656e 7329 202b  output_tokens) +
+000113d0: 2022 2670 726f 6d70 743d 2220 2b70 726f   "&prompt=" +pro
+000113e0: 6d70 7420 2b20 2226 7265 7370 6f6e 7365  mpt + "&response
+000113f0: 666f 6c64 6572 3d22 202b 2072 6573 706f  folder=" + respo
+00011400: 6e73 6566 6f6c 6465 720d 0a20 200d 0a20  nsefolder..  .. 
+00011410: 206f 7074 696f 6e73 203d 204f 7074 696f   options = Optio
+00011420: 6e73 2829 0d0a 2020 6f70 7469 6f6e 732e  ns()..  options.
+00011430: 6164 645f 6172 6775 6d65 6e74 2822 2d2d  add_argument("--
+00011440: 6865 6164 6c65 7373 2229 0d0a 2020 6472  headless")..  dr
+00011450: 6976 6572 203d 2077 6562 6472 6976 6572  iver = webdriver
+00011460: 2e46 6972 6566 6f78 286f 7074 696f 6e73  .Firefox(options
+00011470: 3d6f 7074 696f 6e73 290d 0a20 2072 6574  =options)..  ret
+00011480: 203d 2064 7269 7665 722e 6765 7428 6d61   = driver.get(ma
+00011490: 696e 7572 6c29 2020 2020 2020 2020 0d0a  inurl)        ..
+000114a0: 2020 6472 6976 6572 2e71 7569 7428 290d    driver.quit().
+000114b0: 0a20 2066 6d73 6720 3d20 7265 7370 6f6e  .  fmsg = respon
+000114c0: 7365 666f 6c64 6572 202b 2022 2f22 202b  sefolder + "/" +
+000114d0: 2066 696c 656e 616d 6520 2b20 222e 7478   filename + ".tx
+000114e0: 7422 0d0a 2020 236d 7367 203d 2022 5669  t"..  #msg = "Vi
+000114f0: 6465 6f20 4750 5420 7265 7370 6f6e 7365  deo GPT response
+00011500: 2069 7320 696e 2066 696c 653a 2022 202b   is in file: " +
+00011510: 2072 6573 706f 6e73 6566 6f6c 6465 7220   responsefolder 
+00011520: 2b20 222f 2220 2b20 6669 6c65 6e61 6d65  + "/" + filename
+00011530: 202b 2022 2e74 7874 2028 4e4f 5445 3a20   + ".txt (NOTE: 
+00011540: 7468 6520 726f 6f74 2066 6f6c 6465 7220  the root folder 
+00011550: 6973 2074 6865 2044 6f63 6b65 7220 436f  is the Docker Co
+00011560: 6e74 6169 6e65 7220 7669 6465 6f20 666f  ntainer video fo
+00011570: 6c64 6572 2e29 220d 0a20 2072 6574 7572  lder.)"..  retur
+00011580: 6e20 666d 7367 0d0a 0d0a 0d0a 2323 2323  n fmsg......####
+00011590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000115a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000115b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000115c0: 0d0a 696d 706f 7274 2073 7973 0d0a 6672  ..import sys..fr
+000115d0: 6f6d 2070 6466 6d69 6e65 722e 7064 6670  om pdfminer.pdfp
+000115e0: 6172 7365 7220 696d 706f 7274 2050 4446  arser import PDF
+000115f0: 5061 7273 6572 0d0a 6672 6f6d 2070 6466  Parser..from pdf
+00011600: 6d69 6e65 722e 7064 6664 6f63 756d 656e  miner.pdfdocumen
+00011610: 7420 696d 706f 7274 2050 4446 446f 6375  t import PDFDocu
+00011620: 6d65 6e74 0d0a 6672 6f6d 2070 6466 6d69  ment..from pdfmi
+00011630: 6e65 722e 7064 6670 6167 6520 696d 706f  ner.pdfpage impo
+00011640: 7274 2050 4446 5061 6765 0d0a 6672 6f6d  rt PDFPage..from
+00011650: 2070 6466 6d69 6e65 722e 7064 6670 6167   pdfminer.pdfpag
+00011660: 6520 696d 706f 7274 2050 4446 5465 7874  e import PDFText
+00011670: 4578 7472 6163 7469 6f6e 4e6f 7441 6c6c  ExtractionNotAll
+00011680: 6f77 6564 0d0a 6672 6f6d 2070 6466 6d69  owed..from pdfmi
+00011690: 6e65 722e 7064 6669 6e74 6572 7020 696d  ner.pdfinterp im
+000116a0: 706f 7274 2050 4446 5265 736f 7572 6365  port PDFResource
+000116b0: 4d61 6e61 6765 720d 0a66 726f 6d20 7064  Manager..from pd
+000116c0: 666d 696e 6572 2e70 6466 696e 7465 7270  fminer.pdfinterp
+000116d0: 2069 6d70 6f72 7420 5044 4650 6167 6549   import PDFPageI
+000116e0: 6e74 6572 7072 6574 6572 0d0a 2366 726f  nterpreter..#fro
+000116f0: 6d20 5374 7269 6e67 494f 2069 6d70 6f72  m StringIO impor
+00011700: 7420 5374 7269 6e67 494f 0d0a 6672 6f6d  t StringIO..from
+00011710: 2069 6f20 696d 706f 7274 2053 7472 696e   io import Strin
+00011720: 6749 4f0d 0a69 6d70 6f72 7420 7572 6c6c  gIO..import urll
+00011730: 6962 2e72 6571 7565 7374 2020 0d0a 2369  ib.request  ..#i
+00011740: 6d70 6f72 7420 746d 6c74 6578 7473 756d  mport tmltextsum
+00011750: 6d61 7279 0d0a 696d 706f 7274 206f 730d  mary..import os.
+00011760: 0a69 6d70 6f72 7420 6461 7465 7469 6d65  .import datetime
+00011770: 0d0a 2369 6d70 6f72 7420 676c 6f62 0d0a  ..#import glob..
+00011780: 0d0a 0d0a 6672 6f6d 2070 6466 6d69 6e65  ....from pdfmine
+00011790: 722e 6c61 796f 7574 2069 6d70 6f72 7420  r.layout import 
+000117a0: 4c41 5061 7261 6d73 0d0a 6672 6f6d 2070  LAParams..from p
+000117b0: 6466 6d69 6e65 722e 636f 6e76 6572 7465  dfminer.converte
+000117c0: 7220 696d 706f 7274 2054 6578 7443 6f6e  r import TextCon
+000117d0: 7665 7274 6572 0d0a 200d 0a63 6c61 7373  verter.. ..class
+000117e0: 204d 7950 6172 7365 7228 6f62 6a65 6374   MyParser(object
+000117f0: 293a 0d0a 2020 2020 6465 6620 5f5f 696e  ):..    def __in
+00011800: 6974 5f5f 2873 656c 662c 2070 6466 293a  it__(self, pdf):
+00011810: 0d0a 2020 2020 2020 2020 2323 2053 6e69  ..        ## Sni
+00011820: 7070 6564 2061 6461 7074 6564 2066 726f  pped adapted fro
+00011830: 6d20 5975 7375 6b65 2053 6869 6e79 616d  m Yusuke Shinyam
+00011840: 6173 200d 0a20 2020 2020 2020 2023 5044  as ..        #PD
+00011850: 464d 696e 6572 2064 6f63 756d 656e 7461  FMiner documenta
+00011860: 7469 6f6e 0d0a 2020 2020 2020 2020 2320  tion..        # 
+00011870: 4372 6561 7465 2074 6865 2064 6f63 756d  Create the docum
+00011880: 656e 7420 6d6f 6465 6c20 6672 6f6d 2074  ent model from t
+00011890: 6865 2066 696c 650d 0a20 2020 2020 2020  he file..       
+000118a0: 2070 6172 7365 7220 3d20 5044 4650 6172   parser = PDFPar
+000118b0: 7365 7228 6f70 656e 2870 6466 2c20 2772  ser(open(pdf, 'r
+000118c0: 6227 2929 0d0a 2020 2020 2020 2020 646f  b'))..        do
+000118d0: 6375 6d65 6e74 203d 2050 4446 446f 6375  cument = PDFDocu
+000118e0: 6d65 6e74 2870 6172 7365 7229 0d0a 2020  ment(parser)..  
+000118f0: 2020 2020 2020 2320 5472 7920 746f 2070        # Try to p
+00011900: 6172 7365 2074 6865 2064 6f63 756d 656e  arse the documen
+00011910: 740d 0a20 2020 2020 2020 2069 6620 6e6f  t..        if no
+00011920: 7420 646f 6375 6d65 6e74 2e69 735f 6578  t document.is_ex
+00011930: 7472 6163 7461 626c 653a 0d0a 2020 2020  tractable:..    
+00011940: 2020 2020 2020 2020 7261 6973 6520 5044          raise PD
+00011950: 4654 6578 7445 7874 7261 6374 696f 6e4e  FTextExtractionN
+00011960: 6f74 416c 6c6f 7765 640d 0a20 2020 2020  otAllowed..     
+00011970: 2020 2023 2043 7265 6174 6520 6120 5044     # Create a PD
+00011980: 4620 7265 736f 7572 6365 206d 616e 6167  F resource manag
+00011990: 6572 206f 626a 6563 7420 0d0a 2020 2020  er object ..    
+000119a0: 2020 2020 2320 7468 6174 2073 746f 7265      # that store
+000119b0: 7320 7368 6172 6564 2072 6573 6f75 7263  s shared resourc
+000119c0: 6573 2e0d 0a20 2020 2020 2020 2072 7372  es...        rsr
+000119d0: 636d 6772 203d 2050 4446 5265 736f 7572  cmgr = PDFResour
+000119e0: 6365 4d61 6e61 6765 7228 290d 0a20 2020  ceManager()..   
+000119f0: 2020 2020 2023 2043 7265 6174 6520 6120       # Create a 
+00011a00: 6275 6666 6572 2066 6f72 2074 6865 2070  buffer for the p
+00011a10: 6172 7365 6420 7465 7874 0d0a 2020 2020  arsed text..    
+00011a20: 2020 2020 7265 7473 7472 203d 2053 7472      retstr = Str
+00011a30: 696e 6749 4f28 290d 0a20 2020 2020 2020  ingIO()..       
+00011a40: 2023 2053 7061 6369 6e67 2070 6172 616d   # Spacing param
+00011a50: 6574 6572 7320 666f 7220 7061 7273 696e  eters for parsin
+00011a60: 670d 0a20 2020 2020 2020 206c 6170 6172  g..        lapar
+00011a70: 616d 7320 3d20 4c41 5061 7261 6d73 2829  ams = LAParams()
+00011a80: 0d0a 2020 2020 2020 2020 636f 6465 6320  ..        codec 
+00011a90: 3d20 2775 7466 2d38 270d 0a20 0d0a 2020  = 'utf-8'.. ..  
+00011aa0: 2020 2020 2020 2320 4372 6561 7465 2061        # Create a
+00011ab0: 2050 4446 2064 6576 6963 6520 6f62 6a65   PDF device obje
+00011ac0: 6374 0d0a 2020 2020 2020 2020 6465 7669  ct..        devi
+00011ad0: 6365 203d 2054 6578 7443 6f6e 7665 7274  ce = TextConvert
+00011ae0: 6572 2872 7372 636d 6772 2c20 7265 7473  er(rsrcmgr, rets
+00011af0: 7472 2c0d 0a20 2020 2020 2020 2020 2020  tr,..           
+00011b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b10: 2020 2020 6c61 7061 7261 6d73 203d 206c      laparams = l
+00011b20: 6170 6172 616d 7329 0d0a 2020 2020 2020  aparams)..      
+00011b30: 2020 2320 4372 6561 7465 2061 2050 4446    # Create a PDF
+00011b40: 2069 6e74 6572 7072 6574 6572 206f 626a   interpreter obj
+00011b50: 6563 740d 0a20 2020 2020 2020 2069 6e74  ect..        int
+00011b60: 6572 7072 6574 6572 203d 2050 4446 5061  erpreter = PDFPa
+00011b70: 6765 496e 7465 7270 7265 7465 7228 7273  geInterpreter(rs
+00011b80: 7263 6d67 722c 2064 6576 6963 6529 0d0a  rcmgr, device)..
+00011b90: 2020 2020 2020 2020 2320 5072 6f63 6573          # Proces
+00011ba0: 7320 6561 6368 2070 6167 6520 636f 6e74  s each page cont
+00011bb0: 6169 6e65 6420 696e 2074 6865 2064 6f63  ained in the doc
+00011bc0: 756d 656e 742e 0d0a 2020 2020 2020 2020  ument...        
+00011bd0: 666f 7220 7061 6765 2069 6e20 5044 4650  for page in PDFP
+00011be0: 6167 652e 6372 6561 7465 5f70 6167 6573  age.create_pages
+00011bf0: 2864 6f63 756d 656e 7429 3a0d 0a20 2020  (document):..   
+00011c00: 2020 2020 2020 2020 2069 6e74 6572 7072           interpr
+00011c10: 6574 6572 2e70 726f 6365 7373 5f70 6167  eter.process_pag
+00011c20: 6528 7061 6765 290d 0a20 2020 2020 2020  e(page)..       
+00011c30: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+00011c40: 2e72 6563 6f72 6473 2020 2020 2020 2020  .records        
+00011c50: 2020 2020 3d20 5b5d 0d0a 2020 2020 2020      = []..      
+00011c60: 2020 200d 0a20 2020 2020 2020 206c 696e     ..        lin
+00011c70: 6573 203d 2072 6574 7374 722e 6765 7476  es = retstr.getv
+00011c80: 616c 7565 2829 2e73 706c 6974 6c69 6e65  alue().splitline
+00011c90: 7328 290d 0a20 2020 2020 2020 2066 6f72  s()..        for
+00011ca0: 206c 696e 6520 696e 206c 696e 6573 3a0d   line in lines:.
+00011cb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00011cc0: 662e 6861 6e64 6c65 5f6c 696e 6528 6c69  f.handle_line(li
+00011cd0: 6e65 290d 0a20 2020 2020 0d0a 2020 2020  ne)..     ..    
+00011ce0: 6465 6620 6861 6e64 6c65 5f6c 696e 6528  def handle_line(
+00011cf0: 7365 6c66 2c20 6c69 6e65 293a 0d0a 2020  self, line):..  
+00011d00: 2020 2020 2020 2320 4375 7374 6f6d 697a        # Customiz
+00011d10: 6520 796f 7572 206c 696e 652d 6279 2d6c  e your line-by-l
+00011d20: 696e 6520 7061 7273 6572 2068 6572 650d  ine parser here.
+00011d30: 0a20 2020 2020 2020 2073 656c 662e 7265  .        self.re
+00011d40: 636f 7264 732e 6170 7065 6e64 286c 696e  cords.append(lin
+00011d50: 6529 0d0a 0d0a 6465 6620 7363 7261 7065  e)....def scrape
+00011d60: 7064 6628 7468 6575 726c 2c66 6e29 3a0d  pdf(theurl,fn):.
+00011d70: 0a20 2020 2073 6372 6170 6564 5f64 6174  .    scraped_dat
+00011d80: 6120 3d20 7572 6c6c 6962 2e72 6571 7565  a = urllib.reque
+00011d90: 7374 2e75 726c 6f70 656e 2874 6865 7572  st.urlopen(theur
+00011da0: 6c29 2020 0d0a 2020 2020 6669 6c65 203d  l)  ..    file =
+00011db0: 206f 7065 6e28 666e 2c20 2777 6227 290d   open(fn, 'wb').
+00011dc0: 0a20 2020 2066 696c 652e 7772 6974 6528  .    file.write(
+00011dd0: 7363 7261 7065 645f 6461 7461 2e72 6561  scraped_data.rea
+00011de0: 6428 2929 0d0a 2020 2020 6669 6c65 2e63  d())..    file.c
+00011df0: 6c6f 7365 2829 0d0a 2020 2020 2372 6574  lose()..    #ret
+00011e00: 7572 6e20 6172 7469 636c 655f 7465 7874  urn article_text
+00011e10: 0d0a 0d0a 6465 6620 7374 6172 7470 6466  ....def startpdf
+00011e20: 7265 6164 696e 6728 6669 6c65 6e61 6d65  reading(filename
+00011e30: 2c66 7661 6c75 652c 6b65 7963 6f75 6e74  ,fvalue,keycount
+00011e40: 293a 0d0a 2020 236f 732e 7061 7468 2e61  ):..  #os.path.a
+00011e50: 6273 7061 7468 286f 732e 6765 7463 7764  bspath(os.getcwd
+00011e60: 2829 290d 0a20 2074 6865 7369 7a65 3d72  ())..  thesize=r
+00011e70: 6f75 6e64 286f 732e 7061 7468 2e67 6574  ound(os.path.get
+00011e80: 7369 7a65 2866 696c 656e 616d 6529 2f31  size(filename)/1
+00011e90: 3030 3030 3030 2c32 290d 0a20 206d 5f74  000000,2)..  m_t
+00011ea0: 696d 6520 3d20 6f73 2e70 6174 682e 6765  ime = os.path.ge
+00011eb0: 746d 7469 6d65 2866 696c 656e 616d 6529  tmtime(filename)
+00011ec0: 0d0a 2020 6474 5f6d 203d 2064 6174 6574  ..  dt_m = datet
+00011ed0: 696d 652e 6461 7465 7469 6d65 2e66 726f  ime.datetime.fro
+00011ee0: 6d74 696d 6573 7461 6d70 286d 5f74 696d  mtimestamp(m_tim
+00011ef0: 6529 0d0a 2020 635f 7469 6d65 203d 206f  e)..  c_time = o
+00011f00: 732e 7061 7468 2e67 6574 6374 696d 6528  s.path.getctime(
+00011f10: 6669 6c65 6e61 6d65 290d 0a20 2023 2063  filename)..  # c
+00011f20: 6f6e 7665 7274 2063 7265 6174 696f 6e20  onvert creation 
+00011f30: 7469 6d65 7374 616d 7020 696e 746f 2044  timestamp into D
+00011f40: 6174 6554 696d 6520 6f62 6a65 6374 0d0a  ateTime object..
+00011f50: 2020 6474 5f63 203d 2064 6174 6574 696d    dt_c = datetim
+00011f60: 652e 6461 7465 7469 6d65 2e66 726f 6d74  e.datetime.fromt
+00011f70: 696d 6573 7461 6d70 2863 5f74 696d 6529  imestamp(c_time)
+00011f80: 0d0a 2020 636f 203d 2073 7472 2864 745f  ..  co = str(dt_
+00011f90: 6329 205b 303a 3139 5d0d 0a20 206d 6f20  c) [0:19]..  mo 
+00011fa0: 3d20 7374 7228 6474 5f6d 2920 5b30 3a31  = str(dt_m) [0:1
+00011fb0: 395d 0d0a 0d0a 2020 7020 3d20 4d79 5061  9]....  p = MyPa
+00011fc0: 7273 6572 2866 696c 656e 616d 6529 0d0a  rser(filename)..
+00011fd0: 2020 7468 6574 6578 743d 275c 6e27 2e6a    thetext='\n'.j
+00011fe0: 6f69 6e28 702e 7265 636f 7264 7329 0d0a  oin(p.records)..
+00011ff0: 2020 6172 7469 636c 655f 7465 7874 3d74    article_text=t
+00012000: 6865 7465 7874 2e65 6e63 6f64 6528 2775  hetext.encode('u
+00012010: 7466 3827 290d 0a20 2073 756d 6d61 7269  tf8')..  summari
+00012020: 7a65 643d 227b 5c22 6669 6c65 6e61 6d65  zed="{\"filename
+00012030: 5c22 3a5c 2222 202b 2066 696c 656e 616d  \":\"" + filenam
+00012040: 6520 2b20 225c 222c 5c22 6669 6c65 7369  e + "\",\"filesi
+00012050: 7a65 284d 4229 5c22 3a22 2b73 7472 2874  ze(MB)\":"+str(t
+00012060: 6865 7369 7a65 292b 222c 5c22 6669 6c65  hesize)+",\"file
+00012070: 6372 6561 7465 646f 6e5c 223a 5c22 2220  createdon\":\"" 
+00012080: 2b20 636f 202b 2022 5c22 2c5c 2266 696c  + co + "\",\"fil
+00012090: 656d 6f64 6966 6965 646f 6e5c 223a 5c22  emodifiedon\":\"
+000120a0: 2220 2b20 6d6f 202b 2022 5c22 2c5c 226b  " + mo + "\",\"k
+000120b0: 6579 776f 7264 735c 223a 2220 2b20 2073  eywords\":" +  s
+000120c0: 7461 7274 7375 6d6d 6172 7928 7468 6574  tartsummary(thet
+000120d0: 6578 742c 6676 616c 7565 2c6b 6579 636f  ext,fvalue,keyco
+000120e0: 756e 7429 0d0a 2023 2070 7269 6e74 2873  unt).. # print(s
+000120f0: 756d 6d61 7269 7a65 6429 0d0a 2020 7265  ummarized)..  re
+00012100: 7475 726e 2073 756d 6d61 7269 7a65 640d  turn summarized.
+00012110: 0a0d 0a0d 0a0d 0a0d 0a23 2323 2323 2323  .........#######
 00012120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00012130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00012140: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00012150: 2320 4465 7665 6c6f 7065 6420 6279 204f  # Developed by O
-00012160: 5449 4353 2041 6476 616e 6365 6420 416e  TICS Advanced An
-00012170: 616c 7974 6963 730d 0a23 2053 6562 6173  alytics..# Sebas
-00012180: 7469 616e 204d 6175 7269 6365 0d0a 0d0a  tian Maurice....
-00012190: 696d 706f 7274 2062 7334 2061 7320 6273  import bs4 as bs
-000121a0: 2020 0d0a 696d 706f 7274 2075 726c 6c69    ..import urlli
-000121b0: 622e 7265 7175 6573 7420 200d 0a69 6d70  b.request  ..imp
-000121c0: 6f72 7420 7265 0d0a 696d 706f 7274 206e  ort re..import n
-000121d0: 6c74 6b0d 0a66 726f 6d20 6e6c 746b 2e74  ltk..from nltk.t
-000121e0: 6f6b 656e 697a 6520 696d 706f 7274 2052  okenize import R
-000121f0: 6567 6578 7054 6f6b 656e 697a 6572 0d0a  egexpTokenizer..
-00012200: 696d 706f 7274 2068 6561 7071 0d0a 696d  import heapq..im
-00012210: 706f 7274 2073 7973 0d0a 696d 706f 7274  port sys..import
-00012220: 206f 730d 0a66 726f 6d20 7261 6b65 5f6e   os..from rake_n
-00012230: 6c74 6b20 696d 706f 7274 204d 6574 7269  ltk import Metri
-00012240: 632c 5261 6b65 0d0a 696d 706f 7274 206a  c,Rake..import j
-00012250: 736f 6e0d 0a69 6d70 6f72 7420 7061 6e64  son..import pand
-00012260: 6173 2061 7320 7064 0d0a 696d 706f 7274  as as pd..import
-00012270: 206e 6c74 6b2e 636f 7270 7573 0d0a 6672   nltk.corpus..fr
-00012280: 6f6d 206e 6c74 6b2e 636f 7270 7573 2069  om nltk.corpus i
-00012290: 6d70 6f72 7420 7374 6f70 776f 7264 730d  mport stopwords.
-000122a0: 0a66 726f 6d20 7465 7874 626c 6f62 2069  .from textblob i
-000122b0: 6d70 6f72 7420 5465 7874 426c 6f62 0d0a  mport TextBlob..
-000122c0: 6672 6f6d 2074 6578 7462 6c6f 6220 696d  from textblob im
-000122d0: 706f 7274 2057 6f72 640d 0a66 726f 6d20  port Word..from 
-000122e0: 736b 6c65 6172 6e2e 6665 6174 7572 655f  sklearn.feature_
-000122f0: 6578 7472 6163 7469 6f6e 2e74 6578 7420  extraction.text 
-00012300: 696d 706f 7274 2054 6669 6466 5472 616e  import TfidfTran
-00012310: 7366 6f72 6d65 722c 5466 6964 6656 6563  sformer,TfidfVec
-00012320: 746f 7269 7a65 720d 0a66 726f 6d20 736b  torizer..from sk
-00012330: 6c65 6172 6e2e 6665 6174 7572 655f 6578  learn.feature_ex
-00012340: 7472 6163 7469 6f6e 2e74 6578 7420 696d  traction.text im
-00012350: 706f 7274 2043 6f75 6e74 5665 6374 6f72  port CountVector
-00012360: 697a 6572 0d0a 236e 6c74 6b2e 646f 776e  izer..#nltk.down
-00012370: 6c6f 6164 2827 7075 6e6b 7427 290d 0a69  load('punkt')..i
-00012380: 6d70 6f72 7420 7761 726e 696e 6773 0d0a  mport warnings..
-00012390: 7761 726e 696e 6773 2e66 696c 7465 7277  warnings.filterw
-000123a0: 6172 6e69 6e67 7328 2269 676e 6f72 6522  arnings("ignore"
-000123b0: 290d 0a0d 0a23 6e6c 746b 2e64 6f77 6e6c  )....#nltk.downl
-000123c0: 6f61 6428 2773 746f 7077 6f72 6473 2729  oad('stopwords')
-000123d0: 0d0a 0d0a 6465 6620 6765 745f 7374 6f70  ....def get_stop
-000123e0: 5f77 6f72 6473 2829 3a0d 0a20 2020 2022  _words():..    "
-000123f0: 2222 6c6f 6164 2073 746f 7020 776f 7264  ""load stop word
-00012400: 7320 2222 220d 0a20 2020 2073 7470 7772  s """..    stpwr
-00012410: 6420 3d20 2073 746f 7077 6f72 6473 2e77  d =  stopwords.w
-00012420: 6f72 6473 2827 656e 676c 6973 6827 290d  ords('english').
-00012430: 0a20 2020 206e 6577 5f73 746f 7077 6f72  .    new_stopwor
-00012440: 6473 203d 205b 226e 6565 6422 2c20 2275  ds = ["need", "u
-00012450: 6e66 6f72 7475 6e61 7465 6c79 222c 2022  nfortunately", "
-00012460: 746f 222c 2022 6f6e 222c 2022 6461 696c  to", "on", "dail
-00012470: 7922 2c20 2274 616b 6522 2c0d 0a20 2020  y", "take",..   
-00012480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012490: 2020 2274 616b 656e 222c 2261 6464 7265    "taken","addre
-000124a0: 7373 696e 6722 2c22 736f 6f6e 6572 222c  ssing","sooner",
-000124b0: 2272 6174 6865 7222 2c22 6d61 6b65 222c  "rather","make",
-000124c0: 226c 6174 6572 222c 0d0a 2020 2020 2020  "later",..      
-000124d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000124e0: 736f 6f6e 6572 222c 2273 756d 6d61 7279  sooner","summary
-000124f0: 222c 226c 6561 7665 222c 2265 7665 7279  ","leave","every
-00012500: 222c 2269 6e74 656e 6422 2c22 6669 6e61  ","intend","fina
-00012510: 6c6c 7922 2c0d 0a20 2020 2020 2020 2020  lly",..         
-00012520: 2020 2020 2020 2020 2020 2020 2265 6e74              "ent
-00012530: 6972 656c 7922 2c22 6576 656e 222c 2265  irely","even","e
-00012540: 6e73 7572 6522 2c22 616c 736f 222c 2261  nsure","also","a
-00012550: 6666 6563 7422 2c22 6166 6665 6374 696e  ffect","affectin
-00012560: 6722 2c0d 0a20 2020 2020 2020 2020 2020  g",..           
-00012570: 2020 2020 2020 2020 2020 2262 7573 696e            "busin
-00012580: 6573 7322 2c22 636c 6173 7322 2c22 636f  ess","class","co
-00012590: 6d70 616e 7922 2c22 616c 736f 222c 2279  mpany","also","y
-000125a0: 6561 7222 2c22 7573 696e 6722 2c0d 0a20  ear","using",.. 
-000125b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000125c0: 2020 2020 2269 7373 7565 6422 2c22 7370      "issued","sp
-000125d0: 6563 6966 6963 222c 2273 7065 6369 6669  ecific","specifi
-000125e0: 6361 6c6c 7922 2c22 7265 6173 6f6e 222c  cally","reason",
-000125f0: 2272 6561 6c22 2c0d 0a20 2020 2020 2020  "real",..       
-00012600: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-00012610: 726f 6a65 6374 222c 2270 6172 7469 6375  roject","particu
-00012620: 6c61 726c 7922 2c22 7061 7274 6963 756c  larly","particul
-00012630: 6172 222c 226d 6174 7465 7222 2c22 6d61  ar","matter","ma
-00012640: 696e 222c 0d0a 2020 2020 2020 2020 2020  in",..          
-00012650: 2020 2020 2020 2020 2020 2022 6c69 7374             "list
-00012660: 6564 222c 2263 6f6d 6522 2c22 636f 6d70  ed","come","comp
-00012670: 616e 7922 2c22 636f 756c 6422 2c22 636f  any","could","co
-00012680: 7079 222c 2266 6972 7374 222c 2265 7861  py","first","exa
-00012690: 6d70 6c65 222c 0d0a 2020 2020 2020 2020  mple",..        
-000126a0: 2020 2020 2020 2020 2020 2020 2022 7265               "re
-000126b0: 616c 222c 2266 6163 746f 7222 2c22 7765  al","factor","we
-000126c0: 6c6c 222c 2273 6f72 7422 2c22 736f 6369  ll","sort","soci
-000126d0: 616c 222c 2273 6f63 6961 6c6c 7922 2c22  al","socially","
-000126e0: 7468 726f 7567 686f 7574 222c 0d0a 2020  throughout",..  
-000126f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012700: 2020 2022 7265 6173 6f6e 222c 2261 7661     "reason","ava
-00012710: 696c 6162 6c65 222c 2261 7070 726f 6163  ilable","approac
-00012720: 6822 2c22 7661 7279 222c 2274 7970 6522  h","vary","type"
-00012730: 2c22 6163 726f 7373 222c 0d0a 2020 2020  ,"across",..    
-00012740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012750: 2022 6176 6169 6c61 626c 6522 2c22 6571   "available","eq
-00012760: 7561 6c6c 7922 2c22 6d61 6e61 6765 7222  ually","manager"
-00012770: 2c22 6465 6669 6e69 7469 6f6e 222c 2273  ,"definition","s
-00012780: 686f 7274 222c 2272 6573 706f 6e73 6522  hort","response"
-00012790: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000127a0: 2020 2020 2020 2020 2270 616e 656c 222c          "panel",
-000127b0: 2272 6571 7569 7265 7322 2c22 7265 7175  "requires","requ
-000127c0: 6972 696e 6722 2c22 7261 6973 6522 2c22  iring","raise","
-000127d0: 7368 6f77 222c 2264 6f6e 6522 2c22 6164  show","done","ad
-000127e0: 6571 7561 7465 6c79 222c 0d0a 2020 2020  equately",..    
-000127f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012800: 2022 6765 6e65 7269 6322 2c22 6765 6e65   "generic","gene
-00012810: 7261 6c22 2c22 636f 7572 7365 222c 2261  ral","course","a
-00012820: 7070 6c69 6564 222c 2272 656c 6174 6564  pplied","related
-00012830: 225d 0d0a 2020 2020 7374 7077 7264 2e65  "]..    stpwrd.e
-00012840: 7874 656e 6428 6e65 775f 7374 6f70 776f  xtend(new_stopwo
-00012850: 7264 7329 0d0a 2020 2020 7265 7475 726e  rds)..    return
-00012860: 2073 7470 7772 640d 0a20 200d 0a0d 0a20   stpwrd..  .... 
-00012870: 2020 200d 0a23 2320 2020 2077 6974 6820     ..##    with 
-00012880: 6f70 656e 2827 7374 6f70 776f 7264 732e  open('stopwords.
-00012890: 7478 7427 2c20 2772 272c 2065 6e63 6f64  txt', 'r', encod
-000128a0: 696e 673d 2275 7466 2d38 2229 2061 7320  ing="utf-8") as 
-000128b0: 663a 0d0a 2323 2020 2020 2020 2020 7374  f:..##        st
-000128c0: 6f70 776f 7264 7320 3d20 662e 7265 6164  opwords = f.read
-000128d0: 6c69 6e65 7328 290d 0a23 2320 2020 2020  lines()..##     
-000128e0: 2020 2073 746f 705f 7365 7420 3d20 7365     stop_set = se
-000128f0: 7428 6d2e 7374 7269 7028 2920 666f 7220  t(m.strip() for 
-00012900: 6d20 696e 2073 746f 7077 6f72 6473 290d  m in stopwords).
-00012910: 0a23 2320 2020 2020 2023 2020 7072 696e  .##      #  prin
-00012920: 7428 6672 6f7a 656e 7365 7428 7374 6f70  t(frozenset(stop
-00012930: 5f73 6574 2929 0d0a 2323 2020 2020 2020  _set))..##      
-00012940: 2020 7265 7475 726e 2066 726f 7a65 6e73    return frozens
-00012950: 6574 2873 746f 705f 7365 7429 0d0a 0d0a  et(stop_set)....
-00012960: 6465 6620 7363 7261 7065 7765 6228 7468  def scrapeweb(th
-00012970: 6575 726c 293a 0d0a 2020 2020 7363 7261  eurl):..    scra
-00012980: 7065 645f 6461 7461 203d 2075 726c 6c69  ped_data = urlli
-00012990: 622e 7265 7175 6573 742e 7572 6c6f 7065  b.request.urlope
-000129a0: 6e28 7468 6575 726c 2920 200d 0a20 2020  n(theurl)  ..   
-000129b0: 2061 7274 6963 6c65 203d 2073 6372 6170   article = scrap
-000129c0: 6564 5f64 6174 612e 7265 6164 2829 0d0a  ed_data.read()..
-000129d0: 0d0a 2020 2020 7061 7273 6564 5f61 7274  ..    parsed_art
-000129e0: 6963 6c65 203d 2062 732e 4265 6175 7469  icle = bs.Beauti
-000129f0: 6675 6c53 6f75 7028 6172 7469 636c 652c  fulSoup(article,
-00012a00: 276c 786d 6c27 290d 0a0d 0a20 2020 2070  'lxml')....    p
-00012a10: 6172 6167 7261 7068 7320 3d20 7061 7273  aragraphs = pars
-00012a20: 6564 5f61 7274 6963 6c65 2e66 696e 645f  ed_article.find_
-00012a30: 616c 6c28 2770 2729 0d0a 0d0a 2020 2020  all('p')....    
-00012a40: 6172 7469 636c 655f 7465 7874 203d 2022  article_text = "
-00012a50: 220d 0a0d 0a20 2020 2066 6f72 2070 2069  "....    for p i
-00012a60: 6e20 7061 7261 6772 6170 6873 3a20 200d  n paragraphs:  .
-00012a70: 0a20 2020 2020 2020 2061 7274 6963 6c65  .        article
-00012a80: 5f74 6578 7420 2b3d 2070 2e74 6578 740d  _text += p.text.
-00012a90: 0a20 2020 2072 6574 7572 6e20 6172 7469  .    return arti
-00012aa0: 636c 655f 7465 7874 200d 0a0d 0a64 6566  cle_text ....def
-00012ab0: 2063 6f6e 7665 7274 746f 6c6f 7765 7263   converttolowerc
-00012ac0: 6173 6528 6466 2c63 6f6c 293a 0d0a 2020  ase(df,col):..  
-00012ad0: 2020 2020 6466 5b63 6f6c 5d20 3d20 6466      df[col] = df
-00012ae0: 5b63 6f6c 5d2e 6170 706c 7928 6c61 6d62  [col].apply(lamb
-00012af0: 6461 2078 3a20 2220 222e 6a6f 696e 2878  da x: " ".join(x
-00012b00: 2e6c 6f77 6572 2829 2066 6f72 2078 2069  .lower() for x i
-00012b10: 6e20 782e 7370 6c69 7428 2929 290d 0a20  n x.split())).. 
-00012b20: 2020 2020 2072 6574 7572 6e20 6466 0d0a       return df..
-00012b30: 2020 2020 0d0a 6465 6620 7265 6d6f 7665      ..def remove
-00012b40: 7075 6e63 7475 6174 696f 6e28 6466 2c63  punctuation(df,c
-00012b50: 6f6c 293a 0d0a 2020 2020 2020 6466 5b63  ol):..      df[c
-00012b60: 6f6c 5d20 3d20 6466 5b63 6f6c 5d2e 7374  ol] = df[col].st
-00012b70: 722e 7265 706c 6163 6528 275b 5e5c 775c  r.replace('[^\w\
-00012b80: 735d 272c 2727 290d 0a20 2020 2020 2072  s]','')..      r
-00012b90: 6574 7572 6e20 6466 0d0a 0d0a 6465 6620  eturn df....def 
-00012ba0: 7265 6d6f 7665 7374 6f70 776f 7264 7328  removestopwords(
-00012bb0: 6466 2c63 6f6c 293a 0d0a 2020 2020 2020  df,col):..      
-00012bc0: 7374 6f70 203d 2073 746f 7077 6f72 6473  stop = stopwords
-00012bd0: 2e77 6f72 6473 2827 656e 676c 6973 6827  .words('english'
-00012be0: 290d 0a20 2020 2020 2064 665b 636f 6c5d  )..      df[col]
-00012bf0: 203d 2064 665b 636f 6c5d 2e61 7070 6c79   = df[col].apply
-00012c00: 286c 616d 6264 6120 783a 2022 2022 2e6a  (lambda x: " ".j
-00012c10: 6f69 6e28 7820 666f 7220 7820 696e 2078  oin(x for x in x
-00012c20: 2e73 706c 6974 2829 2069 6620 7820 6e6f  .split() if x no
-00012c30: 7420 696e 2073 746f 7029 290d 0a20 2020  t in stop))..   
-00012c40: 2020 2072 6574 7572 6e20 6466 0d0a 0d0a     return df....
-00012c50: 6465 6620 7265 6d6f 7665 636f 6d6d 6f6e  def removecommon
-00012c60: 776f 7264 7328 6466 2c63 6f6c 293a 0d0a  words(df,col):..
-00012c70: 2020 2020 2020 6672 6571 203d 2070 642e        freq = pd.
-00012c80: 5365 7269 6573 2827 2027 2e6a 6f69 6e28  Series(' '.join(
-00012c90: 6466 5b63 6f6c 5d29 2e73 706c 6974 2829  df[col]).split()
-00012ca0: 292e 7661 6c75 655f 636f 756e 7473 2829  ).value_counts()
-00012cb0: 5b3a 3130 5d0d 0a20 2020 2020 2066 7265  [:10]..      fre
-00012cc0: 7120 3d20 6c69 7374 2866 7265 712e 696e  q = list(freq.in
-00012cd0: 6465 7829 0d0a 2020 2020 2020 6466 5b63  dex)..      df[c
-00012ce0: 6f6c 5d20 3d20 6466 5b63 6f6c 5d2e 6170  ol] = df[col].ap
-00012cf0: 706c 7928 6c61 6d62 6461 2078 3a20 2220  ply(lambda x: " 
-00012d00: 222e 6a6f 696e 2878 2066 6f72 2078 2069  ".join(x for x i
-00012d10: 6e20 782e 7370 6c69 7428 2920 6966 2078  n x.split() if x
-00012d20: 206e 6f74 2069 6e20 6672 6571 2929 0d0a   not in freq))..
-00012d30: 2020 2020 2020 7265 7475 726e 2064 660d        return df.
-00012d40: 0a0d 0a64 6566 2072 656d 6f76 6572 6172  ...def removerar
-00012d50: 6577 6f72 6473 2864 662c 636f 6c29 3a0d  ewords(df,col):.
-00012d60: 0a20 2020 2020 2066 7265 7120 3d20 7064  .      freq = pd
-00012d70: 2e53 6572 6965 7328 2720 272e 6a6f 696e  .Series(' '.join
-00012d80: 2864 665b 636f 6c5d 292e 7370 6c69 7428  (df[col]).split(
-00012d90: 2929 2e76 616c 7565 5f63 6f75 6e74 7328  )).value_counts(
-00012da0: 295b 2d31 303a 5d0d 0a20 2020 2020 2066  )[-10:]..      f
-00012db0: 7265 7120 3d20 6c69 7374 2866 7265 712e  req = list(freq.
-00012dc0: 696e 6465 7829 0d0a 2020 2020 2020 6466  index)..      df
-00012dd0: 5b63 6f6c 5d20 3d20 6466 5b63 6f6c 5d2e  [col] = df[col].
-00012de0: 6170 706c 7928 6c61 6d62 6461 2078 3a20  apply(lambda x: 
-00012df0: 2220 222e 6a6f 696e 2878 2066 6f72 2078  " ".join(x for x
-00012e00: 2069 6e20 782e 7370 6c69 7428 2920 6966   in x.split() if
-00012e10: 2078 206e 6f74 2069 6e20 6672 6571 2929   x not in freq))
-00012e20: 0d0a 2020 2020 2020 7265 7475 726e 2064  ..      return d
-00012e30: 660d 0a0d 0a64 6566 2063 6f72 7265 6374  f....def correct
-00012e40: 7370 656c 6c69 6e67 2864 662c 636f 6c29  spelling(df,col)
-00012e50: 3a0d 0a20 2020 2020 2064 665b 636f 6c5d  :..      df[col]
-00012e60: 5b3a 355d 2e61 7070 6c79 286c 616d 6264  [:5].apply(lambd
-00012e70: 6120 783a 2073 7472 2854 6578 7442 6c6f  a x: str(TextBlo
-00012e80: 6228 7829 2e63 6f72 7265 6374 2829 2929  b(x).correct()))
-00012e90: 0d0a 2020 2020 2020 7265 7475 726e 2064  ..      return d
-00012ea0: 660d 0a0d 0a64 6566 206c 656d 6d61 7469  f....def lemmati
-00012eb0: 7a61 7469 6f6e 2864 662c 636f 6c29 3a0d  zation(df,col):.
-00012ec0: 0a20 2020 2020 2064 665b 636f 6c5d 203d  .      df[col] =
-00012ed0: 2064 665b 636f 6c5d 2e61 7070 6c79 286c   df[col].apply(l
-00012ee0: 616d 6264 6120 783a 2022 2022 2e6a 6f69  ambda x: " ".joi
-00012ef0: 6e28 5b57 6f72 6428 776f 7264 292e 6c65  n([Word(word).le
-00012f00: 6d6d 6174 697a 6528 2920 666f 7220 776f  mmatize() for wo
-00012f10: 7264 2069 6e20 782e 7370 6c69 7428 295d  rd in x.split()]
-00012f20: 2929 0d0a 2020 2020 2020 7265 7475 726e  ))..      return
-00012f30: 2064 660d 0a0d 0a64 6566 2074 7261 696e   df....def train
-00012f40: 7665 6374 2863 762c 7462 6f77 2c64 662c  vect(cv,tbow,df,
-00012f50: 636f 6c2c 6d61 786b 6579 776f 7264 7329  col,maxkeywords)
-00012f60: 3a0d 0a20 2020 2020 2074 6578 743d 6466  :..      text=df
-00012f70: 5b63 6f6c 5d2e 746f 6c69 7374 2829 0d0a  [col].tolist()..
-00012f80: 2020 2020 2020 7466 6964 6620 3d20 5466        tfidf = Tf
-00012f90: 6964 6654 7261 6e73 666f 726d 6572 2873  idfTransformer(s
-00012fa0: 6d6f 6f74 685f 6964 663d 5472 7565 2c75  mooth_idf=True,u
-00012fb0: 7365 5f69 6466 3d54 7275 6529 0d0a 2020  se_idf=True)..  
-00012fc0: 2020 2020 7466 6964 662e 6669 7428 7462      tfidf.fit(tb
-00012fd0: 6f77 290d 0a20 2020 2020 2074 665f 6964  ow)..      tf_id
-00012fe0: 665f 7665 6374 6f72 3d74 6669 6466 2e74  f_vector=tfidf.t
-00012ff0: 7261 6e73 666f 726d 2863 762e 7472 616e  ransform(cv.tran
-00013000: 7366 6f72 6d28 7465 7874 2929 0d0a 2020  sform(text))..  
-00013010: 2020 2020 736f 7274 6564 6974 656d 733d      sorteditems=
-00013020: 736f 7274 5f63 6f6f 2874 665f 6964 665f  sort_coo(tf_idf_
-00013030: 7665 6374 6f72 2e74 6f63 6f6f 2829 290d  vector.tocoo()).
-00013040: 0a20 2020 2020 2066 6561 7475 7265 6e61  .      featurena
-00013050: 6d65 733d 6376 2e67 6574 5f66 6561 7475  mes=cv.get_featu
-00013060: 7265 5f6e 616d 6573 5f6f 7574 2829 0d0a  re_names_out()..
-00013070: 2020 2020 2020 6b65 7977 6f72 6473 3d65        keywords=e
-00013080: 7874 7261 6374 5f74 6f70 6e5f 6672 6f6d  xtract_topn_from
-00013090: 5f76 6563 746f 7228 6665 6174 7572 656e  _vector(featuren
-000130a0: 616d 6573 2c73 6f72 7465 6469 7465 6d73  ames,sorteditems
-000130b0: 2c6d 6178 6b65 7977 6f72 6473 290d 0a20  ,maxkeywords).. 
-000130c0: 2020 2020 206b 6579 776f 7264 733d 6a73       keywords=js
-000130d0: 6f6e 2e64 756d 7073 286b 6579 776f 7264  on.dumps(keyword
-000130e0: 7329 0d0a 2020 2020 2023 2070 7269 6e74  s)..     # print
-000130f0: 286b 6579 776f 7264 7329 0d0a 2020 2020  (keywords)..    
-00013100: 2020 7265 7475 726e 206b 6579 776f 7264    return keyword
-00013110: 730d 0a0d 0a64 6566 2074 7261 696e 626f  s....def trainbo
-00013120: 7728 6466 2c63 6f6c 293a 0d0a 2020 2020  w(df,col):..    
-00013130: 2020 6d79 6c69 7374 3d64 665b 636f 6c5d    mylist=df[col]
-00013140: 2e74 6f6c 6973 7428 290d 0a20 2020 2020  .tolist()..     
-00013150: 2073 746f 7077 6f72 6473 3d67 6574 5f73   stopwords=get_s
-00013160: 746f 705f 776f 7264 7328 290d 0a20 2020  top_words()..   
-00013170: 2020 2063 7620 3d20 436f 756e 7456 6563     cv = CountVec
-00013180: 746f 7269 7a65 7228 7374 6f70 5f77 6f72  torizer(stop_wor
-00013190: 6473 3d73 746f 7077 6f72 6473 290d 0a20  ds=stopwords).. 
-000131a0: 2020 2020 2074 7261 696e 5f62 6f77 203d       train_bow =
-000131b0: 2063 762e 6669 745f 7472 616e 7366 6f72   cv.fit_transfor
-000131c0: 6d28 6d79 6c69 7374 290d 0a20 2020 2020  m(mylist)..     
-000131d0: 2023 7072 696e 7428 6c69 7374 2863 762e   #print(list(cv.
-000131e0: 766f 6361 6275 6c61 7279 5f2e 6b65 7973  vocabulary_.keys
-000131f0: 2829 2929 0d0a 2020 2020 2020 7265 7475  ()))..      retu
-00013200: 726e 2063 762c 7472 6169 6e5f 626f 770d  rn cv,train_bow.
-00013210: 0a0d 0a20 0d0a 6465 6620 736f 7274 5f63  ... ..def sort_c
-00013220: 6f6f 2863 6f6f 5f6d 6174 7269 7829 3a0d  oo(coo_matrix):.
-00013230: 0a20 2020 2074 7570 6c65 7320 3d20 7a69  .    tuples = zi
-00013240: 7028 636f 6f5f 6d61 7472 6978 2e63 6f6c  p(coo_matrix.col
-00013250: 2c20 636f 6f5f 6d61 7472 6978 2e64 6174  , coo_matrix.dat
-00013260: 6129 0d0a 2020 2020 7265 7475 726e 2073  a)..    return s
-00013270: 6f72 7465 6428 7475 706c 6573 2c20 6b65  orted(tuples, ke
-00013280: 793d 6c61 6d62 6461 2078 3a20 2878 5b31  y=lambda x: (x[1
-00013290: 5d2c 2078 5b30 5d29 2c20 7265 7665 7273  ], x[0]), revers
-000132a0: 653d 5472 7565 290d 0a0d 0a64 6566 2065  e=True)....def e
-000132b0: 7874 7261 6374 5f74 6f70 6e5f 6672 6f6d  xtract_topn_from
-000132c0: 5f76 6563 746f 7228 6665 6174 7572 655f  _vector(feature_
-000132d0: 6e61 6d65 732c 2073 6f72 7465 645f 6974  names, sorted_it
-000132e0: 656d 732c 2074 6f70 6e3d 3130 293a 0d0a  ems, topn=10):..
-000132f0: 2020 2020 2222 2267 6574 2074 6865 2066      """get the f
-00013300: 6561 7475 7265 206e 616d 6573 2061 6e64  eature names and
-00013310: 2074 662d 6964 6620 7363 6f72 6520 6f66   tf-idf score of
-00013320: 2074 6f70 206e 2069 7465 6d73 2222 220d   top n items""".
-00013330: 0a20 2020 200d 0a20 2020 2023 7573 6520  .    ..    #use 
-00013340: 6f6e 6c79 2074 6f70 6e20 6974 656d 7320  only topn items 
-00013350: 6672 6f6d 2076 6563 746f 720d 0a20 2020  from vector..   
-00013360: 2073 6f72 7465 645f 6974 656d 7320 3d20   sorted_items = 
-00013370: 736f 7274 6564 5f69 7465 6d73 5b3a 746f  sorted_items[:to
-00013380: 706e 5d0d 0a0d 0a20 2020 2073 636f 7265  pn]....    score
-00013390: 5f76 616c 7320 3d20 5b5d 0d0a 2020 2020  _vals = []..    
-000133a0: 6665 6174 7572 655f 7661 6c73 203d 205b  feature_vals = [
-000133b0: 5d0d 0a0d 0a20 2020 2066 6f72 2069 6478  ]....    for idx
-000133c0: 2c20 7363 6f72 6520 696e 2073 6f72 7465  , score in sorte
-000133d0: 645f 6974 656d 733a 2020 2020 2020 2020  d_items:        
-000133e0: 0d0a 2020 2020 2020 2020 2020 666e 616d  ..          fnam
-000133f0: 6520 3d20 6665 6174 7572 655f 6e61 6d65  e = feature_name
-00013400: 735b 6964 785d 0d0a 2020 2020 2020 2020  s[idx]..        
-00013410: 2020 6966 206c 656e 2866 6e61 6d65 293e    if len(fname)>
-00013420: 333a 0d0a 2020 2020 2020 2020 236b 6565  3:..        #kee
-00013430: 7020 7472 6163 6b20 6f66 2066 6561 7475  p track of featu
-00013440: 7265 206e 616d 6520 616e 6420 6974 7320  re name and its 
-00013450: 636f 7272 6573 706f 6e64 696e 6720 7363  corresponding sc
-00013460: 6f72 650d 0a20 2020 2020 2020 2020 2020  ore..           
-00013470: 2073 636f 7265 5f76 616c 732e 6170 7065   score_vals.appe
-00013480: 6e64 2872 6f75 6e64 2873 636f 7265 2c20  nd(round(score, 
-00013490: 3329 290d 0a20 2020 2020 2020 2020 2020  3))..           
-000134a0: 2066 6561 7475 7265 5f76 616c 732e 6170   feature_vals.ap
-000134b0: 7065 6e64 2866 6561 7475 7265 5f6e 616d  pend(feature_nam
-000134c0: 6573 5b69 6478 5d29 0d0a 0d0a 2020 2020  es[idx])....    
-000134d0: 2363 7265 6174 6520 6120 7475 706c 6573  #create a tuples
-000134e0: 206f 6620 6665 6174 7572 652c 7363 6f72   of feature,scor
-000134f0: 650d 0a20 2020 2023 7265 7375 6c74 7320  e..    #results 
-00013500: 3d20 7a69 7028 6665 6174 7572 655f 7661  = zip(feature_va
-00013510: 6c73 2c73 636f 7265 5f76 616c 7329 0d0a  ls,score_vals)..
-00013520: 2020 2020 7265 7375 6c74 733d 207b 7d0d      results= {}.
-00013530: 0a20 2020 2066 6f72 2069 6478 2069 6e20  .    for idx in 
-00013540: 7261 6e67 6528 6c65 6e28 6665 6174 7572  range(len(featur
-00013550: 655f 7661 6c73 2929 3a0d 0a20 2020 2020  e_vals)):..     
-00013560: 2020 2072 6573 756c 7473 5b66 6561 7475     results[featu
-00013570: 7265 5f76 616c 735b 6964 785d 5d3d 7363  re_vals[idx]]=sc
-00013580: 6f72 655f 7661 6c73 5b69 6478 5d0d 0a20  ore_vals[idx].. 
-00013590: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
-000135a0: 7265 7375 6c74 730d 0a0d 0a64 6566 2067  results....def g
-000135b0: 6574 6b65 7977 6f72 6473 286d 7974 6578  etkeywords(mytex
-000135c0: 742c 6d61 786b 6579 776f 7264 7329 3a0d  t,maxkeywords):.
-000135d0: 0a20 2020 2072 3d52 616b 6528 6d61 785f  .    r=Rake(max_
-000135e0: 6c65 6e67 7468 3d31 3029 0d0a 2020 2020  length=10)..    
-000135f0: 7220 3d20 5261 6b65 2872 616e 6b69 6e67  r = Rake(ranking
-00013600: 5f6d 6574 7269 633d 4d65 7472 6963 2e44  _metric=Metric.D
-00013610: 4547 5245 455f 544f 5f46 5245 5155 454e  EGREE_TO_FREQUEN
-00013620: 4359 5f52 4154 494f 290d 0a20 2020 2023  CY_RATIO)..    #
-00013630: 7220 3d20 5261 6b65 2872 616e 6b69 6e67  r = Rake(ranking
-00013640: 5f6d 6574 7269 633d 4d65 7472 6963 2e57  _metric=Metric.W
-00013650: 4f52 445f 4445 4752 4545 290d 0a20 2020  ORD_DEGREE)..   
-00013660: 2023 7220 3d20 5261 6b65 2872 616e 6b69   #r = Rake(ranki
-00013670: 6e67 5f6d 6574 7269 633d 4d65 7472 6963  ng_metric=Metric
-00013680: 2e57 4f52 445f 4652 4551 5545 4e43 5929  .WORD_FREQUENCY)
-00013690: 0d0a 2020 2020 643d 7b27 696e 7075 7427  ..    d={'input'
-000136a0: 3a5b 6d79 7465 7874 5d7d 0d0a 2020 2020  :[mytext]}..    
-000136b0: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-000136c0: 6528 6429 0d0a 2020 2020 6466 3d63 6f6e  e(d)..    df=con
-000136d0: 7665 7274 746f 6c6f 7765 7263 6173 6528  verttolowercase(
-000136e0: 6466 2c27 696e 7075 7427 290d 0a20 2020  df,'input')..   
-000136f0: 2064 663d 7265 6d6f 7665 7075 6e63 7475   df=removepunctu
-00013700: 6174 696f 6e28 6466 2c27 696e 7075 7427  ation(df,'input'
-00013710: 290d 0a20 2020 2064 663d 7265 6d6f 7665  )..    df=remove
-00013720: 7374 6f70 776f 7264 7328 6466 2c27 696e  stopwords(df,'in
-00013730: 7075 7427 290d 0a20 2020 2064 663d 7265  put')..    df=re
-00013740: 6d6f 7665 636f 6d6d 6f6e 776f 7264 7328  movecommonwords(
-00013750: 6466 2c27 696e 7075 7427 290d 0a20 2020  df,'input')..   
-00013760: 2064 663d 7265 6d6f 7665 7261 7265 776f   df=removerarewo
-00013770: 7264 7328 6466 2c27 696e 7075 7427 290d  rds(df,'input').
-00013780: 0a20 2020 2064 663d 636f 7272 6563 7473  .    df=corrects
-00013790: 7065 6c6c 696e 6728 6466 2c27 696e 7075  pelling(df,'inpu
-000137a0: 7427 290d 0a20 2020 2064 663d 6c65 6d6d  t')..    df=lemm
-000137b0: 6174 697a 6174 696f 6e28 6466 2c27 696e  atization(df,'in
-000137c0: 7075 7427 290d 0a20 2020 206d 7974 6578  put')..    mytex
-000137d0: 743d 6466 5b27 696e 7075 7427 5d5b 305d  t=df['input'][0]
-000137e0: 0d0a 2020 2020 6376 2c74 773d 7472 6169  ..    cv,tw=trai
-000137f0: 6e62 6f77 2864 662c 2769 6e70 7574 2729  nbow(df,'input')
-00013800: 0d0a 2020 2020 6b65 7977 6f72 6473 3d74  ..    keywords=t
-00013810: 7261 696e 7665 6374 2863 762c 7477 2c64  rainvect(cv,tw,d
-00013820: 662c 2769 6e70 7574 272c 6d61 786b 6579  f,'input',maxkey
-00013830: 776f 7264 7329 0d0a 0d0a 2020 2020 0d0a  words)....    ..
-00013840: 2020 2020 6b65 7962 7566 203d 2022 220d      keybuf = "".
-00013850: 0a20 2020 206b 6a73 6f6e 203d 206a 736f  .    kjson = jso
-00013860: 6e2e 6c6f 6164 7328 6b65 7977 6f72 6473  n.loads(keywords
-00013870: 290d 0a20 2020 2066 6f72 206b 6579 2c20  )..    for key, 
-00013880: 7661 6c75 6520 696e 206b 6a73 6f6e 2e69  value in kjson.i
-00013890: 7465 6d73 2829 3a0d 0a20 2020 2020 2020  tems():..       
-000138a0: 206b 6579 6275 6620 3d20 6b65 7962 7566   keybuf = keybuf
-000138b0: 202b 206b 6579 202b 222c 2220 2b20 7374   + key +"," + st
-000138c0: 7228 7661 6c75 6529 202b 2022 3a22 0d0a  r(value) + ":"..
-000138d0: 2020 2020 6b65 7962 7566 203d 206b 6579      keybuf = key
-000138e0: 6275 665b 3a2d 315d 0d0a 0d0a 2020 2020  buf[:-1]....    
-000138f0: 7265 7475 726e 206b 6579 6275 660d 0a20  return keybuf.. 
-00013900: 0d0a 6465 6620 646f 7375 6d6d 6172 7928  ..def dosummary(
-00013910: 6172 7469 636c 655f 7465 7874 2c69 293a  article_text,i):
-00013920: 0d0a 0d0a 0d0a 2020 2020 6172 7469 636c  ......    articl
-00013930: 655f 7465 7874 203d 2072 652e 7375 6228  e_text = re.sub(
-00013940: 7227 5c5b 5b30 2d39 5d2a 5c5d 272c 2027  r'\[[0-9]*\]', '
-00013950: 2027 2c20 6172 7469 636c 655f 7465 7874   ', article_text
-00013960: 2920 200d 0a20 2020 2061 7274 6963 6c65  )  ..    article
-00013970: 5f74 6578 7420 3d20 7265 2e73 7562 2872  _text = re.sub(r
-00013980: 275c 732b 272c 2027 2027 2c20 6172 7469  '\s+', ' ', arti
-00013990: 636c 655f 7465 7874 290d 0a0d 0a20 2020  cle_text)....   
-000139a0: 2023 2052 656d 6f76 696e 6720 7370 6563   # Removing spec
-000139b0: 6961 6c20 6368 6172 6163 7465 7273 2061  ial characters a
-000139c0: 6e64 2064 6967 6974 730d 0a20 2020 2066  nd digits..    f
-000139d0: 6f72 6d61 7474 6564 5f61 7274 6963 6c65  ormatted_article
-000139e0: 5f74 6578 7420 3d20 7265 2e73 7562 2827  _text = re.sub('
-000139f0: 5b5e 612d 7a41 2d5a 5d27 2c20 2720 272c  [^a-zA-Z]', ' ',
-00013a00: 2061 7274 6963 6c65 5f74 6578 7420 2920   article_text ) 
-00013a10: 200d 0a20 2020 2066 6f72 6d61 7474 6564   ..    formatted
-00013a20: 5f61 7274 6963 6c65 5f74 6578 7420 3d20  _article_text = 
-00013a30: 7265 2e73 7562 2872 275c 732b 272c 2027  re.sub(r'\s+', '
-00013a40: 2027 2c20 666f 726d 6174 7465 645f 6172   ', formatted_ar
-00013a50: 7469 636c 655f 7465 7874 2920 200d 0a0d  ticle_text)  ...
-00013a60: 0a20 2020 2073 656e 7465 6e63 655f 6c69  .    sentence_li
-00013a70: 7374 203d 206e 6c74 6b2e 7365 6e74 5f74  st = nltk.sent_t
-00013a80: 6f6b 656e 697a 6528 6172 7469 636c 655f  okenize(article_
-00013a90: 7465 7874 2920 200d 0a20 2020 2023 7072  text)  ..    #pr
-00013aa0: 696e 7428 7365 6e74 656e 6365 5f6c 6973  int(sentence_lis
-00013ab0: 7429 0d0a 0d0a 2020 2020 7374 6f70 776f  t)....    stopwo
-00013ac0: 7264 7320 3d20 6e6c 746b 2e63 6f72 7075  rds = nltk.corpu
-00013ad0: 732e 7374 6f70 776f 7264 732e 776f 7264  s.stopwords.word
-00013ae0: 7328 2765 6e67 6c69 7368 2729 0d0a 0d0a  s('english')....
-00013af0: 2020 2020 776f 7264 5f66 7265 7175 656e      word_frequen
-00013b00: 6369 6573 203d 207b 7d20 200d 0a20 2020  cies = {}  ..   
-00013b10: 2066 6f72 2077 6f72 6420 696e 206e 6c74   for word in nlt
-00013b20: 6b2e 776f 7264 5f74 6f6b 656e 697a 6528  k.word_tokenize(
-00013b30: 666f 726d 6174 7465 645f 6172 7469 636c  formatted_articl
-00013b40: 655f 7465 7874 293a 2020 0d0a 2020 2020  e_text):  ..    
-00013b50: 2020 2020 6966 2077 6f72 6420 6e6f 7420      if word not 
-00013b60: 696e 2073 746f 7077 6f72 6473 3a0d 0a20  in stopwords:.. 
-00013b70: 2020 2020 2020 2020 2020 2069 6620 776f             if wo
-00013b80: 7264 206e 6f74 2069 6e20 776f 7264 5f66  rd not in word_f
-00013b90: 7265 7175 656e 6369 6573 2e6b 6579 7328  requencies.keys(
-00013ba0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00013bb0: 2020 2020 776f 7264 5f66 7265 7175 656e      word_frequen
-00013bc0: 6369 6573 5b77 6f72 645d 203d 2031 0d0a  cies[word] = 1..
-00013bd0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00013be0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00013bf0: 2020 2077 6f72 645f 6672 6571 7565 6e63     word_frequenc
-00013c00: 6965 735b 776f 7264 5d20 2b3d 2031 0d0a  ies[word] += 1..
-00013c10: 0d0a 2020 2020 6d61 7869 6d75 6d5f 6672  ..    maximum_fr
-00013c20: 6571 756e 6379 203d 206d 6178 2877 6f72  equncy = max(wor
-00013c30: 645f 6672 6571 7565 6e63 6965 732e 7661  d_frequencies.va
-00013c40: 6c75 6573 2829 290d 0a0d 0a20 2020 2066  lues())....    f
-00013c50: 6f72 2077 6f72 6420 696e 2077 6f72 645f  or word in word_
-00013c60: 6672 6571 7565 6e63 6965 732e 6b65 7973  frequencies.keys
-00013c70: 2829 3a20 200d 0a20 2020 2020 2020 2077  ():  ..        w
-00013c80: 6f72 645f 6672 6571 7565 6e63 6965 735b  ord_frequencies[
-00013c90: 776f 7264 5d20 3d20 2877 6f72 645f 6672  word] = (word_fr
-00013ca0: 6571 7565 6e63 6965 735b 776f 7264 5d2f  equencies[word]/
-00013cb0: 6d61 7869 6d75 6d5f 6672 6571 756e 6379  maximum_frequncy
-00013cc0: 290d 0a0d 0a20 2020 2023 7072 696e 7428  )....    #print(
-00013cd0: 776f 7264 5f66 7265 7175 656e 6369 6573  word_frequencies
-00013ce0: 290d 0a0d 0a20 2020 2073 656e 7465 6e63  )....    sentenc
-00013cf0: 655f 7363 6f72 6573 203d 207b 7d20 200d  e_scores = {}  .
-00013d00: 0a20 2020 2066 6f72 2073 656e 7420 696e  .    for sent in
-00013d10: 2073 656e 7465 6e63 655f 6c69 7374 3a20   sentence_list: 
-00013d20: 200d 0a20 2020 2020 2020 2066 6f72 2077   ..        for w
-00013d30: 6f72 6420 696e 206e 6c74 6b2e 776f 7264  ord in nltk.word
-00013d40: 5f74 6f6b 656e 697a 6528 7365 6e74 2e6c  _tokenize(sent.l
-00013d50: 6f77 6572 2829 293a 0d0a 2020 2020 2020  ower()):..      
-00013d60: 2020 2020 2020 6966 2077 6f72 6420 696e        if word in
-00013d70: 2077 6f72 645f 6672 6571 7565 6e63 6965   word_frequencie
-00013d80: 732e 6b65 7973 2829 3a0d 0a20 2020 2020  s.keys():..     
-00013d90: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00013da0: 6e28 7365 6e74 2e73 706c 6974 2827 2027  n(sent.split(' '
-00013db0: 2929 203c 2032 353a 0d0a 2020 2020 2020  )) < 25:..      
-00013dc0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00013dd0: 2073 656e 7420 6e6f 7420 696e 2073 656e   sent not in sen
-00013de0: 7465 6e63 655f 7363 6f72 6573 2e6b 6579  tence_scores.key
-00013df0: 7328 293a 0d0a 2020 2020 2020 2020 2020  s():..          
-00013e00: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00013e10: 6e74 656e 6365 5f73 636f 7265 735b 7365  ntence_scores[se
-00013e20: 6e74 5d20 3d20 776f 7264 5f66 7265 7175  nt] = word_frequ
-00013e30: 656e 6369 6573 5b77 6f72 645d 0d0a 2020  encies[word]..  
-00013e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e50: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00013e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e70: 2073 656e 7465 6e63 655f 7363 6f72 6573   sentence_scores
-00013e80: 5b73 656e 745d 202b 3d20 776f 7264 5f66  [sent] += word_f
-00013e90: 7265 7175 656e 6369 6573 5b77 6f72 645d  requencies[word]
-00013ea0: 0d0a 0d0a 2020 2020 2370 7269 6e74 2873  ....    #print(s
-00013eb0: 656e 7465 6e63 655f 7363 6f72 6573 290d  entence_scores).
-00013ec0: 0a0d 0a20 2020 2073 756d 6d61 7279 5f73  ...    summary_s
-00013ed0: 656e 7465 6e63 6573 203d 2068 6561 7071  entences = heapq
-00013ee0: 2e6e 6c61 7267 6573 7428 692c 2073 656e  .nlargest(i, sen
-00013ef0: 7465 6e63 655f 7363 6f72 6573 2c20 6b65  tence_scores, ke
-00013f00: 793d 7365 6e74 656e 6365 5f73 636f 7265  y=sentence_score
-00013f10: 732e 6765 7429 0d0a 2020 2020 2370 7269  s.get)..    #pri
-00013f20: 6e74 2873 756d 6d61 7279 5f73 656e 7465  nt(summary_sente
-00013f30: 6e63 6573 290d 0a20 2020 2073 756d 6d61  nces)..    summa
-00013f40: 7279 203d 2027 2027 2e6a 6f69 6e28 7375  ry = ' '.join(su
-00013f50: 6d6d 6172 795f 7365 6e74 656e 6365 7329  mmary_sentences)
-00013f60: 0d0a 2020 2020 2370 7269 6e74 2822 4149  ..    #print("AI
-00013f70: 2053 756d 6d61 7279 2229 0d0a 2020 2020   Summary")..    
-00013f80: 7265 7475 726e 2073 756d 6d61 7279 0d0a  return summary..
-00013f90: 0d0a 6465 6620 7374 6172 7473 756d 6d61  ..def startsumma
-00013fa0: 7279 2861 7274 6963 6c65 5f74 6578 742c  ry(article_text,
-00013fb0: 6676 616c 7565 2c6d 6178 6b65 7977 6f72  fvalue,maxkeywor
-00013fc0: 6473 293a 0d0a 2020 2020 2020 0d0a 2023  ds):..      .. #
-00013fd0: 2074 7279 3a0d 0a20 2020 6f72 6967 696e   try:..   origin
-00013fe0: 616c 776f 7264 7320 3d20 6c65 6e28 6172  alwords = len(ar
-00013ff0: 7469 636c 655f 7465 7874 2e73 706c 6974  ticle_text.split
-00014000: 2822 2022 2929 0d0a 0d0a 2020 2066 6f72  (" "))....   for
-00014010: 2069 2069 6e20 7261 6e67 6528 312c 3130   i in range(1,10
-00014020: 3030 3029 3a0d 0a20 2020 2020 7375 6d6d  000):..     summ
-00014030: 6172 793d 646f 7375 6d6d 6172 7928 6172  ary=dosummary(ar
-00014040: 7469 636c 655f 7465 7874 2c69 290d 0a20  ticle_text,i).. 
-00014050: 2020 2020 7265 7320 3d20 6c65 6e28 7375      res = len(su
-00014060: 6d6d 6172 792e 7370 6c69 7428 2929 0d0a  mmary.split())..
-00014070: 2020 2020 2069 6620 7265 7320 3e3d 2066       if res >= f
-00014080: 7661 6c75 653a 0d0a 2020 2020 2020 2020  value:..        
-00014090: 2062 7265 616b 0d0a 0d0a 2020 2073 756d   break....   sum
-000140a0: 6d61 7279 203d 2020 7265 2e73 7562 2822  mary =  re.sub("
-000140b0: 5c5c 5c5c 785b 612d 6630 2d39 5d5b 612d  \\\\x[a-f0-9][a-
-000140c0: 6630 2d39 5d22 2c20 2220 222c 7375 6d6d  f0-9]", " ",summ
-000140d0: 6172 7929 0d0a 2020 2073 756d 6d61 7279  ary)..   summary
-000140e0: 203d 2072 652e 7375 6228 225c 5c78 6532   = re.sub("\\xe2
-000140f0: 5c5c 7838 305c 5c78 3939 222c 2227 222c  \\x80\\x99","'",
-00014100: 2073 756d 6d61 7279 290d 0a20 2020 7375   summary)..   su
-00014110: 6d6d 6172 793d 7375 6d6d 6172 792e 7265  mmary=summary.re
-00014120: 706c 6163 6528 225c 5c78 6532 5c5c 7838  place("\\xe2\\x8
-00014130: 305c 5c78 3939 222c 2227 2229 0d0a 2020  0\\x99","'")..  
-00014140: 2073 756d 6d61 7279 3d73 756d 6d61 7279   summary=summary
-00014150: 2e72 6570 6c61 6365 2822 5c5c 7865 325c  .replace("\\xe2\
-00014160: 5c78 3830 5c5c 7839 3022 2c22 2d22 290d  \x80\\x90","-").
-00014170: 0a20 2020 7375 6d6d 6172 793d 7375 6d6d  .   summary=summ
-00014180: 6172 792e 7265 706c 6163 6528 225c 5c78  ary.replace("\\x
-00014190: 6532 5c5c 7838 305c 5c78 3931 222c 222d  e2\\x80\\x91","-
-000141a0: 2229 0d0a 2020 2073 756d 6d61 7279 3d73  ")..   summary=s
-000141b0: 756d 6d61 7279 2e72 6570 6c61 6365 2822  ummary.replace("
-000141c0: 5c5c 7865 325c 5c78 3830 5c5c 7839 3222  \\xe2\\x80\\x92"
-000141d0: 2c22 2d22 290d 0a20 2020 7375 6d6d 6172  ,"-")..   summar
-000141e0: 793d 7375 6d6d 6172 792e 7265 706c 6163  y=summary.replac
-000141f0: 6528 225c 5c78 6532 5c5c 7838 305c 5c78  e("\\xe2\\x80\\x
-00014200: 3933 222c 222d 2229 0d0a 2020 2073 756d  93","-")..   sum
-00014210: 6d61 7279 3d73 756d 6d61 7279 2e72 6570  mary=summary.rep
-00014220: 6c61 6365 2822 5c5c 7865 325c 5c78 3830  lace("\\xe2\\x80
-00014230: 5c5c 7839 3422 2c22 2d22 290d 0a20 2020  \\x94","-")..   
-00014240: 7375 6d6d 6172 793d 7375 6d6d 6172 792e  summary=summary.
-00014250: 7265 706c 6163 6528 225c 5c78 6532 5c5c  replace("\\xe2\\
-00014260: 7838 305c 5c78 3935 222c 222d 2229 0d0a  x80\\x95","-")..
-00014270: 2020 2073 756d 6d61 7279 3d73 756d 6d61     summary=summa
-00014280: 7279 2e72 6570 6c61 6365 2822 5c5c 7865  ry.replace("\\xe
-00014290: 325c 5c78 3830 5c5c 7862 3322 2c27 2227  2\\x80\\xb3",'"'
-000142a0: 290d 0a20 2020 7375 6d6d 6172 7920 3d20  )..   summary = 
-000142b0: 7375 6d6d 6172 792e 7265 706c 6163 6528  summary.replace(
-000142c0: 27e2 809c 272c 2027 2227 290d 0a20 2020  '...', '"')..   
-000142d0: 7375 6d6d 6172 7920 3d20 7375 6d6d 6172  summary = summar
-000142e0: 792e 7265 706c 6163 6528 27e2 809d 272c  y.replace('...',
-000142f0: 2027 2227 290d 0a20 2020 7375 6d6d 6172   '"')..   summar
-00014300: 7920 3d20 7375 6d6d 6172 792e 7265 706c  y = summary.repl
-00014310: 6163 6528 27e2 8099 272c 2022 2722 290d  ace('...', "'").
-00014320: 0a20 2020 7375 6d6d 6172 7920 3d20 7375  .   summary = su
-00014330: 6d6d 6172 792e 7265 706c 6163 6528 27e2  mmary.replace('.
-00014340: 8098 272c 2022 2722 290d 0a20 2020 7375  ..', "'")..   su
-00014350: 6d6d 6172 7920 3d20 7375 6d6d 6172 792e  mmary = summary.
-00014360: 7265 706c 6163 6528 27e2 8093 272c 2022  replace('...', "
-00014370: 2d22 290d 0a20 2020 7375 6d6d 6172 7920  -")..   summary 
-00014380: 3d20 7375 6d6d 6172 792e 7265 706c 6163  = summary.replac
-00014390: 6528 27e2 80a6 272c 2022 2e2e 2e22 290d  e('...', "...").
-000143a0: 0a20 2020 7375 6d6d 6172 7920 3d20 7375  .   summary = su
-000143b0: 6d6d 6172 792e 7265 706c 6163 6528 27e2  mmary.replace('.
-000143c0: 8094 272c 2022 2d22 290d 0a20 2020 7375  ..', "-")..   su
-000143d0: 6d6d 6172 7920 3d20 7375 6d6d 6172 792e  mmary = summary.
-000143e0: 7265 706c 6163 6528 2722 272c 2022 2229  replace('"', "")
-000143f0: 0d0a 0d0a 2020 2073 756d 6d61 7279 203d  ....   summary =
-00014400: 2073 756d 6d61 7279 2e72 6570 6c61 6365   summary.replace
-00014410: 2827 5c5c 7527 2c27 552b 2729 0d0a 2020  ('\\u','U+')..  
-00014420: 2073 756d 6d61 7279 203d 2072 652e 7375   summary = re.su
-00014430: 6228 7227 3c55 5c2b 285b 302d 3961 2d66  b(r'<U\+([0-9a-f
-00014440: 412d 465d 7b34 2c36 7d29 3e27 2c20 6c61  A-F]{4,6})>', la
-00014450: 6d62 6461 2078 3a20 6368 7228 696e 7428  mbda x: chr(int(
-00014460: 782e 6772 6f75 7028 3129 2c31 3629 292c  x.group(1),16)),
-00014470: 2073 756d 6d61 7279 290d 0a0d 0a20 2020   summary)....   
-00014480: 6b65 7977 6f72 6473 3d67 6574 6b65 7977  keywords=getkeyw
-00014490: 6f72 6473 2873 756d 6d61 7279 2c6d 6178  ords(summary,max
-000144a0: 6b65 7977 6f72 6473 290d 0a0d 0a20 2020  keywords)....   
-000144b0: 7375 6d6d 6172 7977 6f72 6473 203d 206c  summarywords = l
-000144c0: 656e 2873 756d 6d61 7279 2e73 706c 6974  en(summary.split
-000144d0: 2822 2022 2929 0d0a 200d 0a20 2020 6d61  (" ")).. ..   ma
-000144e0: 696e 6f75 743d 225c 2222 202b 206b 6579  inout="\"" + key
-000144f0: 776f 7264 7320 2b20 225c 222c 5c22 6f72  words + "\",\"or
-00014500: 6967 696e 616c 776f 7264 636f 756e 745c  iginalwordcount\
-00014510: 223a 2220 2b20 7374 7228 6f72 6967 696e  ":" + str(origin
-00014520: 616c 776f 7264 7329 202b 2022 2c5c 2273  alwords) + ",\"s
-00014530: 756d 6d61 7279 776f 7264 636f 756e 745c  ummarywordcount\
-00014540: 223a 222b 2073 7472 2873 756d 6d61 7279  ":"+ str(summary
-00014550: 776f 7264 7329 202b 222c 5c22 6d61 696e  words) +",\"main
-00014560: 7375 6d6d 6172 795c 223a 7b5c 2273 756d  summary\":{\"sum
-00014570: 6d61 7279 5c22 3a20 5c22 2220 2b20 7375  mary\": \"" + su
-00014580: 6d6d 6172 7920 2b20 225c 227d 7d22 0d0a  mmary + "\"}}"..
-00014590: 2020 2072 6574 7572 6e20 6d61 696e 6f75     return mainou
-000145a0: 740d 0a20 2020 0d0a 2323 2323 2323 2323  t..   ..########
-000145b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000145c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000145d0: 2323 2323 2323 2323 230d 0a0d 0a66 726f  #########....fro
-000145e0: 6d20 6c61 6e67 6368 6169 6e2e 656d 6265  m langchain.embe
-000145f0: 6464 696e 6773 2e6f 7065 6e61 6920 696d  ddings.openai im
-00014600: 706f 7274 204f 7065 6e41 4945 6d62 6564  port OpenAIEmbed
-00014610: 6469 6e67 730d 0a66 726f 6d20 6c61 6e67  dings..from lang
-00014620: 6368 6169 6e2e 7465 7874 5f73 706c 6974  chain.text_split
-00014630: 7465 7220 696d 706f 7274 2043 6861 7261  ter import Chara
-00014640: 6374 6572 5465 7874 5370 6c69 7474 6572  cterTextSplitter
-00014650: 0d0a 6672 6f6d 206c 616e 6763 6861 696e  ..from langchain
-00014660: 2e76 6563 746f 7273 746f 7265 732e 6661  .vectorstores.fa
-00014670: 6973 7320 696d 706f 7274 2046 4149 5353  iss import FAISS
-00014680: 0d0a 0d0a 6672 6f6d 206c 616e 6763 6861  ....from langcha
-00014690: 696e 2e63 6861 696e 732e 7175 6573 7469  in.chains.questi
-000146a0: 6f6e 5f61 6e73 7765 7269 6e67 2069 6d70  on_answering imp
-000146b0: 6f72 7420 6c6f 6164 5f71 615f 6368 6169  ort load_qa_chai
-000146c0: 6e0d 0a66 726f 6d20 6c61 6e67 6368 6169  n..from langchai
-000146d0: 6e2e 6c6c 6d73 2069 6d70 6f72 7420 5072  n.llms import Pr
-000146e0: 6f6d 7074 4c61 7965 724f 7065 6e41 4943  omptLayerOpenAIC
-000146f0: 6861 740d 0a66 726f 6d20 6c61 6e67 6368  hat..from langch
-00014700: 6169 6e2e 6368 6174 5f6d 6f64 656c 7320  ain.chat_models 
-00014710: 696d 706f 7274 2043 6861 744f 7065 6e41  import ChatOpenA
-00014720: 490d 0a66 726f 6d20 6c61 6e67 6368 6169  I..from langchai
-00014730: 6e2e 6c6c 6d73 2069 6d70 6f72 7420 4f70  n.llms import Op
-00014740: 656e 4149 0d0a 696d 706f 7274 2068 6173  enAI..import has
-00014750: 686c 6962 0d0a 0d0a 2320 416e 7377 6572  hlib....# Answer
-00014760: 2071 7565 7374 696f 6e73 2061 626f 7574   questions about
-00014770: 2074 6865 2068 6561 646c 696e 6573 0d0a   the headlines..
-00014780: 6465 6620 7374 6172 745f 636f 6e76 6572  def start_conver
-00014790: 7361 7469 6f6e 286f 7065 6e61 696b 6579  sation(openaikey
-000147a0: 2c71 7565 7279 2c74 6578 742c 7465 6d70  ,query,text,temp
-000147b0: 6572 6174 7572 652c 6d6f 6465 6c29 3a0d  erature,model):.
-000147c0: 0a20 2020 2023 2047 7261 6220 7468 6520  .    # Grab the 
-000147d0: 696e 7075 7420 6672 6f6d 2074 6865 2041  input from the A
-000147e0: 5049 0d0a 2020 2020 2020 2020 2371 7565  PI..        #que
-000147f0: 7279 203d 2069 6e70 7574 735b 2271 7565  ry = inputs["que
-00014800: 7279 220d 0a0d 0a0d 0a20 2020 2020 2020  ry"......       
-00014810: 2074 6578 745f 7370 6c69 7474 6572 203d   text_splitter =
-00014820: 2043 6861 7261 6374 6572 5465 7874 5370   CharacterTextSp
-00014830: 6c69 7474 6572 280d 0a20 2020 2020 2020  litter(..       
-00014840: 2020 2020 2073 6570 6172 6174 6f72 3d22       separator="
-00014850: 2022 2c0d 0a20 2020 2020 2020 2020 2020   ",..           
-00014860: 2063 6875 6e6b 5f73 697a 653d 3130 3030   chunk_size=1000
-00014870: 2c0d 0a20 2020 2020 2020 2020 2020 2063  ,..            c
-00014880: 6875 6e6b 5f6f 7665 726c 6170 3d32 3030  hunk_overlap=200
-00014890: 2c0d 0a20 2020 2020 2020 2020 2020 206c  ,..            l
-000148a0: 656e 6774 685f 6675 6e63 7469 6f6e 3d6c  ength_function=l
-000148b0: 656e 2c0d 0a20 2020 2020 2020 2029 0d0a  en,..        )..
-000148c0: 0d0a 2020 2020 2020 2020 7465 7874 7320  ..        texts 
-000148d0: 3d20 7465 7874 5f73 706c 6974 7465 722e  = text_splitter.
-000148e0: 7370 6c69 745f 7465 7874 2874 6578 7429  split_text(text)
-000148f0: 0d0a 2020 2020 2020 2020 656d 6265 6464  ..        embedd
-00014900: 696e 6773 203d 204f 7065 6e41 4945 6d62  ings = OpenAIEmb
-00014910: 6564 6469 6e67 7328 290d 0a20 2020 2020  eddings()..     
-00014920: 2020 2064 6f63 7365 6172 6368 203d 2046     docsearch = F
-00014930: 4149 5353 2e66 726f 6d5f 7465 7874 7328  AISS.from_texts(
-00014940: 7465 7874 732c 2065 6d62 6564 6469 6e67  texts, embedding
-00014950: 7329 0d0a 2020 2020 2020 2020 646f 6373  s)..        docs
-00014960: 203d 2064 6f63 7365 6172 6368 2e73 696d   = docsearch.sim
-00014970: 696c 6172 6974 795f 7365 6172 6368 2871  ilarity_search(q
-00014980: 7565 7279 290d 0a20 2020 2020 2020 200d  uery)..        .
-00014990: 0a20 2020 2020 2020 2063 6861 696e 203d  .        chain =
-000149a0: 206c 6f61 645f 7161 5f63 6861 696e 284f   load_qa_chain(O
-000149b0: 7065 6e41 4928 6d6f 6465 6c5f 6e61 6d65  penAI(model_name
-000149c0: 3d6d 6f64 656c 2c20 7465 6d70 6572 6174  =model, temperat
-000149d0: 7572 653d 7465 6d70 6572 6174 7572 652c  ure=temperature,
-000149e0: 6f70 656e 6169 5f61 7069 5f6b 6579 3d6f  openai_api_key=o
-000149f0: 7065 6e61 696b 6579 292c 2063 6861 696e  penaikey), chain
-00014a00: 5f74 7970 653d 2273 7475 6666 2229 0d0a  _type="stuff")..
-00014a10: 2020 2020 2020 2020 7265 7320 3d20 6368          res = ch
-00014a20: 6169 6e28 7b22 696e 7075 745f 646f 6375  ain({"input_docu
-00014a30: 6d65 6e74 7322 3a20 646f 6373 2c20 2271  ments": docs, "q
-00014a40: 7565 7374 696f 6e22 3a20 7175 6572 797d  uestion": query}
-00014a50: 2c20 7265 7475 726e 5f6f 6e6c 795f 6f75  , return_only_ou
-00014a60: 7470 7574 733d 5472 7565 290d 0a0d 0a20  tputs=True).... 
-00014a70: 2020 2020 2020 2023 7265 7475 726e 207b         #return {
-00014a80: 2270 7265 6422 3a20 7265 737d 0d0a 2020  "pred": res}..  
-00014a90: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00014aa0: 0d0a 0d0a 2323 2323 2323 2323 2323 2323  ....############
-00014ab0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00014ac0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00014ad0: 2323 2323 2323 2323 0d0a 6672 6f6d 2070  ########..from p
-00014ae0: 6466 7175 6572 7920 696d 706f 7274 2050  dfquery import P
-00014af0: 4446 5175 6572 790d 0a69 6d70 6f72 7420  DFQuery..import 
-00014b00: 786d 6c74 6f64 6963 740d 0a0d 0a0d 0a64  xmltodict......d
-00014b10: 6566 206c 6162 656c 6669 656c 6473 2866  ef labelfields(f
-00014b20: 696c 656e 616d 652c 6c61 6265 6c6e 616d  ilename,labelnam
-00014b30: 652c 6163 726f 7479 7065 293a 0d0a 2020  e,acrotype):..  
-00014b40: 2020 2070 6466 203d 2050 4446 5175 6572     pdf = PDFQuer
-00014b50: 7928 6669 6c65 6e61 6d65 290d 0a20 2020  y(filename)..   
-00014b60: 2020 7064 662e 6c6f 6164 2829 0d0a 2020    pdf.load()..  
-00014b70: 2020 2023 4c54 5465 7874 4c69 6e65 486f     #LTTextLineHo
-00014b80: 7269 7a6f 6e74 616c 0d0a 2020 2020 206c  rizontal..     l
-00014b90: 6162 656c 203d 2070 6466 2e70 7128 6163  abel = pdf.pq(ac
-00014ba0: 726f 7479 7065 2b27 3a63 6f6e 7461 696e  rotype+':contain
-00014bb0: 7328 2227 2b6c 6162 656c 6e61 6d65 202b  s("'+labelname +
-00014bc0: 2027 2229 2729 0d0a 2020 2020 206c 6566   '")')..     lef
-00014bd0: 745f 636f 726e 6572 203d 2066 6c6f 6174  t_corner = float
-00014be0: 286c 6162 656c 2e61 7474 7228 2778 3027  (label.attr('x0'
-00014bf0: 2929 0d0a 2020 2020 2062 6f74 746f 6d5f  ))..     bottom_
-00014c00: 636f 726e 6572 203d 2066 6c6f 6174 286c  corner = float(l
-00014c10: 6162 656c 2e61 7474 7228 2779 3027 2929  abel.attr('y0'))
-00014c20: 0d0a 2020 2020 206e 616d 6520 3d20 7064  ..     name = pd
-00014c30: 662e 7071 2861 6372 6f74 7970 6520 2b27  f.pq(acrotype +'
-00014c40: 3a69 6e5f 6262 6f78 2822 2573 2c20 2573  :in_bbox("%s, %s
-00014c50: 2c20 2573 2c20 2573 2229 2720 2520 286c  , %s, %s")' % (l
-00014c60: 6566 745f 636f 726e 6572 2c20 626f 7474  eft_corner, bott
-00014c70: 6f6d 5f63 6f72 6e65 722d 3330 2c20 6c65  om_corner-30, le
-00014c80: 6674 5f63 6f72 6e65 722b 3135 302c 2062  ft_corner+150, b
-00014c90: 6f74 746f 6d5f 636f 726e 6572 2929 2e74  ottom_corner)).t
-00014ca0: 6578 7428 290d 0a20 2020 2020 7265 7475  ext()..     retu
-00014cb0: 726e 206e 616d 650d 0a0d 0a0d 0a64 6566  rn name......def
-00014cc0: 2065 7874 7261 6374 6669 656c 6473 2866   extractfields(f
-00014cd0: 696c 656e 616d 6529 3a0d 0a20 2020 2020  ilename):..     
-00014ce0: 2023 7265 6164 2074 6865 2050 4446 0d0a   #read the PDF..
-00014cf0: 2020 2020 2020 7064 6620 3d20 5044 4651        pdf = PDFQ
-00014d00: 7565 7279 2866 696c 656e 616d 6529 0d0a  uery(filename)..
-00014d10: 2020 2020 2020 7064 662e 6c6f 6164 2829        pdf.load()
-00014d20: 0d0a 0d0a 2020 2020 2020 236f 203d 2078  ....      #o = x
-00014d30: 6d6c 746f 6469 6374 2e70 6172 7365 2827  mltodict.parse('
-00014d40: 3c65 3e20 3c61 3e74 6578 743c 2f61 3e20  <e> <a>text</a> 
-00014d50: 3c61 3e74 6578 743c 2f61 3e20 3c2f 653e  <a>text</a> </e>
-00014d60: 2729 0d0a 0d0a 2020 2020 2020 2363 6f6e  ')....      #con
-00014d70: 7665 7274 2074 6865 2070 6466 2074 6f20  vert the pdf to 
-00014d80: 584d 4c0d 0a20 2020 2020 2078 6d6c 6669  XML..      xmlfi
-00014d90: 6c65 3d20 6669 6c65 6e61 6d65 202b 2027  le= filename + '
-00014da0: 2e78 6d6c 270d 0a20 2020 2020 2070 6466  .xml'..      pdf
-00014db0: 2e74 7265 652e 7772 6974 6528 786d 6c66  .tree.write(xmlf
-00014dc0: 696c 652c 2070 7265 7474 795f 7072 696e  ile, pretty_prin
-00014dd0: 7420 3d20 5472 7565 290d 0a20 2020 2020  t = True)..     
-00014de0: 2077 6974 6820 6f70 656e 2878 6d6c 6669   with open(xmlfi
-00014df0: 6c65 2920 6173 2066 3a20 7320 3d20 662e  le) as f: s = f.
-00014e00: 7265 6164 2829 0d0a 0d0a 2020 2020 2020  read()....      
-00014e10: 2370 7269 6e74 2873 290d 0a20 2020 2020  #print(s)..     
-00014e20: 206a 736f 6e62 7566 3d78 6d6c 746f 6a73   jsonbuf=xmltojs
-00014e30: 6f6e 2873 2c78 6d6c 6669 6c65 290d 0a0d  on(s,xmlfile)...
-00014e40: 0a20 2020 2020 2072 6574 7572 6e20 6a73  .      return js
-00014e50: 6f6e 6275 660d 0a20 2020 2020 200d 0a0d  onbuf..      ...
-00014e60: 0a64 6566 2078 6d6c 746f 6a73 6f6e 2878  .def xmltojson(x
-00014e70: 6d6c 6275 6666 6572 2c78 6d6c 6669 6c65  mlbuffer,xmlfile
-00014e80: 293a 0d0a 0d0a 2020 2020 2020 6f20 3d20  ):....      o = 
-00014e90: 786d 6c74 6f64 6963 742e 7061 7273 6528  xmltodict.parse(
-00014ea0: 786d 6c62 7566 6665 7229 0d0a 2020 2020  xmlbuffer)..    
-00014eb0: 2020 786d 6c6a 736f 6e3d 6a73 6f6e 2e64    xmljson=json.d
-00014ec0: 756d 7073 286f 290d 0a20 2020 2020 2023  umps(o)..      #
-00014ed0: 7072 696e 7428 786d 6c6a 736f 6e29 0d0a  print(xmljson)..
-00014ee0: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
-00014ef0: 786d 6c66 696c 6520 2b20 272e 6a73 6f6e  xmlfile + '.json
-00014f00: 272c 2277 2229 2061 7320 663a 0d0a 2020  ',"w") as f:..  
-00014f10: 2020 2020 2020 662e 7772 6974 6528 786d        f.write(xm
-00014f20: 6c6a 736f 6e29 0d0a 0d0a 2020 2020 2020  ljson)....      
-00014f30: 7265 7475 726e 2078 6d6c 6a73 6f6e 2020  return xmljson  
-00014f40: 0d0a 0d0a                                ....
+00012140: 2323 2323 2323 2323 2323 0d0a 2323 2320  ##########..### 
+00012150: 4465 7665 6c6f 7065 6420 6279 204f 5449  Developed by OTI
+00012160: 4353 2041 6476 616e 6365 6420 416e 616c  CS Advanced Anal
+00012170: 7974 6963 730d 0a23 2323 2053 6562 6173  ytics..### Sebas
+00012180: 7469 616e 204d 6175 7269 6365 0d0a 2323  tian Maurice..##
+00012190: 0d0a 2323 696d 706f 7274 2062 7334 2061  ..##import bs4 a
+000121a0: 7320 6273 2020 0d0a 2323 696d 706f 7274  s bs  ..##import
+000121b0: 2075 726c 6c69 622e 7265 7175 6573 7420   urllib.request 
+000121c0: 200d 0a23 2369 6d70 6f72 7420 7265 0d0a   ..##import re..
+000121d0: 2323 696d 706f 7274 206e 6c74 6b0d 0a23  ##import nltk..#
+000121e0: 2366 726f 6d20 6e6c 746b 2e74 6f6b 656e  #from nltk.token
+000121f0: 697a 6520 696d 706f 7274 2052 6567 6578  ize import Regex
+00012200: 7054 6f6b 656e 697a 6572 0d0a 2323 696d  pTokenizer..##im
+00012210: 706f 7274 2068 6561 7071 0d0a 2323 696d  port heapq..##im
+00012220: 706f 7274 2073 7973 0d0a 2323 696d 706f  port sys..##impo
+00012230: 7274 206f 730d 0a23 2366 726f 6d20 7261  rt os..##from ra
+00012240: 6b65 5f6e 6c74 6b20 696d 706f 7274 204d  ke_nltk import M
+00012250: 6574 7269 632c 5261 6b65 0d0a 2323 696d  etric,Rake..##im
+00012260: 706f 7274 206a 736f 6e0d 0a23 2369 6d70  port json..##imp
+00012270: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
+00012280: 0d0a 2323 696d 706f 7274 206e 6c74 6b2e  ..##import nltk.
+00012290: 636f 7270 7573 0d0a 2323 6672 6f6d 206e  corpus..##from n
+000122a0: 6c74 6b2e 636f 7270 7573 2069 6d70 6f72  ltk.corpus impor
+000122b0: 7420 7374 6f70 776f 7264 730d 0a23 2366  t stopwords..##f
+000122c0: 726f 6d20 7465 7874 626c 6f62 2069 6d70  rom textblob imp
+000122d0: 6f72 7420 5465 7874 426c 6f62 0d0a 2323  ort TextBlob..##
+000122e0: 6672 6f6d 2074 6578 7462 6c6f 6220 696d  from textblob im
+000122f0: 706f 7274 2057 6f72 640d 0a23 2366 726f  port Word..##fro
+00012300: 6d20 736b 6c65 6172 6e2e 6665 6174 7572  m sklearn.featur
+00012310: 655f 6578 7472 6163 7469 6f6e 2e74 6578  e_extraction.tex
+00012320: 7420 696d 706f 7274 2054 6669 6466 5472  t import TfidfTr
+00012330: 616e 7366 6f72 6d65 722c 5466 6964 6656  ansformer,TfidfV
+00012340: 6563 746f 7269 7a65 720d 0a23 2366 726f  ectorizer..##fro
+00012350: 6d20 736b 6c65 6172 6e2e 6665 6174 7572  m sklearn.featur
+00012360: 655f 6578 7472 6163 7469 6f6e 2e74 6578  e_extraction.tex
+00012370: 7420 696d 706f 7274 2043 6f75 6e74 5665  t import CountVe
+00012380: 6374 6f72 697a 6572 0d0a 2323 236e 6c74  ctorizer..###nlt
+00012390: 6b2e 646f 776e 6c6f 6164 2827 7075 6e6b  k.download('punk
+000123a0: 7427 290d 0a23 2369 6d70 6f72 7420 7761  t')..##import wa
+000123b0: 726e 696e 6773 0d0a 2323 7761 726e 696e  rnings..##warnin
+000123c0: 6773 2e66 696c 7465 7277 6172 6e69 6e67  gs.filterwarning
+000123d0: 7328 2269 676e 6f72 6522 290d 0a23 230d  s("ignore")..##.
+000123e0: 0a23 2323 6e6c 746b 2e64 6f77 6e6c 6f61  .###nltk.downloa
+000123f0: 6428 2773 746f 7077 6f72 6473 2729 0d0a  d('stopwords')..
+00012400: 2323 0d0a 2323 6465 6620 6765 745f 7374  ##..##def get_st
+00012410: 6f70 5f77 6f72 6473 2829 3a0d 0a23 2320  op_words():..## 
+00012420: 2020 2022 2222 6c6f 6164 2073 746f 7020     """load stop 
+00012430: 776f 7264 7320 2222 220d 0a23 2320 2020  words """..##   
+00012440: 2073 7470 7772 6420 3d20 2073 746f 7077   stpwrd =  stopw
+00012450: 6f72 6473 2e77 6f72 6473 2827 656e 676c  ords.words('engl
+00012460: 6973 6827 290d 0a23 2320 2020 206e 6577  ish')..##    new
+00012470: 5f73 746f 7077 6f72 6473 203d 205b 226e  _stopwords = ["n
+00012480: 6565 6422 2c20 2275 6e66 6f72 7475 6e61  eed", "unfortuna
+00012490: 7465 6c79 222c 2022 746f 222c 2022 6f6e  tely", "to", "on
+000124a0: 222c 2022 6461 696c 7922 2c20 2274 616b  ", "daily", "tak
+000124b0: 6522 2c0d 0a23 2320 2020 2020 2020 2020  e",..##         
+000124c0: 2020 2020 2020 2020 2020 2020 2274 616b              "tak
+000124d0: 656e 222c 2261 6464 7265 7373 696e 6722  en","addressing"
+000124e0: 2c22 736f 6f6e 6572 222c 2272 6174 6865  ,"sooner","rathe
+000124f0: 7222 2c22 6d61 6b65 222c 226c 6174 6572  r","make","later
+00012500: 222c 0d0a 2323 2020 2020 2020 2020 2020  ",..##          
+00012510: 2020 2020 2020 2020 2020 2022 736f 6f6e             "soon
+00012520: 6572 222c 2273 756d 6d61 7279 222c 226c  er","summary","l
+00012530: 6561 7665 222c 2265 7665 7279 222c 2269  eave","every","i
+00012540: 6e74 656e 6422 2c22 6669 6e61 6c6c 7922  ntend","finally"
+00012550: 2c0d 0a23 2320 2020 2020 2020 2020 2020  ,..##           
+00012560: 2020 2020 2020 2020 2020 2265 6e74 6972            "entir
+00012570: 656c 7922 2c22 6576 656e 222c 2265 6e73  ely","even","ens
+00012580: 7572 6522 2c22 616c 736f 222c 2261 6666  ure","also","aff
+00012590: 6563 7422 2c22 6166 6665 6374 696e 6722  ect","affecting"
+000125a0: 2c0d 0a23 2320 2020 2020 2020 2020 2020  ,..##           
+000125b0: 2020 2020 2020 2020 2020 2262 7573 696e            "busin
+000125c0: 6573 7322 2c22 636c 6173 7322 2c22 636f  ess","class","co
+000125d0: 6d70 616e 7922 2c22 616c 736f 222c 2279  mpany","also","y
+000125e0: 6561 7222 2c22 7573 696e 6722 2c0d 0a23  ear","using",..#
+000125f0: 2320 2020 2020 2020 2020 2020 2020 2020  #               
+00012600: 2020 2020 2020 2269 7373 7565 6422 2c22        "issued","
+00012610: 7370 6563 6966 6963 222c 2273 7065 6369  specific","speci
+00012620: 6669 6361 6c6c 7922 2c22 7265 6173 6f6e  fically","reason
+00012630: 222c 2272 6561 6c22 2c0d 0a23 2320 2020  ","real",..##   
+00012640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012650: 2020 2270 726f 6a65 6374 222c 2270 6172    "project","par
+00012660: 7469 6375 6c61 726c 7922 2c22 7061 7274  ticularly","part
+00012670: 6963 756c 6172 222c 226d 6174 7465 7222  icular","matter"
+00012680: 2c22 6d61 696e 222c 0d0a 2323 2020 2020  ,"main",..##    
+00012690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000126a0: 2022 6c69 7374 6564 222c 2263 6f6d 6522   "listed","come"
+000126b0: 2c22 636f 6d70 616e 7922 2c22 636f 756c  ,"company","coul
+000126c0: 6422 2c22 636f 7079 222c 2266 6972 7374  d","copy","first
+000126d0: 222c 2265 7861 6d70 6c65 222c 0d0a 2323  ","example",..##
+000126e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000126f0: 2020 2020 2022 7265 616c 222c 2266 6163       "real","fac
+00012700: 746f 7222 2c22 7765 6c6c 222c 2273 6f72  tor","well","sor
+00012710: 7422 2c22 736f 6369 616c 222c 2273 6f63  t","social","soc
+00012720: 6961 6c6c 7922 2c22 7468 726f 7567 686f  ially","througho
+00012730: 7574 222c 0d0a 2323 2020 2020 2020 2020  ut",..##        
+00012740: 2020 2020 2020 2020 2020 2020 2022 7265               "re
+00012750: 6173 6f6e 222c 2261 7661 696c 6162 6c65  ason","available
+00012760: 222c 2261 7070 726f 6163 6822 2c22 7661  ","approach","va
+00012770: 7279 222c 2274 7970 6522 2c22 6163 726f  ry","type","acro
+00012780: 7373 222c 0d0a 2323 2020 2020 2020 2020  ss",..##        
+00012790: 2020 2020 2020 2020 2020 2020 2022 6176               "av
+000127a0: 6169 6c61 626c 6522 2c22 6571 7561 6c6c  ailable","equall
+000127b0: 7922 2c22 6d61 6e61 6765 7222 2c22 6465  y","manager","de
+000127c0: 6669 6e69 7469 6f6e 222c 2273 686f 7274  finition","short
+000127d0: 222c 2272 6573 706f 6e73 6522 2c0d 0a23  ","response",..#
+000127e0: 2320 2020 2020 2020 2020 2020 2020 2020  #               
+000127f0: 2020 2020 2020 2270 616e 656c 222c 2272        "panel","r
+00012800: 6571 7569 7265 7322 2c22 7265 7175 6972  equires","requir
+00012810: 696e 6722 2c22 7261 6973 6522 2c22 7368  ing","raise","sh
+00012820: 6f77 222c 2264 6f6e 6522 2c22 6164 6571  ow","done","adeq
+00012830: 7561 7465 6c79 222c 0d0a 2323 2020 2020  uately",..##    
+00012840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012850: 2022 6765 6e65 7269 6322 2c22 6765 6e65   "generic","gene
+00012860: 7261 6c22 2c22 636f 7572 7365 222c 2261  ral","course","a
+00012870: 7070 6c69 6564 222c 2272 656c 6174 6564  pplied","related
+00012880: 225d 0d0a 2323 2020 2020 7374 7077 7264  "]..##    stpwrd
+00012890: 2e65 7874 656e 6428 6e65 775f 7374 6f70  .extend(new_stop
+000128a0: 776f 7264 7329 0d0a 2323 2020 2020 7265  words)..##    re
+000128b0: 7475 726e 2073 7470 7772 640d 0a23 2320  turn stpwrd..## 
+000128c0: 200d 0a23 230d 0a23 2320 2020 200d 0a23   ..##..##    ..#
+000128d0: 2323 2320 2020 2077 6974 6820 6f70 656e  ###    with open
+000128e0: 2827 7374 6f70 776f 7264 732e 7478 7427  ('stopwords.txt'
+000128f0: 2c20 2772 272c 2065 6e63 6f64 696e 673d  , 'r', encoding=
+00012900: 2275 7466 2d38 2229 2061 7320 663a 0d0a  "utf-8") as f:..
+00012910: 2323 2323 2020 2020 2020 2020 7374 6f70  ####        stop
+00012920: 776f 7264 7320 3d20 662e 7265 6164 6c69  words = f.readli
+00012930: 6e65 7328 290d 0a23 2323 2320 2020 2020  nes()..####     
+00012940: 2020 2073 746f 705f 7365 7420 3d20 7365     stop_set = se
+00012950: 7428 6d2e 7374 7269 7028 2920 666f 7220  t(m.strip() for 
+00012960: 6d20 696e 2073 746f 7077 6f72 6473 290d  m in stopwords).
+00012970: 0a23 2323 2320 2020 2020 2023 2020 7072  .####      #  pr
+00012980: 696e 7428 6672 6f7a 656e 7365 7428 7374  int(frozenset(st
+00012990: 6f70 5f73 6574 2929 0d0a 2323 2323 2020  op_set))..####  
+000129a0: 2020 2020 2020 7265 7475 726e 2066 726f        return fro
+000129b0: 7a65 6e73 6574 2873 746f 705f 7365 7429  zenset(stop_set)
+000129c0: 0d0a 2323 0d0a 2323 6465 6620 7363 7261  ..##..##def scra
+000129d0: 7065 7765 6228 7468 6575 726c 293a 0d0a  peweb(theurl):..
+000129e0: 2323 2020 2020 7363 7261 7065 645f 6461  ##    scraped_da
+000129f0: 7461 203d 2075 726c 6c69 622e 7265 7175  ta = urllib.requ
+00012a00: 6573 742e 7572 6c6f 7065 6e28 7468 6575  est.urlopen(theu
+00012a10: 726c 2920 200d 0a23 2320 2020 2061 7274  rl)  ..##    art
+00012a20: 6963 6c65 203d 2073 6372 6170 6564 5f64  icle = scraped_d
+00012a30: 6174 612e 7265 6164 2829 0d0a 2323 0d0a  ata.read()..##..
+00012a40: 2323 2020 2020 7061 7273 6564 5f61 7274  ##    parsed_art
+00012a50: 6963 6c65 203d 2062 732e 4265 6175 7469  icle = bs.Beauti
+00012a60: 6675 6c53 6f75 7028 6172 7469 636c 652c  fulSoup(article,
+00012a70: 276c 786d 6c27 290d 0a23 230d 0a23 2320  'lxml')..##..## 
+00012a80: 2020 2070 6172 6167 7261 7068 7320 3d20     paragraphs = 
+00012a90: 7061 7273 6564 5f61 7274 6963 6c65 2e66  parsed_article.f
+00012aa0: 696e 645f 616c 6c28 2770 2729 0d0a 2323  ind_all('p')..##
+00012ab0: 0d0a 2323 2020 2020 6172 7469 636c 655f  ..##    article_
+00012ac0: 7465 7874 203d 2022 220d 0a23 230d 0a23  text = ""..##..#
+00012ad0: 2320 2020 2066 6f72 2070 2069 6e20 7061  #    for p in pa
+00012ae0: 7261 6772 6170 6873 3a20 200d 0a23 2320  ragraphs:  ..## 
+00012af0: 2020 2020 2020 2061 7274 6963 6c65 5f74         article_t
+00012b00: 6578 7420 2b3d 2070 2e74 6578 740d 0a23  ext += p.text..#
+00012b10: 2320 2020 2072 6574 7572 6e20 6172 7469  #    return arti
+00012b20: 636c 655f 7465 7874 200d 0a23 230d 0a23  cle_text ..##..#
+00012b30: 2364 6566 2063 6f6e 7665 7274 746f 6c6f  #def converttolo
+00012b40: 7765 7263 6173 6528 6466 2c63 6f6c 293a  wercase(df,col):
+00012b50: 0d0a 2323 2020 2020 2020 6466 5b63 6f6c  ..##      df[col
+00012b60: 5d20 3d20 6466 5b63 6f6c 5d2e 6170 706c  ] = df[col].appl
+00012b70: 7928 6c61 6d62 6461 2078 3a20 2220 222e  y(lambda x: " ".
+00012b80: 6a6f 696e 2878 2e6c 6f77 6572 2829 2066  join(x.lower() f
+00012b90: 6f72 2078 2069 6e20 782e 7370 6c69 7428  or x in x.split(
+00012ba0: 2929 290d 0a23 2320 2020 2020 2072 6574  )))..##      ret
+00012bb0: 7572 6e20 6466 0d0a 2323 2020 2020 0d0a  urn df..##    ..
+00012bc0: 2323 6465 6620 7265 6d6f 7665 7075 6e63  ##def removepunc
+00012bd0: 7475 6174 696f 6e28 6466 2c63 6f6c 293a  tuation(df,col):
+00012be0: 0d0a 2323 2020 2020 2020 6466 5b63 6f6c  ..##      df[col
+00012bf0: 5d20 3d20 6466 5b63 6f6c 5d2e 7374 722e  ] = df[col].str.
+00012c00: 7265 706c 6163 6528 275b 5e5c 775c 735d  replace('[^\w\s]
+00012c10: 272c 2727 290d 0a23 2320 2020 2020 2072  ','')..##      r
+00012c20: 6574 7572 6e20 6466 0d0a 2323 0d0a 2323  eturn df..##..##
+00012c30: 6465 6620 7265 6d6f 7665 7374 6f70 776f  def removestopwo
+00012c40: 7264 7328 6466 2c63 6f6c 293a 0d0a 2323  rds(df,col):..##
+00012c50: 2020 2020 2020 7374 6f70 203d 2073 746f        stop = sto
+00012c60: 7077 6f72 6473 2e77 6f72 6473 2827 656e  pwords.words('en
+00012c70: 676c 6973 6827 290d 0a23 2320 2020 2020  glish')..##     
+00012c80: 2064 665b 636f 6c5d 203d 2064 665b 636f   df[col] = df[co
+00012c90: 6c5d 2e61 7070 6c79 286c 616d 6264 6120  l].apply(lambda 
+00012ca0: 783a 2022 2022 2e6a 6f69 6e28 7820 666f  x: " ".join(x fo
+00012cb0: 7220 7820 696e 2078 2e73 706c 6974 2829  r x in x.split()
+00012cc0: 2069 6620 7820 6e6f 7420 696e 2073 746f   if x not in sto
+00012cd0: 7029 290d 0a23 2320 2020 2020 2072 6574  p))..##      ret
+00012ce0: 7572 6e20 6466 0d0a 2323 0d0a 2323 6465  urn df..##..##de
+00012cf0: 6620 7265 6d6f 7665 636f 6d6d 6f6e 776f  f removecommonwo
+00012d00: 7264 7328 6466 2c63 6f6c 293a 0d0a 2323  rds(df,col):..##
+00012d10: 2020 2020 2020 6672 6571 203d 2070 642e        freq = pd.
+00012d20: 5365 7269 6573 2827 2027 2e6a 6f69 6e28  Series(' '.join(
+00012d30: 6466 5b63 6f6c 5d29 2e73 706c 6974 2829  df[col]).split()
+00012d40: 292e 7661 6c75 655f 636f 756e 7473 2829  ).value_counts()
+00012d50: 5b3a 3130 5d0d 0a23 2320 2020 2020 2066  [:10]..##      f
+00012d60: 7265 7120 3d20 6c69 7374 2866 7265 712e  req = list(freq.
+00012d70: 696e 6465 7829 0d0a 2323 2020 2020 2020  index)..##      
+00012d80: 6466 5b63 6f6c 5d20 3d20 6466 5b63 6f6c  df[col] = df[col
+00012d90: 5d2e 6170 706c 7928 6c61 6d62 6461 2078  ].apply(lambda x
+00012da0: 3a20 2220 222e 6a6f 696e 2878 2066 6f72  : " ".join(x for
+00012db0: 2078 2069 6e20 782e 7370 6c69 7428 2920   x in x.split() 
+00012dc0: 6966 2078 206e 6f74 2069 6e20 6672 6571  if x not in freq
+00012dd0: 2929 0d0a 2323 2020 2020 2020 7265 7475  ))..##      retu
+00012de0: 726e 2064 660d 0a23 230d 0a23 2364 6566  rn df..##..##def
+00012df0: 2072 656d 6f76 6572 6172 6577 6f72 6473   removerarewords
+00012e00: 2864 662c 636f 6c29 3a0d 0a23 2320 2020  (df,col):..##   
+00012e10: 2020 2066 7265 7120 3d20 7064 2e53 6572     freq = pd.Ser
+00012e20: 6965 7328 2720 272e 6a6f 696e 2864 665b  ies(' '.join(df[
+00012e30: 636f 6c5d 292e 7370 6c69 7428 2929 2e76  col]).split()).v
+00012e40: 616c 7565 5f63 6f75 6e74 7328 295b 2d31  alue_counts()[-1
+00012e50: 303a 5d0d 0a23 2320 2020 2020 2066 7265  0:]..##      fre
+00012e60: 7120 3d20 6c69 7374 2866 7265 712e 696e  q = list(freq.in
+00012e70: 6465 7829 0d0a 2323 2020 2020 2020 6466  dex)..##      df
+00012e80: 5b63 6f6c 5d20 3d20 6466 5b63 6f6c 5d2e  [col] = df[col].
+00012e90: 6170 706c 7928 6c61 6d62 6461 2078 3a20  apply(lambda x: 
+00012ea0: 2220 222e 6a6f 696e 2878 2066 6f72 2078  " ".join(x for x
+00012eb0: 2069 6e20 782e 7370 6c69 7428 2920 6966   in x.split() if
+00012ec0: 2078 206e 6f74 2069 6e20 6672 6571 2929   x not in freq))
+00012ed0: 0d0a 2323 2020 2020 2020 7265 7475 726e  ..##      return
+00012ee0: 2064 660d 0a23 230d 0a23 2364 6566 2063   df..##..##def c
+00012ef0: 6f72 7265 6374 7370 656c 6c69 6e67 2864  orrectspelling(d
+00012f00: 662c 636f 6c29 3a0d 0a23 2320 2020 2020  f,col):..##     
+00012f10: 2064 665b 636f 6c5d 5b3a 355d 2e61 7070   df[col][:5].app
+00012f20: 6c79 286c 616d 6264 6120 783a 2073 7472  ly(lambda x: str
+00012f30: 2854 6578 7442 6c6f 6228 7829 2e63 6f72  (TextBlob(x).cor
+00012f40: 7265 6374 2829 2929 0d0a 2323 2020 2020  rect()))..##    
+00012f50: 2020 7265 7475 726e 2064 660d 0a23 230d    return df..##.
+00012f60: 0a23 2364 6566 206c 656d 6d61 7469 7a61  .##def lemmatiza
+00012f70: 7469 6f6e 2864 662c 636f 6c29 3a0d 0a23  tion(df,col):..#
+00012f80: 2320 2020 2020 2064 665b 636f 6c5d 203d  #      df[col] =
+00012f90: 2064 665b 636f 6c5d 2e61 7070 6c79 286c   df[col].apply(l
+00012fa0: 616d 6264 6120 783a 2022 2022 2e6a 6f69  ambda x: " ".joi
+00012fb0: 6e28 5b57 6f72 6428 776f 7264 292e 6c65  n([Word(word).le
+00012fc0: 6d6d 6174 697a 6528 2920 666f 7220 776f  mmatize() for wo
+00012fd0: 7264 2069 6e20 782e 7370 6c69 7428 295d  rd in x.split()]
+00012fe0: 2929 0d0a 2323 2020 2020 2020 7265 7475  ))..##      retu
+00012ff0: 726e 2064 660d 0a23 230d 0a23 2364 6566  rn df..##..##def
+00013000: 2074 7261 696e 7665 6374 2863 762c 7462   trainvect(cv,tb
+00013010: 6f77 2c64 662c 636f 6c2c 6d61 786b 6579  ow,df,col,maxkey
+00013020: 776f 7264 7329 3a0d 0a23 2320 2020 2020  words):..##     
+00013030: 2074 6578 743d 6466 5b63 6f6c 5d2e 746f   text=df[col].to
+00013040: 6c69 7374 2829 0d0a 2323 2020 2020 2020  list()..##      
+00013050: 7466 6964 6620 3d20 5466 6964 6654 7261  tfidf = TfidfTra
+00013060: 6e73 666f 726d 6572 2873 6d6f 6f74 685f  nsformer(smooth_
+00013070: 6964 663d 5472 7565 2c75 7365 5f69 6466  idf=True,use_idf
+00013080: 3d54 7275 6529 0d0a 2323 2020 2020 2020  =True)..##      
+00013090: 7466 6964 662e 6669 7428 7462 6f77 290d  tfidf.fit(tbow).
+000130a0: 0a23 2320 2020 2020 2074 665f 6964 665f  .##      tf_idf_
+000130b0: 7665 6374 6f72 3d74 6669 6466 2e74 7261  vector=tfidf.tra
+000130c0: 6e73 666f 726d 2863 762e 7472 616e 7366  nsform(cv.transf
+000130d0: 6f72 6d28 7465 7874 2929 0d0a 2323 2020  orm(text))..##  
+000130e0: 2020 2020 736f 7274 6564 6974 656d 733d      sorteditems=
+000130f0: 736f 7274 5f63 6f6f 2874 665f 6964 665f  sort_coo(tf_idf_
+00013100: 7665 6374 6f72 2e74 6f63 6f6f 2829 290d  vector.tocoo()).
+00013110: 0a23 2320 2020 2020 2066 6561 7475 7265  .##      feature
+00013120: 6e61 6d65 733d 6376 2e67 6574 5f66 6561  names=cv.get_fea
+00013130: 7475 7265 5f6e 616d 6573 5f6f 7574 2829  ture_names_out()
+00013140: 0d0a 2323 2020 2020 2020 6b65 7977 6f72  ..##      keywor
+00013150: 6473 3d65 7874 7261 6374 5f74 6f70 6e5f  ds=extract_topn_
+00013160: 6672 6f6d 5f76 6563 746f 7228 6665 6174  from_vector(feat
+00013170: 7572 656e 616d 6573 2c73 6f72 7465 6469  urenames,sortedi
+00013180: 7465 6d73 2c6d 6178 6b65 7977 6f72 6473  tems,maxkeywords
+00013190: 290d 0a23 2320 2020 2020 206b 6579 776f  )..##      keywo
+000131a0: 7264 733d 6a73 6f6e 2e64 756d 7073 286b  rds=json.dumps(k
+000131b0: 6579 776f 7264 7329 0d0a 2323 2020 2020  eywords)..##    
+000131c0: 2023 2070 7269 6e74 286b 6579 776f 7264   # print(keyword
+000131d0: 7329 0d0a 2323 2020 2020 2020 7265 7475  s)..##      retu
+000131e0: 726e 206b 6579 776f 7264 730d 0a23 230d  rn keywords..##.
+000131f0: 0a23 2364 6566 2074 7261 696e 626f 7728  .##def trainbow(
+00013200: 6466 2c63 6f6c 293a 0d0a 2323 2020 2020  df,col):..##    
+00013210: 2020 6d79 6c69 7374 3d64 665b 636f 6c5d    mylist=df[col]
+00013220: 2e74 6f6c 6973 7428 290d 0a23 2320 2020  .tolist()..##   
+00013230: 2020 2073 746f 7077 6f72 6473 3d67 6574     stopwords=get
+00013240: 5f73 746f 705f 776f 7264 7328 290d 0a23  _stop_words()..#
+00013250: 2320 2020 2020 2063 7620 3d20 436f 756e  #      cv = Coun
+00013260: 7456 6563 746f 7269 7a65 7228 7374 6f70  tVectorizer(stop
+00013270: 5f77 6f72 6473 3d73 746f 7077 6f72 6473  _words=stopwords
+00013280: 290d 0a23 2320 2020 2020 2074 7261 696e  )..##      train
+00013290: 5f62 6f77 203d 2063 762e 6669 745f 7472  _bow = cv.fit_tr
+000132a0: 616e 7366 6f72 6d28 6d79 6c69 7374 290d  ansform(mylist).
+000132b0: 0a23 2320 2020 2020 2023 7072 696e 7428  .##      #print(
+000132c0: 6c69 7374 2863 762e 766f 6361 6275 6c61  list(cv.vocabula
+000132d0: 7279 5f2e 6b65 7973 2829 2929 0d0a 2323  ry_.keys()))..##
+000132e0: 2020 2020 2020 7265 7475 726e 2063 762c        return cv,
+000132f0: 7472 6169 6e5f 626f 770d 0a23 230d 0a23  train_bow..##..#
+00013300: 2320 0d0a 2323 6465 6620 736f 7274 5f63  # ..##def sort_c
+00013310: 6f6f 2863 6f6f 5f6d 6174 7269 7829 3a0d  oo(coo_matrix):.
+00013320: 0a23 2320 2020 2074 7570 6c65 7320 3d20  .##    tuples = 
+00013330: 7a69 7028 636f 6f5f 6d61 7472 6978 2e63  zip(coo_matrix.c
+00013340: 6f6c 2c20 636f 6f5f 6d61 7472 6978 2e64  ol, coo_matrix.d
+00013350: 6174 6129 0d0a 2323 2020 2020 7265 7475  ata)..##    retu
+00013360: 726e 2073 6f72 7465 6428 7475 706c 6573  rn sorted(tuples
+00013370: 2c20 6b65 793d 6c61 6d62 6461 2078 3a20  , key=lambda x: 
+00013380: 2878 5b31 5d2c 2078 5b30 5d29 2c20 7265  (x[1], x[0]), re
+00013390: 7665 7273 653d 5472 7565 290d 0a23 230d  verse=True)..##.
+000133a0: 0a23 2364 6566 2065 7874 7261 6374 5f74  .##def extract_t
+000133b0: 6f70 6e5f 6672 6f6d 5f76 6563 746f 7228  opn_from_vector(
+000133c0: 6665 6174 7572 655f 6e61 6d65 732c 2073  feature_names, s
+000133d0: 6f72 7465 645f 6974 656d 732c 2074 6f70  orted_items, top
+000133e0: 6e3d 3130 293a 0d0a 2323 2020 2020 2222  n=10):..##    ""
+000133f0: 2267 6574 2074 6865 2066 6561 7475 7265  "get the feature
+00013400: 206e 616d 6573 2061 6e64 2074 662d 6964   names and tf-id
+00013410: 6620 7363 6f72 6520 6f66 2074 6f70 206e  f score of top n
+00013420: 2069 7465 6d73 2222 220d 0a23 2320 2020   items"""..##   
+00013430: 200d 0a23 2320 2020 2023 7573 6520 6f6e   ..##    #use on
+00013440: 6c79 2074 6f70 6e20 6974 656d 7320 6672  ly topn items fr
+00013450: 6f6d 2076 6563 746f 720d 0a23 2320 2020  om vector..##   
+00013460: 2073 6f72 7465 645f 6974 656d 7320 3d20   sorted_items = 
+00013470: 736f 7274 6564 5f69 7465 6d73 5b3a 746f  sorted_items[:to
+00013480: 706e 5d0d 0a23 230d 0a23 2320 2020 2073  pn]..##..##    s
+00013490: 636f 7265 5f76 616c 7320 3d20 5b5d 0d0a  core_vals = []..
+000134a0: 2323 2020 2020 6665 6174 7572 655f 7661  ##    feature_va
+000134b0: 6c73 203d 205b 5d0d 0a23 230d 0a23 2320  ls = []..##..## 
+000134c0: 2020 2066 6f72 2069 6478 2c20 7363 6f72     for idx, scor
+000134d0: 6520 696e 2073 6f72 7465 645f 6974 656d  e in sorted_item
+000134e0: 733a 2020 2020 2020 2020 0d0a 2323 2020  s:        ..##  
+000134f0: 2020 2020 2020 2020 666e 616d 6520 3d20          fname = 
+00013500: 6665 6174 7572 655f 6e61 6d65 735b 6964  feature_names[id
+00013510: 785d 0d0a 2323 2020 2020 2020 2020 2020  x]..##          
+00013520: 6966 206c 656e 2866 6e61 6d65 293e 333a  if len(fname)>3:
+00013530: 0d0a 2323 2020 2020 2020 2020 236b 6565  ..##        #kee
+00013540: 7020 7472 6163 6b20 6f66 2066 6561 7475  p track of featu
+00013550: 7265 206e 616d 6520 616e 6420 6974 7320  re name and its 
+00013560: 636f 7272 6573 706f 6e64 696e 6720 7363  corresponding sc
+00013570: 6f72 650d 0a23 2320 2020 2020 2020 2020  ore..##         
+00013580: 2020 2073 636f 7265 5f76 616c 732e 6170     score_vals.ap
+00013590: 7065 6e64 2872 6f75 6e64 2873 636f 7265  pend(round(score
+000135a0: 2c20 3329 290d 0a23 2320 2020 2020 2020  , 3))..##       
+000135b0: 2020 2020 2066 6561 7475 7265 5f76 616c       feature_val
+000135c0: 732e 6170 7065 6e64 2866 6561 7475 7265  s.append(feature
+000135d0: 5f6e 616d 6573 5b69 6478 5d29 0d0a 2323  _names[idx])..##
+000135e0: 0d0a 2323 2020 2020 2363 7265 6174 6520  ..##    #create 
+000135f0: 6120 7475 706c 6573 206f 6620 6665 6174  a tuples of feat
+00013600: 7572 652c 7363 6f72 650d 0a23 2320 2020  ure,score..##   
+00013610: 2023 7265 7375 6c74 7320 3d20 7a69 7028   #results = zip(
+00013620: 6665 6174 7572 655f 7661 6c73 2c73 636f  feature_vals,sco
+00013630: 7265 5f76 616c 7329 0d0a 2323 2020 2020  re_vals)..##    
+00013640: 7265 7375 6c74 733d 207b 7d0d 0a23 2320  results= {}..## 
+00013650: 2020 2066 6f72 2069 6478 2069 6e20 7261     for idx in ra
+00013660: 6e67 6528 6c65 6e28 6665 6174 7572 655f  nge(len(feature_
+00013670: 7661 6c73 2929 3a0d 0a23 2320 2020 2020  vals)):..##     
+00013680: 2020 2072 6573 756c 7473 5b66 6561 7475     results[featu
+00013690: 7265 5f76 616c 735b 6964 785d 5d3d 7363  re_vals[idx]]=sc
+000136a0: 6f72 655f 7661 6c73 5b69 6478 5d0d 0a23  ore_vals[idx]..#
+000136b0: 2320 2020 200d 0a23 2320 2020 2072 6574  #    ..##    ret
+000136c0: 7572 6e20 7265 7375 6c74 730d 0a23 230d  urn results..##.
+000136d0: 0a23 2364 6566 2067 6574 6b65 7977 6f72  .##def getkeywor
+000136e0: 6473 286d 7974 6578 742c 6d61 786b 6579  ds(mytext,maxkey
+000136f0: 776f 7264 7329 3a0d 0a23 2320 2020 2072  words):..##    r
+00013700: 3d52 616b 6528 6d61 785f 6c65 6e67 7468  =Rake(max_length
+00013710: 3d31 3029 0d0a 2323 2020 2020 7220 3d20  =10)..##    r = 
+00013720: 5261 6b65 2872 616e 6b69 6e67 5f6d 6574  Rake(ranking_met
+00013730: 7269 633d 4d65 7472 6963 2e44 4547 5245  ric=Metric.DEGRE
+00013740: 455f 544f 5f46 5245 5155 454e 4359 5f52  E_TO_FREQUENCY_R
+00013750: 4154 494f 290d 0a23 2320 2020 2023 7220  ATIO)..##    #r 
+00013760: 3d20 5261 6b65 2872 616e 6b69 6e67 5f6d  = Rake(ranking_m
+00013770: 6574 7269 633d 4d65 7472 6963 2e57 4f52  etric=Metric.WOR
+00013780: 445f 4445 4752 4545 290d 0a23 2320 2020  D_DEGREE)..##   
+00013790: 2023 7220 3d20 5261 6b65 2872 616e 6b69   #r = Rake(ranki
+000137a0: 6e67 5f6d 6574 7269 633d 4d65 7472 6963  ng_metric=Metric
+000137b0: 2e57 4f52 445f 4652 4551 5545 4e43 5929  .WORD_FREQUENCY)
+000137c0: 0d0a 2323 2020 2020 643d 7b27 696e 7075  ..##    d={'inpu
+000137d0: 7427 3a5b 6d79 7465 7874 5d7d 0d0a 2323  t':[mytext]}..##
+000137e0: 2020 2020 6466 203d 2070 642e 4461 7461      df = pd.Data
+000137f0: 4672 616d 6528 6429 0d0a 2323 2020 2020  Frame(d)..##    
+00013800: 6466 3d63 6f6e 7665 7274 746f 6c6f 7765  df=converttolowe
+00013810: 7263 6173 6528 6466 2c27 696e 7075 7427  rcase(df,'input'
+00013820: 290d 0a23 2320 2020 2064 663d 7265 6d6f  )..##    df=remo
+00013830: 7665 7075 6e63 7475 6174 696f 6e28 6466  vepunctuation(df
+00013840: 2c27 696e 7075 7427 290d 0a23 2320 2020  ,'input')..##   
+00013850: 2064 663d 7265 6d6f 7665 7374 6f70 776f   df=removestopwo
+00013860: 7264 7328 6466 2c27 696e 7075 7427 290d  rds(df,'input').
+00013870: 0a23 2320 2020 2064 663d 7265 6d6f 7665  .##    df=remove
+00013880: 636f 6d6d 6f6e 776f 7264 7328 6466 2c27  commonwords(df,'
+00013890: 696e 7075 7427 290d 0a23 2320 2020 2064  input')..##    d
+000138a0: 663d 7265 6d6f 7665 7261 7265 776f 7264  f=removerareword
+000138b0: 7328 6466 2c27 696e 7075 7427 290d 0a23  s(df,'input')..#
+000138c0: 2320 2020 2064 663d 636f 7272 6563 7473  #    df=corrects
+000138d0: 7065 6c6c 696e 6728 6466 2c27 696e 7075  pelling(df,'inpu
+000138e0: 7427 290d 0a23 2320 2020 2064 663d 6c65  t')..##    df=le
+000138f0: 6d6d 6174 697a 6174 696f 6e28 6466 2c27  mmatization(df,'
+00013900: 696e 7075 7427 290d 0a23 2320 2020 206d  input')..##    m
+00013910: 7974 6578 743d 6466 5b27 696e 7075 7427  ytext=df['input'
+00013920: 5d5b 305d 0d0a 2323 2020 2020 6376 2c74  ][0]..##    cv,t
+00013930: 773d 7472 6169 6e62 6f77 2864 662c 2769  w=trainbow(df,'i
+00013940: 6e70 7574 2729 0d0a 2323 2020 2020 6b65  nput')..##    ke
+00013950: 7977 6f72 6473 3d74 7261 696e 7665 6374  ywords=trainvect
+00013960: 2863 762c 7477 2c64 662c 2769 6e70 7574  (cv,tw,df,'input
+00013970: 272c 6d61 786b 6579 776f 7264 7329 0d0a  ',maxkeywords)..
+00013980: 2323 0d0a 2323 2020 2020 0d0a 2323 2020  ##..##    ..##  
+00013990: 2020 6b65 7962 7566 203d 2022 220d 0a23    keybuf = ""..#
+000139a0: 2320 2020 206b 6a73 6f6e 203d 206a 736f  #    kjson = jso
+000139b0: 6e2e 6c6f 6164 7328 6b65 7977 6f72 6473  n.loads(keywords
+000139c0: 290d 0a23 2320 2020 2066 6f72 206b 6579  )..##    for key
+000139d0: 2c20 7661 6c75 6520 696e 206b 6a73 6f6e  , value in kjson
+000139e0: 2e69 7465 6d73 2829 3a0d 0a23 2320 2020  .items():..##   
+000139f0: 2020 2020 206b 6579 6275 6620 3d20 6b65       keybuf = ke
+00013a00: 7962 7566 202b 206b 6579 202b 222c 2220  ybuf + key +"," 
+00013a10: 2b20 7374 7228 7661 6c75 6529 202b 2022  + str(value) + "
+00013a20: 3a22 0d0a 2323 2020 2020 6b65 7962 7566  :"..##    keybuf
+00013a30: 203d 206b 6579 6275 665b 3a2d 315d 0d0a   = keybuf[:-1]..
+00013a40: 2323 0d0a 2323 2020 2020 7265 7475 726e  ##..##    return
+00013a50: 206b 6579 6275 660d 0a23 2320 0d0a 2323   keybuf..## ..##
+00013a60: 6465 6620 646f 7375 6d6d 6172 7928 6172  def dosummary(ar
+00013a70: 7469 636c 655f 7465 7874 2c69 293a 0d0a  ticle_text,i):..
+00013a80: 2323 0d0a 2323 0d0a 2323 2020 2020 6172  ##..##..##    ar
+00013a90: 7469 636c 655f 7465 7874 203d 2072 652e  ticle_text = re.
+00013aa0: 7375 6228 7227 5c5b 5b30 2d39 5d2a 5c5d  sub(r'\[[0-9]*\]
+00013ab0: 272c 2027 2027 2c20 6172 7469 636c 655f  ', ' ', article_
+00013ac0: 7465 7874 2920 200d 0a23 2320 2020 2061  text)  ..##    a
+00013ad0: 7274 6963 6c65 5f74 6578 7420 3d20 7265  rticle_text = re
+00013ae0: 2e73 7562 2872 275c 732b 272c 2027 2027  .sub(r'\s+', ' '
+00013af0: 2c20 6172 7469 636c 655f 7465 7874 290d  , article_text).
+00013b00: 0a23 230d 0a23 2320 2020 2023 2052 656d  .##..##    # Rem
+00013b10: 6f76 696e 6720 7370 6563 6961 6c20 6368  oving special ch
+00013b20: 6172 6163 7465 7273 2061 6e64 2064 6967  aracters and dig
+00013b30: 6974 730d 0a23 2320 2020 2066 6f72 6d61  its..##    forma
+00013b40: 7474 6564 5f61 7274 6963 6c65 5f74 6578  tted_article_tex
+00013b50: 7420 3d20 7265 2e73 7562 2827 5b5e 612d  t = re.sub('[^a-
+00013b60: 7a41 2d5a 5d27 2c20 2720 272c 2061 7274  zA-Z]', ' ', art
+00013b70: 6963 6c65 5f74 6578 7420 2920 200d 0a23  icle_text )  ..#
+00013b80: 2320 2020 2066 6f72 6d61 7474 6564 5f61  #    formatted_a
+00013b90: 7274 6963 6c65 5f74 6578 7420 3d20 7265  rticle_text = re
+00013ba0: 2e73 7562 2872 275c 732b 272c 2027 2027  .sub(r'\s+', ' '
+00013bb0: 2c20 666f 726d 6174 7465 645f 6172 7469  , formatted_arti
+00013bc0: 636c 655f 7465 7874 2920 200d 0a23 230d  cle_text)  ..##.
+00013bd0: 0a23 2320 2020 2073 656e 7465 6e63 655f  .##    sentence_
+00013be0: 6c69 7374 203d 206e 6c74 6b2e 7365 6e74  list = nltk.sent
+00013bf0: 5f74 6f6b 656e 697a 6528 6172 7469 636c  _tokenize(articl
+00013c00: 655f 7465 7874 2920 200d 0a23 2320 2020  e_text)  ..##   
+00013c10: 2023 7072 696e 7428 7365 6e74 656e 6365   #print(sentence
+00013c20: 5f6c 6973 7429 0d0a 2323 0d0a 2323 2020  _list)..##..##  
+00013c30: 2020 7374 6f70 776f 7264 7320 3d20 6e6c    stopwords = nl
+00013c40: 746b 2e63 6f72 7075 732e 7374 6f70 776f  tk.corpus.stopwo
+00013c50: 7264 732e 776f 7264 7328 2765 6e67 6c69  rds.words('engli
+00013c60: 7368 2729 0d0a 2323 0d0a 2323 2020 2020  sh')..##..##    
+00013c70: 776f 7264 5f66 7265 7175 656e 6369 6573  word_frequencies
+00013c80: 203d 207b 7d20 200d 0a23 2320 2020 2066   = {}  ..##    f
+00013c90: 6f72 2077 6f72 6420 696e 206e 6c74 6b2e  or word in nltk.
+00013ca0: 776f 7264 5f74 6f6b 656e 697a 6528 666f  word_tokenize(fo
+00013cb0: 726d 6174 7465 645f 6172 7469 636c 655f  rmatted_article_
+00013cc0: 7465 7874 293a 2020 0d0a 2323 2020 2020  text):  ..##    
+00013cd0: 2020 2020 6966 2077 6f72 6420 6e6f 7420      if word not 
+00013ce0: 696e 2073 746f 7077 6f72 6473 3a0d 0a23  in stopwords:..#
+00013cf0: 2320 2020 2020 2020 2020 2020 2069 6620  #            if 
+00013d00: 776f 7264 206e 6f74 2069 6e20 776f 7264  word not in word
+00013d10: 5f66 7265 7175 656e 6369 6573 2e6b 6579  _frequencies.key
+00013d20: 7328 293a 0d0a 2323 2020 2020 2020 2020  s():..##        
+00013d30: 2020 2020 2020 2020 776f 7264 5f66 7265          word_fre
+00013d40: 7175 656e 6369 6573 5b77 6f72 645d 203d  quencies[word] =
+00013d50: 2031 0d0a 2323 2020 2020 2020 2020 2020   1..##          
+00013d60: 2020 656c 7365 3a0d 0a23 2320 2020 2020    else:..##     
+00013d70: 2020 2020 2020 2020 2020 2077 6f72 645f             word_
+00013d80: 6672 6571 7565 6e63 6965 735b 776f 7264  frequencies[word
+00013d90: 5d20 2b3d 2031 0d0a 2323 0d0a 2323 2020  ] += 1..##..##  
+00013da0: 2020 6d61 7869 6d75 6d5f 6672 6571 756e    maximum_frequn
+00013db0: 6379 203d 206d 6178 2877 6f72 645f 6672  cy = max(word_fr
+00013dc0: 6571 7565 6e63 6965 732e 7661 6c75 6573  equencies.values
+00013dd0: 2829 290d 0a23 230d 0a23 2320 2020 2066  ())..##..##    f
+00013de0: 6f72 2077 6f72 6420 696e 2077 6f72 645f  or word in word_
+00013df0: 6672 6571 7565 6e63 6965 732e 6b65 7973  frequencies.keys
+00013e00: 2829 3a20 200d 0a23 2320 2020 2020 2020  ():  ..##       
+00013e10: 2077 6f72 645f 6672 6571 7565 6e63 6965   word_frequencie
+00013e20: 735b 776f 7264 5d20 3d20 2877 6f72 645f  s[word] = (word_
+00013e30: 6672 6571 7565 6e63 6965 735b 776f 7264  frequencies[word
+00013e40: 5d2f 6d61 7869 6d75 6d5f 6672 6571 756e  ]/maximum_frequn
+00013e50: 6379 290d 0a23 230d 0a23 2320 2020 2023  cy)..##..##    #
+00013e60: 7072 696e 7428 776f 7264 5f66 7265 7175  print(word_frequ
+00013e70: 656e 6369 6573 290d 0a23 230d 0a23 2320  encies)..##..## 
+00013e80: 2020 2073 656e 7465 6e63 655f 7363 6f72     sentence_scor
+00013e90: 6573 203d 207b 7d20 200d 0a23 2320 2020  es = {}  ..##   
+00013ea0: 2066 6f72 2073 656e 7420 696e 2073 656e   for sent in sen
+00013eb0: 7465 6e63 655f 6c69 7374 3a20 200d 0a23  tence_list:  ..#
+00013ec0: 2320 2020 2020 2020 2066 6f72 2077 6f72  #        for wor
+00013ed0: 6420 696e 206e 6c74 6b2e 776f 7264 5f74  d in nltk.word_t
+00013ee0: 6f6b 656e 697a 6528 7365 6e74 2e6c 6f77  okenize(sent.low
+00013ef0: 6572 2829 293a 0d0a 2323 2020 2020 2020  er()):..##      
+00013f00: 2020 2020 2020 6966 2077 6f72 6420 696e        if word in
+00013f10: 2077 6f72 645f 6672 6571 7565 6e63 6965   word_frequencie
+00013f20: 732e 6b65 7973 2829 3a0d 0a23 2320 2020  s.keys():..##   
+00013f30: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00013f40: 6c65 6e28 7365 6e74 2e73 706c 6974 2827  len(sent.split('
+00013f50: 2027 2929 203c 2032 353a 0d0a 2323 2020   ')) < 25:..##  
+00013f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f70: 2020 6966 2073 656e 7420 6e6f 7420 696e    if sent not in
+00013f80: 2073 656e 7465 6e63 655f 7363 6f72 6573   sentence_scores
+00013f90: 2e6b 6579 7328 293a 0d0a 2323 2020 2020  .keys():..##    
+00013fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013fb0: 2020 2020 7365 6e74 656e 6365 5f73 636f      sentence_sco
+00013fc0: 7265 735b 7365 6e74 5d20 3d20 776f 7264  res[sent] = word
+00013fd0: 5f66 7265 7175 656e 6369 6573 5b77 6f72  _frequencies[wor
+00013fe0: 645d 0d0a 2323 2020 2020 2020 2020 2020  d]..##          
+00013ff0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00014000: 0a23 2320 2020 2020 2020 2020 2020 2020  .##             
+00014010: 2020 2020 2020 2020 2020 2073 656e 7465             sente
+00014020: 6e63 655f 7363 6f72 6573 5b73 656e 745d  nce_scores[sent]
+00014030: 202b 3d20 776f 7264 5f66 7265 7175 656e   += word_frequen
+00014040: 6369 6573 5b77 6f72 645d 0d0a 2323 0d0a  cies[word]..##..
+00014050: 2323 2020 2020 2370 7269 6e74 2873 656e  ##    #print(sen
+00014060: 7465 6e63 655f 7363 6f72 6573 290d 0a23  tence_scores)..#
+00014070: 230d 0a23 2320 2020 2073 756d 6d61 7279  #..##    summary
+00014080: 5f73 656e 7465 6e63 6573 203d 2068 6561  _sentences = hea
+00014090: 7071 2e6e 6c61 7267 6573 7428 692c 2073  pq.nlargest(i, s
+000140a0: 656e 7465 6e63 655f 7363 6f72 6573 2c20  entence_scores, 
+000140b0: 6b65 793d 7365 6e74 656e 6365 5f73 636f  key=sentence_sco
+000140c0: 7265 732e 6765 7429 0d0a 2323 2020 2020  res.get)..##    
+000140d0: 2370 7269 6e74 2873 756d 6d61 7279 5f73  #print(summary_s
+000140e0: 656e 7465 6e63 6573 290d 0a23 2320 2020  entences)..##   
+000140f0: 2073 756d 6d61 7279 203d 2027 2027 2e6a   summary = ' '.j
+00014100: 6f69 6e28 7375 6d6d 6172 795f 7365 6e74  oin(summary_sent
+00014110: 656e 6365 7329 0d0a 2323 2020 2020 2370  ences)..##    #p
+00014120: 7269 6e74 2822 4149 2053 756d 6d61 7279  rint("AI Summary
+00014130: 2229 0d0a 2323 2020 2020 7265 7475 726e  ")..##    return
+00014140: 2073 756d 6d61 7279 0d0a 2323 0d0a 2323   summary..##..##
+00014150: 6465 6620 7374 6172 7473 756d 6d61 7279  def startsummary
+00014160: 2861 7274 6963 6c65 5f74 6578 742c 6676  (article_text,fv
+00014170: 616c 7565 2c6d 6178 6b65 7977 6f72 6473  alue,maxkeywords
+00014180: 293a 0d0a 2323 2020 2020 2020 0d0a 2323  ):..##      ..##
+00014190: 2023 2074 7279 3a0d 0a23 2320 2020 6f72   # try:..##   or
+000141a0: 6967 696e 616c 776f 7264 7320 3d20 6c65  iginalwords = le
+000141b0: 6e28 6172 7469 636c 655f 7465 7874 2e73  n(article_text.s
+000141c0: 706c 6974 2822 2022 2929 0d0a 2323 0d0a  plit(" "))..##..
+000141d0: 2323 2020 2066 6f72 2069 2069 6e20 7261  ##   for i in ra
+000141e0: 6e67 6528 312c 3130 3030 3029 3a0d 0a23  nge(1,10000):..#
+000141f0: 2320 2020 2020 7375 6d6d 6172 793d 646f  #     summary=do
+00014200: 7375 6d6d 6172 7928 6172 7469 636c 655f  summary(article_
+00014210: 7465 7874 2c69 290d 0a23 2320 2020 2020  text,i)..##     
+00014220: 7265 7320 3d20 6c65 6e28 7375 6d6d 6172  res = len(summar
+00014230: 792e 7370 6c69 7428 2929 0d0a 2323 2020  y.split())..##  
+00014240: 2020 2069 6620 7265 7320 3e3d 2066 7661     if res >= fva
+00014250: 6c75 653a 0d0a 2323 2020 2020 2020 2020  lue:..##        
+00014260: 2062 7265 616b 0d0a 2323 0d0a 2323 2020   break..##..##  
+00014270: 2073 756d 6d61 7279 203d 2020 7265 2e73   summary =  re.s
+00014280: 7562 2822 5c5c 5c5c 785b 612d 6630 2d39  ub("\\\\x[a-f0-9
+00014290: 5d5b 612d 6630 2d39 5d22 2c20 2220 222c  ][a-f0-9]", " ",
+000142a0: 7375 6d6d 6172 7929 0d0a 2323 2020 2073  summary)..##   s
+000142b0: 756d 6d61 7279 203d 2072 652e 7375 6228  ummary = re.sub(
+000142c0: 225c 5c78 6532 5c5c 7838 305c 5c78 3939  "\\xe2\\x80\\x99
+000142d0: 222c 2227 222c 2073 756d 6d61 7279 290d  ","'", summary).
+000142e0: 0a23 2320 2020 7375 6d6d 6172 793d 7375  .##   summary=su
+000142f0: 6d6d 6172 792e 7265 706c 6163 6528 225c  mmary.replace("\
+00014300: 5c78 6532 5c5c 7838 305c 5c78 3939 222c  \xe2\\x80\\x99",
+00014310: 2227 2229 0d0a 2323 2020 2073 756d 6d61  "'")..##   summa
+00014320: 7279 3d73 756d 6d61 7279 2e72 6570 6c61  ry=summary.repla
+00014330: 6365 2822 5c5c 7865 325c 5c78 3830 5c5c  ce("\\xe2\\x80\\
+00014340: 7839 3022 2c22 2d22 290d 0a23 2320 2020  x90","-")..##   
+00014350: 7375 6d6d 6172 793d 7375 6d6d 6172 792e  summary=summary.
+00014360: 7265 706c 6163 6528 225c 5c78 6532 5c5c  replace("\\xe2\\
+00014370: 7838 305c 5c78 3931 222c 222d 2229 0d0a  x80\\x91","-")..
+00014380: 2323 2020 2073 756d 6d61 7279 3d73 756d  ##   summary=sum
+00014390: 6d61 7279 2e72 6570 6c61 6365 2822 5c5c  mary.replace("\\
+000143a0: 7865 325c 5c78 3830 5c5c 7839 3222 2c22  xe2\\x80\\x92","
+000143b0: 2d22 290d 0a23 2320 2020 7375 6d6d 6172  -")..##   summar
+000143c0: 793d 7375 6d6d 6172 792e 7265 706c 6163  y=summary.replac
+000143d0: 6528 225c 5c78 6532 5c5c 7838 305c 5c78  e("\\xe2\\x80\\x
+000143e0: 3933 222c 222d 2229 0d0a 2323 2020 2073  93","-")..##   s
+000143f0: 756d 6d61 7279 3d73 756d 6d61 7279 2e72  ummary=summary.r
+00014400: 6570 6c61 6365 2822 5c5c 7865 325c 5c78  eplace("\\xe2\\x
+00014410: 3830 5c5c 7839 3422 2c22 2d22 290d 0a23  80\\x94","-")..#
+00014420: 2320 2020 7375 6d6d 6172 793d 7375 6d6d  #   summary=summ
+00014430: 6172 792e 7265 706c 6163 6528 225c 5c78  ary.replace("\\x
+00014440: 6532 5c5c 7838 305c 5c78 3935 222c 222d  e2\\x80\\x95","-
+00014450: 2229 0d0a 2323 2020 2073 756d 6d61 7279  ")..##   summary
+00014460: 3d73 756d 6d61 7279 2e72 6570 6c61 6365  =summary.replace
+00014470: 2822 5c5c 7865 325c 5c78 3830 5c5c 7862  ("\\xe2\\x80\\xb
+00014480: 3322 2c27 2227 290d 0a23 2320 2020 7375  3",'"')..##   su
+00014490: 6d6d 6172 7920 3d20 7375 6d6d 6172 792e  mmary = summary.
+000144a0: 7265 706c 6163 6528 27e2 809c 272c 2027  replace('...', '
+000144b0: 2227 290d 0a23 2320 2020 7375 6d6d 6172  "')..##   summar
+000144c0: 7920 3d20 7375 6d6d 6172 792e 7265 706c  y = summary.repl
+000144d0: 6163 6528 27e2 809d 272c 2027 2227 290d  ace('...', '"').
+000144e0: 0a23 2320 2020 7375 6d6d 6172 7920 3d20  .##   summary = 
+000144f0: 7375 6d6d 6172 792e 7265 706c 6163 6528  summary.replace(
+00014500: 27e2 8099 272c 2022 2722 290d 0a23 2320  '...', "'")..## 
+00014510: 2020 7375 6d6d 6172 7920 3d20 7375 6d6d    summary = summ
+00014520: 6172 792e 7265 706c 6163 6528 27e2 8098  ary.replace('...
+00014530: 272c 2022 2722 290d 0a23 2320 2020 7375  ', "'")..##   su
+00014540: 6d6d 6172 7920 3d20 7375 6d6d 6172 792e  mmary = summary.
+00014550: 7265 706c 6163 6528 27e2 8093 272c 2022  replace('...', "
+00014560: 2d22 290d 0a23 2320 2020 7375 6d6d 6172  -")..##   summar
+00014570: 7920 3d20 7375 6d6d 6172 792e 7265 706c  y = summary.repl
+00014580: 6163 6528 27e2 80a6 272c 2022 2e2e 2e22  ace('...', "..."
+00014590: 290d 0a23 2320 2020 7375 6d6d 6172 7920  )..##   summary 
+000145a0: 3d20 7375 6d6d 6172 792e 7265 706c 6163  = summary.replac
+000145b0: 6528 27e2 8094 272c 2022 2d22 290d 0a23  e('...', "-")..#
+000145c0: 2320 2020 7375 6d6d 6172 7920 3d20 7375  #   summary = su
+000145d0: 6d6d 6172 792e 7265 706c 6163 6528 2722  mmary.replace('"
+000145e0: 272c 2022 2229 0d0a 2323 0d0a 2323 2020  ', "")..##..##  
+000145f0: 2073 756d 6d61 7279 203d 2073 756d 6d61   summary = summa
+00014600: 7279 2e72 6570 6c61 6365 2827 5c5c 7527  ry.replace('\\u'
+00014610: 2c27 552b 2729 0d0a 2323 2020 2073 756d  ,'U+')..##   sum
+00014620: 6d61 7279 203d 2072 652e 7375 6228 7227  mary = re.sub(r'
+00014630: 3c55 5c2b 285b 302d 3961 2d66 412d 465d  <U\+([0-9a-fA-F]
+00014640: 7b34 2c36 7d29 3e27 2c20 6c61 6d62 6461  {4,6})>', lambda
+00014650: 2078 3a20 6368 7228 696e 7428 782e 6772   x: chr(int(x.gr
+00014660: 6f75 7028 3129 2c31 3629 292c 2073 756d  oup(1),16)), sum
+00014670: 6d61 7279 290d 0a23 230d 0a23 2320 2020  mary)..##..##   
+00014680: 6b65 7977 6f72 6473 3d67 6574 6b65 7977  keywords=getkeyw
+00014690: 6f72 6473 2873 756d 6d61 7279 2c6d 6178  ords(summary,max
+000146a0: 6b65 7977 6f72 6473 290d 0a23 230d 0a23  keywords)..##..#
+000146b0: 2320 2020 7375 6d6d 6172 7977 6f72 6473  #   summarywords
+000146c0: 203d 206c 656e 2873 756d 6d61 7279 2e73   = len(summary.s
+000146d0: 706c 6974 2822 2022 2929 0d0a 2323 200d  plit(" "))..## .
+000146e0: 0a23 2320 2020 6d61 696e 6f75 743d 225c  .##   mainout="\
+000146f0: 2222 202b 206b 6579 776f 7264 7320 2b20  "" + keywords + 
+00014700: 225c 222c 5c22 6f72 6967 696e 616c 776f  "\",\"originalwo
+00014710: 7264 636f 756e 745c 223a 2220 2b20 7374  rdcount\":" + st
+00014720: 7228 6f72 6967 696e 616c 776f 7264 7329  r(originalwords)
+00014730: 202b 2022 2c5c 2273 756d 6d61 7279 776f   + ",\"summarywo
+00014740: 7264 636f 756e 745c 223a 222b 2073 7472  rdcount\":"+ str
+00014750: 2873 756d 6d61 7279 776f 7264 7329 202b  (summarywords) +
+00014760: 222c 5c22 6d61 696e 7375 6d6d 6172 795c  ",\"mainsummary\
+00014770: 223a 7b5c 2273 756d 6d61 7279 5c22 3a20  ":{\"summary\": 
+00014780: 5c22 2220 2b20 7375 6d6d 6172 7920 2b20  \"" + summary + 
+00014790: 225c 227d 7d22 0d0a 2323 2020 2072 6574  "\"}}"..##   ret
+000147a0: 7572 6e20 6d61 696e 6f75 740d 0a23 2320  urn mainout..## 
+000147b0: 2020 0d0a 2323 2323 2323 2323 2323 2323    ..############
+000147c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000147d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000147e0: 2323 2323 2323 230d 0a23 230d 0a23 2366  #######..##..##f
+000147f0: 726f 6d20 6c61 6e67 6368 6169 6e2e 656d  rom langchain.em
+00014800: 6265 6464 696e 6773 2e6f 7065 6e61 6920  beddings.openai 
+00014810: 696d 706f 7274 204f 7065 6e41 4945 6d62  import OpenAIEmb
+00014820: 6564 6469 6e67 730d 0a23 2366 726f 6d20  eddings..##from 
+00014830: 6c61 6e67 6368 6169 6e2e 7465 7874 5f73  langchain.text_s
+00014840: 706c 6974 7465 7220 696d 706f 7274 2043  plitter import C
+00014850: 6861 7261 6374 6572 5465 7874 5370 6c69  haracterTextSpli
+00014860: 7474 6572 0d0a 2323 6672 6f6d 206c 616e  tter..##from lan
+00014870: 6763 6861 696e 2e76 6563 746f 7273 746f  gchain.vectorsto
+00014880: 7265 732e 6661 6973 7320 696d 706f 7274  res.faiss import
+00014890: 2046 4149 5353 0d0a 2323 0d0a 2323 6672   FAISS..##..##fr
+000148a0: 6f6d 206c 616e 6763 6861 696e 2e63 6861  om langchain.cha
+000148b0: 696e 732e 7175 6573 7469 6f6e 5f61 6e73  ins.question_ans
+000148c0: 7765 7269 6e67 2069 6d70 6f72 7420 6c6f  wering import lo
+000148d0: 6164 5f71 615f 6368 6169 6e0d 0a23 2366  ad_qa_chain..##f
+000148e0: 726f 6d20 6c61 6e67 6368 6169 6e2e 6c6c  rom langchain.ll
+000148f0: 6d73 2069 6d70 6f72 7420 5072 6f6d 7074  ms import Prompt
+00014900: 4c61 7965 724f 7065 6e41 4943 6861 740d  LayerOpenAIChat.
+00014910: 0a23 2366 726f 6d20 6c61 6e67 6368 6169  .##from langchai
+00014920: 6e2e 6368 6174 5f6d 6f64 656c 7320 696d  n.chat_models im
+00014930: 706f 7274 2043 6861 744f 7065 6e41 490d  port ChatOpenAI.
+00014940: 0a23 2366 726f 6d20 6c61 6e67 6368 6169  .##from langchai
+00014950: 6e2e 6c6c 6d73 2069 6d70 6f72 7420 4f70  n.llms import Op
+00014960: 656e 4149 0d0a 2323 696d 706f 7274 2068  enAI..##import h
+00014970: 6173 686c 6962 0d0a 2323 0d0a 2323 2320  ashlib..##..### 
+00014980: 416e 7377 6572 2071 7565 7374 696f 6e73  Answer questions
+00014990: 2061 626f 7574 2074 6865 2068 6561 646c   about the headl
+000149a0: 696e 6573 0d0a 2323 6465 6620 7374 6172  ines..##def star
+000149b0: 745f 636f 6e76 6572 7361 7469 6f6e 286f  t_conversation(o
+000149c0: 7065 6e61 696b 6579 2c71 7565 7279 2c74  penaikey,query,t
+000149d0: 6578 742c 7465 6d70 6572 6174 7572 652c  ext,temperature,
+000149e0: 6d6f 6465 6c29 3a0d 0a23 2320 2020 2023  model):..##    #
+000149f0: 2047 7261 6220 7468 6520 696e 7075 7420   Grab the input 
+00014a00: 6672 6f6d 2074 6865 2041 5049 0d0a 2323  from the API..##
+00014a10: 2020 2020 2020 2020 2371 7565 7279 203d          #query =
+00014a20: 2069 6e70 7574 735b 2271 7565 7279 220d   inputs["query".
+00014a30: 0a23 230d 0a23 230d 0a23 2320 2020 2020  .##..##..##     
+00014a40: 2020 2074 6578 745f 7370 6c69 7474 6572     text_splitter
+00014a50: 203d 2043 6861 7261 6374 6572 5465 7874   = CharacterText
+00014a60: 5370 6c69 7474 6572 280d 0a23 2320 2020  Splitter(..##   
+00014a70: 2020 2020 2020 2020 2073 6570 6172 6174           separat
+00014a80: 6f72 3d22 2022 2c0d 0a23 2320 2020 2020  or=" ",..##     
+00014a90: 2020 2020 2020 2063 6875 6e6b 5f73 697a         chunk_siz
+00014aa0: 653d 3130 3030 2c0d 0a23 2320 2020 2020  e=1000,..##     
+00014ab0: 2020 2020 2020 2063 6875 6e6b 5f6f 7665         chunk_ove
+00014ac0: 726c 6170 3d32 3030 2c0d 0a23 2320 2020  rlap=200,..##   
+00014ad0: 2020 2020 2020 2020 206c 656e 6774 685f           length_
+00014ae0: 6675 6e63 7469 6f6e 3d6c 656e 2c0d 0a23  function=len,..#
+00014af0: 2320 2020 2020 2020 2029 0d0a 2323 0d0a  #        )..##..
+00014b00: 2323 2020 2020 2020 2020 7465 7874 7320  ##        texts 
+00014b10: 3d20 7465 7874 5f73 706c 6974 7465 722e  = text_splitter.
+00014b20: 7370 6c69 745f 7465 7874 2874 6578 7429  split_text(text)
+00014b30: 0d0a 2323 2020 2020 2020 2020 656d 6265  ..##        embe
+00014b40: 6464 696e 6773 203d 204f 7065 6e41 4945  ddings = OpenAIE
+00014b50: 6d62 6564 6469 6e67 7328 290d 0a23 2320  mbeddings()..## 
+00014b60: 2020 2020 2020 2064 6f63 7365 6172 6368         docsearch
+00014b70: 203d 2046 4149 5353 2e66 726f 6d5f 7465   = FAISS.from_te
+00014b80: 7874 7328 7465 7874 732c 2065 6d62 6564  xts(texts, embed
+00014b90: 6469 6e67 7329 0d0a 2323 2020 2020 2020  dings)..##      
+00014ba0: 2020 646f 6373 203d 2064 6f63 7365 6172    docs = docsear
+00014bb0: 6368 2e73 696d 696c 6172 6974 795f 7365  ch.similarity_se
+00014bc0: 6172 6368 2871 7565 7279 290d 0a23 2320  arch(query)..## 
+00014bd0: 2020 2020 2020 200d 0a23 2320 2020 2020         ..##     
+00014be0: 2020 2063 6861 696e 203d 206c 6f61 645f     chain = load_
+00014bf0: 7161 5f63 6861 696e 284f 7065 6e41 4928  qa_chain(OpenAI(
+00014c00: 6d6f 6465 6c5f 6e61 6d65 3d6d 6f64 656c  model_name=model
+00014c10: 2c20 7465 6d70 6572 6174 7572 653d 7465  , temperature=te
+00014c20: 6d70 6572 6174 7572 652c 6f70 656e 6169  mperature,openai
+00014c30: 5f61 7069 5f6b 6579 3d6f 7065 6e61 696b  _api_key=openaik
+00014c40: 6579 292c 2063 6861 696e 5f74 7970 653d  ey), chain_type=
+00014c50: 2273 7475 6666 2229 0d0a 2323 2020 2020  "stuff")..##    
+00014c60: 2020 2020 7265 7320 3d20 6368 6169 6e28      res = chain(
+00014c70: 7b22 696e 7075 745f 646f 6375 6d65 6e74  {"input_document
+00014c80: 7322 3a20 646f 6373 2c20 2271 7565 7374  s": docs, "quest
+00014c90: 696f 6e22 3a20 7175 6572 797d 2c20 7265  ion": query}, re
+00014ca0: 7475 726e 5f6f 6e6c 795f 6f75 7470 7574  turn_only_output
+00014cb0: 733d 5472 7565 290d 0a23 230d 0a23 2320  s=True)..##..## 
+00014cc0: 2020 2020 2020 2023 7265 7475 726e 207b         #return {
+00014cd0: 2270 7265 6422 3a20 7265 737d 0d0a 2323  "pred": res}..##
+00014ce0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00014cf0: 6573 0d0a 2323 0d0a 2323 2323 2323 2323  es..##..########
+00014d00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014d10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014d20: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00014d30: 2323 6672 6f6d 2070 6466 7175 6572 7920  ##from pdfquery 
+00014d40: 696d 706f 7274 2050 4446 5175 6572 790d  import PDFQuery.
+00014d50: 0a23 2369 6d70 6f72 7420 786d 6c74 6f64  .##import xmltod
+00014d60: 6963 740d 0a23 230d 0a23 230d 0a23 2364  ict..##..##..##d
+00014d70: 6566 206c 6162 656c 6669 656c 6473 2866  ef labelfields(f
+00014d80: 696c 656e 616d 652c 6c61 6265 6c6e 616d  ilename,labelnam
+00014d90: 652c 6163 726f 7479 7065 293a 0d0a 2323  e,acrotype):..##
+00014da0: 2020 2020 2070 6466 203d 2050 4446 5175       pdf = PDFQu
+00014db0: 6572 7928 6669 6c65 6e61 6d65 290d 0a23  ery(filename)..#
+00014dc0: 2320 2020 2020 7064 662e 6c6f 6164 2829  #     pdf.load()
+00014dd0: 0d0a 2323 2020 2020 2023 4c54 5465 7874  ..##     #LTText
+00014de0: 4c69 6e65 486f 7269 7a6f 6e74 616c 0d0a  LineHorizontal..
+00014df0: 2323 2020 2020 206c 6162 656c 203d 2070  ##     label = p
+00014e00: 6466 2e70 7128 6163 726f 7479 7065 2b27  df.pq(acrotype+'
+00014e10: 3a63 6f6e 7461 696e 7328 2227 2b6c 6162  :contains("'+lab
+00014e20: 656c 6e61 6d65 202b 2027 2229 2729 0d0a  elname + '")')..
+00014e30: 2323 2020 2020 206c 6566 745f 636f 726e  ##     left_corn
+00014e40: 6572 203d 2066 6c6f 6174 286c 6162 656c  er = float(label
+00014e50: 2e61 7474 7228 2778 3027 2929 0d0a 2323  .attr('x0'))..##
+00014e60: 2020 2020 2062 6f74 746f 6d5f 636f 726e       bottom_corn
+00014e70: 6572 203d 2066 6c6f 6174 286c 6162 656c  er = float(label
+00014e80: 2e61 7474 7228 2779 3027 2929 0d0a 2323  .attr('y0'))..##
+00014e90: 2020 2020 206e 616d 6520 3d20 7064 662e       name = pdf.
+00014ea0: 7071 2861 6372 6f74 7970 6520 2b27 3a69  pq(acrotype +':i
+00014eb0: 6e5f 6262 6f78 2822 2573 2c20 2573 2c20  n_bbox("%s, %s, 
+00014ec0: 2573 2c20 2573 2229 2720 2520 286c 6566  %s, %s")' % (lef
+00014ed0: 745f 636f 726e 6572 2c20 626f 7474 6f6d  t_corner, bottom
+00014ee0: 5f63 6f72 6e65 722d 3330 2c20 6c65 6674  _corner-30, left
+00014ef0: 5f63 6f72 6e65 722b 3135 302c 2062 6f74  _corner+150, bot
+00014f00: 746f 6d5f 636f 726e 6572 2929 2e74 6578  tom_corner)).tex
+00014f10: 7428 290d 0a23 2320 2020 2020 7265 7475  t()..##     retu
+00014f20: 726e 206e 616d 650d 0a23 230d 0a23 230d  rn name..##..##.
+00014f30: 0a23 2364 6566 2065 7874 7261 6374 6669  .##def extractfi
+00014f40: 656c 6473 2866 696c 656e 616d 6529 3a0d  elds(filename):.
+00014f50: 0a23 2320 2020 2020 2023 7265 6164 2074  .##      #read t
+00014f60: 6865 2050 4446 0d0a 2323 2020 2020 2020  he PDF..##      
+00014f70: 7064 6620 3d20 5044 4651 7565 7279 2866  pdf = PDFQuery(f
+00014f80: 696c 656e 616d 6529 0d0a 2323 2020 2020  ilename)..##    
+00014f90: 2020 7064 662e 6c6f 6164 2829 0d0a 2323    pdf.load()..##
+00014fa0: 0d0a 2323 2020 2020 2020 236f 203d 2078  ..##      #o = x
+00014fb0: 6d6c 746f 6469 6374 2e70 6172 7365 2827  mltodict.parse('
+00014fc0: 3c65 3e20 3c61 3e74 6578 743c 2f61 3e20  <e> <a>text</a> 
+00014fd0: 3c61 3e74 6578 743c 2f61 3e20 3c2f 653e  <a>text</a> </e>
+00014fe0: 2729 0d0a 2323 0d0a 2323 2020 2020 2020  ')..##..##      
+00014ff0: 2363 6f6e 7665 7274 2074 6865 2070 6466  #convert the pdf
+00015000: 2074 6f20 584d 4c0d 0a23 2320 2020 2020   to XML..##     
+00015010: 2078 6d6c 6669 6c65 3d20 6669 6c65 6e61   xmlfile= filena
+00015020: 6d65 202b 2027 2e78 6d6c 270d 0a23 2320  me + '.xml'..## 
+00015030: 2020 2020 2070 6466 2e74 7265 652e 7772       pdf.tree.wr
+00015040: 6974 6528 786d 6c66 696c 652c 2070 7265  ite(xmlfile, pre
+00015050: 7474 795f 7072 696e 7420 3d20 5472 7565  tty_print = True
+00015060: 290d 0a23 2320 2020 2020 2077 6974 6820  )..##      with 
+00015070: 6f70 656e 2878 6d6c 6669 6c65 2920 6173  open(xmlfile) as
+00015080: 2066 3a20 7320 3d20 662e 7265 6164 2829   f: s = f.read()
+00015090: 0d0a 2323 0d0a 2323 2020 2020 2020 2370  ..##..##      #p
+000150a0: 7269 6e74 2873 290d 0a23 2320 2020 2020  rint(s)..##     
+000150b0: 206a 736f 6e62 7566 3d78 6d6c 746f 6a73   jsonbuf=xmltojs
+000150c0: 6f6e 2873 2c78 6d6c 6669 6c65 290d 0a23  on(s,xmlfile)..#
+000150d0: 230d 0a23 2320 2020 2020 2072 6574 7572  #..##      retur
+000150e0: 6e20 6a73 6f6e 6275 660d 0a23 2320 2020  n jsonbuf..##   
+000150f0: 2020 200d 0a23 230d 0a23 2364 6566 2078     ..##..##def x
+00015100: 6d6c 746f 6a73 6f6e 2878 6d6c 6275 6666  mltojson(xmlbuff
+00015110: 6572 2c78 6d6c 6669 6c65 293a 0d0a 2323  er,xmlfile):..##
+00015120: 0d0a 2323 2020 2020 2020 6f20 3d20 786d  ..##      o = xm
+00015130: 6c74 6f64 6963 742e 7061 7273 6528 786d  ltodict.parse(xm
+00015140: 6c62 7566 6665 7229 0d0a 2323 2020 2020  lbuffer)..##    
+00015150: 2020 786d 6c6a 736f 6e3d 6a73 6f6e 2e64    xmljson=json.d
+00015160: 756d 7073 286f 290d 0a23 2320 2020 2020  umps(o)..##     
+00015170: 2023 7072 696e 7428 786d 6c6a 736f 6e29   #print(xmljson)
+00015180: 0d0a 2323 2020 2020 2020 7769 7468 206f  ..##      with o
+00015190: 7065 6e28 786d 6c66 696c 6520 2b20 272e  pen(xmlfile + '.
+000151a0: 6a73 6f6e 272c 2277 2229 2061 7320 663a  json',"w") as f:
+000151b0: 0d0a 2323 2020 2020 2020 2020 662e 7772  ..##        f.wr
+000151c0: 6974 6528 786d 6c6a 736f 6e29 0d0a 2323  ite(xmljson)..##
+000151d0: 0d0a 2323 2020 2020 2020 7265 7475 726e  ..##      return
+000151e0: 2078 6d6c 6a73 6f6e 2020 0d0a 0d0a        xmljson  ....
```

### Comparing `maadstml-3.47/maadstml/tmltextsummary.py` & `maadstml-3.48/maadstml/tmltextsummary.py`

 * *Files identical despite different names*

### Comparing `maadstml-3.47/maadstml.egg-info/PKG-INFO` & `maadstml-3.48/maadstml.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: maadstml
-Version: 3.47
+Version: 3.48
 Summary: Multi-Agent Accelerator for Data Science (MAADS): Transactional Machine Learning
 Home-page: https://github.com/smaurice101/transactionalmachinelearning
 Author: Sebastian Maurice
 Author-email: sebastian.maurice@otics.ca
 License: MIT License
 Keywords: genai, multi-agent, transactional machine learning, artificial intelligence, chatGPT, generative AI, privateGPT, data streams, data science, optimization, prescriptive analytics, machine learning, automl,auto-ml,artificial intelligence,predictive analytics,advanced analytics
 Description-Content-Type: text/markdown
```

### Comparing `maadstml-3.47/setup.py` & `maadstml-3.48/setup.py`

 * *Files 16% similar despite different names*

```diff
@@ -10,15 +10,15 @@
 	
 
 with open("requirements.txt","r") as f:
     required = f.read().splitlines()
     
 setuptools.setup(
     name='maadstml',
-    version='3.47',
+    version='3.48',
     description='Multi-Agent Accelerator for Data Science (MAADS): Transactional Machine Learning',
     license='MIT License',
     packages=['maadstml'],
     author='Sebastian Maurice',
     author_email='sebastian.maurice@otics.ca',
     keywords=['genai, multi-agent, transactional machine learning, artificial intelligence, chatGPT, generative AI, privateGPT, data streams, data science, optimization, prescriptive analytics, machine learning, automl,auto-ml,artificial intelligence', 'predictive analytics', 'advanced analytics'],
     long_description=long_description,
```

