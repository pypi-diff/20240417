# Comparing `tmp/web3-7.0.0b3.tar.gz` & `tmp/web3-7.0.0b4.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "web3-7.0.0b3.tar", last modified: Thu Mar 28 19:54:31 2024, max compression
+gzip compressed data, was "web3-7.0.0b4.tar", last modified: Thu Apr 11 21:35:30 2024, max compression
```

## Comparing `web3-7.0.0b3.tar` & `web3-7.0.0b4.tar`

### file list

```diff
@@ -1,201 +1,201 @@
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.975509 web3-7.0.0b3/
--rw-r--r--   0 fselmo     (501) staff       (20)     1090 2023-12-15 21:55:37.000000 web3-7.0.0b3/LICENSE
--rw-r--r--   0 fselmo     (501) staff       (20)      127 2024-03-28 19:22:05.000000 web3-7.0.0b3/MANIFEST.in
--rw-r--r--   0 fselmo     (501) staff       (20)     4514 2024-03-28 19:54:31.974977 web3-7.0.0b3/PKG-INFO
--rw-r--r--   0 fselmo     (501) staff       (20)     1292 2024-03-28 19:22:05.000000 web3-7.0.0b3/README.md
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.779026 web3-7.0.0b3/ens/
--rw-r--r--   0 fselmo     (501) staff       (20)      285 2023-12-15 21:55:37.000000 web3-7.0.0b3/ens/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)    16788 2024-03-28 19:22:05.000000 web3-7.0.0b3/ens/_normalization.py
--rw-r--r--   0 fselmo     (501) staff       (20)    34745 2023-12-15 21:55:37.000000 web3-7.0.0b3/ens/abis.py
--rw-r--r--   0 fselmo     (501) staff       (20)    22333 2024-03-28 19:22:05.000000 web3-7.0.0b3/ens/async_ens.py
--rw-r--r--   0 fselmo     (501) staff       (20)       41 2023-12-15 21:55:37.000000 web3-7.0.0b3/ens/auto.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3477 2023-12-15 21:55:37.000000 web3-7.0.0b3/ens/base_ens.py
--rw-r--r--   0 fselmo     (501) staff       (20)      913 2023-12-15 21:55:37.000000 web3-7.0.0b3/ens/constants.py
--rw-r--r--   0 fselmo     (501) staff       (20)   148604 2024-03-26 22:11:39.000000 web3-7.0.0b3/ens/contract_data.py
--rw-r--r--   0 fselmo     (501) staff       (20)    21605 2024-03-28 19:22:05.000000 web3-7.0.0b3/ens/ens.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2326 2024-03-27 22:42:53.000000 web3-7.0.0b3/ens/exceptions.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.781894 web3-7.0.0b3/ens/specs/
--rw-r--r--   0 fselmo     (501) staff       (20)    48402 2024-03-26 22:11:39.000000 web3-7.0.0b3/ens/specs/nf.json
--rw-r--r--   0 fselmo     (501) staff       (20)  3115333 2024-03-26 22:11:39.000000 web3-7.0.0b3/ens/specs/normalization_spec.json
--rw-r--r--   0 fselmo     (501) staff       (20)     9317 2024-03-28 19:22:05.000000 web3-7.0.0b3/ens/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1202 2024-03-26 22:11:39.000000 web3-7.0.0b3/pyproject.toml
--rw-r--r--   0 fselmo     (501) staff       (20)       38 2024-03-28 19:54:31.975613 web3-7.0.0b3/setup.cfg
--rw-r--r--   0 fselmo     (501) staff       (20)     2767 2024-03-28 19:54:13.000000 web3-7.0.0b3/setup.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.806593 web3-7.0.0b3/web3/
--rw-r--r--   0 fselmo     (501) staff       (20)     1068 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/__init__.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.848519 web3-7.0.0b3/web3/_utils/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2021-06-07 18:31:01.000000 web3-7.0.0b3/web3/_utils/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)    30587 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/abi.py
--rw-r--r--   0 fselmo     (501) staff       (20)      486 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/async_caching.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5161 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/async_transactions.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2059 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/blocks.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4789 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/caching.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.850093 web3-7.0.0b3/web3/_utils/compat/
--rw-r--r--   0 fselmo     (501) staff       (20)      592 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/compat/__init__.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.852738 web3-7.0.0b3/web3/_utils/contract_sources/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/contract_sources/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6491 2024-03-26 22:11:39.000000 web3-7.0.0b3/web3/_utils/contract_sources/compile_contracts.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.897639 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)      552 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/_custom_contract_data.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5344 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/address_reflector.py
--rw-r--r--   0 fselmo     (501) staff       (20)    18852 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/arrays_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    14783 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/bytes_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6089 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/constructor_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6334 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/contract_caller_tester.py
--rw-r--r--   0 fselmo     (501) staff       (20)    40967 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/emitter_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5573 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/event_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)    15824 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/extended_resolver.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1651 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/fallback_function_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1886 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/function_name_tester_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7637 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/math_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    16716 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/offchain_lookup.py
--rw-r--r--   0 fselmo     (501) staff       (20)    32387 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/offchain_resolver.py
--rw-r--r--   0 fselmo     (501) staff       (20)    15579 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/panic_errors_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1825 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/payable_tester.py
--rw-r--r--   0 fselmo     (501) staff       (20)    17290 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/receive_function_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5264 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/reflector_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4264 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/revert_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3555 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/simple_resolver.py
--rw-r--r--   0 fselmo     (501) staff       (20)     8238 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/storage_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    11586 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/string_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    23180 2024-03-28 15:26:36.000000 web3-7.0.0b3/web3/_utils/contract_sources/contract_data/tuple_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)    14323 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1640 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/datatypes.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1738 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/decorators.py
--rw-r--r--   0 fselmo     (501) staff       (20)      144 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/empty.py
--rw-r--r--   0 fselmo     (501) staff       (20)     9117 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/encoding.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2434 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/ens.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6809 2024-03-28 00:29:20.000000 web3-7.0.0b3/web3/_utils/error_formatters_utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)    17498 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/events.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2145 2024-03-26 22:11:39.000000 web3-7.0.0b3/web3/_utils/fee_utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)    11996 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/filters.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3071 2024-03-26 22:11:39.000000 web3-7.0.0b3/web3/_utils/formatters.py
--rw-r--r--   0 fselmo     (501) staff       (20)       55 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/function_identifiers.py
--rw-r--r--   0 fselmo     (501) staff       (20)      205 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/http.py
--rw-r--r--   0 fselmo     (501) staff       (20)      209 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/hypothesis.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1055 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/math.py
--rw-r--r--   0 fselmo     (501) staff       (20)    33918 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/method_formatters.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3147 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/module.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.908969 web3-7.0.0b3/web3/_utils/module_testing/
--rw-r--r--   0 fselmo     (501) staff       (20)      455 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/module_testing/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)   184153 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/module_testing/eth_module.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3406 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/module_testing/go_ethereum_admin_module.py
--rw-r--r--   0 fselmo     (501) staff       (20)    10432 2024-03-26 22:11:39.000000 web3-7.0.0b3/web3/_utils/module_testing/go_ethereum_personal_module.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1176 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/module_testing/go_ethereum_txpool_module.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5594 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/module_testing/module_testing_utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1272 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/module_testing/net_module.py
--rw-r--r--   0 fselmo     (501) staff       (20)    16567 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/module_testing/persistent_connection_provider.py
--rw-r--r--   0 fselmo     (501) staff       (20)     9632 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/module_testing/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)     9613 2024-03-26 00:37:39.000000 web3-7.0.0b3/web3/_utils/module_testing/web3_module.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7447 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/normalizers.py
--rw-r--r--   0 fselmo     (501) staff       (20)     8881 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/request.py
--rw-r--r--   0 fselmo     (501) staff       (20)     9357 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/_utils/rpc_abi.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4208 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/threads.py
--rw-r--r--   0 fselmo     (501) staff       (20)     8839 2024-03-28 19:21:28.000000 web3-7.0.0b3/web3/_utils/transactions.py
--rw-r--r--   0 fselmo     (501) staff       (20)      816 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/type_conversion.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2559 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/utility_methods.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6291 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/_utils/validation.py
--rw-r--r--   0 fselmo     (501) staff       (20)      994 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/_utils/windows.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.911521 web3-7.0.0b3/web3/auto/
--rw-r--r--   0 fselmo     (501) staff       (20)       44 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/auto/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)      438 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/auto/gethdev.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.914951 web3-7.0.0b3/web3/beacon/
--rw-r--r--   0 fselmo     (501) staff       (20)       65 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/beacon/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2208 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/beacon/api_endpoints.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7472 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/beacon/async_beacon.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6640 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/beacon/beacon.py
--rw-r--r--   0 fselmo     (501) staff       (20)      564 2024-03-25 23:10:26.000000 web3-7.0.0b3/web3/constants.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.919189 web3-7.0.0b3/web3/contract/
--rw-r--r--   0 fselmo     (501) staff       (20)      187 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/contract/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)    20392 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/contract/async_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    37552 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/contract/base_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    19997 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/contract/contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    12462 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/contract/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)    10716 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/datastructures.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.922196 web3-7.0.0b3/web3/eth/
--rw-r--r--   0 fselmo     (501) staff       (20)      124 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/eth/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)    23929 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/eth/async_eth.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6822 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/eth/base_eth.py
--rw-r--r--   0 fselmo     (501) staff       (20)    20839 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/eth/eth.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6904 2024-03-27 22:42:53.000000 web3-7.0.0b3/web3/exceptions.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.924849 web3-7.0.0b3/web3/gas_strategies/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2021-06-07 18:31:01.000000 web3-7.0.0b3/web3/gas_strategies/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)      352 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/gas_strategies/rpc.py
--rw-r--r--   0 fselmo     (501) staff       (20)     9169 2024-03-26 22:11:39.000000 web3-7.0.0b3/web3/gas_strategies/time_based.py
--rw-r--r--   0 fselmo     (501) staff       (20)    11329 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/geth.py
--rw-r--r--   0 fselmo     (501) staff       (20)      198 2022-09-26 17:05:32.000000 web3-7.0.0b3/web3/logs.py
--rw-r--r--   0 fselmo     (501) staff       (20)    13987 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/main.py
--rw-r--r--   0 fselmo     (501) staff       (20)    15030 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/manager.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7766 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/method.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.938284 web3-7.0.0b3/web3/middleware/
--rw-r--r--   0 fselmo     (501) staff       (20)     2414 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2259 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/attrdict.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3519 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/base.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1647 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/buffered_gas_estimate.py
--rw-r--r--   0 fselmo     (501) staff       (20)    21778 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/filter.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7507 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/formatting.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3779 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/gas_price_strategy.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4257 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/names.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1429 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/proof_of_authority.py
--rw-r--r--   0 fselmo     (501) staff       (20)      348 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/pythonic.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5680 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/signing.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2656 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/stalecheck.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4280 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/middleware/validation.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4793 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/module.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1562 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/net.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.944216 web3-7.0.0b3/web3/providers/
--rw-r--r--   0 fselmo     (501) staff       (20)      470 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5323 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/async_base.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3465 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/auto.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4468 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/base.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.948615 web3-7.0.0b3/web3/providers/eth_tester/
--rw-r--r--   0 fselmo     (501) staff       (20)       83 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/providers/eth_tester/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)    14512 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/eth_tester/defaults.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7196 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/eth_tester/main.py
--rw-r--r--   0 fselmo     (501) staff       (20)    12882 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/eth_tester/middleware.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5688 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/ipc.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3953 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/legacy_websocket.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.953726 web3-7.0.0b3/web3/providers/persistent/
--rw-r--r--   0 fselmo     (501) staff       (20)      283 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/persistent/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7277 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/persistent/async_ipc.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3556 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/persistent/persistent.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1109 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/persistent/persistent_connection.py
--rw-r--r--   0 fselmo     (501) staff       (20)    11495 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/persistent/request_processor.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1140 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/persistent/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6914 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/persistent/websocket.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.956064 web3-7.0.0b3/web3/providers/rpc/
--rw-r--r--   0 fselmo     (501) staff       (20)       89 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/rpc/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4136 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/rpc/async_rpc.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4230 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/rpc/rpc.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2458 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/providers/rpc/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/py.typed
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.956827 web3-7.0.0b3/web3/scripts/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/scripts/__init__.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.957854 web3-7.0.0b3/web3/scripts/release/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/scripts/release/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1534 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/scripts/release/test_package.py
--rw-r--r--   0 fselmo     (501) staff       (20)      951 2024-03-26 22:11:39.000000 web3-7.0.0b3/web3/testing.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.762114 web3-7.0.0b3/web3/tools/
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.961304 web3-7.0.0b3/web3/tools/benchmark/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/tools/benchmark/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5356 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/tools/benchmark/main.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3501 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/tools/benchmark/node.py
--rw-r--r--   0 fselmo     (501) staff       (20)      912 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/tools/benchmark/reporting.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1722 2024-03-26 22:11:39.000000 web3-7.0.0b3/web3/tools/benchmark/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2968 2024-03-26 22:11:39.000000 web3-7.0.0b3/web3/tracing.py
--rw-r--r--   0 fselmo     (501) staff       (20)    12534 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/types.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.967099 web3-7.0.0b3/web3/utils/
--rw-r--r--   0 fselmo     (501) staff       (20)      455 2024-03-25 23:10:26.000000 web3-7.0.0b3/web3/utils/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)      498 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/utils/abi.py
--rw-r--r--   0 fselmo     (501) staff       (20)      967 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/utils/address.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3096 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/utils/async_exception_handling.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1618 2024-03-28 19:22:05.000000 web3-7.0.0b3/web3/utils/caching.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3052 2023-12-15 21:55:37.000000 web3-7.0.0b3/web3/utils/exception_handling.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-03-28 19:54:31.967824 web3-7.0.0b3/web3.egg-info/
--rw-r--r--   0 fselmo     (501) staff       (20)     4514 2024-03-28 19:54:31.000000 web3-7.0.0b3/web3.egg-info/PKG-INFO
--rw-r--r--   0 fselmo     (501) staff       (20)     5622 2024-03-28 19:54:31.000000 web3-7.0.0b3/web3.egg-info/SOURCES.txt
--rw-r--r--   0 fselmo     (501) staff       (20)        1 2024-03-28 19:54:31.000000 web3-7.0.0b3/web3.egg-info/dependency_links.txt
--rw-r--r--   0 fselmo     (501) staff       (20)        1 2024-03-19 14:23:11.000000 web3-7.0.0b3/web3.egg-info/not-zip-safe
--rw-r--r--   0 fselmo     (501) staff       (20)     1027 2024-03-28 19:54:31.000000 web3-7.0.0b3/web3.egg-info/requires.txt
--rw-r--r--   0 fselmo     (501) staff       (20)        9 2024-03-28 19:54:31.000000 web3-7.0.0b3/web3.egg-info/top_level.txt
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.278621 web3-7.0.0b4/
+-rw-r--r--   0 fselmo     (501) staff       (20)     1090 2023-12-15 21:55:37.000000 web3-7.0.0b4/LICENSE
+-rw-r--r--   0 fselmo     (501) staff       (20)      127 2024-04-10 22:28:14.000000 web3-7.0.0b4/MANIFEST.in
+-rw-r--r--   0 fselmo     (501) staff       (20)     3906 2024-04-11 21:35:30.277847 web3-7.0.0b4/PKG-INFO
+-rw-r--r--   0 fselmo     (501) staff       (20)     1424 2024-04-11 21:30:15.000000 web3-7.0.0b4/README.md
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.007009 web3-7.0.0b4/ens/
+-rw-r--r--   0 fselmo     (501) staff       (20)      285 2023-12-15 21:55:37.000000 web3-7.0.0b4/ens/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    16786 2024-04-11 21:30:15.000000 web3-7.0.0b4/ens/_normalization.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    34745 2023-12-15 21:55:37.000000 web3-7.0.0b4/ens/abis.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    22414 2024-04-11 21:30:15.000000 web3-7.0.0b4/ens/async_ens.py
+-rw-r--r--   0 fselmo     (501) staff       (20)       41 2023-12-15 21:55:37.000000 web3-7.0.0b4/ens/auto.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3477 2023-12-15 21:55:37.000000 web3-7.0.0b4/ens/base_ens.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      913 2023-12-15 21:55:37.000000 web3-7.0.0b4/ens/constants.py
+-rw-r--r--   0 fselmo     (501) staff       (20)   148602 2024-04-11 21:30:15.000000 web3-7.0.0b4/ens/contract_data.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    21718 2024-04-11 21:30:15.000000 web3-7.0.0b4/ens/ens.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2683 2024-04-11 21:30:15.000000 web3-7.0.0b4/ens/exceptions.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.009359 web3-7.0.0b4/ens/specs/
+-rw-r--r--   0 fselmo     (501) staff       (20)    48403 2024-04-11 21:30:15.000000 web3-7.0.0b4/ens/specs/nf.json
+-rw-r--r--   0 fselmo     (501) staff       (20)  3115334 2024-04-11 21:30:15.000000 web3-7.0.0b4/ens/specs/normalization_spec.json
+-rw-r--r--   0 fselmo     (501) staff       (20)     9421 2024-04-11 21:30:15.000000 web3-7.0.0b4/ens/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3598 2024-04-11 21:30:15.000000 web3-7.0.0b4/pyproject.toml
+-rw-r--r--   0 fselmo     (501) staff       (20)       38 2024-04-11 21:35:30.278751 web3-7.0.0b4/setup.cfg
+-rw-r--r--   0 fselmo     (501) staff       (20)     2484 2024-04-11 21:35:13.000000 web3-7.0.0b4/setup.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.043561 web3-7.0.0b4/web3/
+-rw-r--r--   0 fselmo     (501) staff       (20)      900 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/__init__.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.096983 web3-7.0.0b4/web3/_utils/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2021-06-07 18:31:01.000000 web3-7.0.0b4/web3/_utils/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    30677 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/abi.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      486 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/async_caching.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5225 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/async_transactions.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2138 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/blocks.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4841 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/caching.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.097952 web3-7.0.0b4/web3/_utils/compat/
+-rw-r--r--   0 fselmo     (501) staff       (20)      526 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/compat/__init__.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.100668 web3-7.0.0b4/web3/_utils/contract_sources/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/contract_sources/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6486 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/contract_sources/compile_contracts.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.146665 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      552 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/_custom_contract_data.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5344 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/address_reflector.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    18852 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/arrays_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    14783 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/bytes_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6089 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/constructor_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6334 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/contract_caller_tester.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    40967 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/emitter_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5573 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/event_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    15824 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/extended_resolver.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1651 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/fallback_function_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1886 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/function_name_tester_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7637 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/math_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    16716 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/offchain_lookup.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    32387 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/offchain_resolver.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    15579 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/panic_errors_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1825 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/payable_tester.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    17290 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/receive_function_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5264 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/reflector_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4264 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/revert_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3555 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/simple_resolver.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8238 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/storage_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    11586 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/string_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    23180 2024-04-05 19:50:10.000000 web3-7.0.0b4/web3/_utils/contract_sources/contract_data/tuple_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    14206 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1701 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/datatypes.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1825 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/decorators.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      132 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/empty.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     9262 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/encoding.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2434 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/ens.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6868 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/error_formatters_utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    17387 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/events.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2099 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/fee_utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    11974 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/filters.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3067 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/formatters.py
+-rw-r--r--   0 fselmo     (501) staff       (20)       55 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/function_identifiers.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      205 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/http.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      209 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/hypothesis.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1083 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/math.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    34481 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/method_formatters.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3175 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/module.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.174346 web3-7.0.0b4/web3/_utils/module_testing/
+-rw-r--r--   0 fselmo     (501) staff       (20)      455 2024-04-10 17:31:38.000000 web3-7.0.0b4/web3/_utils/module_testing/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)   184026 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/module_testing/eth_module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3406 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/module_testing/go_ethereum_admin_module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    10430 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/module_testing/go_ethereum_personal_module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1176 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/module_testing/go_ethereum_txpool_module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5559 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/module_testing/module_testing_utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1272 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/module_testing/net_module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    16567 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/module_testing/persistent_connection_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    10023 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/module_testing/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     9613 2024-03-26 00:37:39.000000 web3-7.0.0b4/web3/_utils/module_testing/web3_module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7392 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/normalizers.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8843 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/request.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     9444 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/rpc_abi.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4245 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/threads.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8912 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/_utils/transactions.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      873 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/type_conversion.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2559 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/utility_methods.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6370 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/_utils/validation.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      994 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/_utils/windows.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.178996 web3-7.0.0b4/web3/auto/
+-rw-r--r--   0 fselmo     (501) staff       (20)       44 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/auto/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      438 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/auto/gethdev.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.187219 web3-7.0.0b4/web3/beacon/
+-rw-r--r--   0 fselmo     (501) staff       (20)       65 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/beacon/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2208 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/beacon/api_endpoints.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7472 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/beacon/async_beacon.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6640 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/beacon/beacon.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      564 2024-03-25 23:10:26.000000 web3-7.0.0b4/web3/constants.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.195057 web3-7.0.0b4/web3/contract/
+-rw-r--r--   0 fselmo     (501) staff       (20)      187 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/contract/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    20493 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/contract/async_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    36959 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/contract/base_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    20099 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/contract/contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    12510 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/contract/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    10939 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/datastructures.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.201039 web3-7.0.0b4/web3/eth/
+-rw-r--r--   0 fselmo     (501) staff       (20)      124 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/eth/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    24082 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/eth/async_eth.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6905 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/eth/base_eth.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    21026 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/eth/eth.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7387 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/exceptions.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.204611 web3-7.0.0b4/web3/gas_strategies/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2021-06-07 18:31:01.000000 web3-7.0.0b4/web3/gas_strategies/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      352 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/gas_strategies/rpc.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8981 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/gas_strategies/time_based.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    11294 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/geth.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      198 2022-09-26 17:05:32.000000 web3-7.0.0b4/web3/logs.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    14066 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/main.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    15093 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/manager.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7874 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/method.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.223055 web3-7.0.0b4/web3/middleware/
+-rw-r--r--   0 fselmo     (501) staff       (20)     2414 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/middleware/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2259 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/middleware/attrdict.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3553 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/middleware/base.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1647 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/middleware/buffered_gas_estimate.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    21678 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/middleware/filter.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7567 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/middleware/formatting.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3779 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/middleware/gas_price_strategy.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4309 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/middleware/names.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1429 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/middleware/proof_of_authority.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      348 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/middleware/pythonic.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5740 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/middleware/signing.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2680 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/middleware/stalecheck.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4280 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/middleware/validation.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4793 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1562 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/net.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.230787 web3-7.0.0b4/web3/providers/
+-rw-r--r--   0 fselmo     (501) staff       (20)      470 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5323 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/async_base.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3465 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/auto.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4468 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/base.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.237564 web3-7.0.0b4/web3/providers/eth_tester/
+-rw-r--r--   0 fselmo     (501) staff       (20)       83 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/providers/eth_tester/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    14510 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/providers/eth_tester/defaults.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7214 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/eth_tester/main.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    13287 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/providers/eth_tester/middleware.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5768 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/ipc.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3953 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/legacy_websocket.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.244911 web3-7.0.0b4/web3/providers/persistent/
+-rw-r--r--   0 fselmo     (501) staff       (20)      283 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/persistent/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7215 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/providers/persistent/async_ipc.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3918 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/persistent/persistent.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1109 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/persistent/persistent_connection.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    11540 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/providers/persistent/request_processor.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1140 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/persistent/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6901 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/persistent/websocket.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.248518 web3-7.0.0b4/web3/providers/rpc/
+-rw-r--r--   0 fselmo     (501) staff       (20)       89 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/rpc/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4667 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/providers/rpc/async_rpc.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4622 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/providers/rpc/rpc.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2458 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/providers/rpc/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/py.typed
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.252155 web3-7.0.0b4/web3/scripts/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/scripts/__init__.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.253835 web3-7.0.0b4/web3/scripts/release/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/scripts/release/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1534 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/scripts/release/test_package.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      923 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/testing.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:29.990372 web3-7.0.0b4/web3/tools/
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.259806 web3-7.0.0b4/web3/tools/benchmark/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/tools/benchmark/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5768 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/tools/benchmark/main.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3501 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/tools/benchmark/node.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      912 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/tools/benchmark/reporting.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1696 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/tools/benchmark/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3098 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/tracing.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    12635 2024-04-11 21:30:15.000000 web3-7.0.0b4/web3/types.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.267739 web3-7.0.0b4/web3/utils/
+-rw-r--r--   0 fselmo     (501) staff       (20)      455 2024-03-25 23:10:26.000000 web3-7.0.0b4/web3/utils/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      498 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/utils/abi.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      967 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/utils/address.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3096 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/utils/async_exception_handling.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1618 2024-04-10 22:28:14.000000 web3-7.0.0b4/web3/utils/caching.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3052 2023-12-15 21:55:37.000000 web3-7.0.0b4/web3/utils/exception_handling.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-11 21:35:30.269356 web3-7.0.0b4/web3.egg-info/
+-rw-r--r--   0 fselmo     (501) staff       (20)     3906 2024-04-11 21:35:29.000000 web3-7.0.0b4/web3.egg-info/PKG-INFO
+-rw-r--r--   0 fselmo     (501) staff       (20)     5622 2024-04-11 21:35:29.000000 web3-7.0.0b4/web3.egg-info/SOURCES.txt
+-rw-r--r--   0 fselmo     (501) staff       (20)        1 2024-04-11 21:35:29.000000 web3-7.0.0b4/web3.egg-info/dependency_links.txt
+-rw-r--r--   0 fselmo     (501) staff       (20)        1 2024-03-19 14:23:11.000000 web3-7.0.0b4/web3.egg-info/not-zip-safe
+-rw-r--r--   0 fselmo     (501) staff       (20)      752 2024-04-11 21:35:29.000000 web3-7.0.0b4/web3.egg-info/requires.txt
+-rw-r--r--   0 fselmo     (501) staff       (20)        9 2024-04-11 21:35:29.000000 web3-7.0.0b4/web3.egg-info/top_level.txt
```

### Comparing `web3-7.0.0b3/LICENSE` & `web3-7.0.0b4/LICENSE`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/PKG-INFO` & `web3-7.0.0b4/PKG-INFO`

 * *Files 18% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: web3
-Version: 7.0.0b3
+Version: 7.0.0b4
 Summary: web3.py
 Home-page: https://github.com/ethereum/web3.py
 Author: The Ethereum Foundation
 Author-email: snakecharmers@ethereum.org
 License: MIT
 Keywords: ethereum
 Classifier: Development Status :: 5 - Production/Stable
@@ -16,80 +16,65 @@
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Requires-Python: >=3.8
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: aiohttp>=3.7.4.post0
-Requires-Dist: eth-abi>=4.0.0
-Requires-Dist: eth-account>=0.8.0
+Requires-Dist: eth-abi>=5.0.1
+Requires-Dist: eth-account>=0.12.0
 Requires-Dist: eth-hash[pycryptodome]>=0.5.1
-Requires-Dist: eth-typing>=3.0.0
+Requires-Dist: eth-typing>=4.0.0
 Requires-Dist: eth-utils>=4.0.0
-Requires-Dist: hexbytes<0.4.0,>=0.1.0
+Requires-Dist: hexbytes>=1.2.0
 Requires-Dist: pydantic>=2.4.0
 Requires-Dist: pywin32>=223; platform_system == "Windows"
 Requires-Dist: requests>=2.16.0
 Requires-Dist: typing-extensions>=4.0.1
 Requires-Dist: websockets>=10.0.0
 Requires-Dist: pyunormalize>=15.0.0
 Provides-Extra: tester
-Requires-Dist: eth-tester[py-evm]==v0.10.0-b.3; extra == "tester"
+Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "tester"
 Requires-Dist: py-geth>=4.1.0; extra == "tester"
-Provides-Extra: linter
-Requires-Dist: black>=22.1.0; extra == "linter"
-Requires-Dist: blocklint>=0.2.4; extra == "linter"
-Requires-Dist: flake8==3.8.3; extra == "linter"
-Requires-Dist: isort>=5.11.0; extra == "linter"
-Requires-Dist: mypy==1.4.1; extra == "linter"
-Requires-Dist: types-setuptools>=57.4.4; extra == "linter"
-Requires-Dist: types-requests>=2.26.1; extra == "linter"
 Provides-Extra: docs
 Requires-Dist: sphinx>=5.3.0; extra == "docs"
 Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "docs"
 Requires-Dist: towncrier<22,>=21; extra == "docs"
 Provides-Extra: dev
-Requires-Dist: eth-tester[py-evm]==v0.10.0-b.3; extra == "dev"
+Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "dev"
 Requires-Dist: py-geth>=4.1.0; extra == "dev"
-Requires-Dist: black>=22.1.0; extra == "dev"
-Requires-Dist: blocklint>=0.2.4; extra == "dev"
-Requires-Dist: flake8==3.8.3; extra == "dev"
-Requires-Dist: isort>=5.11.0; extra == "dev"
-Requires-Dist: mypy==1.4.1; extra == "dev"
-Requires-Dist: types-setuptools>=57.4.4; extra == "dev"
-Requires-Dist: types-requests>=2.26.1; extra == "dev"
 Requires-Dist: sphinx>=5.3.0; extra == "dev"
 Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "dev"
 Requires-Dist: towncrier<22,>=21; extra == "dev"
+Requires-Dist: build>=0.9.0; extra == "dev"
 Requires-Dist: bumpversion; extra == "dev"
 Requires-Dist: flaky>=3.7.0; extra == "dev"
 Requires-Dist: hypothesis>=3.31.2; extra == "dev"
-Requires-Dist: importlib-metadata<5.0; python_version < "3.8" and extra == "dev"
-Requires-Dist: pytest>=7.0.0; extra == "dev"
+Requires-Dist: pre-commit>=3.4.0; extra == "dev"
 Requires-Dist: pytest-asyncio<0.23,>=0.18.1; extra == "dev"
 Requires-Dist: pytest-mock>=1.10; extra == "dev"
 Requires-Dist: pytest-watch>=4.2; extra == "dev"
 Requires-Dist: pytest-xdist>=1.29; extra == "dev"
+Requires-Dist: pytest>=7.0.0; extra == "dev"
 Requires-Dist: setuptools>=38.6.0; extra == "dev"
 Requires-Dist: tox>=3.18.0; extra == "dev"
 Requires-Dist: tqdm>4.32; extra == "dev"
 Requires-Dist: twine>=1.13; extra == "dev"
-Requires-Dist: build>=0.9.0; extra == "dev"
 
 # web3.py
 
 [![Documentation Status](https://readthedocs.org/projects/web3py/badge/?version=latest)](https://web3py.readthedocs.io/en/latest/?badge=latest)
 [![Discord](https://img.shields.io/discord/809793915578089484?color=blue&label=chat&logo=discord&logoColor=white)](https://discord.gg/GHryRvPB84)
 [![Build Status](https://circleci.com/gh/ethereum/web3.py.svg?style=shield)](https://circleci.com/gh/ethereum/web3.py)
 
 A Python library for interacting with Ethereum.
 
--   Python 3.8+ support
+- Python 3.8+ support
 
----
+______________________________________________________________________
 
 ## Quickstart
 
 [Get started in 5 minutes](https://web3py.readthedocs.io/en/latest/quickstart.html) or
 [take a tour](https://web3py.readthedocs.io/en/latest/overview.html) of the library.
 
 ## Documentation
@@ -99,10 +84,10 @@
 ## Want to help?
 
 Want to file a bug, contribute some code, or improve documentation? Excellent! Read up on our
 guidelines for [contributing](https://web3py.readthedocs.io/en/latest/contributing.html),
 then check out issues that are labeled
 [Good First Issue](https://github.com/ethereum/web3.py/issues?q=is%3Aissue+is%3Aopen+label%3A%22Good+First+Issue%22).
 
----
+______________________________________________________________________
 
 #### Questions on implementation or usage? Join the conversation on [discord](https://discord.gg/GHryRvPB84).
```

### Comparing `web3-7.0.0b3/README.md` & `web3-7.0.0b4/README.md`

 * *Files 4% similar despite different names*

```diff
@@ -2,17 +2,17 @@
 
 [![Documentation Status](https://readthedocs.org/projects/web3py/badge/?version=latest)](https://web3py.readthedocs.io/en/latest/?badge=latest)
 [![Discord](https://img.shields.io/discord/809793915578089484?color=blue&label=chat&logo=discord&logoColor=white)](https://discord.gg/GHryRvPB84)
 [![Build Status](https://circleci.com/gh/ethereum/web3.py.svg?style=shield)](https://circleci.com/gh/ethereum/web3.py)
 
 A Python library for interacting with Ethereum.
 
--   Python 3.8+ support
+- Python 3.8+ support
 
----
+______________________________________________________________________
 
 ## Quickstart
 
 [Get started in 5 minutes](https://web3py.readthedocs.io/en/latest/quickstart.html) or
 [take a tour](https://web3py.readthedocs.io/en/latest/overview.html) of the library.
 
 ## Documentation
@@ -22,10 +22,10 @@
 ## Want to help?
 
 Want to file a bug, contribute some code, or improve documentation? Excellent! Read up on our
 guidelines for [contributing](https://web3py.readthedocs.io/en/latest/contributing.html),
 then check out issues that are labeled
 [Good First Issue](https://github.com/ethereum/web3.py/issues?q=is%3Aissue+is%3Aopen+label%3A%22Good+First+Issue%22).
 
----
+______________________________________________________________________
 
 #### Questions on implementation or usage? Join the conversation on [discord](https://discord.gg/GHryRvPB84).
```

### Comparing `web3-7.0.0b3/ens/_normalization.py` & `web3-7.0.0b4/ens/_normalization.py`

 * *Files 0% similar despite different names*

```diff
@@ -44,15 +44,15 @@
 with open(os.path.join(specs_dir_path, "normalization_spec.json")) as spec:
     f = json.load(spec)
 
     NORMALIZATION_SPEC = _json_list_mapping_to_dict(f, "mapped")
     # clean `FE0F` (65039) from entries since it's optional
     for e in NORMALIZATION_SPEC["emoji"]:
         if 65039 in e:
-            for i in range(e.count(65039)):
+            for _ in range(e.count(65039)):
                 e.remove(65039)
 
 with open(os.path.join(specs_dir_path, "nf.json")) as nf:
     f = json.load(nf)
     NF = _json_list_mapping_to_dict(f, "decomp")
 
 
@@ -218,15 +218,14 @@
 def _validate_tokens_and_get_label_type(tokens: List[Token]) -> str:
     """
     Validate tokens and return the label type.
 
     :param List[Token] tokens: the tokens to validate
     :raises InvalidName: if any of the tokens are invalid
     """
-
     if all(token.type == TokenType.EMOJI for token in tokens):
         return "emoji"
 
     label_text = "".join(token.text for token in tokens)
     concat_text_tokens_as_str = "".join(
         t.text for t in tokens if t.type == TokenType.TEXT
     )
@@ -419,15 +418,14 @@
     """
     Normalize an ENS name according to ENSIP-15
     https://docs.ens.domains/ens-improvement-proposals/ensip-15-normalization-standard
 
     :param str name: the dot-separated ENS name
     :raises InvalidName: if ``name`` has invalid syntax
     """
-
     if not name:
         raise InvalidName("Name cannot be empty")
     elif isinstance(name, (bytes, bytearray)):
         name = name.decode("utf-8")
 
     raw_labels = name.split(".")
```

### Comparing `web3-7.0.0b3/ens/abis.py` & `web3-7.0.0b4/ens/abis.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/ens/async_ens.py` & `web3-7.0.0b4/ens/async_ens.py`

 * *Files 0% similar despite different names*

```diff
@@ -42,14 +42,15 @@
     ENS_MAINNET_ADDR,
     ENS_MULTICHAIN_ADDRESS_INTERFACE_ID,
     ENS_TEXT_INTERFACE_ID,
     REVERSE_REGISTRAR_DOMAIN,
 )
 from ens.exceptions import (
     AddressMismatch,
+    ENSValueError,
     ResolverNotFound,
     UnauthorizedError,
     UnownedName,
     UnsupportedFunction,
 )
 from ens.utils import (
     address_in,
@@ -94,24 +95,25 @@
     """
 
     # mypy types
     w3: "AsyncWeb3"
 
     def __init__(
         self,
-        provider: "AsyncBaseProvider" = cast("AsyncBaseProvider", default),
+        provider: "AsyncBaseProvider" = None,
         addr: ChecksumAddress = None,
         middleware: Optional[Sequence[Tuple["Middleware", str]]] = None,
     ) -> None:
         """
         :param provider: a single provider used to connect to Ethereum
         :type provider: instance of `web3.providers.base.BaseProvider`
         :param hex-string addr: the address of the ENS registry on-chain.
             If not provided, ENS.py will default to the mainnet ENS registry address.
         """
+        provider = provider or cast("AsyncBaseProvider", default)
         self.w3 = init_async_web3(provider, middleware)
 
         ens_addr = addr if addr else ENS_MAINNET_ADDR
         self.ens = self.w3.eth.contract(abi=abis.ENS, address=ens_addr)
         self._resolver_contract = self.w3.eth.contract(
             abi=abis.PUBLIC_RESOLVER_2_EXTENDED
         )
@@ -163,15 +165,15 @@
             if is_none_or_zero_address(address_as_bytes):
                 return None
             return to_checksum_address(address_as_bytes)
 
     async def setup_address(
         self,
         name: str,
-        address: Union[Address, ChecksumAddress, HexAddress] = cast(
+        address: Union[Address, ChecksumAddress, HexAddress] = cast(  # noqa: B008
             ChecksumAddress, default
         ),
         coin_type: Optional[int] = None,
         transact: Optional["TxParams"] = None,
     ) -> Optional[HexBytes]:
         """
         Set up the name to point to the supplied address.
@@ -200,15 +202,15 @@
         if is_none_or_zero_address(address):
             address = None
         elif address is default:
             address = owner
         elif is_binary_address(address):
             address = to_checksum_address(cast(str, address))
         elif not is_checksum_address(address):
-            raise ValueError("You must supply the address in checksum format")
+            raise ENSValueError("You must supply the address in checksum format")
         if await self.address(name) == address:
             return None
         if address is None:
             address = EMPTY_ADDR_HEX
         transact["from"] = owner
 
         resolver: "AsyncContract" = await self._set_resolver(name, transact=transact)
@@ -278,15 +280,15 @@
             if is_none_or_zero_address(address):
                 address = await self.owner(name)
             if is_none_or_zero_address(address):
                 raise UnownedName("claim subdomain using setup_address() first")
             if is_binary_address(address):
                 address = to_checksum_address(address)
             if not is_checksum_address(address):
-                raise ValueError("You must supply the address in checksum format")
+                raise ENSValueError("You must supply the address in checksum format")
             await self._assert_control(address, name)
             if not resolved:
                 await self.setup_address(name, address, transact=transact)
             return await self._setup_reverse(name, address, transact=transact)
 
     async def owner(self, name: str) -> ChecksumAddress:
         """
@@ -301,15 +303,15 @@
         """
         node = raw_name_to_hash(name)
         return await self.ens.caller.owner(node)
 
     async def setup_owner(
         self,
         name: str,
-        new_owner: ChecksumAddress = cast(ChecksumAddress, default),
+        new_owner: ChecksumAddress = None,
         transact: Optional["TxParams"] = None,
     ) -> Optional[ChecksumAddress]:
         """
         Set the owner of the supplied name to `new_owner`.
 
         For typical scenarios, you'll never need to call this method directly,
         simply call :meth:`setup_name` or :meth:`setup_address`. This method does *not*
@@ -328,14 +330,15 @@
             to the parent domain owner's address.
         :param dict transact: the transaction configuration, like in
             :meth:`~web3.eth.Eth.send_transaction`
         :raises InvalidName: if `name` has invalid syntax
         :raises UnauthorizedError: if ``'from'`` in `transact` does not own `name`
         :returns: the new owner's address
         """
+        new_owner = new_owner or cast(ChecksumAddress, default)
         if not transact:
             transact = {}
         transact = deepcopy(transact)
         (super_owner, unowned, owned) = await self._first_owner(name)
         if new_owner is default:
             new_owner = super_owner
         elif not new_owner:
@@ -462,17 +465,17 @@
         if not transact:
             transact = {}
         transact = deepcopy(transact)
         if is_none_or_zero_address(resolver_addr):
             resolver_addr = await self.address("resolver.eth")
         namehash = raw_name_to_hash(name)
         if await self.ens.caller.resolver(namehash) != resolver_addr:
-            await self.ens.functions.setResolver(  # type: ignore
-                namehash, resolver_addr
-            ).transact(transact)
+            await self.ens.functions.setResolver(namehash, resolver_addr).transact(
+                transact
+            )
         return cast("AsyncContract", self._resolver_contract(address=resolver_addr))
 
     async def _resolve(
         self,
         name: str,
         fn_name: str = "addr",
     ) -> Optional[Union[ChecksumAddress, str]]:
@@ -546,15 +549,15 @@
         transact: Optional["TxParams"] = None,
     ) -> None:
         if not transact:
             transact = {}
         transact = deepcopy(transact)
         transact["from"] = old_owner or owner
         for label in reversed(unowned):
-            await self.ens.functions.setSubnodeOwner(  # type: ignore
+            await self.ens.functions.setSubnodeOwner(
                 raw_name_to_hash(owned),
                 label_to_hash(label),
                 owner,
             ).transact(transact)
             owned = f"{label}.{owned}"
 
     async def _setup_reverse(
```

### Comparing `web3-7.0.0b3/ens/base_ens.py` & `web3-7.0.0b4/ens/base_ens.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/ens/constants.py` & `web3-7.0.0b4/ens/constants.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/ens/contract_data.py` & `web3-7.0.0b4/ens/contract_data.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 # flake8: noqa
 import json
 
 """
 This contract data is taken from the actual ENS contracts deployed on mainnet.
-The information was taken from etherscan.io and may need to be updated as the ENS 
-contracts are updated. 
+The information was taken from etherscan.io and may need to be updated as the ENS
+contracts are updated.
 
 https://etherscan.io/accounts/label/ens
 """
 
 # ENS Default Registrar
 registrar_abi = json.loads(
     '[{"inputs":[{"internalType":"contract ENS","name":"_ens","type":"address"},{"internalType":"bytes32","name":"_baseNode","type":"bytes32"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"controller","type":"address"}],"name":"ControllerAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"controller","type":"address"}],"name":"ControllerRemoved","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"uint256","name":"expires","type":"uint256"}],"name":"NameMigrated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"uint256","name":"expires","type":"uint256"}],"name":"NameRegistered","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"expires","type":"uint256"}],"name":"NameRenewed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"},{"constant":true,"inputs":[],"name":"GRACE_PERIOD","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"controller","type":"address"}],"name":"addController","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"available","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"baseNode","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"controllers","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"ens","outputs":[{"internalType":"contract ENS","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"isOwner","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"nameExpires","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"address","name":"owner","type":"address"}],"name":"reclaim","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint256","name":"duration","type":"uint256"}],"name":"register","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint256","name":"duration","type":"uint256"}],"name":"registerOnly","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"controller","type":"address"}],"name":"removeController","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"}],"name":"renew","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"renounceOwnership","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"bytes","name":"_data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"resolver","type":"address"}],"name":"setResolver","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"internalType":"bytes4","name":"interfaceID","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"}]'
```

### Comparing `web3-7.0.0b3/ens/ens.py` & `web3-7.0.0b4/ens/ens.py`

 * *Files 1% similar despite different names*

```diff
@@ -42,14 +42,15 @@
     ENS_MAINNET_ADDR,
     ENS_MULTICHAIN_ADDRESS_INTERFACE_ID,
     ENS_TEXT_INTERFACE_ID,
     REVERSE_REGISTRAR_DOMAIN,
 )
 from .exceptions import (
     AddressMismatch,
+    ENSValueError,
     ResolverNotFound,
     UnauthorizedError,
     UnownedName,
     UnsupportedFunction,
 )
 from .utils import (
     address_in,
@@ -93,25 +94,26 @@
     """
 
     # mypy types
     w3: "Web3"
 
     def __init__(
         self,
-        provider: "BaseProvider" = cast("BaseProvider", default),
+        provider: "BaseProvider" = None,
         addr: ChecksumAddress = None,
         middleware: Optional[Sequence[Tuple["Middleware", str]]] = None,
     ) -> None:
         """
         :param provider: a single provider used to connect to Ethereum
         :type provider: instance of `web3.providers.base.BaseProvider`
         :param hex-string addr: the address of the ENS registry on-chain.
             If not provided, ENS.py will default to the mainnet ENS
             registry address.
         """
+        provider = provider or cast("BaseProvider", default)
         self.w3 = init_web3(provider, middleware)
 
         ens_addr = addr if addr else ENS_MAINNET_ADDR
         self.ens = self.w3.eth.contract(abi=abis.ENS, address=ens_addr)
         self._resolver_contract = self.w3.eth.contract(
             abi=abis.PUBLIC_RESOLVER_2_EXTENDED
         )
@@ -166,15 +168,15 @@
             if is_none_or_zero_address(address_as_bytes):
                 return None
             return to_checksum_address(address_as_bytes)
 
     def setup_address(
         self,
         name: str,
-        address: Union[Address, ChecksumAddress, HexAddress] = cast(
+        address: Union[Address, ChecksumAddress, HexAddress] = cast(  # noqa: B008
             ChecksumAddress, default
         ),
         coin_type: Optional[int] = None,
         transact: Optional["TxParams"] = None,
     ) -> Optional[HexBytes]:
         """
         Set up the name to point to the supplied address.
@@ -204,15 +206,15 @@
         if is_none_or_zero_address(address):
             address = None
         elif address is default:
             address = owner
         elif is_binary_address(address):
             address = to_checksum_address(cast(str, address))
         elif not is_checksum_address(address):
-            raise ValueError("You must supply the address in checksum format")
+            raise ENSValueError("You must supply the address in checksum format")
         if self.address(name) == address:
             return None
         if address is None:
             address = EMPTY_ADDR_HEX
         transact["from"] = owner
 
         resolver: "Contract" = self._set_resolver(name, transact=transact)
@@ -280,15 +282,15 @@
             if is_none_or_zero_address(address):
                 address = self.owner(name)
             if is_none_or_zero_address(address):
                 raise UnownedName("claim subdomain using setup_address() first")
             if is_binary_address(address):
                 address = to_checksum_address(address)
             if not is_checksum_address(address):
-                raise ValueError("You must supply the address in checksum format")
+                raise ENSValueError("You must supply the address in checksum format")
             self._assert_control(address, name)
             if not resolved:
                 self.setup_address(name, address, transact=transact)
             return self._setup_reverse(name, address, transact=transact)
 
     def owner(self, name: str) -> ChecksumAddress:
         """
@@ -303,15 +305,15 @@
         """
         node = raw_name_to_hash(name)
         return self.ens.caller.owner(node)
 
     def setup_owner(
         self,
         name: str,
-        new_owner: ChecksumAddress = cast(ChecksumAddress, default),
+        new_owner: ChecksumAddress = None,
         transact: Optional["TxParams"] = None,
     ) -> Optional[ChecksumAddress]:
         """
         Set the owner of the supplied name to `new_owner`.
 
         For typical scenarios, you'll never need to call this method directly,
         simply call :meth:`setup_name` or :meth:`setup_address`. This method does *not*
@@ -330,14 +332,15 @@
             owner's address.
         :param dict transact: the transaction configuration, like in
             :meth:`~web3.eth.Eth.send_transaction`
         :raises InvalidName: if `name` has invalid syntax
         :raises UnauthorizedError: if ``'from'`` in `transact` does not own `name`
         :returns: the new owner's address
         """
+        new_owner = new_owner or cast(ChecksumAddress, default)
         if not transact:
             transact = {}
 
         transact = deepcopy(transact)
         (super_owner, unowned, owned) = self._first_owner(name)
         if new_owner is default:
             new_owner = super_owner
```

### Comparing `web3-7.0.0b3/ens/exceptions.py` & `web3-7.0.0b4/ens/exceptions.py`

 * *Files 15% similar despite different names*

```diff
@@ -5,115 +5,107 @@
 
 
 class ENSException(Exception):
     """
     Base class for all ENS Errors
     """
 
-    pass
+
+class ENSValueError(ENSException, ValueError):
+    """
+    An ENS exception wrapper for `ValueError`, for better control over
+    exception handling.
+    """
+
+
+class ENSTypeError(ENSException, TypeError):
+    """
+    An ENS exception wrapper for `TypeError`, for better control over
+    exception handling.
+    """
 
 
 class AddressMismatch(ENSException):
     """
     In order to set up reverse resolution correctly, the ENS name should first
     point to the address. This exception is raised if the name does
     not currently point to the address.
     """
 
-    pass
 
-
-class InvalidName(idna.IDNAError, ENSException):
+# type ignored because subclassing IDNAError which has type Any
+class InvalidName(idna.IDNAError, ENSException):  # type: ignore[misc]
     """
-    This exception is raised if the provided name does not meet
-    the normalization standards specified in `ENSIP-15
+    Raised if the provided name does not meet the normalization
+    standards specified in `ENSIP-15
     <https://docs.ens.domains/ens-improvement-proposals/ensip-15-normalization-standard>`_.
     """
 
-    pass
-
 
 class UnauthorizedError(ENSException):
     """
     Raised if the sending account is not the owner of the name
     you are trying to modify. Make sure to set ``from`` in the
     ``transact`` keyword argument to the owner of the name.
     """
 
-    pass
-
 
 class UnownedName(ENSException):
     """
     Raised if you are trying to modify a name that no one owns.
 
     If working on a subdomain, make sure the subdomain gets created
     first with :meth:`~ens.ENS.setup_address`.
     """
 
-    pass
-
 
 class ResolverNotFound(ENSException):
     """
     Raised if no resolver was found for the name you are trying to resolve.
     """
 
-    pass
-
 
 class UnsupportedFunction(ENSException):
     """
     Raised if a resolver does not support a particular method.
     """
 
-    pass
-
 
 class BidTooLow(ENSException):
     """
     Raised if you bid less than the minimum amount
     """
 
-    pass
-
 
 class InvalidBidHash(ENSException):
     """
     Raised if you supply incorrect data to generate the bid hash.
     """
 
-    pass
-
 
 class InvalidLabel(ENSException):
     """
     Raised if you supply an invalid label
     """
 
-    pass
-
 
 class OversizeTransaction(ENSException):
     """
     Raised if a transaction you are trying to create would cost so
     much gas that it could not fit in a block.
 
     For example: when you try to start too many auctions at once.
     """
 
-    pass
-
 
 class UnderfundedBid(ENSException):
     """
     Raised if you send less wei with your bid than you declared
     as your intent to bid.
     """
 
-    pass
-
 
-class ENSValidationError(ENSException, ValidationError):
+# type ignored because subclassing ValidationError which has type Any
+class ENSValidationError(ENSException, ValidationError):  # type: ignore[misc]
     """
     Raised if there is a validation error
     """
```

### Comparing `web3-7.0.0b3/ens/specs/nf.json` & `web3-7.0.0b4/ens/specs/nf.json`

 * *Format-specific differences are supported for JSON files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: JSON text data*

 * *Files 0% similar despite different names*

```diff
@@ -3019,8 +3019,8 @@
 0000bca0: 2c31 3935 3038 362c 3139 3530 3837 2c31  ,195086,195087,1
 0000bcb0: 3935 3038 382c 3139 3530 3839 2c31 3935  95088,195089,195
 0000bcc0: 3039 302c 3139 3530 3931 2c31 3935 3039  090,195091,19509
 0000bcd0: 322c 3139 3530 3933 2c31 3935 3039 342c  2,195093,195094,
 0000bce0: 3139 3530 3935 2c31 3935 3039 362c 3139  195095,195096,19
 0000bcf0: 3530 3937 2c31 3935 3039 382c 3139 3530  5097,195098,1950
 0000bd00: 3939 2c31 3935 3130 302c 3139 3531 3031  99,195100,195101
-0000bd10: 5d7d                                     ]}
+0000bd10: 5d7d 0a                                  ]}.
```

### Comparing `web3-7.0.0b3/ens/specs/normalization_spec.json` & `web3-7.0.0b4/ens/specs/normalization_spec.json`

 * *Format-specific differences are supported for JSON files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: JSON text data*

 * *Files 0% similar despite different names*

```diff
@@ -194702,8 +194702,8 @@
 002f88d0: 3134 312c 3132 3431 3432 2c31 3234 3134  141,124142,12414
 002f88e0: 332c 3132 3531 3336 2c31 3235 3133 372c  3,125136,125137,
 002f88f0: 3132 3531 3338 2c31 3235 3133 392c 3132  125138,125139,12
 002f8900: 3531 3430 2c31 3235 3134 312c 3132 3531  5140,125141,1251
 002f8910: 3432 2c31 3235 3235 322c 3132 3532 3533  42,125252,125253
 002f8920: 2c31 3235 3235 342c 3132 3532 3535 2c31  ,125254,125255,1
 002f8930: 3235 3235 362c 3132 3532 3537 2c31 3235  25256,125257,125
-002f8940: 3235 385d 7d                             258]}
+002f8940: 3235 385d 7d0a                           258]}.
```

### Comparing `web3-7.0.0b3/ens/utils.py` & `web3-7.0.0b4/ens/utils.py`

 * *Files 3% similar despite different names*

```diff
@@ -31,14 +31,19 @@
 from eth_utils.abi import (
     collapse_if_tuple,
 )
 from hexbytes import (
     HexBytes,
 )
 
+from ens.exceptions import (
+    ENSTypeError,
+    ENSValueError,
+)
+
 from .constants import (
     ACCEPTABLE_STALE_HOURS,
     AUCTION_START_GAS_CONSTANT,
     AUCTION_START_GAS_MARGINAL,
     EMPTY_ADDR_HEX,
     EMPTY_SHA3_BYTES,
     REVERSE_REGISTRAR_DOMAIN,
@@ -73,24 +78,25 @@
         Web3 as Web3Main,
     )
 
     return Web3Main
 
 
 def init_web3(
-    provider: "BaseProvider" = cast("BaseProvider", default),
+    provider: "BaseProvider" = None,
     middleware: Optional[Sequence[Tuple["Middleware", str]]] = None,
 ) -> "_Web3":
     from web3 import (
         Web3 as Web3Main,
     )
     from web3.eth import (
         Eth as EthMain,
     )
 
+    provider = provider or cast("BaseProvider", default)
     if provider is default:
         w3 = Web3Main(ens=None, modules={"eth": (EthMain)})
     else:
         w3 = Web3Main(provider, middleware, ens=None, modules={"eth": (EthMain)})
 
     return customize_web3(w3)
 
@@ -131,15 +137,15 @@
     elif isinstance(name, (bytes, bytearray)):
         name = name.decode("utf-8")
 
     return normalize_name_ensip15(name).as_text
 
 
 def ens_encode_name(name: str) -> bytes:
-    """
+    r"""
     Encode a name according to DNS standards specified in section 3.1
     of RFC1035 with the following validations:
 
         - There is no limit on the total length of the encoded name
         and the limit on labels is the ENS standard of 255.
 
         - Return a single 0-octet, b'\x00', if empty name.
@@ -195,25 +201,25 @@
         val = val.encode("utf-8")
     return Web3().keccak(val)
 
 
 def label_to_hash(label: str) -> HexBytes:
     label = normalize_name(label)
     if "." in label:
-        raise ValueError(f"Cannot generate hash for label {label!r} with a '.'")
+        raise ENSValueError(f"Cannot generate hash for label {label!r} with a '.'")
     return Web3().keccak(text=label)
 
 
 def normal_name_to_hash(name: str) -> HexBytes:
     """
-    This method will not normalize the name. 'normal' name here means the name
-    should already be normalized before calling this method.
+    Hashes a pre-normalized name.
+    The normalization of the name is a prerequisite and is not handled by this function.
 
-    :param name:            the name to hash - should already be normalized
-    :return: namehash       the hash of the name
+    :param str name: A normalized name string to be hashed.
+    :return: namehash - the hash of the name
     :rtype: HexBytes
     """
     node = EMPTY_SHA3_BYTES
     if not is_empty_name(name):
         labels = name.split(".")
         for label in reversed(labels):
             labelhash = label_to_hash(label)
@@ -260,15 +266,15 @@
 
 def assert_signer_in_modifier_kwargs(modifier_kwargs: Any) -> ChecksumAddress:
     ERR_MSG = "You must specify the sending account"
     assert len(modifier_kwargs) == 1, ERR_MSG
 
     _modifier_type, modifier_dict = dict(modifier_kwargs).popitem()
     if "from" not in modifier_dict:
-        raise TypeError(ERR_MSG)
+        raise ENSTypeError(ERR_MSG)
 
     return modifier_dict["from"]
 
 
 def is_none_or_zero_address(addr: Union[Address, ChecksumAddress, HexAddress]) -> bool:
     return not addr or addr == EMPTY_ADDR_HEX
 
@@ -296,29 +302,30 @@
     )
 
 
 # -- async -- #
 
 
 def init_async_web3(
-    provider: "AsyncBaseProvider" = cast("AsyncBaseProvider", default),
+    provider: "AsyncBaseProvider" = None,
     middleware: Optional[Sequence[Tuple["Middleware", str]]] = (),
 ) -> "AsyncWeb3":
     from web3 import (
         AsyncWeb3 as AsyncWeb3Main,
     )
     from web3.eth import (
         AsyncEth as AsyncEthMain,
     )
     from web3.middleware import (
         StalecheckMiddlewareBuilder,
     )
 
+    provider = provider or cast("AsyncBaseProvider", default)
     middleware = list(middleware)
-    for i, (mw, name) in enumerate(middleware):
+    for i, (_mw, name) in enumerate(middleware):
         if name == "ens_name_to_address":
             middleware.pop(i)
 
     if "stalecheck" not in (name for mw, name in middleware):
         middleware.append(
             (
                 StalecheckMiddlewareBuilder.build(ACCEPTABLE_STALE_HOURS * 3600),
```

### Comparing `web3-7.0.0b3/setup.py` & `web3-7.0.0b4/setup.py`

 * *Files 9% similar despite different names*

```diff
@@ -2,78 +2,66 @@
 from setuptools import (
     find_packages,
     setup,
 )
 
 extras_require = {
     "tester": [
-        "eth-tester[py-evm]==v0.10.0-b.3",
+        "eth-tester[py-evm]>=0.11.0b1,<0.12.0b1",
         "py-geth>=4.1.0",
     ],
-    "linter": [
-        "black>=22.1.0",
-        "blocklint>=0.2.4",
-        "flake8==3.8.3",
-        "isort>=5.11.0",
-        "mypy==1.4.1",
-        "types-setuptools>=57.4.4",
-        "types-requests>=2.26.1",
-    ],
     "docs": [
         "sphinx>=5.3.0",
         "sphinx_rtd_theme>=1.0.0",
         "towncrier>=21,<22",
     ],
     "dev": [
+        "build>=0.9.0",
         "bumpversion",
         "flaky>=3.7.0",
         "hypothesis>=3.31.2",
-        "importlib-metadata<5.0;python_version<'3.8'",
-        "pytest>=7.0.0",
+        "pre-commit>=3.4.0",
         "pytest-asyncio>=0.18.1,<0.23",
         "pytest-mock>=1.10",
         "pytest-watch>=4.2",
         "pytest-xdist>=1.29",
+        "pytest>=7.0.0",
         "setuptools>=38.6.0",
         "tox>=3.18.0",
         "tqdm>4.32",
         "twine>=1.13",
-        "build>=0.9.0",
     ],
 }
 
 extras_require["dev"] = (
-    extras_require["tester"]
-    + extras_require["linter"]
-    + extras_require["docs"]
-    + extras_require["dev"]
+    extras_require["tester"] + extras_require["docs"] + extras_require["dev"]
 )
 
 with open("./README.md") as readme:
     long_description = readme.read()
 
 setup(
     name="web3",
     # *IMPORTANT*: Don't manually change the version here. Use the 'bumpversion' utility.
-    version="7.0.0-beta.3",
+    version="7.0.0-beta.4",
     description="""web3.py""",
     long_description_content_type="text/markdown",
     long_description=long_description,
     author="The Ethereum Foundation",
     author_email="snakecharmers@ethereum.org",
     url="https://github.com/ethereum/web3.py",
     include_package_data=True,
     install_requires=[
         "aiohttp>=3.7.4.post0",
-        "eth-abi>=4.0.0",
-        "eth-account>=0.8.0",
+        "eth-abi>=5.0.1",
+        "eth-account>=0.12.0",
         "eth-hash[pycryptodome]>=0.5.1",
-        "eth-typing>=3.0.0",
+        "eth-typing>=4.0.0",
         "eth-utils>=4.0.0",
-        "hexbytes>=0.1.0,<0.4.0",
+        "hexbytes>=1.2.0",
         "pydantic>=2.4.0",
         "pywin32>=223;platform_system=='Windows'",
         "requests>=2.16.0",
         "typing-extensions>=4.0.1",
         "websockets>=10.0.0",
         "pyunormalize>=15.0.0",
     ],
```

### Comparing `web3-7.0.0b3/web3/__init__.py` & `web3-7.0.0b4/web3/__init__.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,18 +1,13 @@
 from eth_account import Account  # noqa: E402
 import sys
 
-if sys.version_info.major == 3 and sys.version_info.minor < 8:
-    import pkg_resources
+from importlib.metadata import version
 
-    __version__ = pkg_resources.get_distribution("web3").version
-else:
-    from importlib.metadata import version
-
-    __version__ = version("web3")
+__version__ = version("web3")
 
 
 from web3.main import (
     AsyncWeb3,
     Web3,
 )
 from web3.providers.persistent import (  # noqa: E402
```

### Comparing `web3-7.0.0b3/web3/_utils/abi.py` & `web3-7.0.0b4/web3/_utils/abi.py`

 * *Files 2% similar despite different names*

```diff
@@ -76,14 +76,17 @@
 )
 from web3._utils.formatters import (
     recursive_map,
 )
 from web3.exceptions import (
     FallbackNotFound,
     MismatchedABI,
+    Web3AttributeError,
+    Web3TypeError,
+    Web3ValueError,
 )
 from web3.types import (
     ABI,
     ABIEvent,
     ABIEventParams,
     ABIFunction,
     ABIFunctionParams,
@@ -183,24 +186,26 @@
         abi
         for abi in contract_abi
         if set(argument_names).intersection(get_abi_input_names(abi))
         == set(argument_names)
     ]
 
 
-class AddressEncoder(encoding.AddressEncoder):
+# type ignored because subclassing encoding.AddressEncoder which has type Any
+class AddressEncoder(encoding.AddressEncoder):  # type: ignore[misc]
     @classmethod
     def validate_value(cls, value: Any) -> None:
         if is_ens_name(value):
             return
 
         super().validate_value(value)
 
 
-class AcceptsHexStrEncoder(encoding.BaseEncoder):
+# type ignored because subclassing encoding.BytesEncoder which has type Any
+class AcceptsHexStrEncoder(encoding.BaseEncoder):  # type: ignore[misc]
     subencoder_cls: Type[encoding.BaseEncoder] = None
     is_strict: bool = None
     is_big_endian: bool = False
     data_byte_size: int = None
     value_bit_size: int = None
 
     def __init__(
@@ -223,15 +228,15 @@
             encoding.BaseEncoder, subencoder_cls.from_type_str(abi_type, registry)
         )
         return cls(subencoder)
 
     @classmethod
     def get_subencoder_class(cls) -> Type[encoding.BaseEncoder]:
         if cls.subencoder_cls is None:
-            raise AttributeError(f"No subencoder class is set. {cls.__name__}")
+            raise Web3AttributeError(f"No subencoder class is set. {cls.__name__}")
         return cls.subencoder_cls
 
     def validate_value(self, value: Any) -> None:
         normalized_value = self.validate_and_normalize(value)
         self.subencoder.validate_value(normalized_value)
 
     def encode(self, value: Any) -> bytes:
@@ -283,38 +288,36 @@
 
 class ExactLengthBytesEncoder(BytesEncoder):
     is_strict = True
 
     def validate(self) -> None:
         super().validate()
         if self.value_bit_size is None:
-            raise ValueError("`value_bit_size` may not be none")
+            raise Web3ValueError("`value_bit_size` may not be none")
         if self.data_byte_size is None:
-            raise ValueError("`data_byte_size` may not be none")
+            raise Web3ValueError("`data_byte_size` may not be none")
         if self.is_big_endian is None:
-            raise ValueError("`is_big_endian` may not be none")
+            raise Web3ValueError("`is_big_endian` may not be none")
 
         if self.value_bit_size % 8 != 0:
-            raise ValueError(
+            raise Web3ValueError(
                 f"Invalid value bit size: {self.value_bit_size}. "
                 "Must be a multiple of 8"
             )
 
         if self.value_bit_size > self.data_byte_size * 8:
-            raise ValueError("Value byte size exceeds data size")
+            raise Web3ValueError("Value byte size exceeds data size")
 
     @parse_type_str("bytes")
     def from_type_str(
         cls, abi_type: BasicType, registry: ABIRegistry
     ) -> "ExactLengthBytesEncoder":
         subencoder_cls = cls.get_subencoder_class()
         subencoder = subencoder_cls.from_type_str(abi_type.to_type_str(), registry)
-        # type ignored b/c @parse_type_str decorator turns it into a classmethod,
-        # so mypy thinks cls(...) is a call to __call__, but actually calls __init__
-        return cls(  # type: ignore
+        return cls(
             subencoder,
             value_bit_size=abi_type.sub * 8,
             data_byte_size=abi_type.sub,
         )
 
 
 class ByteStringEncoder(AcceptsHexStrEncoder):
@@ -323,15 +326,16 @@
 
 
 class StrictByteStringEncoder(AcceptsHexStrEncoder):
     subencoder_cls = encoding.ByteStringEncoder
     is_strict = True
 
 
-class TextStringEncoder(encoding.TextStringEncoder):
+# type ignored because subclassing encoding.TextStringEncoder which has type Any
+class TextStringEncoder(encoding.TextStringEncoder):  # type: ignore[misc]
     @classmethod
     def validate_value(cls, value: Any) -> None:
         if is_bytes(value):
             try:
                 value = to_text(value)
             except UnicodeDecodeError:
                 cls.invalidate_value(
@@ -390,15 +394,15 @@
     described by ``function_abi``.  Checks to ensure that the correct number of
     args were given, no duplicate args were given, and no unknown args were
     given.  Returns a list of argument values aligned to the order of inputs
     defined in ``function_abi``.
     """
     # Ensure the function is being applied to the correct number of args
     if len(args) + len(kwargs) != len(function_abi.get("inputs", [])):
-        raise TypeError(
+        raise Web3TypeError(
             f"Incorrect argument count. Expected '{len(function_abi['inputs'])}'"
             f". Got '{len(args) + len(kwargs)}'"
         )
 
     # If no keyword args were given, we don't need to align them
     if not kwargs:
         return cast(Tuple[Any, ...], args)
@@ -406,28 +410,28 @@
     kwarg_names = set(kwargs.keys())
     sorted_arg_names = tuple(arg_abi["name"] for arg_abi in function_abi["inputs"])
     args_as_kwargs = dict(zip(sorted_arg_names, args))
 
     # Check for duplicate args
     duplicate_args = kwarg_names.intersection(args_as_kwargs.keys())
     if duplicate_args:
-        raise TypeError(
+        raise Web3TypeError(
             f"{function_abi.get('name')}() got multiple values for argument(s) "
             f"'{', '.join(duplicate_args)}'"
         )
 
     # Check for unknown args
     unknown_args = kwarg_names.difference(sorted_arg_names)
     if unknown_args:
         if function_abi.get("name"):
-            raise TypeError(
+            raise Web3TypeError(
                 f"{function_abi.get('name')}() got unexpected keyword argument(s)"
                 f" '{', '.join(unknown_args)}'"
             )
-        raise TypeError(
+        raise Web3TypeError(
             f"Type: '{function_abi.get('type')}' got unexpected keyword argument(s)"
             f" '{', '.join(unknown_args)}'"
         )
 
     # Sort args according to their position in the ABI and unzip them from their
     # names
     sorted_args = tuple(
@@ -493,15 +497,15 @@
     if isinstance(arg, abc.Mapping):
         # Arg is mapping.  Align values according to abi order.
         aligned_arg = tuple(arg[abi["name"]] for abi in sub_abis)
     else:
         aligned_arg = arg
 
     if not is_list_like(aligned_arg):
-        raise TypeError(
+        raise Web3TypeError(
             f'Expected non-string sequence for "{arg_abi.get("type")}" '
             f"component type: got {aligned_arg}"
         )
 
     # convert NamedTuple to regular tuple
     typing = tuple if isinstance(aligned_arg, tuple) else type(aligned_arg)
 
@@ -524,29 +528,27 @@
     input_abis = abi.get("inputs", [])
 
     if isinstance(args, abc.Mapping):
         # `args` is mapping.  Align values according to abi order.
         args = tuple(args[abi["name"]] for abi in input_abis)
 
     return (
-        # typed dict cannot be used w/ a normal Dict
-        # https://github.com/python/mypy/issues/4976
-        tuple(collapse_if_tuple(abi) for abi in input_abis),  # type: ignore
+        tuple(collapse_if_tuple(abi) for abi in input_abis),
         type(args)(_align_abi_input(abi, arg) for abi, arg in zip(input_abis, args)),
     )
 
 
 def get_constructor_abi(contract_abi: ABI) -> ABIFunction:
     candidates = [abi for abi in contract_abi if abi["type"] == "constructor"]
     if len(candidates) == 1:
         return candidates[0]
     elif len(candidates) == 0:
         return None
     elif len(candidates) > 1:
-        raise ValueError("Found multiple constructors.")
+        raise Web3ValueError("Found multiple constructors.")
     return None
 
 
 DYNAMIC_TYPES = ["bytes", "string"]
 
 INT_SIZES = range(8, 257, 8)
 BYTES_SIZES = range(1, 33)
@@ -560,15 +562,15 @@
         UINT_TYPES,
         INT_TYPES,
         BYTES_TYPES,
     )
 )
 
 BASE_TYPE_REGEX = "|".join(
-    (_type + "(?![a-z0-9])" for _type in itertools.chain(STATIC_TYPES, DYNAMIC_TYPES))
+    _type + "(?![a-z0-9])" for _type in itertools.chain(STATIC_TYPES, DYNAMIC_TYPES)
 )
 
 SUB_TYPE_REGEX = r"\[" "[0-9]*" r"\]"
 
 TYPE_REGEX = ("^" "(?:{base_type})" "(?:(?:{sub_type})*)?" "$").format(
     base_type=BASE_TYPE_REGEX,
     sub_type=SUB_TYPE_REGEX,
@@ -626,22 +628,22 @@
 
 
 END_BRACKETS_OF_ARRAY_TYPE_REGEX = r"\[[^]]*\]$"
 
 
 def sub_type_of_array_type(abi_type: TypeStr) -> str:
     if not is_array_type(abi_type):
-        raise ValueError(f"Cannot parse subtype of nonarray abi-type: {abi_type}")
+        raise Web3ValueError(f"Cannot parse subtype of nonarray abi-type: {abi_type}")
 
-    return re.sub(END_BRACKETS_OF_ARRAY_TYPE_REGEX, "", abi_type, 1)
+    return re.sub(END_BRACKETS_OF_ARRAY_TYPE_REGEX, "", abi_type, count=1)
 
 
 def length_of_array_type(abi_type: TypeStr) -> int:
     if not is_array_type(abi_type):
-        raise ValueError(f"Cannot parse length of nonarray abi-type: {abi_type}")
+        raise Web3ValueError(f"Cannot parse length of nonarray abi-type: {abi_type}")
 
     inner_brackets = (
         re.search(END_BRACKETS_OF_ARRAY_TYPE_REGEX, abi_type).group(0).strip("[]")
     )
     if not inner_brackets:
         return None
     else:
@@ -701,16 +703,16 @@
 @curry
 def map_abi_data(
     normalizers: Sequence[Callable[[TypeStr, Any], Tuple[TypeStr, Any]]],
     types: Sequence[TypeStr],
     data: Sequence[Any],
 ) -> Any:
     """
-    This function will apply normalizers to your data, in the
-    context of the relevant types. Each normalizer is in the format:
+    Applies normalizers to your data, in the context of the relevant types.
+    Each normalizer is in the format:
 
     def normalizer(datatype, data):
         # Conditionally modify data
         return (datatype, data)
 
     Where datatype is a valid ABI type string, like "uint".
 
@@ -768,15 +770,15 @@
             return elements
 
     return recursive_map(map_to_typed_data, data_tree)
 
 
 class ABITypedData(namedtuple("ABITypedData", "abi_type, data")):
     """
-    This class marks data as having a certain ABI-type.
+    Marks data as having a certain ABI-type.
 
     >>> a1 = ABITypedData(['address', addr1])
     >>> a2 = ABITypedData(['address', addr2])
     >>> addrs = ABITypedData(['address[]', [a1, a2]])
 
     You can access the fields using tuple() interface, or with
     attributes:
@@ -1025,15 +1027,14 @@
 async def async_map_if_collection(
     func: Callable[[Any], Coroutine[Any, Any, Any]], value: Any
 ) -> Any:
     """
     Apply an awaitable method to each element of a collection or value of a dictionary.
     If the value is not a collection, return it unmodified.
     """
-
     datatype = type(value)
     if isinstance(value, Mapping):
         return datatype({key: await func(val) for key, val in value.values()})
     if is_string(value):
         return value
     elif isinstance(value, Iterable):
         return datatype([await func(item) for item in value])
```

### Comparing `web3-7.0.0b3/web3/_utils/async_transactions.py` & `web3-7.0.0b4/web3/_utils/async_transactions.py`

 * *Files 2% similar despite different names*

```diff
@@ -20,14 +20,17 @@
 )
 from web3._utils.utility_methods import (
     any_in_dict,
 )
 from web3.constants import (
     DYNAMIC_FEE_TXN_PARAMS,
 )
+from web3.exceptions import (
+    Web3ValueError,
+)
 from web3.types import (
     BlockIdentifier,
     TxData,
     TxParams,
     Wei,
     _Hash32,
 )
@@ -83,15 +86,15 @@
     gas_estimate_transaction = cast(TxParams, dict(**transaction))
 
     gas_estimate = await async_w3.eth.estimate_gas(gas_estimate_transaction)
 
     gas_limit = await get_block_gas_limit(async_w3.eth)
 
     if gas_estimate > gas_limit:
-        raise ValueError(
+        raise Web3ValueError(
             "Contract does not appear to be deployable within the "
             f"current network gas limits.  Estimated: {gas_estimate}. "
             f"Current gas limit: {gas_limit}"
         )
 
     return min(gas_limit, gas_estimate + gas_buffer)
 
@@ -106,15 +109,15 @@
     return transaction
 
 
 async def async_fill_transaction_defaults(
     async_w3: "AsyncWeb3", transaction: TxParams
 ) -> TxParams:
     """
-    if async_w3 is None, fill as much as possible while offline
+    If async_w3 is None, fill as much as possible while offline
     """
     strategy_based_gas_price = async_w3.eth.generate_gas_price(transaction)
 
     is_dynamic_fee_transaction = strategy_based_gas_price is None and (
         "gasPrice" not in transaction  # default to dynamic fee transaction
         or any_in_dict(DYNAMIC_FEE_TXN_PARAMS, transaction)
     )
@@ -130,15 +133,15 @@
             ):
                 # do not set default max fees if legacy txn or
                 # gas price if dynamic fee txn
                 continue
 
             if callable(default_getter):
                 if async_w3 is None:
-                    raise ValueError(
+                    raise Web3ValueError(
                         f"You must specify a '{key}' value in the transaction"
                     )
                 if key == "gasPrice":
                     # `generate_gas_price()` is on the `BaseEth` class and does not
                     # need to be awaited
                     default_val = default_getter(async_w3, transaction)
                 else:
@@ -151,15 +154,15 @@
 
 
 async def async_get_required_transaction(
     async_w3: "AsyncWeb3", transaction_hash: _Hash32
 ) -> TxData:
     current_transaction = await async_w3.eth.get_transaction(transaction_hash)
     if not current_transaction:
-        raise ValueError(
+        raise Web3ValueError(
             f"Supplied transaction with hash {transaction_hash!r} does not exist"
         )
     return current_transaction
 
 
 async def async_replace_transaction(
     async_w3: "AsyncWeb3", current_transaction: TxData, new_transaction: TxParams
```

### Comparing `web3-7.0.0b3/web3/_utils/blocks.py` & `web3-7.0.0b4/web3/_utils/blocks.py`

 * *Files 4% similar despite different names*

```diff
@@ -11,14 +11,18 @@
     is_text,
     remove_0x_prefix,
 )
 from eth_utils.toolz import (
     curry,
 )
 
+from web3.exceptions import (
+    Web3TypeError,
+    Web3ValueError,
+)
 from web3.types import (
     RPCEndpoint,
 )
 
 
 def is_predefined_block_number(value: Any) -> bool:
     if is_text(value):
@@ -28,15 +32,15 @@
         # one of the words in: {"latest", "pending", "earliest", "safe", "finalized"}
         # We cannot decode the bytes as utf8, because random bytes likely won't be
         # valid. So we speculatively decode as 'latin-1', which cannot fail.
         value_text = value.decode("latin-1")
     elif is_integer(value):
         return False
     else:
-        raise TypeError(f"unrecognized block reference: {value!r}")
+        raise Web3TypeError(f"unrecognized block reference: {value!r}")
 
     return value_text in {"latest", "pending", "earliest", "safe", "finalized"}
 
 
 def is_hex_encoded_block_hash(value: Any) -> bool:
     if not is_string(value):
         return False
@@ -66,10 +70,10 @@
     elif is_hex_encoded_block_hash(value):
         return if_hash
     elif is_integer(value) and (0 <= value < 2**256):
         return if_number
     elif is_hex_encoded_block_number(value):
         return if_number
     else:
-        raise ValueError(
+        raise Web3ValueError(
             f"Value did not match any of the recognized block identifiers: {value}"
         )
```

### Comparing `web3-7.0.0b3/web3/_utils/caching.py` & `web3-7.0.0b4/web3/_utils/caching.py`

 * *Files 2% similar despite different names*

```diff
@@ -19,14 +19,18 @@
     is_list_like,
     is_null,
     is_number,
     is_text,
     to_bytes,
 )
 
+from web3.exceptions import (
+    Web3TypeError,
+)
+
 if TYPE_CHECKING:
     from web3.providers import (  # noqa: F401
         AsyncBaseProvider,
         BaseProvider,
     )
     from web3.types import (  # noqa: F401
         AsyncMakeRequestFn,
@@ -47,19 +51,19 @@
     if is_bytes(value):
         return hashlib.md5(value).hexdigest()
     elif is_text(value):
         return generate_cache_key(to_bytes(text=value))
     elif is_boolean(value) or is_null(value) or is_number(value):
         return generate_cache_key(repr(value))
     elif is_dict(value):
-        return generate_cache_key(((key, value[key]) for key in sorted(value.keys())))
+        return generate_cache_key((key, value[key]) for key in sorted(value.keys()))
     elif is_list_like(value) or isinstance(value, collections.abc.Generator):
-        return generate_cache_key("".join((generate_cache_key(item) for item in value)))
+        return generate_cache_key("".join(generate_cache_key(item) for item in value))
     else:
-        raise TypeError(
+        raise Web3TypeError(
             f"Cannot generate cache key for value {value} of type {type(value)}"
         )
 
 
 class RequestInformation:
     def __init__(
         self,
```

### Comparing `web3-7.0.0b3/web3/_utils/compat/__init__.py` & `web3-7.0.0b4/web3/_utils/compat/__init__.py`

 * *Files 18% similar despite different names*

```diff
@@ -5,13 +5,10 @@
 # because `typing_extensions` will do it for us and either import from `typing`
 # or use the back-ported version of the type.
 
 # Once web3 supports >= the noted python version, the type may be directly
 # imported from `typing`
 
 from typing_extensions import (
-    Literal,  # py38
     NotRequired,  # py311
-    Protocol,  # py38
-    TypedDict,  # py38
     Self,  # py311
 )
```

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/compile_contracts.py` & `web3-7.0.0b4/web3/_utils/contract_sources/compile_contracts.py`

 * *Files 0% similar despite different names*

```diff
@@ -112,15 +112,15 @@
 
 
 contracts_in_file = {}
 
 
 def compile_files(file_list: List[str]) -> None:
     for filename in file_list:
-        with open(os.path.join(os.getcwd(), filename), "r") as f:
+        with open(os.path.join(os.getcwd(), filename)) as f:
             dot_sol_file = f.readlines()
 
         contract_names = []
 
         for line in dot_sol_file:
             if all(_ in line for _ in ["contract", "{"]) and "abstract" not in line:
                 start_index = line.find("contract ") + len("contract ")
```

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/_custom_contract_data.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/_custom_contract_data.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/address_reflector.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/address_reflector.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/arrays_contract.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/arrays_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/bytes_contracts.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/bytes_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/constructor_contracts.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/constructor_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/contract_caller_tester.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/contract_caller_tester.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/emitter_contract.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/emitter_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/event_contracts.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/event_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/extended_resolver.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/extended_resolver.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/fallback_function_contract.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/fallback_function_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/function_name_tester_contract.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/function_name_tester_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/math_contract.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/math_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/offchain_lookup.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/offchain_lookup.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/offchain_resolver.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/offchain_resolver.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/panic_errors_contract.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/panic_errors_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/payable_tester.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/payable_tester.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/receive_function_contracts.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/receive_function_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/reflector_contracts.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/reflector_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/revert_contract.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/revert_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/simple_resolver.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/simple_resolver.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/storage_contract.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/storage_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/string_contract.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/string_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contract_sources/contract_data/tuple_contracts.py` & `web3-7.0.0b4/web3/_utils/contract_sources/contract_data/tuple_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/contracts.py` & `web3-7.0.0b4/web3/_utils/contracts.py`

 * *Files 4% similar despite different names*

```diff
@@ -72,15 +72,17 @@
     abi_address_to_hex,
     abi_bytes_to_bytes,
     abi_ens_resolver,
     abi_string_to_text,
 )
 from web3.exceptions import (
     BlockNumberOutofRange,
+    Web3TypeError,
     Web3ValidationError,
+    Web3ValueError,
 )
 from web3.types import (
     ABI,
     ABIEvent,
     ABIFunction,
     BlockIdentifier,
     BlockNumber,
@@ -132,17 +134,17 @@
         filters.append(functools.partial(filter_by_argument_name, argument_names))
 
     event_abi_candidates = pipe(abi, *filters)
 
     if len(event_abi_candidates) == 1:
         return event_abi_candidates[0]
     elif not event_abi_candidates:
-        raise ValueError("No matching events found")
+        raise Web3ValueError("No matching events found")
     else:
-        raise ValueError("Multiple events found")
+        raise Web3ValueError("Multiple events found")
 
 
 def find_matching_fn_abi(
     abi: ABI,
     abi_codec: ABICodec,
     fn_identifier: Optional[Union[str, Type[FallbackFn], Type[ReceiveFn]]] = None,
     args: Optional[Sequence[Any]] = None,
@@ -155,15 +157,15 @@
     if fn_identifier is FallbackFn:
         return get_fallback_func_abi(abi)
 
     if fn_identifier is ReceiveFn:
         return get_receive_func_abi(abi)
 
     if not is_text(fn_identifier):
-        raise TypeError("Unsupported function identifier")
+        raise Web3TypeError("Unsupported function identifier")
 
     name_filter = functools.partial(filter_by_name, fn_identifier)
     arg_count_filter = functools.partial(filter_by_argument_count, num_arguments)
     encoding_filter = functools.partial(filter_by_encodability, abi_codec, args, kwargs)
 
     function_candidates = pipe(abi, name_filter, arg_count_filter, encoding_filter)
 
@@ -213,15 +215,15 @@
     abi: ABIFunction,
     arguments: Sequence[Any],
     data: Optional[HexStr] = None,
 ) -> HexStr:
     argument_types = get_abi_input_types(abi)
 
     if not check_if_arguments_can_be_encoded(abi, w3.codec, arguments, {}):
-        raise TypeError(
+        raise Web3TypeError(
             "One or more arguments could not be encoded to the necessary "
             f"ABI type. Expected types are: {', '.join(argument_types)}"
         )
 
     normalizers = [
         abi_address_to_hex,
         abi_bytes_to_bytes,
@@ -270,15 +272,15 @@
 
     if transaction is None:
         prepared_transaction: TxParams = {}
     else:
         prepared_transaction = cast(TxParams, dict(**transaction))
 
     if "data" in prepared_transaction:
-        raise ValueError("Transaction parameter may not contain a 'data' key")
+        raise Web3ValueError("Transaction parameter may not contain a 'data' key")
 
     if address:
         prepared_transaction.setdefault("to", address)
 
     prepared_transaction["data"] = encode_transaction_data(
         w3,
         fn_identifier,
@@ -313,26 +315,25 @@
             w3.codec,
             contract_abi,
             fn_abi,
             args,
             kwargs,
         )
     else:
-        raise TypeError("Unsupported function identifier")
+        raise Web3TypeError("Unsupported function identifier")
 
     return add_0x_prefix(encode_abi(w3, fn_abi, fn_arguments, fn_selector))
 
 
 def decode_transaction_data(
     fn_abi: ABIFunction,
     data: HexStr,
     normalizers: Sequence[Callable[[TypeStr, Any], Tuple[TypeStr, Any]]] = None,
 ) -> Dict[str, Any]:
-    # type ignored b/c expects data arg to be HexBytes
-    data = HexBytes(data)  # type: ignore
+    data = HexBytes(data)
     types = get_abi_input_types(fn_abi)
     abi_codec = ABICodec(default_registry)
     decoded = abi_codec.decode(types, HexBytes(data[4:]))
     if normalizers:
         decoded = map_abi_data(normalizers, types, decoded)
     return named_tree(fn_abi["inputs"], decoded)
 
@@ -369,27 +370,26 @@
         args = tuple()
     if kwargs is None:
         kwargs = {}
 
     if fn_abi is None:
         fn_abi = find_matching_fn_abi(contract_abi, abi_codec, fn_name, args, kwargs)
 
-    # typed dict cannot be used w/ a normal Dict
-    # https://github.com/python/mypy/issues/4976
-    fn_selector = encode_hex(function_abi_to_4byte_selector(fn_abi))  # type: ignore
+    fn_selector = encode_hex(function_abi_to_4byte_selector(fn_abi))
 
     fn_arguments = merge_args_and_kwargs(fn_abi, args, kwargs)
 
     _, aligned_fn_arguments = get_aligned_abi_inputs(fn_abi, fn_arguments)
 
     return fn_abi, fn_selector, aligned_fn_arguments
 
 
 def validate_payable(transaction: TxParams, abi: ABIFunction) -> None:
-    """Raise Web3ValidationError if non-zero ether
+    """
+    Raise Web3ValidationError if non-zero ether
     is sent to a non-payable function.
     """
     if "value" in transaction:
         if to_integer_if_hex(transaction["value"]) != 0:
             if (
                 "payable" in abi
                 and not abi["payable"]
```

### Comparing `web3-7.0.0b3/web3/_utils/datatypes.py` & `web3-7.0.0b4/web3/_utils/datatypes.py`

 * *Files 4% similar despite different names*

```diff
@@ -10,18 +10,22 @@
 from eth_utils import (
     apply_formatters_to_dict,
 )
 from eth_utils.toolz import (
     concat,
 )
 
+from web3.exceptions import (
+    Web3AttributeError,
+)
+
 
 def verify_attr(class_name: str, key: str, namespace: Collection[str]) -> None:
     if key not in namespace:
-        raise AttributeError(
+        raise Web3AttributeError(
             f"Property {key} not found on {class_name} class. "
             f"`{class_name}.factory` only accepts keyword arguments which are "
             f"present on the {class_name} class"
         )
 
 
 class PropertyCheckingFactory(type):
```

### Comparing `web3-7.0.0b3/web3/_utils/decorators.py` & `web3-7.0.0b4/web3/_utils/decorators.py`

 * *Files 10% similar despite different names*

```diff
@@ -4,14 +4,18 @@
     Any,
     Callable,
     TypeVar,
     cast,
 )
 import warnings
 
+from web3.exceptions import (
+    Web3ValueError,
+)
+
 TFunc = TypeVar("TFunc", bound=Callable[..., Any])
 
 
 def reject_recursive_repeats(to_wrap: Callable[..., Any]) -> Callable[..., Any]:
     """
     Prevent simple cycles by returning None when called recursively with same instance
     """
@@ -20,15 +24,15 @@
 
     @functools.wraps(to_wrap)
     def wrapped(*args: Any) -> Any:
         arg_instances = tuple(map(id, args))
         thread_id = threading.get_ident()
         thread_local_args = (thread_id,) + arg_instances
         if thread_local_args in to_wrap.__already_called:  # type: ignore
-            raise ValueError(f"Recursively called {to_wrap} with {args!r}")
+            raise Web3ValueError(f"Recursively called {to_wrap} with {args!r}")
         to_wrap.__already_called[thread_local_args] = True  # type: ignore
         try:
             wrapped_val = to_wrap(*args)
         finally:
             del to_wrap.__already_called[thread_local_args]  # type: ignore
         return wrapped_val
 
@@ -46,13 +50,14 @@
 
     def decorator(to_wrap: TFunc) -> TFunc:
         @functools.wraps(to_wrap)
         def wrapper(*args: Any, **kwargs: Any) -> Callable[..., Any]:
             warnings.warn(
                 f"{to_wrap.__name__} is deprecated in favor of {replace_message}",
                 category=DeprecationWarning,
+                stacklevel=2,
             )
             return to_wrap(*args, **kwargs)
 
         return cast(TFunc, wrapper)
 
     return decorator
```

### Comparing `web3-7.0.0b3/web3/_utils/encoding.py` & `web3-7.0.0b4/web3/_utils/encoding.py`

 * *Files 6% similar despite different names*

```diff
@@ -51,14 +51,18 @@
 from web3._utils.validation import (
     validate_abi_type,
     validate_abi_value,
 )
 from web3.datastructures import (
     AttributeDict,
 )
+from web3.exceptions import (
+    Web3TypeError,
+    Web3ValueError,
+)
 
 
 def hex_encode_abi_type(
     abi_type: TypeStr, value: Any, force_size: Optional[int] = None
 ) -> HexStr:
     """
     Encodes value into a hex string in format of abi_type
@@ -86,15 +90,15 @@
         if is_bytes(value):
             return encode_hex(value)
         else:
             return value
     elif is_string_type(abi_type):
         return to_hex(text=value)
     else:
-        raise ValueError(f"Unsupported ABI type: {abi_type}")
+        raise Web3ValueError(f"Unsupported ABI type: {abi_type}")
 
 
 def to_hex_twos_compliment(value: Any, bit_size: int) -> HexStr:
     """
     Converts integer value to twos compliment hex representation with given bit_size
     """
     if value >= 0:
@@ -165,15 +169,15 @@
     @param to_type is a function that takes the arguments (primitive, hexstr=hexstr,
         text=text), eg~ to_bytes, to_text, to_hex, to_int, etc
     @param hexstr_or_primitive in bytes, str, or int.
     """
     if isinstance(hexstr_or_primitive, str):
         (primitive, hexstr) = (None, hexstr_or_primitive)
         if remove_0x_prefix(HexStr(hexstr)) and not is_hex(hexstr):
-            raise ValueError(
+            raise Web3ValueError(
                 "when sending a str, it must be a hex string. "
                 f"Got: {hexstr_or_primitive!r}"
             )
     else:
         (primitive, hexstr) = (hexstr_or_primitive, None)
     return to_type(primitive, hexstr=hexstr)
 
@@ -206,20 +210,20 @@
     ) -> str:
         try:
             encoded = json.dumps(obj, cls=cls)
             return encoded
         except TypeError as full_exception:
             if hasattr(obj, "items"):
                 item_errors = "; ".join(self._json_mapping_errors(obj))
-                raise TypeError(
+                raise Web3TypeError(
                     f"dict had unencodable value at keys: {{{item_errors}}}"
                 )
             elif is_list_like(obj):
                 element_errors = "; ".join(self._json_list_errors(obj))
-                raise TypeError(
+                raise Web3TypeError(
                     f"list had unencodable value at index: [{element_errors}]"
                 )
             else:
                 raise full_exception
 
     def json_decode(self, json_str: str) -> Dict[Any, Any]:
         try:
@@ -233,27 +237,30 @@
 
     def json_encode(
         self, obj: Dict[Any, Any], cls: Optional[Type[json.JSONEncoder]] = None
     ) -> str:
         try:
             return self._friendly_json_encode(obj, cls=cls)
         except TypeError as exc:
-            raise TypeError(f"Could not encode to JSON: {exc}")
+            raise Web3TypeError(f"Could not encode to JSON: {exc}")
 
 
 def to_4byte_hex(hex_or_str_or_bytes: Union[HexStr, str, bytes, int]) -> HexStr:
     size_of_4bytes = 4 * 8
     byte_str = hexstr_if_str(to_bytes, hex_or_str_or_bytes)
     if len(byte_str) > 4:
-        raise ValueError(f"expected value of size 4 bytes. Got: {len(byte_str)} bytes")
+        raise Web3ValueError(
+            f"expected value of size 4 bytes. Got: {len(byte_str)} bytes"
+        )
     hex_str = encode_hex(byte_str)
     return pad_hex(hex_str, size_of_4bytes)
 
 
-class DynamicArrayPackedEncoder(BaseArrayEncoder):
+# type ignored because subclassing BaseArrayEncoder which has type Any
+class DynamicArrayPackedEncoder(BaseArrayEncoder):  # type: ignore[misc]
     is_dynamic = True
 
     def encode(self, value: Sequence[Any]) -> bytes:
         encoded_elements = self.encode_elements(value)
         encoded_value = encoded_elements
 
         return encoded_value
@@ -287,17 +294,15 @@
     return None
 
 
 class Web3JsonEncoder(json.JSONEncoder):
     def default(self, obj: Any) -> Union[Dict[Any, Any], HexStr]:
         if isinstance(obj, AttributeDict):
             return obj.__dict__
-        elif isinstance(obj, HexBytes):
-            return HexStr(obj.hex())
-        elif isinstance(obj, bytes):
+        elif isinstance(obj, (HexBytes, bytes)):
             return to_hex(obj)
         return json.JSONEncoder.default(self, obj)
 
 
 def to_json(obj: Dict[Any, Any]) -> str:
     """
     Convert a complex object (like a transaction object) to a JSON string
```

### Comparing `web3-7.0.0b3/web3/_utils/ens.py` & `web3-7.0.0b4/web3/_utils/ens.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/error_formatters_utils.py` & `web3-7.0.0b4/web3/_utils/error_formatters_utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -9,14 +9,15 @@
 
 from web3.exceptions import (
     ContractCustomError,
     ContractLogicError,
     ContractPanicError,
     OffchainLookup,
     TransactionIndexingInProgress,
+    Web3ValueError,
 )
 from web3.types import (
     RPCResponse,
 )
 
 # func selector for "Error(string)"
 SOLIDITY_ERROR_FUNC_SELECTOR = "0x08c379a0"
@@ -72,15 +73,17 @@
     elif data.startswith("Reverted 0x"):
         # Special case for this form: 'Reverted 0x...'
         error = data.split(" ")[1][2:]
 
     try:
         error = bytes.fromhex(error).decode("utf8")
     except UnicodeDecodeError:
-        warnings.warn("Could not decode revert reason as UTF-8", RuntimeWarning)
+        warnings.warn(
+            "Could not decode revert reason as UTF-8", RuntimeWarning, stacklevel=2
+        )
         raise ContractLogicError("execution reverted", data=data)
 
     return error
 
 
 def _raise_contract_error(response_error_data: str) -> None:
     """
@@ -136,15 +139,15 @@
         `message` - error message is passed to the raised exception
         `data` - response error details (str, dict, None)
 
     See also https://solidity.readthedocs.io/en/v0.6.3/control-structures.html#revert
     """
     error = response.get("error")
     if error is None or isinstance(error, str):
-        raise ValueError(error)
+        raise Web3ValueError(error)
 
     message = error.get("message")
     message_present = message is not None and message != ""
     data = error.get("data", MISSING_DATA)
 
     if data is None:
         if message_present:
@@ -168,15 +171,14 @@
 
 
 def raise_transaction_indexing_error_if_indexing(response: RPCResponse) -> RPCResponse:
     """
     Raise an error if ``eth_getTransactionReceipt`` returns an error indicating that
     transactions are still being indexed.
     """
-
     error = response.get("error")
     if not isinstance(error, str) and error is not None:
         message = error.get("message")
         if message is not None:
             if all(
                 idx_key_phrases in message for idx_key_phrases in ("index", "progress")
             ):
```

### Comparing `web3-7.0.0b3/web3/_utils/events.py` & `web3-7.0.0b4/web3/_utils/events.py`

 * *Files 3% similar despite different names*

```diff
@@ -72,14 +72,15 @@
 from web3.datastructures import (
     AttributeDict,
 )
 from web3.exceptions import (
     InvalidEventABI,
     LogTopicError,
     MismatchedABI,
+    Web3ValueError,
 )
 from web3.types import (
     ABIEvent,
     ABIEventParams,
     BlockIdentifier,
     EventData,
     FilterParams,
@@ -111,32 +112,30 @@
     abi_codec: ABICodec,
     arguments: Optional[Union[Sequence[Any], Dict[str, Any]]] = None,
 ) -> List[HexStr]:
     if arguments is None:
         arguments = {}
     if isinstance(arguments, (list, tuple)):
         if len(arguments) != len(event_abi["inputs"]):
-            raise ValueError(
+            raise Web3ValueError(
                 "When passing an argument list, the number of arguments must "
                 "match the event constructor."
             )
         arguments = {
             arg["name"]: [arg_value]
             for arg, arg_value in zip(event_abi["inputs"], arguments)
         }
 
     normalized_args = {
         key: value if is_list_like(value) else [value]
         # type ignored b/c arguments is always a dict at this point
         for key, value in arguments.items()  # type: ignore
     }
 
-    # typed dict cannot be used w/ a normal Dict
-    # https://github.com/python/mypy/issues/4976
-    event_topic = encode_hex(event_abi_to_log_topic(event_abi))  # type: ignore
+    event_topic = encode_hex(event_abi_to_log_topic(event_abi))
     indexed_args = get_indexed_event_inputs(event_abi)
     zipped_abi_and_args = [
         (arg, normalized_args.get(arg["name"], [None])) for arg in indexed_args
     ]
     encoded_args = [
         [
             (
@@ -158,15 +157,15 @@
     abi_codec: ABICodec,
     arguments: Optional[Union[Sequence[Any], Dict[str, Any]]] = None,
 ) -> List[List[Optional[HexStr]]]:
     if arguments is None:
         arguments = {}
     if isinstance(arguments, (list, tuple)):
         if len(arguments) != len(event_abi["inputs"]):
-            raise ValueError(
+            raise Web3ValueError(
                 "When passing an argument list, the number of arguments must "
                 "match the event constructor."
             )
         arguments = {
             arg["name"]: [arg_value]
             for arg, arg_value in zip(event_abi["inputs"], arguments)
         }
@@ -366,43 +365,43 @@
         return self._fromBlock
 
     @fromBlock.setter
     def fromBlock(self, value: BlockIdentifier) -> None:
         if self._fromBlock is None and not self._immutable:
             self._fromBlock = value
         else:
-            raise ValueError(
+            raise Web3ValueError(
                 f"fromBlock is already set to {self._fromBlock!r}. "
                 "Resetting filter parameters is not permitted"
             )
 
     @property
     def toBlock(self) -> BlockIdentifier:
         return self._toBlock
 
     @toBlock.setter
     def toBlock(self, value: BlockIdentifier) -> None:
         if self._toBlock is None and not self._immutable:
             self._toBlock = value
         else:
-            raise ValueError(
+            raise Web3ValueError(
                 f"toBlock is already set to {self._toBlock!r}. "
                 "Resetting filter parameters is not permitted"
             )
 
     @property
     def address(self) -> ChecksumAddress:
         return self._address
 
     @address.setter
     def address(self, value: ChecksumAddress) -> None:
         if self._address is None and not self._immutable:
             self._address = value
         else:
-            raise ValueError(
+            raise Web3ValueError(
                 f"address is already set to {self.address!r}. "
                 "Resetting filter parameters is not permitted"
             )
 
     @property
     def ordered_args(self) -> Tuple[Any, ...]:
         return tuple(map(self.args.__getitem__, self._ordered_arg_names))
@@ -439,17 +438,17 @@
         }
         return valfilter(lambda x: x is not None, params)
 
 
 class EventFilterBuilder(BaseEventFilterBuilder):
     def deploy(self, w3: "Web3") -> "LogFilter":
         if not isinstance(w3, web3.Web3):
-            raise ValueError(f"Invalid web3 argument: got: {w3!r}")
+            raise Web3ValueError(f"Invalid web3 argument: got: {w3!r}")
 
-        for arg in AttributeDict.values(self.args):  # type: ignore[arg-type]
+        for arg in AttributeDict.values(self.args):
             arg._immutable = True  # type: ignore[attr-defined]
         self._immutable = True
 
         log_filter = cast("LogFilter", w3.eth.filter(self.filter_params))
         log_filter.filter_params = self.filter_params
         log_filter.set_data_filters(self.data_argument_values)
         log_filter.builder = self
@@ -457,17 +456,17 @@
             log_filter.log_entry_formatter = self.formatter
         return log_filter
 
 
 class AsyncEventFilterBuilder(BaseEventFilterBuilder):
     async def deploy(self, async_w3: "AsyncWeb3") -> "AsyncLogFilter":
         if not isinstance(async_w3, web3.AsyncWeb3):
-            raise ValueError(f"Invalid web3 argument: got: {async_w3!r}")
+            raise Web3ValueError(f"Invalid web3 argument: got: {async_w3!r}")
 
-        for arg in AttributeDict.values(self.args):  # type: ignore[arg-type]
+        for arg in AttributeDict.values(self.args):
             arg._immutable = True  # type: ignore[attr-defined]
         self._immutable = True
 
         log_filter = await async_w3.eth.filter(self.filter_params)
         log_filter = cast("AsyncLogFilter", log_filter)
         log_filter.filter_params = self.filter_params
         log_filter.set_data_filters(self.data_argument_values)
@@ -475,16 +474,15 @@
         if self.formatter is not None:
             log_filter.log_entry_formatter = self.formatter
         return log_filter
 
 
 def initialize_event_topics(event_abi: ABIEvent) -> Union[bytes, List[Any]]:
     if event_abi["anonymous"] is False:
-        # https://github.com/python/mypy/issues/4976
-        return event_abi_to_log_topic(event_abi)  # type: ignore
+        return event_abi_to_log_topic(event_abi)
     else:
         return list()
 
 
 @to_dict
 def _build_argument_filters_from_event_abi(
     event_abi: ABIEvent, abi_codec: ABICodec
@@ -515,27 +513,31 @@
     _immutable = False
 
     def __init__(self, arg_type: TypeStr) -> None:
         self.arg_type = arg_type
 
     def match_single(self, value: Any) -> None:
         if self._immutable:
-            raise ValueError("Setting values is forbidden after filter is deployed.")
+            raise Web3ValueError(
+                "Setting values is forbidden after filter is deployed."
+            )
         if self._match_values is None:
             self._match_values = _normalize_match_values((value,))
         else:
-            raise ValueError("An argument match value/s has already been set.")
+            raise Web3ValueError("An argument match value/s has already been set.")
 
     def match_any(self, *values: Collection[Any]) -> None:
         if self._immutable:
-            raise ValueError("Setting values is forbidden after filter is deployed.")
+            raise Web3ValueError(
+                "Setting values is forbidden after filter is deployed."
+            )
         if self._match_values is None:
             self._match_values = _normalize_match_values(values)
         else:
-            raise ValueError("An argument match value/s has already been set.")
+            raise Web3ValueError("An argument match value/s has already been set.")
 
     @property
     @abstractmethod
     def match_values(self) -> None:
         pass
```

### Comparing `web3-7.0.0b3/web3/_utils/fee_utils.py` & `web3-7.0.0b4/web3/_utils/fee_utils.py`

 * *Files 9% similar despite different names*

```diff
@@ -41,19 +41,17 @@
     )
 
 
 def fee_history_priority_fee(eth: "Eth") -> Wei:
     # This is a tested internal call so no need for type hinting. We can keep
     # better consistency between the sync and async calls by unpacking
     # PRIORITY_FEE_HISTORY_PARAMS as constants here.
-    fee_history = eth.fee_history(*PRIORITY_FEE_HISTORY_PARAMS)  # type: ignore
+    fee_history = eth.fee_history(*PRIORITY_FEE_HISTORY_PARAMS)
     return _fee_history_priority_fee_estimate(fee_history)
 
 
 async def async_fee_history_priority_fee(async_eth: "AsyncEth") -> Wei:
     # This is a tested internal call so no need for type hinting. We can keep
     # better consistency between the sync and async calls by unpacking
     # PRIORITY_FEE_HISTORY_PARAMS as constants here.
-    fee_history = await async_eth.fee_history(
-        *PRIORITY_FEE_HISTORY_PARAMS  # type: ignore
-    )
+    fee_history = await async_eth.fee_history(*PRIORITY_FEE_HISTORY_PARAMS)
     return _fee_history_priority_fee_estimate(fee_history)
```

### Comparing `web3-7.0.0b3/web3/_utils/filters.py` & `web3-7.0.0b4/web3/_utils/filters.py`

 * *Files 1% similar despite different names*

```diff
@@ -46,15 +46,17 @@
     construct_event_data_set,
     construct_event_topic_set,
 )
 from web3._utils.validation import (
     validate_address,
 )
 from web3.exceptions import (
+    Web3TypeError,
     Web3ValidationError,
+    Web3ValueError,
 )
 from web3.types import (
     ABIEvent,
     BlockIdentifier,
     FilterParams,
     LogReceipt,
     RPCEndpoint,
@@ -78,37 +80,36 @@
     filter_params: FilterParams = {}
     topic_set: Sequence[HexStr] = construct_event_topic_set(
         event_abi, abi_codec, argument_filters
     )
 
     if topics is not None:
         if len(topic_set) > 1:
-            raise TypeError(
+            raise Web3TypeError(
                 "Merging the topics argument with topics generated "
                 "from argument_filters is not supported."
             )
         topic_set = topics
 
     if len(topic_set) == 1 and is_list_like(topic_set[0]):
-        # type ignored b/c list-like check on line 88
-        filter_params["topics"] = topic_set[0]  # type: ignore
+        filter_params["topics"] = topic_set[0]
     else:
         filter_params["topics"] = topic_set
 
     if address and contract_address:
         if is_list_like(address):
             filter_params["address"] = [address] + [contract_address]
         elif is_string(address):
             filter_params["address"] = (
                 [address, contract_address]
                 if address != contract_address
                 else [address]
             )
         else:
-            raise ValueError(
+            raise Web3ValueError(
                 f"Unsupported type for `address` parameter: {type(address)}"
             )
     elif address:
         filter_params["address"] = address
     elif contract_address:
         filter_params["address"] = contract_address
 
@@ -174,15 +175,15 @@
         ]
         return formatted_log_entries
 
 
 class Filter(BaseFilter):
     def __init__(self, filter_id: HexStr, eth_module: "Eth") -> None:
         self.eth_module = eth_module
-        super(Filter, self).__init__(filter_id)
+        super().__init__(filter_id)
 
     def get_new_entries(self) -> List[LogReceipt]:
         log_entries = self._filter_valid_entries(
             self.eth_module.get_filter_changes(self.filter_id)
         )
         return self._format_log_entries(log_entries)
 
@@ -192,15 +193,15 @@
         )
         return self._format_log_entries(log_entries)
 
 
 class AsyncFilter(BaseFilter):
     def __init__(self, filter_id: HexStr, eth_module: "AsyncEth") -> None:
         self.eth_module = eth_module
-        super(AsyncFilter, self).__init__(filter_id)
+        super().__init__(filter_id)
 
     async def get_new_entries(self) -> List[LogReceipt]:
         filter_changes = await self.eth_module.get_filter_changes(self.filter_id)
         log_entries = self._filter_valid_entries(filter_changes)
         return self._format_log_entries(log_entries)
 
     async def get_all_entries(self) -> List[LogReceipt]:
@@ -246,15 +247,16 @@
         if self.log_entry_formatter:
             return self.log_entry_formatter(entry)
         return entry
 
     def set_data_filters(
         self, data_filter_set: Collection[Tuple[TypeStr, Any]]
     ) -> None:
-        """Sets the data filters (non indexed argument filters)
+        """
+        Sets the data filters (non indexed argument filters)
 
         Expects a set of tuples with the type and value, e.g.:
         (('uint256', [12345, 54321]), ('string', ('a-single-string',)))
         """
         self.data_filter_set = data_filter_set
         if any(data_filter_set):
             self.data_filter_set_function = match_fn(
@@ -288,15 +290,16 @@
         if self.log_entry_formatter:
             return self.log_entry_formatter(entry)
         return entry
 
     def set_data_filters(
         self, data_filter_set: Collection[Tuple[TypeStr, Any]]
     ) -> None:
-        """Sets the data filters (non indexed argument filters)
+        """
+        Sets the data filters (non indexed argument filters)
 
         Expects a set of tuples with the type and value, e.g.:
         (('uint256', [12345, 54321]), ('string', ('a-single-string',)))
         """
         self.data_filter_set = data_filter_set
         if any(data_filter_set):
             self.data_filter_set_function = match_fn(
@@ -314,33 +317,35 @@
 
 
 not_text = complement(is_text)
 normalize_to_text = apply_formatter_if(not_text, decode_utf8_bytes)
 
 
 def normalize_data_values(type_string: TypeStr, data_value: Any) -> Any:
-    """Decodes utf-8 bytes to strings for abi string values.
+    """
+    Decodes utf-8 bytes to strings for abi string values.
 
     eth-abi v1 returns utf-8 bytes for string values.
     This can be removed once eth-abi v2 is required.
     """
     _type = parse_type_string(type_string)
     if _type.base == "string":
         if _type.arrlist is not None:
-            return tuple((normalize_to_text(value) for value in data_value))
+            return tuple(normalize_to_text(value) for value in data_value)
         else:
             return normalize_to_text(data_value)
     return data_value
 
 
 @curry
 def match_fn(
     codec: ABICodec, match_values_and_abi: Collection[Tuple[str, Any]], data: Any
 ) -> bool:
-    """Match function used for filtering non-indexed event arguments.
+    """
+    Match function used for filtering non-indexed event arguments.
 
     Values provided through the match_values_and_abi parameter are
     compared to the abi decoded log data.
     """
     abi_types, all_match_values = zip(*match_values_and_abi)
 
     decoded_values = codec.decode(abi_types, HexBytes(data))
@@ -348,15 +353,15 @@
         decoded_values, all_match_values, abi_types
     ):
         if match_values is None:
             continue
         normalized_data = normalize_data_values(abi_type, data_value)
         for value in match_values:
             if not codec.is_encodable(abi_type, value):
-                raise ValueError(
+                raise Web3ValueError(
                     f"Value {value} is of the wrong abi type. "
                     f"Expected {abi_type} typed value."
                 )
             if value == normalized_data:
                 break
         else:
             return False
```

### Comparing `web3-7.0.0b3/web3/_utils/formatters.py` & `web3-7.0.0b4/web3/_utils/formatters.py`

 * *Files 1% similar despite different names*

```diff
@@ -110,21 +110,21 @@
         else:
             yield key, item
 
 
 def is_array_of_strings(value: Any) -> bool:
     if not is_list_like(value):
         return False
-    return all((is_string(item) for item in value))
+    return all(is_string(item) for item in value)
 
 
 def is_array_of_dicts(value: Any) -> bool:
     if not is_list_like(value):
         return False
-    return all((is_dict(item) for item in value))
+    return all(is_dict(item) for item in value)
 
 
 @curry
 def remove_key_if(
     key: Any, remove_if: Callable[[Dict[Any, Any]], bool], input_dict: Dict[Any, Any]
 ) -> Dict[Any, Any]:
     if key in input_dict and remove_if(input_dict):
```

### Comparing `web3-7.0.0b3/web3/_utils/math.py` & `web3-7.0.0b4/web3/_utils/math.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,29 +1,30 @@
 from typing import (
     Optional,
     Sequence,
 )
 
 from web3.exceptions import (
     InsufficientData,
+    Web3ValueError,
 )
 
 
 def percentile(
     values: Optional[Sequence[int]] = None, percentile: Optional[float] = None
 ) -> float:
     """Calculates a simplified weighted average percentile"""
     if values in [None, tuple(), []] or len(values) < 1:
         raise InsufficientData(
             f"Expected a sequence of at least 1 integers, got {values!r}"
         )
     if percentile is None:
-        raise ValueError(f"Expected a percentile choice, got {percentile}")
+        raise Web3ValueError(f"Expected a percentile choice, got {percentile}")
     if percentile < 0 or percentile > 100:
-        raise ValueError("percentile must be in the range [0, 100]")
+        raise Web3ValueError("percentile must be in the range [0, 100]")
 
     sorted_values = sorted(values)
 
     index = len(values) * percentile / 100 - 1
     if index < 0:
         return sorted_values[0]
```

### Comparing `web3-7.0.0b3/web3/_utils/method_formatters.py` & `web3-7.0.0b4/web3/_utils/method_formatters.py`

 * *Files 1% similar despite different names*

```diff
@@ -95,14 +95,16 @@
 from web3.datastructures import (
     AttributeDict,
     ReadableAttributeDict,
 )
 from web3.exceptions import (
     BlockNotFound,
     TransactionNotFound,
+    Web3TypeError,
+    Web3ValueError,
 )
 from web3.types import (
     BlockIdentifier,
     Formatters,
     RPCEndpoint,
     StateOverrideParams,
     TReturn,
@@ -132,23 +134,23 @@
 @curry
 def to_hexbytes(
     num_bytes: int, val: Union[str, int, bytes], variable_length: bool = False
 ) -> HexBytes:
     if isinstance(val, (str, int, bytes)):
         result = HexBytes(val)
     else:
-        raise TypeError(f"Cannot convert {val!r} to HexBytes")
+        raise Web3TypeError(f"Cannot convert {val!r} to HexBytes")
 
     extra_bytes = len(result) - num_bytes
     if extra_bytes == 0 or (variable_length and extra_bytes < 0):
         return result
     elif all(byte == 0 for byte in result[:extra_bytes]):
         return HexBytes(result[extra_bytes:])
     else:
-        raise ValueError(
+        raise Web3ValueError(
             f"The value {result!r} is {len(result)} bytes, but should be {num_bytes}"
         )
 
 
 def is_attrdict(val: Any) -> bool:
     return isinstance(val, AttributeDict)
 
@@ -173,17 +175,17 @@
     key_formatters: Callable[[Any], Any],
     value_formatters: Callable[[Any], Any],
     dict_like_object: Union[AttributeDict[str, Any], Dict[str, Any]],
 ) -> Union[ReadableAttributeDict[str, Any], Dict[str, Any]]:
     """
     Preserve ``AttributeDict`` types if original ``value`` was an ``AttributeDict``.
     """
-    formatted_dict = dict(
-        (key_formatters(k), value_formatters(v)) for k, v in dict_like_object.items()
-    )
+    formatted_dict = {
+        key_formatters(k): value_formatters(v) for k, v in dict_like_object.items()
+    }
     return (
         AttributeDict.recursive(formatted_dict)
         if is_attrdict(dict_like_object)
         else formatted_dict
     )
 
 
@@ -281,14 +283,16 @@
     "contractAddress": apply_formatter_if(is_not_null, to_checksum_address),
     "logs": apply_list_to_array_formatter(log_entry_formatter),
     "logsBloom": to_hexbytes(256, variable_length=True),
     "from": apply_formatter_if(is_not_null, to_checksum_address),
     "to": apply_formatter_if(is_address, to_checksum_address),
     "effectiveGasPrice": to_integer_if_hex,
     "type": to_integer_if_hex,
+    "blobGasPrice": to_integer_if_hex,
+    "blobGasUsed": to_integer_if_hex,
 }
 
 
 receipt_formatter = type_aware_apply_formatters_to_dict(RECEIPT_FORMATTERS)
 
 BLOCK_FORMATTERS = {
     "baseFeePerGas": to_integer_if_hex,
@@ -419,15 +423,30 @@
 filter_result_formatter = apply_one_of_formatters(
     (
         (is_array_of_dicts, apply_list_to_array_formatter(log_entry_formatter)),
         (is_array_of_strings, apply_list_to_array_formatter(to_hexbytes(32))),
     )
 )
 
+ACCESS_LIST_REQUEST_FORMATTER = type_aware_apply_formatters_to_dict(
+    {
+        "accessList": apply_formatter_if(
+            is_not_null,
+            apply_list_to_array_formatter(
+                apply_formatters_to_dict(
+                    {
+                        "storageKeys": apply_list_to_array_formatter(to_hex_if_bytes),
+                    }
+                )
+            ),
+        ),
+    }
+)
 transaction_param_formatter = compose(
+    ACCESS_LIST_REQUEST_FORMATTER,
     remove_key_if("to", lambda txn: txn["to"] in {"", b"", None}),
     remove_key_if("gasPrice", lambda txn: txn["gasPrice"] in {"", b"", None}),
 )
 
 
 call_without_override: Callable[
     [Tuple[TxParams, BlockIdentifier]], Tuple[Dict[str, Any], int]
```

### Comparing `web3-7.0.0b3/web3/_utils/module.py` & `web3-7.0.0b4/web3/_utils/module.py`

 * *Files 3% similar despite different names*

```diff
@@ -9,14 +9,15 @@
     List,
     Optional,
     Sequence,
     Union,
 )
 
 from web3.exceptions import (
+    Web3AttributeError,
     Web3ValidationError,
 )
 from web3.module import (
     Module,
 )
 
 if TYPE_CHECKING:
@@ -46,15 +47,15 @@
 ) -> None:
     for module_name, module_info in module_definitions.items():
         module_info_is_list_like = isinstance(module_info, Sequence)
 
         module_class = module_info[0] if module_info_is_list_like else module_info
 
         if hasattr(parent_module, module_name):
-            raise AttributeError(
+            raise Web3AttributeError(
                 f"Cannot set {parent_module} module named '{module_name}'. "
                 " The web3 object already has an attribute with that name"
             )
 
         # The parent module is the ``Web3`` instance on first run of the loop and w3 is
         # None. Thus, set w3 to the parent_module. The import needs to happen locally
         # due to circular import issues.
```

### Comparing `web3-7.0.0b3/web3/_utils/module_testing/eth_module.py` & `web3-7.0.0b4/web3/_utils/module_testing/eth_module.py`

 * *Files 1% similar despite different names*

```diff
@@ -296,11215 +296,11207 @@
 00001270: 2829 7d2c 0a5d 0a0a 6966 2054 5950 455f  ()},.]..if TYPE_
 00001280: 4348 4543 4b49 4e47 3a0a 2020 2020 6672  CHECKING:.    fr
 00001290: 6f6d 205f 7079 7465 7374 2e6d 6f6e 6b65  om _pytest.monke
 000012a0: 7970 6174 6368 2069 6d70 6f72 7420 4d6f  ypatch import Mo
 000012b0: 6e6b 6579 5061 7463 6820 2023 206e 6f71  nkeyPatch  # noq
 000012c0: 613a 2046 3430 310a 0a20 2020 2066 726f  a: F401..    fro
 000012d0: 6d20 7765 6233 2e63 6f6e 7472 6163 7420  m web3.contract 
-000012e0: 696d 706f 7274 2043 6f6e 7472 6163 7420  import Contract 
-000012f0: 2023 206e 6f71 613a 2046 3430 310a 2020   # noqa: F401.  
-00001300: 2020 6672 6f6d 2077 6562 332e 6d61 696e    from web3.main
-00001310: 2069 6d70 6f72 7420 2820 2023 206e 6f71   import (  # noq
-00001320: 613a 2046 3430 310a 2020 2020 2020 2020  a: F401.        
-00001330: 4173 796e 6357 6562 332c 0a20 2020 2020  AsyncWeb3,.     
-00001340: 2020 2057 6562 332c 0a20 2020 2029 0a0a     Web3,.    )..
-00001350: 0a64 6566 2061 6269 5f65 6e63 6f64 6564  .def abi_encoded
-00001360: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
-00001370: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
-00001380: 7328 0a20 2020 2077 333a 2055 6e69 6f6e  s(.    w3: Union
-00001390: 5b22 5765 6233 222c 2022 4173 796e 6357  ["Web3", "AsyncW
-000013a0: 6562 3322 5d2c 206f 6666 6368 6169 6e5f  eb3"], offchain_
-000013b0: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 743a  lookup_contract:
-000013c0: 2022 436f 6e74 7261 6374 220a 2920 2d3e   "Contract".) ->
-000013d0: 2048 6578 4164 6472 6573 733a 0a20 2020   HexAddress:.   
-000013e0: 2072 6574 7572 6e20 4865 7841 6464 7265   return HexAddre
-000013f0: 7373 280a 2020 2020 2020 2020 7265 6d6f  ss(.        remo
-00001400: 7665 5f30 785f 7072 6566 6978 280a 2020  ve_0x_prefix(.  
-00001410: 2020 2020 2020 2020 2020 7733 2e74 6f5f            w3.to_
-00001420: 6865 7828 0a20 2020 2020 2020 2020 2020  hex(.           
-00001430: 2020 2020 2061 6269 2e65 6e63 6f64 6528       abi.encode(
-00001440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001450: 2020 2020 205b 2261 6464 7265 7373 225d       ["address"]
-00001460: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00001470: 2020 2020 2020 5b74 6f5f 6279 7465 7328        [to_bytes(
-00001480: 6865 7873 7472 3d6f 6666 6368 6169 6e5f  hexstr=offchain_
-00001490: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
-000014a0: 6164 6472 6573 7329 5d2c 0a20 2020 2020  address)],.     
-000014b0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000014c0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000014d0: 2020 2029 0a20 2020 2029 0a0a 0a63 6c61     ).    )...cla
-000014e0: 7373 2041 7379 6e63 4574 684d 6f64 756c  ss AsyncEthModul
-000014f0: 6554 6573 743a 0a20 2020 2040 7079 7465  eTest:.    @pyte
-00001500: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-00001510: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-00001520: 7374 5f65 7468 5f67 6173 5f70 7269 6365  st_eth_gas_price
-00001530: 2873 656c 662c 2061 7379 6e63 5f77 333a  (self, async_w3:
-00001540: 2022 4173 796e 6357 6562 3322 2920 2d3e   "AsyncWeb3") ->
-00001550: 204e 6f6e 653a 0a20 2020 2020 2020 2067   None:.        g
-00001560: 6173 5f70 7269 6365 203d 2061 7761 6974  as_price = await
-00001570: 2061 7379 6e63 5f77 332e 6574 682e 6761   async_w3.eth.ga
-00001580: 735f 7072 6963 650a 0a20 2020 2020 2020  s_price..       
-00001590: 2061 7373 6572 7420 6761 735f 7072 6963   assert gas_pric
-000015a0: 6520 3e20 300a 0a20 2020 2040 7079 7465  e > 0..    @pyte
-000015b0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-000015c0: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-000015d0: 7374 5f69 735f 636f 6e6e 6563 7465 6428  st_is_connected(
-000015e0: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-000015f0: 2241 7379 6e63 5765 6233 2229 202d 3e20  "AsyncWeb3") -> 
-00001600: 4e6f 6e65 3a0a 2020 2020 2020 2020 6973  None:.        is
-00001610: 5f63 6f6e 6e65 6374 6564 203d 2061 7761  _connected = awa
-00001620: 6974 2061 7379 6e63 5f77 332e 6973 5f63  it async_w3.is_c
-00001630: 6f6e 6e65 6374 6564 2829 0a20 2020 2020  onnected().     
-00001640: 2020 2061 7373 6572 7420 6973 5f63 6f6e     assert is_con
-00001650: 6e65 6374 6564 2069 7320 5472 7565 0a0a  nected is True..
-00001660: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00001670: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-00001680: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
-00001690: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-000016a0: 5f6c 6567 6163 7928 0a20 2020 2020 2020  _legacy(.       
-000016b0: 2073 656c 662c 2061 7379 6e63 5f77 333a   self, async_w3:
-000016c0: 2022 4173 796e 6357 6562 3322 2c20 6173   "AsyncWeb3", as
-000016d0: 796e 635f 756e 6c6f 636b 6564 5f61 6363  ync_unlocked_acc
-000016e0: 6f75 6e74 5f64 7561 6c5f 7479 7065 3a20  ount_dual_type: 
-000016f0: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
-00001700: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00001710: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00001720: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-00001730: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-00001740: 6d22 3a20 6173 796e 635f 756e 6c6f 636b  m": async_unlock
-00001750: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
-00001760: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00001770: 2020 2274 6f22 3a20 6173 796e 635f 756e    "to": async_un
-00001780: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-00001790: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-000017a0: 2020 2020 2020 2276 616c 7565 223a 2057        "value": W
-000017b0: 6569 2831 292c 0a20 2020 2020 2020 2020  ei(1),.         
-000017c0: 2020 2022 6761 7322 3a20 3231 3030 302c     "gas": 21000,
-000017d0: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
-000017e0: 7350 7269 6365 223a 2061 7761 6974 2061  sPrice": await a
-000017f0: 7379 6e63 5f77 332e 6574 682e 6761 735f  sync_w3.eth.gas_
-00001800: 7072 6963 652c 0a20 2020 2020 2020 207d  price,.        }
-00001810: 0a20 2020 2020 2020 2074 786e 5f68 6173  .        txn_has
-00001820: 6820 3d20 6177 6169 7420 6173 796e 635f  h = await async_
-00001830: 7733 2e65 7468 2e73 656e 645f 7472 616e  w3.eth.send_tran
-00001840: 7361 6374 696f 6e28 7478 6e5f 7061 7261  saction(txn_para
-00001850: 6d73 290a 2020 2020 2020 2020 7478 6e20  ms).        txn 
-00001860: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-00001870: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
-00001880: 7469 6f6e 2874 786e 5f68 6173 6829 0a0a  tion(txn_hash)..
-00001890: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-000018a0: 735f 7361 6d65 5f61 6464 7265 7373 2874  s_same_address(t
-000018b0: 786e 5b22 6672 6f6d 225d 2c20 6361 7374  xn["from"], cast
-000018c0: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
-000018d0: 2c20 7478 6e5f 7061 7261 6d73 5b22 6672  , txn_params["fr
-000018e0: 6f6d 225d 2929 0a20 2020 2020 2020 2061  om"])).        a
-000018f0: 7373 6572 7420 6973 5f73 616d 655f 6164  ssert is_same_ad
-00001900: 6472 6573 7328 7478 6e5b 2274 6f22 5d2c  dress(txn["to"],
-00001910: 2063 6173 7428 4368 6563 6b73 756d 4164   cast(ChecksumAd
-00001920: 6472 6573 732c 2074 786e 5f70 6172 616d  dress, txn_param
-00001930: 735b 2274 6f22 5d29 290a 2020 2020 2020  s["to"])).      
-00001940: 2020 6173 7365 7274 2074 786e 5b22 7661    assert txn["va
-00001950: 6c75 6522 5d20 3d3d 2031 0a20 2020 2020  lue"] == 1.     
-00001960: 2020 2061 7373 6572 7420 7478 6e5b 2267     assert txn["g
-00001970: 6173 225d 203d 3d20 3231 3030 300a 2020  as"] == 21000.  
-00001980: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
-00001990: 5b22 6761 7350 7269 6365 225d 203d 3d20  ["gasPrice"] == 
-000019a0: 7478 6e5f 7061 7261 6d73 5b22 6761 7350  txn_params["gasP
-000019b0: 7269 6365 225d 0a0a 2020 2020 4070 7974  rice"]..    @pyt
-000019c0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-000019d0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-000019e0: 6573 745f 6574 685f 6d6f 6469 6679 5f74  est_eth_modify_t
-000019f0: 7261 6e73 6163 7469 6f6e 5f6c 6567 6163  ransaction_legac
-00001a00: 7928 0a20 2020 2020 2020 2073 656c 662c  y(.        self,
-00001a10: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-00001a20: 6357 6562 3322 2c20 6173 796e 635f 756e  cWeb3", async_un
-00001a30: 6c6f 636b 6564 5f61 6363 6f75 6e74 3a20  locked_account: 
-00001a40: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
-00001a50: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00001a60: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00001a70: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-00001a80: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-00001a90: 6d22 3a20 6173 796e 635f 756e 6c6f 636b  m": async_unlock
-00001aa0: 6564 5f61 6363 6f75 6e74 2c0a 2020 2020  ed_account,.    
-00001ab0: 2020 2020 2020 2020 2274 6f22 3a20 6173          "to": as
-00001ac0: 796e 635f 756e 6c6f 636b 6564 5f61 6363  ync_unlocked_acc
-00001ad0: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
-00001ae0: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
-00001af0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00001b00: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
-00001b10: 2020 2020 2020 2020 2022 6761 7350 7269           "gasPri
-00001b20: 6365 223a 2061 7379 6e63 5f77 332e 746f  ce": async_w3.to
-00001b30: 5f77 6569 280a 2020 2020 2020 2020 2020  _wei(.          
-00001b40: 2020 2020 2020 312c 2022 6777 6569 220a        1, "gwei".
-00001b50: 2020 2020 2020 2020 2020 2020 292c 2020              ),  
-00001b60: 2320 6d75 7374 2062 6520 6772 6561 7465  # must be greate
-00001b70: 7220 7468 616e 2062 6173 655f 6665 6520  r than base_fee 
-00001b80: 706f 7374 204c 6f6e 646f 6e0a 2020 2020  post London.    
-00001b90: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
-00001ba0: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
-00001bb0: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
-00001bc0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00001bd0: 5f70 6172 616d 7329 0a0a 2020 2020 2020  _params)..      
-00001be0: 2020 6d6f 6469 6669 6564 5f74 786e 5f68    modified_txn_h
-00001bf0: 6173 6820 3d20 6177 6169 7420 6173 796e  ash = await asyn
-00001c00: 635f 7733 2e65 7468 2e6d 6f64 6966 795f  c_w3.eth.modify_
-00001c10: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
-00001c20: 2020 2020 2020 2020 2074 786e 5f68 6173           txn_has
-00001c30: 682c 2067 6173 5072 6963 653d 2863 6173  h, gasPrice=(cas
-00001c40: 7428 696e 742c 2074 786e 5f70 6172 616d  t(int, txn_param
-00001c50: 735b 2267 6173 5072 6963 6522 5d29 202a  s["gasPrice"]) *
-00001c60: 2032 292c 2076 616c 7565 3d32 0a20 2020   2), value=2.   
-00001c70: 2020 2020 2029 0a20 2020 2020 2020 206d       ).        m
-00001c80: 6f64 6966 6965 645f 7478 6e20 3d20 6177  odified_txn = aw
-00001c90: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00001ca0: 2e67 6574 5f74 7261 6e73 6163 7469 6f6e  .get_transaction
-00001cb0: 286d 6f64 6966 6965 645f 7478 6e5f 6861  (modified_txn_ha
-00001cc0: 7368 290a 0a20 2020 2020 2020 2061 7373  sh)..        ass
-00001cd0: 6572 7420 6973 5f73 616d 655f 6164 6472  ert is_same_addr
-00001ce0: 6573 7328 0a20 2020 2020 2020 2020 2020  ess(.           
-00001cf0: 206d 6f64 6966 6965 645f 7478 6e5b 2266   modified_txn["f
-00001d00: 726f 6d22 5d2c 2063 6173 7428 4368 6563  rom"], cast(Chec
-00001d10: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
-00001d20: 5f70 6172 616d 735b 2266 726f 6d22 5d29  _params["from"])
-00001d30: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00001d40: 2020 2061 7373 6572 7420 6973 5f73 616d     assert is_sam
-00001d50: 655f 6164 6472 6573 7328 0a20 2020 2020  e_address(.     
-00001d60: 2020 2020 2020 206d 6f64 6966 6965 645f         modified_
-00001d70: 7478 6e5b 2274 6f22 5d2c 2063 6173 7428  txn["to"], cast(
-00001d80: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-00001d90: 2074 786e 5f70 6172 616d 735b 2274 6f22   txn_params["to"
-00001da0: 5d29 0a20 2020 2020 2020 2029 0a20 2020  ]).        ).   
-00001db0: 2020 2020 2061 7373 6572 7420 6d6f 6469       assert modi
-00001dc0: 6669 6564 5f74 786e 5b22 7661 6c75 6522  fied_txn["value"
-00001dd0: 5d20 3d3d 2032 0a20 2020 2020 2020 2061  ] == 2.        a
-00001de0: 7373 6572 7420 6d6f 6469 6669 6564 5f74  ssert modified_t
-00001df0: 786e 5b22 6761 7322 5d20 3d3d 2032 3130  xn["gas"] == 210
-00001e00: 3030 0a20 2020 2020 2020 2061 7373 6572  00.        asser
-00001e10: 7420 6d6f 6469 6669 6564 5f74 786e 5b22  t modified_txn["
-00001e20: 6761 7350 7269 6365 225d 203d 3d20 6361  gasPrice"] == ca
-00001e30: 7374 2869 6e74 2c20 7478 6e5f 7061 7261  st(int, txn_para
-00001e40: 6d73 5b22 6761 7350 7269 6365 225d 2920  ms["gasPrice"]) 
-00001e50: 2a20 320a 0a20 2020 2040 7079 7465 7374  * 2..    @pytest
-00001e60: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-00001e70: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-00001e80: 5f65 7468 5f6d 6f64 6966 795f 7472 616e  _eth_modify_tran
-00001e90: 7361 6374 696f 6e28 0a20 2020 2020 2020  saction(.       
-00001ea0: 2073 656c 662c 2061 7379 6e63 5f77 333a   self, async_w3:
-00001eb0: 2022 4173 796e 6357 6562 3322 2c20 6173   "AsyncWeb3", as
-00001ec0: 796e 635f 756e 6c6f 636b 6564 5f61 6363  ync_unlocked_acc
-00001ed0: 6f75 6e74 3a20 4368 6563 6b73 756d 4164  ount: ChecksumAd
-00001ee0: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
-00001ef0: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
-00001f00: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-00001f10: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00001f20: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
-00001f30: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00001f40: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-00001f50: 6f22 3a20 6173 796e 635f 756e 6c6f 636b  o": async_unlock
-00001f60: 6564 5f61 6363 6f75 6e74 2c0a 2020 2020  ed_account,.    
-00001f70: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
-00001f80: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
-00001f90: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
-00001fa0: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
-00001fb0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-00001fc0: 7247 6173 223a 2061 7379 6e63 5f77 332e  rGas": async_w3.
-00001fd0: 746f 5f77 6569 2831 2c20 2267 7765 6922  to_wei(1, "gwei"
-00001fe0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00001ff0: 6d61 7846 6565 5065 7247 6173 223a 2061  maxFeePerGas": a
-00002000: 7379 6e63 5f77 332e 746f 5f77 6569 2832  sync_w3.to_wei(2
-00002010: 2c20 2267 7765 6922 292c 0a20 2020 2020  , "gwei"),.     
-00002020: 2020 207d 0a20 2020 2020 2020 2074 786e     }.        txn
-00002030: 5f68 6173 6820 3d20 6177 6169 7420 6173  _hash = await as
-00002040: 796e 635f 7733 2e65 7468 2e73 656e 645f  ync_w3.eth.send_
-00002050: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
-00002060: 7061 7261 6d73 290a 0a20 2020 2020 2020  params)..       
-00002070: 206d 6f64 6966 6965 645f 7478 6e5f 6861   modified_txn_ha
-00002080: 7368 203d 2061 7761 6974 2061 7379 6e63  sh = await async
-00002090: 5f77 332e 6574 682e 6d6f 6469 6679 5f74  _w3.eth.modify_t
-000020a0: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
-000020b0: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
-000020c0: 2c0a 2020 2020 2020 2020 2020 2020 7661  ,.            va
-000020d0: 6c75 653d 322c 0a20 2020 2020 2020 2020  lue=2,.         
-000020e0: 2020 206d 6178 5072 696f 7269 7479 4665     maxPriorityFe
-000020f0: 6550 6572 4761 733d 2863 6173 7428 5765  ePerGas=(cast(We
-00002100: 692c 2074 786e 5f70 6172 616d 735b 226d  i, txn_params["m
-00002110: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
-00002120: 4761 7322 5d29 202a 2032 292c 0a20 2020  Gas"]) * 2),.   
-00002130: 2020 2020 2020 2020 206d 6178 4665 6550           maxFeeP
-00002140: 6572 4761 733d 2863 6173 7428 5765 692c  erGas=(cast(Wei,
-00002150: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
-00002160: 4665 6550 6572 4761 7322 5d29 202a 2032  FeePerGas"]) * 2
-00002170: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-00002180: 2020 2020 206d 6f64 6966 6965 645f 7478       modified_tx
-00002190: 6e20 3d20 6177 6169 7420 6173 796e 635f  n = await async_
-000021a0: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
-000021b0: 6163 7469 6f6e 286d 6f64 6966 6965 645f  action(modified_
-000021c0: 7478 6e5f 6861 7368 290a 0a20 2020 2020  txn_hash)..     
-000021d0: 2020 2061 7373 6572 7420 6973 5f73 616d     assert is_sam
-000021e0: 655f 6164 6472 6573 7328 0a20 2020 2020  e_address(.     
-000021f0: 2020 2020 2020 206d 6f64 6966 6965 645f         modified_
-00002200: 7478 6e5b 2266 726f 6d22 5d2c 2063 6173  txn["from"], cas
-00002210: 7428 4368 6563 6b73 756d 4164 6472 6573  t(ChecksumAddres
-00002220: 732c 2074 786e 5f70 6172 616d 735b 2266  s, txn_params["f
-00002230: 726f 6d22 5d29 0a20 2020 2020 2020 2029  rom"]).        )
-00002240: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00002250: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
-00002260: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-00002270: 6966 6965 645f 7478 6e5b 2274 6f22 5d2c  ified_txn["to"],
-00002280: 2063 6173 7428 4368 6563 6b73 756d 4164   cast(ChecksumAd
-00002290: 6472 6573 732c 2074 786e 5f70 6172 616d  dress, txn_param
-000022a0: 735b 2274 6f22 5d29 0a20 2020 2020 2020  s["to"]).       
-000022b0: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
-000022c0: 7420 6d6f 6469 6669 6564 5f74 786e 5b22  t modified_txn["
-000022d0: 7661 6c75 6522 5d20 3d3d 2032 0a20 2020  value"] == 2.   
-000022e0: 2020 2020 2061 7373 6572 7420 6d6f 6469       assert modi
-000022f0: 6669 6564 5f74 786e 5b22 6761 7322 5d20  fied_txn["gas"] 
-00002300: 3d3d 2032 3130 3030 0a20 2020 2020 2020  == 21000.       
-00002310: 2061 7373 6572 7420 280a 2020 2020 2020   assert (.      
-00002320: 2020 2020 2020 6d6f 6469 6669 6564 5f74        modified_t
-00002330: 786e 5b22 6d61 7850 7269 6f72 6974 7946  xn["maxPriorityF
-00002340: 6565 5065 7247 6173 225d 0a20 2020 2020  eePerGas"].     
-00002350: 2020 2020 2020 203d 3d20 6361 7374 2857         == cast(W
-00002360: 6569 2c20 7478 6e5f 7061 7261 6d73 5b22  ei, txn_params["
-00002370: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-00002380: 7247 6173 225d 2920 2a20 320a 2020 2020  rGas"]) * 2.    
-00002390: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
-000023a0: 7365 7274 206d 6f64 6966 6965 645f 7478  sert modified_tx
-000023b0: 6e5b 226d 6178 4665 6550 6572 4761 7322  n["maxFeePerGas"
-000023c0: 5d20 3d3d 2063 6173 7428 5765 692c 2074  ] == cast(Wei, t
-000023d0: 786e 5f70 6172 616d 735b 226d 6178 4665  xn_params["maxFe
-000023e0: 6550 6572 4761 7322 5d29 202a 2032 0a0a  ePerGas"]) * 2..
-000023f0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00002400: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-00002410: 6e63 2064 6566 2074 6573 745f 6173 796e  nc def test_asyn
-00002420: 635f 6574 685f 7369 676e 5f74 7261 6e73  c_eth_sign_trans
-00002430: 6163 7469 6f6e 280a 2020 2020 2020 2020  action(.        
-00002440: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-00002450: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
-00002460: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
-00002470: 756e 743a 2043 6865 636b 7375 6d41 6464  unt: ChecksumAdd
-00002480: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-00002490: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-000024a0: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-000024b0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-000024c0: 2022 6672 6f6d 223a 2061 7379 6e63 5f75   "from": async_u
-000024d0: 6e6c 6f63 6b65 645f 6163 636f 756e 742c  nlocked_account,
-000024e0: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
-000024f0: 223a 2061 7379 6e63 5f75 6e6c 6f63 6b65  ": async_unlocke
-00002500: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
-00002510: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
-00002520: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
-00002530: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
-00002540: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
-00002550: 6178 4665 6550 6572 4761 7322 3a20 6173  axFeePerGas": as
-00002560: 796e 635f 7733 2e74 6f5f 7765 6928 322c  ync_w3.to_wei(2,
-00002570: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
-00002580: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
-00002590: 7479 4665 6550 6572 4761 7322 3a20 6173  tyFeePerGas": as
-000025a0: 796e 635f 7733 2e74 6f5f 7765 6928 312c  ync_w3.to_wei(1,
-000025b0: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
-000025c0: 2020 2020 2020 226e 6f6e 6365 223a 204e        "nonce": N
-000025d0: 6f6e 6365 2830 292c 0a20 2020 2020 2020  once(0),.       
-000025e0: 207d 0a20 2020 2020 2020 2072 6573 756c   }.        resul
-000025f0: 7420 3d20 6177 6169 7420 6173 796e 635f  t = await async_
-00002600: 7733 2e65 7468 2e73 6967 6e5f 7472 616e  w3.eth.sign_tran
-00002610: 7361 6374 696f 6e28 7478 6e5f 7061 7261  saction(txn_para
-00002620: 6d73 290a 2020 2020 2020 2020 7369 676e  ms).        sign
-00002630: 6174 6f72 795f 6163 636f 756e 7420 3d20  atory_account = 
-00002640: 6173 796e 635f 7733 2e65 7468 2e61 6363  async_w3.eth.acc
-00002650: 6f75 6e74 2e72 6563 6f76 6572 5f74 7261  ount.recover_tra
-00002660: 6e73 6163 7469 6f6e 2872 6573 756c 745b  nsaction(result[
-00002670: 2272 6177 225d 290a 2020 2020 2020 2020  "raw"]).        
-00002680: 6173 7365 7274 2061 7379 6e63 5f75 6e6c  assert async_unl
-00002690: 6f63 6b65 645f 6163 636f 756e 7420 3d3d  ocked_account ==
-000026a0: 2073 6967 6e61 746f 7279 5f61 6363 6f75   signatory_accou
-000026b0: 6e74 0a20 2020 2020 2020 2061 7373 6572  nt.        asser
-000026c0: 7420 7265 7375 6c74 5b22 7478 225d 5b22  t result["tx"]["
-000026d0: 746f 225d 203d 3d20 7478 6e5f 7061 7261  to"] == txn_para
-000026e0: 6d73 5b22 746f 225d 0a20 2020 2020 2020  ms["to"].       
-000026f0: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
-00002700: 7478 225d 5b22 7661 6c75 6522 5d20 3d3d  tx"]["value"] ==
-00002710: 2074 786e 5f70 6172 616d 735b 2276 616c   txn_params["val
-00002720: 7565 225d 0a20 2020 2020 2020 2061 7373  ue"].        ass
-00002730: 6572 7420 7265 7375 6c74 5b22 7478 225d  ert result["tx"]
-00002740: 5b22 6761 7322 5d20 3d3d 2074 786e 5f70  ["gas"] == txn_p
-00002750: 6172 616d 735b 2267 6173 225d 0a20 2020  arams["gas"].   
-00002760: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-00002770: 6c74 5b22 7478 225d 5b22 6d61 7846 6565  lt["tx"]["maxFee
-00002780: 5065 7247 6173 225d 203d 3d20 7478 6e5f  PerGas"] == txn_
-00002790: 7061 7261 6d73 5b22 6d61 7846 6565 5065  params["maxFeePe
-000027a0: 7247 6173 225d 0a20 2020 2020 2020 2061  rGas"].        a
-000027b0: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
-000027c0: 2020 2020 7265 7375 6c74 5b22 7478 225d      result["tx"]
-000027d0: 5b22 6d61 7850 7269 6f72 6974 7946 6565  ["maxPriorityFee
-000027e0: 5065 7247 6173 225d 203d 3d20 7478 6e5f  PerGas"] == txn_
-000027f0: 7061 7261 6d73 5b22 6d61 7850 7269 6f72  params["maxPrior
-00002800: 6974 7946 6565 5065 7247 6173 225d 0a20  ityFeePerGas"]. 
-00002810: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00002820: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
-00002830: 7478 225d 5b22 6e6f 6e63 6522 5d20 3d3d  tx"]["nonce"] ==
-00002840: 2074 786e 5f70 6172 616d 735b 226e 6f6e   txn_params["non
-00002850: 6365 225d 0a0a 2020 2020 4070 7974 6573  ce"]..    @pytes
-00002860: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00002870: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00002880: 745f 6574 685f 7369 676e 5f74 7970 6564  t_eth_sign_typed
-00002890: 5f64 6174 6128 0a20 2020 2020 2020 2073  _data(.        s
-000028a0: 656c 662c 0a20 2020 2020 2020 2061 7379  elf,.        asy
-000028b0: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-000028c0: 3322 2c0a 2020 2020 2020 2020 6173 796e  3",.        asyn
-000028d0: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
-000028e0: 6e74 5f64 7561 6c5f 7479 7065 3a20 4368  nt_dual_type: Ch
-000028f0: 6563 6b73 756d 4164 6472 6573 732c 0a20  ecksumAddress,. 
-00002900: 2020 2020 2020 2061 7379 6e63 5f73 6b69         async_ski
-00002910: 705f 6966 5f74 6573 7472 7063 3a20 4361  p_if_testrpc: Ca
-00002920: 6c6c 6162 6c65 5b5b 2241 7379 6e63 5765  llable[["AsyncWe
-00002930: 6233 225d 2c20 4e6f 6e65 5d2c 0a20 2020  b3"], None],.   
-00002940: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00002950: 2020 2020 7661 6c69 644a 534f 4e4d 6573      validJSONMes
-00002960: 7361 6765 203d 2022 2222 0a20 2020 2020  sage = """.     
-00002970: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-00002980: 2020 2020 2020 2020 2022 7479 7065 7322           "types"
-00002990: 3a20 7b0a 2020 2020 2020 2020 2020 2020  : {.            
-000029a0: 2020 2020 2020 2020 2245 4950 3731 3244          "EIP712D
-000029b0: 6f6d 6169 6e22 3a20 5b0a 2020 2020 2020  omain": [.      
-000029c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000029d0: 2020 7b22 6e61 6d65 223a 2022 6e61 6d65    {"name": "name
-000029e0: 222c 2022 7479 7065 223a 2022 7374 7269  ", "type": "stri
-000029f0: 6e67 227d 2c0a 2020 2020 2020 2020 2020  ng"},.          
-00002a00: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-00002a10: 6e61 6d65 223a 2022 7665 7273 696f 6e22  name": "version"
-00002a20: 2c20 2274 7970 6522 3a20 2273 7472 696e  , "type": "strin
-00002a30: 6722 7d2c 0a20 2020 2020 2020 2020 2020  g"},.           
-00002a40: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
-00002a50: 616d 6522 3a20 2263 6861 696e 4964 222c  ame": "chainId",
-00002a60: 2022 7479 7065 223a 2022 7569 6e74 3235   "type": "uint25
-00002a70: 3622 7d2c 0a20 2020 2020 2020 2020 2020  6"},.           
-00002a80: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
-00002a90: 616d 6522 3a20 2276 6572 6966 7969 6e67  ame": "verifying
-00002aa0: 436f 6e74 7261 6374 222c 2022 7479 7065  Contract", "type
-00002ab0: 223a 2022 6164 6472 6573 7322 7d0a 2020  ": "address"}.  
+000012e0: 696d 706f 7274 2028 2020 2320 6e6f 7161  import (  # noqa
+000012f0: 3a20 4634 3031 0a20 2020 2020 2020 2041  : F401.        A
+00001300: 7379 6e63 436f 6e74 7261 6374 2c0a 2020  syncContract,.  
+00001310: 2020 2020 2020 436f 6e74 7261 6374 2c0a        Contract,.
+00001320: 2020 2020 290a 2020 2020 6672 6f6d 2077      ).    from w
+00001330: 6562 332e 6d61 696e 2069 6d70 6f72 7420  eb3.main import 
+00001340: 2820 2023 206e 6f71 613a 2046 3430 310a  (  # noqa: F401.
+00001350: 2020 2020 2020 2020 4173 796e 6357 6562          AsyncWeb
+00001360: 332c 0a20 2020 2020 2020 2057 6562 332c  3,.        Web3,
+00001370: 0a20 2020 2029 0a0a 0a64 6566 2061 6269  .    )...def abi
+00001380: 5f65 6e63 6f64 6564 5f6f 6666 6368 6169  _encoded_offchai
+00001390: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
+000013a0: 745f 6164 6472 6573 7328 0a20 2020 2077  t_address(.    w
+000013b0: 333a 2055 6e69 6f6e 5b22 5765 6233 222c  3: Union["Web3",
+000013c0: 2022 4173 796e 6357 6562 3322 5d2c 0a20   "AsyncWeb3"],. 
+000013d0: 2020 206f 6666 6368 6169 6e5f 6c6f 6f6b     offchain_look
+000013e0: 7570 5f63 6f6e 7472 6163 743a 2055 6e69  up_contract: Uni
+000013f0: 6f6e 5b22 436f 6e74 7261 6374 222c 2022  on["Contract", "
+00001400: 4173 796e 6343 6f6e 7472 6163 7422 5d2c  AsyncContract"],
+00001410: 0a29 202d 3e20 4865 7841 6464 7265 7373  .) -> HexAddress
+00001420: 3a0a 2020 2020 7265 7475 726e 2048 6578  :.    return Hex
+00001430: 4164 6472 6573 7328 0a20 2020 2020 2020  Address(.       
+00001440: 2072 656d 6f76 655f 3078 5f70 7265 6669   remove_0x_prefi
+00001450: 7828 0a20 2020 2020 2020 2020 2020 2077  x(.            w
+00001460: 332e 746f 5f68 6578 280a 2020 2020 2020  3.to_hex(.      
+00001470: 2020 2020 2020 2020 2020 6162 692e 656e            abi.en
+00001480: 636f 6465 280a 2020 2020 2020 2020 2020  code(.          
+00001490: 2020 2020 2020 2020 2020 5b22 6164 6472            ["addr
+000014a0: 6573 7322 5d2c 0a20 2020 2020 2020 2020  ess"],.         
+000014b0: 2020 2020 2020 2020 2020 205b 746f 5f62             [to_b
+000014c0: 7974 6573 2868 6578 7374 723d 6f66 6663  ytes(hexstr=offc
+000014d0: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
+000014e0: 7261 6374 2e61 6464 7265 7373 295d 2c0a  ract.address)],.
+000014f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001500: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+00001510: 2020 2020 2020 2020 290a 2020 2020 290a          ).    ).
+00001520: 0a0a 636c 6173 7320 4173 796e 6345 7468  ..class AsyncEth
+00001530: 4d6f 6475 6c65 5465 7374 3a0a 2020 2020  ModuleTest:.    
+00001540: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+00001550: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+00001560: 6566 2074 6573 745f 6574 685f 6761 735f  ef test_eth_gas_
+00001570: 7072 6963 6528 7365 6c66 2c20 6173 796e  price(self, asyn
+00001580: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+00001590: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
+000015a0: 2020 2020 6761 735f 7072 6963 6520 3d20      gas_price = 
+000015b0: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+000015c0: 7468 2e67 6173 5f70 7269 6365 0a0a 2020  th.gas_price..  
+000015d0: 2020 2020 2020 6173 7365 7274 2067 6173        assert gas
+000015e0: 5f70 7269 6365 203e 2030 0a0a 2020 2020  _price > 0..    
+000015f0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+00001600: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+00001610: 6566 2074 6573 745f 6973 5f63 6f6e 6e65  ef test_is_conne
+00001620: 6374 6564 2873 656c 662c 2061 7379 6e63  cted(self, async
+00001630: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
+00001640: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00001650: 2020 2069 735f 636f 6e6e 6563 7465 6420     is_connected 
+00001660: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00001670: 2e69 735f 636f 6e6e 6563 7465 6428 290a  .is_connected().
+00001680: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00001690: 735f 636f 6e6e 6563 7465 6420 6973 2054  s_connected is T
+000016a0: 7275 650a 0a20 2020 2040 7079 7465 7374  rue..    @pytest
+000016b0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+000016c0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+000016d0: 5f65 7468 5f73 656e 645f 7472 616e 7361  _eth_send_transa
+000016e0: 6374 696f 6e5f 6c65 6761 6379 280a 2020  ction_legacy(.  
+000016f0: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
+00001700: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+00001710: 222c 2061 7379 6e63 5f75 6e6c 6f63 6b65  ", async_unlocke
+00001720: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
+00001730: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
+00001740: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
+00001750: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
+00001760: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
+00001770: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00001780: 2022 6672 6f6d 223a 2061 7379 6e63 5f75   "from": async_u
+00001790: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+000017a0: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+000017b0: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
+000017c0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+000017d0: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
+000017e0: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+000017f0: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+00001800: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
+00001810: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
+00001820: 2020 2267 6173 5072 6963 6522 3a20 6177    "gasPrice": aw
+00001830: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+00001840: 2e67 6173 5f70 7269 6365 2c0a 2020 2020  .gas_price,.    
+00001850: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
+00001860: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
+00001870: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
+00001880: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+00001890: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
+000018a0: 2074 786e 203d 2061 7761 6974 2061 7379   txn = await asy
+000018b0: 6e63 5f77 332e 6574 682e 6765 745f 7472  nc_w3.eth.get_tr
+000018c0: 616e 7361 6374 696f 6e28 7478 6e5f 6861  ansaction(txn_ha
+000018d0: 7368 290a 0a20 2020 2020 2020 2061 7373  sh)..        ass
+000018e0: 6572 7420 6973 5f73 616d 655f 6164 6472  ert is_same_addr
+000018f0: 6573 7328 7478 6e5b 2266 726f 6d22 5d2c  ess(txn["from"],
+00001900: 2063 6173 7428 4368 6563 6b73 756d 4164   cast(ChecksumAd
+00001910: 6472 6573 732c 2074 786e 5f70 6172 616d  dress, txn_param
+00001920: 735b 2266 726f 6d22 5d29 290a 2020 2020  s["from"])).    
+00001930: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
+00001940: 6d65 5f61 6464 7265 7373 2874 786e 5b22  me_address(txn["
+00001950: 746f 225d 2c20 6361 7374 2843 6865 636b  to"], cast(Check
+00001960: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
+00001970: 7061 7261 6d73 5b22 746f 225d 2929 0a20  params["to"])). 
+00001980: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
+00001990: 6e5b 2276 616c 7565 225d 203d 3d20 310a  n["value"] == 1.
+000019a0: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+000019b0: 786e 5b22 6761 7322 5d20 3d3d 2032 3130  xn["gas"] == 210
+000019c0: 3030 0a20 2020 2020 2020 2061 7373 6572  00.        asser
+000019d0: 7420 7478 6e5b 2267 6173 5072 6963 6522  t txn["gasPrice"
+000019e0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
+000019f0: 2267 6173 5072 6963 6522 5d0a 0a20 2020  "gasPrice"]..   
+00001a00: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00001a10: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+00001a20: 6465 6620 7465 7374 5f65 7468 5f6d 6f64  def test_eth_mod
+00001a30: 6966 795f 7472 616e 7361 6374 696f 6e5f  ify_transaction_
+00001a40: 6c65 6761 6379 280a 2020 2020 2020 2020  legacy(.        
+00001a50: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+00001a60: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
+00001a70: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+00001a80: 756e 743a 2043 6865 636b 7375 6d41 6464  unt: ChecksumAdd
+00001a90: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
+00001aa0: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
+00001ab0: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
+00001ac0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00001ad0: 2022 6672 6f6d 223a 2061 7379 6e63 5f75   "from": async_u
+00001ae0: 6e6c 6f63 6b65 645f 6163 636f 756e 742c  nlocked_account,
+00001af0: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
+00001b00: 223a 2061 7379 6e63 5f75 6e6c 6f63 6b65  ": async_unlocke
+00001b10: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
+00001b20: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
+00001b30: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
+00001b40: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
+00001b50: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
+00001b60: 6173 5072 6963 6522 3a20 6173 796e 635f  asPrice": async_
+00001b70: 7733 2e74 6f5f 7765 6928 0a20 2020 2020  w3.to_wei(.     
+00001b80: 2020 2020 2020 2020 2020 2031 2c20 2267             1, "g
+00001b90: 7765 6922 0a20 2020 2020 2020 2020 2020  wei".           
+00001ba0: 2029 2c20 2023 206d 7573 7420 6265 2067   ),  # must be g
+00001bb0: 7265 6174 6572 2074 6861 6e20 6261 7365  reater than base
+00001bc0: 5f66 6565 2070 6f73 7420 4c6f 6e64 6f6e  _fee post London
+00001bd0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00001be0: 2020 2074 786e 5f68 6173 6820 3d20 6177     txn_hash = aw
+00001bf0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+00001c00: 2e73 656e 645f 7472 616e 7361 6374 696f  .send_transactio
+00001c10: 6e28 7478 6e5f 7061 7261 6d73 290a 0a20  n(txn_params).. 
+00001c20: 2020 2020 2020 206d 6f64 6966 6965 645f         modified_
+00001c30: 7478 6e5f 6861 7368 203d 2061 7761 6974  txn_hash = await
+00001c40: 2061 7379 6e63 5f77 332e 6574 682e 6d6f   async_w3.eth.mo
+00001c50: 6469 6679 5f74 7261 6e73 6163 7469 6f6e  dify_transaction
+00001c60: 280a 2020 2020 2020 2020 2020 2020 7478  (.            tx
+00001c70: 6e5f 6861 7368 2c20 6761 7350 7269 6365  n_hash, gasPrice
+00001c80: 3d28 6361 7374 2869 6e74 2c20 7478 6e5f  =(cast(int, txn_
+00001c90: 7061 7261 6d73 5b22 6761 7350 7269 6365  params["gasPrice
+00001ca0: 225d 2920 2a20 3229 2c20 7661 6c75 653d  "]) * 2), value=
+00001cb0: 320a 2020 2020 2020 2020 290a 2020 2020  2.        ).    
+00001cc0: 2020 2020 6d6f 6469 6669 6564 5f74 786e      modified_txn
+00001cd0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00001ce0: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
+00001cf0: 6374 696f 6e28 6d6f 6469 6669 6564 5f74  ction(modified_t
+00001d00: 786e 5f68 6173 6829 0a0a 2020 2020 2020  xn_hash)..      
+00001d10: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+00001d20: 5f61 6464 7265 7373 280a 2020 2020 2020  _address(.      
+00001d30: 2020 2020 2020 6d6f 6469 6669 6564 5f74        modified_t
+00001d40: 786e 5b22 6672 6f6d 225d 2c20 6361 7374  xn["from"], cast
+00001d50: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
+00001d60: 2c20 7478 6e5f 7061 7261 6d73 5b22 6672  , txn_params["fr
+00001d70: 6f6d 225d 290a 2020 2020 2020 2020 290a  om"]).        ).
+00001d80: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00001d90: 735f 7361 6d65 5f61 6464 7265 7373 280a  s_same_address(.
+00001da0: 2020 2020 2020 2020 2020 2020 6d6f 6469              modi
+00001db0: 6669 6564 5f74 786e 5b22 746f 225d 2c20  fied_txn["to"], 
+00001dc0: 6361 7374 2843 6865 636b 7375 6d41 6464  cast(ChecksumAdd
+00001dd0: 7265 7373 2c20 7478 6e5f 7061 7261 6d73  ress, txn_params
+00001de0: 5b22 746f 225d 290a 2020 2020 2020 2020  ["to"]).        
+00001df0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00001e00: 206d 6f64 6966 6965 645f 7478 6e5b 2276   modified_txn["v
+00001e10: 616c 7565 225d 203d 3d20 320a 2020 2020  alue"] == 2.    
+00001e20: 2020 2020 6173 7365 7274 206d 6f64 6966      assert modif
+00001e30: 6965 645f 7478 6e5b 2267 6173 225d 203d  ied_txn["gas"] =
+00001e40: 3d20 3231 3030 300a 2020 2020 2020 2020  = 21000.        
+00001e50: 6173 7365 7274 206d 6f64 6966 6965 645f  assert modified_
+00001e60: 7478 6e5b 2267 6173 5072 6963 6522 5d20  txn["gasPrice"] 
+00001e70: 3d3d 2063 6173 7428 696e 742c 2074 786e  == cast(int, txn
+00001e80: 5f70 6172 616d 735b 2267 6173 5072 6963  _params["gasPric
+00001e90: 6522 5d29 202a 2032 0a0a 2020 2020 4070  e"]) * 2..    @p
+00001ea0: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+00001eb0: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
+00001ec0: 2074 6573 745f 6574 685f 6d6f 6469 6679   test_eth_modify
+00001ed0: 5f74 7261 6e73 6163 7469 6f6e 280a 2020  _transaction(.  
+00001ee0: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
+00001ef0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+00001f00: 222c 2061 7379 6e63 5f75 6e6c 6f63 6b65  ", async_unlocke
+00001f10: 645f 6163 636f 756e 743a 2043 6865 636b  d_account: Check
+00001f20: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
+00001f30: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00001f40: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
+00001f50: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
+00001f60: 2020 2020 2020 2022 6672 6f6d 223a 2061         "from": a
+00001f70: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+00001f80: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
+00001f90: 2020 2022 746f 223a 2061 7379 6e63 5f75     "to": async_u
+00001fa0: 6e6c 6f63 6b65 645f 6163 636f 756e 742c  nlocked_account,
+00001fb0: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
+00001fc0: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
+00001fd0: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
+00001fe0: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
+00001ff0: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
+00002000: 4665 6550 6572 4761 7322 3a20 6173 796e  FeePerGas": asyn
+00002010: 635f 7733 2e74 6f5f 7765 6928 312c 2022  c_w3.to_wei(1, "
+00002020: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
+00002030: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
+00002040: 7322 3a20 6173 796e 635f 7733 2e74 6f5f  s": async_w3.to_
+00002050: 7765 6928 322c 2022 6777 6569 2229 2c0a  wei(2, "gwei"),.
+00002060: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00002070: 2020 7478 6e5f 6861 7368 203d 2061 7761    txn_hash = awa
+00002080: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00002090: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+000020a0: 2874 786e 5f70 6172 616d 7329 0a0a 2020  (txn_params)..  
+000020b0: 2020 2020 2020 6d6f 6469 6669 6564 5f74        modified_t
+000020c0: 786e 5f68 6173 6820 3d20 6177 6169 7420  xn_hash = await 
+000020d0: 6173 796e 635f 7733 2e65 7468 2e6d 6f64  async_w3.eth.mod
+000020e0: 6966 795f 7472 616e 7361 6374 696f 6e28  ify_transaction(
+000020f0: 0a20 2020 2020 2020 2020 2020 2074 786e  .            txn
+00002100: 5f68 6173 682c 0a20 2020 2020 2020 2020  _hash,.         
+00002110: 2020 2076 616c 7565 3d32 2c0a 2020 2020     value=2,.    
+00002120: 2020 2020 2020 2020 6d61 7850 7269 6f72          maxPrior
+00002130: 6974 7946 6565 5065 7247 6173 3d28 6361  ityFeePerGas=(ca
+00002140: 7374 2857 6569 2c20 7478 6e5f 7061 7261  st(Wei, txn_para
+00002150: 6d73 5b22 6d61 7850 7269 6f72 6974 7946  ms["maxPriorityF
+00002160: 6565 5065 7247 6173 225d 2920 2a20 3229  eePerGas"]) * 2)
+00002170: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
+00002180: 7846 6565 5065 7247 6173 3d28 6361 7374  xFeePerGas=(cast
+00002190: 2857 6569 2c20 7478 6e5f 7061 7261 6d73  (Wei, txn_params
+000021a0: 5b22 6d61 7846 6565 5065 7247 6173 225d  ["maxFeePerGas"]
+000021b0: 2920 2a20 3229 2c0a 2020 2020 2020 2020  ) * 2),.        
+000021c0: 290a 2020 2020 2020 2020 6d6f 6469 6669  ).        modifi
+000021d0: 6564 5f74 786e 203d 2061 7761 6974 2061  ed_txn = await a
+000021e0: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+000021f0: 7472 616e 7361 6374 696f 6e28 6d6f 6469  transaction(modi
+00002200: 6669 6564 5f74 786e 5f68 6173 6829 0a0a  fied_txn_hash)..
+00002210: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00002220: 735f 7361 6d65 5f61 6464 7265 7373 280a  s_same_address(.
+00002230: 2020 2020 2020 2020 2020 2020 6d6f 6469              modi
+00002240: 6669 6564 5f74 786e 5b22 6672 6f6d 225d  fied_txn["from"]
+00002250: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
+00002260: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
+00002270: 6d73 5b22 6672 6f6d 225d 290a 2020 2020  ms["from"]).    
+00002280: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+00002290: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
+000022a0: 7265 7373 280a 2020 2020 2020 2020 2020  ress(.          
+000022b0: 2020 6d6f 6469 6669 6564 5f74 786e 5b22    modified_txn["
+000022c0: 746f 225d 2c20 6361 7374 2843 6865 636b  to"], cast(Check
+000022d0: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
+000022e0: 7061 7261 6d73 5b22 746f 225d 290a 2020  params["to"]).  
+000022f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00002300: 6173 7365 7274 206d 6f64 6966 6965 645f  assert modified_
+00002310: 7478 6e5b 2276 616c 7565 225d 203d 3d20  txn["value"] == 
+00002320: 320a 2020 2020 2020 2020 6173 7365 7274  2.        assert
+00002330: 206d 6f64 6966 6965 645f 7478 6e5b 2267   modified_txn["g
+00002340: 6173 225d 203d 3d20 3231 3030 300a 2020  as"] == 21000.  
+00002350: 2020 2020 2020 6173 7365 7274 2028 0a20        assert (. 
+00002360: 2020 2020 2020 2020 2020 206d 6f64 6966             modif
+00002370: 6965 645f 7478 6e5b 226d 6178 5072 696f  ied_txn["maxPrio
+00002380: 7269 7479 4665 6550 6572 4761 7322 5d0a  rityFeePerGas"].
+00002390: 2020 2020 2020 2020 2020 2020 3d3d 2063              == c
+000023a0: 6173 7428 5765 692c 2074 786e 5f70 6172  ast(Wei, txn_par
+000023b0: 616d 735b 226d 6178 5072 696f 7269 7479  ams["maxPriority
+000023c0: 4665 6550 6572 4761 7322 5d29 202a 2032  FeePerGas"]) * 2
+000023d0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000023e0: 2020 2061 7373 6572 7420 6d6f 6469 6669     assert modifi
+000023f0: 6564 5f74 786e 5b22 6d61 7846 6565 5065  ed_txn["maxFeePe
+00002400: 7247 6173 225d 203d 3d20 6361 7374 2857  rGas"] == cast(W
+00002410: 6569 2c20 7478 6e5f 7061 7261 6d73 5b22  ei, txn_params["
+00002420: 6d61 7846 6565 5065 7247 6173 225d 2920  maxFeePerGas"]) 
+00002430: 2a20 320a 0a20 2020 2040 7079 7465 7374  * 2..    @pytest
+00002440: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+00002450: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+00002460: 5f61 7379 6e63 5f65 7468 5f73 6967 6e5f  _async_eth_sign_
+00002470: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
+00002480: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
+00002490: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
+000024a0: 2c20 6173 796e 635f 756e 6c6f 636b 6564  , async_unlocked
+000024b0: 5f61 6363 6f75 6e74 3a20 4368 6563 6b73  _account: Checks
+000024c0: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
+000024d0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+000024e0: 2074 786e 5f70 6172 616d 733a 2054 7850   txn_params: TxP
+000024f0: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+00002500: 2020 2020 2020 2266 726f 6d22 3a20 6173        "from": as
+00002510: 796e 635f 756e 6c6f 636b 6564 5f61 6363  ync_unlocked_acc
+00002520: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
+00002530: 2020 2274 6f22 3a20 6173 796e 635f 756e    "to": async_un
+00002540: 6c6f 636b 6564 5f61 6363 6f75 6e74 2c0a  locked_account,.
+00002550: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+00002560: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
+00002570: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
+00002580: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
+00002590: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
+000025a0: 223a 2061 7379 6e63 5f77 332e 746f 5f77  ": async_w3.to_w
+000025b0: 6569 2832 2c20 2267 7765 6922 292c 0a20  ei(2, "gwei"),. 
+000025c0: 2020 2020 2020 2020 2020 2022 6d61 7850             "maxP
+000025d0: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+000025e0: 223a 2061 7379 6e63 5f77 332e 746f 5f77  ": async_w3.to_w
+000025f0: 6569 2831 2c20 2267 7765 6922 292c 0a20  ei(1, "gwei"),. 
+00002600: 2020 2020 2020 2020 2020 2022 6e6f 6e63             "nonc
+00002610: 6522 3a20 4e6f 6e63 6528 3029 2c0a 2020  e": Nonce(0),.  
+00002620: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00002630: 7265 7375 6c74 203d 2061 7761 6974 2061  result = await a
+00002640: 7379 6e63 5f77 332e 6574 682e 7369 676e  sync_w3.eth.sign
+00002650: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+00002660: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
+00002670: 2073 6967 6e61 746f 7279 5f61 6363 6f75   signatory_accou
+00002680: 6e74 203d 2061 7379 6e63 5f77 332e 6574  nt = async_w3.et
+00002690: 682e 6163 636f 756e 742e 7265 636f 7665  h.account.recove
+000026a0: 725f 7472 616e 7361 6374 696f 6e28 7265  r_transaction(re
+000026b0: 7375 6c74 5b22 7261 7722 5d29 0a20 2020  sult["raw"]).   
+000026c0: 2020 2020 2061 7373 6572 7420 6173 796e       assert asyn
+000026d0: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
+000026e0: 6e74 203d 3d20 7369 676e 6174 6f72 795f  nt == signatory_
+000026f0: 6163 636f 756e 740a 2020 2020 2020 2020  account.        
+00002700: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
+00002710: 7822 5d5b 2274 6f22 5d20 3d3d 2074 786e  x"]["to"] == txn
+00002720: 5f70 6172 616d 735b 2274 6f22 5d0a 2020  _params["to"].  
+00002730: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
+00002740: 756c 745b 2274 7822 5d5b 2276 616c 7565  ult["tx"]["value
+00002750: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
+00002760: 5b22 7661 6c75 6522 5d0a 2020 2020 2020  ["value"].      
+00002770: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
+00002780: 2274 7822 5d5b 2267 6173 225d 203d 3d20  "tx"]["gas"] == 
+00002790: 7478 6e5f 7061 7261 6d73 5b22 6761 7322  txn_params["gas"
+000027a0: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+000027b0: 2072 6573 756c 745b 2274 7822 5d5b 226d   result["tx"]["m
+000027c0: 6178 4665 6550 6572 4761 7322 5d20 3d3d  axFeePerGas"] ==
+000027d0: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
+000027e0: 4665 6550 6572 4761 7322 5d0a 2020 2020  FeePerGas"].    
+000027f0: 2020 2020 6173 7365 7274 2028 0a20 2020      assert (.   
+00002800: 2020 2020 2020 2020 2072 6573 756c 745b           result[
+00002810: 2274 7822 5d5b 226d 6178 5072 696f 7269  "tx"]["maxPriori
+00002820: 7479 4665 6550 6572 4761 7322 5d20 3d3d  tyFeePerGas"] ==
+00002830: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
+00002840: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+00002850: 7322 5d0a 2020 2020 2020 2020 290a 2020  s"].        ).  
+00002860: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
+00002870: 756c 745b 2274 7822 5d5b 226e 6f6e 6365  ult["tx"]["nonce
+00002880: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
+00002890: 5b22 6e6f 6e63 6522 5d0a 0a20 2020 2040  ["nonce"]..    @
+000028a0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+000028b0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+000028c0: 6620 7465 7374 5f65 7468 5f73 6967 6e5f  f test_eth_sign_
+000028d0: 7479 7065 645f 6461 7461 280a 2020 2020  typed_data(.    
+000028e0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+000028f0: 2020 6173 796e 635f 7733 3a20 2241 7379    async_w3: "Asy
+00002900: 6e63 5765 6233 222c 0a20 2020 2020 2020  ncWeb3",.       
+00002910: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+00002920: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+00002930: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
+00002940: 7373 2c0a 2020 2020 2020 2020 6173 796e  ss,.        asyn
+00002950: 635f 736b 6970 5f69 665f 7465 7374 7270  c_skip_if_testrp
+00002960: 633a 2043 616c 6c61 626c 655b 5b22 4173  c: Callable[["As
+00002970: 796e 6357 6562 3322 5d2c 204e 6f6e 655d  yncWeb3"], None]
+00002980: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+00002990: 0a20 2020 2020 2020 2076 616c 6964 4a53  .        validJS
+000029a0: 4f4e 4d65 7373 6167 6520 3d20 2222 220a  ONMessage = """.
+000029b0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+000029c0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+000029d0: 7970 6573 223a 207b 0a20 2020 2020 2020  ypes": {.       
+000029e0: 2020 2020 2020 2020 2020 2020 2022 4549               "EI
+000029f0: 5037 3132 446f 6d61 696e 223a 205b 0a20  P712Domain": [. 
+00002a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a10: 2020 2020 2020 207b 226e 616d 6522 3a20         {"name": 
+00002a20: 226e 616d 6522 2c20 2274 7970 6522 3a20  "name", "type": 
+00002a30: 2273 7472 696e 6722 7d2c 0a20 2020 2020  "string"},.     
+00002a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a50: 2020 207b 226e 616d 6522 3a20 2276 6572     {"name": "ver
+00002a60: 7369 6f6e 222c 2022 7479 7065 223a 2022  sion", "type": "
+00002a70: 7374 7269 6e67 227d 2c0a 2020 2020 2020  string"},.      
+00002a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a90: 2020 7b22 6e61 6d65 223a 2022 6368 6169    {"name": "chai
+00002aa0: 6e49 6422 2c20 2274 7970 6522 3a20 2275  nId", "type": "u
+00002ab0: 696e 7432 3536 227d 2c0a 2020 2020 2020  int256"},.      
 00002ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ad0: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
-00002ae0: 2020 2020 2020 2020 2022 5065 7273 6f6e           "Person
-00002af0: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
-00002b00: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
-00002b10: 616d 6522 3a20 226e 616d 6522 2c20 2274  ame": "name", "t
-00002b20: 7970 6522 3a20 2273 7472 696e 6722 7d2c  ype": "string"},
-00002b30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002b40: 2020 2020 2020 2020 207b 226e 616d 6522           {"name"
-00002b50: 3a20 2277 616c 6c65 7422 2c20 2274 7970  : "wallet", "typ
-00002b60: 6522 3a20 2261 6464 7265 7373 227d 0a20  e": "address"}. 
-00002b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b80: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-00002b90: 2020 2020 2020 2020 2020 224d 6169 6c22            "Mail"
-00002ba0: 3a20 5b0a 2020 2020 2020 2020 2020 2020  : [.            
-00002bb0: 2020 2020 2020 2020 2020 2020 7b22 6e61              {"na
-00002bc0: 6d65 223a 2022 6672 6f6d 222c 2022 7479  me": "from", "ty
-00002bd0: 7065 223a 2022 5065 7273 6f6e 227d 2c0a  pe": "Person"},.
-00002be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002bf0: 2020 2020 2020 2020 7b22 6e61 6d65 223a          {"name":
-00002c00: 2022 746f 222c 2022 7479 7065 223a 2022   "to", "type": "
-00002c10: 5065 7273 6f6e 227d 2c0a 2020 2020 2020  Person"},.      
-00002c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c30: 2020 7b22 6e61 6d65 223a 2022 636f 6e74    {"name": "cont
-00002c40: 656e 7473 222c 2022 7479 7065 223a 2022  ents", "type": "
-00002c50: 7374 7269 6e67 227d 0a20 2020 2020 2020  string"}.       
-00002c60: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
-00002c70: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00002c80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00002c90: 2020 2270 7269 6d61 7279 5479 7065 223a    "primaryType":
-00002ca0: 2022 4d61 696c 222c 0a20 2020 2020 2020   "Mail",.       
-00002cb0: 2020 2020 2020 2020 2022 646f 6d61 696e           "domain
-00002cc0: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
-00002cd0: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
-00002ce0: 2022 4574 6865 7220 4d61 696c 222c 0a20   "Ether Mail",. 
-00002cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002d00: 2020 2022 7665 7273 696f 6e22 3a20 2231     "version": "1
-00002d10: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00002d20: 2020 2020 2020 2022 6368 6169 6e49 6422         "chainId"
-00002d30: 3a20 2230 7830 3122 2c0a 2020 2020 2020  : "0x01",.      
-00002d40: 2020 2020 2020 2020 2020 2020 2020 2276                "v
-00002d50: 6572 6966 7969 6e67 436f 6e74 7261 6374  erifyingContract
-00002d60: 223a 2022 3078 4363 4343 6363 6363 4343  ": "0xCcCCccccCC
-00002d70: 4343 6343 4343 4343 4363 4363 4363 6343  CCcCCCCCCcCcCccC
-00002d80: 6343 4343 6343 6363 6363 6363 6343 220a  cCCCcCcccccccC".
-00002d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002da0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-00002db0: 2020 2022 6d65 7373 6167 6522 3a20 7b0a     "message": {.
-00002dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002dd0: 2020 2020 2266 726f 6d22 3a20 7b0a 2020      "from": {.  
-00002de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002df0: 2020 2020 2020 226e 616d 6522 3a20 2243        "name": "C
-00002e00: 6f77 222c 0a20 2020 2020 2020 2020 2020  ow",.           
-00002e10: 2020 2020 2020 2020 2020 2020 2022 7761               "wa
-00002e20: 6c6c 6574 223a 2022 3078 4344 3261 3364  llet": "0xCD2a3d
-00002e30: 3946 3933 3845 3133 4344 3934 3745 6330  9F938E13CD947Ec0
-00002e40: 3541 6243 3746 4537 3334 4466 3844 4438  5AbC7FE734Df8DD8
-00002e50: 3236 220a 2020 2020 2020 2020 2020 2020  26".            
-00002e60: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-00002e70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00002e80: 746f 223a 207b 0a20 2020 2020 2020 2020  to": {.         
-00002e90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00002ea0: 6e61 6d65 223a 2022 426f 6222 2c0a 2020  name": "Bob",.  
+00002ad0: 2020 7b22 6e61 6d65 223a 2022 7665 7269    {"name": "veri
+00002ae0: 6679 696e 6743 6f6e 7472 6163 7422 2c20  fyingContract", 
+00002af0: 2274 7970 6522 3a20 2261 6464 7265 7373  "type": "address
+00002b00: 227d 0a20 2020 2020 2020 2020 2020 2020  "}.             
+00002b10: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
+00002b20: 2020 2020 2020 2020 2020 2020 2020 2250                "P
+00002b30: 6572 736f 6e22 3a20 5b0a 2020 2020 2020  erson": [.      
+00002b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002b50: 2020 7b22 6e61 6d65 223a 2022 6e61 6d65    {"name": "name
+00002b60: 222c 2022 7479 7065 223a 2022 7374 7269  ", "type": "stri
+00002b70: 6e67 227d 2c0a 2020 2020 2020 2020 2020  ng"},.          
+00002b80: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+00002b90: 6e61 6d65 223a 2022 7761 6c6c 6574 222c  name": "wallet",
+00002ba0: 2022 7479 7065 223a 2022 6164 6472 6573   "type": "addres
+00002bb0: 7322 7d0a 2020 2020 2020 2020 2020 2020  s"}.            
+00002bc0: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+00002bd0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00002be0: 4d61 696c 223a 205b 0a20 2020 2020 2020  Mail": [.       
+00002bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c00: 207b 226e 616d 6522 3a20 2266 726f 6d22   {"name": "from"
+00002c10: 2c20 2274 7970 6522 3a20 2250 6572 736f  , "type": "Perso
+00002c20: 6e22 7d2c 0a20 2020 2020 2020 2020 2020  n"},.           
+00002c30: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
+00002c40: 616d 6522 3a20 2274 6f22 2c20 2274 7970  ame": "to", "typ
+00002c50: 6522 3a20 2250 6572 736f 6e22 7d2c 0a20  e": "Person"},. 
+00002c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c70: 2020 2020 2020 207b 226e 616d 6522 3a20         {"name": 
+00002c80: 2263 6f6e 7465 6e74 7322 2c20 2274 7970  "contents", "typ
+00002c90: 6522 3a20 2273 7472 696e 6722 7d0a 2020  e": "string"}.  
+00002ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002cb0: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
+00002cc0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+00002cd0: 2020 2020 2020 2022 7072 696d 6172 7954         "primaryT
+00002ce0: 7970 6522 3a20 224d 6169 6c22 2c0a 2020  ype": "Mail",.  
+00002cf0: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+00002d00: 6f6d 6169 6e22 3a20 7b0a 2020 2020 2020  omain": {.      
+00002d10: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+00002d20: 616d 6522 3a20 2245 7468 6572 204d 6169  ame": "Ether Mai
+00002d30: 6c22 2c0a 2020 2020 2020 2020 2020 2020  l",.            
+00002d40: 2020 2020 2020 2020 2276 6572 7369 6f6e          "version
+00002d50: 223a 2022 3122 2c0a 2020 2020 2020 2020  ": "1",.        
+00002d60: 2020 2020 2020 2020 2020 2020 2263 6861              "cha
+00002d70: 696e 4964 223a 2022 3078 3031 222c 0a20  inId": "0x01",. 
+00002d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002d90: 2020 2022 7665 7269 6679 696e 6743 6f6e     "verifyingCon
+00002da0: 7472 6163 7422 3a20 2230 7843 6343 4363  tract": "0xCcCCc
+00002db0: 6363 6343 4343 4363 4343 4343 4343 6343  cccCCCCcCCCCCCcC
+00002dc0: 6343 6363 4363 4343 4363 4363 6363 6363  cCccCcCCCcCccccc
+00002dd0: 6363 4322 0a20 2020 2020 2020 2020 2020  ccC".           
+00002de0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+00002df0: 2020 2020 2020 2020 226d 6573 7361 6765          "message
+00002e00: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
+00002e10: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
+00002e20: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00002e30: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
+00002e40: 223a 2022 436f 7722 2c0a 2020 2020 2020  ": "Cow",.      
+00002e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002e60: 2020 2277 616c 6c65 7422 3a20 2230 7843    "wallet": "0xC
+00002e70: 4432 6133 6439 4639 3338 4531 3343 4439  D2a3d9F938E13CD9
+00002e80: 3437 4563 3035 4162 4337 4645 3733 3444  47Ec05AbC7FE734D
+00002e90: 6638 4444 3832 3622 0a20 2020 2020 2020  f8DD826".       
+00002ea0: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
 00002eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ec0: 2020 2020 2020 2277 616c 6c65 7422 3a20        "wallet": 
-00002ed0: 2230 7862 4262 4242 4242 6262 4242 4262  "0xbBbBBBBbbBBBb
-00002ee0: 6262 4262 6242 6262 6262 4242 6242 6262  bbBbbBbbbbBBbBbb
-00002ef0: 6262 4262 4262 6242 4262 4222 0a20 2020  bbBbBbbBBbB".   
-00002f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f10: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-00002f20: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
-00002f30: 7322 3a20 2248 656c 6c6f 2c20 426f 6221  s": "Hello, Bob!
+00002ec0: 2020 2020 2274 6f22 3a20 7b0a 2020 2020      "to": {.    
+00002ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002ee0: 2020 2020 226e 616d 6522 3a20 2242 6f62      "name": "Bob
+00002ef0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00002f00: 2020 2020 2020 2020 2020 2022 7761 6c6c             "wall
+00002f10: 6574 223a 2022 3078 6242 6242 4242 4262  et": "0xbBbBBBBb
+00002f20: 6242 4242 6262 6242 6262 4262 6262 6242  bBBBbbbBbbBbbbbB
+00002f30: 4262 4262 6262 6242 6242 6262 4242 6242  BbBbbbbBbBbbBBbB
 00002f40: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00002f50: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-00002f60: 7d0a 2020 2020 2020 2020 2222 220a 2020  }.        """.  
-00002f70: 2020 2020 2020 6173 796e 635f 736b 6970        async_skip
-00002f80: 5f69 665f 7465 7374 7270 6328 6173 796e  _if_testrpc(asyn
-00002f90: 635f 7733 290a 2020 2020 2020 2020 7369  c_w3).        si
-00002fa0: 676e 6174 7572 6520 3d20 4865 7842 7974  gnature = HexByt
-00002fb0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-00002fc0: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
-00002fd0: 7468 2e73 6967 6e5f 7479 7065 645f 6461  th.sign_typed_da
-00002fe0: 7461 280a 2020 2020 2020 2020 2020 2020  ta(.            
-00002ff0: 2020 2020 6173 796e 635f 756e 6c6f 636b      async_unlock
-00003000: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
-00003010: 7479 7065 2c20 6a73 6f6e 2e6c 6f61 6473  type, json.loads
-00003020: 2876 616c 6964 4a53 4f4e 4d65 7373 6167  (validJSONMessag
-00003030: 6529 0a20 2020 2020 2020 2020 2020 2029  e).            )
-00003040: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00003050: 2020 2061 7373 6572 7420 6c65 6e28 7369     assert len(si
-00003060: 676e 6174 7572 6529 203d 3d20 3332 202b  gnature) == 32 +
-00003070: 2033 3220 2b20 310a 0a20 2020 2040 7079   32 + 1..    @py
-00003080: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-00003090: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
-000030a0: 7465 7374 5f69 6e76 616c 6964 5f65 7468  test_invalid_eth
-000030b0: 5f73 6967 6e5f 7479 7065 645f 6461 7461  _sign_typed_data
-000030c0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-000030d0: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
-000030e0: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
-000030f0: 2020 2020 2020 2061 7379 6e63 5f75 6e6c         async_unl
-00003100: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
-00003110: 616c 5f74 7970 653a 2043 6865 636b 7375  al_type: Checksu
-00003120: 6d41 6464 7265 7373 2c0a 2020 2020 2020  mAddress,.      
-00003130: 2020 6173 796e 635f 736b 6970 5f69 665f    async_skip_if_
-00003140: 7465 7374 7270 633a 2043 616c 6c61 626c  testrpc: Callabl
-00003150: 655b 5b22 4173 796e 6357 6562 3322 5d2c  e[["AsyncWeb3"],
-00003160: 204e 6f6e 655d 2c0a 2020 2020 2920 2d3e   None],.    ) ->
-00003170: 204e 6f6e 653a 0a20 2020 2020 2020 2061   None:.        a
-00003180: 7379 6e63 5f73 6b69 705f 6966 5f74 6573  sync_skip_if_tes
-00003190: 7472 7063 2861 7379 6e63 5f77 3329 0a20  trpc(async_w3). 
-000031a0: 2020 2020 2020 2069 6e76 616c 6964 5f74         invalid_t
-000031b0: 7970 6564 5f6d 6573 7361 6765 203d 2022  yped_message = "
-000031c0: 2222 0a20 2020 2020 2020 2020 2020 207b  "".            {
-000031d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000031e0: 2022 7479 7065 7322 3a20 7b0a 2020 2020   "types": {.    
-000031f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003200: 2245 4950 3731 3244 6f6d 6169 6e22 3a20  "EIP712Domain": 
-00003210: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00003220: 2020 2020 2020 2020 2020 7b22 6e61 6d65            {"name
-00003230: 223a 2022 6e61 6d65 222c 2022 7479 7065  ": "name", "type
-00003240: 223a 2022 7374 7269 6e67 227d 2c0a 2020  ": "string"},.  
-00003250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003260: 2020 2020 2020 7b22 6e61 6d65 223a 2022        {"name": "
-00003270: 7665 7273 696f 6e22 2c20 2274 7970 6522  version", "type"
-00003280: 3a20 2273 7472 696e 6722 7d2c 0a20 2020  : "string"},.   
-00003290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000032a0: 2020 2020 207b 226e 616d 6522 3a20 2263       {"name": "c
-000032b0: 6861 696e 4964 222c 2022 7479 7065 223a  hainId", "type":
-000032c0: 2022 7569 6e74 3235 3622 7d2c 0a20 2020   "uint256"},.   
-000032d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000032e0: 2020 2020 207b 226e 616d 6522 3a20 2276       {"name": "v
-000032f0: 6572 6966 7969 6e67 436f 6e74 7261 6374  erifyingContract
-00003300: 222c 2022 7479 7065 223a 2022 6164 6472  ", "type": "addr
-00003310: 6573 7322 7d0a 2020 2020 2020 2020 2020  ess"}.          
-00003320: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-00003330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003340: 2022 5065 7273 6f6e 223a 205b 0a20 2020   "Person": [.   
-00003350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003360: 2020 2020 207b 226e 616d 6522 3a20 226e       {"name": "n
-00003370: 616d 6522 2c20 2274 7970 6522 3a20 2273  ame", "type": "s
-00003380: 7472 696e 6722 7d2c 0a20 2020 2020 2020  tring"},.       
-00003390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000033a0: 207b 226e 616d 6522 3a20 2277 616c 6c65   {"name": "walle
-000033b0: 7422 2c20 2274 7970 6522 3a20 2261 6464  t", "type": "add
-000033c0: 7265 7373 227d 0a20 2020 2020 2020 2020  ress"}.         
-000033d0: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-000033e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000033f0: 2020 224d 6169 6c22 3a20 5b0a 2020 2020    "Mail": [.    
-00003400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003410: 2020 2020 7b22 6e61 6d65 223a 2022 6672      {"name": "fr
-00003420: 6f6d 222c 2022 7479 7065 223a 2022 5065  om", "type": "Pe
-00003430: 7273 6f6e 227d 2c0a 2020 2020 2020 2020  rson"},.        
-00003440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003450: 7b22 6e61 6d65 223a 2022 746f 222c 2022  {"name": "to", "
-00003460: 7479 7065 223a 2022 5065 7273 6f6e 5b32  type": "Person[2
-00003470: 5d22 7d2c 0a20 2020 2020 2020 2020 2020  ]"},.           
-00003480: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
-00003490: 616d 6522 3a20 2263 6f6e 7465 6e74 7322  ame": "contents"
-000034a0: 2c20 2274 7970 6522 3a20 2273 7472 696e  , "type": "strin
-000034b0: 6722 7d0a 2020 2020 2020 2020 2020 2020  g"}.            
-000034c0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-000034d0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-000034e0: 2020 2020 2020 2020 2020 2020 2022 7072               "pr
-000034f0: 696d 6172 7954 7970 6522 3a20 224d 6169  imaryType": "Mai
-00003500: 6c22 2c0a 2020 2020 2020 2020 2020 2020  l",.            
-00003510: 2020 2020 2264 6f6d 6169 6e22 3a20 7b0a      "domain": {.
-00003520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003530: 2020 2020 226e 616d 6522 3a20 2245 7468      "name": "Eth
-00003540: 6572 204d 6169 6c22 2c0a 2020 2020 2020  er Mail",.      
-00003550: 2020 2020 2020 2020 2020 2020 2020 2276                "v
-00003560: 6572 7369 6f6e 223a 2022 3122 2c0a 2020  ersion": "1",.  
-00003570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003580: 2020 2263 6861 696e 4964 223a 2022 3078    "chainId": "0x
-00003590: 3031 222c 0a20 2020 2020 2020 2020 2020  01",.           
-000035a0: 2020 2020 2020 2020 2022 7665 7269 6679           "verify
-000035b0: 696e 6743 6f6e 7472 6163 7422 3a20 2230  ingContract": "0
-000035c0: 7843 6343 4363 6363 6343 4343 4363 4343  xCcCCccccCCCCcCC
-000035d0: 4343 4343 6343 6343 6363 4363 4343 4363  CCCCcCcCccCcCCCc
-000035e0: 4363 6363 6363 6363 4322 0a20 2020 2020  CcccccccC".     
-000035f0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
-00003600: 2020 2020 2020 2020 2020 2020 2020 226d                "m
-00003610: 6573 7361 6765 223a 207b 0a20 2020 2020  essage": {.     
-00003620: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00003630: 6672 6f6d 223a 207b 0a20 2020 2020 2020  from": {.       
-00003640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003650: 2022 6e61 6d65 223a 2022 436f 7722 2c0a   "name": "Cow",.
+00002f50: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+00002f60: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+00002f70: 6e74 656e 7473 223a 2022 4865 6c6c 6f2c  ntents": "Hello,
+00002f80: 2042 6f62 2122 0a20 2020 2020 2020 2020   Bob!".         
+00002f90: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00002fa0: 2020 2020 207d 0a20 2020 2020 2020 2022       }.        "
+00002fb0: 2222 0a20 2020 2020 2020 2061 7379 6e63  "".        async
+00002fc0: 5f73 6b69 705f 6966 5f74 6573 7472 7063  _skip_if_testrpc
+00002fd0: 2861 7379 6e63 5f77 3329 0a20 2020 2020  (async_w3).     
+00002fe0: 2020 2073 6967 6e61 7475 7265 203d 2048     signature = H
+00002ff0: 6578 4279 7465 7328 0a20 2020 2020 2020  exBytes(.       
+00003000: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
+00003010: 5f77 332e 6574 682e 7369 676e 5f74 7970  _w3.eth.sign_typ
+00003020: 6564 5f64 6174 6128 0a20 2020 2020 2020  ed_data(.       
+00003030: 2020 2020 2020 2020 2061 7379 6e63 5f75           async_u
+00003040: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+00003050: 6475 616c 5f74 7970 652c 206a 736f 6e2e  dual_type, json.
+00003060: 6c6f 6164 7328 7661 6c69 644a 534f 4e4d  loads(validJSONM
+00003070: 6573 7361 6765 290a 2020 2020 2020 2020  essage).        
+00003080: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
+00003090: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+000030a0: 656e 2873 6967 6e61 7475 7265 2920 3d3d  en(signature) ==
+000030b0: 2033 3220 2b20 3332 202b 2031 0a0a 2020   32 + 32 + 1..  
+000030c0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+000030d0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+000030e0: 2064 6566 2074 6573 745f 696e 7661 6c69   def test_invali
+000030f0: 645f 6574 685f 7369 676e 5f74 7970 6564  d_eth_sign_typed
+00003100: 5f64 6174 6128 0a20 2020 2020 2020 2073  _data(.        s
+00003110: 656c 662c 0a20 2020 2020 2020 2061 7379  elf,.        asy
+00003120: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
+00003130: 3322 2c0a 2020 2020 2020 2020 6173 796e  3",.        asyn
+00003140: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
+00003150: 6e74 5f64 7561 6c5f 7479 7065 3a20 4368  nt_dual_type: Ch
+00003160: 6563 6b73 756d 4164 6472 6573 732c 0a20  ecksumAddress,. 
+00003170: 2020 2020 2020 2061 7379 6e63 5f73 6b69         async_ski
+00003180: 705f 6966 5f74 6573 7472 7063 3a20 4361  p_if_testrpc: Ca
+00003190: 6c6c 6162 6c65 5b5b 2241 7379 6e63 5765  llable[["AsyncWe
+000031a0: 6233 225d 2c20 4e6f 6e65 5d2c 0a20 2020  b3"], None],.   
+000031b0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+000031c0: 2020 2020 6173 796e 635f 736b 6970 5f69      async_skip_i
+000031d0: 665f 7465 7374 7270 6328 6173 796e 635f  f_testrpc(async_
+000031e0: 7733 290a 2020 2020 2020 2020 696e 7661  w3).        inva
+000031f0: 6c69 645f 7479 7065 645f 6d65 7373 6167  lid_typed_messag
+00003200: 6520 3d20 2222 220a 2020 2020 2020 2020  e = """.        
+00003210: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00003220: 2020 2020 2020 2274 7970 6573 223a 207b        "types": {
+00003230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003240: 2020 2020 2022 4549 5037 3132 446f 6d61       "EIP712Doma
+00003250: 696e 223a 205b 0a20 2020 2020 2020 2020  in": [.         
+00003260: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00003270: 226e 616d 6522 3a20 226e 616d 6522 2c20  "name": "name", 
+00003280: 2274 7970 6522 3a20 2273 7472 696e 6722  "type": "string"
+00003290: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+000032a0: 2020 2020 2020 2020 2020 207b 226e 616d             {"nam
+000032b0: 6522 3a20 2276 6572 7369 6f6e 222c 2022  e": "version", "
+000032c0: 7479 7065 223a 2022 7374 7269 6e67 227d  type": "string"}
+000032d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000032e0: 2020 2020 2020 2020 2020 7b22 6e61 6d65            {"name
+000032f0: 223a 2022 6368 6169 6e49 6422 2c20 2274  ": "chainId", "t
+00003300: 7970 6522 3a20 2275 696e 7432 3536 227d  ype": "uint256"}
+00003310: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00003320: 2020 2020 2020 2020 2020 7b22 6e61 6d65            {"name
+00003330: 223a 2022 7665 7269 6679 696e 6743 6f6e  ": "verifyingCon
+00003340: 7472 6163 7422 2c20 2274 7970 6522 3a20  tract", "type": 
+00003350: 2261 6464 7265 7373 227d 0a20 2020 2020  "address"}.     
+00003360: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00003370: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00003380: 2020 2020 2020 2250 6572 736f 6e22 3a20        "Person": 
+00003390: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+000033a0: 2020 2020 2020 2020 2020 7b22 6e61 6d65            {"name
+000033b0: 223a 2022 6e61 6d65 222c 2022 7479 7065  ": "name", "type
+000033c0: 223a 2022 7374 7269 6e67 227d 2c0a 2020  ": "string"},.  
+000033d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000033e0: 2020 2020 2020 7b22 6e61 6d65 223a 2022        {"name": "
+000033f0: 7761 6c6c 6574 222c 2022 7479 7065 223a  wallet", "type":
+00003400: 2022 6164 6472 6573 7322 7d0a 2020 2020   "address"}.    
+00003410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003420: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00003430: 2020 2020 2020 2022 4d61 696c 223a 205b         "Mail": [
+00003440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003450: 2020 2020 2020 2020 207b 226e 616d 6522           {"name"
+00003460: 3a20 2266 726f 6d22 2c20 2274 7970 6522  : "from", "type"
+00003470: 3a20 2250 6572 736f 6e22 7d2c 0a20 2020  : "Person"},.   
+00003480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003490: 2020 2020 207b 226e 616d 6522 3a20 2274       {"name": "t
+000034a0: 6f22 2c20 2274 7970 6522 3a20 2250 6572  o", "type": "Per
+000034b0: 736f 6e5b 325d 227d 2c0a 2020 2020 2020  son[2]"},.      
+000034c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000034d0: 2020 7b22 6e61 6d65 223a 2022 636f 6e74    {"name": "cont
+000034e0: 656e 7473 222c 2022 7479 7065 223a 2022  ents", "type": "
+000034f0: 7374 7269 6e67 227d 0a20 2020 2020 2020  string"}.       
+00003500: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+00003510: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00003520: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00003530: 2020 2270 7269 6d61 7279 5479 7065 223a    "primaryType":
+00003540: 2022 4d61 696c 222c 0a20 2020 2020 2020   "Mail",.       
+00003550: 2020 2020 2020 2020 2022 646f 6d61 696e           "domain
+00003560: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
+00003570: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
+00003580: 2022 4574 6865 7220 4d61 696c 222c 0a20   "Ether Mail",. 
+00003590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000035a0: 2020 2022 7665 7273 696f 6e22 3a20 2231     "version": "1
+000035b0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000035c0: 2020 2020 2020 2022 6368 6169 6e49 6422         "chainId"
+000035d0: 3a20 2230 7830 3122 2c0a 2020 2020 2020  : "0x01",.      
+000035e0: 2020 2020 2020 2020 2020 2020 2020 2276                "v
+000035f0: 6572 6966 7969 6e67 436f 6e74 7261 6374  erifyingContract
+00003600: 223a 2022 3078 4363 4343 6363 6363 4343  ": "0xCcCCccccCC
+00003610: 4343 6343 4343 4343 4363 4363 4363 6343  CCcCCCCCCcCcCccC
+00003620: 6343 4343 6343 6363 6363 6363 6343 220a  cCCCcCcccccccC".
+00003630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003640: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00003650: 2020 2022 6d65 7373 6167 6522 3a20 7b0a     "message": {.
 00003660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003670: 2020 2020 2020 2020 2277 616c 6c65 7422          "wallet"
-00003680: 3a20 2230 7843 4432 6133 6439 4639 3338  : "0xCD2a3d9F938
-00003690: 4531 3343 4439 3437 4563 3035 4162 4337  E13CD947Ec05AbC7
-000036a0: 4645 3733 3444 6638 4444 3832 3622 0a20  FE734Df8DD826". 
-000036b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000036c0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-000036d0: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
-000036e0: 5b7b 0a20 2020 2020 2020 2020 2020 2020  [{.             
-000036f0: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
-00003700: 223a 2022 426f 6222 2c0a 2020 2020 2020  ": "Bob",.      
-00003710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003720: 2020 2277 616c 6c65 7422 3a20 2230 7862    "wallet": "0xb
-00003730: 4262 4242 4242 6262 4242 4262 6262 4262  BbBBBBbbBBBbbbBb
-00003740: 6242 6262 6262 4242 6242 6262 6262 4262  bBbbbbBBbBbbbbBb
-00003750: 4262 6242 4262 4222 0a20 2020 2020 2020  BbbBBbB".       
-00003760: 2020 2020 2020 2020 2020 2020 207d 5d2c               }],
-00003770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003780: 2020 2020 2022 636f 6e74 656e 7473 223a       "contents":
-00003790: 2022 4865 6c6c 6f2c 2042 6f62 2122 0a20   "Hello, Bob!". 
-000037a0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-000037b0: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
-000037c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000037d0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-000037e0: 6169 7365 7328 0a20 2020 2020 2020 2020  aises(.         
-000037f0: 2020 2056 616c 7565 4572 726f 722c 0a20     ValueError,. 
-00003800: 2020 2020 2020 2020 2020 206d 6174 6368             match
-00003810: 3d72 222e 2a45 7870 6563 7465 6420 3220  =r".*Expected 2 
-00003820: 6974 656d 7320 666f 7220 6172 7261 7920  items for array 
-00003830: 7479 7065 2050 6572 736f 6e5c 5b32 5c5d  type Person\[2\]
-00003840: 2c20 676f 7420 3120 6974 656d 732e 2a22  , got 1 items.*"
-00003850: 2c0a 2020 2020 2020 2020 293a 0a20 2020  ,.        ):.   
-00003860: 2020 2020 2020 2020 2061 7761 6974 2061           await a
-00003870: 7379 6e63 5f77 332e 6574 682e 7369 676e  sync_w3.eth.sign
-00003880: 5f74 7970 6564 5f64 6174 6128 0a20 2020  _typed_data(.   
-00003890: 2020 2020 2020 2020 2020 2020 2061 7379               asy
-000038a0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
-000038b0: 756e 745f 6475 616c 5f74 7970 652c 206a  unt_dual_type, j
-000038c0: 736f 6e2e 6c6f 6164 7328 696e 7661 6c69  son.loads(invali
-000038d0: 645f 7479 7065 645f 6d65 7373 6167 6529  d_typed_message)
-000038e0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-000038f0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00003900: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-00003910: 6e63 2064 6566 2074 6573 745f 6173 796e  nc def test_asyn
-00003920: 635f 6574 685f 7369 676e 5f74 7261 6e73  c_eth_sign_trans
-00003930: 6163 7469 6f6e 5f6c 6567 6163 7928 0a20  action_legacy(. 
-00003940: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
-00003950: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-00003960: 3322 2c20 6173 796e 635f 756e 6c6f 636b  3", async_unlock
-00003970: 6564 5f61 6363 6f75 6e74 3a20 4368 6563  ed_account: Chec
-00003980: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
-00003990: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-000039a0: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
-000039b0: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
-000039c0: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
-000039d0: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
-000039e0: 6363 6f75 6e74 2c0a 2020 2020 2020 2020  ccount,.        
-000039f0: 2020 2020 2274 6f22 3a20 6173 796e 635f      "to": async_
-00003a00: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00003a10: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-00003a20: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-00003a30: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-00003a40: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00003a50: 2020 2020 2022 6761 7350 7269 6365 223a       "gasPrice":
-00003a60: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00003a70: 6574 682e 6761 735f 7072 6963 652c 0a20  eth.gas_price,. 
-00003a80: 2020 2020 2020 2020 2020 2022 6e6f 6e63             "nonc
-00003a90: 6522 3a20 4e6f 6e63 6528 3029 2c0a 2020  e": Nonce(0),.  
-00003aa0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00003ab0: 7265 7375 6c74 203d 2061 7761 6974 2061  result = await a
-00003ac0: 7379 6e63 5f77 332e 6574 682e 7369 676e  sync_w3.eth.sign
-00003ad0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00003ae0: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
-00003af0: 2073 6967 6e61 746f 7279 5f61 6363 6f75   signatory_accou
-00003b00: 6e74 203d 2061 7379 6e63 5f77 332e 6574  nt = async_w3.et
-00003b10: 682e 6163 636f 756e 742e 7265 636f 7665  h.account.recove
-00003b20: 725f 7472 616e 7361 6374 696f 6e28 7265  r_transaction(re
-00003b30: 7375 6c74 5b22 7261 7722 5d29 0a20 2020  sult["raw"]).   
-00003b40: 2020 2020 2061 7373 6572 7420 6173 796e       assert asyn
-00003b50: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
-00003b60: 6e74 203d 3d20 7369 676e 6174 6f72 795f  nt == signatory_
-00003b70: 6163 636f 756e 740a 2020 2020 2020 2020  account.        
-00003b80: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
-00003b90: 7822 5d5b 2274 6f22 5d20 3d3d 2074 786e  x"]["to"] == txn
-00003ba0: 5f70 6172 616d 735b 2274 6f22 5d0a 2020  _params["to"].  
-00003bb0: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
-00003bc0: 756c 745b 2274 7822 5d5b 2276 616c 7565  ult["tx"]["value
-00003bd0: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
-00003be0: 5b22 7661 6c75 6522 5d0a 2020 2020 2020  ["value"].      
-00003bf0: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
-00003c00: 2274 7822 5d5b 2267 6173 225d 203d 3d20  "tx"]["gas"] == 
-00003c10: 7478 6e5f 7061 7261 6d73 5b22 6761 7322  txn_params["gas"
-00003c20: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
-00003c30: 2072 6573 756c 745b 2274 7822 5d5b 2267   result["tx"]["g
-00003c40: 6173 5072 6963 6522 5d20 3d3d 2074 786e  asPrice"] == txn
-00003c50: 5f70 6172 616d 735b 2267 6173 5072 6963  _params["gasPric
-00003c60: 6522 5d0a 2020 2020 2020 2020 6173 7365  e"].        asse
-00003c70: 7274 2072 6573 756c 745b 2274 7822 5d5b  rt result["tx"][
-00003c80: 226e 6f6e 6365 225d 203d 3d20 7478 6e5f  "nonce"] == txn_
-00003c90: 7061 7261 6d73 5b22 6e6f 6e63 6522 5d0a  params["nonce"].
-00003ca0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-00003cb0: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-00003cc0: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
-00003cd0: 6e63 5f65 7468 5f73 6967 6e5f 7472 616e  nc_eth_sign_tran
-00003ce0: 7361 6374 696f 6e5f 6865 785f 6665 6573  saction_hex_fees
-00003cf0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-00003d00: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-00003d10: 5765 6233 222c 2061 7379 6e63 5f75 6e6c  Web3", async_unl
-00003d20: 6f63 6b65 645f 6163 636f 756e 743a 2043  ocked_account: C
-00003d30: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
-00003d40: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-00003d50: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-00003d60: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
-00003d70: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-00003d80: 223a 2061 7379 6e63 5f75 6e6c 6f63 6b65  ": async_unlocke
-00003d90: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
-00003da0: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
-00003db0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
-00003dc0: 756e 742c 0a20 2020 2020 2020 2020 2020  unt,.           
-00003dd0: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
-00003de0: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-00003df0: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
-00003e00: 2020 2020 2020 2020 226d 6178 4665 6550          "maxFeeP
-00003e10: 6572 4761 7322 3a20 6865 7828 6173 796e  erGas": hex(asyn
-00003e20: 635f 7733 2e74 6f5f 7765 6928 322c 2022  c_w3.to_wei(2, "
-00003e30: 6777 6569 2229 292c 0a20 2020 2020 2020  gwei")),.       
-00003e40: 2020 2020 2022 6d61 7850 7269 6f72 6974       "maxPriorit
-00003e50: 7946 6565 5065 7247 6173 223a 2068 6578  yFeePerGas": hex
+00003670: 2020 2020 2266 726f 6d22 3a20 7b0a 2020      "from": {.  
+00003680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003690: 2020 2020 2020 226e 616d 6522 3a20 2243        "name": "C
+000036a0: 6f77 222c 0a20 2020 2020 2020 2020 2020  ow",.           
+000036b0: 2020 2020 2020 2020 2020 2020 2022 7761               "wa
+000036c0: 6c6c 6574 223a 2022 3078 4344 3261 3364  llet": "0xCD2a3d
+000036d0: 3946 3933 3845 3133 4344 3934 3745 6330  9F938E13CD947Ec0
+000036e0: 3541 6243 3746 4537 3334 4466 3844 4438  5AbC7FE734Df8DD8
+000036f0: 3236 220a 2020 2020 2020 2020 2020 2020  26".            
+00003700: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+00003710: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00003720: 746f 223a 205b 7b0a 2020 2020 2020 2020  to": [{.        
+00003730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003740: 226e 616d 6522 3a20 2242 6f62 222c 0a20  "name": "Bob",. 
+00003750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003760: 2020 2020 2020 2022 7761 6c6c 6574 223a         "wallet":
+00003770: 2022 3078 6242 6242 4242 4262 6242 4242   "0xbBbBBBBbbBBB
+00003780: 6262 6242 6262 4262 6262 6242 4262 4262  bbbBbbBbbbbBBbBb
+00003790: 6262 6242 6242 6262 4242 6242 220a 2020  bbbBbBbbBBbB".  
+000037a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000037b0: 2020 7d5d 2c0a 2020 2020 2020 2020 2020    }],.          
+000037c0: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
+000037d0: 6e74 7322 3a20 2248 656c 6c6f 2c20 426f  nts": "Hello, Bo
+000037e0: 6221 220a 2020 2020 2020 2020 2020 2020  b!".            
+000037f0: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+00003800: 2020 7d0a 2020 2020 2020 2020 2222 220a    }.        """.
+00003810: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+00003820: 6573 742e 7261 6973 6573 280a 2020 2020  est.raises(.    
+00003830: 2020 2020 2020 2020 5661 6c75 6545 7272          ValueErr
+00003840: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
+00003850: 6d61 7463 683d 7222 2e2a 4578 7065 6374  match=r".*Expect
+00003860: 6564 2032 2069 7465 6d73 2066 6f72 2061  ed 2 items for a
+00003870: 7272 6179 2074 7970 6520 5065 7273 6f6e  rray type Person
+00003880: 5c5b 325c 5d2c 2067 6f74 2031 2069 7465  \[2\], got 1 ite
+00003890: 6d73 2e2a 222c 0a20 2020 2020 2020 2029  ms.*",.        )
+000038a0: 3a0a 2020 2020 2020 2020 2020 2020 6177  :.            aw
+000038b0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+000038c0: 2e73 6967 6e5f 7479 7065 645f 6461 7461  .sign_typed_data
+000038d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000038e0: 2020 6173 796e 635f 756e 6c6f 636b 6564    async_unlocked
+000038f0: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+00003900: 7065 2c20 6a73 6f6e 2e6c 6f61 6473 2869  pe, json.loads(i
+00003910: 6e76 616c 6964 5f74 7970 6564 5f6d 6573  nvalid_typed_mes
+00003920: 7361 6765 290a 2020 2020 2020 2020 2020  sage).          
+00003930: 2020 290a 0a20 2020 2040 7079 7465 7374    )..    @pytest
+00003940: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+00003950: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+00003960: 5f61 7379 6e63 5f65 7468 5f73 6967 6e5f  _async_eth_sign_
+00003970: 7472 616e 7361 6374 696f 6e5f 6c65 6761  transaction_lega
+00003980: 6379 280a 2020 2020 2020 2020 7365 6c66  cy(.        self
+00003990: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
+000039a0: 6e63 5765 6233 222c 2061 7379 6e63 5f75  ncWeb3", async_u
+000039b0: 6e6c 6f63 6b65 645f 6163 636f 756e 743a  nlocked_account:
+000039c0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+000039d0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+000039e0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+000039f0: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+00003a00: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+00003a10: 6f6d 223a 2061 7379 6e63 5f75 6e6c 6f63  om": async_unloc
+00003a20: 6b65 645f 6163 636f 756e 742c 0a20 2020  ked_account,.   
+00003a30: 2020 2020 2020 2020 2022 746f 223a 2061           "to": a
+00003a40: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+00003a50: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
+00003a60: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
+00003a70: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+00003a80: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
+00003a90: 2020 2020 2020 2020 2020 2267 6173 5072            "gasPr
+00003aa0: 6963 6522 3a20 6177 6169 7420 6173 796e  ice": await asyn
+00003ab0: 635f 7733 2e65 7468 2e67 6173 5f70 7269  c_w3.eth.gas_pri
+00003ac0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
+00003ad0: 226e 6f6e 6365 223a 204e 6f6e 6365 2830  "nonce": Nonce(0
+00003ae0: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
+00003af0: 2020 2020 2072 6573 756c 7420 3d20 6177       result = aw
+00003b00: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+00003b10: 2e73 6967 6e5f 7472 616e 7361 6374 696f  .sign_transactio
+00003b20: 6e28 7478 6e5f 7061 7261 6d73 290a 2020  n(txn_params).  
+00003b30: 2020 2020 2020 7369 676e 6174 6f72 795f        signatory_
+00003b40: 6163 636f 756e 7420 3d20 6173 796e 635f  account = async_
+00003b50: 7733 2e65 7468 2e61 6363 6f75 6e74 2e72  w3.eth.account.r
+00003b60: 6563 6f76 6572 5f74 7261 6e73 6163 7469  ecover_transacti
+00003b70: 6f6e 2872 6573 756c 745b 2272 6177 225d  on(result["raw"]
+00003b80: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00003b90: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+00003ba0: 6163 636f 756e 7420 3d3d 2073 6967 6e61  account == signa
+00003bb0: 746f 7279 5f61 6363 6f75 6e74 0a20 2020  tory_account.   
+00003bc0: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
+00003bd0: 6c74 5b22 7478 225d 5b22 746f 225d 203d  lt["tx"]["to"] =
+00003be0: 3d20 7478 6e5f 7061 7261 6d73 5b22 746f  = txn_params["to
+00003bf0: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
+00003c00: 7420 7265 7375 6c74 5b22 7478 225d 5b22  t result["tx"]["
+00003c10: 7661 6c75 6522 5d20 3d3d 2074 786e 5f70  value"] == txn_p
+00003c20: 6172 616d 735b 2276 616c 7565 225d 0a20  arams["value"]. 
+00003c30: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+00003c40: 7375 6c74 5b22 7478 225d 5b22 6761 7322  sult["tx"]["gas"
+00003c50: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
+00003c60: 2267 6173 225d 0a20 2020 2020 2020 2061  "gas"].        a
+00003c70: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
+00003c80: 225d 5b22 6761 7350 7269 6365 225d 203d  "]["gasPrice"] =
+00003c90: 3d20 7478 6e5f 7061 7261 6d73 5b22 6761  = txn_params["ga
+00003ca0: 7350 7269 6365 225d 0a20 2020 2020 2020  sPrice"].       
+00003cb0: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
+00003cc0: 7478 225d 5b22 6e6f 6e63 6522 5d20 3d3d  tx"]["nonce"] ==
+00003cd0: 2074 786e 5f70 6172 616d 735b 226e 6f6e   txn_params["non
+00003ce0: 6365 225d 0a0a 2020 2020 4070 7974 6573  ce"]..    @pytes
+00003cf0: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+00003d00: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+00003d10: 745f 6173 796e 635f 6574 685f 7369 676e  t_async_eth_sign
+00003d20: 5f74 7261 6e73 6163 7469 6f6e 5f68 6578  _transaction_hex
+00003d30: 5f66 6565 7328 0a20 2020 2020 2020 2073  _fees(.        s
+00003d40: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
+00003d50: 4173 796e 6357 6562 3322 2c20 6173 796e  AsyncWeb3", asyn
+00003d60: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
+00003d70: 6e74 3a20 4368 6563 6b73 756d 4164 6472  nt: ChecksumAddr
+00003d80: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
+00003d90: 653a 0a20 2020 2020 2020 2074 786e 5f70  e:.        txn_p
+00003da0: 6172 616d 733a 2054 7850 6172 616d 7320  arams: TxParams 
+00003db0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00003dc0: 2266 726f 6d22 3a20 6173 796e 635f 756e  "from": async_un
+00003dd0: 6c6f 636b 6564 5f61 6363 6f75 6e74 2c0a  locked_account,.
+00003de0: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+00003df0: 3a20 6173 796e 635f 756e 6c6f 636b 6564  : async_unlocked
+00003e00: 5f61 6363 6f75 6e74 2c0a 2020 2020 2020  _account,.      
+00003e10: 2020 2020 2020 2276 616c 7565 223a 2057        "value": W
+00003e20: 6569 2831 292c 0a20 2020 2020 2020 2020  ei(1),.         
+00003e30: 2020 2022 6761 7322 3a20 3231 3030 302c     "gas": 21000,
+00003e40: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
+00003e50: 7846 6565 5065 7247 6173 223a 2068 6578  xFeePerGas": hex
 00003e60: 2861 7379 6e63 5f77 332e 746f 5f77 6569  (async_w3.to_wei
-00003e70: 2831 2c20 2267 7765 6922 2929 2c0a 2020  (1, "gwei")),.  
-00003e80: 2020 2020 2020 2020 2020 226e 6f6e 6365            "nonce
-00003e90: 223a 204e 6f6e 6365 2830 292c 0a20 2020  ": Nonce(0),.   
-00003ea0: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
-00003eb0: 6573 756c 7420 3d20 6177 6169 7420 6173  esult = await as
-00003ec0: 796e 635f 7733 2e65 7468 2e73 6967 6e5f  ync_w3.eth.sign_
-00003ed0: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
-00003ee0: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-00003ef0: 7369 676e 6174 6f72 795f 6163 636f 756e  signatory_accoun
-00003f00: 7420 3d20 6173 796e 635f 7733 2e65 7468  t = async_w3.eth
-00003f10: 2e61 6363 6f75 6e74 2e72 6563 6f76 6572  .account.recover
-00003f20: 5f74 7261 6e73 6163 7469 6f6e 2872 6573  _transaction(res
-00003f30: 756c 745b 2272 6177 225d 290a 2020 2020  ult["raw"]).    
-00003f40: 2020 2020 6173 7365 7274 2061 7379 6e63      assert async
-00003f50: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
-00003f60: 7420 3d3d 2073 6967 6e61 746f 7279 5f61  t == signatory_a
-00003f70: 6363 6f75 6e74 0a20 2020 2020 2020 2061  ccount.        a
-00003f80: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
-00003f90: 225d 5b22 746f 225d 203d 3d20 7478 6e5f  "]["to"] == txn_
-00003fa0: 7061 7261 6d73 5b22 746f 225d 0a20 2020  params["to"].   
-00003fb0: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-00003fc0: 6c74 5b22 7478 225d 5b22 7661 6c75 6522  lt["tx"]["value"
-00003fd0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
-00003fe0: 2276 616c 7565 225d 0a20 2020 2020 2020  "value"].       
-00003ff0: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
-00004000: 7478 225d 5b22 6761 7322 5d20 3d3d 2074  tx"]["gas"] == t
-00004010: 786e 5f70 6172 616d 735b 2267 6173 225d  xn_params["gas"]
-00004020: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00004030: 7265 7375 6c74 5b22 7478 225d 5b22 6d61  result["tx"]["ma
-00004040: 7846 6565 5065 7247 6173 225d 203d 3d20  xFeePerGas"] == 
-00004050: 696e 7428 7374 7228 7478 6e5f 7061 7261  int(str(txn_para
-00004060: 6d73 5b22 6d61 7846 6565 5065 7247 6173  ms["maxFeePerGas
-00004070: 225d 292c 2031 3629 0a20 2020 2020 2020  "]), 16).       
-00004080: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
-00004090: 7478 225d 5b22 6d61 7850 7269 6f72 6974  tx"]["maxPriorit
-000040a0: 7946 6565 5065 7247 6173 225d 203d 3d20  yFeePerGas"] == 
-000040b0: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
-000040c0: 2073 7472 2874 786e 5f70 6172 616d 735b   str(txn_params[
-000040d0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
-000040e0: 6572 4761 7322 5d29 2c20 3136 0a20 2020  erGas"]), 16.   
-000040f0: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
-00004100: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
-00004110: 225d 5b22 6e6f 6e63 6522 5d20 3d3d 2074  "]["nonce"] == t
-00004120: 786e 5f70 6172 616d 735b 226e 6f6e 6365  xn_params["nonce
-00004130: 225d 0a0a 2020 2020 4070 7974 6573 742e  "]..    @pytest.
-00004140: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-00004150: 2040 7079 7465 7374 2e6d 6172 6b2e 7866   @pytest.mark.xf
-00004160: 6169 6c28 0a20 2020 2020 2020 2072 6561  ail(.        rea
-00004170: 736f 6e3d 2261 7379 6e63 206e 616d 655f  son="async name_
-00004180: 746f 5f61 6464 7265 7373 5f6d 6964 646c  to_address_middl
-00004190: 6577 6172 6520 6861 7320 6e6f 7420 6265  eware has not be
-000041a0: 656e 2069 6d70 6c65 6d65 6e74 6564 2079  en implemented y
-000041b0: 6574 220a 2020 2020 290a 2020 2020 6173  et".    ).    as
-000041c0: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
-000041d0: 6e63 5f65 7468 5f73 6967 6e5f 7472 616e  nc_eth_sign_tran
-000041e0: 7361 6374 696f 6e5f 656e 735f 6e61 6d65  saction_ens_name
-000041f0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-00004200: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-00004210: 6357 6562 3322 2c20 6173 796e 635f 756e  cWeb3", async_un
-00004220: 6c6f 636b 6564 5f61 6363 6f75 6e74 3a20  locked_account: 
-00004230: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
-00004240: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00004250: 2020 2020 2020 2077 6974 6820 656e 735f         with ens_
-00004260: 6164 6472 6573 7365 7328 6173 796e 635f  addresses(async_
-00004270: 7733 2c20 7b22 756e 6c6f 636b 6564 2d61  w3, {"unlocked-a
-00004280: 6363 6f75 6e74 2e65 7468 223a 2061 7379  ccount.eth": asy
-00004290: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
-000042a0: 756e 747d 293a 0a20 2020 2020 2020 2020  unt}):.         
-000042b0: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
-000042c0: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
-000042d0: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-000042e0: 6d22 3a20 2275 6e6c 6f63 6b65 642d 6163  m": "unlocked-ac
-000042f0: 636f 756e 742e 6574 6822 2c0a 2020 2020  count.eth",.    
-00004300: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
-00004310: 3a20 2275 6e6c 6f63 6b65 642d 6163 636f  : "unlocked-acco
-00004320: 756e 742e 6574 6822 2c0a 2020 2020 2020  unt.eth",.      
-00004330: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-00004340: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-00004350: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-00004360: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00004370: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
-00004380: 5065 7247 6173 223a 2061 7379 6e63 5f77  PerGas": async_w
-00004390: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
-000043a0: 6922 292c 0a20 2020 2020 2020 2020 2020  i"),.           
-000043b0: 2020 2020 2022 6d61 7850 7269 6f72 6974       "maxPriorit
-000043c0: 7946 6565 5065 7247 6173 223a 2061 7379  yFeePerGas": asy
-000043d0: 6e63 5f77 332e 746f 5f77 6569 2831 2c20  nc_w3.to_wei(1, 
-000043e0: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
-000043f0: 2020 2020 2020 2020 2022 6e6f 6e63 6522           "nonce"
-00004400: 3a20 4e6f 6e63 6528 3029 2c0a 2020 2020  : Nonce(0),.    
-00004410: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00004420: 2020 2020 2020 7265 7375 6c74 203d 2061        result = a
-00004430: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00004440: 682e 7369 676e 5f74 7261 6e73 6163 7469  h.sign_transacti
-00004450: 6f6e 2874 786e 5f70 6172 616d 7329 0a20  on(txn_params). 
-00004460: 2020 2020 2020 2020 2020 2073 6967 6e61             signa
-00004470: 746f 7279 5f61 6363 6f75 6e74 203d 2061  tory_account = a
-00004480: 7379 6e63 5f77 332e 6574 682e 6163 636f  sync_w3.eth.acco
-00004490: 756e 742e 7265 636f 7665 725f 7472 616e  unt.recover_tran
-000044a0: 7361 6374 696f 6e28 7265 7375 6c74 5b22  saction(result["
-000044b0: 7261 7722 5d29 0a20 2020 2020 2020 2020  raw"]).         
-000044c0: 2020 2061 7373 6572 7420 6173 796e 635f     assert async_
-000044d0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-000044e0: 203d 3d20 7369 676e 6174 6f72 795f 6163   == signatory_ac
-000044f0: 636f 756e 740a 2020 2020 2020 2020 2020  count.          
-00004500: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
-00004510: 2274 7822 5d5b 2274 6f22 5d20 3d3d 2061  "tx"]["to"] == a
-00004520: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
-00004530: 636f 756e 740a 2020 2020 2020 2020 2020  count.          
-00004540: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
-00004550: 2274 7822 5d5b 2276 616c 7565 225d 203d  "tx"]["value"] =
-00004560: 3d20 7478 6e5f 7061 7261 6d73 5b22 7661  = txn_params["va
-00004570: 6c75 6522 5d0a 2020 2020 2020 2020 2020  lue"].          
-00004580: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
-00004590: 2274 7822 5d5b 2267 6173 225d 203d 3d20  "tx"]["gas"] == 
-000045a0: 7478 6e5f 7061 7261 6d73 5b22 6761 7322  txn_params["gas"
-000045b0: 5d0a 2020 2020 2020 2020 2020 2020 6173  ].            as
-000045c0: 7365 7274 2072 6573 756c 745b 2274 7822  sert result["tx"
-000045d0: 5d5b 226d 6178 4665 6550 6572 4761 7322  ]["maxFeePerGas"
+00003e70: 2832 2c20 2267 7765 6922 2929 2c0a 2020  (2, "gwei")),.  
+00003e80: 2020 2020 2020 2020 2020 226d 6178 5072            "maxPr
+00003e90: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
+00003ea0: 3a20 6865 7828 6173 796e 635f 7733 2e74  : hex(async_w3.t
+00003eb0: 6f5f 7765 6928 312c 2022 6777 6569 2229  o_wei(1, "gwei")
+00003ec0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+00003ed0: 6e6f 6e63 6522 3a20 4e6f 6e63 6528 3029  nonce": Nonce(0)
+00003ee0: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+00003ef0: 2020 2020 7265 7375 6c74 203d 2061 7761      result = awa
+00003f00: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00003f10: 7369 676e 5f74 7261 6e73 6163 7469 6f6e  sign_transaction
+00003f20: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
+00003f30: 2020 2020 2073 6967 6e61 746f 7279 5f61       signatory_a
+00003f40: 6363 6f75 6e74 203d 2061 7379 6e63 5f77  ccount = async_w
+00003f50: 332e 6574 682e 6163 636f 756e 742e 7265  3.eth.account.re
+00003f60: 636f 7665 725f 7472 616e 7361 6374 696f  cover_transactio
+00003f70: 6e28 7265 7375 6c74 5b22 7261 7722 5d29  n(result["raw"])
+00003f80: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00003f90: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
+00003fa0: 6363 6f75 6e74 203d 3d20 7369 676e 6174  ccount == signat
+00003fb0: 6f72 795f 6163 636f 756e 740a 2020 2020  ory_account.    
+00003fc0: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
+00003fd0: 745b 2274 7822 5d5b 2274 6f22 5d20 3d3d  t["tx"]["to"] ==
+00003fe0: 2074 786e 5f70 6172 616d 735b 2274 6f22   txn_params["to"
+00003ff0: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+00004000: 2072 6573 756c 745b 2274 7822 5d5b 2276   result["tx"]["v
+00004010: 616c 7565 225d 203d 3d20 7478 6e5f 7061  alue"] == txn_pa
+00004020: 7261 6d73 5b22 7661 6c75 6522 5d0a 2020  rams["value"].  
+00004030: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
+00004040: 756c 745b 2274 7822 5d5b 2267 6173 225d  ult["tx"]["gas"]
+00004050: 203d 3d20 7478 6e5f 7061 7261 6d73 5b22   == txn_params["
+00004060: 6761 7322 5d0a 2020 2020 2020 2020 6173  gas"].        as
+00004070: 7365 7274 2072 6573 756c 745b 2274 7822  sert result["tx"
+00004080: 5d5b 226d 6178 4665 6550 6572 4761 7322  ]["maxFeePerGas"
+00004090: 5d20 3d3d 2069 6e74 2873 7472 2874 786e  ] == int(str(txn
+000040a0: 5f70 6172 616d 735b 226d 6178 4665 6550  _params["maxFeeP
+000040b0: 6572 4761 7322 5d29 2c20 3136 290a 2020  erGas"]), 16).  
+000040c0: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
+000040d0: 756c 745b 2274 7822 5d5b 226d 6178 5072  ult["tx"]["maxPr
+000040e0: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
+000040f0: 5d20 3d3d 2069 6e74 280a 2020 2020 2020  ] == int(.      
+00004100: 2020 2020 2020 7374 7228 7478 6e5f 7061        str(txn_pa
+00004110: 7261 6d73 5b22 6d61 7850 7269 6f72 6974  rams["maxPriorit
+00004120: 7946 6565 5065 7247 6173 225d 292c 2031  yFeePerGas"]), 1
+00004130: 360a 2020 2020 2020 2020 290a 2020 2020  6.        ).    
+00004140: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
+00004150: 745b 2274 7822 5d5b 226e 6f6e 6365 225d  t["tx"]["nonce"]
+00004160: 203d 3d20 7478 6e5f 7061 7261 6d73 5b22   == txn_params["
+00004170: 6e6f 6e63 6522 5d0a 0a20 2020 2040 7079  nonce"]..    @py
+00004180: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+00004190: 6f0a 2020 2020 4070 7974 6573 742e 6d61  o.    @pytest.ma
+000041a0: 726b 2e78 6661 696c 280a 2020 2020 2020  rk.xfail(.      
+000041b0: 2020 7265 6173 6f6e 3d22 6173 796e 6320    reason="async 
+000041c0: 6e61 6d65 5f74 6f5f 6164 6472 6573 735f  name_to_address_
+000041d0: 6d69 6464 6c65 7761 7265 2068 6173 206e  middleware has n
+000041e0: 6f74 2062 6565 6e20 696d 706c 656d 656e  ot been implemen
+000041f0: 7465 6420 7965 7422 0a20 2020 2029 0a20  ted yet".    ). 
+00004200: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+00004210: 745f 6173 796e 635f 6574 685f 7369 676e  t_async_eth_sign
+00004220: 5f74 7261 6e73 6163 7469 6f6e 5f65 6e73  _transaction_ens
+00004230: 5f6e 616d 6573 280a 2020 2020 2020 2020  _names(.        
+00004240: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+00004250: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
+00004260: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+00004270: 756e 743a 2043 6865 636b 7375 6d41 6464  unt: ChecksumAdd
+00004280: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
+00004290: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
+000042a0: 2065 6e73 5f61 6464 7265 7373 6573 2861   ens_addresses(a
+000042b0: 7379 6e63 5f77 332c 207b 2275 6e6c 6f63  sync_w3, {"unloc
+000042c0: 6b65 642d 6163 636f 756e 742e 6574 6822  ked-account.eth"
+000042d0: 3a20 6173 796e 635f 756e 6c6f 636b 6564  : async_unlocked
+000042e0: 5f61 6363 6f75 6e74 7d29 3a0a 2020 2020  _account}):.    
+000042f0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+00004300: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+00004310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004320: 2022 6672 6f6d 223a 2022 756e 6c6f 636b   "from": "unlock
+00004330: 6564 2d61 6363 6f75 6e74 2e65 7468 222c  ed-account.eth",
+00004340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004350: 2022 746f 223a 2022 756e 6c6f 636b 6564   "to": "unlocked
+00004360: 2d61 6363 6f75 6e74 2e65 7468 222c 0a20  -account.eth",. 
+00004370: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00004380: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
+00004390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000043a0: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
+000043b0: 2020 2020 2020 2020 2020 2020 2020 226d                "m
+000043c0: 6178 4665 6550 6572 4761 7322 3a20 6173  axFeePerGas": as
+000043d0: 796e 635f 7733 2e74 6f5f 7765 6928 322c  ync_w3.to_wei(2,
+000043e0: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
+000043f0: 2020 2020 2020 2020 2020 226d 6178 5072            "maxPr
+00004400: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
+00004410: 3a20 6173 796e 635f 7733 2e74 6f5f 7765  : async_w3.to_we
+00004420: 6928 312c 2022 6777 6569 2229 2c0a 2020  i(1, "gwei"),.  
+00004430: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+00004440: 6f6e 6365 223a 204e 6f6e 6365 2830 292c  once": Nonce(0),
+00004450: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
+00004460: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00004470: 7420 3d20 6177 6169 7420 6173 796e 635f  t = await async_
+00004480: 7733 2e65 7468 2e73 6967 6e5f 7472 616e  w3.eth.sign_tran
+00004490: 7361 6374 696f 6e28 7478 6e5f 7061 7261  saction(txn_para
+000044a0: 6d73 290a 2020 2020 2020 2020 2020 2020  ms).            
+000044b0: 7369 676e 6174 6f72 795f 6163 636f 756e  signatory_accoun
+000044c0: 7420 3d20 6173 796e 635f 7733 2e65 7468  t = async_w3.eth
+000044d0: 2e61 6363 6f75 6e74 2e72 6563 6f76 6572  .account.recover
+000044e0: 5f74 7261 6e73 6163 7469 6f6e 2872 6573  _transaction(res
+000044f0: 756c 745b 2272 6177 225d 290a 2020 2020  ult["raw"]).    
+00004500: 2020 2020 2020 2020 6173 7365 7274 2061          assert a
+00004510: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+00004520: 636f 756e 7420 3d3d 2073 6967 6e61 746f  count == signato
+00004530: 7279 5f61 6363 6f75 6e74 0a20 2020 2020  ry_account.     
+00004540: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+00004550: 7375 6c74 5b22 7478 225d 5b22 746f 225d  sult["tx"]["to"]
+00004560: 203d 3d20 6173 796e 635f 756e 6c6f 636b   == async_unlock
+00004570: 6564 5f61 6363 6f75 6e74 0a20 2020 2020  ed_account.     
+00004580: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+00004590: 7375 6c74 5b22 7478 225d 5b22 7661 6c75  sult["tx"]["valu
+000045a0: 6522 5d20 3d3d 2074 786e 5f70 6172 616d  e"] == txn_param
+000045b0: 735b 2276 616c 7565 225d 0a20 2020 2020  s["value"].     
+000045c0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+000045d0: 7375 6c74 5b22 7478 225d 5b22 6761 7322  sult["tx"]["gas"
 000045e0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
-000045f0: 226d 6178 4665 6550 6572 4761 7322 5d0a  "maxFeePerGas"].
-00004600: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00004610: 7274 2028 0a20 2020 2020 2020 2020 2020  rt (.           
-00004620: 2020 2020 2072 6573 756c 745b 2274 7822       result["tx"
-00004630: 5d5b 226d 6178 5072 696f 7269 7479 4665  ]["maxPriorityFe
-00004640: 6550 6572 4761 7322 5d0a 2020 2020 2020  ePerGas"].      
-00004650: 2020 2020 2020 2020 2020 3d3d 2074 786e            == txn
-00004660: 5f70 6172 616d 735b 226d 6178 5072 696f  _params["maxPrio
-00004670: 7269 7479 4665 6550 6572 4761 7322 5d0a  rityFeePerGas"].
-00004680: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00004690: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-000046a0: 2072 6573 756c 745b 2274 7822 5d5b 226e   result["tx"]["n
-000046b0: 6f6e 6365 225d 203d 3d20 7478 6e5f 7061  once"] == txn_pa
-000046c0: 7261 6d73 5b22 6e6f 6e63 6522 5d0a 0a20  rams["nonce"].. 
-000046d0: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-000046e0: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-000046f0: 6320 6465 6620 7465 7374 5f65 7468 5f73  c def test_eth_s
-00004700: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
-00004710: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
-00004720: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-00004730: 6562 3322 2c20 6173 796e 635f 756e 6c6f  eb3", async_unlo
-00004740: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-00004750: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-00004760: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-00004770: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
-00004780: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
-00004790: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-000047a0: 2020 2020 2266 726f 6d22 3a20 6173 796e      "from": asyn
-000047b0: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
-000047c0: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
-000047d0: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
-000047e0: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
-000047f0: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-00004800: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-00004810: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-00004820: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-00004830: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00004840: 2020 2020 2022 6d61 7846 6565 5065 7247       "maxFeePerG
-00004850: 6173 223a 2061 7379 6e63 5f77 332e 746f  as": async_w3.to
-00004860: 5f77 6569 2833 2c20 2267 7765 6922 292c  _wei(3, "gwei"),
-00004870: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
-00004880: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-00004890: 6173 223a 2061 7379 6e63 5f77 332e 746f  as": async_w3.to
-000048a0: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
-000048b0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-000048c0: 2020 2074 786e 5f68 6173 6820 3d20 6177     txn_hash = aw
-000048d0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-000048e0: 2e73 656e 645f 7472 616e 7361 6374 696f  .send_transactio
-000048f0: 6e28 7478 6e5f 7061 7261 6d73 290a 2020  n(txn_params).  
-00004900: 2020 2020 2020 7478 6e20 3d20 6177 6169        txn = awai
-00004910: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
-00004920: 6574 5f74 7261 6e73 6163 7469 6f6e 2874  et_transaction(t
-00004930: 786e 5f68 6173 6829 0a0a 2020 2020 2020  xn_hash)..      
-00004940: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
-00004950: 5f61 6464 7265 7373 2874 786e 5b22 6672  _address(txn["fr
-00004960: 6f6d 225d 2c20 6361 7374 2843 6865 636b  om"], cast(Check
-00004970: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
-00004980: 7061 7261 6d73 5b22 6672 6f6d 225d 2929  params["from"]))
-00004990: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000049a0: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
-000049b0: 7478 6e5b 2274 6f22 5d2c 2063 6173 7428  txn["to"], cast(
-000049c0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-000049d0: 2074 786e 5f70 6172 616d 735b 2274 6f22   txn_params["to"
-000049e0: 5d29 290a 2020 2020 2020 2020 6173 7365  ])).        asse
-000049f0: 7274 2074 786e 5b22 7661 6c75 6522 5d20  rt txn["value"] 
-00004a00: 3d3d 2031 0a20 2020 2020 2020 2061 7373  == 1.        ass
-00004a10: 6572 7420 7478 6e5b 2267 6173 225d 203d  ert txn["gas"] =
-00004a20: 3d20 3231 3030 300a 2020 2020 2020 2020  = 21000.        
-00004a30: 6173 7365 7274 2074 786e 5b22 6d61 7846  assert txn["maxF
-00004a40: 6565 5065 7247 6173 225d 203d 3d20 7478  eePerGas"] == tx
-00004a50: 6e5f 7061 7261 6d73 5b22 6d61 7846 6565  n_params["maxFee
-00004a60: 5065 7247 6173 225d 0a20 2020 2020 2020  PerGas"].       
-00004a70: 2061 7373 6572 7420 7478 6e5b 226d 6178   assert txn["max
-00004a80: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
-00004a90: 7322 5d20 3d3d 2074 786e 5f70 6172 616d  s"] == txn_param
-00004aa0: 735b 226d 6178 5072 696f 7269 7479 4665  s["maxPriorityFe
-00004ab0: 6550 6572 4761 7322 5d0a 2020 2020 2020  ePerGas"].      
-00004ac0: 2020 6173 7365 7274 2074 786e 5b22 6761    assert txn["ga
-00004ad0: 7350 7269 6365 225d 203d 3d20 7478 6e5f  sPrice"] == txn_
-00004ae0: 7061 7261 6d73 5b22 6d61 7846 6565 5065  params["maxFeePe
-00004af0: 7247 6173 225d 0a0a 2020 2020 4070 7974  rGas"]..    @pyt
-00004b00: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00004b10: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-00004b20: 6573 745f 6574 685f 7365 6e64 5f74 7261  est_eth_send_tra
-00004b30: 6e73 6163 7469 6f6e 5f64 6566 6175 6c74  nsaction_default
-00004b40: 5f66 6565 7328 0a20 2020 2020 2020 2073  _fees(.        s
-00004b50: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
-00004b60: 4173 796e 6357 6562 3322 2c20 6173 796e  AsyncWeb3", asyn
-00004b70: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
-00004b80: 6e74 5f64 7561 6c5f 7479 7065 3a20 4368  nt_dual_type: Ch
-00004b90: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
-00004ba0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00004bb0: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-00004bc0: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-00004bd0: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-00004be0: 3a20 6173 796e 635f 756e 6c6f 636b 6564  : async_unlocked
-00004bf0: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
-00004c00: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00004c10: 2274 6f22 3a20 6173 796e 635f 756e 6c6f  "to": async_unlo
-00004c20: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-00004c30: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-00004c40: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
-00004c50: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
-00004c60: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
-00004c70: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00004c80: 2074 786e 5f68 6173 6820 3d20 6177 6169   txn_hash = awai
-00004c90: 7420 6173 796e 635f 7733 2e65 7468 2e73  t async_w3.eth.s
-00004ca0: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
-00004cb0: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
-00004cc0: 2020 2020 7478 6e20 3d20 6177 6169 7420      txn = await 
-00004cd0: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
-00004ce0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00004cf0: 5f68 6173 6829 0a0a 2020 2020 2020 2020  _hash)..        
-00004d00: 6173 7365 7274 2069 735f 7361 6d65 5f61  assert is_same_a
-00004d10: 6464 7265 7373 2874 786e 5b22 6672 6f6d  ddress(txn["from
-00004d20: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
-00004d30: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
-00004d40: 7261 6d73 5b22 6672 6f6d 225d 2929 0a20  rams["from"])). 
-00004d50: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00004d60: 5f73 616d 655f 6164 6472 6573 7328 7478  _same_address(tx
-00004d70: 6e5b 2274 6f22 5d2c 2063 6173 7428 4368  n["to"], cast(Ch
-00004d80: 6563 6b73 756d 4164 6472 6573 732c 2074  ecksumAddress, t
-00004d90: 786e 5f70 6172 616d 735b 2274 6f22 5d29  xn_params["to"])
-00004da0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00004db0: 2074 786e 5b22 7661 6c75 6522 5d20 3d3d   txn["value"] ==
-00004dc0: 2031 0a20 2020 2020 2020 2061 7373 6572   1.        asser
-00004dd0: 7420 7478 6e5b 2267 6173 225d 203d 3d20  t txn["gas"] == 
-00004de0: 3231 3030 300a 2020 2020 2020 2020 6173  21000.        as
-00004df0: 7365 7274 2069 735f 696e 7465 6765 7228  sert is_integer(
-00004e00: 7478 6e5b 226d 6178 5072 696f 7269 7479  txn["maxPriority
-00004e10: 4665 6550 6572 4761 7322 5d29 0a20 2020  FeePerGas"]).   
-00004e20: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
-00004e30: 6e74 6567 6572 2874 786e 5b22 6d61 7846  nteger(txn["maxF
-00004e40: 6565 5065 7247 6173 225d 290a 2020 2020  eePerGas"]).    
-00004e50: 2020 2020 6173 7365 7274 2074 786e 5b22      assert txn["
-00004e60: 6761 7350 7269 6365 225d 203d 3d20 7478  gasPrice"] == tx
-00004e70: 6e5b 226d 6178 4665 6550 6572 4761 7322  n["maxFeePerGas"
-00004e80: 5d0a 0a20 2020 2040 7079 7465 7374 2e6d  ]..    @pytest.m
-00004e90: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-00004ea0: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-00004eb0: 7468 5f73 656e 645f 7472 616e 7361 6374  th_send_transact
-00004ec0: 696f 6e5f 6865 785f 6665 6573 280a 2020  ion_hex_fees(.  
-00004ed0: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
-00004ee0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-00004ef0: 222c 2061 7379 6e63 5f75 6e6c 6f63 6b65  ", async_unlocke
-00004f00: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-00004f10: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-00004f20: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-00004f30: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-00004f40: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-00004f50: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00004f60: 2022 6672 6f6d 223a 2061 7379 6e63 5f75   "from": async_u
-00004f70: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
-00004f80: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
-00004f90: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
-00004fa0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
-00004fb0: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
-00004fc0: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
-00004fd0: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
-00004fe0: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
-00004ff0: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
-00005000: 2020 226d 6178 4665 6550 6572 4761 7322    "maxFeePerGas"
-00005010: 3a20 6865 7828 3235 3020 2a20 3130 2a2a  : hex(250 * 10**
-00005020: 3929 2c0a 2020 2020 2020 2020 2020 2020  9),.            
-00005030: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
-00005040: 6572 4761 7322 3a20 6865 7828 3220 2a20  erGas": hex(2 * 
-00005050: 3130 2a2a 3929 2c0a 2020 2020 2020 2020  10**9),.        
-00005060: 7d0a 2020 2020 2020 2020 7478 6e5f 6861  }.        txn_ha
-00005070: 7368 203d 2061 7761 6974 2061 7379 6e63  sh = await async
-00005080: 5f77 332e 6574 682e 7365 6e64 5f74 7261  _w3.eth.send_tra
-00005090: 6e73 6163 7469 6f6e 2874 786e 5f70 6172  nsaction(txn_par
-000050a0: 616d 7329 0a20 2020 2020 2020 2074 786e  ams).        txn
-000050b0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-000050c0: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
-000050d0: 6374 696f 6e28 7478 6e5f 6861 7368 290a  ction(txn_hash).
-000050e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000050f0: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
-00005100: 7478 6e5b 2266 726f 6d22 5d2c 2063 6173  txn["from"], cas
-00005110: 7428 4368 6563 6b73 756d 4164 6472 6573  t(ChecksumAddres
-00005120: 732c 2074 786e 5f70 6172 616d 735b 2266  s, txn_params["f
-00005130: 726f 6d22 5d29 290a 2020 2020 2020 2020  rom"])).        
-00005140: 6173 7365 7274 2069 735f 7361 6d65 5f61  assert is_same_a
-00005150: 6464 7265 7373 2874 786e 5b22 746f 225d  ddress(txn["to"]
-00005160: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
-00005170: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
-00005180: 6d73 5b22 746f 225d 2929 0a20 2020 2020  ms["to"])).     
-00005190: 2020 2061 7373 6572 7420 7478 6e5b 2276     assert txn["v
-000051a0: 616c 7565 225d 203d 3d20 310a 2020 2020  alue"] == 1.    
-000051b0: 2020 2020 6173 7365 7274 2074 786e 5b22      assert txn["
-000051c0: 6761 7322 5d20 3d3d 2032 3130 3030 0a20  gas"] == 21000. 
-000051d0: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
-000051e0: 6e5b 226d 6178 4665 6550 6572 4761 7322  n["maxFeePerGas"
-000051f0: 5d20 3d3d 2032 3530 202a 2031 302a 2a39  ] == 250 * 10**9
-00005200: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00005210: 7478 6e5b 226d 6178 5072 696f 7269 7479  txn["maxPriority
-00005220: 4665 6550 6572 4761 7322 5d20 3d3d 2032  FeePerGas"] == 2
-00005230: 202a 2031 302a 2a39 0a0a 2020 2020 4070   * 10**9..    @p
-00005240: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-00005250: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-00005260: 2074 6573 745f 6574 685f 7365 6e64 5f74   test_eth_send_t
-00005270: 7261 6e73 6163 7469 6f6e 5f6e 6f5f 6761  ransaction_no_ga
-00005280: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-00005290: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-000052a0: 6357 6562 3322 2c20 6173 796e 635f 756e  cWeb3", async_un
-000052b0: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-000052c0: 7561 6c5f 7479 7065 3a20 4368 6563 6b73  ual_type: Checks
-000052d0: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
-000052e0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-000052f0: 2074 786e 5f70 6172 616d 733a 2054 7850   txn_params: TxP
-00005300: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-00005310: 2020 2020 2020 2266 726f 6d22 3a20 6173        "from": as
-00005320: 796e 635f 756e 6c6f 636b 6564 5f61 6363  ync_unlocked_acc
-00005330: 6f75 6e74 5f64 7561 6c5f 7479 7065 2c0a  ount_dual_type,.
-00005340: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
-00005350: 3a20 6173 796e 635f 756e 6c6f 636b 6564  : async_unlocked
-00005360: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
-00005370: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00005380: 2276 616c 7565 223a 2057 6569 2831 292c  "value": Wei(1),
-00005390: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
-000053a0: 7846 6565 5065 7247 6173 223a 2057 6569  xFeePerGas": Wei
-000053b0: 2832 3530 202a 2031 302a 2a39 292c 0a20  (250 * 10**9),. 
-000053c0: 2020 2020 2020 2020 2020 2022 6d61 7850             "maxP
-000053d0: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
-000053e0: 223a 2057 6569 2832 202a 2031 302a 2a39  ": Wei(2 * 10**9
-000053f0: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
-00005400: 2020 2020 2074 786e 5f68 6173 6820 3d20       txn_hash = 
-00005410: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
-00005420: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
-00005430: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
-00005440: 2020 2020 2020 2020 7478 6e20 3d20 6177          txn = aw
-00005450: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00005460: 2e67 6574 5f74 7261 6e73 6163 7469 6f6e  .get_transaction
-00005470: 2874 786e 5f68 6173 6829 0a0a 2020 2020  (txn_hash)..    
-00005480: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
-00005490: 6d65 5f61 6464 7265 7373 2874 786e 5b22  me_address(txn["
-000054a0: 6672 6f6d 225d 2c20 6361 7374 2843 6865  from"], cast(Che
-000054b0: 636b 7375 6d41 6464 7265 7373 2c20 7478  cksumAddress, tx
-000054c0: 6e5f 7061 7261 6d73 5b22 6672 6f6d 225d  n_params["from"]
-000054d0: 2929 0a20 2020 2020 2020 2061 7373 6572  )).        asser
-000054e0: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
-000054f0: 7328 7478 6e5b 2274 6f22 5d2c 2063 6173  s(txn["to"], cas
-00005500: 7428 4368 6563 6b73 756d 4164 6472 6573  t(ChecksumAddres
-00005510: 732c 2074 786e 5f70 6172 616d 735b 2274  s, txn_params["t
-00005520: 6f22 5d29 290a 2020 2020 2020 2020 6173  o"])).        as
-00005530: 7365 7274 2074 786e 5b22 7661 6c75 6522  sert txn["value"
-00005540: 5d20 3d3d 2031 0a20 2020 2020 2020 2061  ] == 1.        a
-00005550: 7373 6572 7420 7478 6e5b 2267 6173 225d  ssert txn["gas"]
-00005560: 203d 3d20 3132 3130 3030 2020 2320 3231   == 121000  # 21
-00005570: 3030 3020 2b20 6275 6666 6572 0a0a 2020  000 + buffer..  
-00005580: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-00005590: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-000055a0: 2064 6566 2074 6573 745f 6574 685f 7365   def test_eth_se
-000055b0: 6e64 5f74 7261 6e73 6163 7469 6f6e 5f77  nd_transaction_w
-000055c0: 6974 685f 6761 735f 7072 6963 6528 0a20  ith_gas_price(. 
-000055d0: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
-000055e0: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-000055f0: 3322 2c20 6173 796e 635f 756e 6c6f 636b  3", async_unlock
-00005600: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
-00005610: 7479 7065 3a20 4368 6563 6b73 756d 4164  type: ChecksumAd
-00005620: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
-00005630: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
-00005640: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-00005650: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00005660: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
-00005670: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00005680: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-00005690: 2020 2020 2020 2020 2274 6f22 3a20 6173          "to": as
-000056a0: 796e 635f 756e 6c6f 636b 6564 5f61 6363  ync_unlocked_acc
-000056b0: 6f75 6e74 5f64 7561 6c5f 7479 7065 2c0a  ount_dual_type,.
-000056c0: 2020 2020 2020 2020 2020 2020 2276 616c              "val
-000056d0: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
-000056e0: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
-000056f0: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
-00005700: 2020 2022 6761 7350 7269 6365 223a 2057     "gasPrice": W
-00005710: 6569 2831 292c 0a20 2020 2020 2020 2020  ei(1),.         
-00005720: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
-00005730: 223a 2057 6569 2832 3530 202a 2031 302a  ": Wei(250 * 10*
-00005740: 2a39 292c 0a20 2020 2020 2020 2020 2020  *9),.           
-00005750: 2022 6d61 7850 7269 6f72 6974 7946 6565   "maxPriorityFee
-00005760: 5065 7247 6173 223a 2057 6569 2832 202a  PerGas": Wei(2 *
-00005770: 2031 302a 2a39 292c 0a20 2020 2020 2020   10**9),.       
-00005780: 207d 0a20 2020 2020 2020 2077 6974 6820   }.        with 
-00005790: 7079 7465 7374 2e72 6169 7365 7328 5472  pytest.raises(Tr
-000057a0: 616e 7361 6374 696f 6e54 7970 654d 6973  ansactionTypeMis
-000057b0: 6d61 7463 6829 3a0a 2020 2020 2020 2020  match):.        
-000057c0: 2020 2020 6177 6169 7420 6173 796e 635f      await async_
-000057d0: 7733 2e65 7468 2e73 656e 645f 7472 616e  w3.eth.send_tran
-000057e0: 7361 6374 696f 6e28 7478 6e5f 7061 7261  saction(txn_para
-000057f0: 6d73 290a 0a20 2020 2040 7079 7465 7374  ms)..    @pytest
-00005800: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-00005810: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-00005820: 5f65 7468 5f73 656e 645f 7472 616e 7361  _eth_send_transa
-00005830: 6374 696f 6e5f 6e6f 5f70 7269 6f72 6974  ction_no_priorit
-00005840: 795f 6665 6528 0a20 2020 2020 2020 2073  y_fee(.        s
-00005850: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
-00005860: 4173 796e 6357 6562 3322 2c20 6173 796e  AsyncWeb3", asyn
-00005870: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
-00005880: 6e74 5f64 7561 6c5f 7479 7065 3a20 4368  nt_dual_type: Ch
-00005890: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
-000058a0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-000058b0: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-000058c0: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-000058d0: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-000058e0: 3a20 6173 796e 635f 756e 6c6f 636b 6564  : async_unlocked
-000058f0: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
-00005900: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00005910: 2274 6f22 3a20 6173 796e 635f 756e 6c6f  "to": async_unlo
-00005920: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-00005930: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-00005940: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
-00005950: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
-00005960: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
-00005970: 2020 2020 2020 2020 2020 2022 6d61 7846             "maxF
-00005980: 6565 5065 7247 6173 223a 2057 6569 2832  eePerGas": Wei(2
-00005990: 3530 202a 2031 302a 2a39 292c 0a20 2020  50 * 10**9),.   
-000059a0: 2020 2020 207d 0a20 2020 2020 2020 2077       }.        w
-000059b0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-000059c0: 7328 0a20 2020 2020 2020 2020 2020 2049  s(.            I
-000059d0: 6e76 616c 6964 5472 616e 7361 6374 696f  nvalidTransactio
-000059e0: 6e2c 206d 6174 6368 3d22 6d61 7850 7269  n, match="maxPri
-000059f0: 6f72 6974 7946 6565 5065 7247 6173 206d  orityFeePerGas m
-00005a00: 7573 7420 6265 2064 6566 696e 6564 220a  ust be defined".
-00005a10: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-00005a20: 2020 2020 2020 2061 7761 6974 2061 7379         await asy
-00005a30: 6e63 5f77 332e 6574 682e 7365 6e64 5f74  nc_w3.eth.send_t
-00005a40: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
-00005a50: 6172 616d 7329 0a0a 2020 2020 4070 7974  arams)..    @pyt
-00005a60: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00005a70: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-00005a80: 6573 745f 6574 685f 7365 6e64 5f74 7261  est_eth_send_tra
-00005a90: 6e73 6163 7469 6f6e 5f6e 6f5f 6d61 785f  nsaction_no_max_
-00005aa0: 6665 6528 0a20 2020 2020 2020 2073 656c  fee(.        sel
-00005ab0: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-00005ac0: 796e 6357 6562 3322 2c20 6173 796e 635f  yncWeb3", async_
-00005ad0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00005ae0: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
-00005af0: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
-00005b00: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00005b10: 2020 206d 6178 5072 696f 7269 7479 4665     maxPriorityFe
-00005b20: 6550 6572 4761 7320 3d20 6173 796e 635f  ePerGas = async_
-00005b30: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
-00005b40: 6569 2229 0a20 2020 2020 2020 2074 786e  ei").        txn
-00005b50: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-00005b60: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00005b70: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
-00005b80: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00005b90: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-00005ba0: 2020 2020 2020 2020 2274 6f22 3a20 6173          "to": as
-00005bb0: 796e 635f 756e 6c6f 636b 6564 5f61 6363  ync_unlocked_acc
-00005bc0: 6f75 6e74 5f64 7561 6c5f 7479 7065 2c0a  ount_dual_type,.
-00005bd0: 2020 2020 2020 2020 2020 2020 2276 616c              "val
-00005be0: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
-00005bf0: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
-00005c00: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
-00005c10: 2020 2022 6d61 7850 7269 6f72 6974 7946     "maxPriorityF
-00005c20: 6565 5065 7247 6173 223a 206d 6178 5072  eePerGas": maxPr
-00005c30: 696f 7269 7479 4665 6550 6572 4761 732c  iorityFeePerGas,
-00005c40: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00005c50: 2020 2074 786e 5f68 6173 6820 3d20 6177     txn_hash = aw
-00005c60: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00005c70: 2e73 656e 645f 7472 616e 7361 6374 696f  .send_transactio
-00005c80: 6e28 7478 6e5f 7061 7261 6d73 290a 2020  n(txn_params).  
-00005c90: 2020 2020 2020 7478 6e20 3d20 6177 6169        txn = awai
-00005ca0: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
-00005cb0: 6574 5f74 7261 6e73 6163 7469 6f6e 2874  et_transaction(t
-00005cc0: 786e 5f68 6173 6829 0a0a 2020 2020 2020  xn_hash)..      
-00005cd0: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
-00005ce0: 5f61 6464 7265 7373 2874 786e 5b22 6672  _address(txn["fr
-00005cf0: 6f6d 225d 2c20 6361 7374 2843 6865 636b  om"], cast(Check
-00005d00: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
-00005d10: 7061 7261 6d73 5b22 6672 6f6d 225d 2929  params["from"]))
-00005d20: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00005d30: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
-00005d40: 7478 6e5b 2274 6f22 5d2c 2063 6173 7428  txn["to"], cast(
-00005d50: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-00005d60: 2074 786e 5f70 6172 616d 735b 2274 6f22   txn_params["to"
-00005d70: 5d29 290a 2020 2020 2020 2020 6173 7365  ])).        asse
-00005d80: 7274 2074 786e 5b22 7661 6c75 6522 5d20  rt txn["value"] 
-00005d90: 3d3d 2031 0a20 2020 2020 2020 2061 7373  == 1.        ass
-00005da0: 6572 7420 7478 6e5b 2267 6173 225d 203d  ert txn["gas"] =
-00005db0: 3d20 3231 3030 300a 0a20 2020 2020 2020  = 21000..       
-00005dc0: 2062 6c6f 636b 203d 2061 7761 6974 2061   block = await a
-00005dd0: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
-00005de0: 626c 6f63 6b28 226c 6174 6573 7422 290a  block("latest").
-00005df0: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-00005e00: 786e 5b22 6d61 7846 6565 5065 7247 6173  xn["maxFeePerGas
-00005e10: 225d 203d 3d20 6d61 7850 7269 6f72 6974  "] == maxPriorit
-00005e20: 7946 6565 5065 7247 6173 202b 2032 202a  yFeePerGas + 2 *
-00005e30: 2062 6c6f 636b 5b22 6261 7365 4665 6550   block["baseFeeP
-00005e40: 6572 4761 7322 5d0a 0a20 2020 2040 7079  erGas"]..    @py
-00005e50: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-00005e60: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
-00005e70: 7465 7374 5f65 7468 5f73 656e 645f 7472  test_eth_send_tr
-00005e80: 616e 7361 6374 696f 6e5f 6d61 785f 6665  ansaction_max_fe
-00005e90: 655f 6c65 7373 5f74 6861 6e5f 7469 7028  e_less_than_tip(
-00005ea0: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
-00005eb0: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-00005ec0: 6562 3322 2c20 6173 796e 635f 756e 6c6f  eb3", async_unlo
-00005ed0: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-00005ee0: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-00005ef0: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-00005f00: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
-00005f10: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
-00005f20: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-00005f30: 2020 2020 2266 726f 6d22 3a20 6173 796e      "from": asyn
-00005f40: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
-00005f50: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
-00005f60: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
-00005f70: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
-00005f80: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-00005f90: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-00005fa0: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-00005fb0: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-00005fc0: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00005fd0: 2020 2020 2022 6d61 7846 6565 5065 7247       "maxFeePerG
-00005fe0: 6173 223a 2057 6569 2831 202a 2031 302a  as": Wei(1 * 10*
-00005ff0: 2a39 292c 0a20 2020 2020 2020 2020 2020  *9),.           
-00006000: 2022 6d61 7850 7269 6f72 6974 7946 6565   "maxPriorityFee
-00006010: 5065 7247 6173 223a 2057 6569 2832 202a  PerGas": Wei(2 *
-00006020: 2031 302a 2a39 292c 0a20 2020 2020 2020   10**9),.       
-00006030: 207d 0a20 2020 2020 2020 2077 6974 6820   }.        with 
-00006040: 7079 7465 7374 2e72 6169 7365 7328 0a20  pytest.raises(. 
-00006050: 2020 2020 2020 2020 2020 2049 6e76 616c             Inval
-00006060: 6964 5472 616e 7361 6374 696f 6e2c 206d  idTransaction, m
-00006070: 6174 6368 3d22 6d61 7846 6565 5065 7247  atch="maxFeePerG
-00006080: 6173 206d 7573 7420 6265 203e 3d20 6d61  as must be >= ma
-00006090: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-000060a0: 6173 220a 2020 2020 2020 2020 293a 0a20  as".        ):. 
-000060b0: 2020 2020 2020 2020 2020 2061 7761 6974             await
-000060c0: 2061 7379 6e63 5f77 332e 6574 682e 7365   async_w3.eth.se
-000060d0: 6e64 5f74 7261 6e73 6163 7469 6f6e 2874  nd_transaction(t
-000060e0: 786e 5f70 6172 616d 7329 0a0a 2020 2020  xn_params)..    
-000060f0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-00006100: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-00006110: 6566 2074 6573 745f 7661 6c69 6461 7469  ef test_validati
-00006120: 6f6e 5f6d 6964 646c 6577 6172 655f 6368  on_middleware_ch
-00006130: 6169 6e5f 6964 5f6d 6973 6d61 7463 6828  ain_id_mismatch(
-00006140: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
-00006150: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-00006160: 6562 3322 2c20 6173 796e 635f 756e 6c6f  eb3", async_unlo
-00006170: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-00006180: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-00006190: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-000061a0: 204e 6f6e 653a 0a20 2020 2020 2020 2077   None:.        w
-000061b0: 726f 6e67 5f63 6861 696e 5f69 6420 3d20  rong_chain_id = 
-000061c0: 3132 3334 3536 3738 3930 0a20 2020 2020  1234567890.     
-000061d0: 2020 2061 6374 7561 6c5f 6368 6169 6e5f     actual_chain_
-000061e0: 6964 203d 2061 7761 6974 2061 7379 6e63  id = await async
-000061f0: 5f77 332e 6574 682e 6368 6169 6e5f 6964  _w3.eth.chain_id
-00006200: 0a0a 2020 2020 2020 2020 7478 6e5f 7061  ..        txn_pa
-00006210: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
-00006220: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-00006230: 6672 6f6d 223a 2061 7379 6e63 5f75 6e6c  from": async_unl
-00006240: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
-00006250: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
-00006260: 2020 2020 2022 746f 223a 2061 7379 6e63       "to": async
-00006270: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
-00006280: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
-00006290: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
-000062a0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-000062b0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
-000062c0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-000062d0: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
-000062e0: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-000062f0: 322c 2022 6777 6569 2229 2c0a 2020 2020  2, "gwei"),.    
-00006300: 2020 2020 2020 2020 226d 6178 5072 696f          "maxPrio
-00006310: 7269 7479 4665 6550 6572 4761 7322 3a20  rityFeePerGas": 
-00006320: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-00006330: 312c 2022 6777 6569 2229 2c0a 2020 2020  1, "gwei"),.    
-00006340: 2020 2020 2020 2020 2263 6861 696e 4964          "chainId
-00006350: 223a 2077 726f 6e67 5f63 6861 696e 5f69  ": wrong_chain_i
-00006360: 642c 0a20 2020 2020 2020 207d 0a20 2020  d,.        }.   
-00006370: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-00006380: 2e72 6169 7365 7328 0a20 2020 2020 2020  .raises(.       
-00006390: 2020 2020 2057 6562 3356 616c 6964 6174       Web3Validat
-000063a0: 696f 6e45 7272 6f72 2c0a 2020 2020 2020  ionError,.      
-000063b0: 2020 2020 2020 6d61 7463 683d 6622 5468        match=f"Th
-000063c0: 6520 7472 616e 7361 6374 696f 6e20 6465  e transaction de
-000063d0: 636c 6172 6564 2063 6861 696e 2049 4420  clared chain ID 
-000063e0: 7b77 726f 6e67 5f63 6861 696e 5f69 647d  {wrong_chain_id}
-000063f0: 2c20 220a 2020 2020 2020 2020 2020 2020  , ".            
-00006400: 6622 6275 7420 7468 6520 636f 6e6e 6563  f"but the connec
-00006410: 7465 6420 6e6f 6465 2069 7320 6f6e 207b  ted node is on {
-00006420: 6163 7475 616c 5f63 6861 696e 5f69 647d  actual_chain_id}
-00006430: 222c 0a20 2020 2020 2020 2029 3a0a 2020  ",.        ):.  
-00006440: 2020 2020 2020 2020 2020 6177 6169 7420            await 
-00006450: 6173 796e 635f 7733 2e65 7468 2e73 656e  async_w3.eth.sen
-00006460: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
-00006470: 6e5f 7061 7261 6d73 290a 0a20 2020 2040  n_params)..    @
-00006480: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-00006490: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-000064a0: 6620 7465 7374 5f45 7874 7261 4461 7461  f test_ExtraData
-000064b0: 546f 504f 414d 6964 646c 6577 6172 6528  ToPOAMiddleware(
-000064c0: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
-000064d0: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-000064e0: 6562 3322 2c20 7265 7175 6573 745f 6d6f  eb3", request_mo
-000064f0: 636b 6572 3a20 5479 7065 5b52 6571 7565  cker: Type[Reque
-00006500: 7374 4d6f 636b 6572 5d0a 2020 2020 2920  stMocker].    ) 
-00006510: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00006520: 2061 7379 6e63 5f77 332e 6d69 6464 6c65   async_w3.middle
-00006530: 7761 7265 5f6f 6e69 6f6e 2e69 6e6a 6563  ware_onion.injec
-00006540: 7428 4578 7472 6144 6174 6154 6f50 4f41  t(ExtraDataToPOA
-00006550: 4d69 6464 6c65 7761 7265 2c20 2270 6f61  Middleware, "poa
-00006560: 222c 206c 6179 6572 3d30 290a 2020 2020  ", layer=0).    
-00006570: 2020 2020 6578 7472 615f 6461 7461 203d      extra_data =
-00006580: 2066 2230 787b 2766 6627 202a 2033 337d   f"0x{'ff' * 33}
-00006590: 220a 0a20 2020 2020 2020 2061 7379 6e63  "..        async
-000065a0: 2077 6974 6820 7265 7175 6573 745f 6d6f   with request_mo
-000065b0: 636b 6572 280a 2020 2020 2020 2020 2020  cker(.          
-000065c0: 2020 6173 796e 635f 7733 2c0a 2020 2020    async_w3,.    
-000065d0: 2020 2020 2020 2020 6d6f 636b 5f72 6573          mock_res
-000065e0: 756c 7473 3d7b 2265 7468 5f67 6574 426c  ults={"eth_getBl
-000065f0: 6f63 6b42 794e 756d 6265 7222 3a20 7b22  ockByNumber": {"
-00006600: 6578 7472 6144 6174 6122 3a20 6578 7472  extraData": extr
-00006610: 615f 6461 7461 7d7d 2c0a 2020 2020 2020  a_data}},.      
-00006620: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-00006630: 2062 6c6f 636b 203d 2061 7761 6974 2061   block = await a
-00006640: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
-00006650: 626c 6f63 6b28 226c 6174 6573 7422 290a  block("latest").
-00006660: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00006670: 2265 7874 7261 4461 7461 2220 6e6f 7420  "extraData" not 
-00006680: 696e 2062 6c6f 636b 0a20 2020 2020 2020  in block.       
-00006690: 2061 7373 6572 7420 626c 6f63 6b5b 2270   assert block["p
-000066a0: 726f 6f66 4f66 4175 7468 6f72 6974 7944  roofOfAuthorityD
-000066b0: 6174 6122 5d20 3d3d 2074 6f5f 6279 7465  ata"] == to_byte
-000066c0: 7328 6865 7873 7472 3d65 7874 7261 5f64  s(hexstr=extra_d
-000066d0: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
-000066e0: 636c 6561 6e20 7570 0a20 2020 2020 2020  clean up.       
-000066f0: 2061 7379 6e63 5f77 332e 6d69 6464 6c65   async_w3.middle
-00006700: 7761 7265 5f6f 6e69 6f6e 2e72 656d 6f76  ware_onion.remov
-00006710: 6528 2270 6f61 2229 0a0a 2020 2020 4070  e("poa")..    @p
-00006720: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-00006730: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-00006740: 2074 6573 745f 6574 685f 7365 6e64 5f72   test_eth_send_r
-00006750: 6177 5f74 7261 6e73 6163 7469 6f6e 2873  aw_transaction(s
-00006760: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
-00006770: 4173 796e 6357 6562 3322 2920 2d3e 204e  AsyncWeb3") -> N
-00006780: 6f6e 653a 0a20 2020 2020 2020 2023 2070  one:.        # p
-00006790: 7269 7661 7465 206b 6579 2030 7833 6332  rivate key 0x3c2
-000067a0: 6162 3465 3866 3137 6137 6465 6131 3931  ab4e8f17a7dea191
-000067b0: 6238 6339 3931 3532 3236 3630 3132 3664  b8c991522660126d
-000067c0: 3638 3130 3339 3530 3964 6333 6262 3331  681039509dc3bb31
-000067d0: 6166 3763 3962 6462 3633 3531 380a 2020  af7c9bdb63518.  
-000067e0: 2020 2020 2020 2320 5468 6973 2069 7320        # This is 
-000067f0: 616e 2075 6e66 756e 6465 6420 6163 636f  an unfunded acco
-00006800: 756e 742c 2062 7574 2074 6865 2074 7261  unt, but the tra
-00006810: 6e73 6163 7469 6f6e 2068 6173 2061 2030  nsaction has a 0
-00006820: 2067 6173 2070 7269 6365 2c20 736f 2069   gas price, so i
-00006830: 730a 2020 2020 2020 2020 2320 7661 6c69  s.        # vali
-00006840: 642e 2049 7420 6e65 7665 7220 6e65 6564  d. It never need
-00006850: 7320 746f 2062 6520 6d69 6e65 642c 2077  s to be mined, w
-00006860: 6520 6a75 7374 2077 616e 7420 7468 6520  e just want the 
-00006870: 7472 616e 7361 6374 696f 6e20 6861 7368  transaction hash
-00006880: 2062 6163 6b0a 2020 2020 2020 2020 2320   back.        # 
-00006890: 746f 2063 6f6e 6669 726d 2e0a 2020 2020  to confirm..    
-000068a0: 2020 2020 2320 7478 203d 207b 2774 6f27      # tx = {'to'
-000068b0: 3a20 2730 7830 3030 3030 3030 3030 3030  : '0x00000000000
-000068c0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-000068d0: 3030 3030 3030 3030 3030 3030 3027 2c20  0000000000000', 
-000068e0: 2776 616c 7565 273a 2030 2c20 2027 6e6f  'value': 0,  'no
-000068f0: 6e63 6527 3a20 312c 2027 6761 7327 3a20  nce': 1, 'gas': 
-00006900: 3231 3030 302c 2027 6761 7350 7269 6365  21000, 'gasPrice
-00006910: 273a 2030 2c20 2763 6861 696e 4964 273a  ': 0, 'chainId':
-00006920: 2031 3331 3237 3733 3232 3934 3035 3337   131277322940537
-00006930: 7d20 2023 206e 6f71 613a 2045 3530 310a  }  # noqa: E501.
-00006940: 2020 2020 2020 2020 2320 4e4f 5445 3a20          # NOTE: 
-00006950: 6e6f 6e63 653d 3120 746f 206d 616b 6520  nonce=1 to make 
-00006960: 7478 6e20 756e 6971 7565 2066 726f 6d20  txn unique from 
-00006970: 7468 6520 6e6f 6e2d 6173 796e 6320 7665  the non-async ve
-00006980: 7273 696f 6e20 6f66 2074 6869 7320 7465  rsion of this te
-00006990: 7374 0a20 2020 2020 2020 2072 6177 5f74  st.        raw_t
-000069a0: 786e 203d 2048 6578 4279 7465 7328 0a20  xn = HexBytes(. 
-000069b0: 2020 2020 2020 2020 2020 2022 3078 6638             "0xf8
-000069c0: 3635 3031 3830 3832 3532 3038 3934 3030  6501808252089400
-000069d0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-000069e0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-000069f0: 3030 3030 3030 3830 3830 3836 6565 6361  000000808086eeca
-00006a00: 6334 3636 6531 3135 6130 6666 6464 3432  c466e115a0ffdd42
-00006a10: 6437 6465 6534 6163 3835 3432 3734 3638  d7dee4ac85427468
-00006a20: 6263 3631 3638 3132 6534 3934 3332 6532  bc616812e49432e2
-00006a30: 3835 6534 6538 6635 6364 3933 3831 3136  85e4e8f5cd938116
-00006a40: 3361 6333 6232 3831 3038 6130 3465 6336  3ac3b28108a04ec6
-00006a50: 6230 6438 3965 6362 6435 6538 3962 3033  b0d89ecbd5e89b03
-00006a60: 3939 6633 3336 6164 3530 6632 3833 6661  99f336ad50f283fa
-00006a70: 6664 3730 6538 3635 3933 3235 3062 6635  fd70e86593250bf5
-00006a80: 6132 6164 6662 3933 6431 3765 2220 2023  a2adfb93d17e"  #
-00006a90: 206e 6f71 613a 2045 3530 310a 2020 2020   noqa: E501.    
-00006aa0: 2020 2020 290a 2020 2020 2020 2020 6578      ).        ex
-00006ab0: 7065 6374 6564 5f68 6173 6820 3d20 4865  pected_hash = He
-00006ac0: 7853 7472 280a 2020 2020 2020 2020 2020  xStr(.          
-00006ad0: 2020 2230 7835 3262 3066 6639 6362 3437    "0x52b0ff9cb47
-00006ae0: 3266 3235 3837 3266 6138 6563 3661 3632  2f25872fa8ec6a62
-00006af0: 6661 3539 3435 3466 6332 6165 3739 3031  fa59454fc2ae7901
-00006b00: 6366 6363 3663 6338 3964 3039 3666 3439  cfcc6cc89d096f49
-00006b10: 6238 6663 3122 0a20 2020 2020 2020 2029  b8fc1".        )
-00006b20: 0a20 2020 2020 2020 2074 786e 5f68 6173  .        txn_has
-00006b30: 6820 3d20 6177 6169 7420 6173 796e 635f  h = await async_
-00006b40: 7733 2e65 7468 2e73 656e 645f 7261 775f  w3.eth.send_raw_
-00006b50: 7472 616e 7361 6374 696f 6e28 7261 775f  transaction(raw_
-00006b60: 7478 6e29 0a20 2020 2020 2020 2061 7373  txn).        ass
-00006b70: 6572 7420 7478 6e5f 6861 7368 203d 3d20  ert txn_hash == 
-00006b80: 6173 796e 635f 7733 2e74 6f5f 6279 7465  async_w3.to_byte
-00006b90: 7328 6865 7873 7472 3d65 7870 6563 7465  s(hexstr=expecte
-00006ba0: 645f 6861 7368 290a 0a20 2020 2040 7079  d_hash)..    @py
-00006bb0: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-00006bc0: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
-00006bd0: 7465 7374 5f47 6173 5072 6963 6553 7472  test_GasPriceStr
-00006be0: 6174 6567 794d 6964 646c 6577 6172 6528  ategyMiddleware(
-00006bf0: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
-00006c00: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-00006c10: 6562 3322 2c20 6173 796e 635f 756e 6c6f  eb3", async_unlo
-00006c20: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-00006c30: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-00006c40: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-00006c50: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
-00006c60: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
-00006c70: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-00006c80: 2020 2020 2266 726f 6d22 3a20 6173 796e      "from": asyn
-00006c90: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
-00006ca0: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
-00006cb0: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
-00006cc0: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
-00006cd0: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-00006ce0: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-00006cf0: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-00006d00: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-00006d10: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00006d20: 207d 0a20 2020 2020 2020 2074 776f 5f67   }.        two_g
-00006d30: 7765 695f 696e 5f77 6569 203d 2061 7379  wei_in_wei = asy
-00006d40: 6e63 5f77 332e 746f 5f77 6569 2832 2c20  nc_w3.to_wei(2, 
-00006d50: 2267 7765 6922 290a 0a20 2020 2020 2020  "gwei")..       
-00006d60: 2064 6566 2067 6173 5f70 7269 6365 5f73   def gas_price_s
-00006d70: 7472 6174 6567 7928 7733 3a20 2257 6562  trategy(w3: "Web
-00006d80: 3322 2c20 7478 6e3a 2054 7850 6172 616d  3", txn: TxParam
-00006d90: 7329 202d 3e20 5765 693a 0a20 2020 2020  s) -> Wei:.     
-00006da0: 2020 2020 2020 2072 6574 7572 6e20 7477         return tw
-00006db0: 6f5f 6777 6569 5f69 6e5f 7765 690a 0a20  o_gwei_in_wei.. 
-00006dc0: 2020 2020 2020 2061 7379 6e63 5f77 332e         async_w3.
-00006dd0: 6574 682e 7365 745f 6761 735f 7072 6963  eth.set_gas_pric
-00006de0: 655f 7374 7261 7465 6779 2867 6173 5f70  e_strategy(gas_p
-00006df0: 7269 6365 5f73 7472 6174 6567 7929 0a0a  rice_strategy)..
-00006e00: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
-00006e10: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-00006e20: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
-00006e30: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
-00006e40: 7329 0a20 2020 2020 2020 2074 786e 203d  s).        txn =
-00006e50: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00006e60: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
-00006e70: 696f 6e28 7478 6e5f 6861 7368 290a 0a20  ion(txn_hash).. 
-00006e80: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
-00006e90: 6e5b 2267 6173 5072 6963 6522 5d20 3d3d  n["gasPrice"] ==
-00006ea0: 2074 776f 5f67 7765 695f 696e 5f77 6569   two_gwei_in_wei
-00006eb0: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-00006ec0: 332e 6574 682e 7365 745f 6761 735f 7072  3.eth.set_gas_pr
-00006ed0: 6963 655f 7374 7261 7465 6779 284e 6f6e  ice_strategy(Non
-00006ee0: 6529 2020 2320 7265 7365 7420 7374 7261  e)  # reset stra
-00006ef0: 7465 6779 0a0a 2020 2020 4070 7974 6573  tegy..    @pytes
-00006f00: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00006f10: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00006f20: 745f 6761 735f 7072 6963 655f 7374 7261  t_gas_price_stra
-00006f30: 7465 6779 5f6d 6964 646c 6577 6172 655f  tegy_middleware_
-00006f40: 6865 785f 7661 6c75 6528 0a20 2020 2020  hex_value(.     
-00006f50: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
-00006f60: 333a 2022 4173 796e 6357 6562 3322 2c20  3: "AsyncWeb3", 
-00006f70: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
-00006f80: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-00006f90: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-00006fa0: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
-00006fb0: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
-00006fc0: 616d 733a 2054 7850 6172 616d 7320 3d20  ams: TxParams = 
-00006fd0: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
-00006fe0: 726f 6d22 3a20 6173 796e 635f 756e 6c6f  rom": async_unlo
-00006ff0: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-00007000: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-00007010: 2020 2020 2274 6f22 3a20 6173 796e 635f      "to": async_
-00007020: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00007030: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-00007040: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
-00007050: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
-00007060: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
-00007070: 302c 0a20 2020 2020 2020 207d 0a20 2020  0,.        }.   
-00007080: 2020 2020 2074 776f 5f67 7765 695f 696e       two_gwei_in
-00007090: 5f77 6569 203d 2061 7379 6e63 5f77 332e  _wei = async_w3.
-000070a0: 746f 5f77 6569 2832 2c20 2267 7765 6922  to_wei(2, "gwei"
-000070b0: 290a 0a20 2020 2020 2020 2064 6566 2067  )..        def g
-000070c0: 6173 5f70 7269 6365 5f73 7472 6174 6567  as_price_strateg
-000070d0: 7928 5f77 333a 2022 5765 6233 222c 205f  y(_w3: "Web3", _
-000070e0: 7478 6e3a 2054 7850 6172 616d 7329 202d  txn: TxParams) -
-000070f0: 3e20 7374 723a 0a20 2020 2020 2020 2020  > str:.         
-00007100: 2020 2072 6574 7572 6e20 6865 7828 7477     return hex(tw
-00007110: 6f5f 6777 6569 5f69 6e5f 7765 6929 0a0a  o_gwei_in_wei)..
-00007120: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
-00007130: 2e65 7468 2e73 6574 5f67 6173 5f70 7269  .eth.set_gas_pri
-00007140: 6365 5f73 7472 6174 6567 7928 6761 735f  ce_strategy(gas_
-00007150: 7072 6963 655f 7374 7261 7465 6779 2920  price_strategy) 
-00007160: 2023 2074 7970 653a 2069 676e 6f72 650a   # type: ignore.
-00007170: 0a20 2020 2020 2020 2074 786e 5f68 6173  .        txn_has
-00007180: 6820 3d20 6177 6169 7420 6173 796e 635f  h = await async_
-00007190: 7733 2e65 7468 2e73 656e 645f 7472 616e  w3.eth.send_tran
-000071a0: 7361 6374 696f 6e28 7478 6e5f 7061 7261  saction(txn_para
-000071b0: 6d73 290a 2020 2020 2020 2020 7478 6e20  ms).        txn 
-000071c0: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-000071d0: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
-000071e0: 7469 6f6e 2874 786e 5f68 6173 6829 0a0a  tion(txn_hash)..
-000071f0: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-00007200: 786e 5b22 6761 7350 7269 6365 225d 203d  xn["gasPrice"] =
-00007210: 3d20 7477 6f5f 6777 6569 5f69 6e5f 7765  = two_gwei_in_we
-00007220: 690a 2020 2020 2020 2020 6173 796e 635f  i.        async_
-00007230: 7733 2e65 7468 2e73 6574 5f67 6173 5f70  w3.eth.set_gas_p
-00007240: 7269 6365 5f73 7472 6174 6567 7928 4e6f  rice_strategy(No
-00007250: 6e65 2920 2023 2072 6573 6574 2073 7472  ne)  # reset str
-00007260: 6174 6567 790a 0a20 2020 2040 7079 7465  ategy..    @pyte
-00007270: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-00007280: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00007290: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
-000072a0: 2020 2020 2020 226d 6178 5f66 6565 222c        "max_fee",
-000072b0: 2028 3130 3030 3030 3030 3030 2c20 4e6f   (1000000000, No
-000072c0: 6e65 292c 2069 6473 3d5b 2277 6974 685f  ne), ids=["with_
-000072d0: 6d61 785f 6665 6522 2c20 2277 6974 686f  max_fee", "witho
-000072e0: 7574 5f6d 6178 5f66 6565 225d 0a20 2020  ut_max_fee"].   
-000072f0: 2029 0a20 2020 2061 7379 6e63 2064 6566   ).    async def
-00007300: 2074 6573 745f 6761 735f 7072 6963 655f   test_gas_price_
-00007310: 6672 6f6d 5f73 7472 6174 6567 795f 6279  from_strategy_by
-00007320: 7061 7373 6564 5f66 6f72 5f64 796e 616d  passed_for_dynam
-00007330: 6963 5f66 6565 5f74 786e 280a 2020 2020  ic_fee_txn(.    
-00007340: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00007350: 2020 6173 796e 635f 7733 3a20 2241 7379    async_w3: "Asy
-00007360: 6e63 5765 6233 222c 0a20 2020 2020 2020  ncWeb3",.       
-00007370: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
-00007380: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
-00007390: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
-000073a0: 7373 2c0a 2020 2020 2020 2020 6d61 785f  ss,.        max_
-000073b0: 6665 653a 2057 6569 2c0a 2020 2020 2920  fee: Wei,.    ) 
-000073c0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-000073d0: 206d 6178 5f70 7269 6f72 6974 795f 6665   max_priority_fe
-000073e0: 6520 3d20 6173 796e 635f 7733 2e74 6f5f  e = async_w3.to_
-000073f0: 7765 6928 312c 2022 6777 6569 2229 0a20  wei(1, "gwei"). 
-00007400: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00007410: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-00007420: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-00007430: 6d22 3a20 6173 796e 635f 756e 6c6f 636b  m": async_unlock
-00007440: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
-00007450: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00007460: 2020 2274 6f22 3a20 6173 796e 635f 756e    "to": async_un
-00007470: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-00007480: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-00007490: 2020 2020 2020 2276 616c 7565 223a 2057        "value": W
-000074a0: 6569 2831 292c 0a20 2020 2020 2020 2020  ei(1),.         
-000074b0: 2020 2022 6761 7322 3a20 3231 3030 302c     "gas": 21000,
-000074c0: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
-000074d0: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-000074e0: 6173 223a 206d 6178 5f70 7269 6f72 6974  as": max_priorit
-000074f0: 795f 6665 652c 0a20 2020 2020 2020 207d  y_fee,.        }
-00007500: 0a20 2020 2020 2020 2069 6620 6d61 785f  .        if max_
-00007510: 6665 6520 6973 206e 6f74 204e 6f6e 653a  fee is not None:
-00007520: 0a20 2020 2020 2020 2020 2020 2074 786e  .            txn
-00007530: 5f70 6172 616d 7320 3d20 6173 736f 6328  _params = assoc(
-00007540: 7478 6e5f 7061 7261 6d73 2c20 226d 6178  txn_params, "max
-00007550: 4665 6550 6572 4761 7322 2c20 6d61 785f  FeePerGas", max_
-00007560: 6665 6529 0a0a 2020 2020 2020 2020 6465  fee)..        de
-00007570: 6620 6761 735f 7072 6963 655f 7374 7261  f gas_price_stra
-00007580: 7465 6779 2877 333a 2022 5765 6233 222c  tegy(w3: "Web3",
-00007590: 2074 786e 3a20 5478 5061 7261 6d73 2920   txn: TxParams) 
-000075a0: 2d3e 2057 6569 3a0a 2020 2020 2020 2020  -> Wei:.        
-000075b0: 2020 2020 7265 7475 726e 2061 7379 6e63      return async
-000075c0: 5f77 332e 746f 5f77 6569 2832 2c20 2267  _w3.to_wei(2, "g
-000075d0: 7765 6922 290a 0a20 2020 2020 2020 2061  wei")..        a
-000075e0: 7379 6e63 5f77 332e 6574 682e 7365 745f  sync_w3.eth.set_
-000075f0: 6761 735f 7072 6963 655f 7374 7261 7465  gas_price_strate
-00007600: 6779 2867 6173 5f70 7269 6365 5f73 7472  gy(gas_price_str
-00007610: 6174 6567 7929 0a0a 2020 2020 2020 2020  ategy)..        
-00007620: 7478 6e5f 6861 7368 203d 2061 7761 6974  txn_hash = await
-00007630: 2061 7379 6e63 5f77 332e 6574 682e 7365   async_w3.eth.se
-00007640: 6e64 5f74 7261 6e73 6163 7469 6f6e 2874  nd_transaction(t
-00007650: 786e 5f70 6172 616d 7329 0a20 2020 2020  xn_params).     
-00007660: 2020 2074 786e 203d 2061 7761 6974 2061     txn = await a
-00007670: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
-00007680: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
-00007690: 6861 7368 290a 0a20 2020 2020 2020 206c  hash)..        l
-000076a0: 6174 6573 745f 626c 6f63 6b20 3d20 6177  atest_block = aw
+000045f0: 2267 6173 225d 0a20 2020 2020 2020 2020  "gas"].         
+00004600: 2020 2061 7373 6572 7420 7265 7375 6c74     assert result
+00004610: 5b22 7478 225d 5b22 6d61 7846 6565 5065  ["tx"]["maxFeePe
+00004620: 7247 6173 225d 203d 3d20 7478 6e5f 7061  rGas"] == txn_pa
+00004630: 7261 6d73 5b22 6d61 7846 6565 5065 7247  rams["maxFeePerG
+00004640: 6173 225d 0a20 2020 2020 2020 2020 2020  as"].           
+00004650: 2061 7373 6572 7420 280a 2020 2020 2020   assert (.      
+00004660: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00004670: 5b22 7478 225d 5b22 6d61 7850 7269 6f72  ["tx"]["maxPrior
+00004680: 6974 7946 6565 5065 7247 6173 225d 0a20  ityFeePerGas"]. 
+00004690: 2020 2020 2020 2020 2020 2020 2020 203d                 =
+000046a0: 3d20 7478 6e5f 7061 7261 6d73 5b22 6d61  = txn_params["ma
+000046b0: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+000046c0: 6173 225d 0a20 2020 2020 2020 2020 2020  as"].           
+000046d0: 2029 0a20 2020 2020 2020 2020 2020 2061   ).            a
+000046e0: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
+000046f0: 225d 5b22 6e6f 6e63 6522 5d20 3d3d 2074  "]["nonce"] == t
+00004700: 786e 5f70 6172 616d 735b 226e 6f6e 6365  xn_params["nonce
+00004710: 225d 0a0a 2020 2020 4070 7974 6573 742e  "]..    @pytest.
+00004720: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+00004730: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+00004740: 6574 685f 7365 6e64 5f74 7261 6e73 6163  eth_send_transac
+00004750: 7469 6f6e 280a 2020 2020 2020 2020 7365  tion(.        se
+00004760: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00004770: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
+00004780: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+00004790: 745f 6475 616c 5f74 7970 653a 2043 6865  t_dual_type: Che
+000047a0: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
+000047b0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+000047c0: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
+000047d0: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
+000047e0: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
+000047f0: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+00004800: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+00004810: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00004820: 746f 223a 2061 7379 6e63 5f75 6e6c 6f63  to": async_unloc
+00004830: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+00004840: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+00004850: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
+00004860: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+00004870: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
+00004880: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
+00004890: 6550 6572 4761 7322 3a20 6173 796e 635f  ePerGas": async_
+000048a0: 7733 2e74 6f5f 7765 6928 332c 2022 6777  w3.to_wei(3, "gw
+000048b0: 6569 2229 2c0a 2020 2020 2020 2020 2020  ei"),.          
+000048c0: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
+000048d0: 6550 6572 4761 7322 3a20 6173 796e 635f  ePerGas": async_
+000048e0: 7733 2e74 6f5f 7765 6928 312c 2022 6777  w3.to_wei(1, "gw
+000048f0: 6569 2229 2c0a 2020 2020 2020 2020 7d0a  ei"),.        }.
+00004900: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+00004910: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00004920: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+00004930: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
+00004940: 7329 0a20 2020 2020 2020 2074 786e 203d  s).        txn =
+00004950: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00004960: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
+00004970: 696f 6e28 7478 6e5f 6861 7368 290a 0a20  ion(txn_hash).. 
+00004980: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00004990: 5f73 616d 655f 6164 6472 6573 7328 7478  _same_address(tx
+000049a0: 6e5b 2266 726f 6d22 5d2c 2063 6173 7428  n["from"], cast(
+000049b0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+000049c0: 2074 786e 5f70 6172 616d 735b 2266 726f   txn_params["fro
+000049d0: 6d22 5d29 290a 2020 2020 2020 2020 6173  m"])).        as
+000049e0: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
+000049f0: 7265 7373 2874 786e 5b22 746f 225d 2c20  ress(txn["to"], 
+00004a00: 6361 7374 2843 6865 636b 7375 6d41 6464  cast(ChecksumAdd
+00004a10: 7265 7373 2c20 7478 6e5f 7061 7261 6d73  ress, txn_params
+00004a20: 5b22 746f 225d 2929 0a20 2020 2020 2020  ["to"])).       
+00004a30: 2061 7373 6572 7420 7478 6e5b 2276 616c   assert txn["val
+00004a40: 7565 225d 203d 3d20 310a 2020 2020 2020  ue"] == 1.      
+00004a50: 2020 6173 7365 7274 2074 786e 5b22 6761    assert txn["ga
+00004a60: 7322 5d20 3d3d 2032 3130 3030 0a20 2020  s"] == 21000.   
+00004a70: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
+00004a80: 226d 6178 4665 6550 6572 4761 7322 5d20  "maxFeePerGas"] 
+00004a90: 3d3d 2074 786e 5f70 6172 616d 735b 226d  == txn_params["m
+00004aa0: 6178 4665 6550 6572 4761 7322 5d0a 2020  axFeePerGas"].  
+00004ab0: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
+00004ac0: 5b22 6d61 7850 7269 6f72 6974 7946 6565  ["maxPriorityFee
+00004ad0: 5065 7247 6173 225d 203d 3d20 7478 6e5f  PerGas"] == txn_
+00004ae0: 7061 7261 6d73 5b22 6d61 7850 7269 6f72  params["maxPrior
+00004af0: 6974 7946 6565 5065 7247 6173 225d 0a20  ityFeePerGas"]. 
+00004b00: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
+00004b10: 6e5b 2267 6173 5072 6963 6522 5d20 3d3d  n["gasPrice"] ==
+00004b20: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
+00004b30: 4665 6550 6572 4761 7322 5d0a 0a20 2020  FeePerGas"]..   
+00004b40: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00004b50: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+00004b60: 6465 6620 7465 7374 5f65 7468 5f73 656e  def test_eth_sen
+00004b70: 645f 7472 616e 7361 6374 696f 6e5f 6465  d_transaction_de
+00004b80: 6661 756c 745f 6665 6573 280a 2020 2020  fault_fees(.    
+00004b90: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
+00004ba0: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+00004bb0: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+00004bc0: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+00004bd0: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
+00004be0: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
+00004bf0: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
+00004c00: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
+00004c10: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00004c20: 6672 6f6d 223a 2061 7379 6e63 5f75 6e6c  from": async_unl
+00004c30: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+00004c40: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00004c50: 2020 2020 2022 746f 223a 2061 7379 6e63       "to": async
+00004c60: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+00004c70: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
+00004c80: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+00004c90: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+00004ca0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+00004cb0: 3030 2c0a 2020 2020 2020 2020 7d0a 2020  00,.        }.  
+00004cc0: 2020 2020 2020 7478 6e5f 6861 7368 203d        txn_hash =
+00004cd0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00004ce0: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+00004cf0: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+00004d00: 0a20 2020 2020 2020 2074 786e 203d 2061  .        txn = a
+00004d10: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+00004d20: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
+00004d30: 6e28 7478 6e5f 6861 7368 290a 0a20 2020  n(txn_hash)..   
+00004d40: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
+00004d50: 616d 655f 6164 6472 6573 7328 7478 6e5b  ame_address(txn[
+00004d60: 2266 726f 6d22 5d2c 2063 6173 7428 4368  "from"], cast(Ch
+00004d70: 6563 6b73 756d 4164 6472 6573 732c 2074  ecksumAddress, t
+00004d80: 786e 5f70 6172 616d 735b 2266 726f 6d22  xn_params["from"
+00004d90: 5d29 290a 2020 2020 2020 2020 6173 7365  ])).        asse
+00004da0: 7274 2069 735f 7361 6d65 5f61 6464 7265  rt is_same_addre
+00004db0: 7373 2874 786e 5b22 746f 225d 2c20 6361  ss(txn["to"], ca
+00004dc0: 7374 2843 6865 636b 7375 6d41 6464 7265  st(ChecksumAddre
+00004dd0: 7373 2c20 7478 6e5f 7061 7261 6d73 5b22  ss, txn_params["
+00004de0: 746f 225d 2929 0a20 2020 2020 2020 2061  to"])).        a
+00004df0: 7373 6572 7420 7478 6e5b 2276 616c 7565  ssert txn["value
+00004e00: 225d 203d 3d20 310a 2020 2020 2020 2020  "] == 1.        
+00004e10: 6173 7365 7274 2074 786e 5b22 6761 7322  assert txn["gas"
+00004e20: 5d20 3d3d 2032 3130 3030 0a20 2020 2020  ] == 21000.     
+00004e30: 2020 2061 7373 6572 7420 6973 5f69 6e74     assert is_int
+00004e40: 6567 6572 2874 786e 5b22 6d61 7850 7269  eger(txn["maxPri
+00004e50: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
+00004e60: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00004e70: 2069 735f 696e 7465 6765 7228 7478 6e5b   is_integer(txn[
+00004e80: 226d 6178 4665 6550 6572 4761 7322 5d29  "maxFeePerGas"])
+00004e90: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00004ea0: 7478 6e5b 2267 6173 5072 6963 6522 5d20  txn["gasPrice"] 
+00004eb0: 3d3d 2074 786e 5b22 6d61 7846 6565 5065  == txn["maxFeePe
+00004ec0: 7247 6173 225d 0a0a 2020 2020 4070 7974  rGas"]..    @pyt
+00004ed0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+00004ee0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+00004ef0: 6573 745f 6574 685f 7365 6e64 5f74 7261  est_eth_send_tra
+00004f00: 6e73 6163 7469 6f6e 5f68 6578 5f66 6565  nsaction_hex_fee
+00004f10: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+00004f20: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+00004f30: 6357 6562 3322 2c20 6173 796e 635f 756e  cWeb3", async_un
+00004f40: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
+00004f50: 7561 6c5f 7479 7065 3a20 4368 6563 6b73  ual_type: Checks
+00004f60: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
+00004f70: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00004f80: 2074 786e 5f70 6172 616d 733a 2054 7850   txn_params: TxP
+00004f90: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+00004fa0: 2020 2020 2020 2266 726f 6d22 3a20 6173        "from": as
+00004fb0: 796e 635f 756e 6c6f 636b 6564 5f61 6363  ync_unlocked_acc
+00004fc0: 6f75 6e74 5f64 7561 6c5f 7479 7065 2c0a  ount_dual_type,.
+00004fd0: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+00004fe0: 3a20 6173 796e 635f 756e 6c6f 636b 6564  : async_unlocked
+00004ff0: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+00005000: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+00005010: 2276 616c 7565 223a 2057 6569 2831 292c  "value": Wei(1),
+00005020: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
+00005030: 7322 3a20 3231 3030 302c 0a20 2020 2020  s": 21000,.     
+00005040: 2020 2020 2020 2022 6d61 7846 6565 5065         "maxFeePe
+00005050: 7247 6173 223a 2068 6578 2832 3530 202a  rGas": hex(250 *
+00005060: 2031 302a 2a39 292c 0a20 2020 2020 2020   10**9),.       
+00005070: 2020 2020 2022 6d61 7850 7269 6f72 6974       "maxPriorit
+00005080: 7946 6565 5065 7247 6173 223a 2068 6578  yFeePerGas": hex
+00005090: 2832 202a 2031 302a 2a39 292c 0a20 2020  (2 * 10**9),.   
+000050a0: 2020 2020 207d 0a20 2020 2020 2020 2074       }.        t
+000050b0: 786e 5f68 6173 6820 3d20 6177 6169 7420  xn_hash = await 
+000050c0: 6173 796e 635f 7733 2e65 7468 2e73 656e  async_w3.eth.sen
+000050d0: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
+000050e0: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
+000050f0: 2020 7478 6e20 3d20 6177 6169 7420 6173    txn = await as
+00005100: 796e 635f 7733 2e65 7468 2e67 6574 5f74  ync_w3.eth.get_t
+00005110: 7261 6e73 6163 7469 6f6e 2874 786e 5f68  ransaction(txn_h
+00005120: 6173 6829 0a0a 2020 2020 2020 2020 6173  ash)..        as
+00005130: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
+00005140: 7265 7373 2874 786e 5b22 6672 6f6d 225d  ress(txn["from"]
+00005150: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
+00005160: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
+00005170: 6d73 5b22 6672 6f6d 225d 2929 0a20 2020  ms["from"])).   
+00005180: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
+00005190: 616d 655f 6164 6472 6573 7328 7478 6e5b  ame_address(txn[
+000051a0: 2274 6f22 5d2c 2063 6173 7428 4368 6563  "to"], cast(Chec
+000051b0: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
+000051c0: 5f70 6172 616d 735b 2274 6f22 5d29 290a  _params["to"])).
+000051d0: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+000051e0: 786e 5b22 7661 6c75 6522 5d20 3d3d 2031  xn["value"] == 1
+000051f0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00005200: 7478 6e5b 2267 6173 225d 203d 3d20 3231  txn["gas"] == 21
+00005210: 3030 300a 2020 2020 2020 2020 6173 7365  000.        asse
+00005220: 7274 2074 786e 5b22 6d61 7846 6565 5065  rt txn["maxFeePe
+00005230: 7247 6173 225d 203d 3d20 3235 3020 2a20  rGas"] == 250 * 
+00005240: 3130 2a2a 390a 2020 2020 2020 2020 6173  10**9.        as
+00005250: 7365 7274 2074 786e 5b22 6d61 7850 7269  sert txn["maxPri
+00005260: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
+00005270: 203d 3d20 3220 2a20 3130 2a2a 390a 0a20   == 2 * 10**9.. 
+00005280: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
+00005290: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
+000052a0: 6320 6465 6620 7465 7374 5f65 7468 5f73  c def test_eth_s
+000052b0: 656e 645f 7472 616e 7361 6374 696f 6e5f  end_transaction_
+000052c0: 6e6f 5f67 6173 280a 2020 2020 2020 2020  no_gas(.        
+000052d0: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+000052e0: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
+000052f0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+00005300: 756e 745f 6475 616c 5f74 7970 653a 2043  unt_dual_type: C
+00005310: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
+00005320: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00005330: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+00005340: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
+00005350: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+00005360: 223a 2061 7379 6e63 5f75 6e6c 6f63 6b65  ": async_unlocke
+00005370: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
+00005380: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00005390: 2022 746f 223a 2061 7379 6e63 5f75 6e6c   "to": async_unl
+000053a0: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+000053b0: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+000053c0: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+000053d0: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+000053e0: 2020 226d 6178 4665 6550 6572 4761 7322    "maxFeePerGas"
+000053f0: 3a20 5765 6928 3235 3020 2a20 3130 2a2a  : Wei(250 * 10**
+00005400: 3929 2c0a 2020 2020 2020 2020 2020 2020  9),.            
+00005410: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+00005420: 6572 4761 7322 3a20 5765 6928 3220 2a20  erGas": Wei(2 * 
+00005430: 3130 2a2a 3929 2c0a 2020 2020 2020 2020  10**9),.        
+00005440: 7d0a 2020 2020 2020 2020 7478 6e5f 6861  }.        txn_ha
+00005450: 7368 203d 2061 7761 6974 2061 7379 6e63  sh = await async
+00005460: 5f77 332e 6574 682e 7365 6e64 5f74 7261  _w3.eth.send_tra
+00005470: 6e73 6163 7469 6f6e 2874 786e 5f70 6172  nsaction(txn_par
+00005480: 616d 7329 0a20 2020 2020 2020 2074 786e  ams).        txn
+00005490: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+000054a0: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
+000054b0: 6374 696f 6e28 7478 6e5f 6861 7368 290a  ction(txn_hash).
+000054c0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+000054d0: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
+000054e0: 7478 6e5b 2266 726f 6d22 5d2c 2063 6173  txn["from"], cas
+000054f0: 7428 4368 6563 6b73 756d 4164 6472 6573  t(ChecksumAddres
+00005500: 732c 2074 786e 5f70 6172 616d 735b 2266  s, txn_params["f
+00005510: 726f 6d22 5d29 290a 2020 2020 2020 2020  rom"])).        
+00005520: 6173 7365 7274 2069 735f 7361 6d65 5f61  assert is_same_a
+00005530: 6464 7265 7373 2874 786e 5b22 746f 225d  ddress(txn["to"]
+00005540: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
+00005550: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
+00005560: 6d73 5b22 746f 225d 2929 0a20 2020 2020  ms["to"])).     
+00005570: 2020 2061 7373 6572 7420 7478 6e5b 2276     assert txn["v
+00005580: 616c 7565 225d 203d 3d20 310a 2020 2020  alue"] == 1.    
+00005590: 2020 2020 6173 7365 7274 2074 786e 5b22      assert txn["
+000055a0: 6761 7322 5d20 3d3d 2031 3231 3030 3020  gas"] == 121000 
+000055b0: 2023 2032 3130 3030 202b 2062 7566 6665   # 21000 + buffe
+000055c0: 720a 0a20 2020 2040 7079 7465 7374 2e6d  r..    @pytest.m
+000055d0: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
+000055e0: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
+000055f0: 7468 5f73 656e 645f 7472 616e 7361 6374  th_send_transact
+00005600: 696f 6e5f 7769 7468 5f67 6173 5f70 7269  ion_with_gas_pri
+00005610: 6365 280a 2020 2020 2020 2020 7365 6c66  ce(.        self
+00005620: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
+00005630: 6e63 5765 6233 222c 2061 7379 6e63 5f75  ncWeb3", async_u
+00005640: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+00005650: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
+00005660: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
+00005670: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00005680: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
+00005690: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
+000056a0: 2020 2020 2020 2022 6672 6f6d 223a 2061         "from": a
+000056b0: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+000056c0: 636f 756e 745f 6475 616c 5f74 7970 652c  count_dual_type,
+000056d0: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
+000056e0: 223a 2061 7379 6e63 5f75 6e6c 6f63 6b65  ": async_unlocke
+000056f0: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
+00005700: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00005710: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
+00005720: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
+00005730: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
+00005740: 2020 2020 2020 2020 2267 6173 5072 6963          "gasPric
+00005750: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+00005760: 2020 2020 2020 2020 226d 6178 4665 6550          "maxFeeP
+00005770: 6572 4761 7322 3a20 5765 6928 3235 3020  erGas": Wei(250 
+00005780: 2a20 3130 2a2a 3929 2c0a 2020 2020 2020  * 10**9),.      
+00005790: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
+000057a0: 7479 4665 6550 6572 4761 7322 3a20 5765  tyFeePerGas": We
+000057b0: 6928 3220 2a20 3130 2a2a 3929 2c0a 2020  i(2 * 10**9),.  
+000057c0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+000057d0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+000057e0: 6573 2854 7261 6e73 6163 7469 6f6e 5479  es(TransactionTy
+000057f0: 7065 4d69 736d 6174 6368 293a 0a20 2020  peMismatch):.   
+00005800: 2020 2020 2020 2020 2061 7761 6974 2061           await a
+00005810: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
+00005820: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+00005830: 5f70 6172 616d 7329 0a0a 2020 2020 4070  _params)..    @p
+00005840: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+00005850: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
+00005860: 2074 6573 745f 6574 685f 7365 6e64 5f74   test_eth_send_t
+00005870: 7261 6e73 6163 7469 6f6e 5f6e 6f5f 7072  ransaction_no_pr
+00005880: 696f 7269 7479 5f66 6565 280a 2020 2020  iority_fee(.    
+00005890: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
+000058a0: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+000058b0: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+000058c0: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+000058d0: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
+000058e0: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
+000058f0: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
+00005900: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
+00005910: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00005920: 6672 6f6d 223a 2061 7379 6e63 5f75 6e6c  from": async_unl
+00005930: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+00005940: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00005950: 2020 2020 2022 746f 223a 2061 7379 6e63       "to": async
+00005960: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+00005970: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
+00005980: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+00005990: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+000059a0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+000059b0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+000059c0: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
+000059d0: 5765 6928 3235 3020 2a20 3130 2a2a 3929  Wei(250 * 10**9)
+000059e0: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+000059f0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+00005a00: 7261 6973 6573 280a 2020 2020 2020 2020  raises(.        
+00005a10: 2020 2020 496e 7661 6c69 6454 7261 6e73      InvalidTrans
+00005a20: 6163 7469 6f6e 2c20 6d61 7463 683d 226d  action, match="m
+00005a30: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
+00005a40: 4761 7320 6d75 7374 2062 6520 6465 6669  Gas must be defi
+00005a50: 6e65 6422 0a20 2020 2020 2020 2029 3a0a  ned".        ):.
+00005a60: 2020 2020 2020 2020 2020 2020 6177 6169              awai
+00005a70: 7420 6173 796e 635f 7733 2e65 7468 2e73  t async_w3.eth.s
+00005a80: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
+00005a90: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
+00005aa0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00005ab0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+00005ac0: 6465 6620 7465 7374 5f65 7468 5f73 656e  def test_eth_sen
+00005ad0: 645f 7472 616e 7361 6374 696f 6e5f 6e6f  d_transaction_no
+00005ae0: 5f6d 6178 5f66 6565 280a 2020 2020 2020  _max_fee(.      
+00005af0: 2020 7365 6c66 2c20 6173 796e 635f 7733    self, async_w3
+00005b00: 3a20 2241 7379 6e63 5765 6233 222c 2061  : "AsyncWeb3", a
+00005b10: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+00005b20: 636f 756e 745f 6475 616c 5f74 7970 653a  count_dual_type:
+00005b30: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+00005b40: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00005b50: 2020 2020 2020 2020 6d61 7850 7269 6f72          maxPrior
+00005b60: 6974 7946 6565 5065 7247 6173 203d 2061  ityFeePerGas = a
+00005b70: 7379 6e63 5f77 332e 746f 5f77 6569 2832  sync_w3.to_wei(2
+00005b80: 2c20 2267 7765 6922 290a 2020 2020 2020  , "gwei").      
+00005b90: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
+00005ba0: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
+00005bb0: 2020 2020 2020 2022 6672 6f6d 223a 2061         "from": a
+00005bc0: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+00005bd0: 636f 756e 745f 6475 616c 5f74 7970 652c  count_dual_type,
+00005be0: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
+00005bf0: 223a 2061 7379 6e63 5f75 6e6c 6f63 6b65  ": async_unlocke
+00005c00: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
+00005c10: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00005c20: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
+00005c30: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
+00005c40: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
+00005c50: 2020 2020 2020 2020 226d 6178 5072 696f          "maxPrio
+00005c60: 7269 7479 4665 6550 6572 4761 7322 3a20  rityFeePerGas": 
+00005c70: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
+00005c80: 7247 6173 2c0a 2020 2020 2020 2020 7d0a  rGas,.        }.
+00005c90: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+00005ca0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00005cb0: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+00005cc0: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
+00005cd0: 7329 0a20 2020 2020 2020 2074 786e 203d  s).        txn =
+00005ce0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00005cf0: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
+00005d00: 696f 6e28 7478 6e5f 6861 7368 290a 0a20  ion(txn_hash).. 
+00005d10: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00005d20: 5f73 616d 655f 6164 6472 6573 7328 7478  _same_address(tx
+00005d30: 6e5b 2266 726f 6d22 5d2c 2063 6173 7428  n["from"], cast(
+00005d40: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+00005d50: 2074 786e 5f70 6172 616d 735b 2266 726f   txn_params["fro
+00005d60: 6d22 5d29 290a 2020 2020 2020 2020 6173  m"])).        as
+00005d70: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
+00005d80: 7265 7373 2874 786e 5b22 746f 225d 2c20  ress(txn["to"], 
+00005d90: 6361 7374 2843 6865 636b 7375 6d41 6464  cast(ChecksumAdd
+00005da0: 7265 7373 2c20 7478 6e5f 7061 7261 6d73  ress, txn_params
+00005db0: 5b22 746f 225d 2929 0a20 2020 2020 2020  ["to"])).       
+00005dc0: 2061 7373 6572 7420 7478 6e5b 2276 616c   assert txn["val
+00005dd0: 7565 225d 203d 3d20 310a 2020 2020 2020  ue"] == 1.      
+00005de0: 2020 6173 7365 7274 2074 786e 5b22 6761    assert txn["ga
+00005df0: 7322 5d20 3d3d 2032 3130 3030 0a0a 2020  s"] == 21000..  
+00005e00: 2020 2020 2020 626c 6f63 6b20 3d20 6177        block = aw
+00005e10: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+00005e20: 2e67 6574 5f62 6c6f 636b 2822 6c61 7465  .get_block("late
+00005e30: 7374 2229 0a20 2020 2020 2020 2061 7373  st").        ass
+00005e40: 6572 7420 7478 6e5b 226d 6178 4665 6550  ert txn["maxFeeP
+00005e50: 6572 4761 7322 5d20 3d3d 206d 6178 5072  erGas"] == maxPr
+00005e60: 696f 7269 7479 4665 6550 6572 4761 7320  iorityFeePerGas 
+00005e70: 2b20 3220 2a20 626c 6f63 6b5b 2262 6173  + 2 * block["bas
+00005e80: 6546 6565 5065 7247 6173 225d 0a0a 2020  eFeePerGas"]..  
+00005e90: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+00005ea0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+00005eb0: 2064 6566 2074 6573 745f 6574 685f 7365   def test_eth_se
+00005ec0: 6e64 5f74 7261 6e73 6163 7469 6f6e 5f6d  nd_transaction_m
+00005ed0: 6178 5f66 6565 5f6c 6573 735f 7468 616e  ax_fee_less_than
+00005ee0: 5f74 6970 280a 2020 2020 2020 2020 7365  _tip(.        se
+00005ef0: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00005f00: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
+00005f10: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+00005f20: 745f 6475 616c 5f74 7970 653a 2043 6865  t_dual_type: Che
+00005f30: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
+00005f40: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00005f50: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
+00005f60: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
+00005f70: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
+00005f80: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+00005f90: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+00005fa0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00005fb0: 746f 223a 2061 7379 6e63 5f75 6e6c 6f63  to": async_unloc
+00005fc0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+00005fd0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+00005fe0: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
+00005ff0: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+00006000: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
+00006010: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
+00006020: 6550 6572 4761 7322 3a20 5765 6928 3120  ePerGas": Wei(1 
+00006030: 2a20 3130 2a2a 3929 2c0a 2020 2020 2020  * 10**9),.      
+00006040: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
+00006050: 7479 4665 6550 6572 4761 7322 3a20 5765  tyFeePerGas": We
+00006060: 6928 3220 2a20 3130 2a2a 3929 2c0a 2020  i(2 * 10**9),.  
+00006070: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00006080: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+00006090: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
+000060a0: 496e 7661 6c69 6454 7261 6e73 6163 7469  InvalidTransacti
+000060b0: 6f6e 2c20 6d61 7463 683d 226d 6178 4665  on, match="maxFe
+000060c0: 6550 6572 4761 7320 6d75 7374 2062 6520  ePerGas must be 
+000060d0: 3e3d 206d 6178 5072 696f 7269 7479 4665  >= maxPriorityFe
+000060e0: 6550 6572 4761 7322 0a20 2020 2020 2020  ePerGas".       
+000060f0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+00006100: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00006110: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
+00006120: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
+00006130: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00006140: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+00006150: 796e 6320 6465 6620 7465 7374 5f76 616c  ync def test_val
+00006160: 6964 6174 696f 6e5f 6d69 6464 6c65 7761  idation_middlewa
+00006170: 7265 5f63 6861 696e 5f69 645f 6d69 736d  re_chain_id_mism
+00006180: 6174 6368 280a 2020 2020 2020 2020 7365  atch(.        se
+00006190: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+000061a0: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
+000061b0: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+000061c0: 745f 6475 616c 5f74 7970 653a 2043 6865  t_dual_type: Che
+000061d0: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
+000061e0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+000061f0: 2020 2020 7772 6f6e 675f 6368 6169 6e5f      wrong_chain_
+00006200: 6964 203d 2031 3233 3435 3637 3839 300a  id = 1234567890.
+00006210: 2020 2020 2020 2020 6163 7475 616c 5f63          actual_c
+00006220: 6861 696e 5f69 6420 3d20 6177 6169 7420  hain_id = await 
+00006230: 6173 796e 635f 7733 2e65 7468 2e63 6861  async_w3.eth.cha
+00006240: 696e 5f69 640a 0a20 2020 2020 2020 2074  in_id..        t
+00006250: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+00006260: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+00006270: 2020 2020 2266 726f 6d22 3a20 6173 796e      "from": asyn
+00006280: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
+00006290: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
+000062a0: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+000062b0: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
+000062c0: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
+000062d0: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
+000062e0: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
+000062f0: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
+00006300: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
+00006310: 2020 2020 2022 6d61 7846 6565 5065 7247       "maxFeePerG
+00006320: 6173 223a 2061 7379 6e63 5f77 332e 746f  as": async_w3.to
+00006330: 5f77 6569 2832 2c20 2267 7765 6922 292c  _wei(2, "gwei"),
+00006340: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
+00006350: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+00006360: 6173 223a 2061 7379 6e63 5f77 332e 746f  as": async_w3.to
+00006370: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
+00006380: 0a20 2020 2020 2020 2020 2020 2022 6368  .            "ch
+00006390: 6169 6e49 6422 3a20 7772 6f6e 675f 6368  ainId": wrong_ch
+000063a0: 6169 6e5f 6964 2c0a 2020 2020 2020 2020  ain_id,.        
+000063b0: 7d0a 2020 2020 2020 2020 7769 7468 2070  }.        with p
+000063c0: 7974 6573 742e 7261 6973 6573 280a 2020  ytest.raises(.  
+000063d0: 2020 2020 2020 2020 2020 5765 6233 5661            Web3Va
+000063e0: 6c69 6461 7469 6f6e 4572 726f 722c 0a20  lidationError,. 
+000063f0: 2020 2020 2020 2020 2020 206d 6174 6368             match
+00006400: 3d66 2254 6865 2074 7261 6e73 6163 7469  =f"The transacti
+00006410: 6f6e 2064 6563 6c61 7265 6420 6368 6169  on declared chai
+00006420: 6e20 4944 207b 7772 6f6e 675f 6368 6169  n ID {wrong_chai
+00006430: 6e5f 6964 7d2c 2022 0a20 2020 2020 2020  n_id}, ".       
+00006440: 2020 2020 2066 2262 7574 2074 6865 2063       f"but the c
+00006450: 6f6e 6e65 6374 6564 206e 6f64 6520 6973  onnected node is
+00006460: 206f 6e20 7b61 6374 7561 6c5f 6368 6169   on {actual_chai
+00006470: 6e5f 6964 7d22 2c0a 2020 2020 2020 2020  n_id}",.        
+00006480: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+00006490: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+000064a0: 682e 7365 6e64 5f74 7261 6e73 6163 7469  h.send_transacti
+000064b0: 6f6e 2874 786e 5f70 6172 616d 7329 0a0a  on(txn_params)..
+000064c0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+000064d0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+000064e0: 6e63 2064 6566 2074 6573 745f 4578 7472  nc def test_Extr
+000064f0: 6144 6174 6154 6f50 4f41 4d69 6464 6c65  aDataToPOAMiddle
+00006500: 7761 7265 280a 2020 2020 2020 2020 7365  ware(.        se
+00006510: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00006520: 7379 6e63 5765 6233 222c 2072 6571 7565  syncWeb3", reque
+00006530: 7374 5f6d 6f63 6b65 723a 2054 7970 655b  st_mocker: Type[
+00006540: 5265 7175 6573 744d 6f63 6b65 725d 0a20  RequestMocker]. 
+00006550: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00006560: 2020 2020 2020 6173 796e 635f 7733 2e6d        async_w3.m
+00006570: 6964 646c 6577 6172 655f 6f6e 696f 6e2e  iddleware_onion.
+00006580: 696e 6a65 6374 2845 7874 7261 4461 7461  inject(ExtraData
+00006590: 546f 504f 414d 6964 646c 6577 6172 652c  ToPOAMiddleware,
+000065a0: 2022 706f 6122 2c20 6c61 7965 723d 3029   "poa", layer=0)
+000065b0: 0a20 2020 2020 2020 2065 7874 7261 5f64  .        extra_d
+000065c0: 6174 6120 3d20 6622 3078 7b27 6666 2720  ata = f"0x{'ff' 
+000065d0: 2a20 3333 7d22 0a0a 2020 2020 2020 2020  * 33}"..        
+000065e0: 6173 796e 6320 7769 7468 2072 6571 7565  async with reque
+000065f0: 7374 5f6d 6f63 6b65 7228 0a20 2020 2020  st_mocker(.     
+00006600: 2020 2020 2020 2061 7379 6e63 5f77 332c         async_w3,
+00006610: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
+00006620: 6b5f 7265 7375 6c74 733d 7b22 6574 685f  k_results={"eth_
+00006630: 6765 7442 6c6f 636b 4279 4e75 6d62 6572  getBlockByNumber
+00006640: 223a 207b 2265 7874 7261 4461 7461 223a  ": {"extraData":
+00006650: 2065 7874 7261 5f64 6174 617d 7d2c 0a20   extra_data}},. 
+00006660: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00006670: 2020 2020 2020 626c 6f63 6b20 3d20 6177        block = aw
+00006680: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+00006690: 2e67 6574 5f62 6c6f 636b 2822 6c61 7465  .get_block("late
+000066a0: 7374 2229 0a0a 2020 2020 2020 2020 6173  st")..        as
+000066b0: 7365 7274 2022 6578 7472 6144 6174 6122  sert "extraData"
+000066c0: 206e 6f74 2069 6e20 626c 6f63 6b0a 2020   not in block.  
+000066d0: 2020 2020 2020 6173 7365 7274 2062 6c6f        assert blo
+000066e0: 636b 5b22 7072 6f6f 664f 6641 7574 686f  ck["proofOfAutho
+000066f0: 7269 7479 4461 7461 225d 203d 3d20 746f  rityData"] == to
+00006700: 5f62 7974 6573 2868 6578 7374 723d 6578  _bytes(hexstr=ex
+00006710: 7472 615f 6461 7461 290a 0a20 2020 2020  tra_data)..     
+00006720: 2020 2023 2063 6c65 616e 2075 700a 2020     # clean up.  
+00006730: 2020 2020 2020 6173 796e 635f 7733 2e6d        async_w3.m
+00006740: 6964 646c 6577 6172 655f 6f6e 696f 6e2e  iddleware_onion.
+00006750: 7265 6d6f 7665 2822 706f 6122 290a 0a20  remove("poa").. 
+00006760: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
+00006770: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
+00006780: 6320 6465 6620 7465 7374 5f65 7468 5f73  c def test_eth_s
+00006790: 656e 645f 7261 775f 7472 616e 7361 6374  end_raw_transact
+000067a0: 696f 6e28 7365 6c66 2c20 6173 796e 635f  ion(self, async_
+000067b0: 7733 3a20 2241 7379 6e63 5765 6233 2229  w3: "AsyncWeb3")
+000067c0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+000067d0: 2020 2320 7072 6976 6174 6520 6b65 7920    # private key 
+000067e0: 3078 3363 3261 6234 6538 6631 3761 3764  0x3c2ab4e8f17a7d
+000067f0: 6561 3139 3162 3863 3939 3135 3232 3636  ea191b8c99152266
+00006800: 3031 3236 6436 3831 3033 3935 3039 6463  0126d681039509dc
+00006810: 3362 6233 3161 6637 6339 6264 6236 3335  3bb31af7c9bdb635
+00006820: 3138 0a20 2020 2020 2020 2023 2054 6869  18.        # Thi
+00006830: 7320 6973 2061 6e20 756e 6675 6e64 6564  s is an unfunded
+00006840: 2061 6363 6f75 6e74 2c20 6275 7420 7468   account, but th
+00006850: 6520 7472 616e 7361 6374 696f 6e20 6861  e transaction ha
+00006860: 7320 6120 3020 6761 7320 7072 6963 652c  s a 0 gas price,
+00006870: 2073 6f20 6973 0a20 2020 2020 2020 2023   so is.        #
+00006880: 2076 616c 6964 2e20 4974 206e 6576 6572   valid. It never
+00006890: 206e 6565 6473 2074 6f20 6265 206d 696e   needs to be min
+000068a0: 6564 2c20 7765 206a 7573 7420 7761 6e74  ed, we just want
+000068b0: 2074 6865 2074 7261 6e73 6163 7469 6f6e   the transaction
+000068c0: 2068 6173 6820 6261 636b 0a20 2020 2020   hash back.     
+000068d0: 2020 2023 2074 6f20 636f 6e66 6972 6d2e     # to confirm.
+000068e0: 0a20 2020 2020 2020 2023 2074 7820 3d20  .        # tx = 
+000068f0: 7b27 746f 273a 2027 3078 3030 3030 3030  {'to': '0x000000
+00006900: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00006910: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00006920: 3030 272c 2027 7661 6c75 6527 3a20 302c  00', 'value': 0,
+00006930: 2020 276e 6f6e 6365 273a 2031 2c20 2767    'nonce': 1, 'g
+00006940: 6173 273a 2032 3130 3030 2c20 2767 6173  as': 21000, 'gas
+00006950: 5072 6963 6527 3a20 302c 2027 6368 6169  Price': 0, 'chai
+00006960: 6e49 6427 3a20 3133 3132 3737 3332 3239  nId': 1312773229
+00006970: 3430 3533 377d 2020 2320 6e6f 7161 3a20  40537}  # noqa: 
+00006980: 4535 3031 0a20 2020 2020 2020 2023 204e  E501.        # N
+00006990: 4f54 453a 206e 6f6e 6365 3d31 2074 6f20  OTE: nonce=1 to 
+000069a0: 6d61 6b65 2074 786e 2075 6e69 7175 6520  make txn unique 
+000069b0: 6672 6f6d 2074 6865 206e 6f6e 2d61 7379  from the non-asy
+000069c0: 6e63 2076 6572 7369 6f6e 206f 6620 7468  nc version of th
+000069d0: 6973 2074 6573 740a 2020 2020 2020 2020  is test.        
+000069e0: 7261 775f 7478 6e20 3d20 4865 7842 7974  raw_txn = HexByt
+000069f0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
+00006a00: 2230 7866 3836 3530 3138 3038 3235 3230  "0xf865018082520
+00006a10: 3839 3430 3030 3030 3030 3030 3030 3030  8940000000000000
+00006a20: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00006a30: 3030 3030 3030 3030 3030 3038 3038 3038  0000000000080808
+00006a40: 3665 6563 6163 3436 3665 3131 3561 3066  6eecac466e115a0f
+00006a50: 6664 6434 3264 3764 6565 3461 6338 3534  fdd42d7dee4ac854
+00006a60: 3237 3436 3862 6336 3136 3831 3265 3439  27468bc616812e49
+00006a70: 3433 3265 3238 3565 3465 3866 3563 6439  432e285e4e8f5cd9
+00006a80: 3338 3131 3633 6163 3362 3238 3130 3861  381163ac3b28108a
+00006a90: 3034 6563 3662 3064 3839 6563 6264 3565  04ec6b0d89ecbd5e
+00006aa0: 3839 6230 3339 3966 3333 3661 6435 3066  89b0399f336ad50f
+00006ab0: 3238 3366 6166 6437 3065 3836 3539 3332  283fafd70e865932
+00006ac0: 3530 6266 3561 3261 6466 6239 3364 3137  50bf5a2adfb93d17
+00006ad0: 6522 2020 2320 6e6f 7161 3a20 4535 3031  e"  # noqa: E501
+00006ae0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00006af0: 2020 2065 7870 6563 7465 645f 6861 7368     expected_hash
+00006b00: 203d 2048 6578 5374 7228 0a20 2020 2020   = HexStr(.     
+00006b10: 2020 2020 2020 2022 3078 3532 6230 6666         "0x52b0ff
+00006b20: 3963 6234 3732 6632 3538 3732 6661 3865  9cb472f25872fa8e
+00006b30: 6336 6136 3266 6135 3934 3534 6663 3261  c6a62fa59454fc2a
+00006b40: 6537 3930 3163 6663 6336 6363 3839 6430  e7901cfcc6cc89d0
+00006b50: 3936 6634 3962 3866 6331 220a 2020 2020  96f49b8fc1".    
+00006b60: 2020 2020 290a 2020 2020 2020 2020 7478      ).        tx
+00006b70: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
+00006b80: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
+00006b90: 5f72 6177 5f74 7261 6e73 6163 7469 6f6e  _raw_transaction
+00006ba0: 2872 6177 5f74 786e 290a 2020 2020 2020  (raw_txn).      
+00006bb0: 2020 6173 7365 7274 2074 786e 5f68 6173    assert txn_has
+00006bc0: 6820 3d3d 2061 7379 6e63 5f77 332e 746f  h == async_w3.to
+00006bd0: 5f62 7974 6573 2868 6578 7374 723d 6578  _bytes(hexstr=ex
+00006be0: 7065 6374 6564 5f68 6173 6829 0a0a 2020  pected_hash)..  
+00006bf0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+00006c00: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+00006c10: 2064 6566 2074 6573 745f 4761 7350 7269   def test_GasPri
+00006c20: 6365 5374 7261 7465 6779 4d69 6464 6c65  ceStrategyMiddle
+00006c30: 7761 7265 280a 2020 2020 2020 2020 7365  ware(.        se
+00006c40: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00006c50: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
+00006c60: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+00006c70: 745f 6475 616c 5f74 7970 653a 2043 6865  t_dual_type: Che
+00006c80: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
+00006c90: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00006ca0: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
+00006cb0: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
+00006cc0: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
+00006cd0: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+00006ce0: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+00006cf0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00006d00: 746f 223a 2061 7379 6e63 5f75 6e6c 6f63  to": async_unloc
+00006d10: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+00006d20: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+00006d30: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
+00006d40: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+00006d50: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
+00006d60: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00006d70: 7477 6f5f 6777 6569 5f69 6e5f 7765 6920  two_gwei_in_wei 
+00006d80: 3d20 6173 796e 635f 7733 2e74 6f5f 7765  = async_w3.to_we
+00006d90: 6928 322c 2022 6777 6569 2229 0a0a 2020  i(2, "gwei")..  
+00006da0: 2020 2020 2020 6465 6620 6761 735f 7072        def gas_pr
+00006db0: 6963 655f 7374 7261 7465 6779 2877 333a  ice_strategy(w3:
+00006dc0: 2022 5765 6233 222c 2074 786e 3a20 5478   "Web3", txn: Tx
+00006dd0: 5061 7261 6d73 2920 2d3e 2057 6569 3a0a  Params) -> Wei:.
+00006de0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00006df0: 726e 2074 776f 5f67 7765 695f 696e 5f77  rn two_gwei_in_w
+00006e00: 6569 0a0a 2020 2020 2020 2020 6173 796e  ei..        asyn
+00006e10: 635f 7733 2e65 7468 2e73 6574 5f67 6173  c_w3.eth.set_gas
+00006e20: 5f70 7269 6365 5f73 7472 6174 6567 7928  _price_strategy(
+00006e30: 6761 735f 7072 6963 655f 7374 7261 7465  gas_price_strate
+00006e40: 6779 290a 0a20 2020 2020 2020 2074 786e  gy)..        txn
+00006e50: 5f68 6173 6820 3d20 6177 6169 7420 6173  _hash = await as
+00006e60: 796e 635f 7733 2e65 7468 2e73 656e 645f  ync_w3.eth.send_
+00006e70: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
+00006e80: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+00006e90: 7478 6e20 3d20 6177 6169 7420 6173 796e  txn = await asyn
+00006ea0: 635f 7733 2e65 7468 2e67 6574 5f74 7261  c_w3.eth.get_tra
+00006eb0: 6e73 6163 7469 6f6e 2874 786e 5f68 6173  nsaction(txn_has
+00006ec0: 6829 0a0a 2020 2020 2020 2020 6173 7365  h)..        asse
+00006ed0: 7274 2074 786e 5b22 6761 7350 7269 6365  rt txn["gasPrice
+00006ee0: 225d 203d 3d20 7477 6f5f 6777 6569 5f69  "] == two_gwei_i
+00006ef0: 6e5f 7765 690a 2020 2020 2020 2020 6173  n_wei.        as
+00006f00: 796e 635f 7733 2e65 7468 2e73 6574 5f67  ync_w3.eth.set_g
+00006f10: 6173 5f70 7269 6365 5f73 7472 6174 6567  as_price_strateg
+00006f20: 7928 4e6f 6e65 2920 2023 2072 6573 6574  y(None)  # reset
+00006f30: 2073 7472 6174 6567 790a 0a20 2020 2040   strategy..    @
+00006f40: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+00006f50: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+00006f60: 6620 7465 7374 5f67 6173 5f70 7269 6365  f test_gas_price
+00006f70: 5f73 7472 6174 6567 795f 6d69 6464 6c65  _strategy_middle
+00006f80: 7761 7265 5f68 6578 5f76 616c 7565 280a  ware_hex_value(.
+00006f90: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+00006fa0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00006fb0: 6233 222c 2061 7379 6e63 5f75 6e6c 6f63  b3", async_unloc
+00006fc0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+00006fd0: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+00006fe0: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
+00006ff0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
+00007000: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
+00007010: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
+00007020: 2020 2022 6672 6f6d 223a 2061 7379 6e63     "from": async
+00007030: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+00007040: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
+00007050: 2020 2020 2020 2020 2022 746f 223a 2061           "to": a
+00007060: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+00007070: 636f 756e 745f 6475 616c 5f74 7970 652c  count_dual_type,
+00007080: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
+00007090: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
+000070a0: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
+000070b0: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
+000070c0: 7d0a 2020 2020 2020 2020 7477 6f5f 6777  }.        two_gw
+000070d0: 6569 5f69 6e5f 7765 6920 3d20 6173 796e  ei_in_wei = asyn
+000070e0: 635f 7733 2e74 6f5f 7765 6928 322c 2022  c_w3.to_wei(2, "
+000070f0: 6777 6569 2229 0a0a 2020 2020 2020 2020  gwei")..        
+00007100: 6465 6620 6761 735f 7072 6963 655f 7374  def gas_price_st
+00007110: 7261 7465 6779 285f 7733 3a20 2257 6562  rategy(_w3: "Web
+00007120: 3322 2c20 5f74 786e 3a20 5478 5061 7261  3", _txn: TxPara
+00007130: 6d73 2920 2d3e 2073 7472 3a0a 2020 2020  ms) -> str:.    
+00007140: 2020 2020 2020 2020 7265 7475 726e 2068          return h
+00007150: 6578 2874 776f 5f67 7765 695f 696e 5f77  ex(two_gwei_in_w
+00007160: 6569 290a 0a20 2020 2020 2020 2061 7379  ei)..        asy
+00007170: 6e63 5f77 332e 6574 682e 7365 745f 6761  nc_w3.eth.set_ga
+00007180: 735f 7072 6963 655f 7374 7261 7465 6779  s_price_strategy
+00007190: 2867 6173 5f70 7269 6365 5f73 7472 6174  (gas_price_strat
+000071a0: 6567 7929 2020 2320 7479 7065 3a20 6967  egy)  # type: ig
+000071b0: 6e6f 7265 0a0a 2020 2020 2020 2020 7478  nore..        tx
+000071c0: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
+000071d0: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
+000071e0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+000071f0: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
+00007200: 2074 786e 203d 2061 7761 6974 2061 7379   txn = await asy
+00007210: 6e63 5f77 332e 6574 682e 6765 745f 7472  nc_w3.eth.get_tr
+00007220: 616e 7361 6374 696f 6e28 7478 6e5f 6861  ansaction(txn_ha
+00007230: 7368 290a 0a20 2020 2020 2020 2061 7373  sh)..        ass
+00007240: 6572 7420 7478 6e5b 2267 6173 5072 6963  ert txn["gasPric
+00007250: 6522 5d20 3d3d 2074 776f 5f67 7765 695f  e"] == two_gwei_
+00007260: 696e 5f77 6569 0a20 2020 2020 2020 2061  in_wei.        a
+00007270: 7379 6e63 5f77 332e 6574 682e 7365 745f  sync_w3.eth.set_
+00007280: 6761 735f 7072 6963 655f 7374 7261 7465  gas_price_strate
+00007290: 6779 284e 6f6e 6529 2020 2320 7265 7365  gy(None)  # rese
+000072a0: 7420 7374 7261 7465 6779 0a0a 2020 2020  t strategy..    
+000072b0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+000072c0: 6e63 696f 0a20 2020 2040 7079 7465 7374  ncio.    @pytest
+000072d0: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
+000072e0: 6528 0a20 2020 2020 2020 2022 6d61 785f  e(.        "max_
+000072f0: 6665 6522 2c20 2831 3030 3030 3030 3030  fee", (100000000
+00007300: 302c 204e 6f6e 6529 2c20 6964 733d 5b22  0, None), ids=["
+00007310: 7769 7468 5f6d 6178 5f66 6565 222c 2022  with_max_fee", "
+00007320: 7769 7468 6f75 745f 6d61 785f 6665 6522  without_max_fee"
+00007330: 5d0a 2020 2020 290a 2020 2020 6173 796e  ].    ).    asyn
+00007340: 6320 6465 6620 7465 7374 5f67 6173 5f70  c def test_gas_p
+00007350: 7269 6365 5f66 726f 6d5f 7374 7261 7465  rice_from_strate
+00007360: 6779 5f62 7970 6173 7365 645f 666f 725f  gy_bypassed_for_
+00007370: 6479 6e61 6d69 635f 6665 655f 7478 6e28  dynamic_fee_txn(
+00007380: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00007390: 2020 2020 2020 2061 7379 6e63 5f77 333a         async_w3:
+000073a0: 2022 4173 796e 6357 6562 3322 2c0a 2020   "AsyncWeb3",.  
+000073b0: 2020 2020 2020 6173 796e 635f 756e 6c6f        async_unlo
+000073c0: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+000073d0: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
+000073e0: 4164 6472 6573 732c 0a20 2020 2020 2020  Address,.       
+000073f0: 206d 6178 5f66 6565 3a20 5765 692c 0a20   max_fee: Wei,. 
+00007400: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00007410: 2020 2020 2020 6d61 785f 7072 696f 7269        max_priori
+00007420: 7479 5f66 6565 203d 2061 7379 6e63 5f77  ty_fee = async_w
+00007430: 332e 746f 5f77 6569 2831 2c20 2267 7765  3.to_wei(1, "gwe
+00007440: 6922 290a 2020 2020 2020 2020 7478 6e5f  i").        txn_
+00007450: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
+00007460: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00007470: 2022 6672 6f6d 223a 2061 7379 6e63 5f75   "from": async_u
+00007480: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+00007490: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+000074a0: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
+000074b0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+000074c0: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
+000074d0: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+000074e0: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+000074f0: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
+00007500: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
+00007510: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
+00007520: 6550 6572 4761 7322 3a20 6d61 785f 7072  ePerGas": max_pr
+00007530: 696f 7269 7479 5f66 6565 2c0a 2020 2020  iority_fee,.    
+00007540: 2020 2020 7d0a 2020 2020 2020 2020 6966      }.        if
+00007550: 206d 6178 5f66 6565 2069 7320 6e6f 7420   max_fee is not 
+00007560: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00007570: 2020 7478 6e5f 7061 7261 6d73 203d 2061    txn_params = a
+00007580: 7373 6f63 2874 786e 5f70 6172 616d 732c  ssoc(txn_params,
+00007590: 2022 6d61 7846 6565 5065 7247 6173 222c   "maxFeePerGas",
+000075a0: 206d 6178 5f66 6565 290a 0a20 2020 2020   max_fee)..     
+000075b0: 2020 2064 6566 2067 6173 5f70 7269 6365     def gas_price
+000075c0: 5f73 7472 6174 6567 7928 7733 3a20 2257  _strategy(w3: "W
+000075d0: 6562 3322 2c20 7478 6e3a 2054 7850 6172  eb3", txn: TxPar
+000075e0: 616d 7329 202d 3e20 5765 693a 0a20 2020  ams) -> Wei:.   
+000075f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00007600: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
+00007610: 322c 2022 6777 6569 2229 0a0a 2020 2020  2, "gwei")..    
+00007620: 2020 2020 6173 796e 635f 7733 2e65 7468      async_w3.eth
+00007630: 2e73 6574 5f67 6173 5f70 7269 6365 5f73  .set_gas_price_s
+00007640: 7472 6174 6567 7928 6761 735f 7072 6963  trategy(gas_pric
+00007650: 655f 7374 7261 7465 6779 290a 0a20 2020  e_strategy)..   
+00007660: 2020 2020 2074 786e 5f68 6173 6820 3d20       txn_hash = 
+00007670: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00007680: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
+00007690: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
+000076a0: 2020 2020 2020 2020 7478 6e20 3d20 6177          txn = aw
 000076b0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-000076c0: 2e67 6574 5f62 6c6f 636b 2822 6c61 7465  .get_block("late
-000076d0: 7374 2229 0a20 2020 2020 2020 2061 7373  st").        ass
-000076e0: 6572 7420 280a 2020 2020 2020 2020 2020  ert (.          
-000076f0: 2020 7478 6e5b 226d 6178 4665 6550 6572    txn["maxFeePer
-00007700: 4761 7322 5d20 3d3d 206d 6178 5f66 6565  Gas"] == max_fee
-00007710: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00007720: 6d61 785f 6665 6520 6973 206e 6f74 204e  max_fee is not N
-00007730: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-00007740: 656c 7365 2032 202a 206c 6174 6573 745f  else 2 * latest_
-00007750: 626c 6f63 6b5b 2262 6173 6546 6565 5065  block["baseFeePe
-00007760: 7247 6173 225d 202b 206d 6178 5f70 7269  rGas"] + max_pri
-00007770: 6f72 6974 795f 6665 650a 2020 2020 2020  ority_fee.      
-00007780: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
-00007790: 7274 2074 786e 5b22 6d61 7850 7269 6f72  rt txn["maxPrior
-000077a0: 6974 7946 6565 5065 7247 6173 225d 203d  ityFeePerGas"] =
-000077b0: 3d20 6d61 785f 7072 696f 7269 7479 5f66  = max_priority_f
-000077c0: 6565 0a20 2020 2020 2020 2061 7373 6572  ee.        asser
-000077d0: 7420 7478 6e5b 2267 6173 5072 6963 6522  t txn["gasPrice"
-000077e0: 5d20 3d3d 2074 786e 5b22 6d61 7846 6565  ] == txn["maxFee
-000077f0: 5065 7247 6173 225d 0a0a 2020 2020 2020  PerGas"]..      
-00007800: 2020 6173 796e 635f 7733 2e65 7468 2e73    async_w3.eth.s
-00007810: 6574 5f67 6173 5f70 7269 6365 5f73 7472  et_gas_price_str
-00007820: 6174 6567 7928 4e6f 6e65 2920 2023 2072  ategy(None)  # r
-00007830: 6573 6574 2073 7472 6174 6567 790a 0a20  eset strategy.. 
-00007840: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-00007850: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-00007860: 6320 6465 6620 7465 7374 5f67 6173 5f70  c def test_gas_p
-00007870: 7269 6365 5f66 726f 6d5f 7374 7261 7465  rice_from_strate
-00007880: 6779 5f62 7970 6173 7365 645f 666f 725f  gy_bypassed_for_
-00007890: 6479 6e61 6d69 635f 6665 655f 7478 6e5f  dynamic_fee_txn_
-000078a0: 6e6f 5f74 6970 280a 2020 2020 2020 2020  no_tip(.        
-000078b0: 7365 6c66 2c0a 2020 2020 2020 2020 6173  self,.        as
-000078c0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
-000078d0: 6233 222c 0a20 2020 2020 2020 2061 7379  b3",.        asy
-000078e0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
-000078f0: 756e 745f 6475 616c 5f74 7970 653a 2043  unt_dual_type: C
-00007900: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
-00007910: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00007920: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00007930: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-00007940: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-00007950: 6d22 3a20 6173 796e 635f 756e 6c6f 636b  m": async_unlock
-00007960: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
-00007970: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00007980: 2020 2274 6f22 3a20 6173 796e 635f 756e    "to": async_un
-00007990: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-000079a0: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-000079b0: 2020 2020 2020 2276 616c 7565 223a 2057        "value": W
-000079c0: 6569 2831 292c 0a20 2020 2020 2020 2020  ei(1),.         
-000079d0: 2020 2022 6761 7322 3a20 3231 3030 302c     "gas": 21000,
-000079e0: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
-000079f0: 7846 6565 5065 7247 6173 223a 2057 6569  xFeePerGas": Wei
-00007a00: 2831 3030 3030 3030 3030 3029 2c0a 2020  (1000000000),.  
-00007a10: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
-00007a20: 2064 6566 2067 6173 5f70 7269 6365 5f73   def gas_price_s
-00007a30: 7472 6174 6567 7928 5f77 333a 2022 5765  trategy(_w3: "We
-00007a40: 6233 222c 205f 7478 6e3a 2054 7850 6172  b3", _txn: TxPar
-00007a50: 616d 7329 202d 3e20 5765 693a 0a20 2020  ams) -> Wei:.   
-00007a60: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00007a70: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-00007a80: 322c 2022 6777 6569 2229 0a0a 2020 2020  2, "gwei")..    
-00007a90: 2020 2020 6173 796e 635f 7733 2e65 7468      async_w3.eth
-00007aa0: 2e73 6574 5f67 6173 5f70 7269 6365 5f73  .set_gas_price_s
-00007ab0: 7472 6174 6567 7928 6761 735f 7072 6963  trategy(gas_pric
-00007ac0: 655f 7374 7261 7465 6779 290a 0a20 2020  e_strategy)..   
-00007ad0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-00007ae0: 2e72 6169 7365 7328 0a20 2020 2020 2020  .raises(.       
-00007af0: 2020 2020 2049 6e76 616c 6964 5472 616e       InvalidTran
-00007b00: 7361 6374 696f 6e2c 206d 6174 6368 3d22  saction, match="
-00007b10: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-00007b20: 7247 6173 206d 7573 7420 6265 2064 6566  rGas must be def
-00007b30: 696e 6564 220a 2020 2020 2020 2020 293a  ined".        ):
-00007b40: 0a20 2020 2020 2020 2020 2020 2061 7761  .            awa
-00007b50: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00007b60: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-00007b70: 2874 786e 5f70 6172 616d 7329 0a0a 2020  (txn_params)..  
-00007b80: 2020 2020 2020 6173 796e 635f 7733 2e65        async_w3.e
-00007b90: 7468 2e73 6574 5f67 6173 5f70 7269 6365  th.set_gas_price
-00007ba0: 5f73 7472 6174 6567 7928 4e6f 6e65 2920  _strategy(None) 
-00007bb0: 2023 2072 6573 6574 2073 7472 6174 6567   # reset strateg
-00007bc0: 790a 0a20 2020 2040 7079 7465 7374 2e6d  y..    @pytest.m
-00007bd0: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-00007be0: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-00007bf0: 7468 5f65 7374 696d 6174 655f 6761 7328  th_estimate_gas(
-00007c00: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
-00007c10: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-00007c20: 6562 3322 2c20 6173 796e 635f 756e 6c6f  eb3", async_unlo
-00007c30: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-00007c40: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-00007c50: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-00007c60: 204e 6f6e 653a 0a20 2020 2020 2020 2067   None:.        g
-00007c70: 6173 5f65 7374 696d 6174 6520 3d20 6177  as_estimate = aw
-00007c80: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00007c90: 2e65 7374 696d 6174 655f 6761 7328 0a20  .estimate_gas(. 
-00007ca0: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-00007cb0: 2020 2020 2020 2020 2020 2020 2022 6672               "fr
-00007cc0: 6f6d 223a 2061 7379 6e63 5f75 6e6c 6f63  om": async_unloc
-00007cd0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-00007ce0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-00007cf0: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
-00007d00: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
-00007d10: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
-00007d20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00007d30: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
-00007d40: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00007d50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00007d60: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
-00007d70: 7228 6761 735f 6573 7469 6d61 7465 290a  r(gas_estimate).
-00007d80: 2020 2020 2020 2020 6173 7365 7274 2067          assert g
-00007d90: 6173 5f65 7374 696d 6174 6520 3e20 300a  as_estimate > 0.
-00007da0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-00007db0: 6b2e 6173 796e 6369 6f0a 2020 2020 4070  k.asyncio.    @p
-00007dc0: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-00007dd0: 6574 7269 7a65 280a 2020 2020 2020 2020  etrize(.        
-00007de0: 2270 6172 616d 7322 2c0a 2020 2020 2020  "params",.      
-00007df0: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-00007e00: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00007e10: 2020 226e 6f6e 6365 223a 2031 2c20 2023    "nonce": 1,  #
-00007e20: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
-00007e30: 2020 2020 2022 6261 6c61 6e63 6522 3a20       "balance": 
-00007e40: 312c 2020 2320 696e 740a 2020 2020 2020  1,  # int.      
-00007e50: 2020 2020 2020 2020 2020 2263 6f64 6522            "code"
-00007e60: 3a20 4865 7853 7472 2822 3078 2229 2c20  : HexStr("0x"), 
-00007e70: 2023 2048 6578 5374 720a 2020 2020 2020   # HexStr.      
-00007e80: 2020 2020 2020 2020 2020 2320 7769 7468            # with
-00007e90: 2073 7461 7465 0a20 2020 2020 2020 2020   state.         
-00007ea0: 2020 2020 2020 2022 7374 6174 6522 3a20         "state": 
-00007eb0: 7b48 6578 5374 7228 6622 3078 7b27 3030  {HexStr(f"0x{'00
-00007ec0: 2720 2a20 3332 7d22 293a 2048 6578 5374  ' * 32}"): HexSt
-00007ed0: 7228 6622 3078 7b27 3030 2720 2a20 3332  r(f"0x{'00' * 32
-00007ee0: 7d22 297d 2c0a 2020 2020 2020 2020 2020  }")},.          
-00007ef0: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-00007f00: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00007f10: 2020 2022 6e6f 6e63 6522 3a20 4865 7853     "nonce": HexS
-00007f20: 7472 2822 3078 3122 292c 2020 2320 4865  tr("0x1"),  # He
-00007f30: 7853 7472 0a20 2020 2020 2020 2020 2020  xStr.           
-00007f40: 2020 2020 2022 6261 6c61 6e63 6522 3a20       "balance": 
-00007f50: 4865 7853 7472 2822 3078 3122 292c 2020  HexStr("0x1"),  
-00007f60: 2320 4865 7853 7472 0a20 2020 2020 2020  # HexStr.       
-00007f70: 2020 2020 2020 2020 2022 636f 6465 223a           "code":
-00007f80: 2062 225c 7830 3022 2c20 2023 2062 7974   b"\x00",  # byt
-00007f90: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
-00007fa0: 2020 2023 2077 6974 6820 7374 6174 6544     # with stateD
-00007fb0: 6966 660a 2020 2020 2020 2020 2020 2020  iff.            
-00007fc0: 2020 2020 2273 7461 7465 4469 6666 223a      "stateDiff":
-00007fd0: 207b 4865 7853 7472 2866 2230 787b 2730   {HexStr(f"0x{'0
-00007fe0: 3027 202a 2033 327d 2229 3a20 4865 7853  0' * 32}"): HexS
-00007ff0: 7472 2866 2230 787b 2730 3027 202a 2033  tr(f"0x{'00' * 3
-00008000: 327d 2229 7d2c 0a20 2020 2020 2020 2020  2}")},.         
-00008010: 2020 207d 2c0a 2020 2020 2020 2020 292c     },.        ),
-00008020: 0a20 2020 2029 0a20 2020 2061 7379 6e63  .    ).    async
-00008030: 2064 6566 2074 6573 745f 6574 685f 6573   def test_eth_es
-00008040: 7469 6d61 7465 5f67 6173 5f77 6974 685f  timate_gas_with_
-00008050: 6f76 6572 7269 6465 5f70 6172 616d 5f74  override_param_t
-00008060: 7970 655f 6368 6563 6b28 0a20 2020 2020  ype_check(.     
-00008070: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00008080: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-00008090: 6357 6562 3322 2c0a 2020 2020 2020 2020  cWeb3",.        
-000080a0: 6173 796e 635f 6d61 7468 5f63 6f6e 7472  async_math_contr
-000080b0: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
-000080c0: 0a20 2020 2020 2020 2070 6172 616d 733a  .        params:
-000080d0: 2053 7461 7465 4f76 6572 7269 6465 5061   StateOverridePa
-000080e0: 7261 6d73 2c0a 2020 2020 2920 2d3e 204e  rams,.    ) -> N
-000080f0: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
-00008100: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-00008110: 7320 3d20 7b22 6672 6f6d 223a 2061 7761  s = {"from": awa
-00008120: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00008130: 636f 696e 6261 7365 7d0a 0a20 2020 2020  coinbase}..     
-00008140: 2020 2023 2061 7373 6572 7420 646f 6573     # assert does
-00008150: 206e 6f74 2072 6169 7365 0a20 2020 2020   not raise.     
-00008160: 2020 2061 7761 6974 2061 7379 6e63 5f77     await async_w
-00008170: 332e 6574 682e 6573 7469 6d61 7465 5f67  3.eth.estimate_g
-00008180: 6173 280a 2020 2020 2020 2020 2020 2020  as(.            
-00008190: 7478 6e5f 7061 7261 6d73 2c20 4e6f 6e65  txn_params, None
-000081a0: 2c20 7b61 7379 6e63 5f6d 6174 685f 636f  , {async_math_co
-000081b0: 6e74 7261 6374 2e61 6464 7265 7373 3a20  ntract.address: 
-000081c0: 7061 7261 6d73 7d0a 2020 2020 2020 2020  params}.        
-000081d0: 290a 0a20 2020 2040 7079 7465 7374 2e6d  )..    @pytest.m
-000081e0: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-000081f0: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-00008200: 7468 5f66 6565 5f68 6973 746f 7279 2873  th_fee_history(s
-00008210: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
-00008220: 4173 796e 6357 6562 3322 2920 2d3e 204e  AsyncWeb3") -> N
-00008230: 6f6e 653a 0a20 2020 2020 2020 2066 6565  one:.        fee
-00008240: 5f68 6973 746f 7279 203d 2061 7761 6974  _history = await
-00008250: 2061 7379 6e63 5f77 332e 6574 682e 6665   async_w3.eth.fe
-00008260: 655f 6869 7374 6f72 7928 312c 2022 6c61  e_history(1, "la
-00008270: 7465 7374 222c 205b 3530 5d29 0a20 2020  test", [50]).   
-00008280: 2020 2020 2061 7373 6572 7420 6973 5f6c       assert is_l
-00008290: 6973 745f 6c69 6b65 2866 6565 5f68 6973  ist_like(fee_his
-000082a0: 746f 7279 5b22 6261 7365 4665 6550 6572  tory["baseFeePer
-000082b0: 4761 7322 5d29 0a20 2020 2020 2020 2061  Gas"]).        a
-000082c0: 7373 6572 7420 6973 5f6c 6973 745f 6c69  ssert is_list_li
-000082d0: 6b65 2866 6565 5f68 6973 746f 7279 5b22  ke(fee_history["
-000082e0: 6761 7355 7365 6452 6174 696f 225d 290a  gasUsedRatio"]).
-000082f0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00008300: 735f 696e 7465 6765 7228 6665 655f 6869  s_integer(fee_hi
-00008310: 7374 6f72 795b 226f 6c64 6573 7442 6c6f  story["oldestBlo
-00008320: 636b 225d 290a 2020 2020 2020 2020 6173  ck"]).        as
-00008330: 7365 7274 2066 6565 5f68 6973 746f 7279  sert fee_history
-00008340: 5b22 6f6c 6465 7374 426c 6f63 6b22 5d20  ["oldestBlock"] 
-00008350: 3e3d 2030 0a20 2020 2020 2020 2061 7373  >= 0.        ass
-00008360: 6572 7420 6973 5f6c 6973 745f 6c69 6b65  ert is_list_like
-00008370: 2866 6565 5f68 6973 746f 7279 5b22 7265  (fee_history["re
-00008380: 7761 7264 225d 290a 2020 2020 2020 2020  ward"]).        
-00008390: 6966 206c 656e 2866 6565 5f68 6973 746f  if len(fee_histo
-000083a0: 7279 5b22 7265 7761 7264 225d 2920 3e20  ry["reward"]) > 
-000083b0: 303a 0a20 2020 2020 2020 2020 2020 2061  0:.            a
-000083c0: 7373 6572 7420 6973 5f6c 6973 745f 6c69  ssert is_list_li
-000083d0: 6b65 2866 6565 5f68 6973 746f 7279 5b22  ke(fee_history["
-000083e0: 7265 7761 7264 225d 5b30 5d29 0a0a 2020  reward"][0])..  
-000083f0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-00008400: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-00008410: 2064 6566 2074 6573 745f 6574 685f 6665   def test_eth_fe
-00008420: 655f 6869 7374 6f72 795f 7769 7468 5f69  e_history_with_i
-00008430: 6e74 6567 6572 280a 2020 2020 2020 2020  nteger(.        
-00008440: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-00008450: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
-00008460: 6e63 5f65 6d70 7479 5f62 6c6f 636b 3a20  nc_empty_block: 
-00008470: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
-00008480: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00008490: 2066 6565 5f68 6973 746f 7279 203d 2061   fee_history = a
-000084a0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-000084b0: 682e 6665 655f 6869 7374 6f72 7928 0a20  h.fee_history(. 
-000084c0: 2020 2020 2020 2020 2020 2031 2c20 6173             1, as
-000084d0: 796e 635f 656d 7074 795f 626c 6f63 6b5b  ync_empty_block[
-000084e0: 226e 756d 6265 7222 5d2c 205b 3530 5d0a  "number"], [50].
-000084f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00008500: 2020 6173 7365 7274 2069 735f 6c69 7374    assert is_list
-00008510: 5f6c 696b 6528 6665 655f 6869 7374 6f72  _like(fee_histor
-00008520: 795b 2262 6173 6546 6565 5065 7247 6173  y["baseFeePerGas
-00008530: 225d 290a 2020 2020 2020 2020 6173 7365  "]).        asse
-00008540: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
-00008550: 6665 655f 6869 7374 6f72 795b 2267 6173  fee_history["gas
-00008560: 5573 6564 5261 7469 6f22 5d29 0a20 2020  UsedRatio"]).   
-00008570: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
-00008580: 6e74 6567 6572 2866 6565 5f68 6973 746f  nteger(fee_histo
-00008590: 7279 5b22 6f6c 6465 7374 426c 6f63 6b22  ry["oldestBlock"
-000085a0: 5d29 0a20 2020 2020 2020 2061 7373 6572  ]).        asser
-000085b0: 7420 6665 655f 6869 7374 6f72 795b 226f  t fee_history["o
-000085c0: 6c64 6573 7442 6c6f 636b 225d 203e 3d20  ldestBlock"] >= 
-000085d0: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
-000085e0: 2069 735f 6c69 7374 5f6c 696b 6528 6665   is_list_like(fe
-000085f0: 655f 6869 7374 6f72 795b 2272 6577 6172  e_history["rewar
-00008600: 6422 5d29 0a20 2020 2020 2020 2069 6620  d"]).        if 
-00008610: 6c65 6e28 6665 655f 6869 7374 6f72 795b  len(fee_history[
-00008620: 2272 6577 6172 6422 5d29 203e 2030 3a0a  "reward"]) > 0:.
-00008630: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00008640: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
-00008650: 6665 655f 6869 7374 6f72 795b 2272 6577  fee_history["rew
-00008660: 6172 6422 5d5b 305d 290a 0a20 2020 2040  ard"][0])..    @
-00008670: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-00008680: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-00008690: 6620 7465 7374 5f65 7468 5f66 6565 5f68  f test_eth_fee_h
-000086a0: 6973 746f 7279 5f6e 6f5f 7265 7761 7264  istory_no_reward
-000086b0: 5f70 6572 6365 6e74 696c 6573 280a 2020  _percentiles(.  
-000086c0: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
-000086d0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-000086e0: 220a 2020 2020 2920 2d3e 204e 6f6e 653a  ".    ) -> None:
-000086f0: 0a20 2020 2020 2020 2066 6565 5f68 6973  .        fee_his
-00008700: 746f 7279 203d 2061 7761 6974 2061 7379  tory = await asy
-00008710: 6e63 5f77 332e 6574 682e 6665 655f 6869  nc_w3.eth.fee_hi
-00008720: 7374 6f72 7928 312c 2022 6c61 7465 7374  story(1, "latest
-00008730: 2229 0a20 2020 2020 2020 2061 7373 6572  ").        asser
-00008740: 7420 6973 5f6c 6973 745f 6c69 6b65 2866  t is_list_like(f
-00008750: 6565 5f68 6973 746f 7279 5b22 6261 7365  ee_history["base
-00008760: 4665 6550 6572 4761 7322 5d29 0a20 2020  FeePerGas"]).   
-00008770: 2020 2020 2061 7373 6572 7420 6973 5f6c       assert is_l
-00008780: 6973 745f 6c69 6b65 2866 6565 5f68 6973  ist_like(fee_his
-00008790: 746f 7279 5b22 6761 7355 7365 6452 6174  tory["gasUsedRat
-000087a0: 696f 225d 290a 2020 2020 2020 2020 6173  io"]).        as
-000087b0: 7365 7274 2069 735f 696e 7465 6765 7228  sert is_integer(
-000087c0: 6665 655f 6869 7374 6f72 795b 226f 6c64  fee_history["old
-000087d0: 6573 7442 6c6f 636b 225d 290a 2020 2020  estBlock"]).    
-000087e0: 2020 2020 6173 7365 7274 2066 6565 5f68      assert fee_h
-000087f0: 6973 746f 7279 5b22 6f6c 6465 7374 426c  istory["oldestBl
-00008800: 6f63 6b22 5d20 3e3d 2030 0a0a 2020 2020  ock"] >= 0..    
-00008810: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-00008820: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-00008830: 6566 2074 6573 745f 6574 685f 6d61 785f  ef test_eth_max_
-00008840: 7072 696f 7269 7479 5f66 6565 2873 656c  priority_fee(sel
-00008850: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-00008860: 796e 6357 6562 3322 2920 2d3e 204e 6f6e  yncWeb3") -> Non
-00008870: 653a 0a20 2020 2020 2020 206d 6178 5f70  e:.        max_p
-00008880: 7269 6f72 6974 795f 6665 6520 3d20 6177  riority_fee = aw
-00008890: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-000088a0: 2e6d 6178 5f70 7269 6f72 6974 795f 6665  .max_priority_fe
-000088b0: 650a 2020 2020 2020 2020 6173 7365 7274  e.        assert
-000088c0: 2069 735f 696e 7465 6765 7228 6d61 785f   is_integer(max_
-000088d0: 7072 696f 7269 7479 5f66 6565 290a 0a20  priority_fee).. 
-000088e0: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-000088f0: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-00008900: 6320 6465 6620 7465 7374 5f65 7468 5f6d  c def test_eth_m
-00008910: 6178 5f70 7269 6f72 6974 795f 6665 655f  ax_priority_fee_
-00008920: 7769 7468 5f66 6565 5f68 6973 746f 7279  with_fee_history
-00008930: 5f63 616c 6375 6c61 7469 6f6e 280a 2020  _calculation(.  
-00008940: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
-00008950: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-00008960: 222c 2072 6571 7565 7374 5f6d 6f63 6b65  ", request_mocke
-00008970: 723a 2054 7970 655b 5265 7175 6573 744d  r: Type[RequestM
-00008980: 6f63 6b65 725d 0a20 2020 2029 202d 3e20  ocker].    ) -> 
-00008990: 4e6f 6e65 3a0a 2020 2020 2020 2020 6173  None:.        as
-000089a0: 796e 6320 7769 7468 2072 6571 7565 7374  ync with request
-000089b0: 5f6d 6f63 6b65 7228 0a20 2020 2020 2020  _mocker(.       
-000089c0: 2020 2020 2061 7379 6e63 5f77 332c 0a20       async_w3,. 
-000089d0: 2020 2020 2020 2020 2020 206d 6f63 6b5f             mock_
-000089e0: 6572 726f 7273 3d7b 5250 4345 6e64 706f  errors={RPCEndpo
-000089f0: 696e 7428 2265 7468 5f6d 6178 5072 696f  int("eth_maxPrio
-00008a00: 7269 7479 4665 6550 6572 4761 7322 293a  rityFeePerGas"):
-00008a10: 207b 7d7d 2c0a 2020 2020 2020 2020 2020   {}},.          
-00008a20: 2020 6d6f 636b 5f72 6573 756c 7473 3d7b    mock_results={
-00008a30: 5250 4345 6e64 706f 696e 7428 2265 7468  RPCEndpoint("eth
-00008a40: 5f66 6565 4869 7374 6f72 7922 293a 207b  _feeHistory"): {
-00008a50: 2272 6577 6172 6422 3a20 5b5b 305d 5d7d  "reward": [[0]]}
-00008a60: 7d2c 0a20 2020 2020 2020 2029 3a0a 2020  },.        ):.  
-00008a70: 2020 2020 2020 2020 2020 7769 7468 2070            with p
-00008a80: 7974 6573 742e 7761 726e 7328 0a20 2020  ytest.warns(.   
-00008a90: 2020 2020 2020 2020 2020 2020 2055 7365               Use
-00008aa0: 7257 6172 6e69 6e67 2c0a 2020 2020 2020  rWarning,.      
-00008ab0: 2020 2020 2020 2020 2020 6d61 7463 683d            match=
-00008ac0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00008ad0: 2020 2020 2020 2254 6865 7265 2077 6173        "There was
-00008ae0: 2061 6e20 6973 7375 6520 7769 7468 2074   an issue with t
-00008af0: 6865 206d 6574 686f 6420 6574 685f 6d61  he method eth_ma
-00008b00: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-00008b10: 6173 2e20 220a 2020 2020 2020 2020 2020  as. ".          
-00008b20: 2020 2020 2020 2020 2020 2243 616c 6375            "Calcu
-00008b30: 6c61 7469 6e67 2075 7369 6e67 2065 7468  lating using eth
-00008b40: 5f66 6565 4869 7374 6f72 792e 220a 2020  _feeHistory.".  
-00008b50: 2020 2020 2020 2020 2020 2020 2020 292c                ),
-00008b60: 0a20 2020 2020 2020 2020 2020 2029 3a0a  .            ):.
-00008b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b80: 7072 696f 7269 7479 5f66 6565 203d 2061  priority_fee = a
-00008b90: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00008ba0: 682e 6d61 785f 7072 696f 7269 7479 5f66  h.max_priority_f
-00008bb0: 6565 0a20 2020 2020 2020 2020 2020 2020  ee.             
-00008bc0: 2020 2061 7373 6572 7420 6973 5f69 6e74     assert is_int
-00008bd0: 6567 6572 2870 7269 6f72 6974 795f 6665  eger(priority_fe
-00008be0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00008bf0: 2020 2061 7373 6572 7420 7072 696f 7269     assert priori
-00008c00: 7479 5f66 6565 203d 3d20 5052 494f 5249  ty_fee == PRIORI
-00008c10: 5459 5f46 4545 5f4d 494e 0a0a 2020 2020  TY_FEE_MIN..    
-00008c20: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-00008c30: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-00008c40: 6566 2074 6573 745f 6574 685f 6765 7442  ef test_eth_getB
-00008c50: 6c6f 636b 4279 4861 7368 280a 2020 2020  lockByHash(.    
-00008c60: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
-00008c70: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
-00008c80: 2061 7379 6e63 5f65 6d70 7479 5f62 6c6f   async_empty_blo
-00008c90: 636b 3a20 426c 6f63 6b44 6174 610a 2020  ck: BlockData.  
-00008ca0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00008cb0: 2020 2020 2062 6c6f 636b 203d 2061 7761       block = awa
-00008cc0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00008cd0: 6765 745f 626c 6f63 6b28 6173 796e 635f  get_block(async_
-00008ce0: 656d 7074 795f 626c 6f63 6b5b 2268 6173  empty_block["has
-00008cf0: 6822 5d29 0a20 2020 2020 2020 2061 7373  h"]).        ass
-00008d00: 6572 7420 626c 6f63 6b5b 2268 6173 6822  ert block["hash"
-00008d10: 5d20 3d3d 2061 7379 6e63 5f65 6d70 7479  ] == async_empty
-00008d20: 5f62 6c6f 636b 5b22 6861 7368 225d 0a0a  _block["hash"]..
-00008d30: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00008d40: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-00008d50: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
-00008d60: 6765 7442 6c6f 636b 4279 4861 7368 5f6e  getBlockByHash_n
-00008d70: 6f74 5f66 6f75 6e64 2873 656c 662c 2061  ot_found(self, a
-00008d80: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-00008d90: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
-00008da0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-00008db0: 7374 2e72 6169 7365 7328 426c 6f63 6b4e  st.raises(BlockN
-00008dc0: 6f74 466f 756e 6429 3a0a 2020 2020 2020  otFound):.      
-00008dd0: 2020 2020 2020 6177 6169 7420 6173 796e        await asyn
-00008de0: 635f 7733 2e65 7468 2e67 6574 5f62 6c6f  c_w3.eth.get_blo
-00008df0: 636b 2855 4e4b 4e4f 574e 5f48 4153 4829  ck(UNKNOWN_HASH)
-00008e00: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-00008e10: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-00008e20: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
-00008e30: 685f 6765 7442 6c6f 636b 4279 4861 7368  h_getBlockByHash
-00008e40: 5f70 656e 6469 6e67 2873 656c 662c 2061  _pending(self, a
-00008e50: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-00008e60: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
-00008e70: 2020 2020 2020 2062 6c6f 636b 203d 2061         block = a
-00008e80: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00008e90: 682e 6765 745f 626c 6f63 6b28 2270 656e  h.get_block("pen
-00008ea0: 6469 6e67 2229 0a20 2020 2020 2020 2061  ding").        a
-00008eb0: 7373 6572 7420 626c 6f63 6b5b 2268 6173  ssert block["has
-00008ec0: 6822 5d20 6973 204e 6f6e 650a 0a20 2020  h"] is None..   
-00008ed0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-00008ee0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-00008ef0: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-00008f00: 426c 6f63 6b42 794e 756d 6265 725f 7769  BlockByNumber_wi
-00008f10: 7468 5f69 6e74 6567 6572 280a 2020 2020  th_integer(.    
-00008f20: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
-00008f30: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
-00008f40: 2061 7379 6e63 5f65 6d70 7479 5f62 6c6f   async_empty_blo
-00008f50: 636b 3a20 426c 6f63 6b44 6174 610a 2020  ck: BlockData.  
-00008f60: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00008f70: 2020 2020 2062 6c6f 636b 203d 2061 7761       block = awa
-00008f80: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00008f90: 6765 745f 626c 6f63 6b28 6173 796e 635f  get_block(async_
-00008fa0: 656d 7074 795f 626c 6f63 6b5b 226e 756d  empty_block["num
-00008fb0: 6265 7222 5d29 0a20 2020 2020 2020 2061  ber"]).        a
-00008fc0: 7373 6572 7420 626c 6f63 6b5b 226e 756d  ssert block["num
-00008fd0: 6265 7222 5d20 3d3d 2061 7379 6e63 5f65  ber"] == async_e
-00008fe0: 6d70 7479 5f62 6c6f 636b 5b22 6e75 6d62  mpty_block["numb
-00008ff0: 6572 225d 0a0a 2020 2020 4070 7974 6573  er"]..    @pytes
-00009000: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00009010: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00009020: 745f 6574 685f 6765 7442 6c6f 636b 4279  t_eth_getBlockBy
-00009030: 4e75 6d62 6572 5f6c 6174 6573 7428 0a20  Number_latest(. 
-00009040: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
-00009050: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-00009060: 3322 2c20 6173 796e 635f 656d 7074 795f  3", async_empty_
-00009070: 626c 6f63 6b3a 2042 6c6f 636b 4461 7461  block: BlockData
-00009080: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00009090: 2020 2020 2020 2020 6375 7272 656e 745f          current_
-000090a0: 626c 6f63 6b5f 6e75 6d62 6572 203d 2061  block_number = a
-000090b0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-000090c0: 682e 626c 6f63 6b5f 6e75 6d62 6572 0a20  h.block_number. 
-000090d0: 2020 2020 2020 2062 6c6f 636b 203d 2061         block = a
-000090e0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-000090f0: 682e 6765 745f 626c 6f63 6b28 226c 6174  h.get_block("lat
-00009100: 6573 7422 290a 2020 2020 2020 2020 6173  est").        as
-00009110: 7365 7274 2062 6c6f 636b 5b22 6e75 6d62  sert block["numb
-00009120: 6572 225d 203d 3d20 6375 7272 656e 745f  er"] == current_
-00009130: 626c 6f63 6b5f 6e75 6d62 6572 0a0a 2020  block_number..  
-00009140: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-00009150: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-00009160: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
-00009170: 7442 6c6f 636b 4279 4e75 6d62 6572 5f6e  tBlockByNumber_n
-00009180: 6f74 5f66 6f75 6e64 280a 2020 2020 2020  ot_found(.      
-00009190: 2020 7365 6c66 2c20 6173 796e 635f 7733    self, async_w3
-000091a0: 3a20 2241 7379 6e63 5765 6233 222c 2061  : "AsyncWeb3", a
-000091b0: 7379 6e63 5f65 6d70 7479 5f62 6c6f 636b  sync_empty_block
-000091c0: 3a20 426c 6f63 6b44 6174 610a 2020 2020  : BlockData.    
-000091d0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-000091e0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-000091f0: 6169 7365 7328 426c 6f63 6b4e 6f74 466f  aises(BlockNotFo
-00009200: 756e 6429 3a0a 2020 2020 2020 2020 2020  und):.          
-00009210: 2020 6177 6169 7420 6173 796e 635f 7733    await async_w3
-00009220: 2e65 7468 2e67 6574 5f62 6c6f 636b 2842  .eth.get_block(B
-00009230: 6c6f 636b 4e75 6d62 6572 2831 3233 3435  lockNumber(12345
-00009240: 2929 0a0a 2020 2020 4070 7974 6573 742e  ))..    @pytest.
-00009250: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-00009260: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-00009270: 6574 685f 6765 7442 6c6f 636b 4279 4e75  eth_getBlockByNu
-00009280: 6d62 6572 5f70 656e 6469 6e67 280a 2020  mber_pending(.  
-00009290: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
-000092a0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-000092b0: 222c 2061 7379 6e63 5f65 6d70 7479 5f62  ", async_empty_b
-000092c0: 6c6f 636b 3a20 426c 6f63 6b44 6174 610a  lock: BlockData.
-000092d0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-000092e0: 2020 2020 2020 2063 7572 7265 6e74 5f62         current_b
-000092f0: 6c6f 636b 5f6e 756d 6265 7220 3d20 6177  lock_number = aw
-00009300: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00009310: 2e62 6c6f 636b 5f6e 756d 6265 720a 2020  .block_number.  
-00009320: 2020 2020 2020 626c 6f63 6b20 3d20 6177        block = aw
-00009330: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00009340: 2e67 6574 5f62 6c6f 636b 2822 7065 6e64  .get_block("pend
-00009350: 696e 6722 290a 2020 2020 2020 2020 6173  ing").        as
-00009360: 7365 7274 2062 6c6f 636b 5b22 6e75 6d62  sert block["numb
-00009370: 6572 225d 203d 3d20 6375 7272 656e 745f  er"] == current_
-00009380: 626c 6f63 6b5f 6e75 6d62 6572 202b 2031  block_number + 1
-00009390: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-000093a0: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-000093b0: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
-000093c0: 685f 6765 7442 6c6f 636b 4279 4e75 6d62  h_getBlockByNumb
-000093d0: 6572 5f65 6172 6c69 6573 7428 0a20 2020  er_earliest(.   
-000093e0: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
-000093f0: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
-00009400: 2c20 6173 796e 635f 656d 7074 795f 626c  , async_empty_bl
-00009410: 6f63 6b3a 2042 6c6f 636b 4461 7461 0a20  ock: BlockData. 
-00009420: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-00009430: 2020 2020 2020 6765 6e65 7369 735f 626c        genesis_bl
-00009440: 6f63 6b20 3d20 6177 6169 7420 6173 796e  ock = await asyn
-00009450: 635f 7733 2e65 7468 2e67 6574 5f62 6c6f  c_w3.eth.get_blo
-00009460: 636b 2842 6c6f 636b 4e75 6d62 6572 2830  ck(BlockNumber(0
-00009470: 2929 0a20 2020 2020 2020 2062 6c6f 636b  )).        block
-00009480: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-00009490: 332e 6574 682e 6765 745f 626c 6f63 6b28  3.eth.get_block(
-000094a0: 2265 6172 6c69 6573 7422 290a 2020 2020  "earliest").    
-000094b0: 2020 2020 6173 7365 7274 2062 6c6f 636b      assert block
-000094c0: 5b22 6e75 6d62 6572 225d 203d 3d20 300a  ["number"] == 0.
-000094d0: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
-000094e0: 6c6f 636b 5b22 6861 7368 225d 203d 3d20  lock["hash"] == 
-000094f0: 6765 6e65 7369 735f 626c 6f63 6b5b 2268  genesis_block["h
-00009500: 6173 6822 5d0a 0a20 2020 2040 7079 7465  ash"]..    @pyte
-00009510: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-00009520: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-00009530: 7374 5f65 7468 5f67 6574 426c 6f63 6b42  st_eth_getBlockB
-00009540: 794e 756d 6265 725f 7361 6665 280a 2020  yNumber_safe(.  
-00009550: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
-00009560: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-00009570: 222c 2061 7379 6e63 5f65 6d70 7479 5f62  ", async_empty_b
-00009580: 6c6f 636b 3a20 426c 6f63 6b44 6174 610a  lock: BlockData.
-00009590: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-000095a0: 2020 2020 2020 2062 6c6f 636b 203d 2061         block = a
-000095b0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-000095c0: 682e 6765 745f 626c 6f63 6b28 2273 6166  h.get_block("saf
-000095d0: 6522 290a 2020 2020 2020 2020 6173 7365  e").        asse
-000095e0: 7274 2062 6c6f 636b 2069 7320 6e6f 7420  rt block is not 
-000095f0: 4e6f 6e65 0a20 2020 2020 2020 2061 7373  None.        ass
-00009600: 6572 7420 6973 696e 7374 616e 6365 2862  ert isinstance(b
-00009610: 6c6f 636b 5b22 6e75 6d62 6572 225d 2c20  lock["number"], 
-00009620: 696e 7429 0a0a 2020 2020 4070 7974 6573  int)..    @pytes
-00009630: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00009640: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00009650: 745f 6574 685f 6765 7442 6c6f 636b 4279  t_eth_getBlockBy
-00009660: 4e75 6d62 6572 5f66 696e 616c 697a 6564  Number_finalized
-00009670: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-00009680: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-00009690: 5765 6233 222c 2061 7379 6e63 5f65 6d70  Web3", async_emp
-000096a0: 7479 5f62 6c6f 636b 3a20 426c 6f63 6b44  ty_block: BlockD
-000096b0: 6174 610a 2020 2020 2920 2d3e 204e 6f6e  ata.    ) -> Non
-000096c0: 653a 0a20 2020 2020 2020 2062 6c6f 636b  e:.        block
-000096d0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-000096e0: 332e 6574 682e 6765 745f 626c 6f63 6b28  3.eth.get_block(
-000096f0: 2266 696e 616c 697a 6564 2229 0a20 2020  "finalized").   
-00009700: 2020 2020 2061 7373 6572 7420 626c 6f63       assert bloc
-00009710: 6b20 6973 206e 6f74 204e 6f6e 650a 2020  k is not None.  
-00009720: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
-00009730: 6e73 7461 6e63 6528 626c 6f63 6b5b 226e  nstance(block["n
-00009740: 756d 6265 7222 5d2c 2069 6e74 290a 0a20  umber"], int).. 
-00009750: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-00009760: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-00009770: 6320 6465 6620 7465 7374 5f65 7468 5f67  c def test_eth_g
-00009780: 6574 426c 6f63 6b52 6563 6569 7074 735f  etBlockReceipts_
-00009790: 6861 7368 280a 2020 2020 2020 2020 7365  hash(.        se
-000097a0: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
-000097b0: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
-000097c0: 5f65 6d70 7479 5f62 6c6f 636b 3a20 426c  _empty_block: Bl
-000097d0: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
-000097e0: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
-000097f0: 6563 6569 7074 7320 3d20 6177 6169 7420  eceipts = await 
-00009800: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
-00009810: 5f62 6c6f 636b 5f72 6563 6569 7074 7328  _block_receipts(
-00009820: 6173 796e 635f 656d 7074 795f 626c 6f63  async_empty_bloc
-00009830: 6b5b 2268 6173 6822 5d29 0a20 2020 2020  k["hash"]).     
-00009840: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
-00009850: 616e 6365 2872 6563 6569 7074 732c 206c  ance(receipts, l
-00009860: 6973 7429 0a0a 2020 2020 4070 7974 6573  ist)..    @pytes
-00009870: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00009880: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00009890: 745f 6574 685f 6765 7442 6c6f 636b 5265  t_eth_getBlockRe
-000098a0: 6365 6970 7473 5f6e 6f74 5f66 6f75 6e64  ceipts_not_found
-000098b0: 2873 656c 662c 2061 7379 6e63 5f77 333a  (self, async_w3:
-000098c0: 2022 4173 796e 6357 6562 3322 2920 2d3e   "AsyncWeb3") ->
-000098d0: 204e 6f6e 653a 0a20 2020 2020 2020 2077   None:.        w
-000098e0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-000098f0: 7328 426c 6f63 6b4e 6f74 466f 756e 6429  s(BlockNotFound)
-00009900: 3a0a 2020 2020 2020 2020 2020 2020 6177  :.            aw
-00009910: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00009920: 2e67 6574 5f62 6c6f 636b 5f72 6563 6569  .get_block_recei
-00009930: 7074 7328 554e 4b4e 4f57 4e5f 4841 5348  pts(UNKNOWN_HASH
-00009940: 290a 0a20 2020 2040 7079 7465 7374 2e6d  )..    @pytest.m
-00009950: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-00009960: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-00009970: 7468 5f67 6574 426c 6f63 6b52 6563 6569  th_getBlockRecei
-00009980: 7074 735f 7769 7468 5f69 6e74 6567 6572  pts_with_integer
-00009990: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-000099a0: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-000099b0: 5765 6233 222c 2061 7379 6e63 5f65 6d70  Web3", async_emp
-000099c0: 7479 5f62 6c6f 636b 3a20 426c 6f63 6b44  ty_block: BlockD
-000099d0: 6174 610a 2020 2020 2920 2d3e 204e 6f6e  ata.    ) -> Non
-000099e0: 653a 0a20 2020 2020 2020 2072 6563 6569  e:.        recei
-000099f0: 7074 7320 3d20 6177 6169 7420 6173 796e  pts = await asyn
-00009a00: 635f 7733 2e65 7468 2e67 6574 5f62 6c6f  c_w3.eth.get_blo
-00009a10: 636b 5f72 6563 6569 7074 7328 6173 796e  ck_receipts(asyn
-00009a20: 635f 656d 7074 795f 626c 6f63 6b5b 226e  c_empty_block["n
-00009a30: 756d 6265 7222 5d29 0a20 2020 2020 2020  umber"]).       
-00009a40: 2061 7373 6572 7420 6973 696e 7374 616e   assert isinstan
-00009a50: 6365 2872 6563 6569 7074 732c 206c 6973  ce(receipts, lis
-00009a60: 7429 0a0a 2020 2020 4070 7974 6573 742e  t)..    @pytest.
-00009a70: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-00009a80: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-00009a90: 6574 685f 6765 7442 6c6f 636b 5265 6365  eth_getBlockRece
-00009aa0: 6970 7473 5f73 6166 6528 0a20 2020 2020  ipts_safe(.     
-00009ab0: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
-00009ac0: 333a 2022 4173 796e 6357 6562 3322 2c20  3: "AsyncWeb3", 
-00009ad0: 6173 796e 635f 656d 7074 795f 626c 6f63  async_empty_bloc
-00009ae0: 6b3a 2042 6c6f 636b 4461 7461 0a20 2020  k: BlockData.   
-00009af0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00009b00: 2020 2020 7265 6365 6970 7473 203d 2061      receipts = a
-00009b10: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00009b20: 682e 6765 745f 626c 6f63 6b5f 7265 6365  h.get_block_rece
-00009b30: 6970 7473 2822 7361 6665 2229 0a20 2020  ipts("safe").   
-00009b40: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
-00009b50: 7374 616e 6365 2872 6563 6569 7074 732c  stance(receipts,
-00009b60: 206c 6973 7429 0a0a 2020 2020 4070 7974   list)..    @pyt
-00009b70: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00009b80: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-00009b90: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
-00009ba0: 5265 6365 6970 7473 5f66 696e 616c 697a  Receipts_finaliz
-00009bb0: 6564 280a 2020 2020 2020 2020 7365 6c66  ed(.        self
-00009bc0: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
-00009bd0: 6e63 5765 6233 222c 2061 7379 6e63 5f65  ncWeb3", async_e
-00009be0: 6d70 7479 5f62 6c6f 636b 3a20 426c 6f63  mpty_block: Bloc
-00009bf0: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
-00009c00: 6f6e 653a 0a20 2020 2020 2020 2072 6563  one:.        rec
-00009c10: 6569 7074 7320 3d20 6177 6169 7420 6173  eipts = await as
-00009c20: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
-00009c30: 6c6f 636b 5f72 6563 6569 7074 7328 2266  lock_receipts("f
-00009c40: 696e 616c 697a 6564 2229 0a20 2020 2020  inalized").     
-00009c50: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
-00009c60: 616e 6365 2872 6563 6569 7074 732c 206c  ance(receipts, l
-00009c70: 6973 7429 0a0a 2020 2020 4070 7974 6573  ist)..    @pytes
-00009c80: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00009c90: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00009ca0: 745f 6574 685f 6765 745f 626c 6f63 6b5f  t_eth_get_block_
-00009cb0: 6279 5f6e 756d 6265 725f 6675 6c6c 5f74  by_number_full_t
-00009cc0: 7261 6e73 6163 7469 6f6e 7328 0a20 2020  ransactions(.   
-00009cd0: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
-00009ce0: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
-00009cf0: 2c20 6173 796e 635f 626c 6f63 6b5f 7769  , async_block_wi
-00009d00: 7468 5f74 786e 3a20 426c 6f63 6b44 6174  th_txn: BlockDat
-00009d10: 610a 2020 2020 2920 2d3e 204e 6f6e 653a  a.    ) -> None:
-00009d20: 0a20 2020 2020 2020 2062 6c6f 636b 203d  .        block =
-00009d30: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00009d40: 6574 682e 6765 745f 626c 6f63 6b28 6173  eth.get_block(as
-00009d50: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
-00009d60: 786e 5b22 6e75 6d62 6572 225d 2c20 5472  xn["number"], Tr
-00009d70: 7565 290a 2020 2020 2020 2020 7472 616e  ue).        tran
-00009d80: 7361 6374 696f 6e20 3d20 6361 7374 2854  saction = cast(T
-00009d90: 7844 6174 612c 2062 6c6f 636b 5b22 7472  xData, block["tr
-00009da0: 616e 7361 6374 696f 6e73 225d 5b30 5d29  ansactions"][0])
-00009db0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00009dc0: 7472 616e 7361 6374 696f 6e5b 2268 6173  transaction["has
-00009dd0: 6822 5d20 3d3d 2061 7379 6e63 5f62 6c6f  h"] == async_blo
-00009de0: 636b 5f77 6974 685f 7478 6e5b 2274 7261  ck_with_txn["tra
-00009df0: 6e73 6163 7469 6f6e 7322 5d5b 305d 0a0a  nsactions"][0]..
-00009e00: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00009e10: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-00009e20: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
-00009e30: 6765 745f 7261 775f 7472 616e 7361 6374  get_raw_transact
-00009e40: 696f 6e28 0a20 2020 2020 2020 2073 656c  ion(.        sel
-00009e50: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-00009e60: 796e 6357 6562 3322 2c20 6d69 6e65 645f  yncWeb3", mined_
-00009e70: 7478 6e5f 6861 7368 3a20 4865 7853 7472  txn_hash: HexStr
-00009e80: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00009e90: 2020 2020 2020 2020 7261 775f 7472 616e          raw_tran
-00009ea0: 7361 6374 696f 6e20 3d20 6177 6169 7420  saction = await 
-00009eb0: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
-00009ec0: 5f72 6177 5f74 7261 6e73 6163 7469 6f6e  _raw_transaction
-00009ed0: 286d 696e 6564 5f74 786e 5f68 6173 6829  (mined_txn_hash)
-00009ee0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00009ef0: 6973 5f62 7974 6573 2872 6177 5f74 7261  is_bytes(raw_tra
-00009f00: 6e73 6163 7469 6f6e 290a 0a20 2020 2040  nsaction)..    @
-00009f10: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-00009f20: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-00009f30: 6620 7465 7374 5f65 7468 5f67 6574 5f72  f test_eth_get_r
-00009f40: 6177 5f74 7261 6e73 6163 7469 6f6e 5f72  aw_transaction_r
-00009f50: 6169 7365 735f 6572 726f 7228 0a20 2020  aises_error(.   
-00009f60: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
-00009f70: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
-00009f80: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00009f90: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-00009fa0: 6573 742e 7261 6973 6573 280a 2020 2020  est.raises(.    
-00009fb0: 2020 2020 2020 2020 5472 616e 7361 6374          Transact
-00009fc0: 696f 6e4e 6f74 466f 756e 642c 206d 6174  ionNotFound, mat
-00009fd0: 6368 3d66 2254 7261 6e73 6163 7469 6f6e  ch=f"Transaction
-00009fe0: 2077 6974 6820 6861 7368 3a20 277b 554e   with hash: '{UN
-00009ff0: 4b4e 4f57 4e5f 4841 5348 7d27 220a 2020  KNOWN_HASH}'".  
-0000a000: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-0000a010: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
-0000a020: 5f77 332e 6574 682e 6765 745f 7261 775f  _w3.eth.get_raw_
-0000a030: 7472 616e 7361 6374 696f 6e28 554e 4b4e  transaction(UNKN
-0000a040: 4f57 4e5f 4841 5348 290a 0a20 2020 2040  OWN_HASH)..    @
-0000a050: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-0000a060: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-0000a070: 6620 7465 7374 5f65 7468 5f67 6574 5f72  f test_eth_get_r
-0000a080: 6177 5f74 7261 6e73 6163 7469 6f6e 5f62  aw_transaction_b
-0000a090: 795f 626c 6f63 6b28 0a20 2020 2020 2020  y_block(.       
-0000a0a0: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-0000a0b0: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-0000a0c0: 6562 3322 2c0a 2020 2020 2020 2020 6173  eb3",.        as
-0000a0d0: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
-0000a0e0: 786e 3a20 426c 6f63 6b44 6174 612c 0a20  xn: BlockData,. 
-0000a0f0: 2020 2020 2020 2061 7379 6e63 5f75 6e6c         async_unl
-0000a100: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
-0000a110: 616c 5f74 7970 653a 2043 6865 636b 7375  al_type: Checksu
-0000a120: 6d41 6464 7265 7373 2c0a 2020 2020 2920  mAddress,.    ) 
-0000a130: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0000a140: 2023 2065 7468 5f67 6574 5261 7754 7261   # eth_getRawTra
-0000a150: 6e73 6163 7469 6f6e 4279 426c 6f63 6b4e  nsactionByBlockN
-0000a160: 756d 6265 7241 6e64 496e 6465 783a 2062  umberAndIndex: b
-0000a170: 6c6f 636b 2069 6465 6e74 6966 6965 720a  lock identifier.
-0000a180: 2020 2020 2020 2020 2320 7365 6e64 2061          # send a
-0000a190: 2074 786e 2074 6f20 6d61 6b65 2073 7572   txn to make sur
-0000a1a0: 6520 7065 6e64 696e 6720 626c 6f63 6b20  e pending block 
-0000a1b0: 6861 7320 6174 206c 6561 7374 206f 6e65  has at least one
-0000a1c0: 2074 786e 0a20 2020 2020 2020 2061 7761   txn.        awa
-0000a1d0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-0000a1e0: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-0000a1f0: 280a 2020 2020 2020 2020 2020 2020 7b0a  (.            {.
-0000a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a210: 2266 726f 6d22 3a20 6173 796e 635f 756e  "from": async_un
-0000a220: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-0000a230: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-0000a240: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
-0000a250: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
-0000a260: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-0000a270: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000a280: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
-0000a290: 292c 0a20 2020 2020 2020 2020 2020 207d  ),.            }
-0000a2a0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0000a2b0: 2020 2070 656e 6469 6e67 5f62 6c6f 636b     pending_block
-0000a2c0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-0000a2d0: 332e 6574 682e 6765 745f 626c 6f63 6b28  3.eth.get_block(
-0000a2e0: 2270 656e 6469 6e67 2229 0a20 2020 2020  "pending").     
-0000a2f0: 2020 206c 6173 745f 7065 6e64 696e 675f     last_pending_
-0000a300: 7478 6e5f 696e 6465 7820 3d20 6c65 6e28  txn_index = len(
-0000a310: 7065 6e64 696e 675f 626c 6f63 6b5b 2274  pending_block["t
-0000a320: 7261 6e73 6163 7469 6f6e 7322 5d29 202d  ransactions"]) -
-0000a330: 2031 0a20 2020 2020 2020 2072 6177 5f74   1.        raw_t
-0000a340: 786e 203d 2061 7761 6974 2061 7379 6e63  xn = await async
-0000a350: 5f77 332e 6574 682e 6765 745f 7261 775f  _w3.eth.get_raw_
-0000a360: 7472 616e 7361 6374 696f 6e5f 6279 5f62  transaction_by_b
-0000a370: 6c6f 636b 280a 2020 2020 2020 2020 2020  lock(.          
-0000a380: 2020 2270 656e 6469 6e67 222c 206c 6173    "pending", las
-0000a390: 745f 7065 6e64 696e 675f 7478 6e5f 696e  t_pending_txn_in
-0000a3a0: 6465 780a 2020 2020 2020 2020 290a 2020  dex.        ).  
-0000a3b0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-0000a3c0: 6279 7465 7328 7261 775f 7478 6e29 0a0a  bytes(raw_txn)..
-0000a3d0: 2020 2020 2020 2020 2320 6574 685f 6765          # eth_ge
-0000a3e0: 7452 6177 5472 616e 7361 6374 696f 6e42  tRawTransactionB
-0000a3f0: 7942 6c6f 636b 4e75 6d62 6572 416e 6449  yBlockNumberAndI
-0000a400: 6e64 6578 3a20 626c 6f63 6b20 6e75 6d62  ndex: block numb
-0000a410: 6572 0a20 2020 2020 2020 2061 7379 6e63  er.        async
-0000a420: 5f62 6c6f 636b 5f77 6974 685f 7478 6e5f  _block_with_txn_
-0000a430: 6e75 6d62 6572 203d 2061 7379 6e63 5f62  number = async_b
-0000a440: 6c6f 636b 5f77 6974 685f 7478 6e5b 226e  lock_with_txn["n
-0000a450: 756d 6265 7222 5d0a 2020 2020 2020 2020  umber"].        
-0000a460: 7261 775f 7472 616e 7361 6374 696f 6e20  raw_transaction 
-0000a470: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-0000a480: 2e65 7468 2e67 6574 5f72 6177 5f74 7261  .eth.get_raw_tra
-0000a490: 6e73 6163 7469 6f6e 5f62 795f 626c 6f63  nsaction_by_bloc
-0000a4a0: 6b28 0a20 2020 2020 2020 2020 2020 2061  k(.            a
-0000a4b0: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
-0000a4c0: 7478 6e5f 6e75 6d62 6572 2c20 300a 2020  txn_number, 0.  
-0000a4d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000a4e0: 6173 7365 7274 2069 735f 6279 7465 7328  assert is_bytes(
-0000a4f0: 7261 775f 7472 616e 7361 6374 696f 6e29  raw_transaction)
-0000a500: 0a0a 2020 2020 2020 2020 2320 6574 685f  ..        # eth_
-0000a510: 6765 7452 6177 5472 616e 7361 6374 696f  getRawTransactio
-0000a520: 6e42 7942 6c6f 636b 4861 7368 416e 6449  nByBlockHashAndI
-0000a530: 6e64 6578 3a20 626c 6f63 6b20 6861 7368  ndex: block hash
-0000a540: 0a20 2020 2020 2020 2061 7379 6e63 5f62  .        async_b
-0000a550: 6c6f 636b 5f77 6974 685f 7478 6e5f 6861  lock_with_txn_ha
-0000a560: 7368 203d 2061 7379 6e63 5f62 6c6f 636b  sh = async_block
-0000a570: 5f77 6974 685f 7478 6e5b 2268 6173 6822  _with_txn["hash"
-0000a580: 5d0a 2020 2020 2020 2020 7261 775f 7472  ].        raw_tr
-0000a590: 616e 7361 6374 696f 6e20 3d20 6177 6169  ansaction = awai
-0000a5a0: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
-0000a5b0: 6574 5f72 6177 5f74 7261 6e73 6163 7469  et_raw_transacti
-0000a5c0: 6f6e 5f62 795f 626c 6f63 6b28 0a20 2020  on_by_block(.   
-0000a5d0: 2020 2020 2020 2020 2061 7379 6e63 5f62           async_b
-0000a5e0: 6c6f 636b 5f77 6974 685f 7478 6e5f 6861  lock_with_txn_ha
-0000a5f0: 7368 2c20 300a 2020 2020 2020 2020 290a  sh, 0.        ).
-0000a600: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-0000a610: 735f 6279 7465 7328 7261 775f 7472 616e  s_bytes(raw_tran
-0000a620: 7361 6374 696f 6e29 0a0a 2020 2020 4070  saction)..    @p
-0000a630: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-0000a640: 696f 0a20 2020 2040 7079 7465 7374 2e6d  io.    @pytest.m
-0000a650: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
-0000a660: 2275 6e6b 6e6f 776e 5f62 6c6f 636b 5f6e  "unknown_block_n
-0000a670: 756d 5f6f 725f 6861 7368 222c 2028 3132  um_or_hash", (12
-0000a680: 3334 3536 3738 3939 3939 392c 2055 4e4b  34567899999, UNK
-0000a690: 4e4f 574e 5f48 4153 4829 290a 2020 2020  NOWN_HASH)).    
-0000a6a0: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-0000a6b0: 7468 5f67 6574 5f72 6177 5f74 7261 6e73  th_get_raw_trans
-0000a6c0: 6163 7469 6f6e 5f62 795f 626c 6f63 6b5f  action_by_block_
-0000a6d0: 7261 6973 6573 5f65 7272 6f72 280a 2020  raises_error(.  
-0000a6e0: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
-0000a6f0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-0000a700: 222c 2075 6e6b 6e6f 776e 5f62 6c6f 636b  ", unknown_block
-0000a710: 5f6e 756d 5f6f 725f 6861 7368 3a20 556e  _num_or_hash: Un
-0000a720: 696f 6e5b 696e 742c 2048 6578 4279 7465  ion[int, HexByte
-0000a730: 735d 0a20 2020 2029 202d 3e20 4e6f 6e65  s].    ) -> None
-0000a740: 3a0a 2020 2020 2020 2020 7769 7468 2070  :.        with p
-0000a750: 7974 6573 742e 7261 6973 6573 280a 2020  ytest.raises(.  
-0000a760: 2020 2020 2020 2020 2020 5472 616e 7361            Transa
-0000a770: 6374 696f 6e4e 6f74 466f 756e 642c 0a20  ctionNotFound,. 
-0000a780: 2020 2020 2020 2020 2020 206d 6174 6368             match
-0000a790: 3d28 0a20 2020 2020 2020 2020 2020 2020  =(.             
-0000a7a0: 2020 2066 2254 7261 6e73 6163 7469 6f6e     f"Transaction
-0000a7b0: 2069 6e64 6578 3a20 3020 6f6e 2062 6c6f   index: 0 on blo
-0000a7c0: 636b 2069 643a 2022 0a20 2020 2020 2020  ck id: ".       
-0000a7d0: 2020 2020 2020 2020 2066 227b 746f 5f68           f"{to_h
-0000a7e0: 6578 5f69 665f 696e 7465 6765 7228 756e  ex_if_integer(un
-0000a7f0: 6b6e 6f77 6e5f 626c 6f63 6b5f 6e75 6d5f  known_block_num_
-0000a800: 6f72 5f68 6173 6829 2172 7d20 220a 2020  or_hash)!r} ".  
-0000a810: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0000a820: 6e6f 7420 666f 756e 642e 220a 2020 2020  not found.".    
-0000a830: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-0000a840: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-0000a850: 2020 6177 6169 7420 6173 796e 635f 7733    await async_w3
-0000a860: 2e65 7468 2e67 6574 5f72 6177 5f74 7261  .eth.get_raw_tra
-0000a870: 6e73 6163 7469 6f6e 5f62 795f 626c 6f63  nsaction_by_bloc
-0000a880: 6b28 0a20 2020 2020 2020 2020 2020 2020  k(.             
-0000a890: 2020 2075 6e6b 6e6f 776e 5f62 6c6f 636b     unknown_block
-0000a8a0: 5f6e 756d 5f6f 725f 6861 7368 2c20 300a  _num_or_hash, 0.
-0000a8b0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0000a8c0: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-0000a8d0: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-0000a8e0: 6320 6465 6620 7465 7374 5f65 7468 5f67  c def test_eth_g
-0000a8f0: 6574 5f72 6177 5f74 7261 6e73 6163 7469  et_raw_transacti
-0000a900: 6f6e 5f62 795f 626c 6f63 6b5f 7261 6973  on_by_block_rais
-0000a910: 6573 5f65 7272 6f72 5f62 6c6f 636b 5f69  es_error_block_i
-0000a920: 6465 6e74 6966 6965 7228 0a20 2020 2020  dentifier(.     
-0000a930: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
-0000a940: 333a 2022 4173 796e 6357 6562 3322 0a20  3: "AsyncWeb3". 
-0000a950: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0000a960: 2020 2020 2020 756e 6b6e 6f77 6e5f 6964        unknown_id
-0000a970: 656e 7469 6669 6572 203d 2022 756e 6b6e  entifier = "unkn
-0000a980: 6f77 6e22 0a20 2020 2020 2020 2077 6974  own".        wit
-0000a990: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-0000a9a0: 0a20 2020 2020 2020 2020 2020 2056 616c  .            Val
-0000a9b0: 7565 4572 726f 722c 0a20 2020 2020 2020  ueError,.       
-0000a9c0: 2020 2020 206d 6174 6368 3d28 0a20 2020       match=(.   
-0000a9d0: 2020 2020 2020 2020 2020 2020 2022 5661               "Va
-0000a9e0: 6c75 6520 6469 6420 6e6f 7420 6d61 7463  lue did not matc
-0000a9f0: 6820 616e 7920 6f66 2074 6865 2072 6563  h any of the rec
-0000aa00: 6f67 6e69 7a65 6420 626c 6f63 6b20 6964  ognized block id
-0000aa10: 656e 7469 6669 6572 733a 2022 0a20 2020  entifiers: ".   
-0000aa20: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-0000aa30: 756e 6b6e 6f77 6e5f 6964 656e 7469 6669  unknown_identifi
-0000aa40: 6572 7d22 0a20 2020 2020 2020 2020 2020  er}".           
-0000aa50: 2029 2c0a 2020 2020 2020 2020 293a 0a20   ),.        ):. 
-0000aa60: 2020 2020 2020 2020 2020 2061 7761 6974             await
-0000aa70: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-0000aa80: 745f 7261 775f 7472 616e 7361 6374 696f  t_raw_transactio
-0000aa90: 6e5f 6279 5f62 6c6f 636b 280a 2020 2020  n_by_block(.    
-0000aaa0: 2020 2020 2020 2020 2020 2020 756e 6b6e              unkn
-0000aab0: 6f77 6e5f 6964 656e 7469 6669 6572 2c20  own_identifier, 
-0000aac0: 3020 2023 2074 7970 653a 2069 676e 6f72  0  # type: ignor
-0000aad0: 650a 2020 2020 2020 2020 2020 2020 290a  e.            ).
-0000aae0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-0000aaf0: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-0000ab00: 796e 6320 6465 6620 7465 7374 5f65 7468  ync def test_eth
-0000ab10: 5f67 6574 5f62 616c 616e 6365 2873 656c  _get_balance(sel
-0000ab20: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-0000ab30: 796e 6357 6562 3322 2920 2d3e 204e 6f6e  yncWeb3") -> Non
-0000ab40: 653a 0a20 2020 2020 2020 2063 6f69 6e62  e:.        coinb
-0000ab50: 6173 6520 3d20 6177 6169 7420 6173 796e  ase = await asyn
-0000ab60: 635f 7733 2e65 7468 2e63 6f69 6e62 6173  c_w3.eth.coinbas
-0000ab70: 650a 0a20 2020 2020 2020 2077 6974 6820  e..        with 
-0000ab80: 7079 7465 7374 2e72 6169 7365 7328 496e  pytest.raises(In
-0000ab90: 7661 6c69 6441 6464 7265 7373 293a 0a20  validAddress):. 
-0000aba0: 2020 2020 2020 2020 2020 2061 7761 6974             await
-0000abb0: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-0000abc0: 745f 6261 6c61 6e63 6528 0a20 2020 2020  t_balance(.     
-0000abd0: 2020 2020 2020 2020 2020 2043 6865 636b             Check
-0000abe0: 7375 6d41 6464 7265 7373 2848 6578 4164  sumAddress(HexAd
-0000abf0: 6472 6573 7328 4865 7853 7472 2863 6f69  dress(HexStr(coi
-0000ac00: 6e62 6173 652e 6c6f 7765 7228 2929 2929  nbase.lower())))
-0000ac10: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0000ac20: 2020 2020 2020 2020 6261 6c61 6e63 6520          balance 
-0000ac30: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-0000ac40: 2e65 7468 2e67 6574 5f62 616c 616e 6365  .eth.get_balance
-0000ac50: 2863 6f69 6e62 6173 6529 0a0a 2020 2020  (coinbase)..    
-0000ac60: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
-0000ac70: 7465 6765 7228 6261 6c61 6e63 6529 0a20  teger(balance). 
-0000ac80: 2020 2020 2020 2061 7373 6572 7420 6261         assert ba
-0000ac90: 6c61 6e63 6520 3e3d 2030 0a0a 2020 2020  lance >= 0..    
-0000aca0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-0000acb0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-0000acc0: 6566 2074 6573 745f 6574 685f 6765 745f  ef test_eth_get_
-0000acd0: 636f 6465 280a 2020 2020 2020 2020 7365  code(.        se
-0000ace0: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
-0000acf0: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
-0000ad00: 5f6d 6174 685f 636f 6e74 7261 6374 5f61  _math_contract_a
-0000ad10: 6464 7265 7373 3a20 4368 6563 6b73 756d  ddress: Checksum
-0000ad20: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-0000ad30: 204e 6f6e 653a 0a20 2020 2020 2020 2063   None:.        c
-0000ad40: 6f64 6520 3d20 6177 6169 7420 6173 796e  ode = await asyn
-0000ad50: 635f 7733 2e65 7468 2e67 6574 5f63 6f64  c_w3.eth.get_cod
-0000ad60: 6528 6173 796e 635f 6d61 7468 5f63 6f6e  e(async_math_con
-0000ad70: 7472 6163 745f 6164 6472 6573 7329 0a20  tract_address). 
-0000ad80: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-0000ad90: 696e 7374 616e 6365 2863 6f64 652c 2048  instance(code, H
-0000ada0: 6578 4279 7465 7329 0a20 2020 2020 2020  exBytes).       
-0000adb0: 2061 7373 6572 7420 6c65 6e28 636f 6465   assert len(code
-0000adc0: 2920 3e20 300a 0a20 2020 2040 7079 7465  ) > 0..    @pyte
-0000add0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-0000ade0: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-0000adf0: 7374 5f65 7468 5f67 6574 5f63 6f64 655f  st_eth_get_code_
-0000ae00: 696e 7661 6c69 645f 6164 6472 6573 7328  invalid_address(
-0000ae10: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000ae20: 2020 2020 2020 2061 7379 6e63 5f77 333a         async_w3:
-0000ae30: 2022 4173 796e 6357 6562 3322 2c0a 2020   "AsyncWeb3",.  
-0000ae40: 2020 2020 2020 6173 796e 635f 6d61 7468        async_math
-0000ae50: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
-0000ae60: 7261 6374 222c 0a20 2020 2029 202d 3e20  ract",.    ) -> 
-0000ae70: 4e6f 6e65 3a0a 2020 2020 2020 2020 7769  None:.        wi
-0000ae80: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-0000ae90: 2849 6e76 616c 6964 4164 6472 6573 7329  (InvalidAddress)
-0000aea0: 3a0a 2020 2020 2020 2020 2020 2020 6177  :.            aw
-0000aeb0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-0000aec0: 2e67 6574 5f63 6f64 6528 0a20 2020 2020  .get_code(.     
-0000aed0: 2020 2020 2020 2020 2020 2043 6865 636b             Check
-0000aee0: 7375 6d41 6464 7265 7373 2848 6578 4164  sumAddress(HexAd
-0000aef0: 6472 6573 7328 4865 7853 7472 2861 7379  dress(HexStr(asy
-0000af00: 6e63 5f6d 6174 685f 636f 6e74 7261 6374  nc_math_contract
-0000af10: 2e61 6464 7265 7373 2e6c 6f77 6572 2829  .address.lower()
-0000af20: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
-0000af30: 290a 0a20 2020 2040 7079 7465 7374 2e6d  )..    @pytest.m
-0000af40: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-0000af50: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-0000af60: 7468 5f67 6574 5f63 6f64 655f 7769 7468  th_get_code_with
-0000af70: 5f62 6c6f 636b 5f69 6465 6e74 6966 6965  _block_identifie
-0000af80: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
-0000af90: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-0000afa0: 6357 6562 3322 2c20 6173 796e 635f 656d  cWeb3", async_em
-0000afb0: 6974 7465 725f 636f 6e74 7261 6374 3a20  itter_contract: 
-0000afc0: 2243 6f6e 7472 6163 7422 0a20 2020 2029  "Contract".    )
-0000afd0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-0000afe0: 2020 626c 6f63 6b5f 6964 203d 2061 7761    block_id = awa
-0000aff0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-0000b000: 626c 6f63 6b5f 6e75 6d62 6572 0a20 2020  block_number.   
-0000b010: 2020 2020 2063 6f64 6520 3d20 6177 6169       code = awai
-0000b020: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
-0000b030: 6574 5f63 6f64 6528 6173 796e 635f 656d  et_code(async_em
-0000b040: 6974 7465 725f 636f 6e74 7261 6374 2e61  itter_contract.a
-0000b050: 6464 7265 7373 2c20 626c 6f63 6b5f 6964  ddress, block_id
-0000b060: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-0000b070: 2069 7369 6e73 7461 6e63 6528 636f 6465   isinstance(code
-0000b080: 2c20 4865 7842 7974 6573 290a 2020 2020  , HexBytes).    
-0000b090: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
-0000b0a0: 6f64 6529 203e 2030 0a0a 2020 2020 4070  ode) > 0..    @p
-0000b0b0: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-0000b0c0: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-0000b0d0: 2074 6573 745f 6574 685f 6372 6561 7465   test_eth_create
-0000b0e0: 5f61 6363 6573 735f 6c69 7374 280a 2020  _access_list(.  
-0000b0f0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0000b100: 2020 2020 6173 796e 635f 7733 3a20 2241      async_w3: "A
-0000b110: 7379 6e63 5765 6233 222c 0a20 2020 2020  syncWeb3",.     
-0000b120: 2020 2061 7379 6e63 5f75 6e6c 6f63 6b65     async_unlocke
-0000b130: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-0000b140: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-0000b150: 7265 7373 2c0a 2020 2020 2020 2020 6173  ress,.        as
-0000b160: 796e 635f 6d61 7468 5f63 6f6e 7472 6163  ync_math_contrac
-0000b170: 743a 2022 436f 6e74 7261 6374 222c 0a20  t: "Contract",. 
-0000b180: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0000b190: 2020 2020 2020 2320 496e 6974 6961 6c69        # Initiali
-0000b1a0: 7a65 2074 7261 6e73 6163 7469 6f6e 2066  ze transaction f
-0000b1b0: 6f72 2067 6173 2065 7374 696d 6174 696f  or gas estimatio
-0000b1c0: 6e0a 2020 2020 2020 2020 7478 6e5f 7061  n.        txn_pa
-0000b1d0: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
-0000b1e0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-0000b1f0: 6672 6f6d 223a 2061 7379 6e63 5f75 6e6c  from": async_unl
-0000b200: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
-0000b210: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
-0000b220: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
-0000b230: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
-0000b240: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
-0000b250: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-0000b260: 2020 7478 6e20 3d20 6173 796e 635f 6d61    txn = async_ma
-0000b270: 7468 5f63 6f6e 7472 6163 742e 5f70 7265  th_contract._pre
-0000b280: 7061 7265 5f74 7261 6e73 6163 7469 6f6e  pare_transaction
-0000b290: 280a 2020 2020 2020 2020 2020 2020 666e  (.            fn
-0000b2a0: 5f6e 616d 653d 2269 6e63 7265 6d65 6e74  _name="increment
-0000b2b0: 436f 756e 7465 7222 2c0a 2020 2020 2020  Counter",.      
-0000b2c0: 2020 2020 2020 666e 5f61 7267 733d 5b31        fn_args=[1
-0000b2d0: 5d2c 0a20 2020 2020 2020 2020 2020 2074  ],.            t
-0000b2e0: 7261 6e73 6163 7469 6f6e 3d74 786e 5f70  ransaction=txn_p
-0000b2f0: 6172 616d 732c 0a20 2020 2020 2020 2029  arams,.        )
-0000b300: 0a0a 2020 2020 2020 2020 2320 6372 6561  ..        # crea
-0000b310: 7465 2061 6363 6573 7320 6c69 7374 2075  te access list u
-0000b320: 7369 6e67 2064 6174 6120 6672 6f6d 2074  sing data from t
-0000b330: 7261 6e73 6163 7469 6f6e 0a20 2020 2020  ransaction.     
-0000b340: 2020 2072 6573 706f 6e73 6520 3d20 6177     response = aw
-0000b350: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-0000b360: 2e63 7265 6174 655f 6163 6365 7373 5f6c  .create_access_l
-0000b370: 6973 7428 0a20 2020 2020 2020 2020 2020  ist(.           
-0000b380: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-0000b390: 2020 2022 6672 6f6d 223a 2061 7379 6e63     "from": async
-0000b3a0: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
-0000b3b0: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
-0000b3c0: 2020 2020 2020 2020 2020 2020 2022 746f               "to
-0000b3d0: 223a 2061 7379 6e63 5f6d 6174 685f 636f  ": async_math_co
-0000b3e0: 6e74 7261 6374 2e61 6464 7265 7373 2c0a  ntract.address,.
-0000b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b400: 2264 6174 6122 3a20 7478 6e5b 2264 6174  "data": txn["dat
-0000b410: 6122 5d2c 0a20 2020 2020 2020 2020 2020  a"],.           
-0000b420: 207d 0a20 2020 2020 2020 2029 0a0a 2020   }.        )..  
-0000b430: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-0000b440: 6469 6374 2872 6573 706f 6e73 6529 0a20  dict(response). 
-0000b450: 2020 2020 2020 2061 6363 6573 735f 6c69         access_li
-0000b460: 7374 203d 2072 6573 706f 6e73 655b 2261  st = response["a
-0000b470: 6363 6573 734c 6973 7422 5d0a 2020 2020  ccessList"].    
-0000b480: 2020 2020 6173 7365 7274 206c 656e 2861      assert len(a
-0000b490: 6363 6573 735f 6c69 7374 2920 3e20 300a  ccess_list) > 0.
-0000b4a0: 2020 2020 2020 2020 6173 7365 7274 2061          assert a
-0000b4b0: 6363 6573 735f 6c69 7374 5b30 5d5b 2261  ccess_list[0]["a
-0000b4c0: 6464 7265 7373 225d 2069 7320 6e6f 7420  ddress"] is not 
-0000b4d0: 4e6f 6e65 0a20 2020 2020 2020 2061 7373  None.        ass
-0000b4e0: 6572 7420 6973 5f63 6865 636b 7375 6d5f  ert is_checksum_
-0000b4f0: 6164 6472 6573 7328 6163 6365 7373 5f6c  address(access_l
-0000b500: 6973 745b 305d 5b22 6164 6472 6573 7322  ist[0]["address"
-0000b510: 5d29 0a20 2020 2020 2020 2061 7373 6572  ]).        asser
-0000b520: 7420 6c65 6e28 6163 6365 7373 5f6c 6973  t len(access_lis
-0000b530: 745b 305d 5b22 7374 6f72 6167 654b 6579  t[0]["storageKey
-0000b540: 7322 5d5b 305d 2920 3d3d 2033 320a 2020  s"][0]) == 32.  
-0000b550: 2020 2020 2020 6173 7365 7274 2069 6e74        assert int
-0000b560: 2872 6573 706f 6e73 655b 2267 6173 5573  (response["gasUs
-0000b570: 6564 225d 2920 3e3d 2030 0a0a 2020 2020  ed"]) >= 0..    
-0000b580: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-0000b590: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-0000b5a0: 6566 2074 6573 745f 6574 685f 6765 745f  ef test_eth_get_
-0000b5b0: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
-0000b5c0: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
-0000b5d0: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-0000b5e0: 6357 6562 3322 2c20 6173 796e 635f 756e  cWeb3", async_un
-0000b5f0: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-0000b600: 7561 6c5f 7479 7065 3a20 4368 6563 6b73  ual_type: Checks
-0000b610: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
-0000b620: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0000b630: 2074 7261 6e73 6163 7469 6f6e 5f63 6f75   transaction_cou
-0000b640: 6e74 203d 2061 7761 6974 2061 7379 6e63  nt = await async
-0000b650: 5f77 332e 6574 682e 6765 745f 7472 616e  _w3.eth.get_tran
-0000b660: 7361 6374 696f 6e5f 636f 756e 7428 0a20  saction_count(. 
-0000b670: 2020 2020 2020 2020 2020 2061 7379 6e63             async
-0000b680: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
-0000b690: 745f 6475 616c 5f74 7970 650a 2020 2020  t_dual_type.    
-0000b6a0: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
-0000b6b0: 7365 7274 2069 735f 696e 7465 6765 7228  sert is_integer(
-0000b6c0: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
-0000b6d0: 7429 0a20 2020 2020 2020 2061 7373 6572  t).        asser
-0000b6e0: 7420 7472 616e 7361 6374 696f 6e5f 636f  t transaction_co
-0000b6f0: 756e 7420 3e3d 2030 0a0a 2020 2020 4070  unt >= 0..    @p
-0000b700: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-0000b710: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-0000b720: 2074 6573 745f 6574 685f 6361 6c6c 280a   test_eth_call(.
-0000b730: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
-0000b740: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
-0000b750: 6233 222c 2061 7379 6e63 5f6d 6174 685f  b3", async_math_
-0000b760: 636f 6e74 7261 6374 3a20 2243 6f6e 7472  contract: "Contr
-0000b770: 6163 7422 0a20 2020 2029 202d 3e20 4e6f  act".    ) -> No
-0000b780: 6e65 3a0a 2020 2020 2020 2020 636f 696e  ne:.        coin
-0000b790: 6261 7365 203d 2061 7761 6974 2061 7379  base = await asy
-0000b7a0: 6e63 5f77 332e 6574 682e 636f 696e 6261  nc_w3.eth.coinba
-0000b7b0: 7365 0a20 2020 2020 2020 2074 786e 5f70  se.        txn_p
-0000b7c0: 6172 616d 7320 3d20 6173 796e 635f 6d61  arams = async_ma
-0000b7d0: 7468 5f63 6f6e 7472 6163 742e 5f70 7265  th_contract._pre
-0000b7e0: 7061 7265 5f74 7261 6e73 6163 7469 6f6e  pare_transaction
-0000b7f0: 280a 2020 2020 2020 2020 2020 2020 666e  (.            fn
-0000b800: 5f6e 616d 653d 2261 6464 222c 0a20 2020  _name="add",.   
-0000b810: 2020 2020 2020 2020 2066 6e5f 6172 6773           fn_args
-0000b820: 3d28 372c 2031 3129 2c0a 2020 2020 2020  =(7, 11),.      
-0000b830: 2020 2020 2020 7472 616e 7361 6374 696f        transactio
-0000b840: 6e3d 7b22 6672 6f6d 223a 2063 6f69 6e62  n={"from": coinb
-0000b850: 6173 652c 2022 746f 223a 2061 7379 6e63  ase, "to": async
-0000b860: 5f6d 6174 685f 636f 6e74 7261 6374 2e61  _math_contract.a
-0000b870: 6464 7265 7373 7d2c 0a20 2020 2020 2020  ddress},.       
-0000b880: 2029 0a20 2020 2020 2020 2063 616c 6c5f   ).        call_
-0000b890: 7265 7375 6c74 203d 2061 7761 6974 2061  result = await a
-0000b8a0: 7379 6e63 5f77 332e 6574 682e 6361 6c6c  sync_w3.eth.call
-0000b8b0: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
-0000b8c0: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
-0000b8d0: 7472 696e 6728 6361 6c6c 5f72 6573 756c  tring(call_resul
-0000b8e0: 7429 0a20 2020 2020 2020 2028 7265 7375  t).        (resu
-0000b8f0: 6c74 2c29 203d 2061 7379 6e63 5f77 332e  lt,) = async_w3.
-0000b900: 636f 6465 632e 6465 636f 6465 285b 2275  codec.decode(["u
-0000b910: 696e 7432 3536 225d 2c20 6361 6c6c 5f72  int256"], call_r
-0000b920: 6573 756c 7429 0a20 2020 2020 2020 2061  esult).        a
-0000b930: 7373 6572 7420 7265 7375 6c74 203d 3d20  ssert result == 
-0000b940: 3138 0a0a 2020 2020 4070 7974 6573 742e  18..    @pytest.
-0000b950: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-0000b960: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-0000b970: 6574 685f 6361 6c6c 5f77 6974 685f 6f76  eth_call_with_ov
-0000b980: 6572 7269 6465 5f63 6f64 6528 0a20 2020  erride_code(.   
-0000b990: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000b9a0: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
-0000b9b0: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
-0000b9c0: 2020 6173 796e 635f 7265 7665 7274 5f63    async_revert_c
-0000b9d0: 6f6e 7472 6163 743a 2022 436f 6e74 7261  ontract: "Contra
-0000b9e0: 6374 222c 0a20 2020 2029 202d 3e20 4e6f  ct",.    ) -> No
-0000b9f0: 6e65 3a0a 2020 2020 2020 2020 636f 696e  ne:.        coin
-0000ba00: 6261 7365 203d 2061 7761 6974 2061 7379  base = await asy
-0000ba10: 6e63 5f77 332e 6574 682e 636f 696e 6261  nc_w3.eth.coinba
-0000ba20: 7365 0a20 2020 2020 2020 2074 786e 5f70  se.        txn_p
-0000ba30: 6172 616d 7320 3d20 6173 796e 635f 7265  arams = async_re
-0000ba40: 7665 7274 5f63 6f6e 7472 6163 742e 5f70  vert_contract._p
-0000ba50: 7265 7061 7265 5f74 7261 6e73 6163 7469  repare_transacti
-0000ba60: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-0000ba70: 666e 5f6e 616d 653d 226e 6f72 6d61 6c46  fn_name="normalF
-0000ba80: 756e 6374 696f 6e22 2c0a 2020 2020 2020  unction",.      
-0000ba90: 2020 2020 2020 7472 616e 7361 6374 696f        transactio
-0000baa0: 6e3d 7b22 6672 6f6d 223a 2063 6f69 6e62  n={"from": coinb
-0000bab0: 6173 652c 2022 746f 223a 2061 7379 6e63  ase, "to": async
-0000bac0: 5f72 6576 6572 745f 636f 6e74 7261 6374  _revert_contract
-0000bad0: 2e61 6464 7265 7373 7d2c 0a20 2020 2020  .address},.     
-0000bae0: 2020 2029 0a20 2020 2020 2020 2063 616c     ).        cal
-0000baf0: 6c5f 7265 7375 6c74 203d 2061 7761 6974  l_result = await
-0000bb00: 2061 7379 6e63 5f77 332e 6574 682e 6361   async_w3.eth.ca
-0000bb10: 6c6c 2874 786e 5f70 6172 616d 7329 0a20  ll(txn_params). 
-0000bb20: 2020 2020 2020 2028 7265 7375 6c74 2c29         (result,)
-0000bb30: 203d 2061 7379 6e63 5f77 332e 636f 6465   = async_w3.code
-0000bb40: 632e 6465 636f 6465 285b 2262 6f6f 6c22  c.decode(["bool"
-0000bb50: 5d2c 2063 616c 6c5f 7265 7375 6c74 290a  ], call_result).
-0000bb60: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-0000bb70: 6573 756c 7420 6973 2054 7275 650a 0a20  esult is True.. 
-0000bb80: 2020 2020 2020 2023 206f 7665 7272 6964         # overrid
-0000bb90: 6520 7275 6e74 696d 6520 6279 7465 636f  e runtime byteco
-0000bba0: 6465 3a20 606e 6f72 6d61 6c46 756e 6374  de: `normalFunct
-0000bbb0: 696f 6e60 2072 6574 7572 6e73 2060 6661  ion` returns `fa
-0000bbc0: 6c73 6560 0a20 2020 2020 2020 206f 7665  lse`.        ove
-0000bbd0: 7272 6964 655f 636f 6465 203d 2048 6578  rride_code = Hex
-0000bbe0: 5374 7228 0a20 2020 2020 2020 2020 2020  Str(.           
-0000bbf0: 2022 3078 3630 3830 3630 3430 3532 3334   "0x608060405234
-0000bc00: 3830 3135 3630 3066 3537 3630 3030 3830  8015600f57600080
-0000bc10: 6664 3562 3530 3630 3034 3336 3130 3630  fd5b506004361060
-0000bc20: 3363 3537 3630 3030 3335 3630 6530 3163  3c5760003560e01c
-0000bc30: 3830 3633 3138 3563 3338 6134 3134 3630  8063185c38a41460
-0000bc40: 3431 3537 3830 3633 6330 3661 3937 6362  41578063c06a97cb
-0000bc50: 3134 3630 3439 3537 3830 3633 6436 3765  146049578063d67e
-0000bc60: 3462 3834 3134 3630 3531 3537 3562 3630  4b84146051575b60
-0000bc70: 3030 3830 6664 3562 3630 3437 3630 3731  0080fd5b60476071
-0000bc80: 3536 3562 3030 3562 3630 3466 3630 6466  565b005b604f60df
-0000bc90: 3536 3562 3030 3562 3630 3537 3630 6534  565b005b605760e4
-0000bca0: 3536 3562 3630 3430 3531 3830 3832 3135  565b604051808215
-0000bcb0: 3135 3135 3135 3831 3532 3630 3230 3031  1515158152602001
-0000bcc0: 3931 3530 3530 3630 3430 3531 3830 3931  9150506040518091
-0000bcd0: 3033 3930 6633 3562 3630 3430 3531 3766  0390f35b6040517f
-0000bce0: 3038 6333 3739 6130 3030 3030 3030 3030  08c379a000000000
-0000bcf0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-0000bd00: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-0000bd10: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-0000bd20: 3831 3532 3630 3034 3031 3830 3830 3630  8152600401808060
-0000bd30: 3230 3031 3832 3831 3033 3832 3532 3630  2001828103825260
-0000bd40: 3162 3831 3532 3630 3230 3031 3830 3766  1b8152602001807f
-0000bd50: 3436 3735 3665 3633 3734 3639 3666 3665  46756e6374696f6e
-0000bd60: 3230 3638 3631 3733 3230 3632 3635 3635  2068617320626565
-0000bd70: 3665 3230 3732 3635 3736 3635 3732 3734  6e20726576657274
-0000bd80: 3635 3634 3265 3030 3030 3030 3030 3030  65642e0000000000
-0000bd90: 3831 3532 3530 3630 3230 3031 3931 3530  8152506020019150
-0000bda0: 3530 3630 3430 3531 3830 3931 3033 3930  5060405180910390
-0000bdb0: 6664 3562 3630 3030 3830 6664 3562 3630  fd5b600080fd5b60
-0000bdc0: 3030 3830 3930 3530 3930 3536 6665 6132  008090509056fea2
-0000bdd0: 3634 3639 3730 3636 3733 3538 3232 3132  6469706673582212
-0000bde0: 3230 6262 3731 6539 6539 6132 6532 3731  20bb71e9e9a2e271
-0000bdf0: 6364 3066 6265 3833 3335 3234 6133 6561  cd0fbe833524a3ea
-0000be00: 3637 6466 3935 6632 3565 6131 3361 6566  67df95f25ea13aef
-0000be10: 3562 3061 3736 3166 6135 3262 3533 3866  5b0a761fa52b538f
-0000be20: 3130 3634 3733 3666 3663 3633 3433 3030  1064736f6c634300
-0000be30: 3036 3031 3030 3333 2220 2023 206e 6f71  06010033"  # noq
-0000be40: 613a 2045 3530 310a 2020 2020 2020 2020  a: E501.        
-0000be50: 290a 2020 2020 2020 2020 6361 6c6c 5f72  ).        call_r
-0000be60: 6573 756c 7420 3d20 6177 6169 7420 6173  esult = await as
-0000be70: 796e 635f 7733 2e65 7468 2e63 616c 6c28  ync_w3.eth.call(
-0000be80: 0a20 2020 2020 2020 2020 2020 2074 786e  .            txn
-0000be90: 5f70 6172 616d 732c 0a20 2020 2020 2020  _params,.       
-0000bea0: 2020 2020 2022 6c61 7465 7374 222c 0a20       "latest",. 
-0000beb0: 2020 2020 2020 2020 2020 207b 6173 796e             {asyn
-0000bec0: 635f 7265 7665 7274 5f63 6f6e 7472 6163  c_revert_contrac
-0000bed0: 742e 6164 6472 6573 733a 207b 2263 6f64  t.address: {"cod
-0000bee0: 6522 3a20 6f76 6572 7269 6465 5f63 6f64  e": override_cod
-0000bef0: 657d 7d2c 0a20 2020 2020 2020 2029 0a20  e}},.        ). 
-0000bf00: 2020 2020 2020 2028 7265 7375 6c74 2c29         (result,)
-0000bf10: 203d 2061 7379 6e63 5f77 332e 636f 6465   = async_w3.code
-0000bf20: 632e 6465 636f 6465 285b 2262 6f6f 6c22  c.decode(["bool"
-0000bf30: 5d2c 2063 616c 6c5f 7265 7375 6c74 290a  ], call_result).
-0000bf40: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-0000bf50: 6573 756c 7420 6973 2046 616c 7365 0a0a  esult is False..
-0000bf60: 2020 2020 2020 2020 2320 7465 7374 2062          # test b
-0000bf70: 7974 6573 0a0a 2020 2020 2020 2020 6279  ytes..        by
-0000bf80: 7465 735f 6361 6c6c 5f72 6573 756c 7420  tes_call_result 
-0000bf90: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-0000bfa0: 2e65 7468 2e63 616c 6c28 0a20 2020 2020  .eth.call(.     
-0000bfb0: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-0000bfc0: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
-0000bfd0: 6c61 7465 7374 222c 0a20 2020 2020 2020  latest",.       
-0000bfe0: 2020 2020 207b 6173 796e 635f 7265 7665       {async_reve
-0000bff0: 7274 5f63 6f6e 7472 6163 742e 6164 6472  rt_contract.addr
-0000c000: 6573 733a 207b 2263 6f64 6522 3a20 746f  ess: {"code": to
-0000c010: 5f62 7974 6573 2868 6578 7374 723d 6f76  _bytes(hexstr=ov
-0000c020: 6572 7269 6465 5f63 6f64 6529 7d7d 2c0a  erride_code)}},.
-0000c030: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000c040: 2020 2862 7974 6573 5f72 6573 756c 742c    (bytes_result,
-0000c050: 2920 3d20 6173 796e 635f 7733 2e63 6f64  ) = async_w3.cod
-0000c060: 6563 2e64 6563 6f64 6528 5b22 626f 6f6c  ec.decode(["bool
-0000c070: 225d 2c20 6279 7465 735f 6361 6c6c 5f72  "], bytes_call_r
-0000c080: 6573 756c 7429 0a20 2020 2020 2020 2061  esult).        a
-0000c090: 7373 6572 7420 6279 7465 735f 7265 7375  ssert bytes_resu
-0000c0a0: 6c74 2069 7320 4661 6c73 650a 0a20 2020  lt is False..   
-0000c0b0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-0000c0c0: 796e 6369 6f0a 2020 2020 4070 7974 6573  yncio.    @pytes
-0000c0d0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-0000c0e0: 7a65 280a 2020 2020 2020 2020 2270 6172  ze(.        "par
-0000c0f0: 616d 7322 2c0a 2020 2020 2020 2020 280a  ams",.        (.
-0000c100: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-0000c110: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-0000c120: 6f6e 6365 223a 2031 2c20 2023 2069 6e74  once": 1,  # int
-0000c130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c140: 2022 6261 6c61 6e63 6522 3a20 312c 2020   "balance": 1,  
-0000c150: 2320 696e 740a 2020 2020 2020 2020 2020  # int.          
-0000c160: 2020 2020 2020 2263 6f64 6522 3a20 4865        "code": He
-0000c170: 7853 7472 2822 3078 2229 2c20 2023 2048  xStr("0x"),  # H
-0000c180: 6578 5374 720a 2020 2020 2020 2020 2020  exStr.          
-0000c190: 2020 2020 2020 2320 7769 7468 2073 7461        # with sta
-0000c1a0: 7465 0a20 2020 2020 2020 2020 2020 2020  te.             
-0000c1b0: 2020 2022 7374 6174 6522 3a20 7b48 6578     "state": {Hex
-0000c1c0: 5374 7228 6622 3078 7b27 3030 2720 2a20  Str(f"0x{'00' * 
-0000c1d0: 3332 7d22 293a 2048 6578 5374 7228 6622  32}"): HexStr(f"
-0000c1e0: 3078 7b27 3030 2720 2a20 3332 7d22 297d  0x{'00' * 32}")}
-0000c1f0: 2c0a 2020 2020 2020 2020 2020 2020 7d2c  ,.            },
-0000c200: 0a20 2020 2020 2020 2020 2020 207b 0a20  .            {. 
+000076c0: 2e67 6574 5f74 7261 6e73 6163 7469 6f6e  .get_transaction
+000076d0: 2874 786e 5f68 6173 6829 0a0a 2020 2020  (txn_hash)..    
+000076e0: 2020 2020 6c61 7465 7374 5f62 6c6f 636b      latest_block
+000076f0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00007700: 332e 6574 682e 6765 745f 626c 6f63 6b28  3.eth.get_block(
+00007710: 226c 6174 6573 7422 290a 2020 2020 2020  "latest").      
+00007720: 2020 6173 7365 7274 2028 0a20 2020 2020    assert (.     
+00007730: 2020 2020 2020 2074 786e 5b22 6d61 7846         txn["maxF
+00007740: 6565 5065 7247 6173 225d 203d 3d20 6d61  eePerGas"] == ma
+00007750: 785f 6665 650a 2020 2020 2020 2020 2020  x_fee.          
+00007760: 2020 6966 206d 6178 5f66 6565 2069 7320    if max_fee is 
+00007770: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+00007780: 2020 2020 2065 6c73 6520 3220 2a20 6c61       else 2 * la
+00007790: 7465 7374 5f62 6c6f 636b 5b22 6261 7365  test_block["base
+000077a0: 4665 6550 6572 4761 7322 5d20 2b20 6d61  FeePerGas"] + ma
+000077b0: 785f 7072 696f 7269 7479 5f66 6565 0a20  x_priority_fee. 
+000077c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000077d0: 2061 7373 6572 7420 7478 6e5b 226d 6178   assert txn["max
+000077e0: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+000077f0: 7322 5d20 3d3d 206d 6178 5f70 7269 6f72  s"] == max_prior
+00007800: 6974 795f 6665 650a 2020 2020 2020 2020  ity_fee.        
+00007810: 6173 7365 7274 2074 786e 5b22 6761 7350  assert txn["gasP
+00007820: 7269 6365 225d 203d 3d20 7478 6e5b 226d  rice"] == txn["m
+00007830: 6178 4665 6550 6572 4761 7322 5d0a 0a20  axFeePerGas"].. 
+00007840: 2020 2020 2020 2061 7379 6e63 5f77 332e         async_w3.
+00007850: 6574 682e 7365 745f 6761 735f 7072 6963  eth.set_gas_pric
+00007860: 655f 7374 7261 7465 6779 284e 6f6e 6529  e_strategy(None)
+00007870: 2020 2320 7265 7365 7420 7374 7261 7465    # reset strate
+00007880: 6779 0a0a 2020 2020 4070 7974 6573 742e  gy..    @pytest.
+00007890: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+000078a0: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+000078b0: 6761 735f 7072 6963 655f 6672 6f6d 5f73  gas_price_from_s
+000078c0: 7472 6174 6567 795f 6279 7061 7373 6564  trategy_bypassed
+000078d0: 5f66 6f72 5f64 796e 616d 6963 5f66 6565  _for_dynamic_fee
+000078e0: 5f74 786e 5f6e 6f5f 7469 7028 0a20 2020  _txn_no_tip(.   
+000078f0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00007900: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
+00007910: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
+00007920: 2020 6173 796e 635f 756e 6c6f 636b 6564    async_unlocked
+00007930: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+00007940: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
+00007950: 6573 732c 0a20 2020 2029 202d 3e20 4e6f  ess,.    ) -> No
+00007960: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
+00007970: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
+00007980: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00007990: 2022 6672 6f6d 223a 2061 7379 6e63 5f75   "from": async_u
+000079a0: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+000079b0: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+000079c0: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
+000079d0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+000079e0: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
+000079f0: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+00007a00: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+00007a10: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
+00007a20: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
+00007a30: 2020 226d 6178 4665 6550 6572 4761 7322    "maxFeePerGas"
+00007a40: 3a20 5765 6928 3130 3030 3030 3030 3030  : Wei(1000000000
+00007a50: 292c 0a20 2020 2020 2020 207d 0a0a 2020  ),.        }..  
+00007a60: 2020 2020 2020 6465 6620 6761 735f 7072        def gas_pr
+00007a70: 6963 655f 7374 7261 7465 6779 285f 7733  ice_strategy(_w3
+00007a80: 3a20 2257 6562 3322 2c20 5f74 786e 3a20  : "Web3", _txn: 
+00007a90: 5478 5061 7261 6d73 2920 2d3e 2057 6569  TxParams) -> Wei
+00007aa0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00007ab0: 7475 726e 2061 7379 6e63 5f77 332e 746f  turn async_w3.to
+00007ac0: 5f77 6569 2832 2c20 2267 7765 6922 290a  _wei(2, "gwei").
+00007ad0: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
+00007ae0: 332e 6574 682e 7365 745f 6761 735f 7072  3.eth.set_gas_pr
+00007af0: 6963 655f 7374 7261 7465 6779 2867 6173  ice_strategy(gas
+00007b00: 5f70 7269 6365 5f73 7472 6174 6567 7929  _price_strategy)
+00007b10: 0a0a 2020 2020 2020 2020 7769 7468 2070  ..        with p
+00007b20: 7974 6573 742e 7261 6973 6573 280a 2020  ytest.raises(.  
+00007b30: 2020 2020 2020 2020 2020 496e 7661 6c69            Invali
+00007b40: 6454 7261 6e73 6163 7469 6f6e 2c20 6d61  dTransaction, ma
+00007b50: 7463 683d 226d 6178 5072 696f 7269 7479  tch="maxPriority
+00007b60: 4665 6550 6572 4761 7320 6d75 7374 2062  FeePerGas must b
+00007b70: 6520 6465 6669 6e65 6422 0a20 2020 2020  e defined".     
+00007b80: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00007b90: 2020 6177 6169 7420 6173 796e 635f 7733    await async_w3
+00007ba0: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+00007bb0: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
+00007bc0: 290a 0a20 2020 2020 2020 2061 7379 6e63  )..        async
+00007bd0: 5f77 332e 6574 682e 7365 745f 6761 735f  _w3.eth.set_gas_
+00007be0: 7072 6963 655f 7374 7261 7465 6779 284e  price_strategy(N
+00007bf0: 6f6e 6529 2020 2320 7265 7365 7420 7374  one)  # reset st
+00007c00: 7261 7465 6779 0a0a 2020 2020 4070 7974  rategy..    @pyt
+00007c10: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+00007c20: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+00007c30: 6573 745f 6574 685f 6573 7469 6d61 7465  est_eth_estimate
+00007c40: 5f67 6173 280a 2020 2020 2020 2020 7365  _gas(.        se
+00007c50: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00007c60: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
+00007c70: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+00007c80: 745f 6475 616c 5f74 7970 653a 2043 6865  t_dual_type: Che
+00007c90: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
+00007ca0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00007cb0: 2020 2020 6761 735f 6573 7469 6d61 7465      gas_estimate
+00007cc0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00007cd0: 332e 6574 682e 6573 7469 6d61 7465 5f67  3.eth.estimate_g
+00007ce0: 6173 280a 2020 2020 2020 2020 2020 2020  as(.            
+00007cf0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00007d00: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
+00007d10: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+00007d20: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
+00007d30: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+00007d40: 3a20 6173 796e 635f 756e 6c6f 636b 6564  : async_unlocked
+00007d50: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+00007d60: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+00007d70: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
+00007d80: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
+00007d90: 207d 0a20 2020 2020 2020 2029 0a20 2020   }.        ).   
+00007da0: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
+00007db0: 6e74 6567 6572 2867 6173 5f65 7374 696d  nteger(gas_estim
+00007dc0: 6174 6529 0a20 2020 2020 2020 2061 7373  ate).        ass
+00007dd0: 6572 7420 6761 735f 6573 7469 6d61 7465  ert gas_estimate
+00007de0: 203e 2030 0a0a 2020 2020 4070 7974 6573   > 0..    @pytes
+00007df0: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+00007e00: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
+00007e10: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
+00007e20: 2020 2020 2022 7061 7261 6d73 222c 0a20       "params",. 
+00007e30: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
+00007e40: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+00007e50: 2020 2020 2020 2022 6e6f 6e63 6522 3a20         "nonce": 
+00007e60: 312c 2020 2320 696e 740a 2020 2020 2020  1,  # int.      
+00007e70: 2020 2020 2020 2020 2020 2262 616c 616e            "balan
+00007e80: 6365 223a 2031 2c20 2023 2069 6e74 0a20  ce": 1,  # int. 
+00007e90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00007ea0: 636f 6465 223a 2048 6578 5374 7228 2230  code": HexStr("0
+00007eb0: 7822 292c 2020 2320 4865 7853 7472 0a20  x"),  # HexStr. 
+00007ec0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00007ed0: 2077 6974 6820 7374 6174 650a 2020 2020   with state.    
+00007ee0: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
+00007ef0: 7465 223a 207b 4865 7853 7472 2866 2230  te": {HexStr(f"0
+00007f00: 787b 2730 3027 202a 2033 327d 2229 3a20  x{'00' * 32}"): 
+00007f10: 4865 7853 7472 2866 2230 787b 2730 3027  HexStr(f"0x{'00'
+00007f20: 202a 2033 327d 2229 7d2c 0a20 2020 2020   * 32}")},.     
+00007f30: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00007f40: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00007f50: 2020 2020 2020 2020 226e 6f6e 6365 223a          "nonce":
+00007f60: 2048 6578 5374 7228 2230 7831 2229 2c20   HexStr("0x1"), 
+00007f70: 2023 2048 6578 5374 720a 2020 2020 2020   # HexStr.      
+00007f80: 2020 2020 2020 2020 2020 2262 616c 616e            "balan
+00007f90: 6365 223a 2048 6578 5374 7228 2230 7831  ce": HexStr("0x1
+00007fa0: 2229 2c20 2023 2048 6578 5374 720a 2020  "),  # HexStr.  
+00007fb0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00007fc0: 6f64 6522 3a20 6222 5c78 3030 222c 2020  ode": b"\x00",  
+00007fd0: 2320 6279 7465 730a 2020 2020 2020 2020  # bytes.        
+00007fe0: 2020 2020 2020 2020 2320 7769 7468 2073          # with s
+00007ff0: 7461 7465 4469 6666 0a20 2020 2020 2020  tateDiff.       
+00008000: 2020 2020 2020 2020 2022 7374 6174 6544           "stateD
+00008010: 6966 6622 3a20 7b48 6578 5374 7228 6622  iff": {HexStr(f"
+00008020: 3078 7b27 3030 2720 2a20 3332 7d22 293a  0x{'00' * 32}"):
+00008030: 2048 6578 5374 7228 6622 3078 7b27 3030   HexStr(f"0x{'00
+00008040: 2720 2a20 3332 7d22 297d 2c0a 2020 2020  ' * 32}")},.    
+00008050: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+00008060: 2020 2029 2c0a 2020 2020 290a 2020 2020     ),.    ).    
+00008070: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
+00008080: 7468 5f65 7374 696d 6174 655f 6761 735f  th_estimate_gas_
+00008090: 7769 7468 5f6f 7665 7272 6964 655f 7061  with_override_pa
+000080a0: 7261 6d5f 7479 7065 5f63 6865 636b 280a  ram_type_check(.
+000080b0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000080c0: 2020 2020 2020 6173 796e 635f 7733 3a20        async_w3: 
+000080d0: 2241 7379 6e63 5765 6233 222c 0a20 2020  "AsyncWeb3",.   
+000080e0: 2020 2020 2061 7379 6e63 5f6d 6174 685f       async_math_
+000080f0: 636f 6e74 7261 6374 3a20 2241 7379 6e63  contract: "Async
+00008100: 436f 6e74 7261 6374 222c 0a20 2020 2020  Contract",.     
+00008110: 2020 2070 6172 616d 733a 2053 7461 7465     params: State
+00008120: 4f76 6572 7269 6465 5061 7261 6d73 2c0a  OverrideParams,.
+00008130: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00008140: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+00008150: 733a 2054 7850 6172 616d 7320 3d20 7b22  s: TxParams = {"
+00008160: 6672 6f6d 223a 2061 7761 6974 2061 7379  from": await asy
+00008170: 6e63 5f77 332e 6574 682e 636f 696e 6261  nc_w3.eth.coinba
+00008180: 7365 7d0a 0a20 2020 2020 2020 2023 2061  se}..        # a
+00008190: 7373 6572 7420 646f 6573 206e 6f74 2072  ssert does not r
+000081a0: 6169 7365 0a20 2020 2020 2020 2061 7761  aise.        awa
+000081b0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+000081c0: 6573 7469 6d61 7465 5f67 6173 280a 2020  estimate_gas(.  
+000081d0: 2020 2020 2020 2020 2020 7478 6e5f 7061            txn_pa
+000081e0: 7261 6d73 2c20 4e6f 6e65 2c20 7b61 7379  rams, None, {asy
+000081f0: 6e63 5f6d 6174 685f 636f 6e74 7261 6374  nc_math_contract
+00008200: 2e61 6464 7265 7373 3a20 7061 7261 6d73  .address: params
+00008210: 7d0a 2020 2020 2020 2020 290a 0a20 2020  }.        )..   
+00008220: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00008230: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+00008240: 6465 6620 7465 7374 5f65 7468 5f66 6565  def test_eth_fee
+00008250: 5f68 6973 746f 7279 2873 656c 662c 2061  _history(self, a
+00008260: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
+00008270: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
+00008280: 2020 2020 2020 2066 6565 5f68 6973 746f         fee_histo
+00008290: 7279 203d 2061 7761 6974 2061 7379 6e63  ry = await async
+000082a0: 5f77 332e 6574 682e 6665 655f 6869 7374  _w3.eth.fee_hist
+000082b0: 6f72 7928 312c 2022 6c61 7465 7374 222c  ory(1, "latest",
+000082c0: 205b 3530 5d29 0a20 2020 2020 2020 2061   [50]).        a
+000082d0: 7373 6572 7420 6973 5f6c 6973 745f 6c69  ssert is_list_li
+000082e0: 6b65 2866 6565 5f68 6973 746f 7279 5b22  ke(fee_history["
+000082f0: 6261 7365 4665 6550 6572 4761 7322 5d29  baseFeePerGas"])
+00008300: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00008310: 6973 5f6c 6973 745f 6c69 6b65 2866 6565  is_list_like(fee
+00008320: 5f68 6973 746f 7279 5b22 6761 7355 7365  _history["gasUse
+00008330: 6452 6174 696f 225d 290a 2020 2020 2020  dRatio"]).      
+00008340: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
+00008350: 6765 7228 6665 655f 6869 7374 6f72 795b  ger(fee_history[
+00008360: 226f 6c64 6573 7442 6c6f 636b 225d 290a  "oldestBlock"]).
+00008370: 2020 2020 2020 2020 6173 7365 7274 2066          assert f
+00008380: 6565 5f68 6973 746f 7279 5b22 6f6c 6465  ee_history["olde
+00008390: 7374 426c 6f63 6b22 5d20 3e3d 2030 0a20  stBlock"] >= 0. 
+000083a0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+000083b0: 5f6c 6973 745f 6c69 6b65 2866 6565 5f68  _list_like(fee_h
+000083c0: 6973 746f 7279 5b22 7265 7761 7264 225d  istory["reward"]
+000083d0: 290a 2020 2020 2020 2020 6966 206c 656e  ).        if len
+000083e0: 2866 6565 5f68 6973 746f 7279 5b22 7265  (fee_history["re
+000083f0: 7761 7264 225d 2920 3e20 303a 0a20 2020  ward"]) > 0:.   
+00008400: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+00008410: 6973 5f6c 6973 745f 6c69 6b65 2866 6565  is_list_like(fee
+00008420: 5f68 6973 746f 7279 5b22 7265 7761 7264  _history["reward
+00008430: 225d 5b30 5d29 0a0a 2020 2020 4070 7974  "][0])..    @pyt
+00008440: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+00008450: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+00008460: 6573 745f 6574 685f 6665 655f 6869 7374  est_eth_fee_hist
+00008470: 6f72 795f 7769 7468 5f69 6e74 6567 6572  ory_with_integer
+00008480: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00008490: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+000084a0: 5765 6233 222c 2061 7379 6e63 5f65 6d70  Web3", async_emp
+000084b0: 7479 5f62 6c6f 636b 3a20 426c 6f63 6b44  ty_block: BlockD
+000084c0: 6174 610a 2020 2020 2920 2d3e 204e 6f6e  ata.    ) -> Non
+000084d0: 653a 0a20 2020 2020 2020 2066 6565 5f68  e:.        fee_h
+000084e0: 6973 746f 7279 203d 2061 7761 6974 2061  istory = await a
+000084f0: 7379 6e63 5f77 332e 6574 682e 6665 655f  sync_w3.eth.fee_
+00008500: 6869 7374 6f72 7928 0a20 2020 2020 2020  history(.       
+00008510: 2020 2020 2031 2c20 6173 796e 635f 656d       1, async_em
+00008520: 7074 795f 626c 6f63 6b5b 226e 756d 6265  pty_block["numbe
+00008530: 7222 5d2c 205b 3530 5d0a 2020 2020 2020  r"], [50].      
+00008540: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
+00008550: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
+00008560: 6665 655f 6869 7374 6f72 795b 2262 6173  fee_history["bas
+00008570: 6546 6565 5065 7247 6173 225d 290a 2020  eFeePerGas"]).  
+00008580: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+00008590: 6c69 7374 5f6c 696b 6528 6665 655f 6869  list_like(fee_hi
+000085a0: 7374 6f72 795b 2267 6173 5573 6564 5261  story["gasUsedRa
+000085b0: 7469 6f22 5d29 0a20 2020 2020 2020 2061  tio"]).        a
+000085c0: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
+000085d0: 2866 6565 5f68 6973 746f 7279 5b22 6f6c  (fee_history["ol
+000085e0: 6465 7374 426c 6f63 6b22 5d29 0a20 2020  destBlock"]).   
+000085f0: 2020 2020 2061 7373 6572 7420 6665 655f       assert fee_
+00008600: 6869 7374 6f72 795b 226f 6c64 6573 7442  history["oldestB
+00008610: 6c6f 636b 225d 203e 3d20 300a 2020 2020  lock"] >= 0.    
+00008620: 2020 2020 6173 7365 7274 2069 735f 6c69      assert is_li
+00008630: 7374 5f6c 696b 6528 6665 655f 6869 7374  st_like(fee_hist
+00008640: 6f72 795b 2272 6577 6172 6422 5d29 0a20  ory["reward"]). 
+00008650: 2020 2020 2020 2069 6620 6c65 6e28 6665         if len(fe
+00008660: 655f 6869 7374 6f72 795b 2272 6577 6172  e_history["rewar
+00008670: 6422 5d29 203e 2030 3a0a 2020 2020 2020  d"]) > 0:.      
+00008680: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+00008690: 6c69 7374 5f6c 696b 6528 6665 655f 6869  list_like(fee_hi
+000086a0: 7374 6f72 795b 2272 6577 6172 6422 5d5b  story["reward"][
+000086b0: 305d 290a 0a20 2020 2040 7079 7465 7374  0])..    @pytest
+000086c0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+000086d0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+000086e0: 5f65 7468 5f66 6565 5f68 6973 746f 7279  _eth_fee_history
+000086f0: 5f6e 6f5f 7265 7761 7264 5f70 6572 6365  _no_reward_perce
+00008700: 6e74 696c 6573 280a 2020 2020 2020 2020  ntiles(.        
+00008710: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+00008720: 2241 7379 6e63 5765 6233 220a 2020 2020  "AsyncWeb3".    
+00008730: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00008740: 2020 2066 6565 5f68 6973 746f 7279 203d     fee_history =
+00008750: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00008760: 6574 682e 6665 655f 6869 7374 6f72 7928  eth.fee_history(
+00008770: 312c 2022 6c61 7465 7374 2229 0a20 2020  1, "latest").   
+00008780: 2020 2020 2061 7373 6572 7420 6973 5f6c       assert is_l
+00008790: 6973 745f 6c69 6b65 2866 6565 5f68 6973  ist_like(fee_his
+000087a0: 746f 7279 5b22 6261 7365 4665 6550 6572  tory["baseFeePer
+000087b0: 4761 7322 5d29 0a20 2020 2020 2020 2061  Gas"]).        a
+000087c0: 7373 6572 7420 6973 5f6c 6973 745f 6c69  ssert is_list_li
+000087d0: 6b65 2866 6565 5f68 6973 746f 7279 5b22  ke(fee_history["
+000087e0: 6761 7355 7365 6452 6174 696f 225d 290a  gasUsedRatio"]).
+000087f0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00008800: 735f 696e 7465 6765 7228 6665 655f 6869  s_integer(fee_hi
+00008810: 7374 6f72 795b 226f 6c64 6573 7442 6c6f  story["oldestBlo
+00008820: 636b 225d 290a 2020 2020 2020 2020 6173  ck"]).        as
+00008830: 7365 7274 2066 6565 5f68 6973 746f 7279  sert fee_history
+00008840: 5b22 6f6c 6465 7374 426c 6f63 6b22 5d20  ["oldestBlock"] 
+00008850: 3e3d 2030 0a0a 2020 2020 4070 7974 6573  >= 0..    @pytes
+00008860: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+00008870: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+00008880: 745f 6574 685f 6d61 785f 7072 696f 7269  t_eth_max_priori
+00008890: 7479 5f66 6565 2873 656c 662c 2061 7379  ty_fee(self, asy
+000088a0: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
+000088b0: 3322 2920 2d3e 204e 6f6e 653a 0a20 2020  3") -> None:.   
+000088c0: 2020 2020 206d 6178 5f70 7269 6f72 6974       max_priorit
+000088d0: 795f 6665 6520 3d20 6177 6169 7420 6173  y_fee = await as
+000088e0: 796e 635f 7733 2e65 7468 2e6d 6178 5f70  ync_w3.eth.max_p
+000088f0: 7269 6f72 6974 795f 6665 650a 2020 2020  riority_fee.    
+00008900: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
+00008910: 7465 6765 7228 6d61 785f 7072 696f 7269  teger(max_priori
+00008920: 7479 5f66 6565 290a 0a20 2020 2040 7079  ty_fee)..    @py
+00008930: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+00008940: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+00008950: 7465 7374 5f65 7468 5f6d 6178 5f70 7269  test_eth_max_pri
+00008960: 6f72 6974 795f 6665 655f 7769 7468 5f66  ority_fee_with_f
+00008970: 6565 5f68 6973 746f 7279 5f63 616c 6375  ee_history_calcu
+00008980: 6c61 7469 6f6e 280a 2020 2020 2020 2020  lation(.        
+00008990: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+000089a0: 2241 7379 6e63 5765 6233 222c 2072 6571  "AsyncWeb3", req
+000089b0: 7565 7374 5f6d 6f63 6b65 723a 2054 7970  uest_mocker: Typ
+000089c0: 655b 5265 7175 6573 744d 6f63 6b65 725d  e[RequestMocker]
+000089d0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+000089e0: 2020 2020 2020 2020 6173 796e 6320 7769          async wi
+000089f0: 7468 2072 6571 7565 7374 5f6d 6f63 6b65  th request_mocke
+00008a00: 7228 0a20 2020 2020 2020 2020 2020 2061  r(.            a
+00008a10: 7379 6e63 5f77 332c 0a20 2020 2020 2020  sync_w3,.       
+00008a20: 2020 2020 206d 6f63 6b5f 6572 726f 7273       mock_errors
+00008a30: 3d7b 5250 4345 6e64 706f 696e 7428 2265  ={RPCEndpoint("e
+00008a40: 7468 5f6d 6178 5072 696f 7269 7479 4665  th_maxPriorityFe
+00008a50: 6550 6572 4761 7322 293a 207b 7d7d 2c0a  ePerGas"): {}},.
+00008a60: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+00008a70: 5f72 6573 756c 7473 3d7b 5250 4345 6e64  _results={RPCEnd
+00008a80: 706f 696e 7428 2265 7468 5f66 6565 4869  point("eth_feeHi
+00008a90: 7374 6f72 7922 293a 207b 2272 6577 6172  story"): {"rewar
+00008aa0: 6422 3a20 5b5b 305d 5d7d 7d2c 0a20 2020  d": [[0]]}},.   
+00008ab0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00008ac0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+00008ad0: 7761 726e 7328 0a20 2020 2020 2020 2020  warns(.         
+00008ae0: 2020 2020 2020 2055 7365 7257 6172 6e69         UserWarni
+00008af0: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
+00008b00: 2020 2020 6d61 7463 683d 280a 2020 2020      match=(.    
+00008b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008b20: 2254 6865 7265 2077 6173 2061 6e20 6973  "There was an is
+00008b30: 7375 6520 7769 7468 2074 6865 206d 6574  sue with the met
+00008b40: 686f 6420 6574 685f 6d61 7850 7269 6f72  hod eth_maxPrior
+00008b50: 6974 7946 6565 5065 7247 6173 2e20 220a  ityFeePerGas. ".
+00008b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008b70: 2020 2020 2243 616c 6375 6c61 7469 6e67      "Calculating
+00008b80: 2075 7369 6e67 2065 7468 5f66 6565 4869   using eth_feeHi
+00008b90: 7374 6f72 792e 220a 2020 2020 2020 2020  story.".        
+00008ba0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+00008bb0: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00008bc0: 2020 2020 2020 2020 2020 7072 696f 7269            priori
+00008bd0: 7479 5f66 6565 203d 2061 7761 6974 2061  ty_fee = await a
+00008be0: 7379 6e63 5f77 332e 6574 682e 6d61 785f  sync_w3.eth.max_
+00008bf0: 7072 696f 7269 7479 5f66 6565 0a20 2020  priority_fee.   
+00008c00: 2020 2020 2020 2020 2020 2020 2061 7373               ass
+00008c10: 6572 7420 6973 5f69 6e74 6567 6572 2870  ert is_integer(p
+00008c20: 7269 6f72 6974 795f 6665 6529 0a20 2020  riority_fee).   
+00008c30: 2020 2020 2020 2020 2020 2020 2061 7373               ass
+00008c40: 6572 7420 7072 696f 7269 7479 5f66 6565  ert priority_fee
+00008c50: 203d 3d20 5052 494f 5249 5459 5f46 4545   == PRIORITY_FEE
+00008c60: 5f4d 494e 0a0a 2020 2020 4070 7974 6573  _MIN..    @pytes
+00008c70: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+00008c80: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+00008c90: 745f 6574 685f 6765 7442 6c6f 636b 4279  t_eth_getBlockBy
+00008ca0: 4861 7368 280a 2020 2020 2020 2020 7365  Hash(.        se
+00008cb0: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00008cc0: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
+00008cd0: 5f65 6d70 7479 5f62 6c6f 636b 3a20 426c  _empty_block: Bl
+00008ce0: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+00008cf0: 204e 6f6e 653a 0a20 2020 2020 2020 2062   None:.        b
+00008d00: 6c6f 636b 203d 2061 7761 6974 2061 7379  lock = await asy
+00008d10: 6e63 5f77 332e 6574 682e 6765 745f 626c  nc_w3.eth.get_bl
+00008d20: 6f63 6b28 6173 796e 635f 656d 7074 795f  ock(async_empty_
+00008d30: 626c 6f63 6b5b 2268 6173 6822 5d29 0a20  block["hash"]). 
+00008d40: 2020 2020 2020 2061 7373 6572 7420 626c         assert bl
+00008d50: 6f63 6b5b 2268 6173 6822 5d20 3d3d 2061  ock["hash"] == a
+00008d60: 7379 6e63 5f65 6d70 7479 5f62 6c6f 636b  sync_empty_block
+00008d70: 5b22 6861 7368 225d 0a0a 2020 2020 4070  ["hash"]..    @p
+00008d80: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+00008d90: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
+00008da0: 2074 6573 745f 6574 685f 6765 7442 6c6f   test_eth_getBlo
+00008db0: 636b 4279 4861 7368 5f6e 6f74 5f66 6f75  ckByHash_not_fou
+00008dc0: 6e64 2873 656c 662c 2061 7379 6e63 5f77  nd(self, async_w
+00008dd0: 333a 2022 4173 796e 6357 6562 3322 2920  3: "AsyncWeb3") 
+00008de0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00008df0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+00008e00: 7365 7328 426c 6f63 6b4e 6f74 466f 756e  ses(BlockNotFoun
+00008e10: 6429 3a0a 2020 2020 2020 2020 2020 2020  d):.            
+00008e20: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00008e30: 7468 2e67 6574 5f62 6c6f 636b 2855 4e4b  th.get_block(UNK
+00008e40: 4e4f 574e 5f48 4153 4829 0a0a 2020 2020  NOWN_HASH)..    
+00008e50: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+00008e60: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+00008e70: 6566 2074 6573 745f 6574 685f 6765 7442  ef test_eth_getB
+00008e80: 6c6f 636b 4279 4861 7368 5f70 656e 6469  lockByHash_pendi
+00008e90: 6e67 2873 656c 662c 2061 7379 6e63 5f77  ng(self, async_w
+00008ea0: 333a 2022 4173 796e 6357 6562 3322 2920  3: "AsyncWeb3") 
+00008eb0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00008ec0: 2062 6c6f 636b 203d 2061 7761 6974 2061   block = await a
+00008ed0: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+00008ee0: 626c 6f63 6b28 2270 656e 6469 6e67 2229  block("pending")
+00008ef0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00008f00: 626c 6f63 6b5b 2268 6173 6822 5d20 6973  block["hash"] is
+00008f10: 204e 6f6e 650a 0a20 2020 2040 7079 7465   None..    @pyte
+00008f20: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+00008f30: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+00008f40: 7374 5f65 7468 5f67 6574 426c 6f63 6b42  st_eth_getBlockB
+00008f50: 794e 756d 6265 725f 7769 7468 5f69 6e74  yNumber_with_int
+00008f60: 6567 6572 280a 2020 2020 2020 2020 7365  eger(.        se
+00008f70: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00008f80: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
+00008f90: 5f65 6d70 7479 5f62 6c6f 636b 3a20 426c  _empty_block: Bl
+00008fa0: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+00008fb0: 204e 6f6e 653a 0a20 2020 2020 2020 2062   None:.        b
+00008fc0: 6c6f 636b 203d 2061 7761 6974 2061 7379  lock = await asy
+00008fd0: 6e63 5f77 332e 6574 682e 6765 745f 626c  nc_w3.eth.get_bl
+00008fe0: 6f63 6b28 6173 796e 635f 656d 7074 795f  ock(async_empty_
+00008ff0: 626c 6f63 6b5b 226e 756d 6265 7222 5d29  block["number"])
+00009000: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00009010: 626c 6f63 6b5b 226e 756d 6265 7222 5d20  block["number"] 
+00009020: 3d3d 2061 7379 6e63 5f65 6d70 7479 5f62  == async_empty_b
+00009030: 6c6f 636b 5b22 6e75 6d62 6572 225d 0a0a  lock["number"]..
+00009040: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+00009050: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+00009060: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
+00009070: 6765 7442 6c6f 636b 4279 4e75 6d62 6572  getBlockByNumber
+00009080: 5f6c 6174 6573 7428 0a20 2020 2020 2020  _latest(.       
+00009090: 2073 656c 662c 2061 7379 6e63 5f77 333a   self, async_w3:
+000090a0: 2022 4173 796e 6357 6562 3322 2c20 6173   "AsyncWeb3", as
+000090b0: 796e 635f 656d 7074 795f 626c 6f63 6b3a  ync_empty_block:
+000090c0: 2042 6c6f 636b 4461 7461 0a20 2020 2029   BlockData.    )
+000090d0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+000090e0: 2020 6375 7272 656e 745f 626c 6f63 6b5f    current_block_
+000090f0: 6e75 6d62 6572 203d 2061 7761 6974 2061  number = await a
+00009100: 7379 6e63 5f77 332e 6574 682e 626c 6f63  sync_w3.eth.bloc
+00009110: 6b5f 6e75 6d62 6572 0a20 2020 2020 2020  k_number.       
+00009120: 2062 6c6f 636b 203d 2061 7761 6974 2061   block = await a
+00009130: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+00009140: 626c 6f63 6b28 226c 6174 6573 7422 290a  block("latest").
+00009150: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
+00009160: 6c6f 636b 5b22 6e75 6d62 6572 225d 203d  lock["number"] =
+00009170: 3d20 6375 7272 656e 745f 626c 6f63 6b5f  = current_block_
+00009180: 6e75 6d62 6572 0a0a 2020 2020 4070 7974  number..    @pyt
+00009190: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+000091a0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+000091b0: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
+000091c0: 4279 4e75 6d62 6572 5f6e 6f74 5f66 6f75  ByNumber_not_fou
+000091d0: 6e64 280a 2020 2020 2020 2020 7365 6c66  nd(.        self
+000091e0: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
+000091f0: 6e63 5765 6233 222c 2061 7379 6e63 5f65  ncWeb3", async_e
+00009200: 6d70 7479 5f62 6c6f 636b 3a20 426c 6f63  mpty_block: Bloc
+00009210: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
+00009220: 6f6e 653a 0a20 2020 2020 2020 2077 6974  one:.        wit
+00009230: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+00009240: 426c 6f63 6b4e 6f74 466f 756e 6429 3a0a  BlockNotFound):.
+00009250: 2020 2020 2020 2020 2020 2020 6177 6169              awai
+00009260: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
+00009270: 6574 5f62 6c6f 636b 2842 6c6f 636b 4e75  et_block(BlockNu
+00009280: 6d62 6572 2831 3233 3435 2929 0a0a 2020  mber(12345))..  
+00009290: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+000092a0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+000092b0: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+000092c0: 7442 6c6f 636b 4279 4e75 6d62 6572 5f70  tBlockByNumber_p
+000092d0: 656e 6469 6e67 280a 2020 2020 2020 2020  ending(.        
+000092e0: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+000092f0: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
+00009300: 6e63 5f65 6d70 7479 5f62 6c6f 636b 3a20  nc_empty_block: 
+00009310: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
+00009320: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00009330: 2063 7572 7265 6e74 5f62 6c6f 636b 5f6e   current_block_n
+00009340: 756d 6265 7220 3d20 6177 6169 7420 6173  umber = await as
+00009350: 796e 635f 7733 2e65 7468 2e62 6c6f 636b  ync_w3.eth.block
+00009360: 5f6e 756d 6265 720a 2020 2020 2020 2020  _number.        
+00009370: 626c 6f63 6b20 3d20 6177 6169 7420 6173  block = await as
+00009380: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
+00009390: 6c6f 636b 2822 7065 6e64 696e 6722 290a  lock("pending").
+000093a0: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
+000093b0: 6c6f 636b 5b22 6e75 6d62 6572 225d 203d  lock["number"] =
+000093c0: 3d20 6375 7272 656e 745f 626c 6f63 6b5f  = current_block_
+000093d0: 6e75 6d62 6572 202b 2031 0a0a 2020 2020  number + 1..    
+000093e0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+000093f0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+00009400: 6566 2074 6573 745f 6574 685f 6765 7442  ef test_eth_getB
+00009410: 6c6f 636b 4279 4e75 6d62 6572 5f65 6172  lockByNumber_ear
+00009420: 6c69 6573 7428 0a20 2020 2020 2020 2073  liest(.        s
+00009430: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
+00009440: 4173 796e 6357 6562 3322 2c20 6173 796e  AsyncWeb3", asyn
+00009450: 635f 656d 7074 795f 626c 6f63 6b3a 2042  c_empty_block: B
+00009460: 6c6f 636b 4461 7461 0a20 2020 2029 202d  lockData.    ) -
+00009470: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00009480: 6765 6e65 7369 735f 626c 6f63 6b20 3d20  genesis_block = 
+00009490: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+000094a0: 7468 2e67 6574 5f62 6c6f 636b 2842 6c6f  th.get_block(Blo
+000094b0: 636b 4e75 6d62 6572 2830 2929 0a20 2020  ckNumber(0)).   
+000094c0: 2020 2020 2062 6c6f 636b 203d 2061 7761       block = awa
+000094d0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+000094e0: 6765 745f 626c 6f63 6b28 2265 6172 6c69  get_block("earli
+000094f0: 6573 7422 290a 2020 2020 2020 2020 6173  est").        as
+00009500: 7365 7274 2062 6c6f 636b 5b22 6e75 6d62  sert block["numb
+00009510: 6572 225d 203d 3d20 300a 2020 2020 2020  er"] == 0.      
+00009520: 2020 6173 7365 7274 2062 6c6f 636b 5b22    assert block["
+00009530: 6861 7368 225d 203d 3d20 6765 6e65 7369  hash"] == genesi
+00009540: 735f 626c 6f63 6b5b 2268 6173 6822 5d0a  s_block["hash"].
+00009550: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00009560: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+00009570: 796e 6320 6465 6620 7465 7374 5f65 7468  ync def test_eth
+00009580: 5f67 6574 426c 6f63 6b42 794e 756d 6265  _getBlockByNumbe
+00009590: 725f 7361 6665 280a 2020 2020 2020 2020  r_safe(.        
+000095a0: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+000095b0: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
+000095c0: 6e63 5f65 6d70 7479 5f62 6c6f 636b 3a20  nc_empty_block: 
+000095d0: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
+000095e0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+000095f0: 2062 6c6f 636b 203d 2061 7761 6974 2061   block = await a
+00009600: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+00009610: 626c 6f63 6b28 2273 6166 6522 290a 2020  block("safe").  
+00009620: 2020 2020 2020 6173 7365 7274 2062 6c6f        assert blo
+00009630: 636b 2069 7320 6e6f 7420 4e6f 6e65 0a20  ck is not None. 
+00009640: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00009650: 696e 7374 616e 6365 2862 6c6f 636b 5b22  instance(block["
+00009660: 6e75 6d62 6572 225d 2c20 696e 7429 0a0a  number"], int)..
+00009670: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+00009680: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+00009690: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
+000096a0: 6765 7442 6c6f 636b 4279 4e75 6d62 6572  getBlockByNumber
+000096b0: 5f66 696e 616c 697a 6564 280a 2020 2020  _finalized(.    
+000096c0: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
+000096d0: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+000096e0: 2061 7379 6e63 5f65 6d70 7479 5f62 6c6f   async_empty_blo
+000096f0: 636b 3a20 426c 6f63 6b44 6174 610a 2020  ck: BlockData.  
+00009700: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00009710: 2020 2020 2062 6c6f 636b 203d 2061 7761       block = awa
+00009720: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00009730: 6765 745f 626c 6f63 6b28 2266 696e 616c  get_block("final
+00009740: 697a 6564 2229 0a20 2020 2020 2020 2061  ized").        a
+00009750: 7373 6572 7420 626c 6f63 6b20 6973 206e  ssert block is n
+00009760: 6f74 204e 6f6e 650a 2020 2020 2020 2020  ot None.        
+00009770: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
+00009780: 6528 626c 6f63 6b5b 226e 756d 6265 7222  e(block["number"
+00009790: 5d2c 2069 6e74 290a 0a20 2020 2040 7079  ], int)..    @py
+000097a0: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+000097b0: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+000097c0: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
+000097d0: 6b52 6563 6569 7074 735f 6861 7368 280a  kReceipts_hash(.
+000097e0: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+000097f0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00009800: 6233 222c 2061 7379 6e63 5f65 6d70 7479  b3", async_empty
+00009810: 5f62 6c6f 636b 3a20 426c 6f63 6b44 6174  _block: BlockDat
+00009820: 610a 2020 2020 2920 2d3e 204e 6f6e 653a  a.    ) -> None:
+00009830: 0a20 2020 2020 2020 2072 6563 6569 7074  .        receipt
+00009840: 7320 3d20 6177 6169 7420 6173 796e 635f  s = await async_
+00009850: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
+00009860: 5f72 6563 6569 7074 7328 6173 796e 635f  _receipts(async_
+00009870: 656d 7074 795f 626c 6f63 6b5b 2268 6173  empty_block["has
+00009880: 6822 5d29 0a20 2020 2020 2020 2061 7373  h"]).        ass
+00009890: 6572 7420 6973 696e 7374 616e 6365 2872  ert isinstance(r
+000098a0: 6563 6569 7074 732c 206c 6973 7429 0a0a  eceipts, list)..
+000098b0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+000098c0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+000098d0: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
+000098e0: 6765 7442 6c6f 636b 5265 6365 6970 7473  getBlockReceipts
+000098f0: 5f6e 6f74 5f66 6f75 6e64 2873 656c 662c  _not_found(self,
+00009900: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+00009910: 6357 6562 3322 2920 2d3e 204e 6f6e 653a  cWeb3") -> None:
+00009920: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+00009930: 7465 7374 2e72 6169 7365 7328 426c 6f63  test.raises(Bloc
+00009940: 6b4e 6f74 466f 756e 6429 3a0a 2020 2020  kNotFound):.    
+00009950: 2020 2020 2020 2020 6177 6169 7420 6173          await as
+00009960: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
+00009970: 6c6f 636b 5f72 6563 6569 7074 7328 554e  lock_receipts(UN
+00009980: 4b4e 4f57 4e5f 4841 5348 290a 0a20 2020  KNOWN_HASH)..   
+00009990: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+000099a0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+000099b0: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
+000099c0: 426c 6f63 6b52 6563 6569 7074 735f 7769  BlockReceipts_wi
+000099d0: 7468 5f69 6e74 6567 6572 280a 2020 2020  th_integer(.    
+000099e0: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
+000099f0: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+00009a00: 2061 7379 6e63 5f65 6d70 7479 5f62 6c6f   async_empty_blo
+00009a10: 636b 3a20 426c 6f63 6b44 6174 610a 2020  ck: BlockData.  
+00009a20: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00009a30: 2020 2020 2072 6563 6569 7074 7320 3d20       receipts = 
+00009a40: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00009a50: 7468 2e67 6574 5f62 6c6f 636b 5f72 6563  th.get_block_rec
+00009a60: 6569 7074 7328 6173 796e 635f 656d 7074  eipts(async_empt
+00009a70: 795f 626c 6f63 6b5b 226e 756d 6265 7222  y_block["number"
+00009a80: 5d29 0a20 2020 2020 2020 2061 7373 6572  ]).        asser
+00009a90: 7420 6973 696e 7374 616e 6365 2872 6563  t isinstance(rec
+00009aa0: 6569 7074 732c 206c 6973 7429 0a0a 2020  eipts, list)..  
+00009ab0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+00009ac0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+00009ad0: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+00009ae0: 7442 6c6f 636b 5265 6365 6970 7473 5f73  tBlockReceipts_s
+00009af0: 6166 6528 0a20 2020 2020 2020 2073 656c  afe(.        sel
+00009b00: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
+00009b10: 796e 6357 6562 3322 2c20 6173 796e 635f  yncWeb3", async_
+00009b20: 656d 7074 795f 626c 6f63 6b3a 2042 6c6f  empty_block: Blo
+00009b30: 636b 4461 7461 0a20 2020 2029 202d 3e20  ckData.    ) -> 
+00009b40: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
+00009b50: 6365 6970 7473 203d 2061 7761 6974 2061  ceipts = await a
+00009b60: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+00009b70: 626c 6f63 6b5f 7265 6365 6970 7473 2822  block_receipts("
+00009b80: 7361 6665 2229 0a20 2020 2020 2020 2061  safe").        a
+00009b90: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
+00009ba0: 2872 6563 6569 7074 732c 206c 6973 7429  (receipts, list)
+00009bb0: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
+00009bc0: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
+00009bd0: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
+00009be0: 685f 6765 7442 6c6f 636b 5265 6365 6970  h_getBlockReceip
+00009bf0: 7473 5f66 696e 616c 697a 6564 280a 2020  ts_finalized(.  
+00009c00: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
+00009c10: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+00009c20: 222c 2061 7379 6e63 5f65 6d70 7479 5f62  ", async_empty_b
+00009c30: 6c6f 636b 3a20 426c 6f63 6b44 6174 610a  lock: BlockData.
+00009c40: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00009c50: 2020 2020 2020 2072 6563 6569 7074 7320         receipts 
+00009c60: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00009c70: 2e65 7468 2e67 6574 5f62 6c6f 636b 5f72  .eth.get_block_r
+00009c80: 6563 6569 7074 7328 2266 696e 616c 697a  eceipts("finaliz
+00009c90: 6564 2229 0a20 2020 2020 2020 2061 7373  ed").        ass
+00009ca0: 6572 7420 6973 696e 7374 616e 6365 2872  ert isinstance(r
+00009cb0: 6563 6569 7074 732c 206c 6973 7429 0a0a  eceipts, list)..
+00009cc0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+00009cd0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+00009ce0: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
+00009cf0: 6765 745f 626c 6f63 6b5f 6279 5f6e 756d  get_block_by_num
+00009d00: 6265 725f 6675 6c6c 5f74 7261 6e73 6163  ber_full_transac
+00009d10: 7469 6f6e 7328 0a20 2020 2020 2020 2073  tions(.        s
+00009d20: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
+00009d30: 4173 796e 6357 6562 3322 2c20 6173 796e  AsyncWeb3", asyn
+00009d40: 635f 626c 6f63 6b5f 7769 7468 5f74 786e  c_block_with_txn
+00009d50: 3a20 426c 6f63 6b44 6174 610a 2020 2020  : BlockData.    
+00009d60: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00009d70: 2020 2062 6c6f 636b 203d 2061 7761 6974     block = await
+00009d80: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
+00009d90: 745f 626c 6f63 6b28 6173 796e 635f 626c  t_block(async_bl
+00009da0: 6f63 6b5f 7769 7468 5f74 786e 5b22 6e75  ock_with_txn["nu
+00009db0: 6d62 6572 225d 2c20 5472 7565 290a 2020  mber"], True).  
+00009dc0: 2020 2020 2020 7472 616e 7361 6374 696f        transactio
+00009dd0: 6e20 3d20 6361 7374 2854 7844 6174 612c  n = cast(TxData,
+00009de0: 2062 6c6f 636b 5b22 7472 616e 7361 6374   block["transact
+00009df0: 696f 6e73 225d 5b30 5d29 0a20 2020 2020  ions"][0]).     
+00009e00: 2020 2061 7373 6572 7420 7472 616e 7361     assert transa
+00009e10: 6374 696f 6e5b 2268 6173 6822 5d20 3d3d  ction["hash"] ==
+00009e20: 2061 7379 6e63 5f62 6c6f 636b 5f77 6974   async_block_wit
+00009e30: 685f 7478 6e5b 2274 7261 6e73 6163 7469  h_txn["transacti
+00009e40: 6f6e 7322 5d5b 305d 0a0a 2020 2020 4070  ons"][0]..    @p
+00009e50: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+00009e60: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
+00009e70: 2074 6573 745f 6574 685f 6765 745f 7261   test_eth_get_ra
+00009e80: 775f 7472 616e 7361 6374 696f 6e28 0a20  w_transaction(. 
+00009e90: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
+00009ea0: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
+00009eb0: 3322 2c20 6d69 6e65 645f 7478 6e5f 6861  3", mined_txn_ha
+00009ec0: 7368 3a20 4865 7853 7472 0a20 2020 2029  sh: HexStr.    )
+00009ed0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00009ee0: 2020 7261 775f 7472 616e 7361 6374 696f    raw_transactio
+00009ef0: 6e20 3d20 6177 6169 7420 6173 796e 635f  n = await async_
+00009f00: 7733 2e65 7468 2e67 6574 5f72 6177 5f74  w3.eth.get_raw_t
+00009f10: 7261 6e73 6163 7469 6f6e 286d 696e 6564  ransaction(mined
+00009f20: 5f74 786e 5f68 6173 6829 0a20 2020 2020  _txn_hash).     
+00009f30: 2020 2061 7373 6572 7420 6973 5f62 7974     assert is_byt
+00009f40: 6573 2872 6177 5f74 7261 6e73 6163 7469  es(raw_transacti
+00009f50: 6f6e 290a 0a20 2020 2040 7079 7465 7374  on)..    @pytest
+00009f60: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+00009f70: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+00009f80: 5f65 7468 5f67 6574 5f72 6177 5f74 7261  _eth_get_raw_tra
+00009f90: 6e73 6163 7469 6f6e 5f72 6169 7365 735f  nsaction_raises_
+00009fa0: 6572 726f 7228 0a20 2020 2020 2020 2073  error(.        s
+00009fb0: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
+00009fc0: 4173 796e 6357 6562 3322 0a20 2020 2029  AsyncWeb3".    )
+00009fd0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00009fe0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+00009ff0: 6973 6573 280a 2020 2020 2020 2020 2020  ises(.          
+0000a000: 2020 5472 616e 7361 6374 696f 6e4e 6f74    TransactionNot
+0000a010: 466f 756e 642c 206d 6174 6368 3d66 2254  Found, match=f"T
+0000a020: 7261 6e73 6163 7469 6f6e 2077 6974 6820  ransaction with 
+0000a030: 6861 7368 3a20 277b 554e 4b4e 4f57 4e5f  hash: '{UNKNOWN_
+0000a040: 4841 5348 7d27 220a 2020 2020 2020 2020  HASH}'".        
+0000a050: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+0000a060: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+0000a070: 682e 6765 745f 7261 775f 7472 616e 7361  h.get_raw_transa
+0000a080: 6374 696f 6e28 554e 4b4e 4f57 4e5f 4841  ction(UNKNOWN_HA
+0000a090: 5348 290a 0a20 2020 2040 7079 7465 7374  SH)..    @pytest
+0000a0a0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+0000a0b0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+0000a0c0: 5f65 7468 5f67 6574 5f72 6177 5f74 7261  _eth_get_raw_tra
+0000a0d0: 6e73 6163 7469 6f6e 5f62 795f 626c 6f63  nsaction_by_bloc
+0000a0e0: 6b28 0a20 2020 2020 2020 2073 656c 662c  k(.        self,
+0000a0f0: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
+0000a100: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
+0000a110: 2020 2020 2020 2020 6173 796e 635f 626c          async_bl
+0000a120: 6f63 6b5f 7769 7468 5f74 786e 3a20 426c  ock_with_txn: Bl
+0000a130: 6f63 6b44 6174 612c 0a20 2020 2020 2020  ockData,.       
+0000a140: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+0000a150: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+0000a160: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
+0000a170: 7373 2c0a 2020 2020 2920 2d3e 204e 6f6e  ss,.    ) -> Non
+0000a180: 653a 0a20 2020 2020 2020 2023 2065 7468  e:.        # eth
+0000a190: 5f67 6574 5261 7754 7261 6e73 6163 7469  _getRawTransacti
+0000a1a0: 6f6e 4279 426c 6f63 6b4e 756d 6265 7241  onByBlockNumberA
+0000a1b0: 6e64 496e 6465 783a 2062 6c6f 636b 2069  ndIndex: block i
+0000a1c0: 6465 6e74 6966 6965 720a 2020 2020 2020  dentifier.      
+0000a1d0: 2020 2320 7365 6e64 2061 2074 786e 2074    # send a txn t
+0000a1e0: 6f20 6d61 6b65 2073 7572 6520 7065 6e64  o make sure pend
+0000a1f0: 696e 6720 626c 6f63 6b20 6861 7320 6174  ing block has at
+0000a200: 206c 6561 7374 206f 6e65 2074 786e 0a20   least one txn. 
+0000a210: 2020 2020 2020 2061 7761 6974 2061 7379         await asy
+0000a220: 6e63 5f77 332e 6574 682e 7365 6e64 5f74  nc_w3.eth.send_t
+0000a230: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
+0000a240: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0000a250: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
+0000a260: 3a20 6173 796e 635f 756e 6c6f 636b 6564  : async_unlocked
+0000a270: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+0000a280: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+0000a290: 2020 2020 2274 6f22 3a20 6173 796e 635f      "to": async_
+0000a2a0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+0000a2b0: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
+0000a2c0: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+0000a2d0: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
+0000a2e0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+0000a2f0: 2020 2029 0a20 2020 2020 2020 2070 656e     ).        pen
+0000a300: 6469 6e67 5f62 6c6f 636b 203d 2061 7761  ding_block = awa
+0000a310: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+0000a320: 6765 745f 626c 6f63 6b28 2270 656e 6469  get_block("pendi
+0000a330: 6e67 2229 0a20 2020 2020 2020 206c 6173  ng").        las
+0000a340: 745f 7065 6e64 696e 675f 7478 6e5f 696e  t_pending_txn_in
+0000a350: 6465 7820 3d20 6c65 6e28 7065 6e64 696e  dex = len(pendin
+0000a360: 675f 626c 6f63 6b5b 2274 7261 6e73 6163  g_block["transac
+0000a370: 7469 6f6e 7322 5d29 202d 2031 0a20 2020  tions"]) - 1.   
+0000a380: 2020 2020 2072 6177 5f74 786e 203d 2061       raw_txn = a
+0000a390: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+0000a3a0: 682e 6765 745f 7261 775f 7472 616e 7361  h.get_raw_transa
+0000a3b0: 6374 696f 6e5f 6279 5f62 6c6f 636b 280a  ction_by_block(.
+0000a3c0: 2020 2020 2020 2020 2020 2020 2270 656e              "pen
+0000a3d0: 6469 6e67 222c 206c 6173 745f 7065 6e64  ding", last_pend
+0000a3e0: 696e 675f 7478 6e5f 696e 6465 780a 2020  ing_txn_index.  
+0000a3f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000a400: 6173 7365 7274 2069 735f 6279 7465 7328  assert is_bytes(
+0000a410: 7261 775f 7478 6e29 0a0a 2020 2020 2020  raw_txn)..      
+0000a420: 2020 2320 6574 685f 6765 7452 6177 5472    # eth_getRawTr
+0000a430: 616e 7361 6374 696f 6e42 7942 6c6f 636b  ansactionByBlock
+0000a440: 4e75 6d62 6572 416e 6449 6e64 6578 3a20  NumberAndIndex: 
+0000a450: 626c 6f63 6b20 6e75 6d62 6572 0a20 2020  block number.   
+0000a460: 2020 2020 2061 7379 6e63 5f62 6c6f 636b       async_block
+0000a470: 5f77 6974 685f 7478 6e5f 6e75 6d62 6572  _with_txn_number
+0000a480: 203d 2061 7379 6e63 5f62 6c6f 636b 5f77   = async_block_w
+0000a490: 6974 685f 7478 6e5b 226e 756d 6265 7222  ith_txn["number"
+0000a4a0: 5d0a 2020 2020 2020 2020 7261 775f 7472  ].        raw_tr
+0000a4b0: 616e 7361 6374 696f 6e20 3d20 6177 6169  ansaction = awai
+0000a4c0: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
+0000a4d0: 6574 5f72 6177 5f74 7261 6e73 6163 7469  et_raw_transacti
+0000a4e0: 6f6e 5f62 795f 626c 6f63 6b28 0a20 2020  on_by_block(.   
+0000a4f0: 2020 2020 2020 2020 2061 7379 6e63 5f62           async_b
+0000a500: 6c6f 636b 5f77 6974 685f 7478 6e5f 6e75  lock_with_txn_nu
+0000a510: 6d62 6572 2c20 300a 2020 2020 2020 2020  mber, 0.        
+0000a520: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0000a530: 2069 735f 6279 7465 7328 7261 775f 7472   is_bytes(raw_tr
+0000a540: 616e 7361 6374 696f 6e29 0a0a 2020 2020  ansaction)..    
+0000a550: 2020 2020 2320 6574 685f 6765 7452 6177      # eth_getRaw
+0000a560: 5472 616e 7361 6374 696f 6e42 7942 6c6f  TransactionByBlo
+0000a570: 636b 4861 7368 416e 6449 6e64 6578 3a20  ckHashAndIndex: 
+0000a580: 626c 6f63 6b20 6861 7368 0a20 2020 2020  block hash.     
+0000a590: 2020 2061 7379 6e63 5f62 6c6f 636b 5f77     async_block_w
+0000a5a0: 6974 685f 7478 6e5f 6861 7368 203d 2061  ith_txn_hash = a
+0000a5b0: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
+0000a5c0: 7478 6e5b 2268 6173 6822 5d0a 2020 2020  txn["hash"].    
+0000a5d0: 2020 2020 7261 775f 7472 616e 7361 6374      raw_transact
+0000a5e0: 696f 6e20 3d20 6177 6169 7420 6173 796e  ion = await asyn
+0000a5f0: 635f 7733 2e65 7468 2e67 6574 5f72 6177  c_w3.eth.get_raw
+0000a600: 5f74 7261 6e73 6163 7469 6f6e 5f62 795f  _transaction_by_
+0000a610: 626c 6f63 6b28 0a20 2020 2020 2020 2020  block(.         
+0000a620: 2020 2061 7379 6e63 5f62 6c6f 636b 5f77     async_block_w
+0000a630: 6974 685f 7478 6e5f 6861 7368 2c20 300a  ith_txn_hash, 0.
+0000a640: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000a650: 2020 6173 7365 7274 2069 735f 6279 7465    assert is_byte
+0000a660: 7328 7261 775f 7472 616e 7361 6374 696f  s(raw_transactio
+0000a670: 6e29 0a0a 2020 2020 4070 7974 6573 742e  n)..    @pytest.
+0000a680: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+0000a690: 2040 7079 7465 7374 2e6d 6172 6b2e 7061   @pytest.mark.pa
+0000a6a0: 7261 6d65 7472 697a 6528 2275 6e6b 6e6f  rametrize("unkno
+0000a6b0: 776e 5f62 6c6f 636b 5f6e 756d 5f6f 725f  wn_block_num_or_
+0000a6c0: 6861 7368 222c 2028 3132 3334 3536 3738  hash", (12345678
+0000a6d0: 3939 3939 392c 2055 4e4b 4e4f 574e 5f48  99999, UNKNOWN_H
+0000a6e0: 4153 4829 290a 2020 2020 6173 796e 6320  ASH)).    async 
+0000a6f0: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
+0000a700: 5f72 6177 5f74 7261 6e73 6163 7469 6f6e  _raw_transaction
+0000a710: 5f62 795f 626c 6f63 6b5f 7261 6973 6573  _by_block_raises
+0000a720: 5f65 7272 6f72 280a 2020 2020 2020 2020  _error(.        
+0000a730: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+0000a740: 2241 7379 6e63 5765 6233 222c 2075 6e6b  "AsyncWeb3", unk
+0000a750: 6e6f 776e 5f62 6c6f 636b 5f6e 756d 5f6f  nown_block_num_o
+0000a760: 725f 6861 7368 3a20 556e 696f 6e5b 696e  r_hash: Union[in
+0000a770: 742c 2048 6578 4279 7465 735d 0a20 2020  t, HexBytes].   
+0000a780: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+0000a790: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+0000a7a0: 7261 6973 6573 280a 2020 2020 2020 2020  raises(.        
+0000a7b0: 2020 2020 5472 616e 7361 6374 696f 6e4e      TransactionN
+0000a7c0: 6f74 466f 756e 642c 0a20 2020 2020 2020  otFound,.       
+0000a7d0: 2020 2020 206d 6174 6368 3d28 0a20 2020       match=(.   
+0000a7e0: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
+0000a7f0: 7261 6e73 6163 7469 6f6e 2069 6e64 6578  ransaction index
+0000a800: 3a20 3020 6f6e 2062 6c6f 636b 2069 643a  : 0 on block id:
+0000a810: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0000a820: 2020 2066 227b 746f 5f68 6578 5f69 665f     f"{to_hex_if_
+0000a830: 696e 7465 6765 7228 756e 6b6e 6f77 6e5f  integer(unknown_
+0000a840: 626c 6f63 6b5f 6e75 6d5f 6f72 5f68 6173  block_num_or_has
+0000a850: 6829 2172 7d20 220a 2020 2020 2020 2020  h)!r} ".        
+0000a860: 2020 2020 2020 2020 6622 6e6f 7420 666f          f"not fo
+0000a870: 756e 642e 220a 2020 2020 2020 2020 2020  und.".          
+0000a880: 2020 292c 0a20 2020 2020 2020 2029 3a0a    ),.        ):.
+0000a890: 2020 2020 2020 2020 2020 2020 6177 6169              awai
+0000a8a0: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
+0000a8b0: 6574 5f72 6177 5f74 7261 6e73 6163 7469  et_raw_transacti
+0000a8c0: 6f6e 5f62 795f 626c 6f63 6b28 0a20 2020  on_by_block(.   
+0000a8d0: 2020 2020 2020 2020 2020 2020 2075 6e6b               unk
+0000a8e0: 6e6f 776e 5f62 6c6f 636b 5f6e 756d 5f6f  nown_block_num_o
+0000a8f0: 725f 6861 7368 2c20 300a 2020 2020 2020  r_hash, 0.      
+0000a900: 2020 2020 2020 290a 0a20 2020 2040 7079        )..    @py
+0000a910: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+0000a920: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+0000a930: 7465 7374 5f65 7468 5f67 6574 5f72 6177  test_eth_get_raw
+0000a940: 5f74 7261 6e73 6163 7469 6f6e 5f62 795f  _transaction_by_
+0000a950: 626c 6f63 6b5f 7261 6973 6573 5f65 7272  block_raises_err
+0000a960: 6f72 5f62 6c6f 636b 5f69 6465 6e74 6966  or_block_identif
+0000a970: 6965 7228 0a20 2020 2020 2020 2073 656c  ier(.        sel
+0000a980: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
+0000a990: 796e 6357 6562 3322 0a20 2020 2029 202d  yncWeb3".    ) -
+0000a9a0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0000a9b0: 756e 6b6e 6f77 6e5f 6964 656e 7469 6669  unknown_identifi
+0000a9c0: 6572 203d 2022 756e 6b6e 6f77 6e22 0a20  er = "unknown". 
+0000a9d0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+0000a9e0: 7374 2e72 6169 7365 7328 0a20 2020 2020  st.raises(.     
+0000a9f0: 2020 2020 2020 2056 616c 7565 4572 726f         ValueErro
+0000aa00: 722c 0a20 2020 2020 2020 2020 2020 206d  r,.            m
+0000aa10: 6174 6368 3d28 0a20 2020 2020 2020 2020  atch=(.         
+0000aa20: 2020 2020 2020 2022 5661 6c75 6520 6469         "Value di
+0000aa30: 6420 6e6f 7420 6d61 7463 6820 616e 7920  d not match any 
+0000aa40: 6f66 2074 6865 2072 6563 6f67 6e69 7a65  of the recognize
+0000aa50: 6420 626c 6f63 6b20 6964 656e 7469 6669  d block identifi
+0000aa60: 6572 733a 2022 0a20 2020 2020 2020 2020  ers: ".         
+0000aa70: 2020 2020 2020 2066 227b 756e 6b6e 6f77         f"{unknow
+0000aa80: 6e5f 6964 656e 7469 6669 6572 7d22 0a20  n_identifier}". 
+0000aa90: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+0000aaa0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+0000aab0: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
+0000aac0: 5f77 332e 6574 682e 6765 745f 7261 775f  _w3.eth.get_raw_
+0000aad0: 7472 616e 7361 6374 696f 6e5f 6279 5f62  transaction_by_b
+0000aae0: 6c6f 636b 2875 6e6b 6e6f 776e 5f69 6465  lock(unknown_ide
+0000aaf0: 6e74 6966 6965 722c 2030 290a 0a20 2020  ntifier, 0)..   
+0000ab00: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+0000ab10: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+0000ab20: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
+0000ab30: 5f62 616c 616e 6365 2873 656c 662c 2061  _balance(self, a
+0000ab40: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
+0000ab50: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
+0000ab60: 2020 2020 2020 2063 6f69 6e62 6173 6520         coinbase 
+0000ab70: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+0000ab80: 2e65 7468 2e63 6f69 6e62 6173 650a 0a20  .eth.coinbase.. 
+0000ab90: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+0000aba0: 7374 2e72 6169 7365 7328 496e 7661 6c69  st.raises(Invali
+0000abb0: 6441 6464 7265 7373 293a 0a20 2020 2020  dAddress):.     
+0000abc0: 2020 2020 2020 2061 7761 6974 2061 7379         await asy
+0000abd0: 6e63 5f77 332e 6574 682e 6765 745f 6261  nc_w3.eth.get_ba
+0000abe0: 6c61 6e63 6528 0a20 2020 2020 2020 2020  lance(.         
+0000abf0: 2020 2020 2020 2043 6865 636b 7375 6d41         ChecksumA
+0000ac00: 6464 7265 7373 2848 6578 4164 6472 6573  ddress(HexAddres
+0000ac10: 7328 4865 7853 7472 2863 6f69 6e62 6173  s(HexStr(coinbas
+0000ac20: 652e 6c6f 7765 7228 2929 2929 0a20 2020  e.lower()))).   
+0000ac30: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0000ac40: 2020 2020 6261 6c61 6e63 6520 3d20 6177      balance = aw
+0000ac50: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+0000ac60: 2e67 6574 5f62 616c 616e 6365 2863 6f69  .get_balance(coi
+0000ac70: 6e62 6173 6529 0a0a 2020 2020 2020 2020  nbase)..        
+0000ac80: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
+0000ac90: 7228 6261 6c61 6e63 6529 0a20 2020 2020  r(balance).     
+0000aca0: 2020 2061 7373 6572 7420 6261 6c61 6e63     assert balanc
+0000acb0: 6520 3e3d 2030 0a0a 2020 2020 4070 7974  e >= 0..    @pyt
+0000acc0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+0000acd0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+0000ace0: 6573 745f 6574 685f 6765 745f 636f 6465  est_eth_get_code
+0000acf0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+0000ad00: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+0000ad10: 5765 6233 222c 2061 7379 6e63 5f6d 6174  Web3", async_mat
+0000ad20: 685f 636f 6e74 7261 6374 5f61 6464 7265  h_contract_addre
+0000ad30: 7373 3a20 4368 6563 6b73 756d 4164 6472  ss: ChecksumAddr
+0000ad40: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
+0000ad50: 653a 0a20 2020 2020 2020 2063 6f64 6520  e:.        code 
+0000ad60: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+0000ad70: 2e65 7468 2e67 6574 5f63 6f64 6528 6173  .eth.get_code(as
+0000ad80: 796e 635f 6d61 7468 5f63 6f6e 7472 6163  ync_math_contrac
+0000ad90: 745f 6164 6472 6573 7329 0a20 2020 2020  t_address).     
+0000ada0: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
+0000adb0: 616e 6365 2863 6f64 652c 2048 6578 4279  ance(code, HexBy
+0000adc0: 7465 7329 0a20 2020 2020 2020 2061 7373  tes).        ass
+0000add0: 6572 7420 6c65 6e28 636f 6465 2920 3e20  ert len(code) > 
+0000ade0: 300a 0a20 2020 2040 7079 7465 7374 2e6d  0..    @pytest.m
+0000adf0: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
+0000ae00: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
+0000ae10: 7468 5f67 6574 5f63 6f64 655f 696e 7661  th_get_code_inva
+0000ae20: 6c69 645f 6164 6472 6573 7328 0a20 2020  lid_address(.   
+0000ae30: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0000ae40: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
+0000ae50: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
+0000ae60: 2020 6173 796e 635f 6d61 7468 5f63 6f6e    async_math_con
+0000ae70: 7472 6163 743a 2022 4173 796e 6343 6f6e  tract: "AsyncCon
+0000ae80: 7472 6163 7422 2c0a 2020 2020 2920 2d3e  tract",.    ) ->
+0000ae90: 204e 6f6e 653a 0a20 2020 2020 2020 2077   None:.        w
+0000aea0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+0000aeb0: 7328 496e 7661 6c69 6441 6464 7265 7373  s(InvalidAddress
+0000aec0: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+0000aed0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+0000aee0: 682e 6765 745f 636f 6465 280a 2020 2020  h.get_code(.    
+0000aef0: 2020 2020 2020 2020 2020 2020 4368 6563              Chec
+0000af00: 6b73 756d 4164 6472 6573 7328 4865 7841  ksumAddress(HexA
+0000af10: 6464 7265 7373 2848 6578 5374 7228 6173  ddress(HexStr(as
+0000af20: 796e 635f 6d61 7468 5f63 6f6e 7472 6163  ync_math_contrac
+0000af30: 742e 6164 6472 6573 732e 6c6f 7765 7228  t.address.lower(
+0000af40: 2929 2929 0a20 2020 2020 2020 2020 2020  )))).           
+0000af50: 2029 0a0a 2020 2020 4070 7974 6573 742e   )..    @pytest.
+0000af60: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+0000af70: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+0000af80: 6574 685f 6765 745f 636f 6465 5f77 6974  eth_get_code_wit
+0000af90: 685f 626c 6f63 6b5f 6964 656e 7469 6669  h_block_identifi
+0000afa0: 6572 280a 2020 2020 2020 2020 7365 6c66  er(.        self
+0000afb0: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
+0000afc0: 6e63 5765 6233 222c 2061 7379 6e63 5f65  ncWeb3", async_e
+0000afd0: 6d69 7474 6572 5f63 6f6e 7472 6163 743a  mitter_contract:
+0000afe0: 2022 4173 796e 6343 6f6e 7472 6163 7422   "AsyncContract"
+0000aff0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+0000b000: 2020 2020 2020 2020 626c 6f63 6b5f 6964          block_id
+0000b010: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+0000b020: 332e 6574 682e 626c 6f63 6b5f 6e75 6d62  3.eth.block_numb
+0000b030: 6572 0a20 2020 2020 2020 2063 6f64 6520  er.        code 
+0000b040: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+0000b050: 2e65 7468 2e67 6574 5f63 6f64 6528 6173  .eth.get_code(as
+0000b060: 796e 635f 656d 6974 7465 725f 636f 6e74  ync_emitter_cont
+0000b070: 7261 6374 2e61 6464 7265 7373 2c20 626c  ract.address, bl
+0000b080: 6f63 6b5f 6964 290a 2020 2020 2020 2020  ock_id).        
+0000b090: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
+0000b0a0: 6528 636f 6465 2c20 4865 7842 7974 6573  e(code, HexBytes
+0000b0b0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0000b0c0: 206c 656e 2863 6f64 6529 203e 2030 0a0a   len(code) > 0..
+0000b0d0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+0000b0e0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+0000b0f0: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
+0000b100: 6372 6561 7465 5f61 6363 6573 735f 6c69  create_access_li
+0000b110: 7374 280a 2020 2020 2020 2020 7365 6c66  st(.        self
+0000b120: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+0000b130: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+0000b140: 0a20 2020 2020 2020 2061 7379 6e63 5f75  .        async_u
+0000b150: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+0000b160: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
+0000b170: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
+0000b180: 2020 2020 6173 796e 635f 6d61 7468 5f63      async_math_c
+0000b190: 6f6e 7472 6163 743a 2022 4173 796e 6343  ontract: "AsyncC
+0000b1a0: 6f6e 7472 6163 7422 2c0a 2020 2020 2920  ontract",.    ) 
+0000b1b0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000b1c0: 2023 2062 7569 6c64 2074 786e 0a20 2020   # build txn.   
+0000b1d0: 2020 2020 2074 786e 203d 2061 7761 6974       txn = await
+0000b1e0: 2061 7379 6e63 5f6d 6174 685f 636f 6e74   async_math_cont
+0000b1f0: 7261 6374 2e66 756e 6374 696f 6e73 2e69  ract.functions.i
+0000b200: 6e63 7265 6d65 6e74 436f 756e 7465 7228  ncrementCounter(
+0000b210: 3129 2e62 7569 6c64 5f74 7261 6e73 6163  1).build_transac
+0000b220: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+0000b230: 2020 7b22 6672 6f6d 223a 2061 7379 6e63    {"from": async
+0000b240: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+0000b250: 745f 6475 616c 5f74 7970 657d 0a20 2020  t_dual_type}.   
+0000b260: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000b270: 2320 6372 6561 7465 2061 6363 6573 7320  # create access 
+0000b280: 6c69 7374 0a20 2020 2020 2020 2072 6573  list.        res
+0000b290: 706f 6e73 6520 3d20 6177 6169 7420 6173  ponse = await as
+0000b2a0: 796e 635f 7733 2e65 7468 2e63 7265 6174  ync_w3.eth.creat
+0000b2b0: 655f 6163 6365 7373 5f6c 6973 7428 7478  e_access_list(tx
+0000b2c0: 6e29 0a0a 2020 2020 2020 2020 6173 7365  n)..        asse
+0000b2d0: 7274 2069 735f 6469 6374 2872 6573 706f  rt is_dict(respo
+0000b2e0: 6e73 6529 0a20 2020 2020 2020 2061 6363  nse).        acc
+0000b2f0: 6573 735f 6c69 7374 203d 2072 6573 706f  ess_list = respo
+0000b300: 6e73 655b 2261 6363 6573 734c 6973 7422  nse["accessList"
+0000b310: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+0000b320: 206c 656e 2861 6363 6573 735f 6c69 7374   len(access_list
+0000b330: 2920 3e20 300a 2020 2020 2020 2020 6173  ) > 0.        as
+0000b340: 7365 7274 2061 6363 6573 735f 6c69 7374  sert access_list
+0000b350: 5b30 5d5b 2261 6464 7265 7373 225d 2069  [0]["address"] i
+0000b360: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
+0000b370: 2020 2061 7373 6572 7420 6973 5f63 6865     assert is_che
+0000b380: 636b 7375 6d5f 6164 6472 6573 7328 6163  cksum_address(ac
+0000b390: 6365 7373 5f6c 6973 745b 305d 5b22 6164  cess_list[0]["ad
+0000b3a0: 6472 6573 7322 5d29 0a20 2020 2020 2020  dress"]).       
+0000b3b0: 2061 7373 6572 7420 6c65 6e28 6163 6365   assert len(acce
+0000b3c0: 7373 5f6c 6973 745b 305d 5b22 7374 6f72  ss_list[0]["stor
+0000b3d0: 6167 654b 6579 7322 5d5b 305d 2920 3d3d  ageKeys"][0]) ==
+0000b3e0: 2033 320a 2020 2020 2020 2020 6173 7365   32.        asse
+0000b3f0: 7274 2069 6e74 2872 6573 706f 6e73 655b  rt int(response[
+0000b400: 2267 6173 5573 6564 225d 2920 3e3d 2030  "gasUsed"]) >= 0
+0000b410: 0a0a 2020 2020 2020 2020 2320 6173 7365  ..        # asse
+0000b420: 7274 2074 6865 2072 6573 756c 7420 6361  rt the result ca
+0000b430: 6e20 6265 2075 7365 6420 6469 7265 6374  n be used direct
+0000b440: 6c79 2069 6e20 6120 7472 616e 7361 6374  ly in a transact
+0000b450: 696f 6e20 6469 6374 0a20 2020 2020 2020  ion dict.       
+0000b460: 2074 786e 5b22 6163 6365 7373 4c69 7374   txn["accessList
+0000b470: 225d 203d 2072 6573 706f 6e73 655b 2261  "] = response["a
+0000b480: 6363 6573 734c 6973 7422 5d0a 2020 2020  ccessList"].    
+0000b490: 2020 2020 7478 6e5b 2267 6173 225d 203d      txn["gas"] =
+0000b4a0: 2072 6573 706f 6e73 655b 2267 6173 5573   response["gasUs
+0000b4b0: 6564 225d 0a0a 2020 2020 2020 2020 2320  ed"]..        # 
+0000b4c0: 7365 6e64 2074 786e 2077 6974 6820 6163  send txn with ac
+0000b4d0: 6365 7373 206c 6973 740a 2020 2020 2020  cess list.      
+0000b4e0: 2020 6177 6169 7420 6173 796e 635f 7733    await async_w3
+0000b4f0: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+0000b500: 6374 696f 6e28 7478 6e29 0a0a 2020 2020  ction(txn)..    
+0000b510: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+0000b520: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+0000b530: 6566 2074 6573 745f 6574 685f 6765 745f  ef test_eth_get_
+0000b540: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
+0000b550: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+0000b560: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+0000b570: 6357 6562 3322 2c20 6173 796e 635f 756e  cWeb3", async_un
+0000b580: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
+0000b590: 7561 6c5f 7479 7065 3a20 4368 6563 6b73  ual_type: Checks
+0000b5a0: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
+0000b5b0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000b5c0: 2074 7261 6e73 6163 7469 6f6e 5f63 6f75   transaction_cou
+0000b5d0: 6e74 203d 2061 7761 6974 2061 7379 6e63  nt = await async
+0000b5e0: 5f77 332e 6574 682e 6765 745f 7472 616e  _w3.eth.get_tran
+0000b5f0: 7361 6374 696f 6e5f 636f 756e 7428 0a20  saction_count(. 
+0000b600: 2020 2020 2020 2020 2020 2061 7379 6e63             async
+0000b610: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+0000b620: 745f 6475 616c 5f74 7970 650a 2020 2020  t_dual_type.    
+0000b630: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+0000b640: 7365 7274 2069 735f 696e 7465 6765 7228  sert is_integer(
+0000b650: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
+0000b660: 7429 0a20 2020 2020 2020 2061 7373 6572  t).        asser
+0000b670: 7420 7472 616e 7361 6374 696f 6e5f 636f  t transaction_co
+0000b680: 756e 7420 3e3d 2030 0a0a 2020 2020 4070  unt >= 0..    @p
+0000b690: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+0000b6a0: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
+0000b6b0: 2074 6573 745f 6574 685f 6361 6c6c 280a   test_eth_call(.
+0000b6c0: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+0000b6d0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+0000b6e0: 6233 222c 2061 7379 6e63 5f6d 6174 685f  b3", async_math_
+0000b6f0: 636f 6e74 7261 6374 3a20 2241 7379 6e63  contract: "Async
+0000b700: 436f 6e74 7261 6374 220a 2020 2020 2920  Contract".    ) 
+0000b710: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000b720: 2063 6f69 6e62 6173 6520 3d20 6177 6169   coinbase = awai
+0000b730: 7420 6173 796e 635f 7733 2e65 7468 2e63  t async_w3.eth.c
+0000b740: 6f69 6e62 6173 650a 2020 2020 2020 2020  oinbase.        
+0000b750: 7478 6e5f 7061 7261 6d73 203d 2061 7379  txn_params = asy
+0000b760: 6e63 5f6d 6174 685f 636f 6e74 7261 6374  nc_math_contract
+0000b770: 2e5f 7072 6570 6172 655f 7472 616e 7361  ._prepare_transa
+0000b780: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+0000b790: 2020 2066 6e5f 6e61 6d65 3d22 6164 6422     fn_name="add"
+0000b7a0: 2c0a 2020 2020 2020 2020 2020 2020 666e  ,.            fn
+0000b7b0: 5f61 7267 733d 2837 2c20 3131 292c 0a20  _args=(7, 11),. 
+0000b7c0: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
+0000b7d0: 6163 7469 6f6e 3d7b 2266 726f 6d22 3a20  action={"from": 
+0000b7e0: 636f 696e 6261 7365 2c20 2274 6f22 3a20  coinbase, "to": 
+0000b7f0: 6173 796e 635f 6d61 7468 5f63 6f6e 7472  async_math_contr
+0000b800: 6163 742e 6164 6472 6573 737d 2c0a 2020  act.address},.  
+0000b810: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000b820: 6361 6c6c 5f72 6573 756c 7420 3d20 6177  call_result = aw
+0000b830: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+0000b840: 2e63 616c 6c28 7478 6e5f 7061 7261 6d73  .call(txn_params
+0000b850: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0000b860: 2069 735f 7374 7269 6e67 2863 616c 6c5f   is_string(call_
+0000b870: 7265 7375 6c74 290a 2020 2020 2020 2020  result).        
+0000b880: 2872 6573 756c 742c 2920 3d20 6173 796e  (result,) = asyn
+0000b890: 635f 7733 2e63 6f64 6563 2e64 6563 6f64  c_w3.codec.decod
+0000b8a0: 6528 5b22 7569 6e74 3235 3622 5d2c 2063  e(["uint256"], c
+0000b8b0: 616c 6c5f 7265 7375 6c74 290a 2020 2020  all_result).    
+0000b8c0: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
+0000b8d0: 7420 3d3d 2031 380a 0a20 2020 2040 7079  t == 18..    @py
+0000b8e0: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+0000b8f0: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+0000b900: 7465 7374 5f65 7468 5f63 616c 6c5f 7769  test_eth_call_wi
+0000b910: 7468 5f6f 7665 7272 6964 655f 636f 6465  th_override_code
+0000b920: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000b930: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
+0000b940: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
+0000b950: 2020 2020 2020 2061 7379 6e63 5f72 6576         async_rev
+0000b960: 6572 745f 636f 6e74 7261 6374 3a20 2241  ert_contract: "A
+0000b970: 7379 6e63 436f 6e74 7261 6374 222c 0a20  syncContract",. 
+0000b980: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+0000b990: 2020 2020 2020 636f 696e 6261 7365 203d        coinbase =
+0000b9a0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+0000b9b0: 6574 682e 636f 696e 6261 7365 0a20 2020  eth.coinbase.   
+0000b9c0: 2020 2020 2074 786e 5f70 6172 616d 7320       txn_params 
+0000b9d0: 3d20 6173 796e 635f 7265 7665 7274 5f63  = async_revert_c
+0000b9e0: 6f6e 7472 6163 742e 5f70 7265 7061 7265  ontract._prepare
+0000b9f0: 5f74 7261 6e73 6163 7469 6f6e 280a 2020  _transaction(.  
+0000ba00: 2020 2020 2020 2020 2020 666e 5f6e 616d            fn_nam
+0000ba10: 653d 226e 6f72 6d61 6c46 756e 6374 696f  e="normalFunctio
+0000ba20: 6e22 2c0a 2020 2020 2020 2020 2020 2020  n",.            
+0000ba30: 7472 616e 7361 6374 696f 6e3d 7b22 6672  transaction={"fr
+0000ba40: 6f6d 223a 2063 6f69 6e62 6173 652c 2022  om": coinbase, "
+0000ba50: 746f 223a 2061 7379 6e63 5f72 6576 6572  to": async_rever
+0000ba60: 745f 636f 6e74 7261 6374 2e61 6464 7265  t_contract.addre
+0000ba70: 7373 7d2c 0a20 2020 2020 2020 2029 0a20  ss},.        ). 
+0000ba80: 2020 2020 2020 2063 616c 6c5f 7265 7375         call_resu
+0000ba90: 6c74 203d 2061 7761 6974 2061 7379 6e63  lt = await async
+0000baa0: 5f77 332e 6574 682e 6361 6c6c 2874 786e  _w3.eth.call(txn
+0000bab0: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
+0000bac0: 2028 7265 7375 6c74 2c29 203d 2061 7379   (result,) = asy
+0000bad0: 6e63 5f77 332e 636f 6465 632e 6465 636f  nc_w3.codec.deco
+0000bae0: 6465 285b 2262 6f6f 6c22 5d2c 2063 616c  de(["bool"], cal
+0000baf0: 6c5f 7265 7375 6c74 290a 2020 2020 2020  l_result).      
+0000bb00: 2020 6173 7365 7274 2072 6573 756c 7420    assert result 
+0000bb10: 6973 2054 7275 650a 0a20 2020 2020 2020  is True..       
+0000bb20: 2023 206f 7665 7272 6964 6520 7275 6e74   # override runt
+0000bb30: 696d 6520 6279 7465 636f 6465 3a20 606e  ime bytecode: `n
+0000bb40: 6f72 6d61 6c46 756e 6374 696f 6e60 2072  ormalFunction` r
+0000bb50: 6574 7572 6e73 2060 6661 6c73 6560 0a20  eturns `false`. 
+0000bb60: 2020 2020 2020 206f 7665 7272 6964 655f         override_
+0000bb70: 636f 6465 203d 2048 6578 5374 7228 0a20  code = HexStr(. 
+0000bb80: 2020 2020 2020 2020 2020 2022 3078 3630             "0x60
+0000bb90: 3830 3630 3430 3532 3334 3830 3135 3630  8060405234801560
+0000bba0: 3066 3537 3630 3030 3830 6664 3562 3530  0f57600080fd5b50
+0000bbb0: 3630 3034 3336 3130 3630 3363 3537 3630  60043610603c5760
+0000bbc0: 3030 3335 3630 6530 3163 3830 3633 3138  003560e01c806318
+0000bbd0: 3563 3338 6134 3134 3630 3431 3537 3830  5c38a41460415780
+0000bbe0: 3633 6330 3661 3937 6362 3134 3630 3439  63c06a97cb146049
+0000bbf0: 3537 3830 3633 6436 3765 3462 3834 3134  578063d67e4b8414
+0000bc00: 3630 3531 3537 3562 3630 3030 3830 6664  6051575b600080fd
+0000bc10: 3562 3630 3437 3630 3731 3536 3562 3030  5b60476071565b00
+0000bc20: 3562 3630 3466 3630 6466 3536 3562 3030  5b604f60df565b00
+0000bc30: 3562 3630 3537 3630 6534 3536 3562 3630  5b605760e4565b60
+0000bc40: 3430 3531 3830 3832 3135 3135 3135 3135  4051808215151515
+0000bc50: 3831 3532 3630 3230 3031 3931 3530 3530  8152602001915050
+0000bc60: 3630 3430 3531 3830 3931 3033 3930 6633  60405180910390f3
+0000bc70: 3562 3630 3430 3531 3766 3038 6333 3739  5b6040517f08c379
+0000bc80: 6130 3030 3030 3030 3030 3030 3030 3030  a000000000000000
+0000bc90: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+0000bca0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+0000bcb0: 3030 3030 3030 3030 3030 3831 3532 3630  0000000000815260
+0000bcc0: 3034 3031 3830 3830 3630 3230 3031 3832  0401808060200182
+0000bcd0: 3831 3033 3832 3532 3630 3162 3831 3532  81038252601b8152
+0000bce0: 3630 3230 3031 3830 3766 3436 3735 3665  602001807f46756e
+0000bcf0: 3633 3734 3639 3666 3665 3230 3638 3631  6374696f6e206861
+0000bd00: 3733 3230 3632 3635 3635 3665 3230 3732  73206265656e2072
+0000bd10: 3635 3736 3635 3732 3734 3635 3634 3265  657665727465642e
+0000bd20: 3030 3030 3030 3030 3030 3831 3532 3530  0000000000815250
+0000bd30: 3630 3230 3031 3931 3530 3530 3630 3430  6020019150506040
+0000bd40: 3531 3830 3931 3033 3930 6664 3562 3630  5180910390fd5b60
+0000bd50: 3030 3830 6664 3562 3630 3030 3830 3930  0080fd5b60008090
+0000bd60: 3530 3930 3536 6665 6132 3634 3639 3730  509056fea2646970
+0000bd70: 3636 3733 3538 3232 3132 3230 6262 3731  667358221220bb71
+0000bd80: 6539 6539 6132 6532 3731 6364 3066 6265  e9e9a2e271cd0fbe
+0000bd90: 3833 3335 3234 6133 6561 3637 6466 3935  833524a3ea67df95
+0000bda0: 6632 3565 6131 3361 6566 3562 3061 3736  f25ea13aef5b0a76
+0000bdb0: 3166 6135 3262 3533 3866 3130 3634 3733  1fa52b538f106473
+0000bdc0: 3666 3663 3633 3433 3030 3036 3031 3030  6f6c634300060100
+0000bdd0: 3333 2220 2023 206e 6f71 613a 2045 3530  33"  # noqa: E50
+0000bde0: 310a 2020 2020 2020 2020 290a 2020 2020  1.        ).    
+0000bdf0: 2020 2020 6361 6c6c 5f72 6573 756c 7420      call_result 
+0000be00: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+0000be10: 2e65 7468 2e63 616c 6c28 0a20 2020 2020  .eth.call(.     
+0000be20: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+0000be30: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
+0000be40: 6c61 7465 7374 222c 0a20 2020 2020 2020  latest",.       
+0000be50: 2020 2020 207b 6173 796e 635f 7265 7665       {async_reve
+0000be60: 7274 5f63 6f6e 7472 6163 742e 6164 6472  rt_contract.addr
+0000be70: 6573 733a 207b 2263 6f64 6522 3a20 6f76  ess: {"code": ov
+0000be80: 6572 7269 6465 5f63 6f64 657d 7d2c 0a20  erride_code}},. 
+0000be90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000bea0: 2028 7265 7375 6c74 2c29 203d 2061 7379   (result,) = asy
+0000beb0: 6e63 5f77 332e 636f 6465 632e 6465 636f  nc_w3.codec.deco
+0000bec0: 6465 285b 2262 6f6f 6c22 5d2c 2063 616c  de(["bool"], cal
+0000bed0: 6c5f 7265 7375 6c74 290a 2020 2020 2020  l_result).      
+0000bee0: 2020 6173 7365 7274 2072 6573 756c 7420    assert result 
+0000bef0: 6973 2046 616c 7365 0a0a 2020 2020 2020  is False..      
+0000bf00: 2020 2320 7465 7374 2062 7974 6573 0a0a    # test bytes..
+0000bf10: 2020 2020 2020 2020 6279 7465 735f 6361          bytes_ca
+0000bf20: 6c6c 5f72 6573 756c 7420 3d20 6177 6169  ll_result = awai
+0000bf30: 7420 6173 796e 635f 7733 2e65 7468 2e63  t async_w3.eth.c
+0000bf40: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+0000bf50: 2074 786e 5f70 6172 616d 732c 0a20 2020   txn_params,.   
+0000bf60: 2020 2020 2020 2020 2022 6c61 7465 7374           "latest
+0000bf70: 222c 0a20 2020 2020 2020 2020 2020 207b  ",.            {
+0000bf80: 6173 796e 635f 7265 7665 7274 5f63 6f6e  async_revert_con
+0000bf90: 7472 6163 742e 6164 6472 6573 733a 207b  tract.address: {
+0000bfa0: 2263 6f64 6522 3a20 746f 5f62 7974 6573  "code": to_bytes
+0000bfb0: 2868 6578 7374 723d 6f76 6572 7269 6465  (hexstr=override
+0000bfc0: 5f63 6f64 6529 7d7d 2c0a 2020 2020 2020  _code)}},.      
+0000bfd0: 2020 290a 2020 2020 2020 2020 2862 7974    ).        (byt
+0000bfe0: 6573 5f72 6573 756c 742c 2920 3d20 6173  es_result,) = as
+0000bff0: 796e 635f 7733 2e63 6f64 6563 2e64 6563  ync_w3.codec.dec
+0000c000: 6f64 6528 5b22 626f 6f6c 225d 2c20 6279  ode(["bool"], by
+0000c010: 7465 735f 6361 6c6c 5f72 6573 756c 7429  tes_call_result)
+0000c020: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0000c030: 6279 7465 735f 7265 7375 6c74 2069 7320  bytes_result is 
+0000c040: 4661 6c73 650a 0a20 2020 2040 7079 7465  False..    @pyte
+0000c050: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+0000c060: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+0000c070: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
+0000c080: 2020 2020 2020 2270 6172 616d 7322 2c0a        "params",.
+0000c090: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
+0000c0a0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+0000c0b0: 2020 2020 2020 2020 226e 6f6e 6365 223a          "nonce":
+0000c0c0: 2031 2c20 2023 2069 6e74 0a20 2020 2020   1,  # int.     
+0000c0d0: 2020 2020 2020 2020 2020 2022 6261 6c61             "bala
+0000c0e0: 6e63 6522 3a20 312c 2020 2320 696e 740a  nce": 1,  # int.
+0000c0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c100: 2263 6f64 6522 3a20 4865 7853 7472 2822  "code": HexStr("
+0000c110: 3078 2229 2c20 2023 2048 6578 5374 720a  0x"),  # HexStr.
+0000c120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c130: 2320 7769 7468 2073 7461 7465 0a20 2020  # with state.   
+0000c140: 2020 2020 2020 2020 2020 2020 2022 7374               "st
+0000c150: 6174 6522 3a20 7b48 6578 5374 7228 6622  ate": {HexStr(f"
+0000c160: 3078 7b27 3030 2720 2a20 3332 7d22 293a  0x{'00' * 32}"):
+0000c170: 2048 6578 5374 7228 6622 3078 7b27 3030   HexStr(f"0x{'00
+0000c180: 2720 2a20 3332 7d22 297d 2c0a 2020 2020  ' * 32}")},.    
+0000c190: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+0000c1a0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0000c1b0: 2020 2020 2020 2020 2022 6e6f 6e63 6522           "nonce"
+0000c1c0: 3a20 4865 7853 7472 2822 3078 3122 292c  : HexStr("0x1"),
+0000c1d0: 2020 2320 4865 7853 7472 0a20 2020 2020    # HexStr.     
+0000c1e0: 2020 2020 2020 2020 2020 2022 6261 6c61             "bala
+0000c1f0: 6e63 6522 3a20 4865 7853 7472 2822 3078  nce": HexStr("0x
+0000c200: 3122 292c 2020 2320 4865 7853 7472 0a20  1"),  # HexStr. 
 0000c210: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000c220: 6e6f 6e63 6522 3a20 4865 7853 7472 2822  nonce": HexStr("
-0000c230: 3078 3122 292c 2020 2320 4865 7853 7472  0x1"),  # HexStr
-0000c240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c250: 2022 6261 6c61 6e63 6522 3a20 4865 7853   "balance": HexS
-0000c260: 7472 2822 3078 3122 292c 2020 2320 4865  tr("0x1"),  # He
-0000c270: 7853 7472 0a20 2020 2020 2020 2020 2020  xStr.           
-0000c280: 2020 2020 2022 636f 6465 223a 2062 225c       "code": b"\
-0000c290: 7830 3022 2c20 2023 2062 7974 6573 0a20  x00",  # bytes. 
-0000c2a0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0000c2b0: 2077 6974 6820 7374 6174 6544 6966 660a   with stateDiff.
-0000c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c2d0: 2273 7461 7465 4469 6666 223a 207b 4865  "stateDiff": {He
-0000c2e0: 7853 7472 2866 2230 787b 2730 3027 202a  xStr(f"0x{'00' *
-0000c2f0: 2033 327d 2229 3a20 4865 7853 7472 2866   32}"): HexStr(f
-0000c300: 2230 787b 2730 3027 202a 2033 327d 2229  "0x{'00' * 32}")
-0000c310: 7d2c 0a20 2020 2020 2020 2020 2020 207d  },.            }
-0000c320: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-0000c330: 2029 0a20 2020 2061 7379 6e63 2064 6566   ).    async def
-0000c340: 2074 6573 745f 6574 685f 6361 6c6c 5f77   test_eth_call_w
-0000c350: 6974 685f 6f76 6572 7269 6465 5f70 6172  ith_override_par
-0000c360: 616d 5f74 7970 655f 6368 6563 6b28 0a20  am_type_check(. 
-0000c370: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0000c380: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
-0000c390: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
-0000c3a0: 2020 2020 6173 796e 635f 6d61 7468 5f63      async_math_c
-0000c3b0: 6f6e 7472 6163 743a 2022 436f 6e74 7261  ontract: "Contra
-0000c3c0: 6374 222c 0a20 2020 2020 2020 2070 6172  ct",.        par
-0000c3d0: 616d 733a 2053 7461 7465 4f76 6572 7269  ams: StateOverri
-0000c3e0: 6465 5061 7261 6d73 2c0a 2020 2020 2920  deParams,.    ) 
-0000c3f0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0000c400: 2063 6f69 6e62 6173 6520 3d20 6177 6169   coinbase = awai
-0000c410: 7420 6173 796e 635f 7733 2e65 7468 2e63  t async_w3.eth.c
-0000c420: 6f69 6e62 6173 650a 2020 2020 2020 2020  oinbase.        
-0000c430: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
-0000c440: 7261 6d73 203d 207b 2266 726f 6d22 3a20  rams = {"from": 
-0000c450: 636f 696e 6261 7365 7d0a 0a20 2020 2020  coinbase}..     
-0000c460: 2020 2023 2061 7373 6572 7420 646f 6573     # assert does
-0000c470: 206e 6f74 2072 6169 7365 0a20 2020 2020   not raise.     
-0000c480: 2020 2061 7761 6974 2061 7379 6e63 5f77     await async_w
-0000c490: 332e 6574 682e 6361 6c6c 280a 2020 2020  3.eth.call(.    
-0000c4a0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-0000c4b0: 6d73 2c20 226c 6174 6573 7422 2c20 7b61  ms, "latest", {a
-0000c4c0: 7379 6e63 5f6d 6174 685f 636f 6e74 7261  sync_math_contra
-0000c4d0: 6374 2e61 6464 7265 7373 3a20 7061 7261  ct.address: para
-0000c4e0: 6d73 7d0a 2020 2020 2020 2020 290a 0a20  ms}.        ).. 
-0000c4f0: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-0000c500: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-0000c510: 6320 6465 6620 7465 7374 5f65 7468 5f63  c def test_eth_c
-0000c520: 616c 6c5f 7769 7468 5f30 5f72 6573 756c  all_with_0_resul
-0000c530: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
-0000c540: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-0000c550: 6357 6562 3322 2c20 6173 796e 635f 6d61  cWeb3", async_ma
-0000c560: 7468 5f63 6f6e 7472 6163 743a 2022 436f  th_contract: "Co
-0000c570: 6e74 7261 6374 220a 2020 2020 2920 2d3e  ntract".    ) ->
-0000c580: 204e 6f6e 653a 0a20 2020 2020 2020 2063   None:.        c
-0000c590: 6f69 6e62 6173 6520 3d20 6177 6169 7420  oinbase = await 
-0000c5a0: 6173 796e 635f 7733 2e65 7468 2e63 6f69  async_w3.eth.coi
-0000c5b0: 6e62 6173 650a 2020 2020 2020 2020 7478  nbase.        tx
-0000c5c0: 6e5f 7061 7261 6d73 203d 2061 7379 6e63  n_params = async
-0000c5d0: 5f6d 6174 685f 636f 6e74 7261 6374 2e5f  _math_contract._
-0000c5e0: 7072 6570 6172 655f 7472 616e 7361 6374  prepare_transact
-0000c5f0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-0000c600: 2066 6e5f 6e61 6d65 3d22 6164 6422 2c0a   fn_name="add",.
-0000c610: 2020 2020 2020 2020 2020 2020 666e 5f61              fn_a
-0000c620: 7267 733d 2830 2c20 3029 2c0a 2020 2020  rgs=(0, 0),.    
-0000c630: 2020 2020 2020 2020 7472 616e 7361 6374          transact
-0000c640: 696f 6e3d 7b22 6672 6f6d 223a 2063 6f69  ion={"from": coi
-0000c650: 6e62 6173 652c 2022 746f 223a 2061 7379  nbase, "to": asy
-0000c660: 6e63 5f6d 6174 685f 636f 6e74 7261 6374  nc_math_contract
-0000c670: 2e61 6464 7265 7373 7d2c 0a20 2020 2020  .address},.     
-0000c680: 2020 2029 0a20 2020 2020 2020 2063 616c     ).        cal
-0000c690: 6c5f 7265 7375 6c74 203d 2061 7761 6974  l_result = await
-0000c6a0: 2061 7379 6e63 5f77 332e 6574 682e 6361   async_w3.eth.ca
-0000c6b0: 6c6c 2874 786e 5f70 6172 616d 7329 0a20  ll(txn_params). 
-0000c6c0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-0000c6d0: 5f73 7472 696e 6728 6361 6c6c 5f72 6573  _string(call_res
-0000c6e0: 756c 7429 0a20 2020 2020 2020 2028 7265  ult).        (re
-0000c6f0: 7375 6c74 2c29 203d 2061 7379 6e63 5f77  sult,) = async_w
-0000c700: 332e 636f 6465 632e 6465 636f 6465 285b  3.codec.decode([
-0000c710: 2275 696e 7432 3536 225d 2c20 6361 6c6c  "uint256"], call
-0000c720: 5f72 6573 756c 7429 0a20 2020 2020 2020  _result).       
-0000c730: 2061 7373 6572 7420 7265 7375 6c74 203d   assert result =
-0000c740: 3d20 300a 0a20 2020 2040 7079 7465 7374  = 0..    @pytest
-0000c750: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-0000c760: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-0000c770: 5f65 7468 5f63 616c 6c5f 7265 7665 7274  _eth_call_revert
-0000c780: 5f77 6974 685f 6d73 6728 0a20 2020 2020  _with_msg(.     
-0000c790: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000c7a0: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-0000c7b0: 6357 6562 3322 2c0a 2020 2020 2020 2020  cWeb3",.        
-0000c7c0: 6173 796e 635f 7265 7665 7274 5f63 6f6e  async_revert_con
-0000c7d0: 7472 6163 743a 2022 436f 6e74 7261 6374  tract: "Contract
-0000c7e0: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
-0000c7f0: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
-0000c800: 743a 2043 6865 636b 7375 6d41 6464 7265  t: ChecksumAddre
-0000c810: 7373 2c0a 2020 2020 2920 2d3e 204e 6f6e  ss,.    ) -> Non
-0000c820: 653a 0a20 2020 2020 2020 2074 786e 5f70  e:.        txn_p
-0000c830: 6172 616d 7320 3d20 6173 796e 635f 7265  arams = async_re
-0000c840: 7665 7274 5f63 6f6e 7472 6163 742e 5f70  vert_contract._p
-0000c850: 7265 7061 7265 5f74 7261 6e73 6163 7469  repare_transacti
-0000c860: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-0000c870: 666e 5f6e 616d 653d 2272 6576 6572 7457  fn_name="revertW
-0000c880: 6974 684d 6573 7361 6765 222c 0a20 2020  ithMessage",.   
-0000c890: 2020 2020 2020 2020 2074 7261 6e73 6163           transac
-0000c8a0: 7469 6f6e 3d7b 0a20 2020 2020 2020 2020  tion={.         
-0000c8b0: 2020 2020 2020 2022 6672 6f6d 223a 2061         "from": a
-0000c8c0: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
-0000c8d0: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
-0000c8e0: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
-0000c8f0: 6e63 5f72 6576 6572 745f 636f 6e74 7261  nc_revert_contra
-0000c900: 6374 2e61 6464 7265 7373 2c0a 2020 2020  ct.address,.    
-0000c910: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0000c920: 2020 2029 0a20 2020 2020 2020 2077 6974     ).        wit
-0000c930: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-0000c940: 0a20 2020 2020 2020 2020 2020 2043 6f6e  .            Con
-0000c950: 7472 6163 744c 6f67 6963 4572 726f 722c  tractLogicError,
-0000c960: 206d 6174 6368 3d22 6578 6563 7574 696f   match="executio
-0000c970: 6e20 7265 7665 7274 6564 3a20 4675 6e63  n reverted: Func
-0000c980: 7469 6f6e 2068 6173 2062 6565 6e20 7265  tion has been re
-0000c990: 7665 7274 6564 220a 2020 2020 2020 2020  verted".        
-0000c9a0: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-0000c9b0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-0000c9c0: 682e 6361 6c6c 2874 786e 5f70 6172 616d  h.call(txn_param
-0000c9d0: 7329 0a0a 2020 2020 4070 7974 6573 742e  s)..    @pytest.
-0000c9e0: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-0000c9f0: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-0000ca00: 6574 685f 6361 6c6c 5f72 6576 6572 745f  eth_call_revert_
-0000ca10: 7769 7468 6f75 745f 6d73 6728 0a20 2020  without_msg(.   
-0000ca20: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000ca30: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
-0000ca40: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
-0000ca50: 2020 6173 796e 635f 7265 7665 7274 5f63    async_revert_c
-0000ca60: 6f6e 7472 6163 743a 2022 436f 6e74 7261  ontract: "Contra
-0000ca70: 6374 222c 0a20 2020 2020 2020 2061 7379  ct",.        asy
-0000ca80: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
-0000ca90: 756e 743a 2043 6865 636b 7375 6d41 6464  unt: ChecksumAdd
-0000caa0: 7265 7373 2c0a 2020 2020 2920 2d3e 204e  ress,.    ) -> N
-0000cab0: 6f6e 653a 0a20 2020 2020 2020 2077 6974  one:.        wit
-0000cac0: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-0000cad0: 436f 6e74 7261 6374 4c6f 6769 6345 7272  ContractLogicErr
-0000cae0: 6f72 2c20 6d61 7463 683d 2265 7865 6375  or, match="execu
-0000caf0: 7469 6f6e 2072 6576 6572 7465 6422 293a  tion reverted"):
-0000cb00: 0a20 2020 2020 2020 2020 2020 2074 786e  .            txn
-0000cb10: 5f70 6172 616d 7320 3d20 6173 796e 635f  _params = async_
-0000cb20: 7265 7665 7274 5f63 6f6e 7472 6163 742e  revert_contract.
-0000cb30: 5f70 7265 7061 7265 5f74 7261 6e73 6163  _prepare_transac
-0000cb40: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-0000cb50: 2020 2020 2020 666e 5f6e 616d 653d 2272        fn_name="r
-0000cb60: 6576 6572 7457 6974 686f 7574 4d65 7373  evertWithoutMess
-0000cb70: 6167 6522 2c0a 2020 2020 2020 2020 2020  age",.          
-0000cb80: 2020 2020 2020 7472 616e 7361 6374 696f        transactio
-0000cb90: 6e3d 7b0a 2020 2020 2020 2020 2020 2020  n={.            
-0000cba0: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
-0000cbb0: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
-0000cbc0: 6363 6f75 6e74 2c0a 2020 2020 2020 2020  ccount,.        
-0000cbd0: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
-0000cbe0: 3a20 6173 796e 635f 7265 7665 7274 5f63  : async_revert_c
-0000cbf0: 6f6e 7472 6163 742e 6164 6472 6573 732c  ontract.address,
-0000cc00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cc10: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-0000cc20: 290a 2020 2020 2020 2020 2020 2020 6177  ).            aw
-0000cc30: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-0000cc40: 2e63 616c 6c28 7478 6e5f 7061 7261 6d73  .call(txn_params
-0000cc50: 290a 0a20 2020 2040 7079 7465 7374 2e6d  )..    @pytest.m
-0000cc60: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-0000cc70: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-0000cc80: 7468 5f63 616c 6c5f 7265 7665 7274 5f63  th_call_revert_c
-0000cc90: 7573 746f 6d5f 6572 726f 725f 7769 7468  ustom_error_with
-0000cca0: 5f6d 7367 280a 2020 2020 2020 2020 7365  _msg(.        se
-0000ccb0: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
-0000ccc0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-0000ccd0: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
-0000cce0: 5f72 6576 6572 745f 636f 6e74 7261 6374  _revert_contract
-0000ccf0: 3a20 2243 6f6e 7472 6163 7422 2c0a 2020  : "Contract",.  
-0000cd00: 2020 2020 2020 6173 796e 635f 756e 6c6f        async_unlo
-0000cd10: 636b 6564 5f61 6363 6f75 6e74 3a20 4368  cked_account: Ch
-0000cd20: 6563 6b73 756d 4164 6472 6573 732c 0a20  ecksumAddress,. 
-0000cd30: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0000cd40: 2020 2020 2020 6461 7461 203d 2061 7379        data = asy
-0000cd50: 6e63 5f72 6576 6572 745f 636f 6e74 7261  nc_revert_contra
-0000cd60: 6374 2e65 6e63 6f64 655f 6162 6928 0a20  ct.encode_abi(. 
-0000cd70: 2020 2020 2020 2020 2020 2066 6e5f 6e61             fn_na
-0000cd80: 6d65 3d22 556e 6175 7468 6f72 697a 6564  me="Unauthorized
-0000cd90: 5769 7468 4d65 7373 6167 6522 2c20 6172  WithMessage", ar
-0000cda0: 6773 3d5b 2259 6f75 2061 7265 206e 6f74  gs=["You are not
-0000cdb0: 2061 7574 686f 7269 7a65 6422 5d0a 2020   authorized"].  
-0000cdc0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000cdd0: 7478 6e5f 7061 7261 6d73 203d 2061 7379  txn_params = asy
-0000cde0: 6e63 5f72 6576 6572 745f 636f 6e74 7261  nc_revert_contra
-0000cdf0: 6374 2e5f 7072 6570 6172 655f 7472 616e  ct._prepare_tran
-0000ce00: 7361 6374 696f 6e28 0a20 2020 2020 2020  saction(.       
-0000ce10: 2020 2020 2066 6e5f 6e61 6d65 3d22 6375       fn_name="cu
-0000ce20: 7374 6f6d 4572 726f 7257 6974 684d 6573  stomErrorWithMes
-0000ce30: 7361 6765 222c 0a20 2020 2020 2020 2020  sage",.         
-0000ce40: 2020 2074 7261 6e73 6163 7469 6f6e 3d7b     transaction={
-0000ce50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ce60: 2022 6672 6f6d 223a 2061 7379 6e63 5f75   "from": async_u
-0000ce70: 6e6c 6f63 6b65 645f 6163 636f 756e 742c  nlocked_account,
-0000ce80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ce90: 2022 746f 223a 2061 7379 6e63 5f72 6576   "to": async_rev
-0000cea0: 6572 745f 636f 6e74 7261 6374 2e61 6464  ert_contract.add
-0000ceb0: 7265 7373 2c0a 2020 2020 2020 2020 2020  ress,.          
-0000cec0: 2020 7d2c 0a20 2020 2020 2020 2029 0a20    },.        ). 
-0000ced0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-0000cee0: 7374 2e72 6169 7365 7328 436f 6e74 7261  st.raises(Contra
-0000cef0: 6374 4375 7374 6f6d 4572 726f 722c 206d  ctCustomError, m
-0000cf00: 6174 6368 3d64 6174 6129 3a0a 2020 2020  atch=data):.    
-0000cf10: 2020 2020 2020 2020 6177 6169 7420 6173          await as
-0000cf20: 796e 635f 7733 2e65 7468 2e63 616c 6c28  ync_w3.eth.call(
-0000cf30: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
-0000cf40: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-0000cf50: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-0000cf60: 6465 6620 7465 7374 5f65 7468 5f63 616c  def test_eth_cal
-0000cf70: 6c5f 7265 7665 7274 5f63 7573 746f 6d5f  l_revert_custom_
-0000cf80: 6572 726f 725f 7769 7468 6f75 745f 6d73  error_without_ms
-0000cf90: 6728 0a20 2020 2020 2020 2073 656c 662c  g(.        self,
-0000cfa0: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-0000cfb0: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
-0000cfc0: 2020 2020 2020 2020 6173 796e 635f 7265          async_re
-0000cfd0: 7665 7274 5f63 6f6e 7472 6163 743a 2022  vert_contract: "
-0000cfe0: 436f 6e74 7261 6374 222c 0a20 2020 2020  Contract",.     
-0000cff0: 2020 2061 7379 6e63 5f75 6e6c 6f63 6b65     async_unlocke
-0000d000: 645f 6163 636f 756e 743a 2043 6865 636b  d_account: Check
-0000d010: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
-0000d020: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0000d030: 2020 2064 6174 6120 3d20 6173 796e 635f     data = async_
-0000d040: 7265 7665 7274 5f63 6f6e 7472 6163 742e  revert_contract.
-0000d050: 656e 636f 6465 5f61 6269 2866 6e5f 6e61  encode_abi(fn_na
-0000d060: 6d65 3d22 556e 6175 7468 6f72 697a 6564  me="Unauthorized
-0000d070: 2229 0a20 2020 2020 2020 2074 786e 5f70  ").        txn_p
-0000d080: 6172 616d 7320 3d20 6173 796e 635f 7265  arams = async_re
-0000d090: 7665 7274 5f63 6f6e 7472 6163 742e 5f70  vert_contract._p
-0000d0a0: 7265 7061 7265 5f74 7261 6e73 6163 7469  repare_transacti
-0000d0b0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-0000d0c0: 666e 5f6e 616d 653d 2263 7573 746f 6d45  fn_name="customE
-0000d0d0: 7272 6f72 5769 7468 6f75 744d 6573 7361  rrorWithoutMessa
-0000d0e0: 6765 222c 0a20 2020 2020 2020 2020 2020  ge",.           
-0000d0f0: 2074 7261 6e73 6163 7469 6f6e 3d7b 0a20   transaction={. 
-0000d100: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000d110: 6672 6f6d 223a 2061 7379 6e63 5f75 6e6c  from": async_unl
-0000d120: 6f63 6b65 645f 6163 636f 756e 742c 0a20  ocked_account,. 
-0000d130: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000d140: 746f 223a 2061 7379 6e63 5f72 6576 6572  to": async_rever
-0000d150: 745f 636f 6e74 7261 6374 2e61 6464 7265  t_contract.addre
-0000d160: 7373 2c0a 2020 2020 2020 2020 2020 2020  ss,.            
-0000d170: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
-0000d180: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-0000d190: 2e72 6169 7365 7328 436f 6e74 7261 6374  .raises(Contract
-0000d1a0: 4375 7374 6f6d 4572 726f 722c 206d 6174  CustomError, mat
-0000d1b0: 6368 3d64 6174 6129 3a0a 2020 2020 2020  ch=data):.      
-0000d1c0: 2020 2020 2020 6177 6169 7420 6173 796e        await asyn
-0000d1d0: 635f 7733 2e65 7468 2e63 616c 6c28 7478  c_w3.eth.call(tx
-0000d1e0: 6e5f 7061 7261 6d73 290a 0a20 2020 2040  n_params)..    @
-0000d1f0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-0000d200: 6d65 7472 697a 6528 0a20 2020 2020 2020  metrize(.       
-0000d210: 2022 7061 6e69 635f 6572 726f 722c 7061   "panic_error,pa
-0000d220: 7261 6d73 222c 0a20 2020 2020 2020 2028  rams",.        (
-0000d230: 0a20 2020 2020 2020 2020 2020 2028 2230  .            ("0
-0000d240: 3122 2c20 5b5d 292c 0a20 2020 2020 2020  1", []),.       
-0000d250: 2020 2020 2028 2231 3122 2c20 5b5d 292c       ("11", []),
-0000d260: 0a20 2020 2020 2020 2020 2020 2028 2231  .            ("1
-0000d270: 3222 2c20 5b30 5d29 2c0a 2020 2020 2020  2", [0]),.      
-0000d280: 2020 2020 2020 2822 3231 222c 205b 2d31        ("21", [-1
+0000c220: 636f 6465 223a 2062 225c 7830 3022 2c20  code": b"\x00", 
+0000c230: 2023 2062 7974 6573 0a20 2020 2020 2020   # bytes.       
+0000c240: 2020 2020 2020 2020 2023 2077 6974 6820           # with 
+0000c250: 7374 6174 6544 6966 660a 2020 2020 2020  stateDiff.      
+0000c260: 2020 2020 2020 2020 2020 2273 7461 7465            "state
+0000c270: 4469 6666 223a 207b 4865 7853 7472 2866  Diff": {HexStr(f
+0000c280: 2230 787b 2730 3027 202a 2033 327d 2229  "0x{'00' * 32}")
+0000c290: 3a20 4865 7853 7472 2866 2230 787b 2730  : HexStr(f"0x{'0
+0000c2a0: 3027 202a 2033 327d 2229 7d2c 0a20 2020  0' * 32}")},.   
+0000c2b0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+0000c2c0: 2020 2020 292c 0a20 2020 2029 0a20 2020      ),.    ).   
+0000c2d0: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+0000c2e0: 6574 685f 6361 6c6c 5f77 6974 685f 6f76  eth_call_with_ov
+0000c2f0: 6572 7269 6465 5f70 6172 616d 5f74 7970  erride_param_typ
+0000c300: 655f 6368 6563 6b28 0a20 2020 2020 2020  e_check(.       
+0000c310: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
+0000c320: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
+0000c330: 6562 3322 2c0a 2020 2020 2020 2020 6173  eb3",.        as
+0000c340: 796e 635f 6d61 7468 5f63 6f6e 7472 6163  ync_math_contrac
+0000c350: 743a 2022 4173 796e 6343 6f6e 7472 6163  t: "AsyncContrac
+0000c360: 7422 2c0a 2020 2020 2020 2020 7061 7261  t",.        para
+0000c370: 6d73 3a20 5374 6174 654f 7665 7272 6964  ms: StateOverrid
+0000c380: 6550 6172 616d 732c 0a20 2020 2029 202d  eParams,.    ) -
+0000c390: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0000c3a0: 636f 696e 6261 7365 203d 2061 7761 6974  coinbase = await
+0000c3b0: 2061 7379 6e63 5f77 332e 6574 682e 636f   async_w3.eth.co
+0000c3c0: 696e 6261 7365 0a20 2020 2020 2020 2074  inbase.        t
+0000c3d0: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+0000c3e0: 616d 7320 3d20 7b22 6672 6f6d 223a 2063  ams = {"from": c
+0000c3f0: 6f69 6e62 6173 657d 0a0a 2020 2020 2020  oinbase}..      
+0000c400: 2020 2320 6173 7365 7274 2064 6f65 7320    # assert does 
+0000c410: 6e6f 7420 7261 6973 650a 2020 2020 2020  not raise.      
+0000c420: 2020 6177 6169 7420 6173 796e 635f 7733    await async_w3
+0000c430: 2e65 7468 2e63 616c 6c28 0a20 2020 2020  .eth.call(.     
+0000c440: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+0000c450: 732c 2022 6c61 7465 7374 222c 207b 6173  s, "latest", {as
+0000c460: 796e 635f 6d61 7468 5f63 6f6e 7472 6163  ync_math_contrac
+0000c470: 742e 6164 6472 6573 733a 2070 6172 616d  t.address: param
+0000c480: 737d 0a20 2020 2020 2020 2029 0a0a 2020  s}.        )..  
+0000c490: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+0000c4a0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+0000c4b0: 2064 6566 2074 6573 745f 6574 685f 6361   def test_eth_ca
+0000c4c0: 6c6c 5f77 6974 685f 305f 7265 7375 6c74  ll_with_0_result
+0000c4d0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+0000c4e0: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+0000c4f0: 5765 6233 222c 2061 7379 6e63 5f6d 6174  Web3", async_mat
+0000c500: 685f 636f 6e74 7261 6374 3a20 2241 7379  h_contract: "Asy
+0000c510: 6e63 436f 6e74 7261 6374 220a 2020 2020  ncContract".    
+0000c520: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0000c530: 2020 2063 6f69 6e62 6173 6520 3d20 6177     coinbase = aw
+0000c540: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+0000c550: 2e63 6f69 6e62 6173 650a 2020 2020 2020  .coinbase.      
+0000c560: 2020 7478 6e5f 7061 7261 6d73 203d 2061    txn_params = a
+0000c570: 7379 6e63 5f6d 6174 685f 636f 6e74 7261  sync_math_contra
+0000c580: 6374 2e5f 7072 6570 6172 655f 7472 616e  ct._prepare_tran
+0000c590: 7361 6374 696f 6e28 0a20 2020 2020 2020  saction(.       
+0000c5a0: 2020 2020 2066 6e5f 6e61 6d65 3d22 6164       fn_name="ad
+0000c5b0: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+0000c5c0: 666e 5f61 7267 733d 2830 2c20 3029 2c0a  fn_args=(0, 0),.
+0000c5d0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
+0000c5e0: 7361 6374 696f 6e3d 7b22 6672 6f6d 223a  saction={"from":
+0000c5f0: 2063 6f69 6e62 6173 652c 2022 746f 223a   coinbase, "to":
+0000c600: 2061 7379 6e63 5f6d 6174 685f 636f 6e74   async_math_cont
+0000c610: 7261 6374 2e61 6464 7265 7373 7d2c 0a20  ract.address},. 
+0000c620: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000c630: 2063 616c 6c5f 7265 7375 6c74 203d 2061   call_result = a
+0000c640: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+0000c650: 682e 6361 6c6c 2874 786e 5f70 6172 616d  h.call(txn_param
+0000c660: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
+0000c670: 7420 6973 5f73 7472 696e 6728 6361 6c6c  t is_string(call
+0000c680: 5f72 6573 756c 7429 0a20 2020 2020 2020  _result).       
+0000c690: 2028 7265 7375 6c74 2c29 203d 2061 7379   (result,) = asy
+0000c6a0: 6e63 5f77 332e 636f 6465 632e 6465 636f  nc_w3.codec.deco
+0000c6b0: 6465 285b 2275 696e 7432 3536 225d 2c20  de(["uint256"], 
+0000c6c0: 6361 6c6c 5f72 6573 756c 7429 0a20 2020  call_result).   
+0000c6d0: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
+0000c6e0: 6c74 203d 3d20 300a 0a20 2020 2040 7079  lt == 0..    @py
+0000c6f0: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+0000c700: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+0000c710: 7465 7374 5f65 7468 5f63 616c 6c5f 7265  test_eth_call_re
+0000c720: 7665 7274 5f77 6974 685f 6d73 6728 0a20  vert_with_msg(. 
+0000c730: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0000c740: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
+0000c750: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
+0000c760: 2020 2020 6173 796e 635f 7265 7665 7274      async_revert
+0000c770: 5f63 6f6e 7472 6163 743a 2022 4173 796e  _contract: "Asyn
+0000c780: 6343 6f6e 7472 6163 7422 2c0a 2020 2020  cContract",.    
+0000c790: 2020 2020 6173 796e 635f 756e 6c6f 636b      async_unlock
+0000c7a0: 6564 5f61 6363 6f75 6e74 3a20 4368 6563  ed_account: Chec
+0000c7b0: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
+0000c7c0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+0000c7d0: 2020 2020 7478 6e5f 7061 7261 6d73 203d      txn_params =
+0000c7e0: 2061 7379 6e63 5f72 6576 6572 745f 636f   async_revert_co
+0000c7f0: 6e74 7261 6374 2e5f 7072 6570 6172 655f  ntract._prepare_
+0000c800: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
+0000c810: 2020 2020 2020 2020 2066 6e5f 6e61 6d65           fn_name
+0000c820: 3d22 7265 7665 7274 5769 7468 4d65 7373  ="revertWithMess
+0000c830: 6167 6522 2c0a 2020 2020 2020 2020 2020  age",.          
+0000c840: 2020 7472 616e 7361 6374 696f 6e3d 7b0a    transaction={.
+0000c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c860: 2266 726f 6d22 3a20 6173 796e 635f 756e  "from": async_un
+0000c870: 6c6f 636b 6564 5f61 6363 6f75 6e74 2c0a  locked_account,.
+0000c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c890: 2274 6f22 3a20 6173 796e 635f 7265 7665  "to": async_reve
+0000c8a0: 7274 5f63 6f6e 7472 6163 742e 6164 6472  rt_contract.addr
+0000c8b0: 6573 732c 0a20 2020 2020 2020 2020 2020  ess,.           
+0000c8c0: 207d 2c0a 2020 2020 2020 2020 290a 2020   },.        ).  
+0000c8d0: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+0000c8e0: 742e 7261 6973 6573 280a 2020 2020 2020  t.raises(.      
+0000c8f0: 2020 2020 2020 436f 6e74 7261 6374 4c6f        ContractLo
+0000c900: 6769 6345 7272 6f72 2c20 6d61 7463 683d  gicError, match=
+0000c910: 2265 7865 6375 7469 6f6e 2072 6576 6572  "execution rever
+0000c920: 7465 643a 2046 756e 6374 696f 6e20 6861  ted: Function ha
+0000c930: 7320 6265 656e 2072 6576 6572 7465 6422  s been reverted"
+0000c940: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+0000c950: 2020 2020 2020 2020 6177 6169 7420 6173          await as
+0000c960: 796e 635f 7733 2e65 7468 2e63 616c 6c28  ync_w3.eth.call(
+0000c970: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
+0000c980: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+0000c990: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+0000c9a0: 6465 6620 7465 7374 5f65 7468 5f63 616c  def test_eth_cal
+0000c9b0: 6c5f 7265 7665 7274 5f77 6974 686f 7574  l_revert_without
+0000c9c0: 5f6d 7367 280a 2020 2020 2020 2020 7365  _msg(.        se
+0000c9d0: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
+0000c9e0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+0000c9f0: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
+0000ca00: 5f72 6576 6572 745f 636f 6e74 7261 6374  _revert_contract
+0000ca10: 3a20 2241 7379 6e63 436f 6e74 7261 6374  : "AsyncContract
+0000ca20: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
+0000ca30: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+0000ca40: 743a 2043 6865 636b 7375 6d41 6464 7265  t: ChecksumAddre
+0000ca50: 7373 2c0a 2020 2020 2920 2d3e 204e 6f6e  ss,.    ) -> Non
+0000ca60: 653a 0a20 2020 2020 2020 2077 6974 6820  e:.        with 
+0000ca70: 7079 7465 7374 2e72 6169 7365 7328 436f  pytest.raises(Co
+0000ca80: 6e74 7261 6374 4c6f 6769 6345 7272 6f72  ntractLogicError
+0000ca90: 2c20 6d61 7463 683d 2265 7865 6375 7469  , match="executi
+0000caa0: 6f6e 2072 6576 6572 7465 6422 293a 0a20  on reverted"):. 
+0000cab0: 2020 2020 2020 2020 2020 2074 786e 5f70             txn_p
+0000cac0: 6172 616d 7320 3d20 6173 796e 635f 7265  arams = async_re
+0000cad0: 7665 7274 5f63 6f6e 7472 6163 742e 5f70  vert_contract._p
+0000cae0: 7265 7061 7265 5f74 7261 6e73 6163 7469  repare_transacti
+0000caf0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+0000cb00: 2020 2020 666e 5f6e 616d 653d 2272 6576      fn_name="rev
+0000cb10: 6572 7457 6974 686f 7574 4d65 7373 6167  ertWithoutMessag
+0000cb20: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+0000cb30: 2020 2020 7472 616e 7361 6374 696f 6e3d      transaction=
+0000cb40: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0000cb50: 2020 2020 2020 2266 726f 6d22 3a20 6173        "from": as
+0000cb60: 796e 635f 756e 6c6f 636b 6564 5f61 6363  ync_unlocked_acc
+0000cb70: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
+0000cb80: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+0000cb90: 6173 796e 635f 7265 7665 7274 5f63 6f6e  async_revert_con
+0000cba0: 7472 6163 742e 6164 6472 6573 732c 0a20  tract.address,. 
+0000cbb0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0000cbc0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0000cbd0: 2020 2020 2020 2020 2020 2020 6177 6169              awai
+0000cbe0: 7420 6173 796e 635f 7733 2e65 7468 2e63  t async_w3.eth.c
+0000cbf0: 616c 6c28 7478 6e5f 7061 7261 6d73 290a  all(txn_params).
+0000cc00: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+0000cc10: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+0000cc20: 796e 6320 6465 6620 7465 7374 5f65 7468  ync def test_eth
+0000cc30: 5f63 616c 6c5f 7265 7665 7274 5f63 7573  _call_revert_cus
+0000cc40: 746f 6d5f 6572 726f 725f 7769 7468 5f6d  tom_error_with_m
+0000cc50: 7367 280a 2020 2020 2020 2020 7365 6c66  sg(.        self
+0000cc60: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+0000cc70: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+0000cc80: 0a20 2020 2020 2020 2061 7379 6e63 5f72  .        async_r
+0000cc90: 6576 6572 745f 636f 6e74 7261 6374 3a20  evert_contract: 
+0000cca0: 2241 7379 6e63 436f 6e74 7261 6374 222c  "AsyncContract",
+0000ccb0: 0a20 2020 2020 2020 2061 7379 6e63 5f75  .        async_u
+0000ccc0: 6e6c 6f63 6b65 645f 6163 636f 756e 743a  nlocked_account:
+0000ccd0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+0000cce0: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+0000ccf0: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
+0000cd00: 6173 796e 635f 7265 7665 7274 5f63 6f6e  async_revert_con
+0000cd10: 7472 6163 742e 656e 636f 6465 5f61 6269  tract.encode_abi
+0000cd20: 280a 2020 2020 2020 2020 2020 2020 666e  (.            fn
+0000cd30: 5f6e 616d 653d 2255 6e61 7574 686f 7269  _name="Unauthori
+0000cd40: 7a65 6457 6974 684d 6573 7361 6765 222c  zedWithMessage",
+0000cd50: 2061 7267 733d 5b22 596f 7520 6172 6520   args=["You are 
+0000cd60: 6e6f 7420 6175 7468 6f72 697a 6564 225d  not authorized"]
+0000cd70: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0000cd80: 2020 2074 786e 5f70 6172 616d 7320 3d20     txn_params = 
+0000cd90: 6173 796e 635f 7265 7665 7274 5f63 6f6e  async_revert_con
+0000cda0: 7472 6163 742e 5f70 7265 7061 7265 5f74  tract._prepare_t
+0000cdb0: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
+0000cdc0: 2020 2020 2020 2020 666e 5f6e 616d 653d          fn_name=
+0000cdd0: 2263 7573 746f 6d45 7272 6f72 5769 7468  "customErrorWith
+0000cde0: 4d65 7373 6167 6522 2c0a 2020 2020 2020  Message",.      
+0000cdf0: 2020 2020 2020 7472 616e 7361 6374 696f        transactio
+0000ce00: 6e3d 7b0a 2020 2020 2020 2020 2020 2020  n={.            
+0000ce10: 2020 2020 2266 726f 6d22 3a20 6173 796e      "from": asyn
+0000ce20: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
+0000ce30: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+0000ce40: 2020 2020 2274 6f22 3a20 6173 796e 635f      "to": async_
+0000ce50: 7265 7665 7274 5f63 6f6e 7472 6163 742e  revert_contract.
+0000ce60: 6164 6472 6573 732c 0a20 2020 2020 2020  address,.       
+0000ce70: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+0000ce80: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+0000ce90: 7974 6573 742e 7261 6973 6573 2843 6f6e  ytest.raises(Con
+0000cea0: 7472 6163 7443 7573 746f 6d45 7272 6f72  tractCustomError
+0000ceb0: 2c20 6d61 7463 683d 6461 7461 293a 0a20  , match=data):. 
+0000cec0: 2020 2020 2020 2020 2020 2061 7761 6974             await
+0000ced0: 2061 7379 6e63 5f77 332e 6574 682e 6361   async_w3.eth.ca
+0000cee0: 6c6c 2874 786e 5f70 6172 616d 7329 0a0a  ll(txn_params)..
+0000cef0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+0000cf00: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+0000cf10: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
+0000cf20: 6361 6c6c 5f72 6576 6572 745f 6375 7374  call_revert_cust
+0000cf30: 6f6d 5f65 7272 6f72 5f77 6974 686f 7574  om_error_without
+0000cf40: 5f6d 7367 280a 2020 2020 2020 2020 7365  _msg(.        se
+0000cf50: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
+0000cf60: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+0000cf70: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
+0000cf80: 5f72 6576 6572 745f 636f 6e74 7261 6374  _revert_contract
+0000cf90: 3a20 2241 7379 6e63 436f 6e74 7261 6374  : "AsyncContract
+0000cfa0: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
+0000cfb0: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+0000cfc0: 743a 2043 6865 636b 7375 6d41 6464 7265  t: ChecksumAddre
+0000cfd0: 7373 2c0a 2020 2020 2920 2d3e 204e 6f6e  ss,.    ) -> Non
+0000cfe0: 653a 0a20 2020 2020 2020 2064 6174 6120  e:.        data 
+0000cff0: 3d20 6173 796e 635f 7265 7665 7274 5f63  = async_revert_c
+0000d000: 6f6e 7472 6163 742e 656e 636f 6465 5f61  ontract.encode_a
+0000d010: 6269 2866 6e5f 6e61 6d65 3d22 556e 6175  bi(fn_name="Unau
+0000d020: 7468 6f72 697a 6564 2229 0a20 2020 2020  thorized").     
+0000d030: 2020 2074 786e 5f70 6172 616d 7320 3d20     txn_params = 
+0000d040: 6173 796e 635f 7265 7665 7274 5f63 6f6e  async_revert_con
+0000d050: 7472 6163 742e 5f70 7265 7061 7265 5f74  tract._prepare_t
+0000d060: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
+0000d070: 2020 2020 2020 2020 666e 5f6e 616d 653d          fn_name=
+0000d080: 2263 7573 746f 6d45 7272 6f72 5769 7468  "customErrorWith
+0000d090: 6f75 744d 6573 7361 6765 222c 0a20 2020  outMessage",.   
+0000d0a0: 2020 2020 2020 2020 2074 7261 6e73 6163           transac
+0000d0b0: 7469 6f6e 3d7b 0a20 2020 2020 2020 2020  tion={.         
+0000d0c0: 2020 2020 2020 2022 6672 6f6d 223a 2061         "from": a
+0000d0d0: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+0000d0e0: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
+0000d0f0: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
+0000d100: 6e63 5f72 6576 6572 745f 636f 6e74 7261  nc_revert_contra
+0000d110: 6374 2e61 6464 7265 7373 2c0a 2020 2020  ct.address,.    
+0000d120: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+0000d130: 2020 2029 0a20 2020 2020 2020 2077 6974     ).        wit
+0000d140: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+0000d150: 436f 6e74 7261 6374 4375 7374 6f6d 4572  ContractCustomEr
+0000d160: 726f 722c 206d 6174 6368 3d64 6174 6129  ror, match=data)
+0000d170: 3a0a 2020 2020 2020 2020 2020 2020 6177  :.            aw
+0000d180: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+0000d190: 2e63 616c 6c28 7478 6e5f 7061 7261 6d73  .call(txn_params
+0000d1a0: 290a 0a20 2020 2040 7079 7465 7374 2e6d  )..    @pytest.m
+0000d1b0: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+0000d1c0: 0a20 2020 2020 2020 2022 7061 6e69 635f  .        "panic_
+0000d1d0: 6572 726f 722c 7061 7261 6d73 222c 0a20  error,params",. 
+0000d1e0: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
+0000d1f0: 2020 2020 2028 2230 3122 2c20 5b5d 292c       ("01", []),
+0000d200: 0a20 2020 2020 2020 2020 2020 2028 2231  .            ("1
+0000d210: 3122 2c20 5b5d 292c 0a20 2020 2020 2020  1", []),.       
+0000d220: 2020 2020 2028 2231 3222 2c20 5b30 5d29       ("12", [0])
+0000d230: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
+0000d240: 3231 222c 205b 2d31 5d29 2c0a 2020 2020  21", [-1]),.    
+0000d250: 2020 2020 2020 2020 2822 3232 222c 205b          ("22", [
+0000d260: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+0000d270: 2822 3331 222c 205b 5d29 2c0a 2020 2020  ("31", []),.    
+0000d280: 2020 2020 2020 2020 2822 3332 222c 205b          ("32", [
 0000d290: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-0000d2a0: 2822 3232 222c 205b 5d29 2c0a 2020 2020  ("22", []),.    
-0000d2b0: 2020 2020 2020 2020 2822 3331 222c 205b          ("31", [
-0000d2c0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-0000d2d0: 2822 3332 222c 205b 5d29 2c0a 2020 2020  ("32", []),.    
-0000d2e0: 2020 2020 2020 2020 2822 3431 222c 205b          ("41", [
-0000d2f0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-0000d300: 2822 3531 222c 205b 5d29 2c0a 2020 2020  ("51", []),.    
-0000d310: 2020 2020 292c 0a20 2020 2029 0a20 2020      ),.    ).   
-0000d320: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-0000d330: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-0000d340: 6465 6620 7465 7374 5f63 6f6e 7472 6163  def test_contrac
-0000d350: 745f 7061 6e69 635f 6572 726f 7273 280a  t_panic_errors(.
-0000d360: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000d370: 2020 2020 2020 6173 796e 635f 7733 3a20        async_w3: 
-0000d380: 2241 7379 6e63 5765 6233 222c 0a20 2020  "AsyncWeb3",.   
-0000d390: 2020 2020 2061 7379 6e63 5f70 616e 6963       async_panic
-0000d3a0: 5f65 7272 6f72 735f 636f 6e74 7261 6374  _errors_contract
-0000d3b0: 3a20 2243 6f6e 7472 6163 7422 2c0a 2020  : "Contract",.  
-0000d3c0: 2020 2020 2020 7061 6e69 635f 6572 726f        panic_erro
-0000d3d0: 723a 2073 7472 2c0a 2020 2020 2020 2020  r: str,.        
-0000d3e0: 7061 7261 6d73 3a20 4c69 7374 5b41 6e79  params: List[Any
-0000d3f0: 5d2c 0a20 2020 2029 202d 3e20 4e6f 6e65  ],.    ) -> None
-0000d400: 3a0a 2020 2020 2020 2020 6d65 7468 6f64  :.        method
-0000d410: 203d 2067 6574 6174 7472 280a 2020 2020   = getattr(.    
-0000d420: 2020 2020 2020 2020 6173 796e 635f 7061          async_pa
-0000d430: 6e69 635f 6572 726f 7273 5f63 6f6e 7472  nic_errors_contr
-0000d440: 6163 742e 6675 6e63 7469 6f6e 732c 0a20  act.functions,. 
-0000d450: 2020 2020 2020 2020 2020 2066 2265 7272             f"err
-0000d460: 6f72 436f 6465 7b70 616e 6963 5f65 7272  orCode{panic_err
-0000d470: 6f72 7d22 2c0a 2020 2020 2020 2020 290a  or}",.        ).
-0000d480: 2020 2020 2020 2020 6572 726f 725f 6d73          error_ms
-0000d490: 6720 3d20 5041 4e49 435f 4552 524f 525f  g = PANIC_ERROR_
-0000d4a0: 434f 4445 535b 7061 6e69 635f 6572 726f  CODES[panic_erro
-0000d4b0: 725d 0a0a 2020 2020 2020 2020 7769 7468  r]..        with
-0000d4c0: 2070 7974 6573 742e 7261 6973 6573 2843   pytest.raises(C
-0000d4d0: 6f6e 7472 6163 7450 616e 6963 4572 726f  ontractPanicErro
-0000d4e0: 722c 206d 6174 6368 3d72 652e 6573 6361  r, match=re.esca
-0000d4f0: 7065 2865 7272 6f72 5f6d 7367 2929 3a0a  pe(error_msg)):.
-0000d500: 2020 2020 2020 2020 2020 2020 6177 6169              awai
-0000d510: 7420 6d65 7468 6f64 282a 7061 7261 6d73  t method(*params
-0000d520: 292e 6361 6c6c 2829 0a0a 2020 2020 4070  ).call()..    @p
-0000d530: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-0000d540: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-0000d550: 2074 6573 745f 6574 685f 6361 6c6c 5f6f   test_eth_call_o
-0000d560: 6666 6368 6169 6e5f 6c6f 6f6b 7570 280a  ffchain_lookup(.
-0000d570: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000d580: 2020 2020 2020 6173 796e 635f 7733 3a20        async_w3: 
-0000d590: 2241 7379 6e63 5765 6233 222c 0a20 2020  "AsyncWeb3",.   
-0000d5a0: 2020 2020 2061 7379 6e63 5f6f 6666 6368       async_offch
-0000d5b0: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
-0000d5c0: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
-0000d5d0: 0a20 2020 2020 2020 2061 7379 6e63 5f75  .        async_u
-0000d5e0: 6e6c 6f63 6b65 645f 6163 636f 756e 743a  nlocked_account:
-0000d5f0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-0000d600: 2c0a 2020 2020 2020 2020 6d6f 6e6b 6579  ,.        monkey
-0000d610: 7061 7463 683a 2022 4d6f 6e6b 6579 5061  patch: "MonkeyPa
-0000d620: 7463 6822 2c0a 2020 2020 2920 2d3e 204e  tch",.    ) -> N
-0000d630: 6f6e 653a 0a20 2020 2020 2020 206e 6f72  one:.        nor
-0000d640: 6d61 6c69 7a65 645f 636f 6e74 7261 6374  malized_contract
-0000d650: 5f61 6464 7265 7373 203d 2074 6f5f 6865  _address = to_he
-0000d660: 785f 6966 5f62 7974 6573 280a 2020 2020  x_if_bytes(.    
-0000d670: 2020 2020 2020 2020 6173 796e 635f 6f66          async_of
-0000d680: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
-0000d690: 6e74 7261 6374 2e61 6464 7265 7373 0a20  ntract.address. 
-0000d6a0: 2020 2020 2020 2029 2e6c 6f77 6572 2829         ).lower()
-0000d6b0: 0a0a 2020 2020 2020 2020 6173 796e 635f  ..        async_
-0000d6c0: 6d6f 636b 5f6f 6666 6368 6169 6e5f 6c6f  mock_offchain_lo
-0000d6d0: 6f6b 7570 5f72 6571 7565 7374 5f72 6573  okup_request_res
-0000d6e0: 706f 6e73 6528 0a20 2020 2020 2020 2020  ponse(.         
-0000d6f0: 2020 206d 6f6e 6b65 7970 6174 6368 2c0a     monkeypatch,.
-0000d700: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
-0000d710: 6564 5f72 6571 7565 7374 5f75 726c 3d66  ed_request_url=f
-0000d720: 2268 7474 7073 3a2f 2f77 6562 332e 7079  "https://web3.py
-0000d730: 2f67 6174 6577 6179 2f7b 6e6f 726d 616c  /gateway/{normal
-0000d740: 697a 6564 5f63 6f6e 7472 6163 745f 6164  ized_contract_ad
-0000d750: 6472 6573 737d 2f7b 4f46 4643 4841 494e  dress}/{OFFCHAIN
-0000d760: 5f4c 4f4f 4b55 505f 5445 5354 5f44 4154  _LOOKUP_TEST_DAT
-0000d770: 417d 2e6a 736f 6e22 2c20 2023 206e 6f71  A}.json",  # noq
-0000d780: 613a 2045 3530 310a 2020 2020 2020 2020  a: E501.        
-0000d790: 2020 2020 6d6f 636b 6564 5f6a 736f 6e5f      mocked_json_
-0000d7a0: 6461 7461 3d57 4542 3350 595f 4153 5f48  data=WEB3PY_AS_H
-0000d7b0: 4558 4259 5445 532c 0a20 2020 2020 2020  EXBYTES,.       
-0000d7c0: 2029 0a20 2020 2020 2020 2072 6573 706f   ).        respo
-0000d7d0: 6e73 655f 6361 6c6c 6572 203d 2061 7761  nse_caller = awa
-0000d7e0: 6974 2061 7379 6e63 5f6f 6666 6368 6169  it async_offchai
-0000d7f0: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
-0000d800: 742e 6361 6c6c 6572 2829 2e74 6573 744f  t.caller().testO
-0000d810: 6666 6368 6169 6e4c 6f6f 6b75 7028 2020  ffchainLookup(  
-0000d820: 2320 6e6f 7161 3a20 4535 3031 2074 7970  # noqa: E501 typ
-0000d830: 653a 2069 676e 6f72 650a 2020 2020 2020  e: ignore.      
-0000d840: 2020 2020 2020 4f46 4643 4841 494e 5f4c        OFFCHAIN_L
-0000d850: 4f4f 4b55 505f 5445 5354 5f44 4154 410a  OOKUP_TEST_DATA.
-0000d860: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000d870: 2020 7265 7370 6f6e 7365 5f66 756e 6374    response_funct
-0000d880: 696f 6e5f 6361 6c6c 203d 2061 7761 6974  ion_call = await
-0000d890: 2061 7379 6e63 5f6f 6666 6368 6169 6e5f   async_offchain_
-0000d8a0: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
-0000d8b0: 6675 6e63 7469 6f6e 732e 7465 7374 4f66  functions.testOf
-0000d8c0: 6663 6861 696e 4c6f 6f6b 7570 2820 2023  fchainLookup(  #
-0000d8d0: 206e 6f71 613a 2045 3530 3120 7479 7065   noqa: E501 type
-0000d8e0: 3a20 6967 6e6f 7265 0a20 2020 2020 2020  : ignore.       
-0000d8f0: 2020 2020 204f 4646 4348 4149 4e5f 4c4f       OFFCHAIN_LO
-0000d900: 4f4b 5550 5f54 4553 545f 4441 5441 0a20  OKUP_TEST_DATA. 
-0000d910: 2020 2020 2020 2029 2e63 616c 6c28 290a         ).call().
-0000d920: 2020 2020 2020 2020 6173 7365 7274 2061          assert a
-0000d930: 7379 6e63 5f77 332e 636f 6465 632e 6465  sync_w3.codec.de
-0000d940: 636f 6465 285b 2273 7472 696e 6722 5d2c  code(["string"],
-0000d950: 2072 6573 706f 6e73 655f 6361 6c6c 6572   response_caller
-0000d960: 295b 305d 203d 3d20 2277 6562 3370 7922  )[0] == "web3py"
-0000d970: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0000d980: 6173 796e 635f 7733 2e63 6f64 6563 2e64  async_w3.codec.d
-0000d990: 6563 6f64 6528 5b22 7374 7269 6e67 225d  ecode(["string"]
-0000d9a0: 2c20 7265 7370 6f6e 7365 5f66 756e 6374  , response_funct
-0000d9b0: 696f 6e5f 6361 6c6c 295b 305d 203d 3d20  ion_call)[0] == 
-0000d9c0: 2277 6562 3370 7922 0a0a 2020 2020 4070  "web3py"..    @p
-0000d9d0: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-0000d9e0: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-0000d9f0: 2074 6573 745f 6574 685f 6361 6c6c 5f6f   test_eth_call_o
-0000da00: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f72  ffchain_lookup_r
-0000da10: 6169 7365 735f 7768 656e 5f63 6369 705f  aises_when_ccip_
-0000da20: 7265 6164 5f69 735f 6469 7361 626c 6564  read_is_disabled
-0000da30: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000da40: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
-0000da50: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
-0000da60: 2020 2020 2020 2061 7379 6e63 5f6f 6666         async_off
-0000da70: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
-0000da80: 7472 6163 743a 2022 436f 6e74 7261 6374  tract: "Contract
-0000da90: 222c 0a20 2020 2029 202d 3e20 4e6f 6e65  ",.    ) -> None
-0000daa0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0000dab0: 5f64 6174 6120 3d20 280a 2020 2020 2020  _data = (.      
-0000dac0: 2020 2020 2020 4f46 4643 4841 494e 5f4c        OFFCHAIN_L
-0000dad0: 4f4f 4b55 505f 3442 5954 455f 4441 5441  OOKUP_4BYTE_DATA
-0000dae0: 0a20 2020 2020 2020 2020 2020 202b 2061  .            + a
-0000daf0: 6269 5f65 6e63 6f64 6564 5f6f 6666 6368  bi_encoded_offch
-0000db00: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
-0000db10: 6163 745f 6164 6472 6573 7328 0a20 2020  act_address(.   
-0000db20: 2020 2020 2020 2020 2020 2020 2061 7379               asy
-0000db30: 6e63 5f77 332c 2061 7379 6e63 5f6f 6666  nc_w3, async_off
-0000db40: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
-0000db50: 7472 6163 740a 2020 2020 2020 2020 2020  tract.          
-0000db60: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000db70: 2b20 4f46 4643 4841 494e 5f4c 4f4f 4b55  + OFFCHAIN_LOOKU
-0000db80: 505f 5245 5455 524e 5f44 4154 410a 2020  P_RETURN_DATA.  
-0000db90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000dba0: 2320 7465 7374 2041 7379 6e63 436f 6e74  # test AsyncCont
-0000dbb0: 7261 6374 4361 6c6c 6572 0a20 2020 2020  ractCaller.     
-0000dbc0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-0000dbd0: 6169 7365 7328 4f66 6663 6861 696e 4c6f  aises(OffchainLo
-0000dbe0: 6f6b 7570 2920 6173 2065 3a0a 2020 2020  okup) as e:.    
-0000dbf0: 2020 2020 2020 2020 6177 6169 7420 6173          await as
-0000dc00: 796e 635f 6f66 6663 6861 696e 5f6c 6f6f  ync_offchain_loo
-0000dc10: 6b75 705f 636f 6e74 7261 6374 2e63 616c  kup_contract.cal
-0000dc20: 6c65 7228 0a20 2020 2020 2020 2020 2020  ler(.           
-0000dc30: 2020 2020 2063 6369 705f 7265 6164 5f65       ccip_read_e
-0000dc40: 6e61 626c 6564 3d46 616c 7365 0a20 2020  nabled=False.   
-0000dc50: 2020 2020 2020 2020 2029 2e74 6573 744f           ).testO
-0000dc60: 6666 6368 6169 6e4c 6f6f 6b75 7028 4f46  ffchainLookup(OF
-0000dc70: 4643 4841 494e 5f4c 4f4f 4b55 505f 5445  FCHAIN_LOOKUP_TE
-0000dc80: 5354 5f44 4154 4129 0a20 2020 2020 2020  ST_DATA).       
-0000dc90: 2061 7373 6572 7420 652e 7661 6c75 652e   assert e.value.
-0000dca0: 6461 7461 203d 3d20 7265 7475 726e 5f64  data == return_d
-0000dcb0: 6174 610a 0a20 2020 2020 2020 2023 2074  ata..        # t
-0000dcc0: 6573 7420 4173 796e 6343 6f6e 7472 6163  est AsyncContrac
-0000dcd0: 7446 756e 6374 696f 6e20 6361 6c6c 0a20  tFunction call. 
-0000dce0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-0000dcf0: 7374 2e72 6169 7365 7328 4f66 6663 6861  st.raises(Offcha
-0000dd00: 696e 4c6f 6f6b 7570 2920 6173 2065 7863  inLookup) as exc
-0000dd10: 696e 666f 3a0a 2020 2020 2020 2020 2020  info:.          
-0000dd20: 2020 6177 6169 7420 6173 796e 635f 6f66    await async_of
-0000dd30: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
-0000dd40: 6e74 7261 6374 2e66 756e 6374 696f 6e73  ntract.functions
-0000dd50: 2e74 6573 744f 6666 6368 6169 6e4c 6f6f  .testOffchainLoo
-0000dd60: 6b75 7028 0a20 2020 2020 2020 2020 2020  kup(.           
-0000dd70: 2020 2020 204f 4646 4348 4149 4e5f 4c4f       OFFCHAIN_LO
-0000dd80: 4f4b 5550 5f54 4553 545f 4441 5441 0a20  OKUP_TEST_DATA. 
-0000dd90: 2020 2020 2020 2020 2020 2029 2e63 616c             ).cal
-0000dda0: 6c28 6363 6970 5f72 6561 645f 656e 6162  l(ccip_read_enab
-0000ddb0: 6c65 643d 4661 6c73 6529 0a20 2020 2020  led=False).     
-0000ddc0: 2020 2061 7373 6572 7420 6578 6369 6e66     assert excinf
-0000ddd0: 6f2e 7661 6c75 652e 6461 7461 203d 3d20  o.value.data == 
-0000dde0: 7265 7475 726e 5f64 6174 610a 0a20 2020  return_data..   
-0000ddf0: 2020 2020 2023 2074 6573 7420 676c 6f62       # test glob
-0000de00: 616c 2066 6c61 6720 6f6e 2074 6865 2070  al flag on the p
-0000de10: 726f 7669 6465 720a 2020 2020 2020 2020  rovider.        
-0000de20: 6173 796e 635f 7733 2e70 726f 7669 6465  async_w3.provide
-0000de30: 722e 676c 6f62 616c 5f63 6369 705f 7265  r.global_ccip_re
-0000de40: 6164 5f65 6e61 626c 6564 203d 2046 616c  ad_enabled = Fal
-0000de50: 7365 0a0a 2020 2020 2020 2020 7769 7468  se..        with
-0000de60: 2070 7974 6573 742e 7261 6973 6573 284f   pytest.raises(O
-0000de70: 6666 6368 6169 6e4c 6f6f 6b75 7029 2061  ffchainLookup) a
-0000de80: 7320 6578 635f 696e 666f 3a0a 2020 2020  s exc_info:.    
-0000de90: 2020 2020 2020 2020 6177 6169 7420 6173          await as
-0000dea0: 796e 635f 6f66 6663 6861 696e 5f6c 6f6f  ync_offchain_loo
-0000deb0: 6b75 705f 636f 6e74 7261 6374 2e66 756e  kup_contract.fun
-0000dec0: 6374 696f 6e73 2e74 6573 744f 6666 6368  ctions.testOffch
-0000ded0: 6169 6e4c 6f6f 6b75 7028 2020 2320 6e6f  ainLookup(  # no
-0000dee0: 7161 3a20 4535 3031 2074 7970 653a 2069  qa: E501 type: i
-0000def0: 676e 6f72 650a 2020 2020 2020 2020 2020  gnore.          
-0000df00: 2020 2020 2020 4f46 4643 4841 494e 5f4c        OFFCHAIN_L
-0000df10: 4f4f 4b55 505f 5445 5354 5f44 4154 410a  OOKUP_TEST_DATA.
-0000df20: 2020 2020 2020 2020 2020 2020 292e 6361              ).ca
-0000df30: 6c6c 2829 0a20 2020 2020 2020 2061 7373  ll().        ass
-0000df40: 6572 7420 6578 635f 696e 666f 2e76 616c  ert exc_info.val
-0000df50: 7565 2e64 6174 6120 3d3d 2072 6574 7572  ue.data == retur
-0000df60: 6e5f 6461 7461 0a0a 2020 2020 2020 2020  n_data..        
-0000df70: 6173 796e 635f 7733 2e70 726f 7669 6465  async_w3.provide
-0000df80: 722e 676c 6f62 616c 5f63 6369 705f 7265  r.global_ccip_re
-0000df90: 6164 5f65 6e61 626c 6564 203d 2054 7275  ad_enabled = Tru
-0000dfa0: 6520 2023 2063 6c65 616e 7570 0a0a 2020  e  # cleanup..  
-0000dfb0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-0000dfc0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-0000dfd0: 2064 6566 2074 6573 745f 6574 685f 6361   def test_eth_ca
-0000dfe0: 6c6c 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  ll_offchain_look
-0000dff0: 7570 5f63 616c 6c5f 666c 6167 5f6f 7665  up_call_flag_ove
-0000e000: 7272 6964 6573 5f70 726f 7669 6465 725f  rrides_provider_
-0000e010: 666c 6167 280a 2020 2020 2020 2020 7365  flag(.        se
-0000e020: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
-0000e030: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+0000d2a0: 2822 3431 222c 205b 5d29 2c0a 2020 2020  ("41", []),.    
+0000d2b0: 2020 2020 2020 2020 2822 3531 222c 205b          ("51", [
+0000d2c0: 5d29 2c0a 2020 2020 2020 2020 292c 0a20  ]),.        ),. 
+0000d2d0: 2020 2029 0a20 2020 2040 7079 7465 7374     ).    @pytest
+0000d2e0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+0000d2f0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+0000d300: 5f63 6f6e 7472 6163 745f 7061 6e69 635f  _contract_panic_
+0000d310: 6572 726f 7273 280a 2020 2020 2020 2020  errors(.        
+0000d320: 7365 6c66 2c0a 2020 2020 2020 2020 6173  self,.        as
+0000d330: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+0000d340: 6233 222c 0a20 2020 2020 2020 2061 7379  b3",.        asy
+0000d350: 6e63 5f70 616e 6963 5f65 7272 6f72 735f  nc_panic_errors_
+0000d360: 636f 6e74 7261 6374 3a20 2241 7379 6e63  contract: "Async
+0000d370: 436f 6e74 7261 6374 222c 0a20 2020 2020  Contract",.     
+0000d380: 2020 2070 616e 6963 5f65 7272 6f72 3a20     panic_error: 
+0000d390: 7374 722c 0a20 2020 2020 2020 2070 6172  str,.        par
+0000d3a0: 616d 733a 204c 6973 745b 416e 795d 2c0a  ams: List[Any],.
+0000d3b0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0000d3c0: 2020 2020 2020 206d 6574 686f 6420 3d20         method = 
+0000d3d0: 6765 7461 7474 7228 0a20 2020 2020 2020  getattr(.       
+0000d3e0: 2020 2020 2061 7379 6e63 5f70 616e 6963       async_panic
+0000d3f0: 5f65 7272 6f72 735f 636f 6e74 7261 6374  _errors_contract
+0000d400: 2e66 756e 6374 696f 6e73 2c0a 2020 2020  .functions,.    
+0000d410: 2020 2020 2020 2020 6622 6572 726f 7243          f"errorC
+0000d420: 6f64 657b 7061 6e69 635f 6572 726f 727d  ode{panic_error}
+0000d430: 222c 0a20 2020 2020 2020 2029 0a20 2020  ",.        ).   
+0000d440: 2020 2020 2065 7272 6f72 5f6d 7367 203d       error_msg =
+0000d450: 2050 414e 4943 5f45 5252 4f52 5f43 4f44   PANIC_ERROR_COD
+0000d460: 4553 5b70 616e 6963 5f65 7272 6f72 5d0a  ES[panic_error].
+0000d470: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+0000d480: 7465 7374 2e72 6169 7365 7328 436f 6e74  test.raises(Cont
+0000d490: 7261 6374 5061 6e69 6345 7272 6f72 2c20  ractPanicError, 
+0000d4a0: 6d61 7463 683d 7265 2e65 7363 6170 6528  match=re.escape(
+0000d4b0: 6572 726f 725f 6d73 6729 293a 0a20 2020  error_msg)):.   
+0000d4c0: 2020 2020 2020 2020 2061 7761 6974 206d           await m
+0000d4d0: 6574 686f 6428 2a70 6172 616d 7329 2e63  ethod(*params).c
+0000d4e0: 616c 6c28 290a 0a20 2020 2040 7079 7465  all()..    @pyte
+0000d4f0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+0000d500: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+0000d510: 7374 5f65 7468 5f63 616c 6c5f 6f66 6663  st_eth_call_offc
+0000d520: 6861 696e 5f6c 6f6f 6b75 7028 0a20 2020  hain_lookup(.   
+0000d530: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0000d540: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
+0000d550: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
+0000d560: 2020 6173 796e 635f 6f66 6663 6861 696e    async_offchain
+0000d570: 5f6c 6f6f 6b75 705f 636f 6e74 7261 6374  _lookup_contract
+0000d580: 3a20 2241 7379 6e63 436f 6e74 7261 6374  : "AsyncContract
+0000d590: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
+0000d5a0: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+0000d5b0: 743a 2043 6865 636b 7375 6d41 6464 7265  t: ChecksumAddre
+0000d5c0: 7373 2c0a 2020 2020 2020 2020 6d6f 6e6b  ss,.        monk
+0000d5d0: 6579 7061 7463 683a 2022 4d6f 6e6b 6579  eypatch: "Monkey
+0000d5e0: 5061 7463 6822 2c0a 2020 2020 2920 2d3e  Patch",.    ) ->
+0000d5f0: 204e 6f6e 653a 0a20 2020 2020 2020 206e   None:.        n
+0000d600: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
+0000d610: 6374 5f61 6464 7265 7373 203d 2074 6f5f  ct_address = to_
+0000d620: 6865 785f 6966 5f62 7974 6573 280a 2020  hex_if_bytes(.  
+0000d630: 2020 2020 2020 2020 2020 6173 796e 635f            async_
+0000d640: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+0000d650: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
+0000d660: 0a20 2020 2020 2020 2029 2e6c 6f77 6572  .        ).lower
+0000d670: 2829 0a0a 2020 2020 2020 2020 6173 796e  ()..        asyn
+0000d680: 635f 6d6f 636b 5f6f 6666 6368 6169 6e5f  c_mock_offchain_
+0000d690: 6c6f 6f6b 7570 5f72 6571 7565 7374 5f72  lookup_request_r
+0000d6a0: 6573 706f 6e73 6528 0a20 2020 2020 2020  esponse(.       
+0000d6b0: 2020 2020 206d 6f6e 6b65 7970 6174 6368       monkeypatch
+0000d6c0: 2c0a 2020 2020 2020 2020 2020 2020 6d6f  ,.            mo
+0000d6d0: 636b 6564 5f72 6571 7565 7374 5f75 726c  cked_request_url
+0000d6e0: 3d66 2268 7474 7073 3a2f 2f77 6562 332e  =f"https://web3.
+0000d6f0: 7079 2f67 6174 6577 6179 2f7b 6e6f 726d  py/gateway/{norm
+0000d700: 616c 697a 6564 5f63 6f6e 7472 6163 745f  alized_contract_
+0000d710: 6164 6472 6573 737d 2f7b 4f46 4643 4841  address}/{OFFCHA
+0000d720: 494e 5f4c 4f4f 4b55 505f 5445 5354 5f44  IN_LOOKUP_TEST_D
+0000d730: 4154 417d 2e6a 736f 6e22 2c20 2023 206e  ATA}.json",  # n
+0000d740: 6f71 613a 2045 3530 310a 2020 2020 2020  oqa: E501.      
+0000d750: 2020 2020 2020 6d6f 636b 6564 5f6a 736f        mocked_jso
+0000d760: 6e5f 6461 7461 3d57 4542 3350 595f 4153  n_data=WEB3PY_AS
+0000d770: 5f48 4558 4259 5445 532c 0a20 2020 2020  _HEXBYTES,.     
+0000d780: 2020 2029 0a20 2020 2020 2020 2072 6573     ).        res
+0000d790: 706f 6e73 655f 6361 6c6c 6572 203d 2061  ponse_caller = a
+0000d7a0: 7761 6974 2061 7379 6e63 5f6f 6666 6368  wait async_offch
+0000d7b0: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
+0000d7c0: 6163 742e 6361 6c6c 6572 2829 2e74 6573  act.caller().tes
+0000d7d0: 744f 6666 6368 6169 6e4c 6f6f 6b75 7028  tOffchainLookup(
+0000d7e0: 2020 2320 6e6f 7161 3a20 4535 3031 2074    # noqa: E501 t
+0000d7f0: 7970 653a 2069 676e 6f72 650a 2020 2020  ype: ignore.    
+0000d800: 2020 2020 2020 2020 4f46 4643 4841 494e          OFFCHAIN
+0000d810: 5f4c 4f4f 4b55 505f 5445 5354 5f44 4154  _LOOKUP_TEST_DAT
+0000d820: 410a 2020 2020 2020 2020 290a 2020 2020  A.        ).    
+0000d830: 2020 2020 7265 7370 6f6e 7365 5f66 756e      response_fun
+0000d840: 6374 696f 6e5f 6361 6c6c 203d 2061 7761  ction_call = awa
+0000d850: 6974 2061 7379 6e63 5f6f 6666 6368 6169  it async_offchai
+0000d860: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
+0000d870: 742e 6675 6e63 7469 6f6e 732e 7465 7374  t.functions.test
+0000d880: 4f66 6663 6861 696e 4c6f 6f6b 7570 2820  OffchainLookup( 
+0000d890: 2023 206e 6f71 613a 2045 3530 3120 7479   # noqa: E501 ty
+0000d8a0: 7065 3a20 6967 6e6f 7265 0a20 2020 2020  pe: ignore.     
+0000d8b0: 2020 2020 2020 204f 4646 4348 4149 4e5f         OFFCHAIN_
+0000d8c0: 4c4f 4f4b 5550 5f54 4553 545f 4441 5441  LOOKUP_TEST_DATA
+0000d8d0: 0a20 2020 2020 2020 2029 2e63 616c 6c28  .        ).call(
+0000d8e0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0000d8f0: 2061 7379 6e63 5f77 332e 636f 6465 632e   async_w3.codec.
+0000d900: 6465 636f 6465 285b 2273 7472 696e 6722  decode(["string"
+0000d910: 5d2c 2072 6573 706f 6e73 655f 6361 6c6c  ], response_call
+0000d920: 6572 295b 305d 203d 3d20 2277 6562 3370  er)[0] == "web3p
+0000d930: 7922 0a20 2020 2020 2020 2061 7373 6572  y".        asser
+0000d940: 7420 6173 796e 635f 7733 2e63 6f64 6563  t async_w3.codec
+0000d950: 2e64 6563 6f64 6528 5b22 7374 7269 6e67  .decode(["string
+0000d960: 225d 2c20 7265 7370 6f6e 7365 5f66 756e  "], response_fun
+0000d970: 6374 696f 6e5f 6361 6c6c 295b 305d 203d  ction_call)[0] =
+0000d980: 3d20 2277 6562 3370 7922 0a0a 2020 2020  = "web3py"..    
+0000d990: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+0000d9a0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+0000d9b0: 6566 2074 6573 745f 6574 685f 6361 6c6c  ef test_eth_call
+0000d9c0: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
+0000d9d0: 5f72 6169 7365 735f 7768 656e 5f63 6369  _raises_when_cci
+0000d9e0: 705f 7265 6164 5f69 735f 6469 7361 626c  p_read_is_disabl
+0000d9f0: 6564 280a 2020 2020 2020 2020 7365 6c66  ed(.        self
+0000da00: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+0000da10: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+0000da20: 0a20 2020 2020 2020 2061 7379 6e63 5f6f  .        async_o
+0000da30: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
+0000da40: 6f6e 7472 6163 743a 2022 4173 796e 6343  ontract: "AsyncC
+0000da50: 6f6e 7472 6163 7422 2c0a 2020 2020 2920  ontract",.    ) 
+0000da60: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000da70: 2072 6574 7572 6e5f 6461 7461 203d 2028   return_data = (
+0000da80: 0a20 2020 2020 2020 2020 2020 204f 4646  .            OFF
+0000da90: 4348 4149 4e5f 4c4f 4f4b 5550 5f34 4259  CHAIN_LOOKUP_4BY
+0000daa0: 5445 5f44 4154 410a 2020 2020 2020 2020  TE_DATA.        
+0000dab0: 2020 2020 2b20 6162 695f 656e 636f 6465      + abi_encode
+0000dac0: 645f 6f66 6663 6861 696e 5f6c 6f6f 6b75  d_offchain_looku
+0000dad0: 705f 636f 6e74 7261 6374 5f61 6464 7265  p_contract_addre
+0000dae0: 7373 280a 2020 2020 2020 2020 2020 2020  ss(.            
+0000daf0: 2020 2020 6173 796e 635f 7733 2c20 6173      async_w3, as
+0000db00: 796e 635f 6f66 6663 6861 696e 5f6c 6f6f  ync_offchain_loo
+0000db10: 6b75 705f 636f 6e74 7261 6374 0a20 2020  kup_contract.   
+0000db20: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000db30: 2020 2020 2020 202b 204f 4646 4348 4149         + OFFCHAI
+0000db40: 4e5f 4c4f 4f4b 5550 5f52 4554 5552 4e5f  N_LOOKUP_RETURN_
+0000db50: 4441 5441 0a20 2020 2020 2020 2029 0a20  DATA.        ). 
+0000db60: 2020 2020 2020 2023 2074 6573 7420 4173         # test As
+0000db70: 796e 6343 6f6e 7472 6163 7443 616c 6c65  yncContractCalle
+0000db80: 720a 2020 2020 2020 2020 7769 7468 2070  r.        with p
+0000db90: 7974 6573 742e 7261 6973 6573 284f 6666  ytest.raises(Off
+0000dba0: 6368 6169 6e4c 6f6f 6b75 7029 2061 7320  chainLookup) as 
+0000dbb0: 653a 0a20 2020 2020 2020 2020 2020 2061  e:.            a
+0000dbc0: 7761 6974 2061 7379 6e63 5f6f 6666 6368  wait async_offch
+0000dbd0: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
+0000dbe0: 6163 742e 6361 6c6c 6572 280a 2020 2020  act.caller(.    
+0000dbf0: 2020 2020 2020 2020 2020 2020 6363 6970              ccip
+0000dc00: 5f72 6561 645f 656e 6162 6c65 643d 4661  _read_enabled=Fa
+0000dc10: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+0000dc20: 292e 7465 7374 4f66 6663 6861 696e 4c6f  ).testOffchainLo
+0000dc30: 6f6b 7570 284f 4646 4348 4149 4e5f 4c4f  okup(OFFCHAIN_LO
+0000dc40: 4f4b 5550 5f54 4553 545f 4441 5441 290a  OKUP_TEST_DATA).
+0000dc50: 2020 2020 2020 2020 6173 7365 7274 2065          assert e
+0000dc60: 2e76 616c 7565 2e64 6174 6120 3d3d 2072  .value.data == r
+0000dc70: 6574 7572 6e5f 6461 7461 0a0a 2020 2020  eturn_data..    
+0000dc80: 2020 2020 2320 7465 7374 2041 7379 6e63      # test Async
+0000dc90: 436f 6e74 7261 6374 4675 6e63 7469 6f6e  ContractFunction
+0000dca0: 2063 616c 6c0a 2020 2020 2020 2020 7769   call.        wi
+0000dcb0: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+0000dcc0: 284f 6666 6368 6169 6e4c 6f6f 6b75 7029  (OffchainLookup)
+0000dcd0: 2061 7320 6578 6369 6e66 6f3a 0a20 2020   as excinfo:.   
+0000dce0: 2020 2020 2020 2020 2061 7761 6974 2061           await a
+0000dcf0: 7379 6e63 5f6f 6666 6368 6169 6e5f 6c6f  sync_offchain_lo
+0000dd00: 6f6b 7570 5f63 6f6e 7472 6163 742e 6675  okup_contract.fu
+0000dd10: 6e63 7469 6f6e 732e 7465 7374 4f66 6663  nctions.testOffc
+0000dd20: 6861 696e 4c6f 6f6b 7570 280a 2020 2020  hainLookup(.    
+0000dd30: 2020 2020 2020 2020 2020 2020 4f46 4643              OFFC
+0000dd40: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
+0000dd50: 5f44 4154 410a 2020 2020 2020 2020 2020  _DATA.          
+0000dd60: 2020 292e 6361 6c6c 2863 6369 705f 7265    ).call(ccip_re
+0000dd70: 6164 5f65 6e61 626c 6564 3d46 616c 7365  ad_enabled=False
+0000dd80: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0000dd90: 2065 7863 696e 666f 2e76 616c 7565 2e64   excinfo.value.d
+0000dda0: 6174 6120 3d3d 2072 6574 7572 6e5f 6461  ata == return_da
+0000ddb0: 7461 0a0a 2020 2020 2020 2020 2320 7465  ta..        # te
+0000ddc0: 7374 2067 6c6f 6261 6c20 666c 6167 206f  st global flag o
+0000ddd0: 6e20 7468 6520 7072 6f76 6964 6572 0a20  n the provider. 
+0000dde0: 2020 2020 2020 2061 7379 6e63 5f77 332e         async_w3.
+0000ddf0: 7072 6f76 6964 6572 2e67 6c6f 6261 6c5f  provider.global_
+0000de00: 6363 6970 5f72 6561 645f 656e 6162 6c65  ccip_read_enable
+0000de10: 6420 3d20 4661 6c73 650a 0a20 2020 2020  d = False..     
+0000de20: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+0000de30: 6169 7365 7328 4f66 6663 6861 696e 4c6f  aises(OffchainLo
+0000de40: 6f6b 7570 2920 6173 2065 7863 5f69 6e66  okup) as exc_inf
+0000de50: 6f3a 0a20 2020 2020 2020 2020 2020 2061  o:.            a
+0000de60: 7761 6974 2061 7379 6e63 5f6f 6666 6368  wait async_offch
+0000de70: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
+0000de80: 6163 742e 6675 6e63 7469 6f6e 732e 7465  act.functions.te
+0000de90: 7374 4f66 6663 6861 696e 4c6f 6f6b 7570  stOffchainLookup
+0000dea0: 2820 2023 206e 6f71 613a 2045 3530 3120  (  # noqa: E501 
+0000deb0: 7479 7065 3a20 6967 6e6f 7265 0a20 2020  type: ignore.   
+0000dec0: 2020 2020 2020 2020 2020 2020 204f 4646               OFF
+0000ded0: 4348 4149 4e5f 4c4f 4f4b 5550 5f54 4553  CHAIN_LOOKUP_TES
+0000dee0: 545f 4441 5441 0a20 2020 2020 2020 2020  T_DATA.         
+0000def0: 2020 2029 2e63 616c 6c28 290a 2020 2020     ).call().    
+0000df00: 2020 2020 6173 7365 7274 2065 7863 5f69      assert exc_i
+0000df10: 6e66 6f2e 7661 6c75 652e 6461 7461 203d  nfo.value.data =
+0000df20: 3d20 7265 7475 726e 5f64 6174 610a 0a20  = return_data.. 
+0000df30: 2020 2020 2020 2061 7379 6e63 5f77 332e         async_w3.
+0000df40: 7072 6f76 6964 6572 2e67 6c6f 6261 6c5f  provider.global_
+0000df50: 6363 6970 5f72 6561 645f 656e 6162 6c65  ccip_read_enable
+0000df60: 6420 3d20 5472 7565 2020 2320 636c 6561  d = True  # clea
+0000df70: 6e75 700a 0a20 2020 2040 7079 7465 7374  nup..    @pytest
+0000df80: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+0000df90: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+0000dfa0: 5f65 7468 5f63 616c 6c5f 6f66 6663 6861  _eth_call_offcha
+0000dfb0: 696e 5f6c 6f6f 6b75 705f 6361 6c6c 5f66  in_lookup_call_f
+0000dfc0: 6c61 675f 6f76 6572 7269 6465 735f 7072  lag_overrides_pr
+0000dfd0: 6f76 6964 6572 5f66 6c61 6728 0a20 2020  ovider_flag(.   
+0000dfe0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0000dff0: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
+0000e000: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
+0000e010: 2020 6173 796e 635f 6f66 6663 6861 696e    async_offchain
+0000e020: 5f6c 6f6f 6b75 705f 636f 6e74 7261 6374  _lookup_contract
+0000e030: 3a20 2241 7379 6e63 436f 6e74 7261 6374  : "AsyncContract
 0000e040: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
-0000e050: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
-0000e060: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
-0000e070: 7261 6374 222c 0a20 2020 2020 2020 2061  ract",.        a
-0000e080: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
-0000e090: 636f 756e 743a 2043 6865 636b 7375 6d41  count: ChecksumA
-0000e0a0: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
-0000e0b0: 6d6f 6e6b 6579 7061 7463 683a 2022 4d6f  monkeypatch: "Mo
-0000e0c0: 6e6b 6579 5061 7463 6822 2c0a 2020 2020  nkeyPatch",.    
-0000e0d0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0000e0e0: 2020 206e 6f72 6d61 6c69 7a65 645f 636f     normalized_co
-0000e0f0: 6e74 7261 6374 5f61 6464 7265 7373 203d  ntract_address =
-0000e100: 2074 6f5f 6865 785f 6966 5f62 7974 6573   to_hex_if_bytes
-0000e110: 280a 2020 2020 2020 2020 2020 2020 6173  (.            as
-0000e120: 796e 635f 6f66 6663 6861 696e 5f6c 6f6f  ync_offchain_loo
-0000e130: 6b75 705f 636f 6e74 7261 6374 2e61 6464  kup_contract.add
-0000e140: 7265 7373 0a20 2020 2020 2020 2029 2e6c  ress.        ).l
-0000e150: 6f77 6572 2829 0a0a 2020 2020 2020 2020  ower()..        
-0000e160: 6173 796e 635f 6d6f 636b 5f6f 6666 6368  async_mock_offch
-0000e170: 6169 6e5f 6c6f 6f6b 7570 5f72 6571 7565  ain_lookup_reque
-0000e180: 7374 5f72 6573 706f 6e73 6528 0a20 2020  st_response(.   
-0000e190: 2020 2020 2020 2020 206d 6f6e 6b65 7970           monkeyp
-0000e1a0: 6174 6368 2c0a 2020 2020 2020 2020 2020  atch,.          
-0000e1b0: 2020 6d6f 636b 6564 5f72 6571 7565 7374    mocked_request
-0000e1c0: 5f75 726c 3d66 2268 7474 7073 3a2f 2f77  _url=f"https://w
-0000e1d0: 6562 332e 7079 2f67 6174 6577 6179 2f7b  eb3.py/gateway/{
-0000e1e0: 6e6f 726d 616c 697a 6564 5f63 6f6e 7472  normalized_contr
-0000e1f0: 6163 745f 6164 6472 6573 737d 2f7b 4f46  act_address}/{OF
-0000e200: 4643 4841 494e 5f4c 4f4f 4b55 505f 5445  FCHAIN_LOOKUP_TE
-0000e210: 5354 5f44 4154 417d 2e6a 736f 6e22 2c20  ST_DATA}.json", 
-0000e220: 2023 206e 6f71 613a 2045 3530 310a 2020   # noqa: E501.  
-0000e230: 2020 2020 2020 2020 2020 6d6f 636b 6564            mocked
-0000e240: 5f6a 736f 6e5f 6461 7461 3d57 4542 3350  _json_data=WEB3P
-0000e250: 595f 4153 5f48 4558 4259 5445 532c 0a20  Y_AS_HEXBYTES,. 
-0000e260: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0000e270: 2020 6173 796e 635f 7733 2e70 726f 7669    async_w3.provi
-0000e280: 6465 722e 676c 6f62 616c 5f63 6369 705f  der.global_ccip_
-0000e290: 7265 6164 5f65 6e61 626c 6564 203d 2046  read_enabled = F
-0000e2a0: 616c 7365 0a0a 2020 2020 2020 2020 7265  alse..        re
-0000e2b0: 7370 6f6e 7365 203d 2061 7761 6974 2061  sponse = await a
-0000e2c0: 7379 6e63 5f6f 6666 6368 6169 6e5f 6c6f  sync_offchain_lo
-0000e2d0: 6f6b 7570 5f63 6f6e 7472 6163 742e 6675  okup_contract.fu
-0000e2e0: 6e63 7469 6f6e 732e 7465 7374 4f66 6663  nctions.testOffc
-0000e2f0: 6861 696e 4c6f 6f6b 7570 280a 2020 2020  hainLookup(.    
-0000e300: 2020 2020 2020 2020 4f46 4643 4841 494e          OFFCHAIN
-0000e310: 5f4c 4f4f 4b55 505f 5445 5354 5f44 4154  _LOOKUP_TEST_DAT
-0000e320: 410a 2020 2020 2020 2020 292e 6361 6c6c  A.        ).call
-0000e330: 2863 6369 705f 7265 6164 5f65 6e61 626c  (ccip_read_enabl
-0000e340: 6564 3d54 7275 6529 0a20 2020 2020 2020  ed=True).       
-0000e350: 2061 7373 6572 7420 6173 796e 635f 7733   assert async_w3
-0000e360: 2e63 6f64 6563 2e64 6563 6f64 6528 5b22  .codec.decode(["
-0000e370: 7374 7269 6e67 225d 2c20 7265 7370 6f6e  string"], respon
-0000e380: 7365 295b 305d 203d 3d20 2277 6562 3370  se)[0] == "web3p
-0000e390: 7922 0a0a 2020 2020 2020 2020 6173 796e  y"..        asyn
-0000e3a0: 635f 7733 2e70 726f 7669 6465 722e 676c  c_w3.provider.gl
-0000e3b0: 6f62 616c 5f63 6369 705f 7265 6164 5f65  obal_ccip_read_e
-0000e3c0: 6e61 626c 6564 203d 2054 7275 6520 2023  nabled = True  #
-0000e3d0: 2063 6c65 616e 7570 0a0a 2020 2020 4070   cleanup..    @p
-0000e3e0: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-0000e3f0: 696f 0a20 2020 2040 7079 7465 7374 2e6d  io.    @pytest.m
-0000e400: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
-0000e410: 226d 6178 5f72 6564 6972 6563 7473 222c  "max_redirects",
-0000e420: 2072 616e 6765 282d 312c 2034 2929 0a20   range(-1, 4)). 
-0000e430: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-0000e440: 745f 6574 685f 6361 6c6c 5f6f 6666 6368  t_eth_call_offch
-0000e450: 6169 6e5f 6c6f 6f6b 7570 5f72 6169 7365  ain_lookup_raise
-0000e460: 735f 6966 5f6d 6178 5f72 6564 6972 6563  s_if_max_redirec
-0000e470: 7473 5f69 735f 6c65 7373 5f74 6861 6e5f  ts_is_less_than_
-0000e480: 3428 0a20 2020 2020 2020 2073 656c 662c  4(.        self,
-0000e490: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-0000e4a0: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
-0000e4b0: 2020 2020 2020 2020 6173 796e 635f 6f66          async_of
-0000e4c0: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
-0000e4d0: 6e74 7261 6374 3a20 2243 6f6e 7472 6163  ntract: "Contrac
-0000e4e0: 7422 2c0a 2020 2020 2020 2020 6d61 785f  t",.        max_
-0000e4f0: 7265 6469 7265 6374 733a 2069 6e74 2c0a  redirects: int,.
-0000e500: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-0000e510: 2020 2020 2020 2064 6566 6175 6c74 5f6d         default_m
-0000e520: 6178 5f72 6564 6972 6563 7473 203d 2061  ax_redirects = a
-0000e530: 7379 6e63 5f77 332e 7072 6f76 6964 6572  sync_w3.provider
-0000e540: 2e63 6369 705f 7265 6164 5f6d 6178 5f72  .ccip_read_max_r
-0000e550: 6564 6972 6563 7473 0a0a 2020 2020 2020  edirects..      
-0000e560: 2020 6173 796e 635f 7733 2e70 726f 7669    async_w3.provi
-0000e570: 6465 722e 6363 6970 5f72 6561 645f 6d61  der.ccip_read_ma
-0000e580: 785f 7265 6469 7265 6374 7320 3d20 6d61  x_redirects = ma
-0000e590: 785f 7265 6469 7265 6374 730a 2020 2020  x_redirects.    
-0000e5a0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-0000e5b0: 7261 6973 6573 2856 616c 7565 4572 726f  raises(ValueErro
-0000e5c0: 722c 206d 6174 6368 3d22 6174 206c 6561  r, match="at lea
-0000e5d0: 7374 2034 2229 3a0a 2020 2020 2020 2020  st 4"):.        
-0000e5e0: 2020 2020 6177 6169 7420 6173 796e 635f      await async_
-0000e5f0: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-0000e600: 636f 6e74 7261 6374 2e63 616c 6c65 7228  contract.caller(
-0000e610: 292e 7465 7374 4f66 6663 6861 696e 4c6f  ).testOffchainLo
-0000e620: 6f6b 7570 280a 2020 2020 2020 2020 2020  okup(.          
-0000e630: 2020 2020 2020 4f46 4643 4841 494e 5f4c        OFFCHAIN_L
-0000e640: 4f4f 4b55 505f 5445 5354 5f44 4154 410a  OOKUP_TEST_DATA.
-0000e650: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0000e660: 2020 2020 2020 2061 7379 6e63 5f77 332e         async_w3.
-0000e670: 7072 6f76 6964 6572 2e63 6369 705f 7265  provider.ccip_re
-0000e680: 6164 5f6d 6178 5f72 6564 6972 6563 7473  ad_max_redirects
-0000e690: 203d 2064 6566 6175 6c74 5f6d 6178 5f72   = default_max_r
-0000e6a0: 6564 6972 6563 7473 2020 2320 636c 6561  edirects  # clea
-0000e6b0: 6e75 700a 0a20 2020 2040 7079 7465 7374  nup..    @pytest
-0000e6c0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-0000e6d0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-0000e6e0: 5f65 7468 5f63 616c 6c5f 6f66 6663 6861  _eth_call_offcha
-0000e6f0: 696e 5f6c 6f6f 6b75 705f 7261 6973 6573  in_lookup_raises
-0000e700: 5f66 6f72 5f69 6d70 726f 7065 726c 795f  _for_improperly_
-0000e710: 666f 726d 6174 7465 645f 7265 7374 5f72  formatted_rest_r
-0000e720: 6571 7565 7374 5f72 6573 706f 6e73 6528  equest_response(
-0000e730: 2020 2320 6e6f 7161 3a20 4535 3031 0a20    # noqa: E501. 
-0000e740: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0000e750: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
-0000e760: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
-0000e770: 2020 2020 6173 796e 635f 6f66 6663 6861      async_offcha
-0000e780: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
-0000e790: 6374 3a20 2243 6f6e 7472 6163 7422 2c0a  ct: "Contract",.
-0000e7a0: 2020 2020 2020 2020 6173 796e 635f 756e          async_un
-0000e7b0: 6c6f 636b 6564 5f61 6363 6f75 6e74 3a20  locked_account: 
-0000e7c0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-0000e7d0: 0a20 2020 2020 2020 206d 6f6e 6b65 7970  .        monkeyp
-0000e7e0: 6174 6368 3a20 224d 6f6e 6b65 7950 6174  atch: "MonkeyPat
-0000e7f0: 6368 222c 0a20 2020 2029 202d 3e20 4e6f  ch",.    ) -> No
-0000e800: 6e65 3a0a 2020 2020 2020 2020 6e6f 726d  ne:.        norm
-0000e810: 616c 697a 6564 5f63 6f6e 7472 6163 745f  alized_contract_
-0000e820: 6164 6472 6573 7320 3d20 746f 5f68 6578  address = to_hex
-0000e830: 5f69 665f 6279 7465 7328 0a20 2020 2020  _if_bytes(.     
-0000e840: 2020 2020 2020 2061 7379 6e63 5f6f 6666         async_off
-0000e850: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
-0000e860: 7472 6163 742e 6164 6472 6573 730a 2020  tract.address.  
-0000e870: 2020 2020 2020 292e 6c6f 7765 7228 290a        ).lower().
-0000e880: 0a20 2020 2020 2020 2061 7379 6e63 5f6d  .        async_m
-0000e890: 6f63 6b5f 6f66 6663 6861 696e 5f6c 6f6f  ock_offchain_loo
-0000e8a0: 6b75 705f 7265 7175 6573 745f 7265 7370  kup_request_resp
-0000e8b0: 6f6e 7365 280a 2020 2020 2020 2020 2020  onse(.          
-0000e8c0: 2020 6d6f 6e6b 6579 7061 7463 682c 0a20    monkeypatch,. 
-0000e8d0: 2020 2020 2020 2020 2020 206d 6f63 6b65             mocke
-0000e8e0: 645f 7265 7175 6573 745f 7572 6c3d 6622  d_request_url=f"
-0000e8f0: 6874 7470 733a 2f2f 7765 6233 2e70 792f  https://web3.py/
-0000e900: 6761 7465 7761 792f 7b6e 6f72 6d61 6c69  gateway/{normali
-0000e910: 7a65 645f 636f 6e74 7261 6374 5f61 6464  zed_contract_add
-0000e920: 7265 7373 7d2f 7b4f 4646 4348 4149 4e5f  ress}/{OFFCHAIN_
-0000e930: 4c4f 4f4b 5550 5f54 4553 545f 4441 5441  LOOKUP_TEST_DATA
-0000e940: 7d2e 6a73 6f6e 222c 2020 2320 6e6f 7161  }.json",  # noqa
-0000e950: 3a20 4535 3031 0a20 2020 2020 2020 2020  : E501.         
-0000e960: 2020 206d 6f63 6b65 645f 6a73 6f6e 5f64     mocked_json_d
-0000e970: 6174 613d 5745 4233 5059 5f41 535f 4845  ata=WEB3PY_AS_HE
-0000e980: 5842 5954 4553 2c0a 2020 2020 2020 2020  XBYTES,.        
-0000e990: 2020 2020 6a73 6f6e 5f64 6174 615f 6669      json_data_fi
-0000e9a0: 656c 643d 226e 6f74 5f64 6174 6122 2c0a  eld="not_data",.
-0000e9b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000e9c0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-0000e9d0: 6973 6573 2857 6562 3356 616c 6964 6174  ises(Web3Validat
-0000e9e0: 696f 6e45 7272 6f72 2c20 6d61 7463 683d  ionError, match=
-0000e9f0: 226d 6973 7369 6e67 2027 6461 7461 2720  "missing 'data' 
-0000ea00: 6669 656c 6422 293a 0a20 2020 2020 2020  field"):.       
-0000ea10: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
-0000ea20: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
-0000ea30: 5f63 6f6e 7472 6163 742e 6361 6c6c 6572  _contract.caller
-0000ea40: 2829 2e74 6573 744f 6666 6368 6169 6e4c  ().testOffchainL
-0000ea50: 6f6f 6b75 7028 0a20 2020 2020 2020 2020  ookup(.         
-0000ea60: 2020 2020 2020 204f 4646 4348 4149 4e5f         OFFCHAIN_
-0000ea70: 4c4f 4f4b 5550 5f54 4553 545f 4441 5441  LOOKUP_TEST_DATA
-0000ea80: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0000ea90: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-0000eaa0: 2e61 7379 6e63 696f 0a20 2020 2040 7079  .asyncio.    @py
-0000eab0: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-0000eac0: 7472 697a 6528 2273 7461 7475 735f 636f  trize("status_co
-0000ead0: 6465 5f6e 6f6e 5f34 7878 5f65 7272 6f72  de_non_4xx_error
-0000eae0: 222c 205b 3130 302c 2033 3030 2c20 3530  ", [100, 300, 50
-0000eaf0: 302c 2036 3030 5d29 0a20 2020 2061 7379  0, 600]).    asy
-0000eb00: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
-0000eb10: 6361 6c6c 5f6f 6666 6368 6169 6e5f 6c6f  call_offchain_lo
-0000eb20: 6f6b 7570 5f74 7269 6573 5f6e 6578 745f  okup_tries_next_
-0000eb30: 7572 6c5f 666f 725f 6e6f 6e5f 3478 785f  url_for_non_4xx_
-0000eb40: 6572 726f 725f 7374 6174 7573 5f61 6e64  error_status_and
-0000eb50: 5f74 6573 7473 5f50 4f53 5428 2020 2320  _tests_POST(  # 
-0000eb60: 6e6f 7161 3a20 4535 3031 0a20 2020 2020  noqa: E501.     
-0000eb70: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000eb80: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-0000eb90: 6357 6562 3322 2c0a 2020 2020 2020 2020  cWeb3",.        
-0000eba0: 6173 796e 635f 6f66 6663 6861 696e 5f6c  async_offchain_l
-0000ebb0: 6f6f 6b75 705f 636f 6e74 7261 6374 3a20  ookup_contract: 
-0000ebc0: 2243 6f6e 7472 6163 7422 2c0a 2020 2020  "Contract",.    
-0000ebd0: 2020 2020 6173 796e 635f 756e 6c6f 636b      async_unlock
-0000ebe0: 6564 5f61 6363 6f75 6e74 3a20 4368 6563  ed_account: Chec
-0000ebf0: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
-0000ec00: 2020 2020 206d 6f6e 6b65 7970 6174 6368       monkeypatch
-0000ec10: 3a20 224d 6f6e 6b65 7950 6174 6368 222c  : "MonkeyPatch",
-0000ec20: 0a20 2020 2020 2020 2073 7461 7475 735f  .        status_
-0000ec30: 636f 6465 5f6e 6f6e 5f34 7878 5f65 7272  code_non_4xx_err
-0000ec40: 6f72 3a20 696e 742c 0a20 2020 2029 202d  or: int,.    ) -
-0000ec50: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-0000ec60: 6e6f 726d 616c 697a 6564 5f63 6f6e 7472  normalized_contr
-0000ec70: 6163 745f 6164 6472 6573 7320 3d20 746f  act_address = to
-0000ec80: 5f68 6578 5f69 665f 6279 7465 7328 0a20  _hex_if_bytes(. 
-0000ec90: 2020 2020 2020 2020 2020 2061 7379 6e63             async
-0000eca0: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
-0000ecb0: 5f63 6f6e 7472 6163 742e 6164 6472 6573  _contract.addres
-0000ecc0: 730a 2020 2020 2020 2020 292e 6c6f 7765  s.        ).lowe
-0000ecd0: 7228 290a 0a20 2020 2020 2020 2023 2054  r()..        # T
-0000ece0: 6865 206e 6578 7420 7572 6c20 696e 206f  he next url in o
-0000ecf0: 7572 2074 6573 7420 636f 6e74 7261 6374  ur test contract
-0000ed00: 2064 6f65 736e 2774 2063 6f6e 7461 696e   doesn't contain
-0000ed10: 2027 7b64 6174 617d 272c 2074 7269 6767   '{data}', trigg
-0000ed20: 6572 696e 670a 2020 2020 2020 2020 2320  ering.        # 
-0000ed30: 7468 6520 504f 5354 2072 6571 7565 7374  the POST request
-0000ed40: 206c 6f67 6963 2e20 5468 6520 6964 6561   logic. The idea
-0000ed50: 2068 6572 6520 6973 2074 6f20 7265 7475   here is to retu
-0000ed60: 726e 2061 2062 6164 2073 7461 7475 7320  rn a bad status 
-0000ed70: 666f 7220 7468 650a 2020 2020 2020 2020  for the.        
-0000ed80: 2320 6669 7273 7420 7572 6c20 2847 4554  # first url (GET
-0000ed90: 2920 616e 6420 6120 7375 6363 6573 7320  ) and a success 
-0000eda0: 7374 6174 7573 2066 6f72 2074 6865 2073  status for the s
-0000edb0: 6563 6f6e 6420 6361 6c6c 2028 504f 5354  econd call (POST
-0000edc0: 2920 746f 2074 6573 740a 2020 2020 2020  ) to test.      
-0000edd0: 2020 2320 626f 7468 2074 6861 7420 7765    # both that we
-0000ede0: 206d 6f76 6520 6f6e 2074 6f20 7468 6520   move on to the 
-0000edf0: 6e65 7874 2075 726c 2077 6974 6820 6e6f  next url with no
-0000ee00: 6e2d 3478 7820 7374 6174 7573 2061 6e64  n-4xx status and
-0000ee10: 2074 6861 7420 7468 650a 2020 2020 2020   that the.      
-0000ee20: 2020 2320 504f 5354 206c 6f67 6963 2069    # POST logic i
-0000ee30: 7320 616c 736f 2077 6f72 6b69 6e67 2061  s also working a
-0000ee40: 7320 6578 7065 6374 6564 2e0a 2020 2020  s expected..    
-0000ee50: 2020 2020 6173 796e 635f 6d6f 636b 5f6f      async_mock_o
-0000ee60: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f72  ffchain_lookup_r
-0000ee70: 6571 7565 7374 5f72 6573 706f 6e73 6528  equest_response(
-0000ee80: 0a20 2020 2020 2020 2020 2020 206d 6f6e  .            mon
-0000ee90: 6b65 7970 6174 6368 2c0a 2020 2020 2020  keypatch,.      
-0000eea0: 2020 2020 2020 6d6f 636b 6564 5f72 6571        mocked_req
-0000eeb0: 7565 7374 5f75 726c 3d66 2268 7474 7073  uest_url=f"https
-0000eec0: 3a2f 2f77 6562 332e 7079 2f67 6174 6577  ://web3.py/gatew
-0000eed0: 6179 2f7b 6e6f 726d 616c 697a 6564 5f63  ay/{normalized_c
-0000eee0: 6f6e 7472 6163 745f 6164 6472 6573 737d  ontract_address}
-0000eef0: 2f7b 4f46 4643 4841 494e 5f4c 4f4f 4b55  /{OFFCHAIN_LOOKU
-0000ef00: 505f 5445 5354 5f44 4154 417d 2e6a 736f  P_TEST_DATA}.jso
-0000ef10: 6e22 2c20 2023 206e 6f71 613a 2045 3530  n",  # noqa: E50
-0000ef20: 310a 2020 2020 2020 2020 2020 2020 6d6f  1.            mo
-0000ef30: 636b 6564 5f73 7461 7475 735f 636f 6465  cked_status_code
-0000ef40: 3d73 7461 7475 735f 636f 6465 5f6e 6f6e  =status_code_non
-0000ef50: 5f34 7878 5f65 7272 6f72 2c0a 2020 2020  _4xx_error,.    
-0000ef60: 2020 2020 2020 2020 6d6f 636b 6564 5f6a          mocked_j
-0000ef70: 736f 6e5f 6461 7461 3d57 4542 3350 595f  son_data=WEB3PY_
-0000ef80: 4153 5f48 4558 4259 5445 532c 0a20 2020  AS_HEXBYTES,.   
-0000ef90: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
-0000efa0: 7379 6e63 5f6d 6f63 6b5f 6f66 6663 6861  sync_mock_offcha
-0000efb0: 696e 5f6c 6f6f 6b75 705f 7265 7175 6573  in_lookup_reques
-0000efc0: 745f 7265 7370 6f6e 7365 280a 2020 2020  t_response(.    
-0000efd0: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
-0000efe0: 7463 682c 0a20 2020 2020 2020 2020 2020  tch,.           
-0000eff0: 2068 7474 705f 6d65 7468 6f64 3d22 504f   http_method="PO
-0000f000: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
-0000f010: 206d 6f63 6b65 645f 7265 7175 6573 745f   mocked_request_
-0000f020: 7572 6c3d 6622 6874 7470 733a 2f2f 7765  url=f"https://we
-0000f030: 6233 2e70 792f 6761 7465 7761 792f 7b6e  b3.py/gateway/{n
-0000f040: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
-0000f050: 6374 5f61 6464 7265 7373 7d2e 6a73 6f6e  ct_address}.json
-0000f060: 222c 2020 2320 6e6f 7161 3a20 4535 3031  ",  # noqa: E501
-0000f070: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
-0000f080: 6b65 645f 7374 6174 7573 5f63 6f64 653d  ked_status_code=
-0000f090: 3230 302c 0a20 2020 2020 2020 2020 2020  200,.           
-0000f0a0: 206d 6f63 6b65 645f 6a73 6f6e 5f64 6174   mocked_json_dat
-0000f0b0: 613d 5745 4233 5059 5f41 535f 4845 5842  a=WEB3PY_AS_HEXB
-0000f0c0: 5954 4553 2c0a 2020 2020 2020 2020 2020  YTES,.          
-0000f0d0: 2020 7365 6e64 6572 3d6e 6f72 6d61 6c69    sender=normali
-0000f0e0: 7a65 645f 636f 6e74 7261 6374 5f61 6464  zed_contract_add
-0000f0f0: 7265 7373 2c0a 2020 2020 2020 2020 2020  ress,.          
-0000f100: 2020 6361 6c6c 6461 7461 3d4f 4646 4348    calldata=OFFCH
-0000f110: 4149 4e5f 4c4f 4f4b 5550 5f54 4553 545f  AIN_LOOKUP_TEST_
-0000f120: 4441 5441 2c0a 2020 2020 2020 2020 290a  DATA,.        ).
-0000f130: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
-0000f140: 203d 2061 7761 6974 2061 7379 6e63 5f6f   = await async_o
-0000f150: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
-0000f160: 6f6e 7472 6163 742e 6361 6c6c 6572 2829  ontract.caller()
-0000f170: 2e74 6573 744f 6666 6368 6169 6e4c 6f6f  .testOffchainLoo
-0000f180: 6b75 7028 0a20 2020 2020 2020 2020 2020  kup(.           
-0000f190: 204f 4646 4348 4149 4e5f 4c4f 4f4b 5550   OFFCHAIN_LOOKUP
-0000f1a0: 5f54 4553 545f 4441 5441 0a20 2020 2020  _TEST_DATA.     
-0000f1b0: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
-0000f1c0: 6572 7420 6173 796e 635f 7733 2e63 6f64  ert async_w3.cod
-0000f1d0: 6563 2e64 6563 6f64 6528 5b22 7374 7269  ec.decode(["stri
-0000f1e0: 6e67 225d 2c20 7265 7370 6f6e 7365 295b  ng"], response)[
-0000f1f0: 305d 203d 3d20 2277 6562 3370 7922 0a0a  0] == "web3py"..
-0000f200: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-0000f210: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-0000f220: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
-0000f230: 6361 6c6c 5f6f 6666 6368 6169 6e5f 6c6f  call_offchain_lo
-0000f240: 6f6b 7570 5f63 616c 6c73 5f72 6169 7365  okup_calls_raise
-0000f250: 5f66 6f72 5f73 7461 7475 735f 666f 725f  _for_status_for_
-0000f260: 3478 785f 7374 6174 7573 5f63 6f64 6528  4xx_status_code(
-0000f270: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000f280: 2020 2020 2020 2061 7379 6e63 5f77 333a         async_w3:
-0000f290: 2022 4173 796e 6357 6562 3322 2c0a 2020   "AsyncWeb3",.  
-0000f2a0: 2020 2020 2020 6173 796e 635f 6f66 6663        async_offc
-0000f2b0: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
-0000f2c0: 7261 6374 3a20 2243 6f6e 7472 6163 7422  ract: "Contract"
-0000f2d0: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
-0000f2e0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-0000f2f0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-0000f300: 732c 0a20 2020 2020 2020 206d 6f6e 6b65  s,.        monke
-0000f310: 7970 6174 6368 3a20 224d 6f6e 6b65 7950  ypatch: "MonkeyP
-0000f320: 6174 6368 222c 0a20 2020 2029 202d 3e20  atch",.    ) -> 
-0000f330: 4e6f 6e65 3a0a 2020 2020 2020 2020 6e6f  None:.        no
-0000f340: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
-0000f350: 745f 6164 6472 6573 7320 3d20 746f 5f68  t_address = to_h
-0000f360: 6578 5f69 665f 6279 7465 7328 0a20 2020  ex_if_bytes(.   
-0000f370: 2020 2020 2020 2020 2061 7379 6e63 5f6f           async_o
-0000f380: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
-0000f390: 6f6e 7472 6163 742e 6164 6472 6573 730a  ontract.address.
-0000f3a0: 2020 2020 2020 2020 292e 6c6f 7765 7228          ).lower(
-0000f3b0: 290a 0a20 2020 2020 2020 2061 7379 6e63  )..        async
-0000f3c0: 5f6d 6f63 6b5f 6f66 6663 6861 696e 5f6c  _mock_offchain_l
-0000f3d0: 6f6f 6b75 705f 7265 7175 6573 745f 7265  ookup_request_re
-0000f3e0: 7370 6f6e 7365 280a 2020 2020 2020 2020  sponse(.        
-0000f3f0: 2020 2020 6d6f 6e6b 6579 7061 7463 682c      monkeypatch,
-0000f400: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
-0000f410: 6b65 645f 7265 7175 6573 745f 7572 6c3d  ked_request_url=
-0000f420: 6622 6874 7470 733a 2f2f 7765 6233 2e70  f"https://web3.p
-0000f430: 792f 6761 7465 7761 792f 7b6e 6f72 6d61  y/gateway/{norma
-0000f440: 6c69 7a65 645f 636f 6e74 7261 6374 5f61  lized_contract_a
-0000f450: 6464 7265 7373 7d2f 7b4f 4646 4348 4149  ddress}/{OFFCHAI
-0000f460: 4e5f 4c4f 4f4b 5550 5f54 4553 545f 4441  N_LOOKUP_TEST_DA
-0000f470: 5441 7d2e 6a73 6f6e 222c 2020 2320 6e6f  TA}.json",  # no
-0000f480: 7161 3a20 4535 3031 0a20 2020 2020 2020  qa: E501.       
-0000f490: 2020 2020 206d 6f63 6b65 645f 7374 6174       mocked_stat
-0000f4a0: 7573 5f63 6f64 653d 7261 6e64 696e 7428  us_code=randint(
-0000f4b0: 3430 302c 2034 3939 292c 0a20 2020 2020  400, 499),.     
-0000f4c0: 2020 2020 2020 206d 6f63 6b65 645f 6a73         mocked_js
-0000f4d0: 6f6e 5f64 6174 613d 5745 4233 5059 5f41  on_data=WEB3PY_A
-0000f4e0: 535f 4845 5842 5954 4553 2c0a 2020 2020  S_HEXBYTES,.    
-0000f4f0: 2020 2020 290a 2020 2020 2020 2020 7769      ).        wi
-0000f500: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-0000f510: 2845 7863 6570 7469 6f6e 2c20 6d61 7463  (Exception, matc
-0000f520: 683d 2263 616c 6c65 6420 7261 6973 655f  h="called raise_
-0000f530: 666f 725f 7374 6174 7573 5c5c 285c 5c29  for_status\\(\\)
-0000f540: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
-0000f550: 6177 6169 7420 6173 796e 635f 6f66 6663  await async_offc
-0000f560: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
-0000f570: 7261 6374 2e63 616c 6c65 7228 292e 7465  ract.caller().te
-0000f580: 7374 4f66 6663 6861 696e 4c6f 6f6b 7570  stOffchainLookup
-0000f590: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000f5a0: 2020 4f46 4643 4841 494e 5f4c 4f4f 4b55    OFFCHAIN_LOOKU
-0000f5b0: 505f 5445 5354 5f44 4154 410a 2020 2020  P_TEST_DATA.    
-0000f5c0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-0000f5d0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-0000f5e0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-0000f5f0: 6620 7465 7374 5f65 7468 5f63 616c 6c5f  f test_eth_call_
-0000f600: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-0000f610: 7261 6973 6573 5f77 6865 6e5f 616c 6c5f  raises_when_all_
-0000f620: 7375 7070 6c69 6564 5f75 726c 735f 6661  supplied_urls_fa
-0000f630: 696c 280a 2020 2020 2020 2020 7365 6c66  il(.        self
-0000f640: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
-0000f650: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
-0000f660: 0a20 2020 2020 2020 2061 7379 6e63 5f6f  .        async_o
-0000f670: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
-0000f680: 6f6e 7472 6163 743a 2022 436f 6e74 7261  ontract: "Contra
-0000f690: 6374 222c 0a20 2020 2029 202d 3e20 4e6f  ct",.    ) -> No
-0000f6a0: 6e65 3a0a 2020 2020 2020 2020 2320 4745  ne:.        # GE
-0000f6b0: 5420 616e 6420 504f 5354 2072 6571 7565  T and POST reque
-0000f6c0: 7374 7320 7368 6f75 6c64 2066 6169 6c20  sts should fail 
-0000f6d0: 7369 6e63 6520 7265 7370 6f6e 7365 7320  since responses 
-0000f6e0: 6172 6520 6e6f 7420 6d6f 636b 6564 0a20  are not mocked. 
-0000f6f0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-0000f700: 7374 2e72 6169 7365 7328 0a20 2020 2020  st.raises(.     
-0000f710: 2020 2020 2020 204d 756c 7469 706c 6546         MultipleF
-0000f720: 6169 6c65 6452 6571 7565 7374 732c 206d  ailedRequests, m
-0000f730: 6174 6368 3d22 4f66 6663 6861 696e 206c  atch="Offchain l
-0000f740: 6f6f 6b75 7020 6661 696c 6564 2066 6f72  ookup failed for
-0000f750: 2073 7570 706c 6965 6420 7572 6c73 220a   supplied urls".
-0000f760: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-0000f770: 2020 2020 2020 2061 7761 6974 2061 7379         await asy
-0000f780: 6e63 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  nc_offchain_look
-0000f790: 7570 5f63 6f6e 7472 6163 742e 6361 6c6c  up_contract.call
-0000f7a0: 6572 2829 2e74 6573 744f 6666 6368 6169  er().testOffchai
-0000f7b0: 6e4c 6f6f 6b75 7028 0a20 2020 2020 2020  nLookup(.       
-0000f7c0: 2020 2020 2020 2020 204f 4646 4348 4149           OFFCHAI
-0000f7d0: 4e5f 4c4f 4f4b 5550 5f54 4553 545f 4441  N_LOOKUP_TEST_DA
-0000f7e0: 5441 0a20 2020 2020 2020 2020 2020 2029  TA.            )
-0000f7f0: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-0000f800: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-0000f810: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
-0000f820: 685f 6361 6c6c 5f63 6f6e 7469 6e75 6f75  h_call_continuou
-0000f830: 735f 6f66 6663 6861 696e 5f6c 6f6f 6b75  s_offchain_looku
-0000f840: 705f 7261 6973 6573 5f77 6974 685f 746f  p_raises_with_to
-0000f850: 6f5f 6d61 6e79 5f72 6571 7565 7374 7328  o_many_requests(
-0000f860: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000f870: 2020 2020 2020 2061 7379 6e63 5f77 333a         async_w3:
-0000f880: 2022 4173 796e 6357 6562 3322 2c0a 2020   "AsyncWeb3",.  
-0000f890: 2020 2020 2020 6173 796e 635f 6f66 6663        async_offc
-0000f8a0: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
-0000f8b0: 7261 6374 3a20 2243 6f6e 7472 6163 7422  ract: "Contract"
-0000f8c0: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
-0000f8d0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-0000f8e0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-0000f8f0: 732c 0a20 2020 2020 2020 206d 6f6e 6b65  s,.        monke
-0000f900: 7970 6174 6368 3a20 224d 6f6e 6b65 7950  ypatch: "MonkeyP
-0000f910: 6174 6368 222c 0a20 2020 2029 202d 3e20  atch",.    ) -> 
-0000f920: 4e6f 6e65 3a0a 2020 2020 2020 2020 6e6f  None:.        no
-0000f930: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
-0000f940: 745f 6164 6472 6573 7320 3d20 746f 5f68  t_address = to_h
-0000f950: 6578 5f69 665f 6279 7465 7328 0a20 2020  ex_if_bytes(.   
-0000f960: 2020 2020 2020 2020 2061 7379 6e63 5f6f           async_o
-0000f970: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
-0000f980: 6f6e 7472 6163 742e 6164 6472 6573 730a  ontract.address.
-0000f990: 2020 2020 2020 2020 292e 6c6f 7765 7228          ).lower(
-0000f9a0: 290a 0a20 2020 2020 2020 2061 7379 6e63  )..        async
-0000f9b0: 5f6d 6f63 6b5f 6f66 6663 6861 696e 5f6c  _mock_offchain_l
-0000f9c0: 6f6f 6b75 705f 7265 7175 6573 745f 7265  ookup_request_re
-0000f9d0: 7370 6f6e 7365 280a 2020 2020 2020 2020  sponse(.        
-0000f9e0: 2020 2020 6d6f 6e6b 6579 7061 7463 682c      monkeypatch,
-0000f9f0: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
-0000fa00: 6b65 645f 7265 7175 6573 745f 7572 6c3d  ked_request_url=
-0000fa10: 6622 6874 7470 733a 2f2f 7765 6233 2e70  f"https://web3.p
-0000fa20: 792f 6761 7465 7761 792f 7b6e 6f72 6d61  y/gateway/{norma
-0000fa30: 6c69 7a65 645f 636f 6e74 7261 6374 5f61  lized_contract_a
-0000fa40: 6464 7265 7373 7d2f 3078 2e6a 736f 6e22  ddress}/0x.json"
-0000fa50: 2c20 2023 206e 6f71 613a 2045 3530 310a  ,  # noqa: E501.
-0000fa60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000fa70: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-0000fa80: 6973 6573 2854 6f6f 4d61 6e79 5265 7175  ises(TooManyRequ
-0000fa90: 6573 7473 2c20 6d61 7463 683d 2254 6f6f  ests, match="Too
-0000faa0: 206d 616e 7920 4343 4950 2072 6561 6420   many CCIP read 
-0000fab0: 7265 6469 7265 6374 7322 293a 0a20 2020  redirects"):.   
-0000fac0: 2020 2020 2020 2020 2061 7761 6974 2061           await a
-0000fad0: 7379 6e63 5f6f 6666 6368 6169 6e5f 6c6f  sync_offchain_lo
-0000fae0: 6f6b 7570 5f63 6f6e 7472 6163 742e 6361  okup_contract.ca
-0000faf0: 6c6c 6572 2829 2e63 6f6e 7469 6e75 6f75  ller().continuou
-0000fb00: 734f 6666 6368 6169 6e4c 6f6f 6b75 7028  sOffchainLookup(
-0000fb10: 2920 2023 206e 6f71 613a 2045 3530 3120  )  # noqa: E501 
-0000fb20: 7479 7065 3a20 6967 6e6f 7265 0a0a 2020  type: ignore..  
-0000fb30: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-0000fb40: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-0000fb50: 2064 6566 2074 6573 745f 6173 796e 635f   def test_async_
-0000fb60: 6574 685f 6861 7368 7261 7465 2873 656c  eth_hashrate(sel
-0000fb70: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-0000fb80: 796e 6357 6562 3322 2920 2d3e 204e 6f6e  yncWeb3") -> Non
-0000fb90: 653a 0a20 2020 2020 2020 2068 6173 6872  e:.        hashr
-0000fba0: 6174 6520 3d20 6177 6169 7420 6173 796e  ate = await asyn
-0000fbb0: 635f 7733 2e65 7468 2e68 6173 6872 6174  c_w3.eth.hashrat
-0000fbc0: 650a 2020 2020 2020 2020 6173 7365 7274  e.        assert
-0000fbd0: 2069 735f 696e 7465 6765 7228 6861 7368   is_integer(hash
-0000fbe0: 7261 7465 290a 2020 2020 2020 2020 6173  rate).        as
-0000fbf0: 7365 7274 2068 6173 6872 6174 6520 3e3d  sert hashrate >=
-0000fc00: 2030 0a0a 2020 2020 4070 7974 6573 742e   0..    @pytest.
-0000fc10: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-0000fc20: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-0000fc30: 6173 796e 635f 6574 685f 6368 6169 6e5f  async_eth_chain_
-0000fc40: 6964 2873 656c 662c 2061 7379 6e63 5f77  id(self, async_w
-0000fc50: 333a 2022 4173 796e 6357 6562 3322 2920  3: "AsyncWeb3") 
-0000fc60: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0000fc70: 2063 6861 696e 5f69 6420 3d20 6177 6169   chain_id = awai
-0000fc80: 7420 6173 796e 635f 7733 2e65 7468 2e63  t async_w3.eth.c
-0000fc90: 6861 696e 5f69 640a 2020 2020 2020 2020  hain_id.        
-0000fca0: 2320 6368 6169 6e20 6964 2076 616c 7565  # chain id value
-0000fcb0: 2066 726f 6d20 6765 7468 2066 6978 7475   from geth fixtu
-0000fcc0: 7265 2067 656e 6573 6973 2066 696c 650a  re genesis file.
-0000fcd0: 2020 2020 2020 2020 6173 7365 7274 2063          assert c
-0000fce0: 6861 696e 5f69 6420 3d3d 2031 3331 3237  hain_id == 13127
-0000fcf0: 3733 3232 3934 3035 3337 0a0a 2020 2020  7322940537..    
-0000fd00: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-0000fd10: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-0000fd20: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
-0000fd30: 685f 6d69 6e69 6e67 2873 656c 662c 2061  h_mining(self, a
-0000fd40: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-0000fd50: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
-0000fd60: 2020 2020 2020 206d 696e 696e 6720 3d20         mining = 
-0000fd70: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
-0000fd80: 7468 2e6d 696e 696e 670a 2020 2020 2020  th.mining.      
-0000fd90: 2020 6173 7365 7274 2069 735f 626f 6f6c    assert is_bool
-0000fda0: 6561 6e28 6d69 6e69 6e67 290a 0a20 2020  ean(mining)..   
-0000fdb0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-0000fdc0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-0000fdd0: 6465 6620 7465 7374 5f61 7379 6e63 5f65  def test_async_e
-0000fde0: 7468 5f67 6574 5f74 7261 6e73 6163 7469  th_get_transacti
-0000fdf0: 6f6e 5f72 6563 6569 7074 5f6d 696e 6564  on_receipt_mined
-0000fe00: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000fe10: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
-0000fe20: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
-0000fe30: 2020 2020 2020 2061 7379 6e63 5f62 6c6f         async_blo
-0000fe40: 636b 5f77 6974 685f 7478 6e3a 2042 6c6f  ck_with_txn: Blo
-0000fe50: 636b 4461 7461 2c0a 2020 2020 2020 2020  ckData,.        
-0000fe60: 6d69 6e65 645f 7478 6e5f 6861 7368 3a20  mined_txn_hash: 
-0000fe70: 4865 7853 7472 2c0a 2020 2020 2920 2d3e  HexStr,.    ) ->
-0000fe80: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
-0000fe90: 6563 6569 7074 203d 2061 7761 6974 2061  eceipt = await a
-0000fea0: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
-0000feb0: 7472 616e 7361 6374 696f 6e5f 7265 6365  transaction_rece
-0000fec0: 6970 7428 6d69 6e65 645f 7478 6e5f 6861  ipt(mined_txn_ha
-0000fed0: 7368 290a 2020 2020 2020 2020 6173 7365  sh).        asse
-0000fee0: 7274 2069 735f 6469 6374 2872 6563 6569  rt is_dict(recei
-0000fef0: 7074 290a 2020 2020 2020 2020 6173 7365  pt).        asse
-0000ff00: 7274 2072 6563 6569 7074 5b22 626c 6f63  rt receipt["bloc
-0000ff10: 6b4e 756d 6265 7222 5d20 3d3d 2061 7379  kNumber"] == asy
-0000ff20: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
-0000ff30: 6e5b 226e 756d 6265 7222 5d0a 2020 2020  n["number"].    
-0000ff40: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
-0000ff50: 7074 5b22 626c 6f63 6b48 6173 6822 5d20  pt["blockHash"] 
-0000ff60: 3d3d 2061 7379 6e63 5f62 6c6f 636b 5f77  == async_block_w
-0000ff70: 6974 685f 7478 6e5b 2268 6173 6822 5d0a  ith_txn["hash"].
-0000ff80: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-0000ff90: 6563 6569 7074 5b22 7472 616e 7361 6374  eceipt["transact
-0000ffa0: 696f 6e49 6e64 6578 225d 203d 3d20 300a  ionIndex"] == 0.
-0000ffb0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-0000ffc0: 6563 6569 7074 5b22 7472 616e 7361 6374  eceipt["transact
-0000ffd0: 696f 6e48 6173 6822 5d20 3d3d 2048 6578  ionHash"] == Hex
-0000ffe0: 4279 7465 7328 6d69 6e65 645f 7478 6e5f  Bytes(mined_txn_
-0000fff0: 6861 7368 290a 2020 2020 2020 2020 6173  hash).        as
-00010000: 7365 7274 2069 735f 6368 6563 6b73 756d  sert is_checksum
-00010010: 5f61 6464 7265 7373 2872 6563 6569 7074  _address(receipt
-00010020: 5b22 746f 225d 290a 2020 2020 2020 2020  ["to"]).        
-00010030: 6173 7365 7274 2072 6563 6569 7074 5b22  assert receipt["
-00010040: 6672 6f6d 225d 2069 7320 6e6f 7420 4e6f  from"] is not No
-00010050: 6e65 0a20 2020 2020 2020 2061 7373 6572  ne.        asser
-00010060: 7420 6973 5f63 6865 636b 7375 6d5f 6164  t is_checksum_ad
-00010070: 6472 6573 7328 7265 6365 6970 745b 2266  dress(receipt["f
-00010080: 726f 6d22 5d29 0a0a 2020 2020 2020 2020  rom"])..        
-00010090: 6566 6665 6374 6976 655f 6761 735f 7072  effective_gas_pr
-000100a0: 6963 6520 3d20 7265 6365 6970 745b 2265  ice = receipt["e
-000100b0: 6666 6563 7469 7665 4761 7350 7269 6365  ffectiveGasPrice
-000100c0: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
-000100d0: 7420 6973 696e 7374 616e 6365 2865 6666  t isinstance(eff
-000100e0: 6563 7469 7665 5f67 6173 5f70 7269 6365  ective_gas_price
-000100f0: 2c20 696e 7429 0a20 2020 2020 2020 2061  , int).        a
-00010100: 7373 6572 7420 6566 6665 6374 6976 655f  ssert effective_
-00010110: 6761 735f 7072 6963 6520 3e20 300a 0a20  gas_price > 0.. 
-00010120: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-00010130: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-00010140: 6320 6465 6620 7465 7374 5f61 7379 6e63  c def test_async
-00010150: 5f65 7468 5f67 6574 5f74 7261 6e73 6163  _eth_get_transac
-00010160: 7469 6f6e 5f72 6563 6569 7074 5f75 6e6d  tion_receipt_unm
-00010170: 696e 6564 280a 2020 2020 2020 2020 7365  ined(.        se
-00010180: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
-00010190: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
-000101a0: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
-000101b0: 745f 6475 616c 5f74 7970 653a 2043 6865  t_dual_type: Che
-000101c0: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
-000101d0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-000101e0: 2020 2020 7478 6e5f 6861 7368 203d 2061      txn_hash = a
-000101f0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00010200: 682e 7365 6e64 5f74 7261 6e73 6163 7469  h.send_transacti
-00010210: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-00010220: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00010230: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
-00010240: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00010250: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-00010260: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
-00010270: 3a20 6173 796e 635f 756e 6c6f 636b 6564  : async_unlocked
-00010280: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
-00010290: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-000102a0: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
-000102b0: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
-000102c0: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
-000102d0: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-000102e0: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
-000102f0: 223a 2061 7379 6e63 5f77 332e 746f 5f77  ": async_w3.to_w
-00010300: 6569 2833 2c20 2267 7765 6922 292c 0a20  ei(3, "gwei"),. 
-00010310: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00010320: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-00010330: 7247 6173 223a 2061 7379 6e63 5f77 332e  rGas": async_w3.
-00010340: 746f 5f77 6569 2831 2c20 2267 7765 6922  to_wei(1, "gwei"
-00010350: 292c 0a20 2020 2020 2020 2020 2020 207d  ),.            }
-00010360: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00010370: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-00010380: 6169 7365 7328 5472 616e 7361 6374 696f  aises(Transactio
-00010390: 6e4e 6f74 466f 756e 6429 3a0a 2020 2020  nNotFound):.    
-000103a0: 2020 2020 2020 2020 6177 6169 7420 6173          await as
-000103b0: 796e 635f 7733 2e65 7468 2e67 6574 5f74  ync_w3.eth.get_t
-000103c0: 7261 6e73 6163 7469 6f6e 5f72 6563 6569  ransaction_recei
-000103d0: 7074 2874 786e 5f68 6173 6829 0a0a 2020  pt(txn_hash)..  
-000103e0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-000103f0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-00010400: 2064 6566 2074 6573 745f 6173 796e 635f   def test_async_
-00010410: 6574 685f 6765 745f 7472 616e 7361 6374  eth_get_transact
-00010420: 696f 6e5f 7265 6365 6970 745f 7769 7468  ion_receipt_with
-00010430: 5f6c 6f67 5f65 6e74 7279 280a 2020 2020  _log_entry(.    
-00010440: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00010450: 2020 6173 796e 635f 7733 3a20 2241 7379    async_w3: "Asy
-00010460: 6e63 5765 6233 222c 0a20 2020 2020 2020  ncWeb3",.       
-00010470: 2061 7379 6e63 5f62 6c6f 636b 5f77 6974   async_block_wit
-00010480: 685f 7478 6e5f 7769 7468 5f6c 6f67 3a20  h_txn_with_log: 
-00010490: 426c 6f63 6b44 6174 612c 0a20 2020 2020  BlockData,.     
-000104a0: 2020 2061 7379 6e63 5f65 6d69 7474 6572     async_emitter
-000104b0: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
-000104c0: 7261 6374 222c 0a20 2020 2020 2020 2074  ract",.        t
-000104d0: 786e 5f68 6173 685f 7769 7468 5f6c 6f67  xn_hash_with_log
-000104e0: 3a20 4865 7853 7472 2c0a 2020 2020 2920  : HexStr,.    ) 
-000104f0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00010500: 2072 6563 6569 7074 203d 2061 7761 6974   receipt = await
-00010510: 2061 7379 6e63 5f77 332e 6574 682e 7761   async_w3.eth.wa
-00010520: 6974 5f66 6f72 5f74 7261 6e73 6163 7469  it_for_transacti
-00010530: 6f6e 5f72 6563 6569 7074 2874 786e 5f68  on_receipt(txn_h
-00010540: 6173 685f 7769 7468 5f6c 6f67 290a 2020  ash_with_log).  
-00010550: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00010560: 6469 6374 2872 6563 6569 7074 290a 2020  dict(receipt).  
-00010570: 2020 2020 2020 6173 7365 7274 2072 6563        assert rec
-00010580: 6569 7074 5b22 626c 6f63 6b4e 756d 6265  eipt["blockNumbe
-00010590: 7222 5d20 3d3d 2061 7379 6e63 5f62 6c6f  r"] == async_blo
-000105a0: 636b 5f77 6974 685f 7478 6e5f 7769 7468  ck_with_txn_with
-000105b0: 5f6c 6f67 5b22 6e75 6d62 6572 225d 0a20  _log["number"]. 
-000105c0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-000105d0: 6365 6970 745b 2262 6c6f 636b 4861 7368  ceipt["blockHash
-000105e0: 225d 203d 3d20 6173 796e 635f 626c 6f63  "] == async_bloc
-000105f0: 6b5f 7769 7468 5f74 786e 5f77 6974 685f  k_with_txn_with_
-00010600: 6c6f 675b 2268 6173 6822 5d0a 2020 2020  log["hash"].    
-00010610: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
-00010620: 7074 5b22 7472 616e 7361 6374 696f 6e49  pt["transactionI
-00010630: 6e64 6578 225d 203d 3d20 300a 2020 2020  ndex"] == 0.    
-00010640: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
-00010650: 7074 5b22 7472 616e 7361 6374 696f 6e48  pt["transactionH
-00010660: 6173 6822 5d20 3d3d 2048 6578 4279 7465  ash"] == HexByte
-00010670: 7328 7478 6e5f 6861 7368 5f77 6974 685f  s(txn_hash_with_
-00010680: 6c6f 6729 0a0a 2020 2020 2020 2020 6173  log)..        as
-00010690: 7365 7274 206c 656e 2872 6563 6569 7074  sert len(receipt
-000106a0: 5b22 6c6f 6773 225d 2920 3d3d 2031 0a20  ["logs"]) == 1. 
-000106b0: 2020 2020 2020 206c 6f67 5f65 6e74 7279         log_entry
-000106c0: 203d 2072 6563 6569 7074 5b22 6c6f 6773   = receipt["logs
-000106d0: 225d 5b30 5d0a 0a20 2020 2020 2020 2061  "][0]..        a
-000106e0: 7373 6572 7420 6c6f 675f 656e 7472 795b  ssert log_entry[
-000106f0: 2262 6c6f 636b 4e75 6d62 6572 225d 203d  "blockNumber"] =
-00010700: 3d20 6173 796e 635f 626c 6f63 6b5f 7769  = async_block_wi
-00010710: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
-00010720: 226e 756d 6265 7222 5d0a 2020 2020 2020  "number"].      
-00010730: 2020 6173 7365 7274 206c 6f67 5f65 6e74    assert log_ent
-00010740: 7279 5b22 626c 6f63 6b48 6173 6822 5d20  ry["blockHash"] 
-00010750: 3d3d 2061 7379 6e63 5f62 6c6f 636b 5f77  == async_block_w
-00010760: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
-00010770: 5b22 6861 7368 225d 0a20 2020 2020 2020  ["hash"].       
-00010780: 2061 7373 6572 7420 6c6f 675f 656e 7472   assert log_entr
-00010790: 795b 226c 6f67 496e 6465 7822 5d20 3d3d  y["logIndex"] ==
-000107a0: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
-000107b0: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
-000107c0: 7328 6c6f 675f 656e 7472 795b 2261 6464  s(log_entry["add
-000107d0: 7265 7373 225d 2c20 6173 796e 635f 656d  ress"], async_em
-000107e0: 6974 7465 725f 636f 6e74 7261 6374 2e61  itter_contract.a
-000107f0: 6464 7265 7373 290a 2020 2020 2020 2020  ddress).        
-00010800: 6173 7365 7274 206c 6f67 5f65 6e74 7279  assert log_entry
-00010810: 5b22 7472 616e 7361 6374 696f 6e49 6e64  ["transactionInd
-00010820: 6578 225d 203d 3d20 300a 2020 2020 2020  ex"] == 0.      
-00010830: 2020 6173 7365 7274 206c 6f67 5f65 6e74    assert log_ent
-00010840: 7279 5b22 7472 616e 7361 6374 696f 6e48  ry["transactionH
-00010850: 6173 6822 5d20 3d3d 2048 6578 4279 7465  ash"] == HexByte
-00010860: 7328 7478 6e5f 6861 7368 5f77 6974 685f  s(txn_hash_with_
-00010870: 6c6f 6729 0a0a 2020 2020 4070 7974 6573  log)..    @pytes
-00010880: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00010890: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-000108a0: 745f 6173 796e 635f 6574 685f 7761 6974  t_async_eth_wait
-000108b0: 5f66 6f72 5f74 7261 6e73 6163 7469 6f6e  _for_transaction
-000108c0: 5f72 6563 6569 7074 5f6d 696e 6564 280a  _receipt_mined(.
-000108d0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000108e0: 2020 2020 2020 6173 796e 635f 7733 3a20        async_w3: 
-000108f0: 2241 7379 6e63 5765 6233 222c 0a20 2020  "AsyncWeb3",.   
-00010900: 2020 2020 2061 7379 6e63 5f62 6c6f 636b       async_block
-00010910: 5f77 6974 685f 7478 6e3a 2042 6c6f 636b  _with_txn: Block
-00010920: 4461 7461 2c0a 2020 2020 2020 2020 6d69  Data,.        mi
-00010930: 6e65 645f 7478 6e5f 6861 7368 3a20 4865  ned_txn_hash: He
-00010940: 7853 7472 2c0a 2020 2020 2920 2d3e 204e  xStr,.    ) -> N
-00010950: 6f6e 653a 0a20 2020 2020 2020 2072 6563  one:.        rec
-00010960: 6569 7074 203d 2061 7761 6974 2061 7379  eipt = await asy
-00010970: 6e63 5f77 332e 6574 682e 7761 6974 5f66  nc_w3.eth.wait_f
-00010980: 6f72 5f74 7261 6e73 6163 7469 6f6e 5f72  or_transaction_r
-00010990: 6563 6569 7074 286d 696e 6564 5f74 786e  eceipt(mined_txn
-000109a0: 5f68 6173 6829 0a20 2020 2020 2020 2061  _hash).        a
-000109b0: 7373 6572 7420 6973 5f64 6963 7428 7265  ssert is_dict(re
-000109c0: 6365 6970 7429 0a20 2020 2020 2020 2061  ceipt).        a
-000109d0: 7373 6572 7420 7265 6365 6970 745b 2262  ssert receipt["b
-000109e0: 6c6f 636b 4e75 6d62 6572 225d 203d 3d20  lockNumber"] == 
-000109f0: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
-00010a00: 5f74 786e 5b22 6e75 6d62 6572 225d 0a20  _txn["number"]. 
-00010a10: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-00010a20: 6365 6970 745b 2262 6c6f 636b 4861 7368  ceipt["blockHash
-00010a30: 225d 203d 3d20 6173 796e 635f 626c 6f63  "] == async_bloc
-00010a40: 6b5f 7769 7468 5f74 786e 5b22 6861 7368  k_with_txn["hash
-00010a50: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
-00010a60: 7420 7265 6365 6970 745b 2274 7261 6e73  t receipt["trans
-00010a70: 6163 7469 6f6e 496e 6465 7822 5d20 3d3d  actionIndex"] ==
-00010a80: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
-00010a90: 7420 7265 6365 6970 745b 2274 7261 6e73  t receipt["trans
-00010aa0: 6163 7469 6f6e 4861 7368 225d 203d 3d20  actionHash"] == 
-00010ab0: 4865 7842 7974 6573 286d 696e 6564 5f74  HexBytes(mined_t
-00010ac0: 786e 5f68 6173 6829 0a20 2020 2020 2020  xn_hash).       
-00010ad0: 2061 7373 6572 7420 6973 5f63 6865 636b   assert is_check
-00010ae0: 7375 6d5f 6164 6472 6573 7328 7265 6365  sum_address(rece
-00010af0: 6970 745b 2274 6f22 5d29 0a20 2020 2020  ipt["to"]).     
-00010b00: 2020 2061 7373 6572 7420 7265 6365 6970     assert receip
-00010b10: 745b 2266 726f 6d22 5d20 6973 206e 6f74  t["from"] is not
-00010b20: 204e 6f6e 650a 2020 2020 2020 2020 6173   None.        as
-00010b30: 7365 7274 2069 735f 6368 6563 6b73 756d  sert is_checksum
-00010b40: 5f61 6464 7265 7373 2872 6563 6569 7074  _address(receipt
-00010b50: 5b22 6672 6f6d 225d 290a 0a20 2020 2020  ["from"])..     
-00010b60: 2020 2065 6666 6563 7469 7665 5f67 6173     effective_gas
-00010b70: 5f70 7269 6365 203d 2072 6563 6569 7074  _price = receipt
-00010b80: 5b22 6566 6665 6374 6976 6547 6173 5072  ["effectiveGasPr
-00010b90: 6963 6522 5d0a 2020 2020 2020 2020 6173  ice"].        as
-00010ba0: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
-00010bb0: 6566 6665 6374 6976 655f 6761 735f 7072  effective_gas_pr
-00010bc0: 6963 652c 2069 6e74 290a 2020 2020 2020  ice, int).      
-00010bd0: 2020 6173 7365 7274 2065 6666 6563 7469    assert effecti
-00010be0: 7665 5f67 6173 5f70 7269 6365 203e 2030  ve_gas_price > 0
-00010bf0: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-00010c00: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-00010c10: 7379 6e63 2064 6566 2074 6573 745f 6173  sync def test_as
-00010c20: 796e 635f 6574 685f 7761 6974 5f66 6f72  ync_eth_wait_for
-00010c30: 5f74 7261 6e73 6163 7469 6f6e 5f72 6563  _transaction_rec
-00010c40: 6569 7074 5f75 6e6d 696e 6564 280a 2020  eipt_unmined(.  
-00010c50: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
-00010c60: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-00010c70: 222c 2061 7379 6e63 5f75 6e6c 6f63 6b65  ", async_unlocke
-00010c80: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-00010c90: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-00010ca0: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-00010cb0: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-00010cc0: 6861 7368 203d 2061 7761 6974 2061 7379  hash = await asy
-00010cd0: 6e63 5f77 332e 6574 682e 7365 6e64 5f74  nc_w3.eth.send_t
-00010ce0: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
-00010cf0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00010d00: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-00010d10: 3a20 6173 796e 635f 756e 6c6f 636b 6564  : async_unlocked
-00010d20: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
-00010d30: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00010d40: 2020 2020 2274 6f22 3a20 6173 796e 635f      "to": async_
-00010d50: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00010d60: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-00010d70: 2020 2020 2020 2020 2020 2020 2276 616c              "val
-00010d80: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
-00010d90: 2020 2020 2020 2020 2020 2020 2022 6761               "ga
-00010da0: 7322 3a20 3231 3030 302c 0a20 2020 2020  s": 21000,.     
-00010db0: 2020 2020 2020 2020 2020 2022 6d61 7846             "maxF
-00010dc0: 6565 5065 7247 6173 223a 2061 7379 6e63  eePerGas": async
-00010dd0: 5f77 332e 746f 5f77 6569 2833 2c20 2267  _w3.to_wei(3, "g
-00010de0: 7765 6922 292c 0a20 2020 2020 2020 2020  wei"),.         
-00010df0: 2020 2020 2020 2022 6d61 7850 7269 6f72         "maxPrior
-00010e00: 6974 7946 6565 5065 7247 6173 223a 2061  ityFeePerGas": a
-00010e10: 7379 6e63 5f77 332e 746f 5f77 6569 2831  sync_w3.to_wei(1
-00010e20: 2c20 2267 7765 6922 292c 0a20 2020 2020  , "gwei"),.     
-00010e30: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00010e40: 2029 0a0a 2020 2020 2020 2020 7469 6d65   )..        time
-00010e50: 6f75 7420 3d20 302e 3031 0a20 2020 2020  out = 0.01.     
-00010e60: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-00010e70: 6169 7365 7328 5469 6d65 4578 6861 7573  aises(TimeExhaus
-00010e80: 7465 6429 2061 7320 6578 635f 696e 666f  ted) as exc_info
-00010e90: 3a0a 2020 2020 2020 2020 2020 2020 6177  :.            aw
-00010ea0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00010eb0: 2e77 6169 745f 666f 725f 7472 616e 7361  .wait_for_transa
-00010ec0: 6374 696f 6e5f 7265 6365 6970 7428 7478  ction_receipt(tx
-00010ed0: 6e5f 6861 7368 2c20 7469 6d65 6f75 743d  n_hash, timeout=
-00010ee0: 7469 6d65 6f75 7429 0a0a 2020 2020 2020  timeout)..      
-00010ef0: 2020 6173 7365 7274 2028 5f20 696e 2073    assert (_ in s
-00010f00: 7472 2865 7863 5f69 6e66 6f29 2066 6f72  tr(exc_info) for
-00010f10: 205f 2069 6e20 5b72 6570 7228 7478 6e5f   _ in [repr(txn_
-00010f20: 6861 7368 292c 2074 696d 656f 7574 5d29  hash), timeout])
-00010f30: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-00010f40: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-00010f50: 7379 6e63 2064 6566 2074 6573 745f 6173  sync def test_as
-00010f60: 796e 635f 6574 685f 7761 6974 5f66 6f72  ync_eth_wait_for
-00010f70: 5f74 7261 6e73 6163 7469 6f6e 5f72 6563  _transaction_rec
-00010f80: 6569 7074 5f77 6974 685f 6c6f 675f 656e  eipt_with_log_en
-00010f90: 7472 7928 0a20 2020 2020 2020 2073 656c  try(.        sel
-00010fa0: 662c 0a20 2020 2020 2020 2061 7379 6e63  f,.        async
-00010fb0: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
-00010fc0: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
-00010fd0: 626c 6f63 6b5f 7769 7468 5f74 786e 5f77  block_with_txn_w
-00010fe0: 6974 685f 6c6f 673a 2042 6c6f 636b 4461  ith_log: BlockDa
-00010ff0: 7461 2c0a 2020 2020 2020 2020 6173 796e  ta,.        asyn
-00011000: 635f 656d 6974 7465 725f 636f 6e74 7261  c_emitter_contra
-00011010: 6374 3a20 2243 6f6e 7472 6163 7422 2c0a  ct: "Contract",.
-00011020: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
-00011030: 5f77 6974 685f 6c6f 673a 2048 6578 5374  _with_log: HexSt
-00011040: 722c 0a20 2020 2029 202d 3e20 4e6f 6e65  r,.    ) -> None
-00011050: 3a0a 2020 2020 2020 2020 7265 6365 6970  :.        receip
-00011060: 7420 3d20 6177 6169 7420 6173 796e 635f  t = await async_
-00011070: 7733 2e65 7468 2e77 6169 745f 666f 725f  w3.eth.wait_for_
-00011080: 7472 616e 7361 6374 696f 6e5f 7265 6365  transaction_rece
-00011090: 6970 7428 7478 6e5f 6861 7368 5f77 6974  ipt(txn_hash_wit
-000110a0: 685f 6c6f 6729 0a20 2020 2020 2020 2061  h_log).        a
-000110b0: 7373 6572 7420 6973 5f64 6963 7428 7265  ssert is_dict(re
-000110c0: 6365 6970 7429 0a20 2020 2020 2020 2061  ceipt).        a
-000110d0: 7373 6572 7420 7265 6365 6970 745b 2262  ssert receipt["b
-000110e0: 6c6f 636b 4e75 6d62 6572 225d 203d 3d20  lockNumber"] == 
-000110f0: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
-00011100: 5f74 786e 5f77 6974 685f 6c6f 675b 226e  _txn_with_log["n
-00011110: 756d 6265 7222 5d0a 2020 2020 2020 2020  umber"].        
-00011120: 6173 7365 7274 2072 6563 6569 7074 5b22  assert receipt["
-00011130: 626c 6f63 6b48 6173 6822 5d20 3d3d 2061  blockHash"] == a
-00011140: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
-00011150: 7478 6e5f 7769 7468 5f6c 6f67 5b22 6861  txn_with_log["ha
-00011160: 7368 225d 0a20 2020 2020 2020 2061 7373  sh"].        ass
-00011170: 6572 7420 7265 6365 6970 745b 2274 7261  ert receipt["tra
-00011180: 6e73 6163 7469 6f6e 496e 6465 7822 5d20  nsactionIndex"] 
-00011190: 3d3d 2030 0a20 2020 2020 2020 2061 7373  == 0.        ass
-000111a0: 6572 7420 7265 6365 6970 745b 2274 7261  ert receipt["tra
-000111b0: 6e73 6163 7469 6f6e 4861 7368 225d 203d  nsactionHash"] =
-000111c0: 3d20 4865 7842 7974 6573 2874 786e 5f68  = HexBytes(txn_h
-000111d0: 6173 685f 7769 7468 5f6c 6f67 290a 0a20  ash_with_log).. 
-000111e0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-000111f0: 6e28 7265 6365 6970 745b 226c 6f67 7322  n(receipt["logs"
-00011200: 5d29 203d 3d20 310a 2020 2020 2020 2020  ]) == 1.        
-00011210: 6c6f 675f 656e 7472 7920 3d20 7265 6365  log_entry = rece
-00011220: 6970 745b 226c 6f67 7322 5d5b 305d 0a0a  ipt["logs"][0]..
-00011230: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-00011240: 6f67 5f65 6e74 7279 5b22 626c 6f63 6b4e  og_entry["blockN
-00011250: 756d 6265 7222 5d20 3d3d 2061 7379 6e63  umber"] == async
-00011260: 5f62 6c6f 636b 5f77 6974 685f 7478 6e5f  _block_with_txn_
-00011270: 7769 7468 5f6c 6f67 5b22 6e75 6d62 6572  with_log["number
-00011280: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
-00011290: 7420 6c6f 675f 656e 7472 795b 2262 6c6f  t log_entry["blo
-000112a0: 636b 4861 7368 225d 203d 3d20 6173 796e  ckHash"] == asyn
-000112b0: 635f 626c 6f63 6b5f 7769 7468 5f74 786e  c_block_with_txn
-000112c0: 5f77 6974 685f 6c6f 675b 2268 6173 6822  _with_log["hash"
-000112d0: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
-000112e0: 206c 6f67 5f65 6e74 7279 5b22 6c6f 6749   log_entry["logI
-000112f0: 6e64 6578 225d 203d 3d20 300a 2020 2020  ndex"] == 0.    
-00011300: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
-00011310: 6d65 5f61 6464 7265 7373 286c 6f67 5f65  me_address(log_e
-00011320: 6e74 7279 5b22 6164 6472 6573 7322 5d2c  ntry["address"],
-00011330: 2061 7379 6e63 5f65 6d69 7474 6572 5f63   async_emitter_c
-00011340: 6f6e 7472 6163 742e 6164 6472 6573 7329  ontract.address)
-00011350: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00011360: 6c6f 675f 656e 7472 795b 2274 7261 6e73  log_entry["trans
-00011370: 6163 7469 6f6e 496e 6465 7822 5d20 3d3d  actionIndex"] ==
-00011380: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
-00011390: 7420 6c6f 675f 656e 7472 795b 2274 7261  t log_entry["tra
-000113a0: 6e73 6163 7469 6f6e 4861 7368 225d 203d  nsactionHash"] =
-000113b0: 3d20 4865 7842 7974 6573 2874 786e 5f68  = HexBytes(txn_h
-000113c0: 6173 685f 7769 7468 5f6c 6f67 290a 0a20  ash_with_log).. 
-000113d0: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-000113e0: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-000113f0: 6320 6465 6620 7465 7374 5f61 7379 6e63  c def test_async
-00011400: 5f65 7468 5f61 6363 6f75 6e74 7328 7365  _eth_accounts(se
-00011410: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
-00011420: 7379 6e63 5765 6233 2229 202d 3e20 4e6f  syncWeb3") -> No
-00011430: 6e65 3a0a 2020 2020 2020 2020 6163 636f  ne:.        acco
-00011440: 756e 7473 203d 2061 7761 6974 2061 7379  unts = await asy
-00011450: 6e63 5f77 332e 6574 682e 6163 636f 756e  nc_w3.eth.accoun
-00011460: 7473 0a20 2020 2020 2020 2061 7373 6572  ts.        asser
-00011470: 7420 6973 5f6c 6973 745f 6c69 6b65 2861  t is_list_like(a
-00011480: 6363 6f75 6e74 7329 0a20 2020 2020 2020  ccounts).       
-00011490: 2061 7373 6572 7420 6c65 6e28 6163 636f   assert len(acco
-000114a0: 756e 7473 2920 213d 2030 0a20 2020 2020  unts) != 0.     
-000114b0: 2020 2061 7373 6572 7420 616c 6c28 2869     assert all((i
-000114c0: 735f 6368 6563 6b73 756d 5f61 6464 7265  s_checksum_addre
-000114d0: 7373 2861 6363 6f75 6e74 2920 666f 7220  ss(account) for 
-000114e0: 6163 636f 756e 7420 696e 2061 6363 6f75  account in accou
-000114f0: 6e74 7329 290a 2020 2020 2020 2020 6173  nts)).        as
-00011500: 7365 7274 2061 7761 6974 2061 7379 6e63  sert await async
-00011510: 5f77 332e 6574 682e 636f 696e 6261 7365  _w3.eth.coinbase
-00011520: 2069 6e20 6163 636f 756e 7473 0a0a 2020   in accounts..  
-00011530: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-00011540: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-00011550: 2064 6566 2074 6573 745f 6173 796e 635f   def test_async_
-00011560: 6574 685f 6765 745f 6c6f 6773 5f77 6974  eth_get_logs_wit
-00011570: 686f 7574 5f6c 6f67 7328 0a20 2020 2020  hout_logs(.     
-00011580: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
-00011590: 333a 2022 4173 796e 6357 6562 3322 2c20  3: "AsyncWeb3", 
-000115a0: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
-000115b0: 5f74 786e 5f77 6974 685f 6c6f 673a 2042  _txn_with_log: B
-000115c0: 6c6f 636b 4461 7461 0a20 2020 2029 202d  lockData.    ) -
-000115d0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-000115e0: 2320 5465 7374 2077 6974 6820 626c 6f63  # Test with bloc
-000115f0: 6b20 7261 6e67 650a 0a20 2020 2020 2020  k range..       
-00011600: 2066 696c 7465 725f 7061 7261 6d73 3a20   filter_params: 
-00011610: 4669 6c74 6572 5061 7261 6d73 203d 207b  FilterParams = {
-00011620: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
-00011630: 6f6d 426c 6f63 6b22 3a20 426c 6f63 6b4e  omBlock": BlockN
-00011640: 756d 6265 7228 3029 2c0a 2020 2020 2020  umber(0),.      
-00011650: 2020 2020 2020 2274 6f42 6c6f 636b 223a        "toBlock":
-00011660: 2042 6c6f 636b 4e75 6d62 6572 2861 7379   BlockNumber(asy
-00011670: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
-00011680: 6e5f 7769 7468 5f6c 6f67 5b22 6e75 6d62  n_with_log["numb
-00011690: 6572 225d 202d 2031 292c 0a20 2020 2020  er"] - 1),.     
-000116a0: 2020 207d 0a20 2020 2020 2020 2072 6573     }.        res
-000116b0: 756c 7420 3d20 6177 6169 7420 6173 796e  ult = await asyn
-000116c0: 635f 7733 2e65 7468 2e67 6574 5f6c 6f67  c_w3.eth.get_log
-000116d0: 7328 6669 6c74 6572 5f70 6172 616d 7329  s(filter_params)
-000116e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000116f0: 6c65 6e28 7265 7375 6c74 2920 3d3d 2030  len(result) == 0
-00011700: 0a0a 2020 2020 2020 2020 2320 7468 6520  ..        # the 
-00011710: 7261 6e67 6520 6973 2077 726f 6e67 0a20  range is wrong. 
-00011720: 2020 2020 2020 2066 696c 7465 725f 7061         filter_pa
-00011730: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-00011740: 2020 2020 2022 6672 6f6d 426c 6f63 6b22       "fromBlock"
-00011750: 3a20 6173 796e 635f 626c 6f63 6b5f 7769  : async_block_wi
-00011760: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
-00011770: 226e 756d 6265 7222 5d2c 0a20 2020 2020  "number"],.     
-00011780: 2020 2020 2020 2022 746f 426c 6f63 6b22         "toBlock"
-00011790: 3a20 426c 6f63 6b4e 756d 6265 7228 6173  : BlockNumber(as
-000117a0: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
-000117b0: 786e 5f77 6974 685f 6c6f 675b 226e 756d  xn_with_log["num
-000117c0: 6265 7222 5d20 2d20 3129 2c0a 2020 2020  ber"] - 1),.    
-000117d0: 2020 2020 7d0a 2020 2020 2020 2020 7769      }.        wi
-000117e0: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-000117f0: 2856 616c 7565 4572 726f 7229 3a0a 2020  (ValueError):.  
-00011800: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00011810: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-00011820: 332e 6574 682e 6765 745f 6c6f 6773 2866  3.eth.get_logs(f
-00011830: 696c 7465 725f 7061 7261 6d73 290a 0a20  ilter_params).. 
-00011840: 2020 2020 2020 2023 2054 6573 7420 7769         # Test wi
-00011850: 7468 2060 6164 6472 6573 7360 0a0a 2020  th `address`..  
-00011860: 2020 2020 2020 2320 6669 6c74 6572 2077        # filter w
-00011870: 6974 6820 6f74 6865 7220 6164 6472 6573  ith other addres
-00011880: 730a 2020 2020 2020 2020 6669 6c74 6572  s.        filter
-00011890: 5f70 6172 616d 7320 3d20 7b0a 2020 2020  _params = {.    
-000118a0: 2020 2020 2020 2020 2266 726f 6d42 6c6f          "fromBlo
-000118b0: 636b 223a 2042 6c6f 636b 4e75 6d62 6572  ck": BlockNumber
-000118c0: 2830 292c 0a20 2020 2020 2020 2020 2020  (0),.           
-000118d0: 2022 6164 6472 6573 7322 3a20 554e 4b4e   "address": UNKN
-000118e0: 4f57 4e5f 4144 4452 4553 532c 0a20 2020  OWN_ADDRESS,.   
-000118f0: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
-00011900: 6573 756c 7420 3d20 6177 6169 7420 6173  esult = await as
-00011910: 796e 635f 7733 2e65 7468 2e67 6574 5f6c  ync_w3.eth.get_l
-00011920: 6f67 7328 6669 6c74 6572 5f70 6172 616d  ogs(filter_param
-00011930: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
-00011940: 7420 6c65 6e28 7265 7375 6c74 2920 3d3d  t len(result) ==
-00011950: 2030 0a0a 2020 2020 2020 2020 2320 5465   0..        # Te
-00011960: 7374 2077 6974 6820 6d75 6c74 6970 6c65  st with multiple
-00011970: 2060 6164 6472 6573 7360 0a0a 2020 2020   `address`..    
-00011980: 2020 2020 2320 6669 6c74 6572 2077 6974      # filter wit
-00011990: 6820 6f74 6865 7220 6164 6472 6573 730a  h other address.
-000119a0: 2020 2020 2020 2020 6669 6c74 6572 5f70          filter_p
-000119b0: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-000119c0: 2020 2020 2020 2266 726f 6d42 6c6f 636b        "fromBlock
-000119d0: 223a 2042 6c6f 636b 4e75 6d62 6572 2830  ": BlockNumber(0
-000119e0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-000119f0: 6164 6472 6573 7322 3a20 5b55 4e4b 4e4f  address": [UNKNO
-00011a00: 574e 5f41 4444 5245 5353 2c20 554e 4b4e  WN_ADDRESS, UNKN
-00011a10: 4f57 4e5f 4144 4452 4553 535d 2c0a 2020  OWN_ADDRESS],.  
-00011a20: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00011a30: 7265 7375 6c74 203d 2061 7761 6974 2061  result = await a
-00011a40: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
-00011a50: 6c6f 6773 2866 696c 7465 725f 7061 7261  logs(filter_para
-00011a60: 6d73 290a 2020 2020 2020 2020 6173 7365  ms).        asse
-00011a70: 7274 206c 656e 2872 6573 756c 7429 203d  rt len(result) =
-00011a80: 3d20 300a 0a20 2020 2040 7079 7465 7374  = 0..    @pytest
-00011a90: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-00011aa0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-00011ab0: 5f61 7379 6e63 5f65 7468 5f67 6574 5f6c  _async_eth_get_l
-00011ac0: 6f67 735f 7769 7468 5f6c 6f67 7328 0a20  ogs_with_logs(. 
-00011ad0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00011ae0: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
-00011af0: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
-00011b00: 2020 2020 6173 796e 635f 626c 6f63 6b5f      async_block_
-00011b10: 7769 7468 5f74 786e 5f77 6974 685f 6c6f  with_txn_with_lo
-00011b20: 673a 2042 6c6f 636b 4461 7461 2c0a 2020  g: BlockData,.  
-00011b30: 2020 2020 2020 6173 796e 635f 656d 6974        async_emit
-00011b40: 7465 725f 636f 6e74 7261 6374 5f61 6464  ter_contract_add
-00011b50: 7265 7373 3a20 4368 6563 6b73 756d 4164  ress: ChecksumAd
-00011b60: 6472 6573 732c 0a20 2020 2020 2020 2074  dress,.        t
-00011b70: 786e 5f68 6173 685f 7769 7468 5f6c 6f67  xn_hash_with_log
-00011b80: 3a20 4865 7853 7472 2c0a 2020 2020 2920  : HexStr,.    ) 
-00011b90: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00011ba0: 2023 2054 6573 7420 7769 7468 2062 6c6f   # Test with blo
-00011bb0: 636b 2072 616e 6765 0a0a 2020 2020 2020  ck range..      
-00011bc0: 2020 2320 7468 6520 7261 6e67 6520 696e    # the range in
-00011bd0: 636c 7564 6573 2074 6865 2062 6c6f 636b  cludes the block
-00011be0: 2077 6865 7265 2074 6865 206c 6f67 2072   where the log r
-00011bf0: 6573 6964 6573 2069 6e0a 2020 2020 2020  esides in.      
-00011c00: 2020 6669 6c74 6572 5f70 6172 616d 733a    filter_params:
-00011c10: 2046 696c 7465 7250 6172 616d 7320 3d20   FilterParams = 
-00011c20: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
-00011c30: 726f 6d42 6c6f 636b 223a 2061 7379 6e63  romBlock": async
-00011c40: 5f62 6c6f 636b 5f77 6974 685f 7478 6e5f  _block_with_txn_
-00011c50: 7769 7468 5f6c 6f67 5b22 6e75 6d62 6572  with_log["number
-00011c60: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-00011c70: 2274 6f42 6c6f 636b 223a 2061 7379 6e63  "toBlock": async
-00011c80: 5f62 6c6f 636b 5f77 6974 685f 7478 6e5f  _block_with_txn_
-00011c90: 7769 7468 5f6c 6f67 5b22 6e75 6d62 6572  with_log["number
-00011ca0: 225d 2c0a 2020 2020 2020 2020 7d0a 2020  "],.        }.  
-00011cb0: 2020 2020 2020 7265 7375 6c74 203d 2061        result = a
-00011cc0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00011cd0: 682e 6765 745f 6c6f 6773 2866 696c 7465  h.get_logs(filte
-00011ce0: 725f 7061 7261 6d73 290a 2020 2020 2020  r_params).      
-00011cf0: 2020 6173 7365 7274 5f63 6f6e 7461 696e    assert_contain
-00011d00: 735f 6c6f 6728 0a20 2020 2020 2020 2020  s_log(.         
-00011d10: 2020 2072 6573 756c 742c 0a20 2020 2020     result,.     
-00011d20: 2020 2020 2020 2061 7379 6e63 5f62 6c6f         async_blo
-00011d30: 636b 5f77 6974 685f 7478 6e5f 7769 7468  ck_with_txn_with
-00011d40: 5f6c 6f67 2c0a 2020 2020 2020 2020 2020  _log,.          
-00011d50: 2020 6173 796e 635f 656d 6974 7465 725f    async_emitter_
-00011d60: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
-00011d70: 2c0a 2020 2020 2020 2020 2020 2020 7478  ,.            tx
-00011d80: 6e5f 6861 7368 5f77 6974 685f 6c6f 672c  n_hash_with_log,
-00011d90: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00011da0: 2020 2020 2320 7370 6563 6966 7920 6f6e      # specify on
-00011db0: 6c79 2060 6672 6f6d 5f62 6c6f 636b 602e  ly `from_block`.
-00011dc0: 2062 7920 6465 6661 756c 7420 6074 6f5f   by default `to_
-00011dd0: 626c 6f63 6b60 2073 686f 756c 6420 6265  block` should be
-00011de0: 2027 6c61 7465 7374 270a 2020 2020 2020   'latest'.      
-00011df0: 2020 6669 6c74 6572 5f70 6172 616d 7320    filter_params 
-00011e00: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00011e10: 2266 726f 6d42 6c6f 636b 223a 2042 6c6f  "fromBlock": Blo
-00011e20: 636b 4e75 6d62 6572 2830 292c 0a20 2020  ckNumber(0),.   
-00011e30: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
-00011e40: 6573 756c 7420 3d20 6177 6169 7420 6173  esult = await as
-00011e50: 796e 635f 7733 2e65 7468 2e67 6574 5f6c  ync_w3.eth.get_l
-00011e60: 6f67 7328 6669 6c74 6572 5f70 6172 616d  ogs(filter_param
-00011e70: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
-00011e80: 745f 636f 6e74 6169 6e73 5f6c 6f67 280a  t_contains_log(.
-00011e90: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00011ea0: 6c74 2c0a 2020 2020 2020 2020 2020 2020  lt,.            
-00011eb0: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
-00011ec0: 5f74 786e 5f77 6974 685f 6c6f 672c 0a20  _txn_with_log,. 
-00011ed0: 2020 2020 2020 2020 2020 2061 7379 6e63             async
-00011ee0: 5f65 6d69 7474 6572 5f63 6f6e 7472 6163  _emitter_contrac
-00011ef0: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
-00011f00: 2020 2020 2020 2074 786e 5f68 6173 685f         txn_hash_
-00011f10: 7769 7468 5f6c 6f67 2c0a 2020 2020 2020  with_log,.      
-00011f20: 2020 290a 0a20 2020 2020 2020 2023 2054    )..        # T
-00011f30: 6573 7420 7769 7468 2060 6164 6472 6573  est with `addres
-00011f40: 7360 0a0a 2020 2020 2020 2020 2320 6669  s`..        # fi
-00011f50: 6c74 6572 2077 6974 6820 656d 6974 7465  lter with emitte
-00011f60: 725f 636f 6e74 7261 6374 2e61 6464 7265  r_contract.addre
-00011f70: 7373 0a20 2020 2020 2020 2066 696c 7465  ss.        filte
-00011f80: 725f 7061 7261 6d73 203d 207b 0a20 2020  r_params = {.   
-00011f90: 2020 2020 2020 2020 2022 6672 6f6d 426c           "fromBl
-00011fa0: 6f63 6b22 3a20 426c 6f63 6b4e 756d 6265  ock": BlockNumbe
-00011fb0: 7228 3029 2c0a 2020 2020 2020 2020 2020  r(0),.          
-00011fc0: 2020 2261 6464 7265 7373 223a 2061 7379    "address": asy
-00011fd0: 6e63 5f65 6d69 7474 6572 5f63 6f6e 7472  nc_emitter_contr
-00011fe0: 6163 745f 6164 6472 6573 732c 0a20 2020  act_address,.   
-00011ff0: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
-00012000: 6573 756c 7420 3d20 6177 6169 7420 6173  esult = await as
-00012010: 796e 635f 7733 2e65 7468 2e67 6574 5f6c  ync_w3.eth.get_l
-00012020: 6f67 7328 6669 6c74 6572 5f70 6172 616d  ogs(filter_param
-00012030: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
-00012040: 745f 636f 6e74 6169 6e73 5f6c 6f67 280a  t_contains_log(.
-00012050: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00012060: 6c74 2c0a 2020 2020 2020 2020 2020 2020  lt,.            
-00012070: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
-00012080: 5f74 786e 5f77 6974 685f 6c6f 672c 0a20  _txn_with_log,. 
-00012090: 2020 2020 2020 2020 2020 2061 7379 6e63             async
-000120a0: 5f65 6d69 7474 6572 5f63 6f6e 7472 6163  _emitter_contrac
-000120b0: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
-000120c0: 2020 2020 2020 2074 786e 5f68 6173 685f         txn_hash_
-000120d0: 7769 7468 5f6c 6f67 2c0a 2020 2020 2020  with_log,.      
-000120e0: 2020 290a 0a20 2020 2040 7079 7465 7374    )..    @pytest
-000120f0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-00012100: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-00012110: 5f61 7379 6e63 5f65 7468 5f67 6574 5f6c  _async_eth_get_l
-00012120: 6f67 735f 7769 7468 5f6c 6f67 735f 746f  ogs_with_logs_to
-00012130: 7069 635f 6172 6773 280a 2020 2020 2020  pic_args(.      
-00012140: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00012150: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-00012160: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
-00012170: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
-00012180: 7478 6e5f 7769 7468 5f6c 6f67 3a20 426c  txn_with_log: Bl
-00012190: 6f63 6b44 6174 612c 0a20 2020 2020 2020  ockData,.       
-000121a0: 2061 7379 6e63 5f65 6d69 7474 6572 5f63   async_emitter_c
-000121b0: 6f6e 7472 6163 745f 6164 6472 6573 733a  ontract_address:
-000121c0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-000121d0: 2c0a 2020 2020 2020 2020 7478 6e5f 6861  ,.        txn_ha
-000121e0: 7368 5f77 6974 685f 6c6f 673a 2048 6578  sh_with_log: Hex
-000121f0: 5374 722c 0a20 2020 2029 202d 3e20 4e6f  Str,.    ) -> No
-00012200: 6e65 3a0a 2020 2020 2020 2020 2320 5465  ne:.        # Te
-00012210: 7374 2077 6974 6820 4e6f 6e65 2065 7665  st with None eve
-00012220: 6e74 2073 6967 0a0a 2020 2020 2020 2020  nt sig..        
-00012230: 6669 6c74 6572 5f70 6172 616d 733a 2046  filter_params: F
-00012240: 696c 7465 7250 6172 616d 7320 3d20 7b0a  ilterParams = {.
-00012250: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-00012260: 6d42 6c6f 636b 223a 2042 6c6f 636b 4e75  mBlock": BlockNu
-00012270: 6d62 6572 2830 292c 0a20 2020 2020 2020  mber(0),.       
-00012280: 2020 2020 2022 746f 7069 6373 223a 205b       "topics": [
-00012290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000122a0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-000122b0: 2020 2020 2020 2048 6578 5374 7228 0a20         HexStr(. 
-000122c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000122d0: 2020 2022 3078 3030 3030 3030 3030 3030     "0x0000000000
+0000e050: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+0000e060: 743a 2043 6865 636b 7375 6d41 6464 7265  t: ChecksumAddre
+0000e070: 7373 2c0a 2020 2020 2020 2020 6d6f 6e6b  ss,.        monk
+0000e080: 6579 7061 7463 683a 2022 4d6f 6e6b 6579  eypatch: "Monkey
+0000e090: 5061 7463 6822 2c0a 2020 2020 2920 2d3e  Patch",.    ) ->
+0000e0a0: 204e 6f6e 653a 0a20 2020 2020 2020 206e   None:.        n
+0000e0b0: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
+0000e0c0: 6374 5f61 6464 7265 7373 203d 2074 6f5f  ct_address = to_
+0000e0d0: 6865 785f 6966 5f62 7974 6573 280a 2020  hex_if_bytes(.  
+0000e0e0: 2020 2020 2020 2020 2020 6173 796e 635f            async_
+0000e0f0: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+0000e100: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
+0000e110: 0a20 2020 2020 2020 2029 2e6c 6f77 6572  .        ).lower
+0000e120: 2829 0a0a 2020 2020 2020 2020 6173 796e  ()..        asyn
+0000e130: 635f 6d6f 636b 5f6f 6666 6368 6169 6e5f  c_mock_offchain_
+0000e140: 6c6f 6f6b 7570 5f72 6571 7565 7374 5f72  lookup_request_r
+0000e150: 6573 706f 6e73 6528 0a20 2020 2020 2020  esponse(.       
+0000e160: 2020 2020 206d 6f6e 6b65 7970 6174 6368       monkeypatch
+0000e170: 2c0a 2020 2020 2020 2020 2020 2020 6d6f  ,.            mo
+0000e180: 636b 6564 5f72 6571 7565 7374 5f75 726c  cked_request_url
+0000e190: 3d66 2268 7474 7073 3a2f 2f77 6562 332e  =f"https://web3.
+0000e1a0: 7079 2f67 6174 6577 6179 2f7b 6e6f 726d  py/gateway/{norm
+0000e1b0: 616c 697a 6564 5f63 6f6e 7472 6163 745f  alized_contract_
+0000e1c0: 6164 6472 6573 737d 2f7b 4f46 4643 4841  address}/{OFFCHA
+0000e1d0: 494e 5f4c 4f4f 4b55 505f 5445 5354 5f44  IN_LOOKUP_TEST_D
+0000e1e0: 4154 417d 2e6a 736f 6e22 2c20 2023 206e  ATA}.json",  # n
+0000e1f0: 6f71 613a 2045 3530 310a 2020 2020 2020  oqa: E501.      
+0000e200: 2020 2020 2020 6d6f 636b 6564 5f6a 736f        mocked_jso
+0000e210: 6e5f 6461 7461 3d57 4542 3350 595f 4153  n_data=WEB3PY_AS
+0000e220: 5f48 4558 4259 5445 532c 0a20 2020 2020  _HEXBYTES,.     
+0000e230: 2020 2029 0a0a 2020 2020 2020 2020 6173     )..        as
+0000e240: 796e 635f 7733 2e70 726f 7669 6465 722e  ync_w3.provider.
+0000e250: 676c 6f62 616c 5f63 6369 705f 7265 6164  global_ccip_read
+0000e260: 5f65 6e61 626c 6564 203d 2046 616c 7365  _enabled = False
+0000e270: 0a0a 2020 2020 2020 2020 7265 7370 6f6e  ..        respon
+0000e280: 7365 203d 2061 7761 6974 2061 7379 6e63  se = await async
+0000e290: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
+0000e2a0: 5f63 6f6e 7472 6163 742e 6675 6e63 7469  _contract.functi
+0000e2b0: 6f6e 732e 7465 7374 4f66 6663 6861 696e  ons.testOffchain
+0000e2c0: 4c6f 6f6b 7570 280a 2020 2020 2020 2020  Lookup(.        
+0000e2d0: 2020 2020 4f46 4643 4841 494e 5f4c 4f4f      OFFCHAIN_LOO
+0000e2e0: 4b55 505f 5445 5354 5f44 4154 410a 2020  KUP_TEST_DATA.  
+0000e2f0: 2020 2020 2020 292e 6361 6c6c 2863 6369        ).call(cci
+0000e300: 705f 7265 6164 5f65 6e61 626c 6564 3d54  p_read_enabled=T
+0000e310: 7275 6529 0a20 2020 2020 2020 2061 7373  rue).        ass
+0000e320: 6572 7420 6173 796e 635f 7733 2e63 6f64  ert async_w3.cod
+0000e330: 6563 2e64 6563 6f64 6528 5b22 7374 7269  ec.decode(["stri
+0000e340: 6e67 225d 2c20 7265 7370 6f6e 7365 295b  ng"], response)[
+0000e350: 305d 203d 3d20 2277 6562 3370 7922 0a0a  0] == "web3py"..
+0000e360: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
+0000e370: 2e70 726f 7669 6465 722e 676c 6f62 616c  .provider.global
+0000e380: 5f63 6369 705f 7265 6164 5f65 6e61 626c  _ccip_read_enabl
+0000e390: 6564 203d 2054 7275 6520 2023 2063 6c65  ed = True  # cle
+0000e3a0: 616e 7570 0a0a 2020 2020 4070 7974 6573  anup..    @pytes
+0000e3b0: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+0000e3c0: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
+0000e3d0: 7061 7261 6d65 7472 697a 6528 226d 6178  parametrize("max
+0000e3e0: 5f72 6564 6972 6563 7473 222c 2072 616e  _redirects", ran
+0000e3f0: 6765 282d 312c 2034 2929 0a20 2020 2061  ge(-1, 4)).    a
+0000e400: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
+0000e410: 685f 6361 6c6c 5f6f 6666 6368 6169 6e5f  h_call_offchain_
+0000e420: 6c6f 6f6b 7570 5f72 6169 7365 735f 6966  lookup_raises_if
+0000e430: 5f6d 6178 5f72 6564 6972 6563 7473 5f69  _max_redirects_i
+0000e440: 735f 6c65 7373 5f74 6861 6e5f 3428 0a20  s_less_than_4(. 
+0000e450: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0000e460: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
+0000e470: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
+0000e480: 2020 2020 6173 796e 635f 6f66 6663 6861      async_offcha
+0000e490: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
+0000e4a0: 6374 3a20 2241 7379 6e63 436f 6e74 7261  ct: "AsyncContra
+0000e4b0: 6374 222c 0a20 2020 2020 2020 206d 6178  ct",.        max
+0000e4c0: 5f72 6564 6972 6563 7473 3a20 696e 742c  _redirects: int,
+0000e4d0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+0000e4e0: 2020 2020 2020 2020 6465 6661 756c 745f          default_
+0000e4f0: 6d61 785f 7265 6469 7265 6374 7320 3d20  max_redirects = 
+0000e500: 6173 796e 635f 7733 2e70 726f 7669 6465  async_w3.provide
+0000e510: 722e 6363 6970 5f72 6561 645f 6d61 785f  r.ccip_read_max_
+0000e520: 7265 6469 7265 6374 730a 0a20 2020 2020  redirects..     
+0000e530: 2020 2061 7379 6e63 5f77 332e 7072 6f76     async_w3.prov
+0000e540: 6964 6572 2e63 6369 705f 7265 6164 5f6d  ider.ccip_read_m
+0000e550: 6178 5f72 6564 6972 6563 7473 203d 206d  ax_redirects = m
+0000e560: 6178 5f72 6564 6972 6563 7473 0a20 2020  ax_redirects.   
+0000e570: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+0000e580: 2e72 6169 7365 7328 5661 6c75 6545 7272  .raises(ValueErr
+0000e590: 6f72 2c20 6d61 7463 683d 2261 7420 6c65  or, match="at le
+0000e5a0: 6173 7420 3422 293a 0a20 2020 2020 2020  ast 4"):.       
+0000e5b0: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
+0000e5c0: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
+0000e5d0: 5f63 6f6e 7472 6163 742e 6361 6c6c 6572  _contract.caller
+0000e5e0: 2829 2e74 6573 744f 6666 6368 6169 6e4c  ().testOffchainL
+0000e5f0: 6f6f 6b75 7028 0a20 2020 2020 2020 2020  ookup(.         
+0000e600: 2020 2020 2020 204f 4646 4348 4149 4e5f         OFFCHAIN_
+0000e610: 4c4f 4f4b 5550 5f54 4553 545f 4441 5441  LOOKUP_TEST_DATA
+0000e620: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000e630: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
+0000e640: 2e70 726f 7669 6465 722e 6363 6970 5f72  .provider.ccip_r
+0000e650: 6561 645f 6d61 785f 7265 6469 7265 6374  ead_max_redirect
+0000e660: 7320 3d20 6465 6661 756c 745f 6d61 785f  s = default_max_
+0000e670: 7265 6469 7265 6374 7320 2023 2063 6c65  redirects  # cle
+0000e680: 616e 7570 0a0a 2020 2020 4070 7974 6573  anup..    @pytes
+0000e690: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+0000e6a0: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+0000e6b0: 745f 6574 685f 6361 6c6c 5f6f 6666 6368  t_eth_call_offch
+0000e6c0: 6169 6e5f 6c6f 6f6b 7570 5f72 6169 7365  ain_lookup_raise
+0000e6d0: 735f 666f 725f 696d 7072 6f70 6572 6c79  s_for_improperly
+0000e6e0: 5f66 6f72 6d61 7474 6564 5f72 6573 745f  _formatted_rest_
+0000e6f0: 7265 7175 6573 745f 7265 7370 6f6e 7365  request_response
+0000e700: 2820 2023 206e 6f71 613a 2045 3530 310a  (  # noqa: E501.
+0000e710: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000e720: 2020 2020 2020 6173 796e 635f 7733 3a20        async_w3: 
+0000e730: 2241 7379 6e63 5765 6233 222c 0a20 2020  "AsyncWeb3",.   
+0000e740: 2020 2020 2061 7379 6e63 5f6f 6666 6368       async_offch
+0000e750: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
+0000e760: 6163 743a 2022 4173 796e 6343 6f6e 7472  act: "AsyncContr
+0000e770: 6163 7422 2c0a 2020 2020 2020 2020 6173  act",.        as
+0000e780: 796e 635f 756e 6c6f 636b 6564 5f61 6363  ync_unlocked_acc
+0000e790: 6f75 6e74 3a20 4368 6563 6b73 756d 4164  ount: ChecksumAd
+0000e7a0: 6472 6573 732c 0a20 2020 2020 2020 206d  dress,.        m
+0000e7b0: 6f6e 6b65 7970 6174 6368 3a20 224d 6f6e  onkeypatch: "Mon
+0000e7c0: 6b65 7950 6174 6368 222c 0a20 2020 2029  keyPatch",.    )
+0000e7d0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0000e7e0: 2020 6e6f 726d 616c 697a 6564 5f63 6f6e    normalized_con
+0000e7f0: 7472 6163 745f 6164 6472 6573 7320 3d20  tract_address = 
+0000e800: 746f 5f68 6578 5f69 665f 6279 7465 7328  to_hex_if_bytes(
+0000e810: 0a20 2020 2020 2020 2020 2020 2061 7379  .            asy
+0000e820: 6e63 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  nc_offchain_look
+0000e830: 7570 5f63 6f6e 7472 6163 742e 6164 6472  up_contract.addr
+0000e840: 6573 730a 2020 2020 2020 2020 292e 6c6f  ess.        ).lo
+0000e850: 7765 7228 290a 0a20 2020 2020 2020 2061  wer()..        a
+0000e860: 7379 6e63 5f6d 6f63 6b5f 6f66 6663 6861  sync_mock_offcha
+0000e870: 696e 5f6c 6f6f 6b75 705f 7265 7175 6573  in_lookup_reques
+0000e880: 745f 7265 7370 6f6e 7365 280a 2020 2020  t_response(.    
+0000e890: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
+0000e8a0: 7463 682c 0a20 2020 2020 2020 2020 2020  tch,.           
+0000e8b0: 206d 6f63 6b65 645f 7265 7175 6573 745f   mocked_request_
+0000e8c0: 7572 6c3d 6622 6874 7470 733a 2f2f 7765  url=f"https://we
+0000e8d0: 6233 2e70 792f 6761 7465 7761 792f 7b6e  b3.py/gateway/{n
+0000e8e0: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
+0000e8f0: 6374 5f61 6464 7265 7373 7d2f 7b4f 4646  ct_address}/{OFF
+0000e900: 4348 4149 4e5f 4c4f 4f4b 5550 5f54 4553  CHAIN_LOOKUP_TES
+0000e910: 545f 4441 5441 7d2e 6a73 6f6e 222c 2020  T_DATA}.json",  
+0000e920: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
+0000e930: 2020 2020 2020 2020 206d 6f63 6b65 645f           mocked_
+0000e940: 6a73 6f6e 5f64 6174 613d 5745 4233 5059  json_data=WEB3PY
+0000e950: 5f41 535f 4845 5842 5954 4553 2c0a 2020  _AS_HEXBYTES,.  
+0000e960: 2020 2020 2020 2020 2020 6a73 6f6e 5f64            json_d
+0000e970: 6174 615f 6669 656c 643d 226e 6f74 5f64  ata_field="not_d
+0000e980: 6174 6122 2c0a 2020 2020 2020 2020 290a  ata",.        ).
+0000e990: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+0000e9a0: 6573 742e 7261 6973 6573 2857 6562 3356  est.raises(Web3V
+0000e9b0: 616c 6964 6174 696f 6e45 7272 6f72 2c20  alidationError, 
+0000e9c0: 6d61 7463 683d 226d 6973 7369 6e67 2027  match="missing '
+0000e9d0: 6461 7461 2720 6669 656c 6422 293a 0a20  data' field"):. 
+0000e9e0: 2020 2020 2020 2020 2020 2061 7761 6974             await
+0000e9f0: 2061 7379 6e63 5f6f 6666 6368 6169 6e5f   async_offchain_
+0000ea00: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
+0000ea10: 6361 6c6c 6572 2829 2e74 6573 744f 6666  caller().testOff
+0000ea20: 6368 6169 6e4c 6f6f 6b75 7028 0a20 2020  chainLookup(.   
+0000ea30: 2020 2020 2020 2020 2020 2020 204f 4646               OFF
+0000ea40: 4348 4149 4e5f 4c4f 4f4b 5550 5f54 4553  CHAIN_LOOKUP_TES
+0000ea50: 545f 4441 5441 0a20 2020 2020 2020 2020  T_DATA.         
+0000ea60: 2020 2029 0a0a 2020 2020 4070 7974 6573     )..    @pytes
+0000ea70: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+0000ea80: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
+0000ea90: 7061 7261 6d65 7472 697a 6528 2273 7461  parametrize("sta
+0000eaa0: 7475 735f 636f 6465 5f6e 6f6e 5f34 7878  tus_code_non_4xx
+0000eab0: 5f65 7272 6f72 222c 205b 3130 302c 2033  _error", [100, 3
+0000eac0: 3030 2c20 3530 302c 2036 3030 5d29 0a20  00, 500, 600]). 
+0000ead0: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+0000eae0: 745f 6574 685f 6361 6c6c 5f6f 6666 6368  t_eth_call_offch
+0000eaf0: 6169 6e5f 6c6f 6f6b 7570 5f74 7269 6573  ain_lookup_tries
+0000eb00: 5f6e 6578 745f 7572 6c5f 666f 725f 6e6f  _next_url_for_no
+0000eb10: 6e5f 3478 785f 6572 726f 725f 7374 6174  n_4xx_error_stat
+0000eb20: 7573 5f61 6e64 5f74 6573 7473 5f50 4f53  us_and_tests_POS
+0000eb30: 5428 2020 2320 6e6f 7161 3a20 4535 3031  T(  # noqa: E501
+0000eb40: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000eb50: 2020 2020 2020 2061 7379 6e63 5f77 333a         async_w3:
+0000eb60: 2022 4173 796e 6357 6562 3322 2c0a 2020   "AsyncWeb3",.  
+0000eb70: 2020 2020 2020 6173 796e 635f 6f66 6663        async_offc
+0000eb80: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
+0000eb90: 7261 6374 3a20 2241 7379 6e63 436f 6e74  ract: "AsyncCont
+0000eba0: 7261 6374 222c 0a20 2020 2020 2020 2061  ract",.        a
+0000ebb0: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+0000ebc0: 636f 756e 743a 2043 6865 636b 7375 6d41  count: ChecksumA
+0000ebd0: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+0000ebe0: 6d6f 6e6b 6579 7061 7463 683a 2022 4d6f  monkeypatch: "Mo
+0000ebf0: 6e6b 6579 5061 7463 6822 2c0a 2020 2020  nkeyPatch",.    
+0000ec00: 2020 2020 7374 6174 7573 5f63 6f64 655f      status_code_
+0000ec10: 6e6f 6e5f 3478 785f 6572 726f 723a 2069  non_4xx_error: i
+0000ec20: 6e74 2c0a 2020 2020 2920 2d3e 204e 6f6e  nt,.    ) -> Non
+0000ec30: 653a 0a20 2020 2020 2020 206e 6f72 6d61  e:.        norma
+0000ec40: 6c69 7a65 645f 636f 6e74 7261 6374 5f61  lized_contract_a
+0000ec50: 6464 7265 7373 203d 2074 6f5f 6865 785f  ddress = to_hex_
+0000ec60: 6966 5f62 7974 6573 280a 2020 2020 2020  if_bytes(.      
+0000ec70: 2020 2020 2020 6173 796e 635f 6f66 6663        async_offc
+0000ec80: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
+0000ec90: 7261 6374 2e61 6464 7265 7373 0a20 2020  ract.address.   
+0000eca0: 2020 2020 2029 2e6c 6f77 6572 2829 0a0a       ).lower()..
+0000ecb0: 2020 2020 2020 2020 2320 5468 6520 6e65          # The ne
+0000ecc0: 7874 2075 726c 2069 6e20 6f75 7220 7465  xt url in our te
+0000ecd0: 7374 2063 6f6e 7472 6163 7420 646f 6573  st contract does
+0000ece0: 6e27 7420 636f 6e74 6169 6e20 277b 6461  n't contain '{da
+0000ecf0: 7461 7d27 2c20 7472 6967 6765 7269 6e67  ta}', triggering
+0000ed00: 0a20 2020 2020 2020 2023 2074 6865 2050  .        # the P
+0000ed10: 4f53 5420 7265 7175 6573 7420 6c6f 6769  OST request logi
+0000ed20: 632e 2054 6865 2069 6465 6120 6865 7265  c. The idea here
+0000ed30: 2069 7320 746f 2072 6574 7572 6e20 6120   is to return a 
+0000ed40: 6261 6420 7374 6174 7573 2066 6f72 2074  bad status for t
+0000ed50: 6865 0a20 2020 2020 2020 2023 2066 6972  he.        # fir
+0000ed60: 7374 2075 726c 2028 4745 5429 2061 6e64  st url (GET) and
+0000ed70: 2061 2073 7563 6365 7373 2073 7461 7475   a success statu
+0000ed80: 7320 666f 7220 7468 6520 7365 636f 6e64  s for the second
+0000ed90: 2063 616c 6c20 2850 4f53 5429 2074 6f20   call (POST) to 
+0000eda0: 7465 7374 0a20 2020 2020 2020 2023 2062  test.        # b
+0000edb0: 6f74 6820 7468 6174 2077 6520 6d6f 7665  oth that we move
+0000edc0: 206f 6e20 746f 2074 6865 206e 6578 7420   on to the next 
+0000edd0: 7572 6c20 7769 7468 206e 6f6e 2d34 7878  url with non-4xx
+0000ede0: 2073 7461 7475 7320 616e 6420 7468 6174   status and that
+0000edf0: 2074 6865 0a20 2020 2020 2020 2023 2050   the.        # P
+0000ee00: 4f53 5420 6c6f 6769 6320 6973 2061 6c73  OST logic is als
+0000ee10: 6f20 776f 726b 696e 6720 6173 2065 7870  o working as exp
+0000ee20: 6563 7465 642e 0a20 2020 2020 2020 2061  ected..        a
+0000ee30: 7379 6e63 5f6d 6f63 6b5f 6f66 6663 6861  sync_mock_offcha
+0000ee40: 696e 5f6c 6f6f 6b75 705f 7265 7175 6573  in_lookup_reques
+0000ee50: 745f 7265 7370 6f6e 7365 280a 2020 2020  t_response(.    
+0000ee60: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
+0000ee70: 7463 682c 0a20 2020 2020 2020 2020 2020  tch,.           
+0000ee80: 206d 6f63 6b65 645f 7265 7175 6573 745f   mocked_request_
+0000ee90: 7572 6c3d 6622 6874 7470 733a 2f2f 7765  url=f"https://we
+0000eea0: 6233 2e70 792f 6761 7465 7761 792f 7b6e  b3.py/gateway/{n
+0000eeb0: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
+0000eec0: 6374 5f61 6464 7265 7373 7d2f 7b4f 4646  ct_address}/{OFF
+0000eed0: 4348 4149 4e5f 4c4f 4f4b 5550 5f54 4553  CHAIN_LOOKUP_TES
+0000eee0: 545f 4441 5441 7d2e 6a73 6f6e 222c 2020  T_DATA}.json",  
+0000eef0: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
+0000ef00: 2020 2020 2020 2020 206d 6f63 6b65 645f           mocked_
+0000ef10: 7374 6174 7573 5f63 6f64 653d 7374 6174  status_code=stat
+0000ef20: 7573 5f63 6f64 655f 6e6f 6e5f 3478 785f  us_code_non_4xx_
+0000ef30: 6572 726f 722c 0a20 2020 2020 2020 2020  error,.         
+0000ef40: 2020 206d 6f63 6b65 645f 6a73 6f6e 5f64     mocked_json_d
+0000ef50: 6174 613d 5745 4233 5059 5f41 535f 4845  ata=WEB3PY_AS_HE
+0000ef60: 5842 5954 4553 2c0a 2020 2020 2020 2020  XBYTES,.        
+0000ef70: 290a 2020 2020 2020 2020 6173 796e 635f  ).        async_
+0000ef80: 6d6f 636b 5f6f 6666 6368 6169 6e5f 6c6f  mock_offchain_lo
+0000ef90: 6f6b 7570 5f72 6571 7565 7374 5f72 6573  okup_request_res
+0000efa0: 706f 6e73 6528 0a20 2020 2020 2020 2020  ponse(.         
+0000efb0: 2020 206d 6f6e 6b65 7970 6174 6368 2c0a     monkeypatch,.
+0000efc0: 2020 2020 2020 2020 2020 2020 6874 7470              http
+0000efd0: 5f6d 6574 686f 643d 2250 4f53 5422 2c0a  _method="POST",.
+0000efe0: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+0000eff0: 6564 5f72 6571 7565 7374 5f75 726c 3d66  ed_request_url=f
+0000f000: 2268 7474 7073 3a2f 2f77 6562 332e 7079  "https://web3.py
+0000f010: 2f67 6174 6577 6179 2f7b 6e6f 726d 616c  /gateway/{normal
+0000f020: 697a 6564 5f63 6f6e 7472 6163 745f 6164  ized_contract_ad
+0000f030: 6472 6573 737d 2e6a 736f 6e22 2c20 2023  dress}.json",  #
+0000f040: 206e 6f71 613a 2045 3530 310a 2020 2020   noqa: E501.    
+0000f050: 2020 2020 2020 2020 6d6f 636b 6564 5f73          mocked_s
+0000f060: 7461 7475 735f 636f 6465 3d32 3030 2c0a  tatus_code=200,.
+0000f070: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+0000f080: 6564 5f6a 736f 6e5f 6461 7461 3d57 4542  ed_json_data=WEB
+0000f090: 3350 595f 4153 5f48 4558 4259 5445 532c  3PY_AS_HEXBYTES,
+0000f0a0: 0a20 2020 2020 2020 2020 2020 2073 656e  .            sen
+0000f0b0: 6465 723d 6e6f 726d 616c 697a 6564 5f63  der=normalized_c
+0000f0c0: 6f6e 7472 6163 745f 6164 6472 6573 732c  ontract_address,
+0000f0d0: 0a20 2020 2020 2020 2020 2020 2063 616c  .            cal
+0000f0e0: 6c64 6174 613d 4f46 4643 4841 494e 5f4c  ldata=OFFCHAIN_L
+0000f0f0: 4f4f 4b55 505f 5445 5354 5f44 4154 412c  OOKUP_TEST_DATA,
+0000f100: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0000f110: 2020 2072 6573 706f 6e73 6520 3d20 6177     response = aw
+0000f120: 6169 7420 6173 796e 635f 6f66 6663 6861  ait async_offcha
+0000f130: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
+0000f140: 6374 2e63 616c 6c65 7228 292e 7465 7374  ct.caller().test
+0000f150: 4f66 6663 6861 696e 4c6f 6f6b 7570 280a  OffchainLookup(.
+0000f160: 2020 2020 2020 2020 2020 2020 4f46 4643              OFFC
+0000f170: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
+0000f180: 5f44 4154 410a 2020 2020 2020 2020 290a  _DATA.        ).
+0000f190: 2020 2020 2020 2020 6173 7365 7274 2061          assert a
+0000f1a0: 7379 6e63 5f77 332e 636f 6465 632e 6465  sync_w3.codec.de
+0000f1b0: 636f 6465 285b 2273 7472 696e 6722 5d2c  code(["string"],
+0000f1c0: 2072 6573 706f 6e73 6529 5b30 5d20 3d3d   response)[0] ==
+0000f1d0: 2022 7765 6233 7079 220a 0a20 2020 2040   "web3py"..    @
+0000f1e0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+0000f1f0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+0000f200: 6620 7465 7374 5f65 7468 5f63 616c 6c5f  f test_eth_call_
+0000f210: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+0000f220: 6361 6c6c 735f 7261 6973 655f 666f 725f  calls_raise_for_
+0000f230: 7374 6174 7573 5f66 6f72 5f34 7878 5f73  status_for_4xx_s
+0000f240: 7461 7475 735f 636f 6465 280a 2020 2020  tatus_code(.    
+0000f250: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000f260: 2020 6173 796e 635f 7733 3a20 2241 7379    async_w3: "Asy
+0000f270: 6e63 5765 6233 222c 0a20 2020 2020 2020  ncWeb3",.       
+0000f280: 2061 7379 6e63 5f6f 6666 6368 6169 6e5f   async_offchain_
+0000f290: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 743a  lookup_contract:
+0000f2a0: 2022 4173 796e 6343 6f6e 7472 6163 7422   "AsyncContract"
+0000f2b0: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+0000f2c0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+0000f2d0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+0000f2e0: 732c 0a20 2020 2020 2020 206d 6f6e 6b65  s,.        monke
+0000f2f0: 7970 6174 6368 3a20 224d 6f6e 6b65 7950  ypatch: "MonkeyP
+0000f300: 6174 6368 222c 0a20 2020 2029 202d 3e20  atch",.    ) -> 
+0000f310: 4e6f 6e65 3a0a 2020 2020 2020 2020 6e6f  None:.        no
+0000f320: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
+0000f330: 745f 6164 6472 6573 7320 3d20 746f 5f68  t_address = to_h
+0000f340: 6578 5f69 665f 6279 7465 7328 0a20 2020  ex_if_bytes(.   
+0000f350: 2020 2020 2020 2020 2061 7379 6e63 5f6f           async_o
+0000f360: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
+0000f370: 6f6e 7472 6163 742e 6164 6472 6573 730a  ontract.address.
+0000f380: 2020 2020 2020 2020 292e 6c6f 7765 7228          ).lower(
+0000f390: 290a 0a20 2020 2020 2020 2061 7379 6e63  )..        async
+0000f3a0: 5f6d 6f63 6b5f 6f66 6663 6861 696e 5f6c  _mock_offchain_l
+0000f3b0: 6f6f 6b75 705f 7265 7175 6573 745f 7265  ookup_request_re
+0000f3c0: 7370 6f6e 7365 280a 2020 2020 2020 2020  sponse(.        
+0000f3d0: 2020 2020 6d6f 6e6b 6579 7061 7463 682c      monkeypatch,
+0000f3e0: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
+0000f3f0: 6b65 645f 7265 7175 6573 745f 7572 6c3d  ked_request_url=
+0000f400: 6622 6874 7470 733a 2f2f 7765 6233 2e70  f"https://web3.p
+0000f410: 792f 6761 7465 7761 792f 7b6e 6f72 6d61  y/gateway/{norma
+0000f420: 6c69 7a65 645f 636f 6e74 7261 6374 5f61  lized_contract_a
+0000f430: 6464 7265 7373 7d2f 7b4f 4646 4348 4149  ddress}/{OFFCHAI
+0000f440: 4e5f 4c4f 4f4b 5550 5f54 4553 545f 4441  N_LOOKUP_TEST_DA
+0000f450: 5441 7d2e 6a73 6f6e 222c 2020 2320 6e6f  TA}.json",  # no
+0000f460: 7161 3a20 4535 3031 0a20 2020 2020 2020  qa: E501.       
+0000f470: 2020 2020 206d 6f63 6b65 645f 7374 6174       mocked_stat
+0000f480: 7573 5f63 6f64 653d 7261 6e64 696e 7428  us_code=randint(
+0000f490: 3430 302c 2034 3939 292c 0a20 2020 2020  400, 499),.     
+0000f4a0: 2020 2020 2020 206d 6f63 6b65 645f 6a73         mocked_js
+0000f4b0: 6f6e 5f64 6174 613d 5745 4233 5059 5f41  on_data=WEB3PY_A
+0000f4c0: 535f 4845 5842 5954 4553 2c0a 2020 2020  S_HEXBYTES,.    
+0000f4d0: 2020 2020 290a 2020 2020 2020 2020 7769      ).        wi
+0000f4e0: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+0000f4f0: 2845 7863 6570 7469 6f6e 2c20 6d61 7463  (Exception, matc
+0000f500: 683d 2263 616c 6c65 6420 7261 6973 655f  h="called raise_
+0000f510: 666f 725f 7374 6174 7573 5c5c 285c 5c29  for_status\\(\\)
+0000f520: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+0000f530: 6177 6169 7420 6173 796e 635f 6f66 6663  await async_offc
+0000f540: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
+0000f550: 7261 6374 2e63 616c 6c65 7228 292e 7465  ract.caller().te
+0000f560: 7374 4f66 6663 6861 696e 4c6f 6f6b 7570  stOffchainLookup
+0000f570: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000f580: 2020 4f46 4643 4841 494e 5f4c 4f4f 4b55    OFFCHAIN_LOOKU
+0000f590: 505f 5445 5354 5f44 4154 410a 2020 2020  P_TEST_DATA.    
+0000f5a0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+0000f5b0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+0000f5c0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+0000f5d0: 6620 7465 7374 5f65 7468 5f63 616c 6c5f  f test_eth_call_
+0000f5e0: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+0000f5f0: 7261 6973 6573 5f77 6865 6e5f 616c 6c5f  raises_when_all_
+0000f600: 7375 7070 6c69 6564 5f75 726c 735f 6661  supplied_urls_fa
+0000f610: 696c 280a 2020 2020 2020 2020 7365 6c66  il(.        self
+0000f620: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+0000f630: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+0000f640: 0a20 2020 2020 2020 2061 7379 6e63 5f6f  .        async_o
+0000f650: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
+0000f660: 6f6e 7472 6163 743a 2022 4173 796e 6343  ontract: "AsyncC
+0000f670: 6f6e 7472 6163 7422 2c0a 2020 2020 2920  ontract",.    ) 
+0000f680: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000f690: 2023 2047 4554 2061 6e64 2050 4f53 5420   # GET and POST 
+0000f6a0: 7265 7175 6573 7473 2073 686f 756c 6420  requests should 
+0000f6b0: 6661 696c 2073 696e 6365 2072 6573 706f  fail since respo
+0000f6c0: 6e73 6573 2061 7265 206e 6f74 206d 6f63  nses are not moc
+0000f6d0: 6b65 640a 2020 2020 2020 2020 7769 7468  ked.        with
+0000f6e0: 2070 7974 6573 742e 7261 6973 6573 280a   pytest.raises(.
+0000f6f0: 2020 2020 2020 2020 2020 2020 4d75 6c74              Mult
+0000f700: 6970 6c65 4661 696c 6564 5265 7175 6573  ipleFailedReques
+0000f710: 7473 2c20 6d61 7463 683d 224f 6666 6368  ts, match="Offch
+0000f720: 6169 6e20 6c6f 6f6b 7570 2066 6169 6c65  ain lookup faile
+0000f730: 6420 666f 7220 7375 7070 6c69 6564 2075  d for supplied u
+0000f740: 726c 7322 0a20 2020 2020 2020 2029 3a0a  rls".        ):.
+0000f750: 2020 2020 2020 2020 2020 2020 6177 6169              awai
+0000f760: 7420 6173 796e 635f 6f66 6663 6861 696e  t async_offchain
+0000f770: 5f6c 6f6f 6b75 705f 636f 6e74 7261 6374  _lookup_contract
+0000f780: 2e63 616c 6c65 7228 292e 7465 7374 4f66  .caller().testOf
+0000f790: 6663 6861 696e 4c6f 6f6b 7570 280a 2020  fchainLookup(.  
+0000f7a0: 2020 2020 2020 2020 2020 2020 2020 4f46                OF
+0000f7b0: 4643 4841 494e 5f4c 4f4f 4b55 505f 5445  FCHAIN_LOOKUP_TE
+0000f7c0: 5354 5f44 4154 410a 2020 2020 2020 2020  ST_DATA.        
+0000f7d0: 2020 2020 290a 0a20 2020 2040 7079 7465      )..    @pyte
+0000f7e0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+0000f7f0: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+0000f800: 7374 5f65 7468 5f63 616c 6c5f 636f 6e74  st_eth_call_cont
+0000f810: 696e 756f 7573 5f6f 6666 6368 6169 6e5f  inuous_offchain_
+0000f820: 6c6f 6f6b 7570 5f72 6169 7365 735f 7769  lookup_raises_wi
+0000f830: 7468 5f74 6f6f 5f6d 616e 795f 7265 7175  th_too_many_requ
+0000f840: 6573 7473 280a 2020 2020 2020 2020 7365  ests(.        se
+0000f850: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
+0000f860: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+0000f870: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
+0000f880: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
+0000f890: 5f63 6f6e 7472 6163 743a 2022 4173 796e  _contract: "Asyn
+0000f8a0: 6343 6f6e 7472 6163 7422 2c0a 2020 2020  cContract",.    
+0000f8b0: 2020 2020 6173 796e 635f 756e 6c6f 636b      async_unlock
+0000f8c0: 6564 5f61 6363 6f75 6e74 3a20 4368 6563  ed_account: Chec
+0000f8d0: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
+0000f8e0: 2020 2020 206d 6f6e 6b65 7970 6174 6368       monkeypatch
+0000f8f0: 3a20 224d 6f6e 6b65 7950 6174 6368 222c  : "MonkeyPatch",
+0000f900: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+0000f910: 2020 2020 2020 2020 6e6f 726d 616c 697a          normaliz
+0000f920: 6564 5f63 6f6e 7472 6163 745f 6164 6472  ed_contract_addr
+0000f930: 6573 7320 3d20 746f 5f68 6578 5f69 665f  ess = to_hex_if_
+0000f940: 6279 7465 7328 0a20 2020 2020 2020 2020  bytes(.         
+0000f950: 2020 2061 7379 6e63 5f6f 6666 6368 6169     async_offchai
+0000f960: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
+0000f970: 742e 6164 6472 6573 730a 2020 2020 2020  t.address.      
+0000f980: 2020 292e 6c6f 7765 7228 290a 0a20 2020    ).lower()..   
+0000f990: 2020 2020 2061 7379 6e63 5f6d 6f63 6b5f       async_mock_
+0000f9a0: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+0000f9b0: 7265 7175 6573 745f 7265 7370 6f6e 7365  request_response
+0000f9c0: 280a 2020 2020 2020 2020 2020 2020 6d6f  (.            mo
+0000f9d0: 6e6b 6579 7061 7463 682c 0a20 2020 2020  nkeypatch,.     
+0000f9e0: 2020 2020 2020 206d 6f63 6b65 645f 7265         mocked_re
+0000f9f0: 7175 6573 745f 7572 6c3d 6622 6874 7470  quest_url=f"http
+0000fa00: 733a 2f2f 7765 6233 2e70 792f 6761 7465  s://web3.py/gate
+0000fa10: 7761 792f 7b6e 6f72 6d61 6c69 7a65 645f  way/{normalized_
+0000fa20: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
+0000fa30: 7d2f 3078 2e6a 736f 6e22 2c20 2023 206e  }/0x.json",  # n
+0000fa40: 6f71 613a 2045 3530 310a 2020 2020 2020  oqa: E501.      
+0000fa50: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
+0000fa60: 2070 7974 6573 742e 7261 6973 6573 2854   pytest.raises(T
+0000fa70: 6f6f 4d61 6e79 5265 7175 6573 7473 2c20  ooManyRequests, 
+0000fa80: 6d61 7463 683d 2254 6f6f 206d 616e 7920  match="Too many 
+0000fa90: 4343 4950 2072 6561 6420 7265 6469 7265  CCIP read redire
+0000faa0: 6374 7322 293a 0a20 2020 2020 2020 2020  cts"):.         
+0000fab0: 2020 2061 7761 6974 2061 7379 6e63 5f6f     await async_o
+0000fac0: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
+0000fad0: 6f6e 7472 6163 742e 6361 6c6c 6572 2829  ontract.caller()
+0000fae0: 2e63 6f6e 7469 6e75 6f75 734f 6666 6368  .continuousOffch
+0000faf0: 6169 6e4c 6f6f 6b75 7028 2920 2023 206e  ainLookup()  # n
+0000fb00: 6f71 613a 2045 3530 3120 7479 7065 3a20  oqa: E501 type: 
+0000fb10: 6967 6e6f 7265 0a0a 2020 2020 4070 7974  ignore..    @pyt
+0000fb20: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+0000fb30: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+0000fb40: 6573 745f 6173 796e 635f 6574 685f 6861  est_async_eth_ha
+0000fb50: 7368 7261 7465 2873 656c 662c 2061 7379  shrate(self, asy
+0000fb60: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
+0000fb70: 3322 2920 2d3e 204e 6f6e 653a 0a20 2020  3") -> None:.   
+0000fb80: 2020 2020 2068 6173 6872 6174 6520 3d20       hashrate = 
+0000fb90: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+0000fba0: 7468 2e68 6173 6872 6174 650a 2020 2020  th.hashrate.    
+0000fbb0: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
+0000fbc0: 7465 6765 7228 6861 7368 7261 7465 290a  teger(hashrate).
+0000fbd0: 2020 2020 2020 2020 6173 7365 7274 2068          assert h
+0000fbe0: 6173 6872 6174 6520 3e3d 2030 0a0a 2020  ashrate >= 0..  
+0000fbf0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+0000fc00: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+0000fc10: 2064 6566 2074 6573 745f 6173 796e 635f   def test_async_
+0000fc20: 6574 685f 6368 6169 6e5f 6964 2873 656c  eth_chain_id(sel
+0000fc30: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
+0000fc40: 796e 6357 6562 3322 2920 2d3e 204e 6f6e  yncWeb3") -> Non
+0000fc50: 653a 0a20 2020 2020 2020 2063 6861 696e  e:.        chain
+0000fc60: 5f69 6420 3d20 6177 6169 7420 6173 796e  _id = await asyn
+0000fc70: 635f 7733 2e65 7468 2e63 6861 696e 5f69  c_w3.eth.chain_i
+0000fc80: 640a 2020 2020 2020 2020 2320 6368 6169  d.        # chai
+0000fc90: 6e20 6964 2076 616c 7565 2066 726f 6d20  n id value from 
+0000fca0: 6765 7468 2066 6978 7475 7265 2067 656e  geth fixture gen
+0000fcb0: 6573 6973 2066 696c 650a 2020 2020 2020  esis file.      
+0000fcc0: 2020 6173 7365 7274 2063 6861 696e 5f69    assert chain_i
+0000fcd0: 6420 3d3d 2031 3331 3237 3733 3232 3934  d == 13127732294
+0000fce0: 3035 3337 0a0a 2020 2020 4070 7974 6573  0537..    @pytes
+0000fcf0: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+0000fd00: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+0000fd10: 745f 6173 796e 635f 6574 685f 6d69 6e69  t_async_eth_mini
+0000fd20: 6e67 2873 656c 662c 2061 7379 6e63 5f77  ng(self, async_w
+0000fd30: 333a 2022 4173 796e 6357 6562 3322 2920  3: "AsyncWeb3") 
+0000fd40: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000fd50: 206d 696e 696e 6720 3d20 6177 6169 7420   mining = await 
+0000fd60: 6173 796e 635f 7733 2e65 7468 2e6d 696e  async_w3.eth.min
+0000fd70: 696e 670a 2020 2020 2020 2020 6173 7365  ing.        asse
+0000fd80: 7274 2069 735f 626f 6f6c 6561 6e28 6d69  rt is_boolean(mi
+0000fd90: 6e69 6e67 290a 0a20 2020 2040 7079 7465  ning)..    @pyte
+0000fda0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+0000fdb0: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+0000fdc0: 7374 5f61 7379 6e63 5f65 7468 5f67 6574  st_async_eth_get
+0000fdd0: 5f74 7261 6e73 6163 7469 6f6e 5f72 6563  _transaction_rec
+0000fde0: 6569 7074 5f6d 696e 6564 280a 2020 2020  eipt_mined(.    
+0000fdf0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000fe00: 2020 6173 796e 635f 7733 3a20 2241 7379    async_w3: "Asy
+0000fe10: 6e63 5765 6233 222c 0a20 2020 2020 2020  ncWeb3",.       
+0000fe20: 2061 7379 6e63 5f62 6c6f 636b 5f77 6974   async_block_wit
+0000fe30: 685f 7478 6e3a 2042 6c6f 636b 4461 7461  h_txn: BlockData
+0000fe40: 2c0a 2020 2020 2020 2020 6d69 6e65 645f  ,.        mined_
+0000fe50: 7478 6e5f 6861 7368 3a20 4865 7853 7472  txn_hash: HexStr
+0000fe60: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+0000fe70: 0a20 2020 2020 2020 2072 6563 6569 7074  .        receipt
+0000fe80: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+0000fe90: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
+0000fea0: 6374 696f 6e5f 7265 6365 6970 7428 6d69  ction_receipt(mi
+0000feb0: 6e65 645f 7478 6e5f 6861 7368 290a 2020  ned_txn_hash).  
+0000fec0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+0000fed0: 6469 6374 2872 6563 6569 7074 290a 2020  dict(receipt).  
+0000fee0: 2020 2020 2020 6173 7365 7274 2072 6563        assert rec
+0000fef0: 6569 7074 5b22 626c 6f63 6b4e 756d 6265  eipt["blockNumbe
+0000ff00: 7222 5d20 3d3d 2061 7379 6e63 5f62 6c6f  r"] == async_blo
+0000ff10: 636b 5f77 6974 685f 7478 6e5b 226e 756d  ck_with_txn["num
+0000ff20: 6265 7222 5d0a 2020 2020 2020 2020 6173  ber"].        as
+0000ff30: 7365 7274 2072 6563 6569 7074 5b22 626c  sert receipt["bl
+0000ff40: 6f63 6b48 6173 6822 5d20 3d3d 2061 7379  ockHash"] == asy
+0000ff50: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
+0000ff60: 6e5b 2268 6173 6822 5d0a 2020 2020 2020  n["hash"].      
+0000ff70: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
+0000ff80: 5b22 7472 616e 7361 6374 696f 6e49 6e64  ["transactionInd
+0000ff90: 6578 225d 203d 3d20 300a 2020 2020 2020  ex"] == 0.      
+0000ffa0: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
+0000ffb0: 5b22 7472 616e 7361 6374 696f 6e48 6173  ["transactionHas
+0000ffc0: 6822 5d20 3d3d 2048 6578 4279 7465 7328  h"] == HexBytes(
+0000ffd0: 6d69 6e65 645f 7478 6e5f 6861 7368 290a  mined_txn_hash).
+0000ffe0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+0000fff0: 735f 6368 6563 6b73 756d 5f61 6464 7265  s_checksum_addre
+00010000: 7373 2872 6563 6569 7074 5b22 746f 225d  ss(receipt["to"]
+00010010: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00010020: 2072 6563 6569 7074 5b22 6672 6f6d 225d   receipt["from"]
+00010030: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
+00010040: 2020 2020 2061 7373 6572 7420 6973 5f63       assert is_c
+00010050: 6865 636b 7375 6d5f 6164 6472 6573 7328  hecksum_address(
+00010060: 7265 6365 6970 745b 2266 726f 6d22 5d29  receipt["from"])
+00010070: 0a0a 2020 2020 2020 2020 6566 6665 6374  ..        effect
+00010080: 6976 655f 6761 735f 7072 6963 6520 3d20  ive_gas_price = 
+00010090: 7265 6365 6970 745b 2265 6666 6563 7469  receipt["effecti
+000100a0: 7665 4761 7350 7269 6365 225d 0a20 2020  veGasPrice"].   
+000100b0: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
+000100c0: 7374 616e 6365 2865 6666 6563 7469 7665  stance(effective
+000100d0: 5f67 6173 5f70 7269 6365 2c20 696e 7429  _gas_price, int)
+000100e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+000100f0: 6566 6665 6374 6976 655f 6761 735f 7072  effective_gas_pr
+00010100: 6963 6520 3e20 300a 0a20 2020 2040 7079  ice > 0..    @py
+00010110: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+00010120: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+00010130: 7465 7374 5f61 7379 6e63 5f65 7468 5f67  test_async_eth_g
+00010140: 6574 5f74 7261 6e73 6163 7469 6f6e 5f72  et_transaction_r
+00010150: 6563 6569 7074 5f75 6e6d 696e 6564 280a  eceipt_unmined(.
+00010160: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+00010170: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00010180: 6233 222c 2061 7379 6e63 5f75 6e6c 6f63  b3", async_unloc
+00010190: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+000101a0: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+000101b0: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
+000101c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
+000101d0: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
+000101e0: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
+000101f0: 5f74 7261 6e73 6163 7469 6f6e 280a 2020  _transaction(.  
+00010200: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+00010210: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+00010220: 6d22 3a20 6173 796e 635f 756e 6c6f 636b  m": async_unlock
+00010230: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
+00010240: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+00010250: 2020 2020 2020 2274 6f22 3a20 6173 796e        "to": asyn
+00010260: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
+00010270: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
+00010280: 2020 2020 2020 2020 2020 2020 2020 2276                "v
+00010290: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
+000102a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000102b0: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
+000102c0: 2020 2020 2020 2020 2020 2020 2022 6d61               "ma
+000102d0: 7846 6565 5065 7247 6173 223a 2061 7379  xFeePerGas": asy
+000102e0: 6e63 5f77 332e 746f 5f77 6569 2833 2c20  nc_w3.to_wei(3, 
+000102f0: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
+00010300: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
+00010310: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
+00010320: 2061 7379 6e63 5f77 332e 746f 5f77 6569   async_w3.to_wei
+00010330: 2831 2c20 2267 7765 6922 292c 0a20 2020  (1, "gwei"),.   
+00010340: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+00010350: 2020 2029 0a20 2020 2020 2020 2077 6974     ).        wit
+00010360: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+00010370: 5472 616e 7361 6374 696f 6e4e 6f74 466f  TransactionNotFo
+00010380: 756e 6429 3a0a 2020 2020 2020 2020 2020  und):.          
+00010390: 2020 6177 6169 7420 6173 796e 635f 7733    await async_w3
+000103a0: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
+000103b0: 7469 6f6e 5f72 6563 6569 7074 2874 786e  tion_receipt(txn
+000103c0: 5f68 6173 6829 0a0a 2020 2020 4070 7974  _hash)..    @pyt
+000103d0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+000103e0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+000103f0: 6573 745f 6173 796e 635f 6574 685f 6765  est_async_eth_ge
+00010400: 745f 7472 616e 7361 6374 696f 6e5f 7265  t_transaction_re
+00010410: 6365 6970 745f 7769 7468 5f6c 6f67 5f65  ceipt_with_log_e
+00010420: 6e74 7279 280a 2020 2020 2020 2020 7365  ntry(.        se
+00010430: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
+00010440: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+00010450: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
+00010460: 5f62 6c6f 636b 5f77 6974 685f 7478 6e5f  _block_with_txn_
+00010470: 7769 7468 5f6c 6f67 3a20 426c 6f63 6b44  with_log: BlockD
+00010480: 6174 612c 0a20 2020 2020 2020 2061 7379  ata,.        asy
+00010490: 6e63 5f65 6d69 7474 6572 5f63 6f6e 7472  nc_emitter_contr
+000104a0: 6163 743a 2022 4173 796e 6343 6f6e 7472  act: "AsyncContr
+000104b0: 6163 7422 2c0a 2020 2020 2020 2020 7478  act",.        tx
+000104c0: 6e5f 6861 7368 5f77 6974 685f 6c6f 673a  n_hash_with_log:
+000104d0: 2048 6578 5374 722c 0a20 2020 2029 202d   HexStr,.    ) -
+000104e0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+000104f0: 7265 6365 6970 7420 3d20 6177 6169 7420  receipt = await 
+00010500: 6173 796e 635f 7733 2e65 7468 2e77 6169  async_w3.eth.wai
+00010510: 745f 666f 725f 7472 616e 7361 6374 696f  t_for_transactio
+00010520: 6e5f 7265 6365 6970 7428 7478 6e5f 6861  n_receipt(txn_ha
+00010530: 7368 5f77 6974 685f 6c6f 6729 0a20 2020  sh_with_log).   
+00010540: 2020 2020 2061 7373 6572 7420 6973 5f64       assert is_d
+00010550: 6963 7428 7265 6365 6970 7429 0a20 2020  ict(receipt).   
+00010560: 2020 2020 2061 7373 6572 7420 7265 6365       assert rece
+00010570: 6970 745b 2262 6c6f 636b 4e75 6d62 6572  ipt["blockNumber
+00010580: 225d 203d 3d20 6173 796e 635f 626c 6f63  "] == async_bloc
+00010590: 6b5f 7769 7468 5f74 786e 5f77 6974 685f  k_with_txn_with_
+000105a0: 6c6f 675b 226e 756d 6265 7222 5d0a 2020  log["number"].  
+000105b0: 2020 2020 2020 6173 7365 7274 2072 6563        assert rec
+000105c0: 6569 7074 5b22 626c 6f63 6b48 6173 6822  eipt["blockHash"
+000105d0: 5d20 3d3d 2061 7379 6e63 5f62 6c6f 636b  ] == async_block
+000105e0: 5f77 6974 685f 7478 6e5f 7769 7468 5f6c  _with_txn_with_l
+000105f0: 6f67 5b22 6861 7368 225d 0a20 2020 2020  og["hash"].     
+00010600: 2020 2061 7373 6572 7420 7265 6365 6970     assert receip
+00010610: 745b 2274 7261 6e73 6163 7469 6f6e 496e  t["transactionIn
+00010620: 6465 7822 5d20 3d3d 2030 0a20 2020 2020  dex"] == 0.     
+00010630: 2020 2061 7373 6572 7420 7265 6365 6970     assert receip
+00010640: 745b 2274 7261 6e73 6163 7469 6f6e 4861  t["transactionHa
+00010650: 7368 225d 203d 3d20 4865 7842 7974 6573  sh"] == HexBytes
+00010660: 2874 786e 5f68 6173 685f 7769 7468 5f6c  (txn_hash_with_l
+00010670: 6f67 290a 0a20 2020 2020 2020 2061 7373  og)..        ass
+00010680: 6572 7420 6c65 6e28 7265 6365 6970 745b  ert len(receipt[
+00010690: 226c 6f67 7322 5d29 203d 3d20 310a 2020  "logs"]) == 1.  
+000106a0: 2020 2020 2020 6c6f 675f 656e 7472 7920        log_entry 
+000106b0: 3d20 7265 6365 6970 745b 226c 6f67 7322  = receipt["logs"
+000106c0: 5d5b 305d 0a0a 2020 2020 2020 2020 6173  ][0]..        as
+000106d0: 7365 7274 206c 6f67 5f65 6e74 7279 5b22  sert log_entry["
+000106e0: 626c 6f63 6b4e 756d 6265 7222 5d20 3d3d  blockNumber"] ==
+000106f0: 2061 7379 6e63 5f62 6c6f 636b 5f77 6974   async_block_wit
+00010700: 685f 7478 6e5f 7769 7468 5f6c 6f67 5b22  h_txn_with_log["
+00010710: 6e75 6d62 6572 225d 0a20 2020 2020 2020  number"].       
+00010720: 2061 7373 6572 7420 6c6f 675f 656e 7472   assert log_entr
+00010730: 795b 2262 6c6f 636b 4861 7368 225d 203d  y["blockHash"] =
+00010740: 3d20 6173 796e 635f 626c 6f63 6b5f 7769  = async_block_wi
+00010750: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
+00010760: 2268 6173 6822 5d0a 2020 2020 2020 2020  "hash"].        
+00010770: 6173 7365 7274 206c 6f67 5f65 6e74 7279  assert log_entry
+00010780: 5b22 6c6f 6749 6e64 6578 225d 203d 3d20  ["logIndex"] == 
+00010790: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
+000107a0: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
+000107b0: 286c 6f67 5f65 6e74 7279 5b22 6164 6472  (log_entry["addr
+000107c0: 6573 7322 5d2c 2061 7379 6e63 5f65 6d69  ess"], async_emi
+000107d0: 7474 6572 5f63 6f6e 7472 6163 742e 6164  tter_contract.ad
+000107e0: 6472 6573 7329 0a20 2020 2020 2020 2061  dress).        a
+000107f0: 7373 6572 7420 6c6f 675f 656e 7472 795b  ssert log_entry[
+00010800: 2274 7261 6e73 6163 7469 6f6e 496e 6465  "transactionInde
+00010810: 7822 5d20 3d3d 2030 0a20 2020 2020 2020  x"] == 0.       
+00010820: 2061 7373 6572 7420 6c6f 675f 656e 7472   assert log_entr
+00010830: 795b 2274 7261 6e73 6163 7469 6f6e 4861  y["transactionHa
+00010840: 7368 225d 203d 3d20 4865 7842 7974 6573  sh"] == HexBytes
+00010850: 2874 786e 5f68 6173 685f 7769 7468 5f6c  (txn_hash_with_l
+00010860: 6f67 290a 0a20 2020 2040 7079 7465 7374  og)..    @pytest
+00010870: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+00010880: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+00010890: 5f61 7379 6e63 5f65 7468 5f77 6169 745f  _async_eth_wait_
+000108a0: 666f 725f 7472 616e 7361 6374 696f 6e5f  for_transaction_
+000108b0: 7265 6365 6970 745f 6d69 6e65 6428 0a20  receipt_mined(. 
+000108c0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+000108d0: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
+000108e0: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
+000108f0: 2020 2020 6173 796e 635f 626c 6f63 6b5f      async_block_
+00010900: 7769 7468 5f74 786e 3a20 426c 6f63 6b44  with_txn: BlockD
+00010910: 6174 612c 0a20 2020 2020 2020 206d 696e  ata,.        min
+00010920: 6564 5f74 786e 5f68 6173 683a 2048 6578  ed_txn_hash: Hex
+00010930: 5374 722c 0a20 2020 2029 202d 3e20 4e6f  Str,.    ) -> No
+00010940: 6e65 3a0a 2020 2020 2020 2020 7265 6365  ne:.        rece
+00010950: 6970 7420 3d20 6177 6169 7420 6173 796e  ipt = await asyn
+00010960: 635f 7733 2e65 7468 2e77 6169 745f 666f  c_w3.eth.wait_fo
+00010970: 725f 7472 616e 7361 6374 696f 6e5f 7265  r_transaction_re
+00010980: 6365 6970 7428 6d69 6e65 645f 7478 6e5f  ceipt(mined_txn_
+00010990: 6861 7368 290a 2020 2020 2020 2020 6173  hash).        as
+000109a0: 7365 7274 2069 735f 6469 6374 2872 6563  sert is_dict(rec
+000109b0: 6569 7074 290a 2020 2020 2020 2020 6173  eipt).        as
+000109c0: 7365 7274 2072 6563 6569 7074 5b22 626c  sert receipt["bl
+000109d0: 6f63 6b4e 756d 6265 7222 5d20 3d3d 2061  ockNumber"] == a
+000109e0: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
+000109f0: 7478 6e5b 226e 756d 6265 7222 5d0a 2020  txn["number"].  
+00010a00: 2020 2020 2020 6173 7365 7274 2072 6563        assert rec
+00010a10: 6569 7074 5b22 626c 6f63 6b48 6173 6822  eipt["blockHash"
+00010a20: 5d20 3d3d 2061 7379 6e63 5f62 6c6f 636b  ] == async_block
+00010a30: 5f77 6974 685f 7478 6e5b 2268 6173 6822  _with_txn["hash"
+00010a40: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+00010a50: 2072 6563 6569 7074 5b22 7472 616e 7361   receipt["transa
+00010a60: 6374 696f 6e49 6e64 6578 225d 203d 3d20  ctionIndex"] == 
+00010a70: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
+00010a80: 2072 6563 6569 7074 5b22 7472 616e 7361   receipt["transa
+00010a90: 6374 696f 6e48 6173 6822 5d20 3d3d 2048  ctionHash"] == H
+00010aa0: 6578 4279 7465 7328 6d69 6e65 645f 7478  exBytes(mined_tx
+00010ab0: 6e5f 6861 7368 290a 2020 2020 2020 2020  n_hash).        
+00010ac0: 6173 7365 7274 2069 735f 6368 6563 6b73  assert is_checks
+00010ad0: 756d 5f61 6464 7265 7373 2872 6563 6569  um_address(recei
+00010ae0: 7074 5b22 746f 225d 290a 2020 2020 2020  pt["to"]).      
+00010af0: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
+00010b00: 5b22 6672 6f6d 225d 2069 7320 6e6f 7420  ["from"] is not 
+00010b10: 4e6f 6e65 0a20 2020 2020 2020 2061 7373  None.        ass
+00010b20: 6572 7420 6973 5f63 6865 636b 7375 6d5f  ert is_checksum_
+00010b30: 6164 6472 6573 7328 7265 6365 6970 745b  address(receipt[
+00010b40: 2266 726f 6d22 5d29 0a0a 2020 2020 2020  "from"])..      
+00010b50: 2020 6566 6665 6374 6976 655f 6761 735f    effective_gas_
+00010b60: 7072 6963 6520 3d20 7265 6365 6970 745b  price = receipt[
+00010b70: 2265 6666 6563 7469 7665 4761 7350 7269  "effectiveGasPri
+00010b80: 6365 225d 0a20 2020 2020 2020 2061 7373  ce"].        ass
+00010b90: 6572 7420 6973 696e 7374 616e 6365 2865  ert isinstance(e
+00010ba0: 6666 6563 7469 7665 5f67 6173 5f70 7269  ffective_gas_pri
+00010bb0: 6365 2c20 696e 7429 0a20 2020 2020 2020  ce, int).       
+00010bc0: 2061 7373 6572 7420 6566 6665 6374 6976   assert effectiv
+00010bd0: 655f 6761 735f 7072 6963 6520 3e20 300a  e_gas_price > 0.
+00010be0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00010bf0: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+00010c00: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
+00010c10: 6e63 5f65 7468 5f77 6169 745f 666f 725f  nc_eth_wait_for_
+00010c20: 7472 616e 7361 6374 696f 6e5f 7265 6365  transaction_rece
+00010c30: 6970 745f 756e 6d69 6e65 6428 0a20 2020  ipt_unmined(.   
+00010c40: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
+00010c50: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
+00010c60: 2c20 6173 796e 635f 756e 6c6f 636b 6564  , async_unlocked
+00010c70: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+00010c80: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
+00010c90: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
+00010ca0: 653a 0a20 2020 2020 2020 2074 786e 5f68  e:.        txn_h
+00010cb0: 6173 6820 3d20 6177 6169 7420 6173 796e  ash = await asyn
+00010cc0: 635f 7733 2e65 7468 2e73 656e 645f 7472  c_w3.eth.send_tr
+00010cd0: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+00010ce0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+00010cf0: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
+00010d00: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+00010d10: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+00010d20: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00010d30: 2020 2022 746f 223a 2061 7379 6e63 5f75     "to": async_u
+00010d40: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+00010d50: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+00010d60: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+00010d70: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+00010d80: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+00010d90: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
+00010da0: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
+00010db0: 6550 6572 4761 7322 3a20 6173 796e 635f  ePerGas": async_
+00010dc0: 7733 2e74 6f5f 7765 6928 332c 2022 6777  w3.to_wei(3, "gw
+00010dd0: 6569 2229 2c0a 2020 2020 2020 2020 2020  ei"),.          
+00010de0: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
+00010df0: 7479 4665 6550 6572 4761 7322 3a20 6173  tyFeePerGas": as
+00010e00: 796e 635f 7733 2e74 6f5f 7765 6928 312c  ync_w3.to_wei(1,
+00010e10: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
+00010e20: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00010e30: 290a 0a20 2020 2020 2020 2074 696d 656f  )..        timeo
+00010e40: 7574 203d 2030 2e30 310a 2020 2020 2020  ut = 0.01.      
+00010e50: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+00010e60: 6973 6573 2854 696d 6545 7868 6175 7374  ises(TimeExhaust
+00010e70: 6564 2920 6173 2065 7863 5f69 6e66 6f3a  ed) as exc_info:
+00010e80: 0a20 2020 2020 2020 2020 2020 2061 7761  .            awa
+00010e90: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00010ea0: 7761 6974 5f66 6f72 5f74 7261 6e73 6163  wait_for_transac
+00010eb0: 7469 6f6e 5f72 6563 6569 7074 2874 786e  tion_receipt(txn
+00010ec0: 5f68 6173 682c 2074 696d 656f 7574 3d74  _hash, timeout=t
+00010ed0: 696d 656f 7574 290a 0a20 2020 2020 2020  imeout)..       
+00010ee0: 2061 7373 6572 7420 285f 2069 6e20 7374   assert (_ in st
+00010ef0: 7228 6578 635f 696e 666f 2920 666f 7220  r(exc_info) for 
+00010f00: 5f20 696e 205b 7265 7072 2874 786e 5f68  _ in [repr(txn_h
+00010f10: 6173 6829 2c20 7469 6d65 6f75 745d 290a  ash), timeout]).
+00010f20: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00010f30: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+00010f40: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
+00010f50: 6e63 5f65 7468 5f77 6169 745f 666f 725f  nc_eth_wait_for_
+00010f60: 7472 616e 7361 6374 696f 6e5f 7265 6365  transaction_rece
+00010f70: 6970 745f 7769 7468 5f6c 6f67 5f65 6e74  ipt_with_log_ent
+00010f80: 7279 280a 2020 2020 2020 2020 7365 6c66  ry(.        self
+00010f90: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+00010fa0: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+00010fb0: 0a20 2020 2020 2020 2061 7379 6e63 5f62  .        async_b
+00010fc0: 6c6f 636b 5f77 6974 685f 7478 6e5f 7769  lock_with_txn_wi
+00010fd0: 7468 5f6c 6f67 3a20 426c 6f63 6b44 6174  th_log: BlockDat
+00010fe0: 612c 0a20 2020 2020 2020 2061 7379 6e63  a,.        async
+00010ff0: 5f65 6d69 7474 6572 5f63 6f6e 7472 6163  _emitter_contrac
+00011000: 743a 2022 4173 796e 6343 6f6e 7472 6163  t: "AsyncContrac
+00011010: 7422 2c0a 2020 2020 2020 2020 7478 6e5f  t",.        txn_
+00011020: 6861 7368 5f77 6974 685f 6c6f 673a 2048  hash_with_log: H
+00011030: 6578 5374 722c 0a20 2020 2029 202d 3e20  exStr,.    ) -> 
+00011040: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
+00011050: 6365 6970 7420 3d20 6177 6169 7420 6173  ceipt = await as
+00011060: 796e 635f 7733 2e65 7468 2e77 6169 745f  ync_w3.eth.wait_
+00011070: 666f 725f 7472 616e 7361 6374 696f 6e5f  for_transaction_
+00011080: 7265 6365 6970 7428 7478 6e5f 6861 7368  receipt(txn_hash
+00011090: 5f77 6974 685f 6c6f 6729 0a20 2020 2020  _with_log).     
+000110a0: 2020 2061 7373 6572 7420 6973 5f64 6963     assert is_dic
+000110b0: 7428 7265 6365 6970 7429 0a20 2020 2020  t(receipt).     
+000110c0: 2020 2061 7373 6572 7420 7265 6365 6970     assert receip
+000110d0: 745b 2262 6c6f 636b 4e75 6d62 6572 225d  t["blockNumber"]
+000110e0: 203d 3d20 6173 796e 635f 626c 6f63 6b5f   == async_block_
+000110f0: 7769 7468 5f74 786e 5f77 6974 685f 6c6f  with_txn_with_lo
+00011100: 675b 226e 756d 6265 7222 5d0a 2020 2020  g["number"].    
+00011110: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
+00011120: 7074 5b22 626c 6f63 6b48 6173 6822 5d20  pt["blockHash"] 
+00011130: 3d3d 2061 7379 6e63 5f62 6c6f 636b 5f77  == async_block_w
+00011140: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
+00011150: 5b22 6861 7368 225d 0a20 2020 2020 2020  ["hash"].       
+00011160: 2061 7373 6572 7420 7265 6365 6970 745b   assert receipt[
+00011170: 2274 7261 6e73 6163 7469 6f6e 496e 6465  "transactionInde
+00011180: 7822 5d20 3d3d 2030 0a20 2020 2020 2020  x"] == 0.       
+00011190: 2061 7373 6572 7420 7265 6365 6970 745b   assert receipt[
+000111a0: 2274 7261 6e73 6163 7469 6f6e 4861 7368  "transactionHash
+000111b0: 225d 203d 3d20 4865 7842 7974 6573 2874  "] == HexBytes(t
+000111c0: 786e 5f68 6173 685f 7769 7468 5f6c 6f67  xn_hash_with_log
+000111d0: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+000111e0: 7420 6c65 6e28 7265 6365 6970 745b 226c  t len(receipt["l
+000111f0: 6f67 7322 5d29 203d 3d20 310a 2020 2020  ogs"]) == 1.    
+00011200: 2020 2020 6c6f 675f 656e 7472 7920 3d20      log_entry = 
+00011210: 7265 6365 6970 745b 226c 6f67 7322 5d5b  receipt["logs"][
+00011220: 305d 0a0a 2020 2020 2020 2020 6173 7365  0]..        asse
+00011230: 7274 206c 6f67 5f65 6e74 7279 5b22 626c  rt log_entry["bl
+00011240: 6f63 6b4e 756d 6265 7222 5d20 3d3d 2061  ockNumber"] == a
+00011250: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
+00011260: 7478 6e5f 7769 7468 5f6c 6f67 5b22 6e75  txn_with_log["nu
+00011270: 6d62 6572 225d 0a20 2020 2020 2020 2061  mber"].        a
+00011280: 7373 6572 7420 6c6f 675f 656e 7472 795b  ssert log_entry[
+00011290: 2262 6c6f 636b 4861 7368 225d 203d 3d20  "blockHash"] == 
+000112a0: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
+000112b0: 5f74 786e 5f77 6974 685f 6c6f 675b 2268  _txn_with_log["h
+000112c0: 6173 6822 5d0a 2020 2020 2020 2020 6173  ash"].        as
+000112d0: 7365 7274 206c 6f67 5f65 6e74 7279 5b22  sert log_entry["
+000112e0: 6c6f 6749 6e64 6578 225d 203d 3d20 300a  logIndex"] == 0.
+000112f0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00011300: 735f 7361 6d65 5f61 6464 7265 7373 286c  s_same_address(l
+00011310: 6f67 5f65 6e74 7279 5b22 6164 6472 6573  og_entry["addres
+00011320: 7322 5d2c 2061 7379 6e63 5f65 6d69 7474  s"], async_emitt
+00011330: 6572 5f63 6f6e 7472 6163 742e 6164 6472  er_contract.addr
+00011340: 6573 7329 0a20 2020 2020 2020 2061 7373  ess).        ass
+00011350: 6572 7420 6c6f 675f 656e 7472 795b 2274  ert log_entry["t
+00011360: 7261 6e73 6163 7469 6f6e 496e 6465 7822  ransactionIndex"
+00011370: 5d20 3d3d 2030 0a20 2020 2020 2020 2061  ] == 0.        a
+00011380: 7373 6572 7420 6c6f 675f 656e 7472 795b  ssert log_entry[
+00011390: 2274 7261 6e73 6163 7469 6f6e 4861 7368  "transactionHash
+000113a0: 225d 203d 3d20 4865 7842 7974 6573 2874  "] == HexBytes(t
+000113b0: 786e 5f68 6173 685f 7769 7468 5f6c 6f67  xn_hash_with_log
+000113c0: 290a 0a20 2020 2040 7079 7465 7374 2e6d  )..    @pytest.m
+000113d0: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
+000113e0: 6173 796e 6320 6465 6620 7465 7374 5f61  async def test_a
+000113f0: 7379 6e63 5f65 7468 5f61 6363 6f75 6e74  sync_eth_account
+00011400: 7328 7365 6c66 2c20 6173 796e 635f 7733  s(self, async_w3
+00011410: 3a20 2241 7379 6e63 5765 6233 2229 202d  : "AsyncWeb3") -
+00011420: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00011430: 6163 636f 756e 7473 203d 2061 7761 6974  accounts = await
+00011440: 2061 7379 6e63 5f77 332e 6574 682e 6163   async_w3.eth.ac
+00011450: 636f 756e 7473 0a20 2020 2020 2020 2061  counts.        a
+00011460: 7373 6572 7420 6973 5f6c 6973 745f 6c69  ssert is_list_li
+00011470: 6b65 2861 6363 6f75 6e74 7329 0a20 2020  ke(accounts).   
+00011480: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+00011490: 6163 636f 756e 7473 2920 213d 2030 0a20  accounts) != 0. 
+000114a0: 2020 2020 2020 2061 7373 6572 7420 616c         assert al
+000114b0: 6c28 6973 5f63 6865 636b 7375 6d5f 6164  l(is_checksum_ad
+000114c0: 6472 6573 7328 6163 636f 756e 7429 2066  dress(account) f
+000114d0: 6f72 2061 6363 6f75 6e74 2069 6e20 6163  or account in ac
+000114e0: 636f 756e 7473 290a 2020 2020 2020 2020  counts).        
+000114f0: 6173 7365 7274 2061 7761 6974 2061 7379  assert await asy
+00011500: 6e63 5f77 332e 6574 682e 636f 696e 6261  nc_w3.eth.coinba
+00011510: 7365 2069 6e20 6163 636f 756e 7473 0a0a  se in accounts..
+00011520: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+00011530: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+00011540: 6e63 2064 6566 2074 6573 745f 6173 796e  nc def test_asyn
+00011550: 635f 6574 685f 6765 745f 6c6f 6773 5f77  c_eth_get_logs_w
+00011560: 6974 686f 7574 5f6c 6f67 7328 0a20 2020  ithout_logs(.   
+00011570: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
+00011580: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
+00011590: 2c20 6173 796e 635f 626c 6f63 6b5f 7769  , async_block_wi
+000115a0: 7468 5f74 786e 5f77 6974 685f 6c6f 673a  th_txn_with_log:
+000115b0: 2042 6c6f 636b 4461 7461 0a20 2020 2029   BlockData.    )
+000115c0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+000115d0: 2020 2320 5465 7374 2077 6974 6820 626c    # Test with bl
+000115e0: 6f63 6b20 7261 6e67 650a 0a20 2020 2020  ock range..     
+000115f0: 2020 2066 696c 7465 725f 7061 7261 6d73     filter_params
+00011600: 3a20 4669 6c74 6572 5061 7261 6d73 203d  : FilterParams =
+00011610: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00011620: 6672 6f6d 426c 6f63 6b22 3a20 426c 6f63  fromBlock": Bloc
+00011630: 6b4e 756d 6265 7228 3029 2c0a 2020 2020  kNumber(0),.    
+00011640: 2020 2020 2020 2020 2274 6f42 6c6f 636b          "toBlock
+00011650: 223a 2042 6c6f 636b 4e75 6d62 6572 2861  ": BlockNumber(a
+00011660: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
+00011670: 7478 6e5f 7769 7468 5f6c 6f67 5b22 6e75  txn_with_log["nu
+00011680: 6d62 6572 225d 202d 2031 292c 0a20 2020  mber"] - 1),.   
+00011690: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
+000116a0: 6573 756c 7420 3d20 6177 6169 7420 6173  esult = await as
+000116b0: 796e 635f 7733 2e65 7468 2e67 6574 5f6c  ync_w3.eth.get_l
+000116c0: 6f67 7328 6669 6c74 6572 5f70 6172 616d  ogs(filter_param
+000116d0: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
+000116e0: 7420 6c65 6e28 7265 7375 6c74 2920 3d3d  t len(result) ==
+000116f0: 2030 0a0a 2020 2020 2020 2020 2320 7468   0..        # th
+00011700: 6520 7261 6e67 6520 6973 2077 726f 6e67  e range is wrong
+00011710: 0a20 2020 2020 2020 2066 696c 7465 725f  .        filter_
+00011720: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
+00011730: 2020 2020 2020 2022 6672 6f6d 426c 6f63         "fromBloc
+00011740: 6b22 3a20 6173 796e 635f 626c 6f63 6b5f  k": async_block_
+00011750: 7769 7468 5f74 786e 5f77 6974 685f 6c6f  with_txn_with_lo
+00011760: 675b 226e 756d 6265 7222 5d2c 0a20 2020  g["number"],.   
+00011770: 2020 2020 2020 2020 2022 746f 426c 6f63           "toBloc
+00011780: 6b22 3a20 426c 6f63 6b4e 756d 6265 7228  k": BlockNumber(
+00011790: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
+000117a0: 5f74 786e 5f77 6974 685f 6c6f 675b 226e  _txn_with_log["n
+000117b0: 756d 6265 7222 5d20 2d20 3129 2c0a 2020  umber"] - 1),.  
+000117c0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+000117d0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+000117e0: 6573 2856 616c 7565 4572 726f 7229 3a0a  es(ValueError):.
+000117f0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00011800: 6c74 203d 2061 7761 6974 2061 7379 6e63  lt = await async
+00011810: 5f77 332e 6574 682e 6765 745f 6c6f 6773  _w3.eth.get_logs
+00011820: 2866 696c 7465 725f 7061 7261 6d73 290a  (filter_params).
+00011830: 0a20 2020 2020 2020 2023 2054 6573 7420  .        # Test 
+00011840: 7769 7468 2060 6164 6472 6573 7360 0a0a  with `address`..
+00011850: 2020 2020 2020 2020 2320 6669 6c74 6572          # filter
+00011860: 2077 6974 6820 6f74 6865 7220 6164 6472   with other addr
+00011870: 6573 730a 2020 2020 2020 2020 6669 6c74  ess.        filt
+00011880: 6572 5f70 6172 616d 7320 3d20 7b0a 2020  er_params = {.  
+00011890: 2020 2020 2020 2020 2020 2266 726f 6d42            "fromB
+000118a0: 6c6f 636b 223a 2042 6c6f 636b 4e75 6d62  lock": BlockNumb
+000118b0: 6572 2830 292c 0a20 2020 2020 2020 2020  er(0),.         
+000118c0: 2020 2022 6164 6472 6573 7322 3a20 554e     "address": UN
+000118d0: 4b4e 4f57 4e5f 4144 4452 4553 532c 0a20  KNOWN_ADDRESS,. 
+000118e0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+000118f0: 2072 6573 756c 7420 3d20 6177 6169 7420   result = await 
+00011900: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
+00011910: 5f6c 6f67 7328 6669 6c74 6572 5f70 6172  _logs(filter_par
+00011920: 616d 7329 0a20 2020 2020 2020 2061 7373  ams).        ass
+00011930: 6572 7420 6c65 6e28 7265 7375 6c74 2920  ert len(result) 
+00011940: 3d3d 2030 0a0a 2020 2020 2020 2020 2320  == 0..        # 
+00011950: 5465 7374 2077 6974 6820 6d75 6c74 6970  Test with multip
+00011960: 6c65 2060 6164 6472 6573 7360 0a0a 2020  le `address`..  
+00011970: 2020 2020 2020 2320 6669 6c74 6572 2077        # filter w
+00011980: 6974 6820 6f74 6865 7220 6164 6472 6573  ith other addres
+00011990: 730a 2020 2020 2020 2020 6669 6c74 6572  s.        filter
+000119a0: 5f70 6172 616d 7320 3d20 7b0a 2020 2020  _params = {.    
+000119b0: 2020 2020 2020 2020 2266 726f 6d42 6c6f          "fromBlo
+000119c0: 636b 223a 2042 6c6f 636b 4e75 6d62 6572  ck": BlockNumber
+000119d0: 2830 292c 0a20 2020 2020 2020 2020 2020  (0),.           
+000119e0: 2022 6164 6472 6573 7322 3a20 5b55 4e4b   "address": [UNK
+000119f0: 4e4f 574e 5f41 4444 5245 5353 2c20 554e  NOWN_ADDRESS, UN
+00011a00: 4b4e 4f57 4e5f 4144 4452 4553 535d 2c0a  KNOWN_ADDRESS],.
+00011a10: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00011a20: 2020 7265 7375 6c74 203d 2061 7761 6974    result = await
+00011a30: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
+00011a40: 745f 6c6f 6773 2866 696c 7465 725f 7061  t_logs(filter_pa
+00011a50: 7261 6d73 290a 2020 2020 2020 2020 6173  rams).        as
+00011a60: 7365 7274 206c 656e 2872 6573 756c 7429  sert len(result)
+00011a70: 203d 3d20 300a 0a20 2020 2040 7079 7465   == 0..    @pyte
+00011a80: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+00011a90: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+00011aa0: 7374 5f61 7379 6e63 5f65 7468 5f67 6574  st_async_eth_get
+00011ab0: 5f6c 6f67 735f 7769 7468 5f6c 6f67 7328  _logs_with_logs(
+00011ac0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00011ad0: 2020 2020 2020 2061 7379 6e63 5f77 333a         async_w3:
+00011ae0: 2022 4173 796e 6357 6562 3322 2c0a 2020   "AsyncWeb3",.  
+00011af0: 2020 2020 2020 6173 796e 635f 626c 6f63        async_bloc
+00011b00: 6b5f 7769 7468 5f74 786e 5f77 6974 685f  k_with_txn_with_
+00011b10: 6c6f 673a 2042 6c6f 636b 4461 7461 2c0a  log: BlockData,.
+00011b20: 2020 2020 2020 2020 6173 796e 635f 656d          async_em
+00011b30: 6974 7465 725f 636f 6e74 7261 6374 5f61  itter_contract_a
+00011b40: 6464 7265 7373 3a20 4368 6563 6b73 756d  ddress: Checksum
+00011b50: 4164 6472 6573 732c 0a20 2020 2020 2020  Address,.       
+00011b60: 2074 786e 5f68 6173 685f 7769 7468 5f6c   txn_hash_with_l
+00011b70: 6f67 3a20 4865 7853 7472 2c0a 2020 2020  og: HexStr,.    
+00011b80: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00011b90: 2020 2023 2054 6573 7420 7769 7468 2062     # Test with b
+00011ba0: 6c6f 636b 2072 616e 6765 0a0a 2020 2020  lock range..    
+00011bb0: 2020 2020 2320 7468 6520 7261 6e67 6520      # the range 
+00011bc0: 696e 636c 7564 6573 2074 6865 2062 6c6f  includes the blo
+00011bd0: 636b 2077 6865 7265 2074 6865 206c 6f67  ck where the log
+00011be0: 2072 6573 6964 6573 2069 6e0a 2020 2020   resides in.    
+00011bf0: 2020 2020 6669 6c74 6572 5f70 6172 616d      filter_param
+00011c00: 733a 2046 696c 7465 7250 6172 616d 7320  s: FilterParams 
+00011c10: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00011c20: 2266 726f 6d42 6c6f 636b 223a 2061 7379  "fromBlock": asy
+00011c30: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
+00011c40: 6e5f 7769 7468 5f6c 6f67 5b22 6e75 6d62  n_with_log["numb
+00011c50: 6572 225d 2c0a 2020 2020 2020 2020 2020  er"],.          
+00011c60: 2020 2274 6f42 6c6f 636b 223a 2061 7379    "toBlock": asy
+00011c70: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
+00011c80: 6e5f 7769 7468 5f6c 6f67 5b22 6e75 6d62  n_with_log["numb
+00011c90: 6572 225d 2c0a 2020 2020 2020 2020 7d0a  er"],.        }.
+00011ca0: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+00011cb0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00011cc0: 6574 682e 6765 745f 6c6f 6773 2866 696c  eth.get_logs(fil
+00011cd0: 7465 725f 7061 7261 6d73 290a 2020 2020  ter_params).    
+00011ce0: 2020 2020 6173 7365 7274 5f63 6f6e 7461      assert_conta
+00011cf0: 696e 735f 6c6f 6728 0a20 2020 2020 2020  ins_log(.       
+00011d00: 2020 2020 2072 6573 756c 742c 0a20 2020       result,.   
+00011d10: 2020 2020 2020 2020 2061 7379 6e63 5f62           async_b
+00011d20: 6c6f 636b 5f77 6974 685f 7478 6e5f 7769  lock_with_txn_wi
+00011d30: 7468 5f6c 6f67 2c0a 2020 2020 2020 2020  th_log,.        
+00011d40: 2020 2020 6173 796e 635f 656d 6974 7465      async_emitte
+00011d50: 725f 636f 6e74 7261 6374 5f61 6464 7265  r_contract_addre
+00011d60: 7373 2c0a 2020 2020 2020 2020 2020 2020  ss,.            
+00011d70: 7478 6e5f 6861 7368 5f77 6974 685f 6c6f  txn_hash_with_lo
+00011d80: 672c 0a20 2020 2020 2020 2029 0a0a 2020  g,.        )..  
+00011d90: 2020 2020 2020 2320 7370 6563 6966 7920        # specify 
+00011da0: 6f6e 6c79 2060 6672 6f6d 5f62 6c6f 636b  only `from_block
+00011db0: 602e 2062 7920 6465 6661 756c 7420 6074  `. by default `t
+00011dc0: 6f5f 626c 6f63 6b60 2073 686f 756c 6420  o_block` should 
+00011dd0: 6265 2027 6c61 7465 7374 270a 2020 2020  be 'latest'.    
+00011de0: 2020 2020 6669 6c74 6572 5f70 6172 616d      filter_param
+00011df0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00011e00: 2020 2266 726f 6d42 6c6f 636b 223a 2042    "fromBlock": B
+00011e10: 6c6f 636b 4e75 6d62 6572 2830 292c 0a20  lockNumber(0),. 
+00011e20: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00011e30: 2072 6573 756c 7420 3d20 6177 6169 7420   result = await 
+00011e40: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
+00011e50: 5f6c 6f67 7328 6669 6c74 6572 5f70 6172  _logs(filter_par
+00011e60: 616d 7329 0a20 2020 2020 2020 2061 7373  ams).        ass
+00011e70: 6572 745f 636f 6e74 6169 6e73 5f6c 6f67  ert_contains_log
+00011e80: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
+00011e90: 7375 6c74 2c0a 2020 2020 2020 2020 2020  sult,.          
+00011ea0: 2020 6173 796e 635f 626c 6f63 6b5f 7769    async_block_wi
+00011eb0: 7468 5f74 786e 5f77 6974 685f 6c6f 672c  th_txn_with_log,
+00011ec0: 0a20 2020 2020 2020 2020 2020 2061 7379  .            asy
+00011ed0: 6e63 5f65 6d69 7474 6572 5f63 6f6e 7472  nc_emitter_contr
+00011ee0: 6163 745f 6164 6472 6573 732c 0a20 2020  act_address,.   
+00011ef0: 2020 2020 2020 2020 2074 786e 5f68 6173           txn_has
+00011f00: 685f 7769 7468 5f6c 6f67 2c0a 2020 2020  h_with_log,.    
+00011f10: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
+00011f20: 2054 6573 7420 7769 7468 2060 6164 6472   Test with `addr
+00011f30: 6573 7360 0a0a 2020 2020 2020 2020 2320  ess`..        # 
+00011f40: 6669 6c74 6572 2077 6974 6820 656d 6974  filter with emit
+00011f50: 7465 725f 636f 6e74 7261 6374 2e61 6464  ter_contract.add
+00011f60: 7265 7373 0a20 2020 2020 2020 2066 696c  ress.        fil
+00011f70: 7465 725f 7061 7261 6d73 203d 207b 0a20  ter_params = {. 
+00011f80: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+00011f90: 426c 6f63 6b22 3a20 426c 6f63 6b4e 756d  Block": BlockNum
+00011fa0: 6265 7228 3029 2c0a 2020 2020 2020 2020  ber(0),.        
+00011fb0: 2020 2020 2261 6464 7265 7373 223a 2061      "address": a
+00011fc0: 7379 6e63 5f65 6d69 7474 6572 5f63 6f6e  sync_emitter_con
+00011fd0: 7472 6163 745f 6164 6472 6573 732c 0a20  tract_address,. 
+00011fe0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00011ff0: 2072 6573 756c 7420 3d20 6177 6169 7420   result = await 
+00012000: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
+00012010: 5f6c 6f67 7328 6669 6c74 6572 5f70 6172  _logs(filter_par
+00012020: 616d 7329 0a20 2020 2020 2020 2061 7373  ams).        ass
+00012030: 6572 745f 636f 6e74 6169 6e73 5f6c 6f67  ert_contains_log
+00012040: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
+00012050: 7375 6c74 2c0a 2020 2020 2020 2020 2020  sult,.          
+00012060: 2020 6173 796e 635f 626c 6f63 6b5f 7769    async_block_wi
+00012070: 7468 5f74 786e 5f77 6974 685f 6c6f 672c  th_txn_with_log,
+00012080: 0a20 2020 2020 2020 2020 2020 2061 7379  .            asy
+00012090: 6e63 5f65 6d69 7474 6572 5f63 6f6e 7472  nc_emitter_contr
+000120a0: 6163 745f 6164 6472 6573 732c 0a20 2020  act_address,.   
+000120b0: 2020 2020 2020 2020 2074 786e 5f68 6173           txn_has
+000120c0: 685f 7769 7468 5f6c 6f67 2c0a 2020 2020  h_with_log,.    
+000120d0: 2020 2020 290a 0a20 2020 2040 7079 7465      )..    @pyte
+000120e0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+000120f0: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+00012100: 7374 5f61 7379 6e63 5f65 7468 5f67 6574  st_async_eth_get
+00012110: 5f6c 6f67 735f 7769 7468 5f6c 6f67 735f  _logs_with_logs_
+00012120: 746f 7069 635f 6172 6773 280a 2020 2020  topic_args(.    
+00012130: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00012140: 2020 6173 796e 635f 7733 3a20 2241 7379    async_w3: "Asy
+00012150: 6e63 5765 6233 222c 0a20 2020 2020 2020  ncWeb3",.       
+00012160: 2061 7379 6e63 5f62 6c6f 636b 5f77 6974   async_block_wit
+00012170: 685f 7478 6e5f 7769 7468 5f6c 6f67 3a20  h_txn_with_log: 
+00012180: 426c 6f63 6b44 6174 612c 0a20 2020 2020  BlockData,.     
+00012190: 2020 2061 7379 6e63 5f65 6d69 7474 6572     async_emitter
+000121a0: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
+000121b0: 733a 2043 6865 636b 7375 6d41 6464 7265  s: ChecksumAddre
+000121c0: 7373 2c0a 2020 2020 2020 2020 7478 6e5f  ss,.        txn_
+000121d0: 6861 7368 5f77 6974 685f 6c6f 673a 2048  hash_with_log: H
+000121e0: 6578 5374 722c 0a20 2020 2029 202d 3e20  exStr,.    ) -> 
+000121f0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2320  None:.        # 
+00012200: 5465 7374 2077 6974 6820 4e6f 6e65 2065  Test with None e
+00012210: 7665 6e74 2073 6967 0a0a 2020 2020 2020  vent sig..      
+00012220: 2020 6669 6c74 6572 5f70 6172 616d 733a    filter_params:
+00012230: 2046 696c 7465 7250 6172 616d 7320 3d20   FilterParams = 
+00012240: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
+00012250: 726f 6d42 6c6f 636b 223a 2042 6c6f 636b  romBlock": Block
+00012260: 4e75 6d62 6572 2830 292c 0a20 2020 2020  Number(0),.     
+00012270: 2020 2020 2020 2022 746f 7069 6373 223a         "topics":
+00012280: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+00012290: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
+000122a0: 2020 2020 2020 2020 2048 6578 5374 7228           HexStr(
+000122b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000122c0: 2020 2020 2022 3078 3030 3030 3030 3030       "0x00000000
+000122d0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 000122e0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 000122f0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00012300: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00012310: 3030 6434 3331 220a 2020 2020 2020 2020  00d431".        
-00012320: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00012330: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-00012340: 2020 7d0a 0a20 2020 2020 2020 2072 6573    }..        res
-00012350: 756c 7420 3d20 6177 6169 7420 6173 796e  ult = await asyn
-00012360: 635f 7733 2e65 7468 2e67 6574 5f6c 6f67  c_w3.eth.get_log
-00012370: 7328 6669 6c74 6572 5f70 6172 616d 7329  s(filter_params)
-00012380: 0a20 2020 2020 2020 2061 7373 6572 745f  .        assert_
-00012390: 636f 6e74 6169 6e73 5f6c 6f67 280a 2020  contains_log(.  
-000123a0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-000123b0: 2c0a 2020 2020 2020 2020 2020 2020 6173  ,.            as
-000123c0: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
-000123d0: 786e 5f77 6974 685f 6c6f 672c 0a20 2020  xn_with_log,.   
-000123e0: 2020 2020 2020 2020 2061 7379 6e63 5f65           async_e
-000123f0: 6d69 7474 6572 5f63 6f6e 7472 6163 745f  mitter_contract_
-00012400: 6164 6472 6573 732c 0a20 2020 2020 2020  address,.       
-00012410: 2020 2020 2074 786e 5f68 6173 685f 7769       txn_hash_wi
-00012420: 7468 5f6c 6f67 2c0a 2020 2020 2020 2020  th_log,.        
-00012430: 290a 0a20 2020 2020 2020 2023 2054 6573  )..        # Tes
-00012440: 7420 7769 7468 204e 6f6e 6520 696e 6465  t with None inde
-00012450: 7865 6420 6172 670a 2020 2020 2020 2020  xed arg.        
-00012460: 6669 6c74 6572 5f70 6172 616d 7320 3d20  filter_params = 
-00012470: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
-00012480: 726f 6d42 6c6f 636b 223a 2042 6c6f 636b  romBlock": Block
-00012490: 4e75 6d62 6572 2830 292c 0a20 2020 2020  Number(0),.     
-000124a0: 2020 2020 2020 2022 746f 7069 6373 223a         "topics":
-000124b0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-000124c0: 2020 2048 6578 5374 7228 0a20 2020 2020     HexStr(.     
-000124d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000124e0: 3078 3035 3762 6333 3238 3236 6662 6531  0x057bc32826fbe1
-000124f0: 3631 6461 3163 3131 3061 6663 6463 6165  61da1c110afcdcae
-00012500: 3763 3130 3961 3862 3639 3134 3966 3732  7c109a8b69149f72
-00012510: 3766 6333 3761 3630 3363 3630 6566 3934  7fc37a603c60ef94
-00012520: 6361 220a 2020 2020 2020 2020 2020 2020  ca".            
-00012530: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-00012540: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-00012550: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-00012560: 2020 2020 7d0a 2020 2020 2020 2020 7265      }.        re
-00012570: 7375 6c74 203d 2061 7761 6974 2061 7379  sult = await asy
-00012580: 6e63 5f77 332e 6574 682e 6765 745f 6c6f  nc_w3.eth.get_lo
-00012590: 6773 2866 696c 7465 725f 7061 7261 6d73  gs(filter_params
-000125a0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-000125b0: 5f63 6f6e 7461 696e 735f 6c6f 6728 0a20  _contains_log(. 
-000125c0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-000125d0: 742c 0a20 2020 2020 2020 2020 2020 2061  t,.            a
-000125e0: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
-000125f0: 7478 6e5f 7769 7468 5f6c 6f67 2c0a 2020  txn_with_log,.  
-00012600: 2020 2020 2020 2020 2020 6173 796e 635f            async_
-00012610: 656d 6974 7465 725f 636f 6e74 7261 6374  emitter_contract
-00012620: 5f61 6464 7265 7373 2c0a 2020 2020 2020  _address,.      
-00012630: 2020 2020 2020 7478 6e5f 6861 7368 5f77        txn_hash_w
-00012640: 6974 685f 6c6f 672c 0a20 2020 2020 2020  ith_log,.       
-00012650: 2029 0a0a 2020 2020 4070 7974 6573 742e   )..    @pytest.
-00012660: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-00012670: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-00012680: 6173 796e 635f 6574 685f 6765 745f 6c6f  async_eth_get_lo
-00012690: 6773 5f77 6974 685f 6c6f 6773 5f6e 6f6e  gs_with_logs_non
-000126a0: 655f 746f 7069 635f 6172 6773 280a 2020  e_topic_args(.  
-000126b0: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
-000126c0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-000126d0: 220a 2020 2020 2920 2d3e 204e 6f6e 653a  ".    ) -> None:
-000126e0: 0a20 2020 2020 2020 2023 2054 6573 7420  .        # Test 
-000126f0: 7769 7468 204e 6f6e 6520 6f76 6572 666c  with None overfl
-00012700: 6f77 696e 670a 2020 2020 2020 2020 6669  owing.        fi
-00012710: 6c74 6572 5f70 6172 616d 733a 2046 696c  lter_params: Fil
-00012720: 7465 7250 6172 616d 7320 3d20 7b0a 2020  terParams = {.  
-00012730: 2020 2020 2020 2020 2020 2266 726f 6d42            "fromB
-00012740: 6c6f 636b 223a 2042 6c6f 636b 4e75 6d62  lock": BlockNumb
-00012750: 6572 2830 292c 0a20 2020 2020 2020 2020  er(0),.         
-00012760: 2020 2022 746f 7069 6373 223a 205b 4e6f     "topics": [No
-00012770: 6e65 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c  ne, None, None],
-00012780: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-00012790: 2020 2020 7265 7375 6c74 203d 2061 7761      result = awa
-000127a0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-000127b0: 6765 745f 6c6f 6773 2866 696c 7465 725f  get_logs(filter_
-000127c0: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-000127d0: 6173 7365 7274 206c 656e 2872 6573 756c  assert len(resul
-000127e0: 7429 203d 3d20 300a 0a20 2020 2040 7079  t) == 0..    @py
-000127f0: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-00012800: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
-00012810: 7465 7374 5f61 7379 6e63 5f65 7468 5f73  test_async_eth_s
-00012820: 796e 6369 6e67 2873 656c 662c 2061 7379  yncing(self, asy
-00012830: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-00012840: 3322 2920 2d3e 204e 6f6e 653a 0a20 2020  3") -> None:.   
-00012850: 2020 2020 2073 796e 6369 6e67 203d 2061       syncing = a
-00012860: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00012870: 682e 7379 6e63 696e 670a 0a20 2020 2020  h.syncing..     
-00012880: 2020 2061 7373 6572 7420 6973 5f62 6f6f     assert is_boo
-00012890: 6c65 616e 2873 796e 6369 6e67 2920 6f72  lean(syncing) or
-000128a0: 2069 735f 6469 6374 2873 796e 6369 6e67   is_dict(syncing
-000128b0: 290a 0a20 2020 2020 2020 2069 6620 6973  )..        if is
-000128c0: 5f62 6f6f 6c65 616e 2873 796e 6369 6e67  _boolean(syncing
-000128d0: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-000128e0: 7373 6572 7420 7379 6e63 696e 6720 6973  ssert syncing is
-000128f0: 2046 616c 7365 0a20 2020 2020 2020 2065   False.        e
-00012900: 6c69 6620 6973 5f64 6963 7428 7379 6e63  lif is_dict(sync
-00012910: 696e 6729 3a0a 2020 2020 2020 2020 2020  ing):.          
-00012920: 2020 7379 6e63 5f64 6963 7420 3d20 6361    sync_dict = ca
-00012930: 7374 2853 796e 6353 7461 7475 732c 2073  st(SyncStatus, s
-00012940: 796e 6369 6e67 290a 2020 2020 2020 2020  yncing).        
-00012950: 2020 2020 6173 7365 7274 2022 7374 6172      assert "star
-00012960: 7469 6e67 426c 6f63 6b22 2069 6e20 7379  tingBlock" in sy
-00012970: 6e63 5f64 6963 740a 2020 2020 2020 2020  nc_dict.        
-00012980: 2020 2020 6173 7365 7274 2022 6375 7272      assert "curr
-00012990: 656e 7442 6c6f 636b 2220 696e 2073 796e  entBlock" in syn
-000129a0: 635f 6469 6374 0a20 2020 2020 2020 2020  c_dict.         
-000129b0: 2020 2061 7373 6572 7420 2268 6967 6865     assert "highe
-000129c0: 7374 426c 6f63 6b22 2069 6e20 7379 6e63  stBlock" in sync
-000129d0: 5f64 6963 740a 0a20 2020 2020 2020 2020  _dict..         
-000129e0: 2020 2061 7373 6572 7420 6973 5f69 6e74     assert is_int
-000129f0: 6567 6572 2873 796e 635f 6469 6374 5b22  eger(sync_dict["
-00012a00: 7374 6172 7469 6e67 426c 6f63 6b22 5d29  startingBlock"])
-00012a10: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-00012a20: 6572 7420 6973 5f69 6e74 6567 6572 2873  ert is_integer(s
-00012a30: 796e 635f 6469 6374 5b22 6375 7272 656e  ync_dict["curren
-00012a40: 7442 6c6f 636b 225d 290a 2020 2020 2020  tBlock"]).      
-00012a50: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00012a60: 696e 7465 6765 7228 7379 6e63 5f64 6963  integer(sync_dic
-00012a70: 745b 2268 6967 6865 7374 426c 6f63 6b22  t["highestBlock"
-00012a80: 5d29 0a0a 2020 2020 4070 7974 6573 742e  ])..    @pytest.
-00012a90: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-00012aa0: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-00012ab0: 6173 796e 635f 6574 685f 6765 745f 7374  async_eth_get_st
-00012ac0: 6f72 6167 655f 6174 280a 2020 2020 2020  orage_at(.      
-00012ad0: 2020 7365 6c66 2c20 6173 796e 635f 7733    self, async_w3
-00012ae0: 3a20 2241 7379 6e63 5765 6233 222c 2061  : "AsyncWeb3", a
-00012af0: 7379 6e63 5f73 746f 7261 6765 5f63 6f6e  sync_storage_con
-00012b00: 7472 6163 743a 2022 436f 6e74 7261 6374  tract: "Contract
-00012b10: 220a 2020 2020 2920 2d3e 204e 6f6e 653a  ".    ) -> None:
-00012b20: 0a20 2020 2020 2020 2061 7379 6e63 5f73  .        async_s
-00012b30: 746f 7261 6765 5f63 6f6e 7472 6163 745f  torage_contract_
-00012b40: 6164 6472 6573 7320 3d20 6173 796e 635f  address = async_
-00012b50: 7374 6f72 6167 655f 636f 6e74 7261 6374  storage_contract
-00012b60: 2e61 6464 7265 7373 0a0a 2020 2020 2020  .address..      
-00012b70: 2020 736c 6f74 5f30 203d 2061 7761 6974    slot_0 = await
-00012b80: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00012b90: 745f 7374 6f72 6167 655f 6174 2861 7379  t_storage_at(asy
-00012ba0: 6e63 5f73 746f 7261 6765 5f63 6f6e 7472  nc_storage_contr
-00012bb0: 6163 745f 6164 6472 6573 732c 2030 290a  act_address, 0).
-00012bc0: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
-00012bd0: 6c6f 745f 3020 3d3d 2048 6578 4279 7465  lot_0 == HexByte
-00012be0: 7328 6622 3078 7b27 3030 2720 2a20 3332  s(f"0x{'00' * 32
-00012bf0: 7d22 290a 0a20 2020 2020 2020 2073 6c6f  }")..        slo
-00012c00: 745f 3120 3d20 6177 6169 7420 6173 796e  t_1 = await asyn
-00012c10: 635f 7733 2e65 7468 2e67 6574 5f73 746f  c_w3.eth.get_sto
-00012c20: 7261 6765 5f61 7428 6173 796e 635f 7374  rage_at(async_st
-00012c30: 6f72 6167 655f 636f 6e74 7261 6374 5f61  orage_contract_a
-00012c40: 6464 7265 7373 2c20 3129 0a20 2020 2020  ddress, 1).     
-00012c50: 2020 2061 7373 6572 7420 736c 6f74 5f31     assert slot_1
-00012c60: 203d 3d20 4865 7842 7974 6573 2866 2230   == HexBytes(f"0
-00012c70: 787b 2730 3027 202a 2033 317d 3031 2229  x{'00' * 31}01")
-00012c80: 0a0a 2020 2020 2020 2020 736c 6f74 5f32  ..        slot_2
-00012c90: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-00012ca0: 332e 6574 682e 6765 745f 7374 6f72 6167  3.eth.get_storag
-00012cb0: 655f 6174 2861 7379 6e63 5f73 746f 7261  e_at(async_stora
-00012cc0: 6765 5f63 6f6e 7472 6163 745f 6164 6472  ge_contract_addr
-00012cd0: 6573 732c 2032 290a 2020 2020 2020 2020  ess, 2).        
-00012ce0: 6173 7365 7274 2073 6c6f 745f 3220 3d3d  assert slot_2 ==
-00012cf0: 2048 6578 4279 7465 7328 6622 3078 7b27   HexBytes(f"0x{'
-00012d00: 3030 2720 2a20 3331 7d30 3222 290a 0a20  00' * 31}02").. 
-00012d10: 2020 2020 2020 2073 6c6f 745f 3320 3d20         slot_3 = 
-00012d20: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
-00012d30: 7468 2e67 6574 5f73 746f 7261 6765 5f61  th.get_storage_a
-00012d40: 7428 6173 796e 635f 7374 6f72 6167 655f  t(async_storage_
-00012d50: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
-00012d60: 2c20 3329 0a20 2020 2020 2020 2061 7373  , 3).        ass
-00012d70: 6572 7420 736c 6f74 5f33 203d 3d20 4865  ert slot_3 == He
-00012d80: 7842 7974 6573 280a 2020 2020 2020 2020  xBytes(.        
-00012d90: 2020 2020 2230 7837 3436 3837 3236 3536      "0x746872656
-00012da0: 3530 3030 3030 3030 3030 3030 3030 3030  5000000000000000
+00012300: 3030 3030 6434 3331 220a 2020 2020 2020  0000d431".      
+00012310: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00012320: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00012330: 2020 2020 7d0a 0a20 2020 2020 2020 2072      }..        r
+00012340: 6573 756c 7420 3d20 6177 6169 7420 6173  esult = await as
+00012350: 796e 635f 7733 2e65 7468 2e67 6574 5f6c  ync_w3.eth.get_l
+00012360: 6f67 7328 6669 6c74 6572 5f70 6172 616d  ogs(filter_param
+00012370: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
+00012380: 745f 636f 6e74 6169 6e73 5f6c 6f67 280a  t_contains_log(.
+00012390: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+000123a0: 6c74 2c0a 2020 2020 2020 2020 2020 2020  lt,.            
+000123b0: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
+000123c0: 5f74 786e 5f77 6974 685f 6c6f 672c 0a20  _txn_with_log,. 
+000123d0: 2020 2020 2020 2020 2020 2061 7379 6e63             async
+000123e0: 5f65 6d69 7474 6572 5f63 6f6e 7472 6163  _emitter_contrac
+000123f0: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
+00012400: 2020 2020 2020 2074 786e 5f68 6173 685f         txn_hash_
+00012410: 7769 7468 5f6c 6f67 2c0a 2020 2020 2020  with_log,.      
+00012420: 2020 290a 0a20 2020 2020 2020 2023 2054    )..        # T
+00012430: 6573 7420 7769 7468 204e 6f6e 6520 696e  est with None in
+00012440: 6465 7865 6420 6172 670a 2020 2020 2020  dexed arg.      
+00012450: 2020 6669 6c74 6572 5f70 6172 616d 7320    filter_params 
+00012460: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00012470: 2266 726f 6d42 6c6f 636b 223a 2042 6c6f  "fromBlock": Blo
+00012480: 636b 4e75 6d62 6572 2830 292c 0a20 2020  ckNumber(0),.   
+00012490: 2020 2020 2020 2020 2022 746f 7069 6373           "topics
+000124a0: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
+000124b0: 2020 2020 2048 6578 5374 7228 0a20 2020       HexStr(.   
+000124c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000124d0: 2022 3078 3035 3762 6333 3238 3236 6662   "0x057bc32826fb
+000124e0: 6531 3631 6461 3163 3131 3061 6663 6463  e161da1c110afcdc
+000124f0: 6165 3763 3130 3961 3862 3639 3134 3966  ae7c109a8b69149f
+00012500: 3732 3766 6333 3761 3630 3363 3630 6566  727fc37a603c60ef
+00012510: 3934 6361 220a 2020 2020 2020 2020 2020  94ca".          
+00012520: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+00012530: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
+00012540: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
+00012550: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00012560: 7265 7375 6c74 203d 2061 7761 6974 2061  result = await a
+00012570: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+00012580: 6c6f 6773 2866 696c 7465 725f 7061 7261  logs(filter_para
+00012590: 6d73 290a 2020 2020 2020 2020 6173 7365  ms).        asse
+000125a0: 7274 5f63 6f6e 7461 696e 735f 6c6f 6728  rt_contains_log(
+000125b0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+000125c0: 756c 742c 0a20 2020 2020 2020 2020 2020  ult,.           
+000125d0: 2061 7379 6e63 5f62 6c6f 636b 5f77 6974   async_block_wit
+000125e0: 685f 7478 6e5f 7769 7468 5f6c 6f67 2c0a  h_txn_with_log,.
+000125f0: 2020 2020 2020 2020 2020 2020 6173 796e              asyn
+00012600: 635f 656d 6974 7465 725f 636f 6e74 7261  c_emitter_contra
+00012610: 6374 5f61 6464 7265 7373 2c0a 2020 2020  ct_address,.    
+00012620: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+00012630: 5f77 6974 685f 6c6f 672c 0a20 2020 2020  _with_log,.     
+00012640: 2020 2029 0a0a 2020 2020 4070 7974 6573     )..    @pytes
+00012650: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+00012660: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+00012670: 745f 6173 796e 635f 6574 685f 6765 745f  t_async_eth_get_
+00012680: 6c6f 6773 5f77 6974 685f 6c6f 6773 5f6e  logs_with_logs_n
+00012690: 6f6e 655f 746f 7069 635f 6172 6773 280a  one_topic_args(.
+000126a0: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+000126b0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+000126c0: 6233 220a 2020 2020 2920 2d3e 204e 6f6e  b3".    ) -> Non
+000126d0: 653a 0a20 2020 2020 2020 2023 2054 6573  e:.        # Tes
+000126e0: 7420 7769 7468 204e 6f6e 6520 6f76 6572  t with None over
+000126f0: 666c 6f77 696e 670a 2020 2020 2020 2020  flowing.        
+00012700: 6669 6c74 6572 5f70 6172 616d 733a 2046  filter_params: F
+00012710: 696c 7465 7250 6172 616d 7320 3d20 7b0a  ilterParams = {.
+00012720: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+00012730: 6d42 6c6f 636b 223a 2042 6c6f 636b 4e75  mBlock": BlockNu
+00012740: 6d62 6572 2830 292c 0a20 2020 2020 2020  mber(0),.       
+00012750: 2020 2020 2022 746f 7069 6373 223a 205b       "topics": [
+00012760: 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f 6e65  None, None, None
+00012770: 5d2c 0a20 2020 2020 2020 207d 0a0a 2020  ],.        }..  
+00012780: 2020 2020 2020 7265 7375 6c74 203d 2061        result = a
+00012790: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+000127a0: 682e 6765 745f 6c6f 6773 2866 696c 7465  h.get_logs(filte
+000127b0: 725f 7061 7261 6d73 290a 2020 2020 2020  r_params).      
+000127c0: 2020 6173 7365 7274 206c 656e 2872 6573    assert len(res
+000127d0: 756c 7429 203d 3d20 300a 0a20 2020 2040  ult) == 0..    @
+000127e0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+000127f0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+00012800: 6620 7465 7374 5f61 7379 6e63 5f65 7468  f test_async_eth
+00012810: 5f73 796e 6369 6e67 2873 656c 662c 2061  _syncing(self, a
+00012820: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
+00012830: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
+00012840: 2020 2020 2020 2073 796e 6369 6e67 203d         syncing =
+00012850: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00012860: 6574 682e 7379 6e63 696e 670a 0a20 2020  eth.syncing..   
+00012870: 2020 2020 2061 7373 6572 7420 6973 5f62       assert is_b
+00012880: 6f6f 6c65 616e 2873 796e 6369 6e67 2920  oolean(syncing) 
+00012890: 6f72 2069 735f 6469 6374 2873 796e 6369  or is_dict(synci
+000128a0: 6e67 290a 0a20 2020 2020 2020 2069 6620  ng)..        if 
+000128b0: 6973 5f62 6f6f 6c65 616e 2873 796e 6369  is_boolean(synci
+000128c0: 6e67 293a 0a20 2020 2020 2020 2020 2020  ng):.           
+000128d0: 2061 7373 6572 7420 7379 6e63 696e 6720   assert syncing 
+000128e0: 6973 2046 616c 7365 0a20 2020 2020 2020  is False.       
+000128f0: 2065 6c69 6620 6973 5f64 6963 7428 7379   elif is_dict(sy
+00012900: 6e63 696e 6729 3a0a 2020 2020 2020 2020  ncing):.        
+00012910: 2020 2020 7379 6e63 5f64 6963 7420 3d20      sync_dict = 
+00012920: 6361 7374 2853 796e 6353 7461 7475 732c  cast(SyncStatus,
+00012930: 2073 796e 6369 6e67 290a 2020 2020 2020   syncing).      
+00012940: 2020 2020 2020 6173 7365 7274 2022 7374        assert "st
+00012950: 6172 7469 6e67 426c 6f63 6b22 2069 6e20  artingBlock" in 
+00012960: 7379 6e63 5f64 6963 740a 2020 2020 2020  sync_dict.      
+00012970: 2020 2020 2020 6173 7365 7274 2022 6375        assert "cu
+00012980: 7272 656e 7442 6c6f 636b 2220 696e 2073  rrentBlock" in s
+00012990: 796e 635f 6469 6374 0a20 2020 2020 2020  ync_dict.       
+000129a0: 2020 2020 2061 7373 6572 7420 2268 6967       assert "hig
+000129b0: 6865 7374 426c 6f63 6b22 2069 6e20 7379  hestBlock" in sy
+000129c0: 6e63 5f64 6963 740a 0a20 2020 2020 2020  nc_dict..       
+000129d0: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
+000129e0: 6e74 6567 6572 2873 796e 635f 6469 6374  nteger(sync_dict
+000129f0: 5b22 7374 6172 7469 6e67 426c 6f63 6b22  ["startingBlock"
+00012a00: 5d29 0a20 2020 2020 2020 2020 2020 2061  ]).            a
+00012a10: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
+00012a20: 2873 796e 635f 6469 6374 5b22 6375 7272  (sync_dict["curr
+00012a30: 656e 7442 6c6f 636b 225d 290a 2020 2020  entBlock"]).    
+00012a40: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00012a50: 735f 696e 7465 6765 7228 7379 6e63 5f64  s_integer(sync_d
+00012a60: 6963 745b 2268 6967 6865 7374 426c 6f63  ict["highestBloc
+00012a70: 6b22 5d29 0a0a 2020 2020 4070 7974 6573  k"])..    @pytes
+00012a80: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+00012a90: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+00012aa0: 745f 6173 796e 635f 6574 685f 6765 745f  t_async_eth_get_
+00012ab0: 7374 6f72 6167 655f 6174 280a 2020 2020  storage_at(.    
+00012ac0: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
+00012ad0: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+00012ae0: 2061 7379 6e63 5f73 746f 7261 6765 5f63   async_storage_c
+00012af0: 6f6e 7472 6163 743a 2022 4173 796e 6343  ontract: "AsyncC
+00012b00: 6f6e 7472 6163 7422 0a20 2020 2029 202d  ontract".    ) -
+00012b10: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00012b20: 6173 796e 635f 7374 6f72 6167 655f 636f  async_storage_co
+00012b30: 6e74 7261 6374 5f61 6464 7265 7373 203d  ntract_address =
+00012b40: 2061 7379 6e63 5f73 746f 7261 6765 5f63   async_storage_c
+00012b50: 6f6e 7472 6163 742e 6164 6472 6573 730a  ontract.address.
+00012b60: 0a20 2020 2020 2020 2073 6c6f 745f 3020  .        slot_0 
+00012b70: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00012b80: 2e65 7468 2e67 6574 5f73 746f 7261 6765  .eth.get_storage
+00012b90: 5f61 7428 6173 796e 635f 7374 6f72 6167  _at(async_storag
+00012ba0: 655f 636f 6e74 7261 6374 5f61 6464 7265  e_contract_addre
+00012bb0: 7373 2c20 3029 0a20 2020 2020 2020 2061  ss, 0).        a
+00012bc0: 7373 6572 7420 736c 6f74 5f30 203d 3d20  ssert slot_0 == 
+00012bd0: 4865 7842 7974 6573 2866 2230 787b 2730  HexBytes(f"0x{'0
+00012be0: 3027 202a 2033 327d 2229 0a0a 2020 2020  0' * 32}")..    
+00012bf0: 2020 2020 736c 6f74 5f31 203d 2061 7761      slot_1 = awa
+00012c00: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00012c10: 6765 745f 7374 6f72 6167 655f 6174 2861  get_storage_at(a
+00012c20: 7379 6e63 5f73 746f 7261 6765 5f63 6f6e  sync_storage_con
+00012c30: 7472 6163 745f 6164 6472 6573 732c 2031  tract_address, 1
+00012c40: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00012c50: 2073 6c6f 745f 3120 3d3d 2048 6578 4279   slot_1 == HexBy
+00012c60: 7465 7328 6622 3078 7b27 3030 2720 2a20  tes(f"0x{'00' * 
+00012c70: 3331 7d30 3122 290a 0a20 2020 2020 2020  31}01")..       
+00012c80: 2073 6c6f 745f 3220 3d20 6177 6169 7420   slot_2 = await 
+00012c90: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
+00012ca0: 5f73 746f 7261 6765 5f61 7428 6173 796e  _storage_at(asyn
+00012cb0: 635f 7374 6f72 6167 655f 636f 6e74 7261  c_storage_contra
+00012cc0: 6374 5f61 6464 7265 7373 2c20 3229 0a20  ct_address, 2). 
+00012cd0: 2020 2020 2020 2061 7373 6572 7420 736c         assert sl
+00012ce0: 6f74 5f32 203d 3d20 4865 7842 7974 6573  ot_2 == HexBytes
+00012cf0: 2866 2230 787b 2730 3027 202a 2033 317d  (f"0x{'00' * 31}
+00012d00: 3032 2229 0a0a 2020 2020 2020 2020 736c  02")..        sl
+00012d10: 6f74 5f33 203d 2061 7761 6974 2061 7379  ot_3 = await asy
+00012d20: 6e63 5f77 332e 6574 682e 6765 745f 7374  nc_w3.eth.get_st
+00012d30: 6f72 6167 655f 6174 2861 7379 6e63 5f73  orage_at(async_s
+00012d40: 746f 7261 6765 5f63 6f6e 7472 6163 745f  torage_contract_
+00012d50: 6164 6472 6573 732c 2033 290a 2020 2020  address, 3).    
+00012d60: 2020 2020 6173 7365 7274 2073 6c6f 745f      assert slot_
+00012d70: 3320 3d3d 2048 6578 4279 7465 7328 0a20  3 == HexBytes(. 
+00012d80: 2020 2020 2020 2020 2020 2022 3078 3734             "0x74
+00012d90: 3638 3732 3635 3635 3030 3030 3030 3030  6872656500000000
+00012da0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 00012db0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00012dc0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00012dd0: 3030 3030 3030 6122 0a20 2020 2020 2020  000000a".       
-00012de0: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
-00012df0: 7420 6279 7465 7328 736c 6f74 5f33 5b3a  t bytes(slot_3[:
-00012e00: 355d 2920 3d3d 2062 2274 6872 6565 220a  5]) == b"three".
-00012e10: 0a20 2020 2020 2020 2073 6c6f 745f 3420  .        slot_4 
-00012e20: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-00012e30: 2e65 7468 2e67 6574 5f73 746f 7261 6765  .eth.get_storage
-00012e40: 5f61 7428 6173 796e 635f 7374 6f72 6167  _at(async_storag
-00012e50: 655f 636f 6e74 7261 6374 5f61 6464 7265  e_contract_addre
-00012e60: 7373 2c20 3429 0a20 2020 2020 2020 2061  ss, 4).        a
-00012e70: 7373 6572 7420 736c 6f74 5f34 203d 3d20  ssert slot_4 == 
-00012e80: 4865 7842 7974 6573 280a 2020 2020 2020  HexBytes(.      
-00012e90: 2020 2020 2020 2230 7836 3636 6637 3537        "0x666f757
-00012ea0: 3230 3030 3030 3030 3030 3030 3030 3030  2000000000000000
+00012dc0: 3030 3030 3030 3030 3030 3030 3061 220a  0000000000000a".
+00012dd0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00012de0: 2020 6173 7365 7274 2062 7974 6573 2873    assert bytes(s
+00012df0: 6c6f 745f 335b 3a35 5d29 203d 3d20 6222  lot_3[:5]) == b"
+00012e00: 7468 7265 6522 0a0a 2020 2020 2020 2020  three"..        
+00012e10: 736c 6f74 5f34 203d 2061 7761 6974 2061  slot_4 = await a
+00012e20: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+00012e30: 7374 6f72 6167 655f 6174 2861 7379 6e63  storage_at(async
+00012e40: 5f73 746f 7261 6765 5f63 6f6e 7472 6163  _storage_contrac
+00012e50: 745f 6164 6472 6573 732c 2034 290a 2020  t_address, 4).  
+00012e60: 2020 2020 2020 6173 7365 7274 2073 6c6f        assert slo
+00012e70: 745f 3420 3d3d 2048 6578 4279 7465 7328  t_4 == HexBytes(
+00012e80: 0a20 2020 2020 2020 2020 2020 2022 3078  .            "0x
+00012e90: 3636 3666 3735 3732 3030 3030 3030 3030  666f757200000000
+00012ea0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 00012eb0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00012ec0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00012ed0: 3030 3030 3030 3030 3822 0a20 2020 2020  000000008".     
-00012ee0: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
-00012ef0: 6572 7420 6279 7465 7328 736c 6f74 5f34  ert bytes(slot_4
-00012f00: 5b3a 345d 2920 3d3d 2062 2266 6f75 7222  [:4]) == b"four"
-00012f10: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-00012f20: 726b 2e61 7379 6e63 696f 0a20 2020 2040  rk.asyncio.    @
-00012f30: 7079 7465 7374 2e6d 6172 6b2e 7866 6169  pytest.mark.xfai
-00012f40: 6c0a 2020 2020 6173 796e 6320 6465 6620  l.    async def 
-00012f50: 7465 7374 5f61 7379 6e63 5f65 7468 5f67  test_async_eth_g
-00012f60: 6574 5f73 746f 7261 6765 5f61 745f 656e  et_storage_at_en
-00012f70: 735f 6e61 6d65 280a 2020 2020 2020 2020  s_name(.        
-00012f80: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-00012f90: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
-00012fa0: 6e63 5f73 746f 7261 6765 5f63 6f6e 7472  nc_storage_contr
-00012fb0: 6163 743a 2022 436f 6e74 7261 6374 220a  act: "Contract".
-00012fc0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00012fd0: 2020 2020 2020 2077 6974 6820 656e 735f         with ens_
-00012fe0: 6164 6472 6573 7365 7328 6173 796e 635f  addresses(async_
-00012ff0: 7733 2c20 7b22 7374 6f72 6167 652e 6574  w3, {"storage.et
-00013000: 6822 3a20 6173 796e 635f 7374 6f72 6167  h": async_storag
-00013010: 655f 636f 6e74 7261 6374 2e61 6464 7265  e_contract.addre
-00013020: 7373 7d29 3a0a 2020 2020 2020 2020 2020  ss}):.          
-00013030: 2020 7374 6f72 6167 6520 3d20 6177 6169    storage = awai
-00013040: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
-00013050: 6574 5f73 746f 7261 6765 5f61 7428 454e  et_storage_at(EN
-00013060: 5328 2273 746f 7261 6765 2e65 7468 2229  S("storage.eth")
-00013070: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
-00013080: 2061 7373 6572 7420 7374 6f72 6167 6520   assert storage 
-00013090: 3d3d 2048 6578 4279 7465 7328 6622 3078  == HexBytes(f"0x
-000130a0: 7b27 3030 2720 2a20 3331 7d30 3122 290a  {'00' * 31}01").
-000130b0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-000130c0: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-000130d0: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
-000130e0: 6e63 5f65 7468 5f67 6574 5f73 746f 7261  nc_eth_get_stora
-000130f0: 6765 5f61 745f 696e 7661 6c69 645f 6164  ge_at_invalid_ad
-00013100: 6472 6573 7328 0a20 2020 2020 2020 2073  dress(.        s
-00013110: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
-00013120: 4173 796e 6357 6562 3322 0a20 2020 2029  AsyncWeb3".    )
-00013130: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00013140: 2020 636f 696e 6261 7365 203d 2061 7761    coinbase = awa
-00013150: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00013160: 636f 696e 6261 7365 0a20 2020 2020 2020  coinbase.       
-00013170: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-00013180: 7365 7328 496e 7661 6c69 6441 6464 7265  ses(InvalidAddre
-00013190: 7373 293a 0a20 2020 2020 2020 2020 2020  ss):.           
-000131a0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-000131b0: 6574 682e 6765 745f 7374 6f72 6167 655f  eth.get_storage_
-000131c0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-000131d0: 2020 2020 4368 6563 6b73 756d 4164 6472      ChecksumAddr
-000131e0: 6573 7328 4865 7841 6464 7265 7373 2848  ess(HexAddress(H
-000131f0: 6578 5374 7228 636f 696e 6261 7365 2e6c  exStr(coinbase.l
-00013200: 6f77 6572 2829 2929 292c 2030 0a20 2020  ower()))), 0.   
-00013210: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00013220: 6465 6620 7465 7374 5f61 7379 6e63 5f70  def test_async_p
-00013230: 726f 7669 6465 725f 6465 6661 756c 745f  rovider_default_
-00013240: 6163 636f 756e 7428 0a20 2020 2020 2020  account(.       
-00013250: 2073 656c 662c 2061 7379 6e63 5f77 333a   self, async_w3:
-00013260: 2022 4173 796e 6357 6562 3322 2c20 6173   "AsyncWeb3", as
-00013270: 796e 635f 756e 6c6f 636b 6564 5f61 6363  ync_unlocked_acc
-00013280: 6f75 6e74 5f64 7561 6c5f 7479 7065 3a20  ount_dual_type: 
-00013290: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
-000132a0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-000132b0: 2020 2020 2020 2023 2063 6865 636b 2064         # check d
-000132c0: 6566 6175 6c74 7320 746f 2065 6d70 7479  efaults to empty
-000132d0: 0a20 2020 2020 2020 2064 6566 6175 6c74  .        default
-000132e0: 5f61 6363 6f75 6e74 203d 2061 7379 6e63  _account = async
-000132f0: 5f77 332e 6574 682e 6465 6661 756c 745f  _w3.eth.default_
-00013300: 6163 636f 756e 740a 2020 2020 2020 2020  account.        
-00013310: 6173 7365 7274 2064 6566 6175 6c74 5f61  assert default_a
-00013320: 6363 6f75 6e74 2069 7320 656d 7074 790a  ccount is empty.
-00013330: 0a20 2020 2020 2020 2023 2063 6865 636b  .        # check
-00013340: 2073 6574 7465 720a 2020 2020 2020 2020   setter.        
-00013350: 6173 796e 635f 7733 2e65 7468 2e64 6566  async_w3.eth.def
-00013360: 6175 6c74 5f61 6363 6f75 6e74 203d 2061  ault_account = a
-00013370: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
-00013380: 636f 756e 745f 6475 616c 5f74 7970 650a  count_dual_type.
-00013390: 2020 2020 2020 2020 6465 6661 756c 745f          default_
-000133a0: 6163 636f 756e 7420 3d20 6173 796e 635f  account = async_
-000133b0: 7733 2e65 7468 2e64 6566 6175 6c74 5f61  w3.eth.default_a
-000133c0: 6363 6f75 6e74 0a20 2020 2020 2020 2061  ccount.        a
-000133d0: 7373 6572 7420 6465 6661 756c 745f 6163  ssert default_ac
-000133e0: 636f 756e 7420 3d3d 2061 7379 6e63 5f75  count == async_u
-000133f0: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
-00013400: 6475 616c 5f74 7970 650a 0a20 2020 2020  dual_type..     
-00013410: 2020 2023 2072 6573 6574 2074 6f20 6465     # reset to de
-00013420: 6661 756c 740a 2020 2020 2020 2020 6173  fault.        as
-00013430: 796e 635f 7733 2e65 7468 2e64 6566 6175  ync_w3.eth.defau
-00013440: 6c74 5f61 6363 6f75 6e74 203d 2065 6d70  lt_account = emp
-00013450: 7479 0a0a 2020 2020 6465 6620 7465 7374  ty..    def test
-00013460: 5f61 7379 6e63 5f70 726f 7669 6465 725f  _async_provider_
-00013470: 6465 6661 756c 745f 626c 6f63 6b28 0a20  default_block(. 
-00013480: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00013490: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
-000134a0: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
-000134b0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-000134c0: 2020 2023 2063 6865 636b 2064 6566 6175     # check defau
-000134d0: 6c74 7320 746f 2027 6c61 7465 7374 270a  lts to 'latest'.
-000134e0: 2020 2020 2020 2020 6465 6661 756c 745f          default_
-000134f0: 626c 6f63 6b20 3d20 6173 796e 635f 7733  block = async_w3
-00013500: 2e65 7468 2e64 6566 6175 6c74 5f62 6c6f  .eth.default_blo
-00013510: 636b 0a20 2020 2020 2020 2061 7373 6572  ck.        asser
-00013520: 7420 6465 6661 756c 745f 626c 6f63 6b20  t default_block 
-00013530: 3d3d 2022 6c61 7465 7374 220a 0a20 2020  == "latest"..   
-00013540: 2020 2020 2023 2063 6865 636b 2073 6574       # check set
-00013550: 7465 720a 2020 2020 2020 2020 6173 796e  ter.        asyn
-00013560: 635f 7733 2e65 7468 2e64 6566 6175 6c74  c_w3.eth.default
-00013570: 5f62 6c6f 636b 203d 2042 6c6f 636b 4e75  _block = BlockNu
-00013580: 6d62 6572 2831 3233 3435 290a 2020 2020  mber(12345).    
-00013590: 2020 2020 6465 6661 756c 745f 626c 6f63      default_bloc
-000135a0: 6b20 3d20 6173 796e 635f 7733 2e65 7468  k = async_w3.eth
-000135b0: 2e64 6566 6175 6c74 5f62 6c6f 636b 0a20  .default_block. 
-000135c0: 2020 2020 2020 2061 7373 6572 7420 6465         assert de
-000135d0: 6661 756c 745f 626c 6f63 6b20 3d3d 2042  fault_block == B
-000135e0: 6c6f 636b 4e75 6d62 6572 2831 3233 3435  lockNumber(12345
-000135f0: 290a 0a20 2020 2020 2020 2023 2072 6573  )..        # res
-00013600: 6574 2074 6f20 6465 6661 756c 740a 2020  et to default.  
-00013610: 2020 2020 2020 6173 796e 635f 7733 2e65        async_w3.e
-00013620: 7468 2e64 6566 6175 6c74 5f62 6c6f 636b  th.default_block
-00013630: 203d 2022 6c61 7465 7374 220a 0a20 2020   = "latest"..   
-00013640: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-00013650: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-00013660: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-00013670: 426c 6f63 6b54 7261 6e73 6163 7469 6f6e  BlockTransaction
-00013680: 436f 756e 7442 7948 6173 685f 6173 796e  CountByHash_asyn
-00013690: 635f 656d 7074 795f 626c 6f63 6b28 0a20  c_empty_block(. 
-000136a0: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
-000136b0: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-000136c0: 3322 2c20 6173 796e 635f 656d 7074 795f  3", async_empty_
-000136d0: 626c 6f63 6b3a 2042 6c6f 636b 4461 7461  block: BlockData
-000136e0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-000136f0: 2020 2020 2020 2020 7472 616e 7361 6374          transact
-00013700: 696f 6e5f 636f 756e 7420 3d20 6177 6169  ion_count = awai
-00013710: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
-00013720: 6574 5f62 6c6f 636b 5f74 7261 6e73 6163  et_block_transac
-00013730: 7469 6f6e 5f63 6f75 6e74 280a 2020 2020  tion_count(.    
-00013740: 2020 2020 2020 2020 6173 796e 635f 656d          async_em
-00013750: 7074 795f 626c 6f63 6b5b 2268 6173 6822  pty_block["hash"
-00013760: 5d0a 2020 2020 2020 2020 290a 0a20 2020  ].        )..   
-00013770: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
-00013780: 6e74 6567 6572 2874 7261 6e73 6163 7469  nteger(transacti
-00013790: 6f6e 5f63 6f75 6e74 290a 2020 2020 2020  on_count).      
-000137a0: 2020 6173 7365 7274 2074 7261 6e73 6163    assert transac
-000137b0: 7469 6f6e 5f63 6f75 6e74 203d 3d20 300a  tion_count == 0.
-000137c0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-000137d0: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-000137e0: 796e 6320 6465 6620 7465 7374 5f65 7468  ync def test_eth
-000137f0: 5f67 6574 426c 6f63 6b54 7261 6e73 6163  _getBlockTransac
-00013800: 7469 6f6e 436f 756e 7442 794e 756d 6265  tionCountByNumbe
-00013810: 725f 6173 796e 635f 656d 7074 795f 626c  r_async_empty_bl
-00013820: 6f63 6b28 0a20 2020 2020 2020 2073 656c  ock(.        sel
-00013830: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-00013840: 796e 6357 6562 3322 2c20 6173 796e 635f  yncWeb3", async_
-00013850: 656d 7074 795f 626c 6f63 6b3a 2042 6c6f  empty_block: Blo
-00013860: 636b 4461 7461 0a20 2020 2029 202d 3e20  ckData.    ) -> 
-00013870: 4e6f 6e65 3a0a 2020 2020 2020 2020 7472  None:.        tr
-00013880: 616e 7361 6374 696f 6e5f 636f 756e 7420  ansaction_count 
-00013890: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-000138a0: 2e65 7468 2e67 6574 5f62 6c6f 636b 5f74  .eth.get_block_t
-000138b0: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
-000138c0: 280a 2020 2020 2020 2020 2020 2020 6173  (.            as
-000138d0: 796e 635f 656d 7074 795f 626c 6f63 6b5b  ync_empty_block[
-000138e0: 226e 756d 6265 7222 5d0a 2020 2020 2020  "number"].      
-000138f0: 2020 290a 0a20 2020 2020 2020 2061 7373    )..        ass
-00013900: 6572 7420 6973 5f69 6e74 6567 6572 2874  ert is_integer(t
-00013910: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
-00013920: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00013930: 2074 7261 6e73 6163 7469 6f6e 5f63 6f75   transaction_cou
-00013940: 6e74 203d 3d20 300a 0a20 2020 2040 7079  nt == 0..    @py
-00013950: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-00013960: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
-00013970: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
-00013980: 6b54 7261 6e73 6163 7469 6f6e 436f 756e  kTransactionCoun
-00013990: 7442 7948 6173 685f 626c 6f63 6b5f 7769  tByHash_block_wi
-000139a0: 7468 5f74 786e 280a 2020 2020 2020 2020  th_txn(.        
-000139b0: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-000139c0: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
-000139d0: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
-000139e0: 6e3a 2042 6c6f 636b 4461 7461 0a20 2020  n: BlockData.   
-000139f0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00013a00: 2020 2020 7472 616e 7361 6374 696f 6e5f      transaction_
-00013a10: 636f 756e 7420 3d20 6177 6169 7420 6173  count = await as
-00013a20: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
-00013a30: 6c6f 636b 5f74 7261 6e73 6163 7469 6f6e  lock_transaction
-00013a40: 5f63 6f75 6e74 280a 2020 2020 2020 2020  _count(.        
-00013a50: 2020 2020 6173 796e 635f 626c 6f63 6b5f      async_block_
-00013a60: 7769 7468 5f74 786e 5b22 6861 7368 225d  with_txn["hash"]
-00013a70: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00013a80: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
-00013a90: 7465 6765 7228 7472 616e 7361 6374 696f  teger(transactio
-00013aa0: 6e5f 636f 756e 7429 0a20 2020 2020 2020  n_count).       
-00013ab0: 2061 7373 6572 7420 7472 616e 7361 6374   assert transact
-00013ac0: 696f 6e5f 636f 756e 7420 3e3d 2031 0a0a  ion_count >= 1..
-00013ad0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00013ae0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-00013af0: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
-00013b00: 6765 7455 6e63 6c65 436f 756e 7442 7942  getUncleCountByB
-00013b10: 6c6f 636b 4861 7368 280a 2020 2020 2020  lockHash(.      
-00013b20: 2020 7365 6c66 2c20 6173 796e 635f 7733    self, async_w3
-00013b30: 3a20 2241 7379 6e63 5765 6233 222c 2061  : "AsyncWeb3", a
-00013b40: 7379 6e63 5f65 6d70 7479 5f62 6c6f 636b  sync_empty_block
-00013b50: 3a20 426c 6f63 6b44 6174 610a 2020 2020  : BlockData.    
-00013b60: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00013b70: 2020 2075 6e63 6c65 5f63 6f75 6e74 203d     uncle_count =
-00013b80: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00013b90: 6574 682e 6765 745f 756e 636c 655f 636f  eth.get_uncle_co
-00013ba0: 756e 7428 6173 796e 635f 656d 7074 795f  unt(async_empty_
-00013bb0: 626c 6f63 6b5b 2268 6173 6822 5d29 0a0a  block["hash"])..
-00013bc0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00013bd0: 735f 696e 7465 6765 7228 756e 636c 655f  s_integer(uncle_
-00013be0: 636f 756e 7429 0a20 2020 2020 2020 2061  count).        a
-00013bf0: 7373 6572 7420 756e 636c 655f 636f 756e  ssert uncle_coun
-00013c00: 7420 3d3d 2030 0a0a 2020 2020 4070 7974  t == 0..    @pyt
-00013c10: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00013c20: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-00013c30: 6573 745f 6574 685f 6765 7455 6e63 6c65  est_eth_getUncle
-00013c40: 436f 756e 7442 7942 6c6f 636b 4e75 6d62  CountByBlockNumb
-00013c50: 6572 280a 2020 2020 2020 2020 7365 6c66  er(.        self
-00013c60: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
-00013c70: 6e63 5765 6233 222c 2061 7379 6e63 5f65  ncWeb3", async_e
-00013c80: 6d70 7479 5f62 6c6f 636b 3a20 426c 6f63  mpty_block: Bloc
-00013c90: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
-00013ca0: 6f6e 653a 0a20 2020 2020 2020 2075 6e63  one:.        unc
-00013cb0: 6c65 5f63 6f75 6e74 203d 2061 7761 6974  le_count = await
-00013cc0: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00013cd0: 745f 756e 636c 655f 636f 756e 7428 6173  t_uncle_count(as
-00013ce0: 796e 635f 656d 7074 795f 626c 6f63 6b5b  ync_empty_block[
-00013cf0: 226e 756d 6265 7222 5d29 0a0a 2020 2020  "number"])..    
-00013d00: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
-00013d10: 7465 6765 7228 756e 636c 655f 636f 756e  teger(uncle_coun
-00013d20: 7429 0a20 2020 2020 2020 2061 7373 6572  t).        asser
-00013d30: 7420 756e 636c 655f 636f 756e 7420 3d3d  t uncle_count ==
-00013d40: 2030 0a0a 2020 2020 4070 7974 6573 742e   0..    @pytest.
-00013d50: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-00013d60: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-00013d70: 6574 685f 6765 7442 6c6f 636b 5472 616e  eth_getBlockTran
-00013d80: 7361 6374 696f 6e43 6f75 6e74 4279 4e75  sactionCountByNu
-00013d90: 6d62 6572 5f62 6c6f 636b 5f77 6974 685f  mber_block_with_
-00013da0: 7478 6e28 0a20 2020 2020 2020 2073 656c  txn(.        sel
-00013db0: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-00013dc0: 796e 6357 6562 3322 2c20 6173 796e 635f  yncWeb3", async_
-00013dd0: 626c 6f63 6b5f 7769 7468 5f74 786e 3a20  block_with_txn: 
-00013de0: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
-00013df0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00013e00: 2074 7261 6e73 6163 7469 6f6e 5f63 6f75   transaction_cou
-00013e10: 6e74 203d 2061 7761 6974 2061 7379 6e63  nt = await async
-00013e20: 5f77 332e 6574 682e 6765 745f 626c 6f63  _w3.eth.get_bloc
-00013e30: 6b5f 7472 616e 7361 6374 696f 6e5f 636f  k_transaction_co
-00013e40: 756e 7428 0a20 2020 2020 2020 2020 2020  unt(.           
-00013e50: 2061 7379 6e63 5f62 6c6f 636b 5f77 6974   async_block_wit
-00013e60: 685f 7478 6e5b 226e 756d 6265 7222 5d0a  h_txn["number"].
-00013e70: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00013e80: 2020 2061 7373 6572 7420 6973 5f69 6e74     assert is_int
-00013e90: 6567 6572 2874 7261 6e73 6163 7469 6f6e  eger(transaction
-00013ea0: 5f63 6f75 6e74 290a 2020 2020 2020 2020  _count).        
-00013eb0: 6173 7365 7274 2074 7261 6e73 6163 7469  assert transacti
-00013ec0: 6f6e 5f63 6f75 6e74 203e 3d20 310a 0a20  on_count >= 1.. 
-00013ed0: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-00013ee0: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-00013ef0: 6320 6465 6620 7465 7374 5f61 7379 6e63  c def test_async
-00013f00: 5f65 7468 5f73 6967 6e28 0a20 2020 2020  _eth_sign(.     
-00013f10: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
-00013f20: 333a 2022 4173 796e 6357 6562 3322 2c20  3: "AsyncWeb3", 
-00013f30: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
-00013f40: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-00013f50: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-00013f60: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
-00013f70: 0a20 2020 2020 2020 2073 6967 6e61 7475  .        signatu
-00013f80: 7265 203d 2061 7761 6974 2061 7379 6e63  re = await async
-00013f90: 5f77 332e 6574 682e 7369 676e 280a 2020  _w3.eth.sign(.  
-00013fa0: 2020 2020 2020 2020 2020 6173 796e 635f            async_
-00013fb0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00013fc0: 5f64 7561 6c5f 7479 7065 2c20 7465 7874  _dual_type, text
-00013fd0: 3d22 4d65 7373 6167 6520 74c3 b620 7369  ="Message t.. si
-00013fe0: 676e 2e20 4c6f 6e67 6572 2074 6861 6e20  gn. Longer than 
-00013ff0: 6861 7368 2122 0a20 2020 2020 2020 2029  hash!".        )
-00014000: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00014010: 6973 5f62 7974 6573 2873 6967 6e61 7475  is_bytes(signatu
-00014020: 7265 290a 2020 2020 2020 2020 6173 7365  re).        asse
-00014030: 7274 206c 656e 2873 6967 6e61 7475 7265  rt len(signature
-00014040: 2920 3d3d 2033 3220 2b20 3332 202b 2031  ) == 32 + 32 + 1
-00014050: 0a0a 2020 2020 2020 2020 2320 7465 7374  ..        # test
-00014060: 206f 7468 6572 2066 6f72 6d61 7473 0a20   other formats. 
-00014070: 2020 2020 2020 2068 6578 7369 676e 203d         hexsign =
-00014080: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00014090: 6574 682e 7369 676e 280a 2020 2020 2020  eth.sign(.      
-000140a0: 2020 2020 2020 6173 796e 635f 756e 6c6f        async_unlo
-000140b0: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-000140c0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-000140d0: 2020 2020 6865 7873 7472 3d48 6578 5374      hexstr=HexSt
-000140e0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-000140f0: 2020 2022 3078 3464 3635 3733 3733 3631     "0x4d65737361
-00014100: 3637 3635 3230 3734 6333 6236 3230 3733  67652074c3b62073
-00014110: 3639 3637 3665 3265 3230 3463 3666 3665  69676e2e204c6f6e
-00014120: 3637 3635 3732 3230 3734 3638 3631 3665  676572207468616e
-00014130: 3230 3638 3631 3733 3638 3231 2220 2023  206861736821"  #
-00014140: 206e 6f71 613a 2045 3530 310a 2020 2020   noqa: E501.    
-00014150: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00014160: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
-00014170: 6572 7420 6865 7873 6967 6e20 3d3d 2073  ert hexsign == s
-00014180: 6967 6e61 7475 7265 0a0a 2020 2020 2020  ignature..      
-00014190: 2020 696e 7473 6967 6e20 3d20 6177 6169    intsign = awai
-000141a0: 7420 6173 796e 635f 7733 2e65 7468 2e73  t async_w3.eth.s
-000141b0: 6967 6e28 0a20 2020 2020 2020 2020 2020  ign(.           
-000141c0: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
-000141d0: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
-000141e0: 652c 0a20 2020 2020 2020 2020 2020 2030  e,.            0
-000141f0: 7834 4436 3537 3337 3336 3136 3736 3532  x4D6573736167652
-00014200: 3037 3443 3342 3632 3037 3336 3936 3736  074C3B6207369676
-00014210: 4532 4532 3034 4336 4636 4536 3736 3537  E2E204C6F6E67657
-00014220: 3232 3037 3436 3836 3136 4532 3036 3836  2207468616E20686
-00014230: 3137 3336 3832 312c 0a20 2020 2020 2020  1736821,.       
-00014240: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
-00014250: 7420 696e 7473 6967 6e20 3d3d 2073 6967  t intsign == sig
-00014260: 6e61 7475 7265 0a0a 2020 2020 2020 2020  nature..        
-00014270: 6279 7465 7373 6967 6e20 3d20 6177 6169  bytessign = awai
-00014280: 7420 6173 796e 635f 7733 2e65 7468 2e73  t async_w3.eth.s
-00014290: 6967 6e28 0a20 2020 2020 2020 2020 2020  ign(.           
-000142a0: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
-000142b0: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
-000142c0: 652c 0a20 2020 2020 2020 2020 2020 2062  e,.            b
-000142d0: 224d 6573 7361 6765 2074 5c78 6333 5c78  "Message t\xc3\x
-000142e0: 6236 2073 6967 6e2e 204c 6f6e 6765 7220  b6 sign. Longer 
-000142f0: 7468 616e 2068 6173 6821 222c 0a20 2020  than hash!",.   
-00014300: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
-00014310: 7373 6572 7420 6279 7465 7373 6967 6e20  ssert bytessign 
-00014320: 3d3d 2073 6967 6e61 7475 7265 0a0a 2020  == signature..  
-00014330: 2020 2020 2020 6e65 775f 7369 676e 6174        new_signat
-00014340: 7572 6520 3d20 6177 6169 7420 6173 796e  ure = await asyn
-00014350: 635f 7733 2e65 7468 2e73 6967 6e28 0a20  c_w3.eth.sign(. 
-00014360: 2020 2020 2020 2020 2020 2061 7379 6e63             async
-00014370: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
-00014380: 745f 6475 616c 5f74 7970 652c 2074 6578  t_dual_type, tex
-00014390: 743d 2264 6966 6665 7265 6e74 206d 6573  t="different mes
-000143a0: 7361 6765 2069 7320 6469 6666 6572 656e  sage is differen
-000143b0: 7422 0a20 2020 2020 2020 2029 0a20 2020  t".        ).   
-000143c0: 2020 2020 2061 7373 6572 7420 6e65 775f       assert new_
-000143d0: 7369 676e 6174 7572 6520 213d 2073 6967  signature != sig
-000143e0: 6e61 7475 7265 0a0a 2020 2020 4070 7974  nature..    @pyt
-000143f0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00014400: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-00014410: 6b2e 7866 6169 6c28 0a20 2020 2020 2020  k.xfail(.       
-00014420: 2072 6561 736f 6e3d 2241 7379 6e63 206d   reason="Async m
-00014430: 6964 646c 6577 6172 6520 746f 2063 6f6e  iddleware to con
-00014440: 7665 7274 2045 4e53 206e 616d 6573 2074  vert ENS names t
-00014450: 6f20 6164 6472 6573 7365 7320 6973 206d  o addresses is m
-00014460: 6973 7369 6e67 220a 2020 2020 290a 2020  issing".    ).  
-00014470: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-00014480: 5f61 7379 6e63 5f65 7468 5f73 6967 6e5f  _async_eth_sign_
-00014490: 656e 735f 6e61 6d65 7328 0a20 2020 2020  ens_names(.     
-000144a0: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
-000144b0: 333a 2022 4173 796e 6357 6562 3322 2c20  3: "AsyncWeb3", 
-000144c0: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
-000144d0: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-000144e0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-000144f0: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
-00014500: 0a20 2020 2020 2020 2077 6974 6820 656e  .        with en
-00014510: 735f 6164 6472 6573 7365 7328 0a20 2020  s_addresses(.   
-00014520: 2020 2020 2020 2020 2061 7379 6e63 5f77           async_w
-00014530: 332c 207b 2275 6e6c 6f63 6b65 642d 6163  3, {"unlocked-ac
-00014540: 6374 2e65 7468 223a 2061 7379 6e63 5f75  ct.eth": async_u
-00014550: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
-00014560: 6475 616c 5f74 7970 657d 0a20 2020 2020  dual_type}.     
-00014570: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00014580: 2020 7369 676e 6174 7572 6520 3d20 6177    signature = aw
-00014590: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-000145a0: 2e73 6967 6e28 0a20 2020 2020 2020 2020  .sign(.         
-000145b0: 2020 2020 2020 2045 4e53 2822 756e 6c6f         ENS("unlo
-000145c0: 636b 6564 2d61 6363 742e 6574 6822 292c  cked-acct.eth"),
-000145d0: 2074 6578 743d 224d 6573 7361 6765 2074   text="Message t
-000145e0: c3b6 2073 6967 6e2e 204c 6f6e 6765 7220  .. sign. Longer 
-000145f0: 7468 616e 2068 6173 6821 220a 2020 2020  than hash!".    
-00014600: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00014610: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00014620: 6279 7465 7328 7369 676e 6174 7572 6529  bytes(signature)
-00014630: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-00014640: 6572 7420 6c65 6e28 7369 676e 6174 7572  ert len(signatur
-00014650: 6529 203d 3d20 3332 202b 2033 3220 2b20  e) == 32 + 32 + 
-00014660: 310a 0a20 2020 2040 666c 616b 795f 6765  1..    @flaky_ge
-00014670: 7468 5f64 6576 5f6d 696e 696e 670a 2020  th_dev_mining.  
-00014680: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-00014690: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-000146a0: 2064 6566 2074 6573 745f 6173 796e 635f   def test_async_
-000146b0: 6574 685f 7265 706c 6163 655f 7472 616e  eth_replace_tran
-000146c0: 7361 6374 696f 6e5f 6c65 6761 6379 280a  saction_legacy(.
-000146d0: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
-000146e0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
-000146f0: 6233 222c 2061 7379 6e63 5f75 6e6c 6f63  b3", async_unloc
-00014700: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-00014710: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
-00014720: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
-00014730: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
-00014740: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
-00014750: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-00014760: 2020 2022 6672 6f6d 223a 2061 7379 6e63     "from": async
-00014770: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
-00014780: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
-00014790: 2020 2020 2020 2020 2022 746f 223a 2061           "to": a
-000147a0: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
-000147b0: 636f 756e 745f 6475 616c 5f74 7970 652c  count_dual_type,
-000147c0: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
-000147d0: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
-000147e0: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
-000147f0: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
-00014800: 2020 2020 2267 6173 5072 6963 6522 3a20      "gasPrice": 
-00014810: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-00014820: 312c 2022 6777 6569 2229 2c0a 2020 2020  1, "gwei"),.    
-00014830: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
-00014840: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
-00014850: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
-00014860: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00014870: 5f70 6172 616d 7329 0a0a 2020 2020 2020  _params)..      
-00014880: 2020 7478 6e5f 7061 7261 6d73 5b22 6761    txn_params["ga
-00014890: 7350 7269 6365 225d 203d 2061 7379 6e63  sPrice"] = async
-000148a0: 5f77 332e 746f 5f77 6569 2832 2c20 2267  _w3.to_wei(2, "g
-000148b0: 7765 6922 290a 2020 2020 2020 2020 7265  wei").        re
-000148c0: 706c 6163 655f 7478 6e5f 6861 7368 203d  place_txn_hash =
-000148d0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-000148e0: 6574 682e 7265 706c 6163 655f 7472 616e  eth.replace_tran
-000148f0: 7361 6374 696f 6e28 7478 6e5f 6861 7368  saction(txn_hash
-00014900: 2c20 7478 6e5f 7061 7261 6d73 290a 2020  , txn_params).  
-00014910: 2020 2020 2020 7265 706c 6163 655f 7478        replace_tx
-00014920: 6e20 3d20 6177 6169 7420 6173 796e 635f  n = await async_
-00014930: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
-00014940: 6163 7469 6f6e 2872 6570 6c61 6365 5f74  action(replace_t
-00014950: 786e 5f68 6173 6829 0a0a 2020 2020 2020  xn_hash)..      
-00014960: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
-00014970: 5f61 6464 7265 7373 280a 2020 2020 2020  _address(.      
-00014980: 2020 2020 2020 7265 706c 6163 655f 7478        replace_tx
-00014990: 6e5b 2266 726f 6d22 5d2c 2063 6173 7428  n["from"], cast(
-000149a0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-000149b0: 2074 786e 5f70 6172 616d 735b 2266 726f   txn_params["fro
-000149c0: 6d22 5d29 0a20 2020 2020 2020 2029 0a20  m"]).        ). 
-000149d0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-000149e0: 5f73 616d 655f 6164 6472 6573 7328 0a20  _same_address(. 
-000149f0: 2020 2020 2020 2020 2020 2072 6570 6c61             repla
-00014a00: 6365 5f74 786e 5b22 746f 225d 2c20 6361  ce_txn["to"], ca
-00014a10: 7374 2843 6865 636b 7375 6d41 6464 7265  st(ChecksumAddre
-00014a20: 7373 2c20 7478 6e5f 7061 7261 6d73 5b22  ss, txn_params["
-00014a30: 746f 225d 290a 2020 2020 2020 2020 290a  to"]).        ).
-00014a40: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-00014a50: 6570 6c61 6365 5f74 786e 5b22 7661 6c75  eplace_txn["valu
-00014a60: 6522 5d20 3d3d 2031 0a20 2020 2020 2020  e"] == 1.       
-00014a70: 2061 7373 6572 7420 7265 706c 6163 655f   assert replace_
-00014a80: 7478 6e5b 2267 6173 225d 203d 3d20 3231  txn["gas"] == 21
-00014a90: 3030 300a 2020 2020 2020 2020 6173 7365  000.        asse
-00014aa0: 7274 2072 6570 6c61 6365 5f74 786e 5b22  rt replace_txn["
-00014ab0: 6761 7350 7269 6365 225d 203d 3d20 7478  gasPrice"] == tx
-00014ac0: 6e5f 7061 7261 6d73 5b22 6761 7350 7269  n_params["gasPri
-00014ad0: 6365 225d 0a0a 2020 2020 4066 6c61 6b79  ce"]..    @flaky
-00014ae0: 5f67 6574 685f 6465 765f 6d69 6e69 6e67  _geth_dev_mining
-00014af0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-00014b00: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-00014b10: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
-00014b20: 6e63 5f65 7468 5f72 6570 6c61 6365 5f74  nc_eth_replace_t
-00014b30: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
-00014b40: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
-00014b50: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
-00014b60: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
-00014b70: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
-00014b80: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
-00014b90: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
-00014ba0: 3a0a 2020 2020 2020 2020 7477 6f5f 6777  :.        two_gw
-00014bb0: 6569 5f69 6e5f 7765 6920 3d20 6173 796e  ei_in_wei = asyn
-00014bc0: 635f 7733 2e74 6f5f 7765 6928 322c 2022  c_w3.to_wei(2, "
-00014bd0: 6777 6569 2229 0a20 2020 2020 2020 2074  gwei").        t
-00014be0: 6872 6565 5f67 7765 695f 696e 5f77 6569  hree_gwei_in_wei
-00014bf0: 203d 2061 7379 6e63 5f77 332e 746f 5f77   = async_w3.to_w
-00014c00: 6569 2833 2c20 2267 7765 6922 290a 0a20  ei(3, "gwei").. 
-00014c10: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00014c20: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-00014c30: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-00014c40: 6d22 3a20 6173 796e 635f 756e 6c6f 636b  m": async_unlock
-00014c50: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
-00014c60: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00014c70: 2020 2274 6f22 3a20 6173 796e 635f 756e    "to": async_un
-00014c80: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-00014c90: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-00014ca0: 2020 2020 2020 2276 616c 7565 223a 2057        "value": W
-00014cb0: 6569 2831 292c 0a20 2020 2020 2020 2020  ei(1),.         
-00014cc0: 2020 2022 6761 7322 3a20 3231 3030 302c     "gas": 21000,
-00014cd0: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
-00014ce0: 7846 6565 5065 7247 6173 223a 2074 776f  xFeePerGas": two
-00014cf0: 5f67 7765 695f 696e 5f77 6569 2c0a 2020  _gwei_in_wei,.  
-00014d00: 2020 2020 2020 2020 2020 226d 6178 5072            "maxPr
-00014d10: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
-00014d20: 3a20 6173 796e 635f 7733 2e74 6f5f 7765  : async_w3.to_we
-00014d30: 6928 312c 2022 6777 6569 2229 2c0a 2020  i(1, "gwei"),.  
-00014d40: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00014d50: 7478 6e5f 6861 7368 203d 2061 7761 6974  txn_hash = await
-00014d60: 2061 7379 6e63 5f77 332e 6574 682e 7365   async_w3.eth.se
-00014d70: 6e64 5f74 7261 6e73 6163 7469 6f6e 2874  nd_transaction(t
-00014d80: 786e 5f70 6172 616d 7329 0a0a 2020 2020  xn_params)..    
-00014d90: 2020 2020 7478 6e5f 7061 7261 6d73 5b22      txn_params["
-00014da0: 6d61 7846 6565 5065 7247 6173 225d 203d  maxFeePerGas"] =
-00014db0: 2074 6872 6565 5f67 7765 695f 696e 5f77   three_gwei_in_w
-00014dc0: 6569 0a20 2020 2020 2020 2074 786e 5f70  ei.        txn_p
-00014dd0: 6172 616d 735b 226d 6178 5072 696f 7269  arams["maxPriori
-00014de0: 7479 4665 6550 6572 4761 7322 5d20 3d20  tyFeePerGas"] = 
-00014df0: 7477 6f5f 6777 6569 5f69 6e5f 7765 690a  two_gwei_in_wei.
-00014e00: 0a20 2020 2020 2020 2072 6570 6c61 6365  .        replace
-00014e10: 5f74 786e 5f68 6173 6820 3d20 6177 6169  _txn_hash = awai
-00014e20: 7420 6173 796e 635f 7733 2e65 7468 2e72  t async_w3.eth.r
-00014e30: 6570 6c61 6365 5f74 7261 6e73 6163 7469  eplace_transacti
-00014e40: 6f6e 2874 786e 5f68 6173 682c 2074 786e  on(txn_hash, txn
-00014e50: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
-00014e60: 2072 6570 6c61 6365 5f74 786e 203d 2061   replace_txn = a
-00014e70: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00014e80: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
-00014e90: 6e28 7265 706c 6163 655f 7478 6e5f 6861  n(replace_txn_ha
-00014ea0: 7368 290a 0a20 2020 2020 2020 2061 7373  sh)..        ass
-00014eb0: 6572 7420 6973 5f73 616d 655f 6164 6472  ert is_same_addr
-00014ec0: 6573 7328 0a20 2020 2020 2020 2020 2020  ess(.           
-00014ed0: 2072 6570 6c61 6365 5f74 786e 5b22 6672   replace_txn["fr
-00014ee0: 6f6d 225d 2c20 6361 7374 2843 6865 636b  om"], cast(Check
-00014ef0: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
-00014f00: 7061 7261 6d73 5b22 6672 6f6d 225d 290a  params["from"]).
-00014f10: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00014f20: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
-00014f30: 5f61 6464 7265 7373 280a 2020 2020 2020  _address(.      
-00014f40: 2020 2020 2020 7265 706c 6163 655f 7478        replace_tx
-00014f50: 6e5b 2274 6f22 5d2c 2063 6173 7428 4368  n["to"], cast(Ch
-00014f60: 6563 6b73 756d 4164 6472 6573 732c 2074  ecksumAddress, t
-00014f70: 786e 5f70 6172 616d 735b 2274 6f22 5d29  xn_params["to"])
-00014f80: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00014f90: 2020 2061 7373 6572 7420 7265 706c 6163     assert replac
-00014fa0: 655f 7478 6e5b 2276 616c 7565 225d 203d  e_txn["value"] =
-00014fb0: 3d20 310a 2020 2020 2020 2020 6173 7365  = 1.        asse
-00014fc0: 7274 2072 6570 6c61 6365 5f74 786e 5b22  rt replace_txn["
-00014fd0: 6761 7322 5d20 3d3d 2032 3130 3030 0a20  gas"] == 21000. 
-00014fe0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-00014ff0: 706c 6163 655f 7478 6e5b 226d 6178 4665  place_txn["maxFe
-00015000: 6550 6572 4761 7322 5d20 3d3d 2074 6872  ePerGas"] == thr
-00015010: 6565 5f67 7765 695f 696e 5f77 6569 0a20  ee_gwei_in_wei. 
-00015020: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-00015030: 706c 6163 655f 7478 6e5b 226d 6178 5072  place_txn["maxPr
-00015040: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
-00015050: 5d20 3d3d 2074 776f 5f67 7765 695f 696e  ] == two_gwei_in
-00015060: 5f77 6569 0a0a 2020 2020 4066 6c61 6b79  _wei..    @flaky
-00015070: 5f67 6574 685f 6465 765f 6d69 6e69 6e67  _geth_dev_mining
-00015080: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-00015090: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-000150a0: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
-000150b0: 6e63 5f65 7468 5f72 6570 6c61 6365 5f74  nc_eth_replace_t
-000150c0: 7261 6e73 6163 7469 6f6e 5f75 6e64 6572  ransaction_under
-000150d0: 7072 6963 6564 280a 2020 2020 2020 2020  priced(.        
-000150e0: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-000150f0: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
-00015100: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
-00015110: 756e 745f 6475 616c 5f74 7970 653a 2043  unt_dual_type: C
-00015120: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
-00015130: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-00015140: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-00015150: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
-00015160: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-00015170: 223a 2061 7379 6e63 5f75 6e6c 6f63 6b65  ": async_unlocke
-00015180: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-00015190: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-000151a0: 2022 746f 223a 2061 7379 6e63 5f75 6e6c   "to": async_unl
-000151b0: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
-000151c0: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
-000151d0: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
-000151e0: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
-000151f0: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
-00015200: 2020 2020 2020 2020 2020 2020 226d 6178              "max
-00015210: 4665 6550 6572 4761 7322 3a20 6173 796e  FeePerGas": asyn
-00015220: 635f 7733 2e74 6f5f 7765 6928 332c 2022  c_w3.to_wei(3, "
-00015230: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
-00015240: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
-00015250: 4665 6550 6572 4761 7322 3a20 6173 796e  FeePerGas": asyn
-00015260: 635f 7733 2e74 6f5f 7765 6928 322c 2022  c_w3.to_wei(2, "
-00015270: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
-00015280: 7d0a 2020 2020 2020 2020 7478 6e5f 6861  }.        txn_ha
-00015290: 7368 203d 2061 7761 6974 2061 7379 6e63  sh = await async
-000152a0: 5f77 332e 6574 682e 7365 6e64 5f74 7261  _w3.eth.send_tra
-000152b0: 6e73 6163 7469 6f6e 2874 786e 5f70 6172  nsaction(txn_par
-000152c0: 616d 7329 0a0a 2020 2020 2020 2020 6f6e  ams)..        on
-000152d0: 655f 6777 6569 5f69 6e5f 7765 6920 3d20  e_gwei_in_wei = 
-000152e0: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-000152f0: 312c 2022 6777 6569 2229 0a20 2020 2020  1, "gwei").     
-00015300: 2020 2074 786e 5f70 6172 616d 735b 226d     txn_params["m
-00015310: 6178 4665 6550 6572 4761 7322 5d20 3d20  axFeePerGas"] = 
-00015320: 6f6e 655f 6777 6569 5f69 6e5f 7765 690a  one_gwei_in_wei.
-00015330: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-00015340: 6d73 5b22 6d61 7850 7269 6f72 6974 7946  ms["maxPriorityF
-00015350: 6565 5065 7247 6173 225d 203d 206f 6e65  eePerGas"] = one
-00015360: 5f67 7765 695f 696e 5f77 6569 0a0a 2020  _gwei_in_wei..  
-00015370: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
-00015380: 742e 7261 6973 6573 2856 616c 7565 4572  t.raises(ValueEr
-00015390: 726f 722c 206d 6174 6368 3d22 7265 706c  ror, match="repl
-000153a0: 6163 656d 656e 7420 7472 616e 7361 6374  acement transact
-000153b0: 696f 6e20 756e 6465 7270 7269 6365 6422  ion underpriced"
-000153c0: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-000153d0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-000153e0: 682e 7265 706c 6163 655f 7472 616e 7361  h.replace_transa
-000153f0: 6374 696f 6e28 7478 6e5f 6861 7368 2c20  ction(txn_hash, 
-00015400: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
-00015410: 2040 666c 616b 795f 6765 7468 5f64 6576   @flaky_geth_dev
-00015420: 5f6d 696e 696e 670a 2020 2020 4070 7974  _mining.    @pyt
-00015430: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00015440: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-00015450: 6573 745f 6173 796e 635f 6574 685f 7265  est_async_eth_re
-00015460: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
-00015470: 6e5f 6e6f 6e5f 6578 6973 7469 6e67 5f74  n_non_existing_t
-00015480: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
-00015490: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
-000154a0: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
-000154b0: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
-000154c0: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
-000154d0: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
-000154e0: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
-000154f0: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
-00015500: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
-00015510: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-00015520: 6672 6f6d 223a 2061 7379 6e63 5f75 6e6c  from": async_unl
-00015530: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
-00015540: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
-00015550: 2020 2020 2022 746f 223a 2061 7379 6e63       "to": async
-00015560: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
-00015570: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
-00015580: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
-00015590: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-000155a0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
-000155b0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-000155c0: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
-000155d0: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-000155e0: 332c 2022 6777 6569 2229 2c0a 2020 2020  3, "gwei"),.    
-000155f0: 2020 2020 2020 2020 226d 6178 5072 696f          "maxPrio
-00015600: 7269 7479 4665 6550 6572 4761 7322 3a20  rityFeePerGas": 
-00015610: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-00015620: 312c 2022 6777 6569 2229 2c0a 2020 2020  1, "gwei"),.    
-00015630: 2020 2020 7d0a 2020 2020 2020 2020 7769      }.        wi
-00015640: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-00015650: 2854 7261 6e73 6163 7469 6f6e 4e6f 7446  (TransactionNotF
-00015660: 6f75 6e64 293a 0a20 2020 2020 2020 2020  ound):.         
-00015670: 2020 2061 7761 6974 2061 7379 6e63 5f77     await async_w
-00015680: 332e 6574 682e 7265 706c 6163 655f 7472  3.eth.replace_tr
-00015690: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
-000156a0: 2020 2020 2020 2020 2020 2048 6578 5374             HexSt
-000156b0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-000156c0: 2020 2020 2020 2022 3078 3938 6538 6363         "0x98e8cc
-000156d0: 3039 6233 3131 3538 3363 3530 3739 6661  09b311583c5079fa
-000156e0: 3630 3066 3663 3261 3362 6561 3836 3131  600f6c2a3bea8611
-000156f0: 6166 3136 3863 3532 6534 6236 3062 3562  af168c52e4b60b5b
-00015700: 3234 3361 3434 3139 3937 220a 2020 2020  243a441997".    
-00015710: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-00015720: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00015730: 786e 5f70 6172 616d 732c 0a20 2020 2020  xn_params,.     
-00015740: 2020 2020 2020 2029 0a0a 2020 2020 4066         )..    @f
-00015750: 6c61 6b79 5f67 6574 685f 6465 765f 6d69  laky_geth_dev_mi
-00015760: 6e69 6e67 0a20 2020 2040 7079 7465 7374  ning.    @pytest
-00015770: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-00015780: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-00015790: 5f61 7379 6e63 5f65 7468 5f72 6570 6c61  _async_eth_repla
-000157a0: 6365 5f74 7261 6e73 6163 7469 6f6e 5f61  ce_transaction_a
-000157b0: 6c72 6561 6479 5f6d 696e 6564 280a 2020  lready_mined(.  
-000157c0: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
-000157d0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-000157e0: 222c 2061 7379 6e63 5f75 6e6c 6f63 6b65  ", async_unlocke
-000157f0: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-00015800: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-00015810: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-00015820: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-00015830: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-00015840: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00015850: 2022 6672 6f6d 223a 2061 7379 6e63 5f75   "from": async_u
-00015860: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
-00015870: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
-00015880: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
-00015890: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
-000158a0: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
-000158b0: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
-000158c0: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
-000158d0: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
-000158e0: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
-000158f0: 2020 226d 6178 4665 6550 6572 4761 7322    "maxFeePerGas"
-00015900: 3a20 6173 796e 635f 7733 2e74 6f5f 7765  : async_w3.to_we
-00015910: 6928 322c 2022 6777 6569 2229 2c0a 2020  i(2, "gwei"),.  
-00015920: 2020 2020 2020 2020 2020 226d 6178 5072            "maxPr
-00015930: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
-00015940: 3a20 6173 796e 635f 7733 2e74 6f5f 7765  : async_w3.to_we
-00015950: 6928 312c 2022 6777 6569 2229 2c0a 2020  i(1, "gwei"),.  
-00015960: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00015970: 7478 6e5f 6861 7368 203d 2061 7761 6974  txn_hash = await
-00015980: 2061 7379 6e63 5f77 332e 6574 682e 7365   async_w3.eth.se
-00015990: 6e64 5f74 7261 6e73 6163 7469 6f6e 2874  nd_transaction(t
-000159a0: 786e 5f70 6172 616d 7329 0a20 2020 2020  xn_params).     
-000159b0: 2020 2061 7761 6974 2061 7379 6e63 5f77     await async_w
-000159c0: 332e 6574 682e 7761 6974 5f66 6f72 5f74  3.eth.wait_for_t
-000159d0: 7261 6e73 6163 7469 6f6e 5f72 6563 6569  ransaction_recei
-000159e0: 7074 2874 786e 5f68 6173 682c 2074 696d  pt(txn_hash, tim
-000159f0: 656f 7574 3d31 3029 0a0a 2020 2020 2020  eout=10)..      
-00015a00: 2020 7478 6e5f 7061 7261 6d73 5b22 6d61    txn_params["ma
-00015a10: 7846 6565 5065 7247 6173 225d 203d 2061  xFeePerGas"] = a
-00015a20: 7379 6e63 5f77 332e 746f 5f77 6569 2833  sync_w3.to_wei(3
-00015a30: 2c20 2267 7765 6922 290a 2020 2020 2020  , "gwei").      
-00015a40: 2020 7478 6e5f 7061 7261 6d73 5b22 6d61    txn_params["ma
-00015a50: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-00015a60: 6173 225d 203d 2061 7379 6e63 5f77 332e  as"] = async_w3.
-00015a70: 746f 5f77 6569 2832 2c20 2267 7765 6922  to_wei(2, "gwei"
-00015a80: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
-00015a90: 7974 6573 742e 7261 6973 6573 2856 616c  ytest.raises(Val
-00015aa0: 7565 4572 726f 722c 206d 6174 6368 3d22  ueError, match="
-00015ab0: 5375 7070 6c69 6564 2074 7261 6e73 6163  Supplied transac
-00015ac0: 7469 6f6e 2077 6974 6820 6861 7368 2229  tion with hash")
-00015ad0: 3a0a 2020 2020 2020 2020 2020 2020 6177  :.            aw
-00015ae0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00015af0: 2e72 6570 6c61 6365 5f74 7261 6e73 6163  .replace_transac
-00015b00: 7469 6f6e 2874 786e 5f68 6173 682c 2074  tion(txn_hash, t
-00015b10: 786e 5f70 6172 616d 7329 0a0a 2020 2020  xn_params)..    
-00015b20: 4066 6c61 6b79 5f67 6574 685f 6465 765f  @flaky_geth_dev_
-00015b30: 6d69 6e69 6e67 0a20 2020 2040 7079 7465  mining.    @pyte
-00015b40: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-00015b50: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-00015b60: 7374 5f61 7379 6e63 5f65 7468 5f72 6570  st_async_eth_rep
-00015b70: 6c61 6365 5f74 7261 6e73 6163 7469 6f6e  lace_transaction
-00015b80: 5f69 6e63 6f72 7265 6374 5f6e 6f6e 6365  _incorrect_nonce
-00015b90: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-00015ba0: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-00015bb0: 5765 6233 222c 2061 7379 6e63 5f75 6e6c  Web3", async_unl
-00015bc0: 6f63 6b65 645f 6163 636f 756e 743a 2043  ocked_account: C
-00015bd0: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
-00015be0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-00015bf0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-00015c00: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
-00015c10: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-00015c20: 223a 2061 7379 6e63 5f75 6e6c 6f63 6b65  ": async_unlocke
-00015c30: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
-00015c40: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
-00015c50: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
-00015c60: 756e 742c 0a20 2020 2020 2020 2020 2020  unt,.           
-00015c70: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
-00015c80: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-00015c90: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
-00015ca0: 2020 2020 2020 2020 226d 6178 4665 6550          "maxFeeP
-00015cb0: 6572 4761 7322 3a20 6173 796e 635f 7733  erGas": async_w3
-00015cc0: 2e74 6f5f 7765 6928 322c 2022 6777 6569  .to_wei(2, "gwei
-00015cd0: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-00015ce0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
-00015cf0: 6572 4761 7322 3a20 6173 796e 635f 7733  erGas": async_w3
-00015d00: 2e74 6f5f 7765 6928 312c 2022 6777 6569  .to_wei(1, "gwei
-00015d10: 2229 2c0a 2020 2020 2020 2020 7d0a 2020  "),.        }.  
-00015d20: 2020 2020 2020 7478 6e5f 6861 7368 203d        txn_hash =
-00015d30: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00015d40: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
-00015d50: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
-00015d60: 0a20 2020 2020 2020 2074 786e 203d 2061  .        txn = a
-00015d70: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00015d80: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
-00015d90: 6e28 7478 6e5f 6861 7368 290a 0a20 2020  n(txn_hash)..   
-00015da0: 2020 2020 2074 786e 5f70 6172 616d 735b       txn_params[
-00015db0: 226d 6178 4665 6550 6572 4761 7322 5d20  "maxFeePerGas"] 
-00015dc0: 3d20 6173 796e 635f 7733 2e74 6f5f 7765  = async_w3.to_we
-00015dd0: 6928 332c 2022 6777 6569 2229 0a20 2020  i(3, "gwei").   
-00015de0: 2020 2020 2074 786e 5f70 6172 616d 735b       txn_params[
-00015df0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
-00015e00: 6572 4761 7322 5d20 3d20 6173 796e 635f  erGas"] = async_
-00015e10: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
-00015e20: 6569 2229 0a20 2020 2020 2020 2074 786e  ei").        txn
-00015e30: 5f70 6172 616d 735b 226e 6f6e 6365 225d  _params["nonce"]
-00015e40: 203d 204e 6f6e 6365 2874 786e 5b22 6e6f   = Nonce(txn["no
-00015e50: 6e63 6522 5d20 2b20 3129 0a20 2020 2020  nce"] + 1).     
-00015e60: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-00015e70: 6169 7365 7328 5661 6c75 6545 7272 6f72  aises(ValueError
-00015e80: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-00015e90: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00015ea0: 682e 7265 706c 6163 655f 7472 616e 7361  h.replace_transa
-00015eb0: 6374 696f 6e28 7478 6e5f 6861 7368 2c20  ction(txn_hash, 
-00015ec0: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
-00015ed0: 2040 666c 616b 795f 6765 7468 5f64 6576   @flaky_geth_dev
-00015ee0: 5f6d 696e 696e 670a 2020 2020 4070 7974  _mining.    @pyt
-00015ef0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00015f00: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-00015f10: 6573 745f 6173 796e 635f 6574 685f 7265  est_async_eth_re
-00015f20: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
-00015f30: 6e5f 6761 735f 7072 6963 655f 746f 6f5f  n_gas_price_too_
-00015f40: 6c6f 7728 0a20 2020 2020 2020 2073 656c  low(.        sel
-00015f50: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-00015f60: 796e 6357 6562 3322 2c20 6173 796e 635f  yncWeb3", async_
-00015f70: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00015f80: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
-00015f90: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
-00015fa0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00015fb0: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
-00015fc0: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
-00015fd0: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
-00015fe0: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
-00015ff0: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-00016000: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-00016010: 6f22 3a20 6173 796e 635f 756e 6c6f 636b  o": async_unlock
-00016020: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
-00016030: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00016040: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
-00016050: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00016060: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
-00016070: 2020 2020 2020 2020 2022 6761 7350 7269           "gasPri
-00016080: 6365 223a 2061 7379 6e63 5f77 332e 746f  ce": async_w3.to
-00016090: 5f77 6569 2832 2c20 2267 7765 6922 292c  _wei(2, "gwei"),
-000160a0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-000160b0: 2020 2074 786e 5f68 6173 6820 3d20 6177     txn_hash = aw
-000160c0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-000160d0: 2e73 656e 645f 7472 616e 7361 6374 696f  .send_transactio
-000160e0: 6e28 7478 6e5f 7061 7261 6d73 290a 0a20  n(txn_params).. 
-000160f0: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00016100: 735b 2267 6173 5072 6963 6522 5d20 3d20  s["gasPrice"] = 
-00016110: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-00016120: 312c 2022 6777 6569 2229 0a20 2020 2020  1, "gwei").     
-00016130: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-00016140: 6169 7365 7328 5661 6c75 6545 7272 6f72  aises(ValueError
-00016150: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-00016160: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00016170: 682e 7265 706c 6163 655f 7472 616e 7361  h.replace_transa
-00016180: 6374 696f 6e28 7478 6e5f 6861 7368 2c20  ction(txn_hash, 
-00016190: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
-000161a0: 2040 666c 616b 795f 6765 7468 5f64 6576   @flaky_geth_dev
-000161b0: 5f6d 696e 696e 670a 2020 2020 4070 7974  _mining.    @pyt
-000161c0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-000161d0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-000161e0: 6573 745f 6173 796e 635f 6574 685f 7265  est_async_eth_re
-000161f0: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
-00016200: 6e5f 6761 735f 7072 6963 655f 6465 6661  n_gas_price_defa
-00016210: 756c 7469 6e67 5f6d 696e 696d 756d 280a  ulting_minimum(.
-00016220: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
-00016230: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
-00016240: 6233 222c 2061 7379 6e63 5f75 6e6c 6f63  b3", async_unloc
-00016250: 6b65 645f 6163 636f 756e 743a 2043 6865  ked_account: Che
-00016260: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
-00016270: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00016280: 2020 2020 6761 735f 7072 6963 6520 3d20      gas_price = 
-00016290: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-000162a0: 312c 2022 6777 6569 2229 0a0a 2020 2020  1, "gwei")..    
-000162b0: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
-000162c0: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
-000162d0: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
-000162e0: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
-000162f0: 6163 636f 756e 742c 0a20 2020 2020 2020  account,.       
-00016300: 2020 2020 2022 746f 223a 2061 7379 6e63       "to": async
-00016310: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
-00016320: 742c 0a20 2020 2020 2020 2020 2020 2022  t,.            "
-00016330: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
-00016340: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
-00016350: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
-00016360: 2020 2020 2020 2267 6173 5072 6963 6522        "gasPrice"
-00016370: 3a20 6761 735f 7072 6963 652c 0a20 2020  : gas_price,.   
-00016380: 2020 2020 207d 0a20 2020 2020 2020 2074       }.        t
-00016390: 786e 5f68 6173 6820 3d20 6177 6169 7420  xn_hash = await 
-000163a0: 6173 796e 635f 7733 2e65 7468 2e73 656e  async_w3.eth.sen
-000163b0: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
-000163c0: 6e5f 7061 7261 6d73 290a 0a20 2020 2020  n_params)..     
-000163d0: 2020 2074 786e 5f70 6172 616d 732e 706f     txn_params.po
-000163e0: 7028 2267 6173 5072 6963 6522 290a 2020  p("gasPrice").  
-000163f0: 2020 2020 2020 7265 706c 6163 655f 7478        replace_tx
-00016400: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
-00016410: 7379 6e63 5f77 332e 6574 682e 7265 706c  sync_w3.eth.repl
-00016420: 6163 655f 7472 616e 7361 6374 696f 6e28  ace_transaction(
-00016430: 7478 6e5f 6861 7368 2c20 7478 6e5f 7061  txn_hash, txn_pa
-00016440: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
-00016450: 706c 6163 655f 7478 6e20 3d20 6177 6169  place_txn = awai
-00016460: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
-00016470: 6574 5f74 7261 6e73 6163 7469 6f6e 2872  et_transaction(r
-00016480: 6570 6c61 6365 5f74 786e 5f68 6173 6829  eplace_txn_hash)
-00016490: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-000164a0: 2072 6570 6c61 6365 5f74 786e 5b22 6761   replace_txn["ga
-000164b0: 7350 7269 6365 225d 203d 3d20 6d61 7468  sPrice"] == math
-000164c0: 2e63 6569 6c28 0a20 2020 2020 2020 2020  .ceil(.         
-000164d0: 2020 2067 6173 5f70 7269 6365 202a 2031     gas_price * 1
-000164e0: 2e31 3235 0a20 2020 2020 2020 2029 2020  .125.        )  
-000164f0: 2320 6d69 6e69 6d75 6d20 6761 7320 7072  # minimum gas pr
-00016500: 6963 650a 0a20 2020 2040 666c 616b 795f  ice..    @flaky_
-00016510: 6765 7468 5f64 6576 5f6d 696e 696e 670a  geth_dev_mining.
-00016520: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00016530: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-00016540: 6e63 2064 6566 2074 6573 745f 6173 796e  nc def test_asyn
-00016550: 635f 6574 685f 7265 706c 6163 655f 7472  c_eth_replace_tr
-00016560: 616e 7361 6374 696f 6e5f 6761 735f 7072  ansaction_gas_pr
-00016570: 6963 655f 6465 6661 756c 7469 6e67 5f73  ice_defaulting_s
-00016580: 7472 6174 6567 795f 6869 6768 6572 280a  trategy_higher(.
-00016590: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
-000165a0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
-000165b0: 6233 222c 2061 7379 6e63 5f75 6e6c 6f63  b3", async_unloc
-000165c0: 6b65 645f 6163 636f 756e 743a 2043 6865  ked_account: Che
-000165d0: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
-000165e0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-000165f0: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
-00016600: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
-00016610: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
-00016620: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
-00016630: 6163 636f 756e 742c 0a20 2020 2020 2020  account,.       
-00016640: 2020 2020 2022 746f 223a 2061 7379 6e63       "to": async
-00016650: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
-00016660: 742c 0a20 2020 2020 2020 2020 2020 2022  t,.            "
-00016670: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
-00016680: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
-00016690: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
-000166a0: 2020 2020 2020 2267 6173 5072 6963 6522        "gasPrice"
-000166b0: 3a20 6173 796e 635f 7733 2e74 6f5f 7765  : async_w3.to_we
-000166c0: 6928 312c 2022 6777 6569 2229 2c0a 2020  i(1, "gwei"),.  
-000166d0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-000166e0: 7478 6e5f 6861 7368 203d 2061 7761 6974  txn_hash = await
-000166f0: 2061 7379 6e63 5f77 332e 6574 682e 7365   async_w3.eth.se
-00016700: 6e64 5f74 7261 6e73 6163 7469 6f6e 2874  nd_transaction(t
-00016710: 786e 5f70 6172 616d 7329 0a0a 2020 2020  xn_params)..    
-00016720: 2020 2020 7477 6f5f 6777 6569 5f69 6e5f      two_gwei_in_
-00016730: 7765 6920 3d20 6173 796e 635f 7733 2e74  wei = async_w3.t
-00016740: 6f5f 7765 6928 322c 2022 6777 6569 2229  o_wei(2, "gwei")
-00016750: 0a0a 2020 2020 2020 2020 6465 6620 6869  ..        def hi
-00016760: 6768 6572 5f67 6173 5f70 7269 6365 5f73  gher_gas_price_s
-00016770: 7472 6174 6567 7928 6173 796e 635f 7733  trategy(async_w3
-00016780: 3a20 2241 7379 6e63 5765 6233 222c 2074  : "AsyncWeb3", t
-00016790: 786e 3a20 5478 5061 7261 6d73 2920 2d3e  xn: TxParams) ->
-000167a0: 2057 6569 3a0a 2020 2020 2020 2020 2020   Wei:.          
-000167b0: 2020 7265 7475 726e 2074 776f 5f67 7765    return two_gwe
-000167c0: 695f 696e 5f77 6569 0a0a 2020 2020 2020  i_in_wei..      
-000167d0: 2020 6173 796e 635f 7733 2e65 7468 2e73    async_w3.eth.s
-000167e0: 6574 5f67 6173 5f70 7269 6365 5f73 7472  et_gas_price_str
-000167f0: 6174 6567 7928 6869 6768 6572 5f67 6173  ategy(higher_gas
-00016800: 5f70 7269 6365 5f73 7472 6174 6567 7929  _price_strategy)
-00016810: 0a0a 2020 2020 2020 2020 7478 6e5f 7061  ..        txn_pa
-00016820: 7261 6d73 2e70 6f70 2822 6761 7350 7269  rams.pop("gasPri
-00016830: 6365 2229 0a20 2020 2020 2020 2072 6570  ce").        rep
-00016840: 6c61 6365 5f74 786e 5f68 6173 6820 3d20  lace_txn_hash = 
-00016850: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
-00016860: 7468 2e72 6570 6c61 6365 5f74 7261 6e73  th.replace_trans
-00016870: 6163 7469 6f6e 2874 786e 5f68 6173 682c  action(txn_hash,
-00016880: 2074 786e 5f70 6172 616d 7329 0a20 2020   txn_params).   
-00016890: 2020 2020 2072 6570 6c61 6365 5f74 786e       replace_txn
-000168a0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-000168b0: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
-000168c0: 6374 696f 6e28 7265 706c 6163 655f 7478  ction(replace_tx
-000168d0: 6e5f 6861 7368 290a 2020 2020 2020 2020  n_hash).        
-000168e0: 6173 7365 7274 2028 0a20 2020 2020 2020  assert (.       
-000168f0: 2020 2020 2072 6570 6c61 6365 5f74 786e       replace_txn
-00016900: 5b22 6761 7350 7269 6365 225d 203d 3d20  ["gasPrice"] == 
-00016910: 7477 6f5f 6777 6569 5f69 6e5f 7765 690a  two_gwei_in_wei.
-00016920: 2020 2020 2020 2020 2920 2023 2053 7472          )  # Str
-00016930: 6174 6567 7920 7072 6f76 6964 6573 2068  ategy provides h
-00016940: 6967 6865 7220 6761 7320 7072 6963 650a  igher gas price.
-00016950: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
-00016960: 2e65 7468 2e73 6574 5f67 6173 5f70 7269  .eth.set_gas_pri
-00016970: 6365 5f73 7472 6174 6567 7928 4e6f 6e65  ce_strategy(None
-00016980: 2920 2023 2072 6573 6574 2073 7472 6174  )  # reset strat
-00016990: 6567 790a 0a20 2020 2040 666c 616b 795f  egy..    @flaky_
-000169a0: 6765 7468 5f64 6576 5f6d 696e 696e 670a  geth_dev_mining.
-000169b0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-000169c0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-000169d0: 6e63 2064 6566 2074 6573 745f 6173 796e  nc def test_asyn
-000169e0: 635f 6574 685f 7265 706c 6163 655f 7472  c_eth_replace_tr
-000169f0: 616e 7361 6374 696f 6e5f 6761 735f 7072  ansaction_gas_pr
-00016a00: 6963 655f 6465 6661 756c 7469 6e67 5f73  ice_defaulting_s
-00016a10: 7472 6174 6567 795f 6c6f 7765 7228 0a20  trategy_lower(. 
-00016a20: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
-00016a30: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-00016a40: 3322 2c20 6173 796e 635f 756e 6c6f 636b  3", async_unlock
-00016a50: 6564 5f61 6363 6f75 6e74 3a20 4368 6563  ed_account: Chec
-00016a60: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
-00016a70: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00016a80: 2020 2067 6173 5f70 7269 6365 203d 2061     gas_price = a
-00016a90: 7379 6e63 5f77 332e 746f 5f77 6569 2832  sync_w3.to_wei(2
-00016aa0: 2c20 2267 7765 6922 290a 0a20 2020 2020  , "gwei")..     
-00016ab0: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
-00016ac0: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
-00016ad0: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
-00016ae0: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
-00016af0: 6363 6f75 6e74 2c0a 2020 2020 2020 2020  ccount,.        
-00016b00: 2020 2020 2274 6f22 3a20 6173 796e 635f      "to": async_
-00016b10: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00016b20: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-00016b30: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-00016b40: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-00016b50: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00016b60: 2020 2020 2022 6761 7350 7269 6365 223a       "gasPrice":
-00016b70: 2067 6173 5f70 7269 6365 2c0a 2020 2020   gas_price,.    
-00016b80: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
-00016b90: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
-00016ba0: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
-00016bb0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00016bc0: 5f70 6172 616d 7329 0a0a 2020 2020 2020  _params)..      
-00016bd0: 2020 6465 6620 6c6f 7765 725f 6761 735f    def lower_gas_
-00016be0: 7072 6963 655f 7374 7261 7465 6779 2861  price_strategy(a
-00016bf0: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-00016c00: 6562 3322 2c20 7478 6e3a 2054 7850 6172  eb3", txn: TxPar
-00016c10: 616d 7329 202d 3e20 5765 693a 0a20 2020  ams) -> Wei:.   
-00016c20: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00016c30: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-00016c40: 312c 2022 6777 6569 2229 0a0a 2020 2020  1, "gwei")..    
-00016c50: 2020 2020 6173 796e 635f 7733 2e65 7468      async_w3.eth
-00016c60: 2e73 6574 5f67 6173 5f70 7269 6365 5f73  .set_gas_price_s
-00016c70: 7472 6174 6567 7928 6c6f 7765 725f 6761  trategy(lower_ga
-00016c80: 735f 7072 6963 655f 7374 7261 7465 6779  s_price_strategy
-00016c90: 290a 0a20 2020 2020 2020 2074 786e 5f70  )..        txn_p
-00016ca0: 6172 616d 732e 706f 7028 2267 6173 5072  arams.pop("gasPr
-00016cb0: 6963 6522 290a 2020 2020 2020 2020 7265  ice").        re
-00016cc0: 706c 6163 655f 7478 6e5f 6861 7368 203d  place_txn_hash =
-00016cd0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00016ce0: 6574 682e 7265 706c 6163 655f 7472 616e  eth.replace_tran
-00016cf0: 7361 6374 696f 6e28 7478 6e5f 6861 7368  saction(txn_hash
-00016d00: 2c20 7478 6e5f 7061 7261 6d73 290a 2020  , txn_params).  
-00016d10: 2020 2020 2020 7265 706c 6163 655f 7478        replace_tx
-00016d20: 6e20 3d20 6177 6169 7420 6173 796e 635f  n = await async_
-00016d30: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
-00016d40: 6163 7469 6f6e 2872 6570 6c61 6365 5f74  action(replace_t
-00016d50: 786e 5f68 6173 6829 0a20 2020 2020 2020  xn_hash).       
-00016d60: 2023 2053 7472 6174 6567 7920 7072 6f76   # Strategy prov
-00016d70: 6964 6573 206c 6f77 6572 2067 6173 2070  ides lower gas p
-00016d80: 7269 6365 202d 206d 696e 696d 756d 2070  rice - minimum p
-00016d90: 7265 6665 7272 6564 0a20 2020 2020 2020  referred.       
-00016da0: 2061 7373 6572 7420 7265 706c 6163 655f   assert replace_
-00016db0: 7478 6e5b 2267 6173 5072 6963 6522 5d20  txn["gasPrice"] 
-00016dc0: 3d3d 206d 6174 682e 6365 696c 2867 6173  == math.ceil(gas
-00016dd0: 5f70 7269 6365 202a 2031 2e31 3235 290a  _price * 1.125).
-00016de0: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
-00016df0: 2e65 7468 2e73 6574 5f67 6173 5f70 7269  .eth.set_gas_pri
-00016e00: 6365 5f73 7472 6174 6567 7928 4e6f 6e65  ce_strategy(None
-00016e10: 2920 2023 2072 6573 6574 2073 7472 6174  )  # reset strat
-00016e20: 6567 790a 0a20 2020 2040 7079 7465 7374  egy..    @pytest
-00016e30: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-00016e40: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-00016e50: 5f61 7379 6e63 5f65 7468 5f6e 6577 5f66  _async_eth_new_f
-00016e60: 696c 7465 7228 7365 6c66 2c20 6173 796e  ilter(self, asyn
-00016e70: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-00016e80: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
-00016e90: 2020 2020 6669 6c74 6572 203d 2061 7761      filter = awa
-00016ea0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00016eb0: 6669 6c74 6572 287b 7d29 0a0a 2020 2020  filter({})..    
-00016ec0: 2020 2020 6368 616e 6765 7320 3d20 6177      changes = aw
-00016ed0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00016ee0: 2e67 6574 5f66 696c 7465 725f 6368 616e  .get_filter_chan
-00016ef0: 6765 7328 6669 6c74 6572 2e66 696c 7465  ges(filter.filte
-00016f00: 725f 6964 290a 2020 2020 2020 2020 6173  r_id).        as
-00016f10: 7365 7274 2069 735f 6c69 7374 5f6c 696b  sert is_list_lik
-00016f20: 6528 6368 616e 6765 7329 0a20 2020 2020  e(changes).     
-00016f30: 2020 2061 7373 6572 7420 6e6f 7420 6368     assert not ch
-00016f40: 616e 6765 730a 0a20 2020 2020 2020 206c  anges..        l
-00016f50: 6f67 7320 3d20 6177 6169 7420 6173 796e  ogs = await asyn
-00016f60: 635f 7733 2e65 7468 2e67 6574 5f66 696c  c_w3.eth.get_fil
-00016f70: 7465 725f 6c6f 6773 2866 696c 7465 722e  ter_logs(filter.
-00016f80: 6669 6c74 6572 5f69 6429 0a20 2020 2020  filter_id).     
-00016f90: 2020 2061 7373 6572 7420 6973 5f6c 6973     assert is_lis
-00016fa0: 745f 6c69 6b65 286c 6f67 7329 0a20 2020  t_like(logs).   
-00016fb0: 2020 2020 2061 7373 6572 7420 6e6f 7420       assert not 
-00016fc0: 6c6f 6773 0a0a 2020 2020 2020 2020 7265  logs..        re
-00016fd0: 7375 6c74 203d 2061 7761 6974 2061 7379  sult = await asy
-00016fe0: 6e63 5f77 332e 6574 682e 756e 696e 7374  nc_w3.eth.uninst
-00016ff0: 616c 6c5f 6669 6c74 6572 2866 696c 7465  all_filter(filte
-00017000: 722e 6669 6c74 6572 5f69 6429 0a20 2020  r.filter_id).   
-00017010: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-00017020: 6c74 2069 7320 5472 7565 0a0a 2020 2020  lt is True..    
-00017030: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-00017040: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-00017050: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
-00017060: 685f 6e65 775f 626c 6f63 6b5f 6669 6c74  h_new_block_filt
-00017070: 6572 2873 656c 662c 2061 7379 6e63 5f77  er(self, async_w
-00017080: 333a 2022 4173 796e 6357 6562 3322 2920  3: "AsyncWeb3") 
-00017090: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-000170a0: 2066 696c 7465 7220 3d20 6177 6169 7420   filter = await 
-000170b0: 6173 796e 635f 7733 2e65 7468 2e66 696c  async_w3.eth.fil
-000170c0: 7465 7228 226c 6174 6573 7422 290a 2020  ter("latest").  
-000170d0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-000170e0: 7374 7269 6e67 2866 696c 7465 722e 6669  string(filter.fi
-000170f0: 6c74 6572 5f69 6429 0a0a 2020 2020 2020  lter_id)..      
-00017100: 2020 6368 616e 6765 7320 3d20 6177 6169    changes = awai
-00017110: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
-00017120: 6574 5f66 696c 7465 725f 6368 616e 6765  et_filter_change
-00017130: 7328 6669 6c74 6572 2e66 696c 7465 725f  s(filter.filter_
-00017140: 6964 290a 2020 2020 2020 2020 6173 7365  id).        asse
-00017150: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
-00017160: 6368 616e 6765 7329 0a0a 2020 2020 2020  changes)..      
-00017170: 2020 7265 7375 6c74 203d 2061 7761 6974    result = await
-00017180: 2061 7379 6e63 5f77 332e 6574 682e 756e   async_w3.eth.un
-00017190: 696e 7374 616c 6c5f 6669 6c74 6572 2866  install_filter(f
-000171a0: 696c 7465 722e 6669 6c74 6572 5f69 6429  ilter.filter_id)
-000171b0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000171c0: 7265 7375 6c74 2069 7320 5472 7565 0a0a  result is True..
-000171d0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-000171e0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-000171f0: 6e63 2064 6566 2074 6573 745f 6173 796e  nc def test_asyn
-00017200: 635f 6574 685f 6e65 775f 7065 6e64 696e  c_eth_new_pendin
-00017210: 675f 7472 616e 7361 6374 696f 6e5f 6669  g_transaction_fi
-00017220: 6c74 6572 280a 2020 2020 2020 2020 7365  lter(.        se
-00017230: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
-00017240: 7379 6e63 5765 6233 220a 2020 2020 2920  syncWeb3".    ) 
-00017250: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00017260: 2066 696c 7465 7220 3d20 6177 6169 7420   filter = await 
-00017270: 6173 796e 635f 7733 2e65 7468 2e66 696c  async_w3.eth.fil
-00017280: 7465 7228 2270 656e 6469 6e67 2229 0a20  ter("pending"). 
-00017290: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-000172a0: 5f73 7472 696e 6728 6669 6c74 6572 2e66  _string(filter.f
-000172b0: 696c 7465 725f 6964 290a 0a20 2020 2020  ilter_id)..     
-000172c0: 2020 2063 6861 6e67 6573 203d 2061 7761     changes = awa
-000172d0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-000172e0: 6765 745f 6669 6c74 6572 5f63 6861 6e67  get_filter_chang
-000172f0: 6573 2866 696c 7465 722e 6669 6c74 6572  es(filter.filter
-00017300: 5f69 6429 0a20 2020 2020 2020 2061 7373  _id).        ass
-00017310: 6572 7420 6973 5f6c 6973 745f 6c69 6b65  ert is_list_like
-00017320: 2863 6861 6e67 6573 290a 2020 2020 2020  (changes).      
-00017330: 2020 6173 7365 7274 206e 6f74 2063 6861    assert not cha
-00017340: 6e67 6573 0a0a 2020 2020 2020 2020 7265  nges..        re
-00017350: 7375 6c74 203d 2061 7761 6974 2061 7379  sult = await asy
-00017360: 6e63 5f77 332e 6574 682e 756e 696e 7374  nc_w3.eth.uninst
-00017370: 616c 6c5f 6669 6c74 6572 2866 696c 7465  all_filter(filte
-00017380: 722e 6669 6c74 6572 5f69 6429 0a20 2020  r.filter_id).   
-00017390: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-000173a0: 6c74 2069 7320 5472 7565 0a0a 2020 2020  lt is True..    
-000173b0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-000173c0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-000173d0: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
-000173e0: 685f 756e 696e 7374 616c 6c5f 6669 6c74  h_uninstall_filt
-000173f0: 6572 2873 656c 662c 2061 7379 6e63 5f77  er(self, async_w
-00017400: 333a 2022 4173 796e 6357 6562 3322 2920  3: "AsyncWeb3") 
-00017410: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00017420: 2066 696c 7465 7220 3d20 6177 6169 7420   filter = await 
-00017430: 6173 796e 635f 7733 2e65 7468 2e66 696c  async_w3.eth.fil
-00017440: 7465 7228 7b7d 290a 2020 2020 2020 2020  ter({}).        
-00017450: 6173 7365 7274 2069 735f 7374 7269 6e67  assert is_string
-00017460: 2866 696c 7465 722e 6669 6c74 6572 5f69  (filter.filter_i
-00017470: 6429 0a0a 2020 2020 2020 2020 7375 6363  d)..        succ
-00017480: 6573 7320 3d20 6177 6169 7420 6173 796e  ess = await asyn
-00017490: 635f 7733 2e65 7468 2e75 6e69 6e73 7461  c_w3.eth.uninsta
-000174a0: 6c6c 5f66 696c 7465 7228 6669 6c74 6572  ll_filter(filter
-000174b0: 2e66 696c 7465 725f 6964 290a 2020 2020  .filter_id).    
-000174c0: 2020 2020 6173 7365 7274 2073 7563 6365      assert succe
-000174d0: 7373 2069 7320 5472 7565 0a0a 2020 2020  ss is True..    
-000174e0: 2020 2020 6661 696c 7572 6520 3d20 6177      failure = aw
-000174f0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00017500: 2e75 6e69 6e73 7461 6c6c 5f66 696c 7465  .uninstall_filte
-00017510: 7228 6669 6c74 6572 2e66 696c 7465 725f  r(filter.filter_
-00017520: 6964 290a 2020 2020 2020 2020 6173 7365  id).        asse
-00017530: 7274 2066 6169 6c75 7265 2069 7320 4661  rt failure is Fa
-00017540: 6c73 650a 0a0a 636c 6173 7320 4574 684d  lse...class EthM
-00017550: 6f64 756c 6554 6573 743a 0a20 2020 2064  oduleTest:.    d
-00017560: 6566 2074 6573 745f 6574 685f 7379 6e63  ef test_eth_sync
-00017570: 696e 6728 7365 6c66 2c20 7733 3a20 2257  ing(self, w3: "W
-00017580: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
-00017590: 2020 2020 2020 2073 796e 6369 6e67 203d         syncing =
-000175a0: 2077 332e 6574 682e 7379 6e63 696e 670a   w3.eth.syncing.
-000175b0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000175c0: 6973 5f62 6f6f 6c65 616e 2873 796e 6369  is_boolean(synci
-000175d0: 6e67 2920 6f72 2069 735f 6469 6374 2873  ng) or is_dict(s
-000175e0: 796e 6369 6e67 290a 0a20 2020 2020 2020  yncing)..       
-000175f0: 2069 6620 6973 5f62 6f6f 6c65 616e 2873   if is_boolean(s
-00017600: 796e 6369 6e67 293a 0a20 2020 2020 2020  yncing):.       
-00017610: 2020 2020 2061 7373 6572 7420 7379 6e63       assert sync
-00017620: 696e 6720 6973 2046 616c 7365 0a20 2020  ing is False.   
-00017630: 2020 2020 2065 6c69 6620 6973 5f64 6963       elif is_dic
-00017640: 7428 7379 6e63 696e 6729 3a0a 2020 2020  t(syncing):.    
-00017650: 2020 2020 2020 2020 7379 6e63 5f64 6963          sync_dic
-00017660: 7420 3d20 6361 7374 2853 796e 6353 7461  t = cast(SyncSta
-00017670: 7475 732c 2073 796e 6369 6e67 290a 2020  tus, syncing).  
-00017680: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-00017690: 2022 7374 6172 7469 6e67 426c 6f63 6b22   "startingBlock"
-000176a0: 2069 6e20 7379 6e63 5f64 6963 740a 2020   in sync_dict.  
-000176b0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-000176c0: 2022 6375 7272 656e 7442 6c6f 636b 2220   "currentBlock" 
-000176d0: 696e 2073 796e 635f 6469 6374 0a20 2020  in sync_dict.   
-000176e0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-000176f0: 2268 6967 6865 7374 426c 6f63 6b22 2069  "highestBlock" i
-00017700: 6e20 7379 6e63 5f64 6963 740a 0a20 2020  n sync_dict..   
-00017710: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-00017720: 6973 5f69 6e74 6567 6572 2873 796e 635f  is_integer(sync_
-00017730: 6469 6374 5b22 7374 6172 7469 6e67 426c  dict["startingBl
-00017740: 6f63 6b22 5d29 0a20 2020 2020 2020 2020  ock"]).         
-00017750: 2020 2061 7373 6572 7420 6973 5f69 6e74     assert is_int
-00017760: 6567 6572 2873 796e 635f 6469 6374 5b22  eger(sync_dict["
-00017770: 6375 7272 656e 7442 6c6f 636b 225d 290a  currentBlock"]).
-00017780: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00017790: 7274 2069 735f 696e 7465 6765 7228 7379  rt is_integer(sy
-000177a0: 6e63 5f64 6963 745b 2268 6967 6865 7374  nc_dict["highest
-000177b0: 426c 6f63 6b22 5d29 0a0a 2020 2020 6465  Block"])..    de
-000177c0: 6620 7465 7374 5f65 7468 5f63 6f69 6e62  f test_eth_coinb
-000177d0: 6173 6528 7365 6c66 2c20 7733 3a20 2257  ase(self, w3: "W
-000177e0: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
-000177f0: 2020 2020 2020 2063 6f69 6e62 6173 6520         coinbase 
-00017800: 3d20 7733 2e65 7468 2e63 6f69 6e62 6173  = w3.eth.coinbas
-00017810: 650a 2020 2020 2020 2020 6173 7365 7274  e.        assert
-00017820: 2069 735f 6368 6563 6b73 756d 5f61 6464   is_checksum_add
-00017830: 7265 7373 2863 6f69 6e62 6173 6529 0a0a  ress(coinbase)..
-00017840: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-00017850: 5f6d 696e 696e 6728 7365 6c66 2c20 7733  _mining(self, w3
-00017860: 3a20 2257 6562 3322 2920 2d3e 204e 6f6e  : "Web3") -> Non
-00017870: 653a 0a20 2020 2020 2020 206d 696e 696e  e:.        minin
-00017880: 6720 3d20 7733 2e65 7468 2e6d 696e 696e  g = w3.eth.minin
-00017890: 670a 2020 2020 2020 2020 6173 7365 7274  g.        assert
-000178a0: 2069 735f 626f 6f6c 6561 6e28 6d69 6e69   is_boolean(mini
-000178b0: 6e67 290a 0a20 2020 2064 6566 2074 6573  ng)..    def tes
-000178c0: 745f 6574 685f 6861 7368 7261 7465 2873  t_eth_hashrate(s
-000178d0: 656c 662c 2077 333a 2022 5765 6233 2229  elf, w3: "Web3")
-000178e0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-000178f0: 2020 6861 7368 7261 7465 203d 2077 332e    hashrate = w3.
-00017900: 6574 682e 6861 7368 7261 7465 0a20 2020  eth.hashrate.   
-00017910: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
-00017920: 6e74 6567 6572 2868 6173 6872 6174 6529  nteger(hashrate)
-00017930: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00017940: 6861 7368 7261 7465 203e 3d20 300a 0a20  hashrate >= 0.. 
-00017950: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-00017960: 6368 6169 6e5f 6964 2873 656c 662c 2077  chain_id(self, w
-00017970: 333a 2022 5765 6233 2229 202d 3e20 4e6f  3: "Web3") -> No
-00017980: 6e65 3a0a 2020 2020 2020 2020 6368 6169  ne:.        chai
-00017990: 6e5f 6964 203d 2077 332e 6574 682e 6368  n_id = w3.eth.ch
-000179a0: 6169 6e5f 6964 0a20 2020 2020 2020 2023  ain_id.        #
-000179b0: 2063 6861 696e 2069 6420 7661 6c75 6520   chain id value 
-000179c0: 6672 6f6d 2067 6574 6820 6669 7874 7572  from geth fixtur
-000179d0: 6520 6765 6e65 7369 7320 6669 6c65 0a20  e genesis file. 
-000179e0: 2020 2020 2020 2061 7373 6572 7420 6368         assert ch
-000179f0: 6169 6e5f 6964 203d 3d20 3133 3132 3737  ain_id == 131277
-00017a00: 3332 3239 3430 3533 370a 0a20 2020 2064  322940537..    d
-00017a10: 6566 2074 6573 745f 6574 685f 6665 655f  ef test_eth_fee_
-00017a20: 6869 7374 6f72 7928 7365 6c66 2c20 7733  history(self, w3
-00017a30: 3a20 2257 6562 3322 2920 2d3e 204e 6f6e  : "Web3") -> Non
-00017a40: 653a 0a20 2020 2020 2020 2066 6565 5f68  e:.        fee_h
-00017a50: 6973 746f 7279 203d 2077 332e 6574 682e  istory = w3.eth.
-00017a60: 6665 655f 6869 7374 6f72 7928 312c 2022  fee_history(1, "
-00017a70: 6c61 7465 7374 222c 205b 3530 5d29 0a20  latest", [50]). 
-00017a80: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00017a90: 5f6c 6973 745f 6c69 6b65 2866 6565 5f68  _list_like(fee_h
-00017aa0: 6973 746f 7279 5b22 6261 7365 4665 6550  istory["baseFeeP
-00017ab0: 6572 4761 7322 5d29 0a20 2020 2020 2020  erGas"]).       
-00017ac0: 2061 7373 6572 7420 6973 5f6c 6973 745f   assert is_list_
-00017ad0: 6c69 6b65 2866 6565 5f68 6973 746f 7279  like(fee_history
-00017ae0: 5b22 6761 7355 7365 6452 6174 696f 225d  ["gasUsedRatio"]
-00017af0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00017b00: 2069 735f 696e 7465 6765 7228 6665 655f   is_integer(fee_
-00017b10: 6869 7374 6f72 795b 226f 6c64 6573 7442  history["oldestB
-00017b20: 6c6f 636b 225d 290a 2020 2020 2020 2020  lock"]).        
-00017b30: 6173 7365 7274 2066 6565 5f68 6973 746f  assert fee_histo
-00017b40: 7279 5b22 6f6c 6465 7374 426c 6f63 6b22  ry["oldestBlock"
-00017b50: 5d20 3e3d 2030 0a20 2020 2020 2020 2061  ] >= 0.        a
-00017b60: 7373 6572 7420 6973 5f6c 6973 745f 6c69  ssert is_list_li
-00017b70: 6b65 2866 6565 5f68 6973 746f 7279 5b22  ke(fee_history["
-00017b80: 7265 7761 7264 225d 290a 2020 2020 2020  reward"]).      
-00017b90: 2020 6966 206c 656e 2866 6565 5f68 6973    if len(fee_his
-00017ba0: 746f 7279 5b22 7265 7761 7264 225d 2920  tory["reward"]) 
-00017bb0: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-00017bc0: 2061 7373 6572 7420 6973 5f6c 6973 745f   assert is_list_
-00017bd0: 6c69 6b65 2866 6565 5f68 6973 746f 7279  like(fee_history
-00017be0: 5b22 7265 7761 7264 225d 5b30 5d29 0a0a  ["reward"][0])..
-00017bf0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-00017c00: 5f66 6565 5f68 6973 746f 7279 5f77 6974  _fee_history_wit
-00017c10: 685f 696e 7465 6765 7228 0a20 2020 2020  h_integer(.     
-00017c20: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
-00017c30: 6233 222c 2065 6d70 7479 5f62 6c6f 636b  b3", empty_block
-00017c40: 3a20 426c 6f63 6b44 6174 610a 2020 2020  : BlockData.    
-00017c50: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00017c60: 2020 2066 6565 5f68 6973 746f 7279 203d     fee_history =
-00017c70: 2077 332e 6574 682e 6665 655f 6869 7374   w3.eth.fee_hist
-00017c80: 6f72 7928 312c 2065 6d70 7479 5f62 6c6f  ory(1, empty_blo
-00017c90: 636b 5b22 6e75 6d62 6572 225d 2c20 5b35  ck["number"], [5
-00017ca0: 305d 290a 2020 2020 2020 2020 6173 7365  0]).        asse
-00017cb0: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
-00017cc0: 6665 655f 6869 7374 6f72 795b 2262 6173  fee_history["bas
-00017cd0: 6546 6565 5065 7247 6173 225d 290a 2020  eFeePerGas"]).  
-00017ce0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00017cf0: 6c69 7374 5f6c 696b 6528 6665 655f 6869  list_like(fee_hi
-00017d00: 7374 6f72 795b 2267 6173 5573 6564 5261  story["gasUsedRa
-00017d10: 7469 6f22 5d29 0a20 2020 2020 2020 2061  tio"]).        a
-00017d20: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
-00017d30: 2866 6565 5f68 6973 746f 7279 5b22 6f6c  (fee_history["ol
-00017d40: 6465 7374 426c 6f63 6b22 5d29 0a20 2020  destBlock"]).   
-00017d50: 2020 2020 2061 7373 6572 7420 6665 655f       assert fee_
-00017d60: 6869 7374 6f72 795b 226f 6c64 6573 7442  history["oldestB
-00017d70: 6c6f 636b 225d 203e 3d20 300a 2020 2020  lock"] >= 0.    
-00017d80: 2020 2020 6173 7365 7274 2069 735f 6c69      assert is_li
-00017d90: 7374 5f6c 696b 6528 6665 655f 6869 7374  st_like(fee_hist
-00017da0: 6f72 795b 2272 6577 6172 6422 5d29 0a20  ory["reward"]). 
-00017db0: 2020 2020 2020 2069 6620 6c65 6e28 6665         if len(fe
-00017dc0: 655f 6869 7374 6f72 795b 2272 6577 6172  e_history["rewar
-00017dd0: 6422 5d29 203e 2030 3a0a 2020 2020 2020  d"]) > 0:.      
-00017de0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00017df0: 6c69 7374 5f6c 696b 6528 6665 655f 6869  list_like(fee_hi
-00017e00: 7374 6f72 795b 2272 6577 6172 6422 5d5b  story["reward"][
-00017e10: 305d 290a 0a20 2020 2064 6566 2074 6573  0])..    def tes
-00017e20: 745f 6574 685f 6665 655f 6869 7374 6f72  t_eth_fee_histor
-00017e30: 795f 6e6f 5f72 6577 6172 645f 7065 7263  y_no_reward_perc
-00017e40: 656e 7469 6c65 7328 7365 6c66 2c20 7733  entiles(self, w3
-00017e50: 3a20 2257 6562 3322 2920 2d3e 204e 6f6e  : "Web3") -> Non
-00017e60: 653a 0a20 2020 2020 2020 2066 6565 5f68  e:.        fee_h
-00017e70: 6973 746f 7279 203d 2077 332e 6574 682e  istory = w3.eth.
-00017e80: 6665 655f 6869 7374 6f72 7928 312c 2022  fee_history(1, "
-00017e90: 6c61 7465 7374 2229 0a20 2020 2020 2020  latest").       
-00017ea0: 2061 7373 6572 7420 6973 5f6c 6973 745f   assert is_list_
-00017eb0: 6c69 6b65 2866 6565 5f68 6973 746f 7279  like(fee_history
-00017ec0: 5b22 6261 7365 4665 6550 6572 4761 7322  ["baseFeePerGas"
-00017ed0: 5d29 0a20 2020 2020 2020 2061 7373 6572  ]).        asser
-00017ee0: 7420 6973 5f6c 6973 745f 6c69 6b65 2866  t is_list_like(f
-00017ef0: 6565 5f68 6973 746f 7279 5b22 6761 7355  ee_history["gasU
-00017f00: 7365 6452 6174 696f 225d 290a 2020 2020  sedRatio"]).    
-00017f10: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
-00017f20: 7465 6765 7228 6665 655f 6869 7374 6f72  teger(fee_histor
-00017f30: 795b 226f 6c64 6573 7442 6c6f 636b 225d  y["oldestBlock"]
-00017f40: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00017f50: 2066 6565 5f68 6973 746f 7279 5b22 6f6c   fee_history["ol
-00017f60: 6465 7374 426c 6f63 6b22 5d20 3e3d 2030  destBlock"] >= 0
-00017f70: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-00017f80: 7468 5f67 6173 5f70 7269 6365 2873 656c  th_gas_price(sel
-00017f90: 662c 2077 333a 2022 5765 6233 2229 202d  f, w3: "Web3") -
-00017fa0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00017fb0: 6761 735f 7072 6963 6520 3d20 7733 2e65  gas_price = w3.e
-00017fc0: 7468 2e67 6173 5f70 7269 6365 0a20 2020  th.gas_price.   
-00017fd0: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
-00017fe0: 6e74 6567 6572 2867 6173 5f70 7269 6365  nteger(gas_price
-00017ff0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00018000: 2067 6173 5f70 7269 6365 203e 2030 0a0a   gas_price > 0..
-00018010: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-00018020: 5f6d 6178 5f70 7269 6f72 6974 795f 6665  _max_priority_fe
-00018030: 6528 7365 6c66 2c20 7733 3a20 2257 6562  e(self, w3: "Web
-00018040: 3322 2920 2d3e 204e 6f6e 653a 0a20 2020  3") -> None:.   
-00018050: 2020 2020 206d 6178 5f70 7269 6f72 6974       max_priorit
-00018060: 795f 6665 6520 3d20 7733 2e65 7468 2e6d  y_fee = w3.eth.m
-00018070: 6178 5f70 7269 6f72 6974 795f 6665 650a  ax_priority_fee.
-00018080: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00018090: 735f 696e 7465 6765 7228 6d61 785f 7072  s_integer(max_pr
-000180a0: 696f 7269 7479 5f66 6565 290a 0a20 2020  iority_fee)..   
-000180b0: 2064 6566 2074 6573 745f 6574 685f 6d61   def test_eth_ma
-000180c0: 785f 7072 696f 7269 7479 5f66 6565 5f77  x_priority_fee_w
-000180d0: 6974 685f 6665 655f 6869 7374 6f72 795f  ith_fee_history_
-000180e0: 6361 6c63 756c 6174 696f 6e28 0a20 2020  calculation(.   
-000180f0: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
-00018100: 5765 6233 222c 2072 6571 7565 7374 5f6d  Web3", request_m
-00018110: 6f63 6b65 723a 2054 7970 655b 5265 7175  ocker: Type[Requ
-00018120: 6573 744d 6f63 6b65 725d 0a20 2020 2029  estMocker].    )
-00018130: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00018140: 2020 7769 7468 2072 6571 7565 7374 5f6d    with request_m
-00018150: 6f63 6b65 7228 0a20 2020 2020 2020 2020  ocker(.         
-00018160: 2020 2077 332c 0a20 2020 2020 2020 2020     w3,.         
-00018170: 2020 206d 6f63 6b5f 6572 726f 7273 3d7b     mock_errors={
-00018180: 5250 4345 6e64 706f 696e 7428 2265 7468  RPCEndpoint("eth
-00018190: 5f6d 6178 5072 696f 7269 7479 4665 6550  _maxPriorityFeeP
-000181a0: 6572 4761 7322 293a 207b 7d7d 2c0a 2020  erGas"): {}},.  
-000181b0: 2020 2020 2020 2020 2020 6d6f 636b 5f72            mock_r
-000181c0: 6573 756c 7473 3d7b 5250 4345 6e64 706f  esults={RPCEndpo
-000181d0: 696e 7428 2265 7468 5f66 6565 4869 7374  int("eth_feeHist
-000181e0: 6f72 7922 293a 207b 2272 6577 6172 6422  ory"): {"reward"
-000181f0: 3a20 5b5b 305d 5d7d 7d2c 0a20 2020 2020  : [[0]]}},.     
-00018200: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00018210: 2020 7769 7468 2070 7974 6573 742e 7761    with pytest.wa
-00018220: 726e 7328 0a20 2020 2020 2020 2020 2020  rns(.           
-00018230: 2020 2020 2055 7365 7257 6172 6e69 6e67       UserWarning
-00018240: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00018250: 2020 6d61 7463 683d 280a 2020 2020 2020    match=(.      
-00018260: 2020 2020 2020 2020 2020 2020 2020 2254                "T
-00018270: 6865 7265 2077 6173 2061 6e20 6973 7375  here was an issu
-00018280: 6520 7769 7468 2074 6865 206d 6574 686f  e with the metho
-00018290: 6420 6574 685f 6d61 7850 7269 6f72 6974  d eth_maxPriorit
-000182a0: 7946 6565 5065 7247 6173 2e20 220a 2020  yFeePerGas. ".  
-000182b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182c0: 2020 2243 616c 6375 6c61 7469 6e67 2075    "Calculating u
-000182d0: 7369 6e67 2065 7468 5f66 6565 4869 7374  sing eth_feeHist
-000182e0: 6f72 792e 220a 2020 2020 2020 2020 2020  ory.".          
-000182f0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-00018300: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-00018310: 2020 2020 2020 2020 6d61 785f 7072 696f          max_prio
-00018320: 7269 7479 5f66 6565 203d 2077 332e 6574  rity_fee = w3.et
-00018330: 682e 6d61 785f 7072 696f 7269 7479 5f66  h.max_priority_f
-00018340: 6565 0a20 2020 2020 2020 2020 2020 2020  ee.             
-00018350: 2020 2061 7373 6572 7420 6973 5f69 6e74     assert is_int
-00018360: 6567 6572 286d 6178 5f70 7269 6f72 6974  eger(max_priorit
-00018370: 795f 6665 6529 0a20 2020 2020 2020 2020  y_fee).         
-00018380: 2020 2020 2020 2061 7373 6572 7420 6d61         assert ma
-00018390: 785f 7072 696f 7269 7479 5f66 6565 203d  x_priority_fee =
-000183a0: 3d20 5052 494f 5249 5459 5f46 4545 5f4d  = PRIORITY_FEE_M
-000183b0: 494e 0a0a 2020 2020 6465 6620 7465 7374  IN..    def test
-000183c0: 5f65 7468 5f61 6363 6f75 6e74 7328 7365  _eth_accounts(se
-000183d0: 6c66 2c20 7733 3a20 2257 6562 3322 2920  lf, w3: "Web3") 
-000183e0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-000183f0: 2061 6363 6f75 6e74 7320 3d20 7733 2e65   accounts = w3.e
-00018400: 7468 2e61 6363 6f75 6e74 730a 2020 2020  th.accounts.    
-00018410: 2020 2020 6173 7365 7274 2069 735f 6c69      assert is_li
-00018420: 7374 5f6c 696b 6528 6163 636f 756e 7473  st_like(accounts
-00018430: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00018440: 206c 656e 2861 6363 6f75 6e74 7329 2021   len(accounts) !
-00018450: 3d20 300a 2020 2020 2020 2020 6173 7365  = 0.        asse
-00018460: 7274 2061 6c6c 2828 6973 5f63 6865 636b  rt all((is_check
-00018470: 7375 6d5f 6164 6472 6573 7328 6163 636f  sum_address(acco
-00018480: 756e 7429 2066 6f72 2061 6363 6f75 6e74  unt) for account
-00018490: 2069 6e20 6163 636f 756e 7473 2929 0a20   in accounts)). 
-000184a0: 2020 2020 2020 2061 7373 6572 7420 7733         assert w3
-000184b0: 2e65 7468 2e63 6f69 6e62 6173 6520 696e  .eth.coinbase in
-000184c0: 2061 6363 6f75 6e74 730a 0a20 2020 2064   accounts..    d
-000184d0: 6566 2074 6573 745f 6574 685f 626c 6f63  ef test_eth_bloc
-000184e0: 6b5f 6e75 6d62 6572 2873 656c 662c 2077  k_number(self, w
-000184f0: 333a 2022 5765 6233 2229 202d 3e20 4e6f  3: "Web3") -> No
-00018500: 6e65 3a0a 2020 2020 2020 2020 626c 6f63  ne:.        bloc
-00018510: 6b5f 6e75 6d62 6572 203d 2077 332e 6574  k_number = w3.et
-00018520: 682e 626c 6f63 6b5f 6e75 6d62 6572 0a20  h.block_number. 
-00018530: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00018540: 5f69 6e74 6567 6572 2862 6c6f 636b 5f6e  _integer(block_n
-00018550: 756d 6265 7229 0a20 2020 2020 2020 2061  umber).        a
-00018560: 7373 6572 7420 626c 6f63 6b5f 6e75 6d62  ssert block_numb
-00018570: 6572 203e 3d20 300a 0a20 2020 2064 6566  er >= 0..    def
-00018580: 2074 6573 745f 6574 685f 6765 745f 626c   test_eth_get_bl
-00018590: 6f63 6b5f 6e75 6d62 6572 2873 656c 662c  ock_number(self,
-000185a0: 2077 333a 2022 5765 6233 2229 202d 3e20   w3: "Web3") -> 
-000185b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 626c  None:.        bl
-000185c0: 6f63 6b5f 6e75 6d62 6572 203d 2077 332e  ock_number = w3.
-000185d0: 6574 682e 6765 745f 626c 6f63 6b5f 6e75  eth.get_block_nu
-000185e0: 6d62 6572 2829 0a20 2020 2020 2020 2061  mber().        a
-000185f0: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
-00018600: 2862 6c6f 636b 5f6e 756d 6265 7229 0a20  (block_number). 
-00018610: 2020 2020 2020 2061 7373 6572 7420 626c         assert bl
-00018620: 6f63 6b5f 6e75 6d62 6572 203e 3d20 300a  ock_number >= 0.
-00018630: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00018640: 685f 6765 745f 6261 6c61 6e63 6528 7365  h_get_balance(se
-00018650: 6c66 2c20 7733 3a20 2257 6562 3322 2920  lf, w3: "Web3") 
-00018660: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00018670: 2063 6f69 6e62 6173 6520 3d20 7733 2e65   coinbase = w3.e
-00018680: 7468 2e63 6f69 6e62 6173 650a 0a20 2020  th.coinbase..   
-00018690: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-000186a0: 2e72 6169 7365 7328 496e 7661 6c69 6441  .raises(InvalidA
-000186b0: 6464 7265 7373 293a 0a20 2020 2020 2020  ddress):.       
-000186c0: 2020 2020 2077 332e 6574 682e 6765 745f       w3.eth.get_
-000186d0: 6261 6c61 6e63 6528 4368 6563 6b73 756d  balance(Checksum
-000186e0: 4164 6472 6573 7328 4865 7841 6464 7265  Address(HexAddre
-000186f0: 7373 2848 6578 5374 7228 636f 696e 6261  ss(HexStr(coinba
-00018700: 7365 2e6c 6f77 6572 2829 2929 2929 0a0a  se.lower()))))..
-00018710: 2020 2020 2020 2020 6261 6c61 6e63 6520          balance 
-00018720: 3d20 7733 2e65 7468 2e67 6574 5f62 616c  = w3.eth.get_bal
-00018730: 616e 6365 2863 6f69 6e62 6173 6529 0a0a  ance(coinbase)..
-00018740: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00018750: 735f 696e 7465 6765 7228 6261 6c61 6e63  s_integer(balanc
-00018760: 6529 0a20 2020 2020 2020 2061 7373 6572  e).        asser
-00018770: 7420 6261 6c61 6e63 6520 3e3d 2030 0a0a  t balance >= 0..
-00018780: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-00018790: 5f67 6574 5f62 616c 616e 6365 5f77 6974  _get_balance_wit
-000187a0: 685f 626c 6f63 6b5f 6964 656e 7469 6669  h_block_identifi
-000187b0: 6572 2873 656c 662c 2077 333a 2022 5765  er(self, w3: "We
-000187c0: 6233 2229 202d 3e20 4e6f 6e65 3a0a 2020  b3") -> None:.  
-000187d0: 2020 2020 2020 6d69 6e65 725f 6164 6472        miner_addr
-000187e0: 6573 7320 3d20 7733 2e65 7468 2e67 6574  ess = w3.eth.get
-000187f0: 5f62 6c6f 636b 2831 295b 226d 696e 6572  _block(1)["miner
-00018800: 225d 0a20 2020 2020 2020 2062 616c 616e  "].        balan
-00018810: 6365 5f70 6f73 745f 6765 6e65 7369 7320  ce_post_genesis 
-00018820: 3d20 7733 2e65 7468 2e67 6574 5f62 616c  = w3.eth.get_bal
-00018830: 616e 6365 286d 696e 6572 5f61 6464 7265  ance(miner_addre
-00018840: 7373 2c20 3129 0a20 2020 2020 2020 206c  ss, 1).        l
-00018850: 6174 6572 5f62 616c 616e 6365 203d 2077  ater_balance = w
-00018860: 332e 6574 682e 6765 745f 6261 6c61 6e63  3.eth.get_balanc
-00018870: 6528 6d69 6e65 725f 6164 6472 6573 732c  e(miner_address,
-00018880: 2022 6c61 7465 7374 2229 0a0a 2020 2020   "latest")..    
-00018890: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
-000188a0: 7465 6765 7228 6261 6c61 6e63 655f 706f  teger(balance_po
-000188b0: 7374 5f67 656e 6573 6973 290a 2020 2020  st_genesis).    
-000188c0: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
-000188d0: 7465 6765 7228 6c61 7465 725f 6261 6c61  teger(later_bala
-000188e0: 6e63 6529 0a20 2020 2020 2020 2061 7373  nce).        ass
-000188f0: 6572 7420 6c61 7465 725f 6261 6c61 6e63  ert later_balanc
-00018900: 6520 3e20 6261 6c61 6e63 655f 706f 7374  e > balance_post
-00018910: 5f67 656e 6573 6973 0a0a 2020 2020 4070  _genesis..    @p
-00018920: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-00018930: 6574 7269 7a65 280a 2020 2020 2020 2020  etrize(.        
-00018940: 2261 6464 7265 7373 2c20 6578 7065 6374  "address, expect
-00018950: 5f73 7563 6365 7373 222c 0a20 2020 2020  _success",.     
-00018960: 2020 205b 2822 7465 7374 2d61 6464 7265     [("test-addre
-00018970: 7373 2e65 7468 222c 2054 7275 6529 2c20  ss.eth", True), 
-00018980: 2822 6e6f 742d 616e 2d61 6464 7265 7373  ("not-an-address
-00018990: 2e65 7468 222c 2046 616c 7365 295d 2c0a  .eth", False)],.
-000189a0: 2020 2020 290a 2020 2020 6465 6620 7465      ).    def te
-000189b0: 7374 5f65 7468 5f67 6574 5f62 616c 616e  st_eth_get_balan
-000189c0: 6365 5f77 6974 685f 656e 735f 6e61 6d65  ce_with_ens_name
-000189d0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-000189e0: 7733 3a20 2257 6562 3322 2c20 6164 6472  w3: "Web3", addr
-000189f0: 6573 733a 2043 6865 636b 7375 6d41 6464  ess: ChecksumAdd
-00018a00: 7265 7373 2c20 6578 7065 6374 5f73 7563  ress, expect_suc
-00018a10: 6365 7373 3a20 626f 6f6c 0a20 2020 2029  cess: bool.    )
-00018a20: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00018a30: 2020 7769 7468 2065 6e73 5f61 6464 7265    with ens_addre
-00018a40: 7373 6573 2877 332c 207b 2274 6573 742d  sses(w3, {"test-
-00018a50: 6164 6472 6573 732e 6574 6822 3a20 7733  address.eth": w3
-00018a60: 2e65 7468 2e61 6363 6f75 6e74 735b 305d  .eth.accounts[0]
-00018a70: 7d29 3a0a 2020 2020 2020 2020 2020 2020  }):.            
-00018a80: 6966 2065 7870 6563 745f 7375 6363 6573  if expect_succes
-00018a90: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00018aa0: 2020 2062 616c 616e 6365 203d 2077 332e     balance = w3.
-00018ab0: 6574 682e 6765 745f 6261 6c61 6e63 6528  eth.get_balance(
-00018ac0: 6164 6472 6573 7329 0a20 2020 2020 2020  address).       
-00018ad0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-00018ae0: 6973 5f69 6e74 6567 6572 2862 616c 616e  is_integer(balan
-00018af0: 6365 290a 2020 2020 2020 2020 2020 2020  ce).            
-00018b00: 2020 2020 6173 7365 7274 2062 616c 616e      assert balan
-00018b10: 6365 203e 3d20 300a 2020 2020 2020 2020  ce >= 0.        
-00018b20: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00018b30: 2020 2020 2020 2020 2020 7769 7468 2070            with p
-00018b40: 7974 6573 742e 7261 6973 6573 284e 616d  ytest.raises(Nam
-00018b50: 654e 6f74 466f 756e 6429 3a0a 2020 2020  eNotFound):.    
-00018b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b70: 7733 2e65 7468 2e67 6574 5f62 616c 616e  w3.eth.get_balan
-00018b80: 6365 2861 6464 7265 7373 290a 0a20 2020  ce(address)..   
-00018b90: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
-00018ba0: 745f 7374 6f72 6167 655f 6174 2873 656c  t_storage_at(sel
-00018bb0: 662c 2077 333a 2022 5765 6233 222c 2073  f, w3: "Web3", s
-00018bc0: 746f 7261 6765 5f63 6f6e 7472 6163 743a  torage_contract:
-00018bd0: 2022 436f 6e74 7261 6374 2229 202d 3e20   "Contract") -> 
-00018be0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7374  None:.        st
-00018bf0: 6f72 6167 655f 636f 6e74 7261 6374 5f61  orage_contract_a
-00018c00: 6464 7265 7373 203d 2073 746f 7261 6765  ddress = storage
-00018c10: 5f63 6f6e 7472 6163 742e 6164 6472 6573  _contract.addres
-00018c20: 730a 0a20 2020 2020 2020 2073 6c6f 745f  s..        slot_
-00018c30: 3020 3d20 7733 2e65 7468 2e67 6574 5f73  0 = w3.eth.get_s
-00018c40: 746f 7261 6765 5f61 7428 7374 6f72 6167  torage_at(storag
-00018c50: 655f 636f 6e74 7261 6374 5f61 6464 7265  e_contract_addre
-00018c60: 7373 2c20 3029 0a20 2020 2020 2020 2061  ss, 0).        a
-00018c70: 7373 6572 7420 736c 6f74 5f30 203d 3d20  ssert slot_0 == 
-00018c80: 4865 7842 7974 6573 2866 2230 787b 2730  HexBytes(f"0x{'0
-00018c90: 3027 202a 2033 327d 2229 0a0a 2020 2020  0' * 32}")..    
-00018ca0: 2020 2020 736c 6f74 5f31 203d 2077 332e      slot_1 = w3.
-00018cb0: 6574 682e 6765 745f 7374 6f72 6167 655f  eth.get_storage_
-00018cc0: 6174 2873 746f 7261 6765 5f63 6f6e 7472  at(storage_contr
-00018cd0: 6163 745f 6164 6472 6573 732c 2031 290a  act_address, 1).
-00018ce0: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
-00018cf0: 6c6f 745f 3120 3d3d 2048 6578 4279 7465  lot_1 == HexByte
-00018d00: 7328 6622 3078 7b27 3030 2720 2a20 3331  s(f"0x{'00' * 31
-00018d10: 7d30 3122 290a 0a20 2020 2020 2020 2073  }01")..        s
-00018d20: 6c6f 745f 3220 3d20 7733 2e65 7468 2e67  lot_2 = w3.eth.g
-00018d30: 6574 5f73 746f 7261 6765 5f61 7428 7374  et_storage_at(st
-00018d40: 6f72 6167 655f 636f 6e74 7261 6374 5f61  orage_contract_a
-00018d50: 6464 7265 7373 2c20 3229 0a20 2020 2020  ddress, 2).     
-00018d60: 2020 2061 7373 6572 7420 736c 6f74 5f32     assert slot_2
-00018d70: 203d 3d20 4865 7842 7974 6573 2866 2230   == HexBytes(f"0
-00018d80: 787b 2730 3027 202a 2033 317d 3032 2229  x{'00' * 31}02")
-00018d90: 0a0a 2020 2020 2020 2020 736c 6f74 5f33  ..        slot_3
-00018da0: 203d 2077 332e 6574 682e 6765 745f 7374   = w3.eth.get_st
-00018db0: 6f72 6167 655f 6174 2873 746f 7261 6765  orage_at(storage
-00018dc0: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
-00018dd0: 732c 2033 290a 2020 2020 2020 2020 6173  s, 3).        as
-00018de0: 7365 7274 2073 6c6f 745f 3320 3d3d 2048  sert slot_3 == H
-00018df0: 6578 4279 7465 7328 0a20 2020 2020 2020  exBytes(.       
-00018e00: 2020 2020 2022 3078 3734 3638 3732 3635       "0x74687265
-00018e10: 3635 3030 3030 3030 3030 3030 3030 3030  6500000000000000
+00012ec0: 3030 3030 3030 3030 3030 3030 3030 3038  0000000000000008
+00012ed0: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
+00012ee0: 2020 2020 6173 7365 7274 2062 7974 6573      assert bytes
+00012ef0: 2873 6c6f 745f 345b 3a34 5d29 203d 3d20  (slot_4[:4]) == 
+00012f00: 6222 666f 7572 220a 0a20 2020 2040 7079  b"four"..    @py
+00012f10: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+00012f20: 6f0a 2020 2020 4070 7974 6573 742e 6d61  o.    @pytest.ma
+00012f30: 726b 2e78 6661 696c 0a20 2020 2061 7379  rk.xfail.    asy
+00012f40: 6e63 2064 6566 2074 6573 745f 6173 796e  nc def test_asyn
+00012f50: 635f 6574 685f 6765 745f 7374 6f72 6167  c_eth_get_storag
+00012f60: 655f 6174 5f65 6e73 5f6e 616d 6528 0a20  e_at_ens_name(. 
+00012f70: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
+00012f80: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
+00012f90: 3322 2c20 6173 796e 635f 7374 6f72 6167  3", async_storag
+00012fa0: 655f 636f 6e74 7261 6374 3a20 2241 7379  e_contract: "Asy
+00012fb0: 6e63 436f 6e74 7261 6374 220a 2020 2020  ncContract".    
+00012fc0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00012fd0: 2020 2077 6974 6820 656e 735f 6164 6472     with ens_addr
+00012fe0: 6573 7365 7328 6173 796e 635f 7733 2c20  esses(async_w3, 
+00012ff0: 7b22 7374 6f72 6167 652e 6574 6822 3a20  {"storage.eth": 
+00013000: 6173 796e 635f 7374 6f72 6167 655f 636f  async_storage_co
+00013010: 6e74 7261 6374 2e61 6464 7265 7373 7d29  ntract.address})
+00013020: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
+00013030: 6f72 6167 6520 3d20 6177 6169 7420 6173  orage = await as
+00013040: 796e 635f 7733 2e65 7468 2e67 6574 5f73  ync_w3.eth.get_s
+00013050: 746f 7261 6765 5f61 7428 454e 5328 2273  torage_at(ENS("s
+00013060: 746f 7261 6765 2e65 7468 2229 2c20 3129  torage.eth"), 1)
+00013070: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+00013080: 6572 7420 7374 6f72 6167 6520 3d3d 2048  ert storage == H
+00013090: 6578 4279 7465 7328 6622 3078 7b27 3030  exBytes(f"0x{'00
+000130a0: 2720 2a20 3331 7d30 3122 290a 0a20 2020  ' * 31}01")..   
+000130b0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+000130c0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+000130d0: 6465 6620 7465 7374 5f61 7379 6e63 5f65  def test_async_e
+000130e0: 7468 5f67 6574 5f73 746f 7261 6765 5f61  th_get_storage_a
+000130f0: 745f 696e 7661 6c69 645f 6164 6472 6573  t_invalid_addres
+00013100: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+00013110: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+00013120: 6357 6562 3322 0a20 2020 2029 202d 3e20  cWeb3".    ) -> 
+00013130: 4e6f 6e65 3a0a 2020 2020 2020 2020 636f  None:.        co
+00013140: 696e 6261 7365 203d 2061 7761 6974 2061  inbase = await a
+00013150: 7379 6e63 5f77 332e 6574 682e 636f 696e  sync_w3.eth.coin
+00013160: 6261 7365 0a20 2020 2020 2020 2077 6974  base.        wit
+00013170: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+00013180: 496e 7661 6c69 6441 6464 7265 7373 293a  InvalidAddress):
+00013190: 0a20 2020 2020 2020 2020 2020 2061 7761  .            awa
+000131a0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+000131b0: 6765 745f 7374 6f72 6167 655f 6174 280a  get_storage_at(.
+000131c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000131d0: 4368 6563 6b73 756d 4164 6472 6573 7328  ChecksumAddress(
+000131e0: 4865 7841 6464 7265 7373 2848 6578 5374  HexAddress(HexSt
+000131f0: 7228 636f 696e 6261 7365 2e6c 6f77 6572  r(coinbase.lower
+00013200: 2829 2929 292c 2030 0a20 2020 2020 2020  ()))), 0.       
+00013210: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00013220: 7465 7374 5f61 7379 6e63 5f70 726f 7669  test_async_provi
+00013230: 6465 725f 6465 6661 756c 745f 6163 636f  der_default_acco
+00013240: 756e 7428 0a20 2020 2020 2020 2073 656c  unt(.        sel
+00013250: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
+00013260: 796e 6357 6562 3322 2c20 6173 796e 635f  yncWeb3", async_
+00013270: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+00013280: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
+00013290: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
+000132a0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+000132b0: 2020 2023 2063 6865 636b 2064 6566 6175     # check defau
+000132c0: 6c74 7320 746f 2065 6d70 7479 0a20 2020  lts to empty.   
+000132d0: 2020 2020 2064 6566 6175 6c74 5f61 6363       default_acc
+000132e0: 6f75 6e74 203d 2061 7379 6e63 5f77 332e  ount = async_w3.
+000132f0: 6574 682e 6465 6661 756c 745f 6163 636f  eth.default_acco
+00013300: 756e 740a 2020 2020 2020 2020 6173 7365  unt.        asse
+00013310: 7274 2064 6566 6175 6c74 5f61 6363 6f75  rt default_accou
+00013320: 6e74 2069 7320 656d 7074 790a 0a20 2020  nt is empty..   
+00013330: 2020 2020 2023 2063 6865 636b 2073 6574       # check set
+00013340: 7465 720a 2020 2020 2020 2020 6173 796e  ter.        asyn
+00013350: 635f 7733 2e65 7468 2e64 6566 6175 6c74  c_w3.eth.default
+00013360: 5f61 6363 6f75 6e74 203d 2061 7379 6e63  _account = async
+00013370: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+00013380: 745f 6475 616c 5f74 7970 650a 2020 2020  t_dual_type.    
+00013390: 2020 2020 6465 6661 756c 745f 6163 636f      default_acco
+000133a0: 756e 7420 3d20 6173 796e 635f 7733 2e65  unt = async_w3.e
+000133b0: 7468 2e64 6566 6175 6c74 5f61 6363 6f75  th.default_accou
+000133c0: 6e74 0a20 2020 2020 2020 2061 7373 6572  nt.        asser
+000133d0: 7420 6465 6661 756c 745f 6163 636f 756e  t default_accoun
+000133e0: 7420 3d3d 2061 7379 6e63 5f75 6e6c 6f63  t == async_unloc
+000133f0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+00013400: 5f74 7970 650a 0a20 2020 2020 2020 2023  _type..        #
+00013410: 2072 6573 6574 2074 6f20 6465 6661 756c   reset to defaul
+00013420: 740a 2020 2020 2020 2020 6173 796e 635f  t.        async_
+00013430: 7733 2e65 7468 2e64 6566 6175 6c74 5f61  w3.eth.default_a
+00013440: 6363 6f75 6e74 203d 2065 6d70 7479 0a0a  ccount = empty..
+00013450: 2020 2020 6465 6620 7465 7374 5f61 7379      def test_asy
+00013460: 6e63 5f70 726f 7669 6465 725f 6465 6661  nc_provider_defa
+00013470: 756c 745f 626c 6f63 6b28 0a20 2020 2020  ult_block(.     
+00013480: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00013490: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+000134a0: 6357 6562 3322 2c0a 2020 2020 2920 2d3e  cWeb3",.    ) ->
+000134b0: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
+000134c0: 2063 6865 636b 2064 6566 6175 6c74 7320   check defaults 
+000134d0: 746f 2027 6c61 7465 7374 270a 2020 2020  to 'latest'.    
+000134e0: 2020 2020 6465 6661 756c 745f 626c 6f63      default_bloc
+000134f0: 6b20 3d20 6173 796e 635f 7733 2e65 7468  k = async_w3.eth
+00013500: 2e64 6566 6175 6c74 5f62 6c6f 636b 0a20  .default_block. 
+00013510: 2020 2020 2020 2061 7373 6572 7420 6465         assert de
+00013520: 6661 756c 745f 626c 6f63 6b20 3d3d 2022  fault_block == "
+00013530: 6c61 7465 7374 220a 0a20 2020 2020 2020  latest"..       
+00013540: 2023 2063 6865 636b 2073 6574 7465 720a   # check setter.
+00013550: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
+00013560: 2e65 7468 2e64 6566 6175 6c74 5f62 6c6f  .eth.default_blo
+00013570: 636b 203d 2042 6c6f 636b 4e75 6d62 6572  ck = BlockNumber
+00013580: 2831 3233 3435 290a 2020 2020 2020 2020  (12345).        
+00013590: 6465 6661 756c 745f 626c 6f63 6b20 3d20  default_block = 
+000135a0: 6173 796e 635f 7733 2e65 7468 2e64 6566  async_w3.eth.def
+000135b0: 6175 6c74 5f62 6c6f 636b 0a20 2020 2020  ault_block.     
+000135c0: 2020 2061 7373 6572 7420 6465 6661 756c     assert defaul
+000135d0: 745f 626c 6f63 6b20 3d3d 2042 6c6f 636b  t_block == Block
+000135e0: 4e75 6d62 6572 2831 3233 3435 290a 0a20  Number(12345).. 
+000135f0: 2020 2020 2020 2023 2072 6573 6574 2074         # reset t
+00013600: 6f20 6465 6661 756c 740a 2020 2020 2020  o default.      
+00013610: 2020 6173 796e 635f 7733 2e65 7468 2e64    async_w3.eth.d
+00013620: 6566 6175 6c74 5f62 6c6f 636b 203d 2022  efault_block = "
+00013630: 6c61 7465 7374 220a 0a20 2020 2040 7079  latest"..    @py
+00013640: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+00013650: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+00013660: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
+00013670: 6b54 7261 6e73 6163 7469 6f6e 436f 756e  kTransactionCoun
+00013680: 7442 7948 6173 685f 6173 796e 635f 656d  tByHash_async_em
+00013690: 7074 795f 626c 6f63 6b28 0a20 2020 2020  pty_block(.     
+000136a0: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
+000136b0: 333a 2022 4173 796e 6357 6562 3322 2c20  3: "AsyncWeb3", 
+000136c0: 6173 796e 635f 656d 7074 795f 626c 6f63  async_empty_bloc
+000136d0: 6b3a 2042 6c6f 636b 4461 7461 0a20 2020  k: BlockData.   
+000136e0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+000136f0: 2020 2020 7472 616e 7361 6374 696f 6e5f      transaction_
+00013700: 636f 756e 7420 3d20 6177 6169 7420 6173  count = await as
+00013710: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
+00013720: 6c6f 636b 5f74 7261 6e73 6163 7469 6f6e  lock_transaction
+00013730: 5f63 6f75 6e74 280a 2020 2020 2020 2020  _count(.        
+00013740: 2020 2020 6173 796e 635f 656d 7074 795f      async_empty_
+00013750: 626c 6f63 6b5b 2268 6173 6822 5d0a 2020  block["hash"].  
+00013760: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00013770: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
+00013780: 6572 2874 7261 6e73 6163 7469 6f6e 5f63  er(transaction_c
+00013790: 6f75 6e74 290a 2020 2020 2020 2020 6173  ount).        as
+000137a0: 7365 7274 2074 7261 6e73 6163 7469 6f6e  sert transaction
+000137b0: 5f63 6f75 6e74 203d 3d20 300a 0a20 2020  _count == 0..   
+000137c0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+000137d0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+000137e0: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
+000137f0: 426c 6f63 6b54 7261 6e73 6163 7469 6f6e  BlockTransaction
+00013800: 436f 756e 7442 794e 756d 6265 725f 6173  CountByNumber_as
+00013810: 796e 635f 656d 7074 795f 626c 6f63 6b28  ync_empty_block(
+00013820: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
+00013830: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
+00013840: 6562 3322 2c20 6173 796e 635f 656d 7074  eb3", async_empt
+00013850: 795f 626c 6f63 6b3a 2042 6c6f 636b 4461  y_block: BlockDa
+00013860: 7461 0a20 2020 2029 202d 3e20 4e6f 6e65  ta.    ) -> None
+00013870: 3a0a 2020 2020 2020 2020 7472 616e 7361  :.        transa
+00013880: 6374 696f 6e5f 636f 756e 7420 3d20 6177  ction_count = aw
+00013890: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+000138a0: 2e67 6574 5f62 6c6f 636b 5f74 7261 6e73  .get_block_trans
+000138b0: 6163 7469 6f6e 5f63 6f75 6e74 280a 2020  action_count(.  
+000138c0: 2020 2020 2020 2020 2020 6173 796e 635f            async_
+000138d0: 656d 7074 795f 626c 6f63 6b5b 226e 756d  empty_block["num
+000138e0: 6265 7222 5d0a 2020 2020 2020 2020 290a  ber"].        ).
+000138f0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00013900: 6973 5f69 6e74 6567 6572 2874 7261 6e73  is_integer(trans
+00013910: 6163 7469 6f6e 5f63 6f75 6e74 290a 2020  action_count).  
+00013920: 2020 2020 2020 6173 7365 7274 2074 7261        assert tra
+00013930: 6e73 6163 7469 6f6e 5f63 6f75 6e74 203d  nsaction_count =
+00013940: 3d20 300a 0a20 2020 2040 7079 7465 7374  = 0..    @pytest
+00013950: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+00013960: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+00013970: 5f65 7468 5f67 6574 426c 6f63 6b54 7261  _eth_getBlockTra
+00013980: 6e73 6163 7469 6f6e 436f 756e 7442 7948  nsactionCountByH
+00013990: 6173 685f 626c 6f63 6b5f 7769 7468 5f74  ash_block_with_t
+000139a0: 786e 280a 2020 2020 2020 2020 7365 6c66  xn(.        self
+000139b0: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
+000139c0: 6e63 5765 6233 222c 2061 7379 6e63 5f62  ncWeb3", async_b
+000139d0: 6c6f 636b 5f77 6974 685f 7478 6e3a 2042  lock_with_txn: B
+000139e0: 6c6f 636b 4461 7461 0a20 2020 2029 202d  lockData.    ) -
+000139f0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00013a00: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
+00013a10: 7420 3d20 6177 6169 7420 6173 796e 635f  t = await async_
+00013a20: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
+00013a30: 5f74 7261 6e73 6163 7469 6f6e 5f63 6f75  _transaction_cou
+00013a40: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+00013a50: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
+00013a60: 5f74 786e 5b22 6861 7368 225d 0a20 2020  _txn["hash"].   
+00013a70: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00013a80: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
+00013a90: 7228 7472 616e 7361 6374 696f 6e5f 636f  r(transaction_co
+00013aa0: 756e 7429 0a20 2020 2020 2020 2061 7373  unt).        ass
+00013ab0: 6572 7420 7472 616e 7361 6374 696f 6e5f  ert transaction_
+00013ac0: 636f 756e 7420 3e3d 2031 0a0a 2020 2020  count >= 1..    
+00013ad0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+00013ae0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+00013af0: 6566 2074 6573 745f 6574 685f 6765 7455  ef test_eth_getU
+00013b00: 6e63 6c65 436f 756e 7442 7942 6c6f 636b  ncleCountByBlock
+00013b10: 4861 7368 280a 2020 2020 2020 2020 7365  Hash(.        se
+00013b20: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00013b30: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
+00013b40: 5f65 6d70 7479 5f62 6c6f 636b 3a20 426c  _empty_block: Bl
+00013b50: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+00013b60: 204e 6f6e 653a 0a20 2020 2020 2020 2075   None:.        u
+00013b70: 6e63 6c65 5f63 6f75 6e74 203d 2061 7761  ncle_count = awa
+00013b80: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00013b90: 6765 745f 756e 636c 655f 636f 756e 7428  get_uncle_count(
+00013ba0: 6173 796e 635f 656d 7074 795f 626c 6f63  async_empty_bloc
+00013bb0: 6b5b 2268 6173 6822 5d29 0a0a 2020 2020  k["hash"])..    
+00013bc0: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
+00013bd0: 7465 6765 7228 756e 636c 655f 636f 756e  teger(uncle_coun
+00013be0: 7429 0a20 2020 2020 2020 2061 7373 6572  t).        asser
+00013bf0: 7420 756e 636c 655f 636f 756e 7420 3d3d  t uncle_count ==
+00013c00: 2030 0a0a 2020 2020 4070 7974 6573 742e   0..    @pytest.
+00013c10: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+00013c20: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+00013c30: 6574 685f 6765 7455 6e63 6c65 436f 756e  eth_getUncleCoun
+00013c40: 7442 7942 6c6f 636b 4e75 6d62 6572 280a  tByBlockNumber(.
+00013c50: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+00013c60: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00013c70: 6233 222c 2061 7379 6e63 5f65 6d70 7479  b3", async_empty
+00013c80: 5f62 6c6f 636b 3a20 426c 6f63 6b44 6174  _block: BlockDat
+00013c90: 610a 2020 2020 2920 2d3e 204e 6f6e 653a  a.    ) -> None:
+00013ca0: 0a20 2020 2020 2020 2075 6e63 6c65 5f63  .        uncle_c
+00013cb0: 6f75 6e74 203d 2061 7761 6974 2061 7379  ount = await asy
+00013cc0: 6e63 5f77 332e 6574 682e 6765 745f 756e  nc_w3.eth.get_un
+00013cd0: 636c 655f 636f 756e 7428 6173 796e 635f  cle_count(async_
+00013ce0: 656d 7074 795f 626c 6f63 6b5b 226e 756d  empty_block["num
+00013cf0: 6265 7222 5d29 0a0a 2020 2020 2020 2020  ber"])..        
+00013d00: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
+00013d10: 7228 756e 636c 655f 636f 756e 7429 0a20  r(uncle_count). 
+00013d20: 2020 2020 2020 2061 7373 6572 7420 756e         assert un
+00013d30: 636c 655f 636f 756e 7420 3d3d 2030 0a0a  cle_count == 0..
+00013d40: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+00013d50: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+00013d60: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
+00013d70: 6765 7442 6c6f 636b 5472 616e 7361 6374  getBlockTransact
+00013d80: 696f 6e43 6f75 6e74 4279 4e75 6d62 6572  ionCountByNumber
+00013d90: 5f62 6c6f 636b 5f77 6974 685f 7478 6e28  _block_with_txn(
+00013da0: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
+00013db0: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
+00013dc0: 6562 3322 2c20 6173 796e 635f 626c 6f63  eb3", async_bloc
+00013dd0: 6b5f 7769 7468 5f74 786e 3a20 426c 6f63  k_with_txn: Bloc
+00013de0: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
+00013df0: 6f6e 653a 0a20 2020 2020 2020 2074 7261  one:.        tra
+00013e00: 6e73 6163 7469 6f6e 5f63 6f75 6e74 203d  nsaction_count =
+00013e10: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00013e20: 6574 682e 6765 745f 626c 6f63 6b5f 7472  eth.get_block_tr
+00013e30: 616e 7361 6374 696f 6e5f 636f 756e 7428  ansaction_count(
+00013e40: 0a20 2020 2020 2020 2020 2020 2061 7379  .            asy
+00013e50: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
+00013e60: 6e5b 226e 756d 6265 7222 5d0a 2020 2020  n["number"].    
+00013e70: 2020 2020 290a 0a20 2020 2020 2020 2061      )..        a
+00013e80: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
+00013e90: 2874 7261 6e73 6163 7469 6f6e 5f63 6f75  (transaction_cou
+00013ea0: 6e74 290a 2020 2020 2020 2020 6173 7365  nt).        asse
+00013eb0: 7274 2074 7261 6e73 6163 7469 6f6e 5f63  rt transaction_c
+00013ec0: 6f75 6e74 203e 3d20 310a 0a20 2020 2040  ount >= 1..    @
+00013ed0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+00013ee0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+00013ef0: 6620 7465 7374 5f61 7379 6e63 5f65 7468  f test_async_eth
+00013f00: 5f73 6967 6e28 0a20 2020 2020 2020 2073  _sign(.        s
+00013f10: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
+00013f20: 4173 796e 6357 6562 3322 2c20 6173 796e  AsyncWeb3", asyn
+00013f30: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
+00013f40: 6e74 5f64 7561 6c5f 7479 7065 3a20 4368  nt_dual_type: Ch
+00013f50: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
+00013f60: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00013f70: 2020 2020 2073 6967 6e61 7475 7265 203d       signature =
+00013f80: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00013f90: 6574 682e 7369 676e 280a 2020 2020 2020  eth.sign(.      
+00013fa0: 2020 2020 2020 6173 796e 635f 756e 6c6f        async_unlo
+00013fb0: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+00013fc0: 6c5f 7479 7065 2c20 7465 7874 3d22 4d65  l_type, text="Me
+00013fd0: 7373 6167 6520 74c3 b620 7369 676e 2e20  ssage t.. sign. 
+00013fe0: 4c6f 6e67 6572 2074 6861 6e20 6861 7368  Longer than hash
+00013ff0: 2122 0a20 2020 2020 2020 2029 0a20 2020  !".        ).   
+00014000: 2020 2020 2061 7373 6572 7420 6973 5f62       assert is_b
+00014010: 7974 6573 2873 6967 6e61 7475 7265 290a  ytes(signature).
+00014020: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+00014030: 656e 2873 6967 6e61 7475 7265 2920 3d3d  en(signature) ==
+00014040: 2033 3220 2b20 3332 202b 2031 0a0a 2020   32 + 32 + 1..  
+00014050: 2020 2020 2020 2320 7465 7374 206f 7468        # test oth
+00014060: 6572 2066 6f72 6d61 7473 0a20 2020 2020  er formats.     
+00014070: 2020 2068 6578 7369 676e 203d 2061 7761     hexsign = awa
+00014080: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00014090: 7369 676e 280a 2020 2020 2020 2020 2020  sign(.          
+000140a0: 2020 6173 796e 635f 756e 6c6f 636b 6564    async_unlocked
+000140b0: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+000140c0: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+000140d0: 6865 7873 7472 3d48 6578 5374 7228 0a20  hexstr=HexStr(. 
+000140e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000140f0: 3078 3464 3635 3733 3733 3631 3637 3635  0x4d657373616765
+00014100: 3230 3734 6333 6236 3230 3733 3639 3637  2074c3b620736967
+00014110: 3665 3265 3230 3463 3666 3665 3637 3635  6e2e204c6f6e6765
+00014120: 3732 3230 3734 3638 3631 3665 3230 3638  72207468616e2068
+00014130: 3631 3733 3638 3231 2220 2023 206e 6f71  61736821"  # noq
+00014140: 613a 2045 3530 310a 2020 2020 2020 2020  a: E501.        
+00014150: 2020 2020 292c 0a20 2020 2020 2020 2029      ),.        )
+00014160: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00014170: 6865 7873 6967 6e20 3d3d 2073 6967 6e61  hexsign == signa
+00014180: 7475 7265 0a0a 2020 2020 2020 2020 696e  ture..        in
+00014190: 7473 6967 6e20 3d20 6177 6169 7420 6173  tsign = await as
+000141a0: 796e 635f 7733 2e65 7468 2e73 6967 6e28  ync_w3.eth.sign(
+000141b0: 0a20 2020 2020 2020 2020 2020 2061 7379  .            asy
+000141c0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+000141d0: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
+000141e0: 2020 2020 2020 2020 2020 2030 7834 4436             0x4D6
+000141f0: 3537 3337 3336 3136 3736 3532 3037 3443  573736167652074C
+00014200: 3342 3632 3037 3336 3936 3736 4532 4532  3B6207369676E2E2
+00014210: 3034 4336 4636 4536 3736 3537 3232 3037  04C6F6E676572207
+00014220: 3436 3836 3136 4532 3036 3836 3137 3336  468616E206861736
+00014230: 3832 312c 0a20 2020 2020 2020 2029 0a20  821,.        ). 
+00014240: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
+00014250: 7473 6967 6e20 3d3d 2073 6967 6e61 7475  tsign == signatu
+00014260: 7265 0a0a 2020 2020 2020 2020 6279 7465  re..        byte
+00014270: 7373 6967 6e20 3d20 6177 6169 7420 6173  ssign = await as
+00014280: 796e 635f 7733 2e65 7468 2e73 6967 6e28  ync_w3.eth.sign(
+00014290: 0a20 2020 2020 2020 2020 2020 2061 7379  .            asy
+000142a0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+000142b0: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
+000142c0: 2020 2020 2020 2020 2020 2062 224d 6573             b"Mes
+000142d0: 7361 6765 2074 5c78 6333 5c78 6236 2073  sage t\xc3\xb6 s
+000142e0: 6967 6e2e 204c 6f6e 6765 7220 7468 616e  ign. Longer than
+000142f0: 2068 6173 6821 222c 0a20 2020 2020 2020   hash!",.       
+00014300: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
+00014310: 7420 6279 7465 7373 6967 6e20 3d3d 2073  t bytessign == s
+00014320: 6967 6e61 7475 7265 0a0a 2020 2020 2020  ignature..      
+00014330: 2020 6e65 775f 7369 676e 6174 7572 6520    new_signature 
+00014340: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00014350: 2e65 7468 2e73 6967 6e28 0a20 2020 2020  .eth.sign(.     
+00014360: 2020 2020 2020 2061 7379 6e63 5f75 6e6c         async_unl
+00014370: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+00014380: 616c 5f74 7970 652c 2074 6578 743d 2264  al_type, text="d
+00014390: 6966 6665 7265 6e74 206d 6573 7361 6765  ifferent message
+000143a0: 2069 7320 6469 6666 6572 656e 7422 0a20   is different". 
+000143b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000143c0: 2061 7373 6572 7420 6e65 775f 7369 676e   assert new_sign
+000143d0: 6174 7572 6520 213d 2073 6967 6e61 7475  ature != signatu
+000143e0: 7265 0a0a 2020 2020 4070 7974 6573 742e  re..    @pytest.
+000143f0: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+00014400: 2040 7079 7465 7374 2e6d 6172 6b2e 7866   @pytest.mark.xf
+00014410: 6169 6c28 0a20 2020 2020 2020 2072 6561  ail(.        rea
+00014420: 736f 6e3d 2241 7379 6e63 206d 6964 646c  son="Async middl
+00014430: 6577 6172 6520 746f 2063 6f6e 7665 7274  eware to convert
+00014440: 2045 4e53 206e 616d 6573 2074 6f20 6164   ENS names to ad
+00014450: 6472 6573 7365 7320 6973 206d 6973 7369  dresses is missi
+00014460: 6e67 220a 2020 2020 290a 2020 2020 6173  ng".    ).    as
+00014470: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
+00014480: 6e63 5f65 7468 5f73 6967 6e5f 656e 735f  nc_eth_sign_ens_
+00014490: 6e61 6d65 7328 0a20 2020 2020 2020 2073  names(.        s
+000144a0: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
+000144b0: 4173 796e 6357 6562 3322 2c20 6173 796e  AsyncWeb3", asyn
+000144c0: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
+000144d0: 6e74 5f64 7561 6c5f 7479 7065 3a20 4368  nt_dual_type: Ch
+000144e0: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
+000144f0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00014500: 2020 2020 2077 6974 6820 656e 735f 6164       with ens_ad
+00014510: 6472 6573 7365 7328 0a20 2020 2020 2020  dresses(.       
+00014520: 2020 2020 2061 7379 6e63 5f77 332c 207b       async_w3, {
+00014530: 2275 6e6c 6f63 6b65 642d 6163 6374 2e65  "unlocked-acct.e
+00014540: 7468 223a 2061 7379 6e63 5f75 6e6c 6f63  th": async_unloc
+00014550: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+00014560: 5f74 7970 657d 0a20 2020 2020 2020 2029  _type}.        )
+00014570: 3a0a 2020 2020 2020 2020 2020 2020 7369  :.            si
+00014580: 676e 6174 7572 6520 3d20 6177 6169 7420  gnature = await 
+00014590: 6173 796e 635f 7733 2e65 7468 2e73 6967  async_w3.eth.sig
+000145a0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+000145b0: 2020 2045 4e53 2822 756e 6c6f 636b 6564     ENS("unlocked
+000145c0: 2d61 6363 742e 6574 6822 292c 2074 6578  -acct.eth"), tex
+000145d0: 743d 224d 6573 7361 6765 2074 c3b6 2073  t="Message t.. s
+000145e0: 6967 6e2e 204c 6f6e 6765 7220 7468 616e  ign. Longer than
+000145f0: 2068 6173 6821 220a 2020 2020 2020 2020   hash!".        
+00014600: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00014610: 2020 6173 7365 7274 2069 735f 6279 7465    assert is_byte
+00014620: 7328 7369 676e 6174 7572 6529 0a20 2020  s(signature).   
+00014630: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+00014640: 6c65 6e28 7369 676e 6174 7572 6529 203d  len(signature) =
+00014650: 3d20 3332 202b 2033 3220 2b20 310a 0a20  = 32 + 32 + 1.. 
+00014660: 2020 2040 666c 616b 795f 6765 7468 5f64     @flaky_geth_d
+00014670: 6576 5f6d 696e 696e 670a 2020 2020 4070  ev_mining.    @p
+00014680: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+00014690: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
+000146a0: 2074 6573 745f 6173 796e 635f 6574 685f   test_async_eth_
+000146b0: 7265 706c 6163 655f 7472 616e 7361 6374  replace_transact
+000146c0: 696f 6e5f 6c65 6761 6379 280a 2020 2020  ion_legacy(.    
+000146d0: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
+000146e0: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+000146f0: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+00014700: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+00014710: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
+00014720: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
+00014730: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
+00014740: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
+00014750: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00014760: 6672 6f6d 223a 2061 7379 6e63 5f75 6e6c  from": async_unl
+00014770: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+00014780: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00014790: 2020 2020 2022 746f 223a 2061 7379 6e63       "to": async
+000147a0: 5f75 6e6c 6f63 6b65 645f 6163 636f 756e  _unlocked_accoun
+000147b0: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
+000147c0: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+000147d0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+000147e0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+000147f0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+00014800: 2267 6173 5072 6963 6522 3a20 6173 796e  "gasPrice": asyn
+00014810: 635f 7733 2e74 6f5f 7765 6928 312c 2022  c_w3.to_wei(1, "
+00014820: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
+00014830: 7d0a 2020 2020 2020 2020 7478 6e5f 6861  }.        txn_ha
+00014840: 7368 203d 2061 7761 6974 2061 7379 6e63  sh = await async
+00014850: 5f77 332e 6574 682e 7365 6e64 5f74 7261  _w3.eth.send_tra
+00014860: 6e73 6163 7469 6f6e 2874 786e 5f70 6172  nsaction(txn_par
+00014870: 616d 7329 0a0a 2020 2020 2020 2020 7478  ams)..        tx
+00014880: 6e5f 7061 7261 6d73 5b22 6761 7350 7269  n_params["gasPri
+00014890: 6365 225d 203d 2061 7379 6e63 5f77 332e  ce"] = async_w3.
+000148a0: 746f 5f77 6569 2832 2c20 2267 7765 6922  to_wei(2, "gwei"
+000148b0: 290a 2020 2020 2020 2020 7265 706c 6163  ).        replac
+000148c0: 655f 7478 6e5f 6861 7368 203d 2061 7761  e_txn_hash = awa
+000148d0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+000148e0: 7265 706c 6163 655f 7472 616e 7361 6374  replace_transact
+000148f0: 696f 6e28 7478 6e5f 6861 7368 2c20 7478  ion(txn_hash, tx
+00014900: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
+00014910: 2020 7265 706c 6163 655f 7478 6e20 3d20    replace_txn = 
+00014920: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00014930: 7468 2e67 6574 5f74 7261 6e73 6163 7469  th.get_transacti
+00014940: 6f6e 2872 6570 6c61 6365 5f74 786e 5f68  on(replace_txn_h
+00014950: 6173 6829 0a0a 2020 2020 2020 2020 6173  ash)..        as
+00014960: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
+00014970: 7265 7373 280a 2020 2020 2020 2020 2020  ress(.          
+00014980: 2020 7265 706c 6163 655f 7478 6e5b 2266    replace_txn["f
+00014990: 726f 6d22 5d2c 2063 6173 7428 4368 6563  rom"], cast(Chec
+000149a0: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
+000149b0: 5f70 6172 616d 735b 2266 726f 6d22 5d29  _params["from"])
+000149c0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000149d0: 2020 2061 7373 6572 7420 6973 5f73 616d     assert is_sam
+000149e0: 655f 6164 6472 6573 7328 0a20 2020 2020  e_address(.     
+000149f0: 2020 2020 2020 2072 6570 6c61 6365 5f74         replace_t
+00014a00: 786e 5b22 746f 225d 2c20 6361 7374 2843  xn["to"], cast(C
+00014a10: 6865 636b 7375 6d41 6464 7265 7373 2c20  hecksumAddress, 
+00014a20: 7478 6e5f 7061 7261 6d73 5b22 746f 225d  txn_params["to"]
+00014a30: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+00014a40: 2020 2020 6173 7365 7274 2072 6570 6c61      assert repla
+00014a50: 6365 5f74 786e 5b22 7661 6c75 6522 5d20  ce_txn["value"] 
+00014a60: 3d3d 2031 0a20 2020 2020 2020 2061 7373  == 1.        ass
+00014a70: 6572 7420 7265 706c 6163 655f 7478 6e5b  ert replace_txn[
+00014a80: 2267 6173 225d 203d 3d20 3231 3030 300a  "gas"] == 21000.
+00014a90: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00014aa0: 6570 6c61 6365 5f74 786e 5b22 6761 7350  eplace_txn["gasP
+00014ab0: 7269 6365 225d 203d 3d20 7478 6e5f 7061  rice"] == txn_pa
+00014ac0: 7261 6d73 5b22 6761 7350 7269 6365 225d  rams["gasPrice"]
+00014ad0: 0a0a 2020 2020 4066 6c61 6b79 5f67 6574  ..    @flaky_get
+00014ae0: 685f 6465 765f 6d69 6e69 6e67 0a20 2020  h_dev_mining.   
+00014af0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00014b00: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+00014b10: 6465 6620 7465 7374 5f61 7379 6e63 5f65  def test_async_e
+00014b20: 7468 5f72 6570 6c61 6365 5f74 7261 6e73  th_replace_trans
+00014b30: 6163 7469 6f6e 280a 2020 2020 2020 2020  action(.        
+00014b40: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+00014b50: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
+00014b60: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+00014b70: 756e 745f 6475 616c 5f74 7970 653a 2043  unt_dual_type: C
+00014b80: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
+00014b90: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00014ba0: 2020 2020 2020 7477 6f5f 6777 6569 5f69        two_gwei_i
+00014bb0: 6e5f 7765 6920 3d20 6173 796e 635f 7733  n_wei = async_w3
+00014bc0: 2e74 6f5f 7765 6928 322c 2022 6777 6569  .to_wei(2, "gwei
+00014bd0: 2229 0a20 2020 2020 2020 2074 6872 6565  ").        three
+00014be0: 5f67 7765 695f 696e 5f77 6569 203d 2061  _gwei_in_wei = a
+00014bf0: 7379 6e63 5f77 332e 746f 5f77 6569 2833  sync_w3.to_wei(3
+00014c00: 2c20 2267 7765 6922 290a 0a20 2020 2020  , "gwei")..     
+00014c10: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
+00014c20: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
+00014c30: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
+00014c40: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
+00014c50: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
+00014c60: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+00014c70: 6f22 3a20 6173 796e 635f 756e 6c6f 636b  o": async_unlock
+00014c80: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
+00014c90: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+00014ca0: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
+00014cb0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+00014cc0: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
+00014cd0: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
+00014ce0: 5065 7247 6173 223a 2074 776f 5f67 7765  PerGas": two_gwe
+00014cf0: 695f 696e 5f77 6569 2c0a 2020 2020 2020  i_in_wei,.      
+00014d00: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
+00014d10: 7479 4665 6550 6572 4761 7322 3a20 6173  tyFeePerGas": as
+00014d20: 796e 635f 7733 2e74 6f5f 7765 6928 312c  ync_w3.to_wei(1,
+00014d30: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
+00014d40: 2020 7d0a 2020 2020 2020 2020 7478 6e5f    }.        txn_
+00014d50: 6861 7368 203d 2061 7761 6974 2061 7379  hash = await asy
+00014d60: 6e63 5f77 332e 6574 682e 7365 6e64 5f74  nc_w3.eth.send_t
+00014d70: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+00014d80: 6172 616d 7329 0a0a 2020 2020 2020 2020  arams)..        
+00014d90: 7478 6e5f 7061 7261 6d73 5b22 6d61 7846  txn_params["maxF
+00014da0: 6565 5065 7247 6173 225d 203d 2074 6872  eePerGas"] = thr
+00014db0: 6565 5f67 7765 695f 696e 5f77 6569 0a20  ee_gwei_in_wei. 
+00014dc0: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+00014dd0: 735b 226d 6178 5072 696f 7269 7479 4665  s["maxPriorityFe
+00014de0: 6550 6572 4761 7322 5d20 3d20 7477 6f5f  ePerGas"] = two_
+00014df0: 6777 6569 5f69 6e5f 7765 690a 0a20 2020  gwei_in_wei..   
+00014e00: 2020 2020 2072 6570 6c61 6365 5f74 786e       replace_txn
+00014e10: 5f68 6173 6820 3d20 6177 6169 7420 6173  _hash = await as
+00014e20: 796e 635f 7733 2e65 7468 2e72 6570 6c61  ync_w3.eth.repla
+00014e30: 6365 5f74 7261 6e73 6163 7469 6f6e 2874  ce_transaction(t
+00014e40: 786e 5f68 6173 682c 2074 786e 5f70 6172  xn_hash, txn_par
+00014e50: 616d 7329 0a20 2020 2020 2020 2072 6570  ams).        rep
+00014e60: 6c61 6365 5f74 786e 203d 2061 7761 6974  lace_txn = await
+00014e70: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
+00014e80: 745f 7472 616e 7361 6374 696f 6e28 7265  t_transaction(re
+00014e90: 706c 6163 655f 7478 6e5f 6861 7368 290a  place_txn_hash).
+00014ea0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00014eb0: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
+00014ec0: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
+00014ed0: 6c61 6365 5f74 786e 5b22 6672 6f6d 225d  lace_txn["from"]
+00014ee0: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
+00014ef0: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
+00014f00: 6d73 5b22 6672 6f6d 225d 290a 2020 2020  ms["from"]).    
+00014f10: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+00014f20: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
+00014f30: 7265 7373 280a 2020 2020 2020 2020 2020  ress(.          
+00014f40: 2020 7265 706c 6163 655f 7478 6e5b 2274    replace_txn["t
+00014f50: 6f22 5d2c 2063 6173 7428 4368 6563 6b73  o"], cast(Checks
+00014f60: 756d 4164 6472 6573 732c 2074 786e 5f70  umAddress, txn_p
+00014f70: 6172 616d 735b 2274 6f22 5d29 0a20 2020  arams["to"]).   
+00014f80: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
+00014f90: 7373 6572 7420 7265 706c 6163 655f 7478  ssert replace_tx
+00014fa0: 6e5b 2276 616c 7565 225d 203d 3d20 310a  n["value"] == 1.
+00014fb0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00014fc0: 6570 6c61 6365 5f74 786e 5b22 6761 7322  eplace_txn["gas"
+00014fd0: 5d20 3d3d 2032 3130 3030 0a20 2020 2020  ] == 21000.     
+00014fe0: 2020 2061 7373 6572 7420 7265 706c 6163     assert replac
+00014ff0: 655f 7478 6e5b 226d 6178 4665 6550 6572  e_txn["maxFeePer
+00015000: 4761 7322 5d20 3d3d 2074 6872 6565 5f67  Gas"] == three_g
+00015010: 7765 695f 696e 5f77 6569 0a20 2020 2020  wei_in_wei.     
+00015020: 2020 2061 7373 6572 7420 7265 706c 6163     assert replac
+00015030: 655f 7478 6e5b 226d 6178 5072 696f 7269  e_txn["maxPriori
+00015040: 7479 4665 6550 6572 4761 7322 5d20 3d3d  tyFeePerGas"] ==
+00015050: 2074 776f 5f67 7765 695f 696e 5f77 6569   two_gwei_in_wei
+00015060: 0a0a 2020 2020 4066 6c61 6b79 5f67 6574  ..    @flaky_get
+00015070: 685f 6465 765f 6d69 6e69 6e67 0a20 2020  h_dev_mining.   
+00015080: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00015090: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+000150a0: 6465 6620 7465 7374 5f61 7379 6e63 5f65  def test_async_e
+000150b0: 7468 5f72 6570 6c61 6365 5f74 7261 6e73  th_replace_trans
+000150c0: 6163 7469 6f6e 5f75 6e64 6572 7072 6963  action_underpric
+000150d0: 6564 280a 2020 2020 2020 2020 7365 6c66  ed(.        self
+000150e0: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
+000150f0: 6e63 5765 6233 222c 2061 7379 6e63 5f75  ncWeb3", async_u
+00015100: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+00015110: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
+00015120: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
+00015130: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00015140: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
+00015150: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
+00015160: 2020 2020 2020 2022 6672 6f6d 223a 2061         "from": a
+00015170: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+00015180: 636f 756e 745f 6475 616c 5f74 7970 652c  count_dual_type,
+00015190: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
+000151a0: 223a 2061 7379 6e63 5f75 6e6c 6f63 6b65  ": async_unlocke
+000151b0: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
+000151c0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+000151d0: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
+000151e0: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
+000151f0: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
+00015200: 2020 2020 2020 2020 226d 6178 4665 6550          "maxFeeP
+00015210: 6572 4761 7322 3a20 6173 796e 635f 7733  erGas": async_w3
+00015220: 2e74 6f5f 7765 6928 332c 2022 6777 6569  .to_wei(3, "gwei
+00015230: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+00015240: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+00015250: 6572 4761 7322 3a20 6173 796e 635f 7733  erGas": async_w3
+00015260: 2e74 6f5f 7765 6928 322c 2022 6777 6569  .to_wei(2, "gwei
+00015270: 2229 2c0a 2020 2020 2020 2020 7d0a 2020  "),.        }.  
+00015280: 2020 2020 2020 7478 6e5f 6861 7368 203d        txn_hash =
+00015290: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+000152a0: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+000152b0: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+000152c0: 0a0a 2020 2020 2020 2020 6f6e 655f 6777  ..        one_gw
+000152d0: 6569 5f69 6e5f 7765 6920 3d20 6173 796e  ei_in_wei = asyn
+000152e0: 635f 7733 2e74 6f5f 7765 6928 312c 2022  c_w3.to_wei(1, "
+000152f0: 6777 6569 2229 0a20 2020 2020 2020 2074  gwei").        t
+00015300: 786e 5f70 6172 616d 735b 226d 6178 4665  xn_params["maxFe
+00015310: 6550 6572 4761 7322 5d20 3d20 6f6e 655f  ePerGas"] = one_
+00015320: 6777 6569 5f69 6e5f 7765 690a 2020 2020  gwei_in_wei.    
+00015330: 2020 2020 7478 6e5f 7061 7261 6d73 5b22      txn_params["
+00015340: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
+00015350: 7247 6173 225d 203d 206f 6e65 5f67 7765  rGas"] = one_gwe
+00015360: 695f 696e 5f77 6569 0a0a 2020 2020 2020  i_in_wei..      
+00015370: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+00015380: 6973 6573 2856 616c 7565 4572 726f 722c  ises(ValueError,
+00015390: 206d 6174 6368 3d22 7265 706c 6163 656d   match="replacem
+000153a0: 656e 7420 7472 616e 7361 6374 696f 6e20  ent transaction 
+000153b0: 756e 6465 7270 7269 6365 6422 293a 0a20  underpriced"):. 
+000153c0: 2020 2020 2020 2020 2020 2061 7761 6974             await
+000153d0: 2061 7379 6e63 5f77 332e 6574 682e 7265   async_w3.eth.re
+000153e0: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
+000153f0: 6e28 7478 6e5f 6861 7368 2c20 7478 6e5f  n(txn_hash, txn_
+00015400: 7061 7261 6d73 290a 0a20 2020 2040 666c  params)..    @fl
+00015410: 616b 795f 6765 7468 5f64 6576 5f6d 696e  aky_geth_dev_min
+00015420: 696e 670a 2020 2020 4070 7974 6573 742e  ing.    @pytest.
+00015430: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+00015440: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+00015450: 6173 796e 635f 6574 685f 7265 706c 6163  async_eth_replac
+00015460: 655f 7472 616e 7361 6374 696f 6e5f 6e6f  e_transaction_no
+00015470: 6e5f 6578 6973 7469 6e67 5f74 7261 6e73  n_existing_trans
+00015480: 6163 7469 6f6e 280a 2020 2020 2020 2020  action(.        
+00015490: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+000154a0: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
+000154b0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+000154c0: 756e 745f 6475 616c 5f74 7970 653a 2043  unt_dual_type: C
+000154d0: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
+000154e0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+000154f0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+00015500: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
+00015510: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+00015520: 223a 2061 7379 6e63 5f75 6e6c 6f63 6b65  ": async_unlocke
+00015530: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
+00015540: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00015550: 2022 746f 223a 2061 7379 6e63 5f75 6e6c   "to": async_unl
+00015560: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+00015570: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00015580: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+00015590: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+000155a0: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
+000155b0: 2020 2020 2020 2020 2020 2020 226d 6178              "max
+000155c0: 4665 6550 6572 4761 7322 3a20 6173 796e  FeePerGas": asyn
+000155d0: 635f 7733 2e74 6f5f 7765 6928 332c 2022  c_w3.to_wei(3, "
+000155e0: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
+000155f0: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
+00015600: 4665 6550 6572 4761 7322 3a20 6173 796e  FeePerGas": asyn
+00015610: 635f 7733 2e74 6f5f 7765 6928 312c 2022  c_w3.to_wei(1, "
+00015620: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
+00015630: 7d0a 2020 2020 2020 2020 7769 7468 2070  }.        with p
+00015640: 7974 6573 742e 7261 6973 6573 2854 7261  ytest.raises(Tra
+00015650: 6e73 6163 7469 6f6e 4e6f 7446 6f75 6e64  nsactionNotFound
+00015660: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+00015670: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+00015680: 682e 7265 706c 6163 655f 7472 616e 7361  h.replace_transa
+00015690: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+000156a0: 2020 2020 2020 2048 6578 5374 7228 0a20         HexStr(. 
+000156b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000156c0: 2020 2022 3078 3938 6538 6363 3039 6233     "0x98e8cc09b3
+000156d0: 3131 3538 3363 3530 3739 6661 3630 3066  11583c5079fa600f
+000156e0: 3663 3261 3362 6561 3836 3131 6166 3136  6c2a3bea8611af16
+000156f0: 3863 3532 6534 6236 3062 3562 3234 3361  8c52e4b60b5b243a
+00015700: 3434 3139 3937 220a 2020 2020 2020 2020  441997".        
+00015710: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+00015720: 2020 2020 2020 2020 2020 2074 786e 5f70             txn_p
+00015730: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
+00015740: 2020 2029 0a0a 2020 2020 4066 6c61 6b79     )..    @flaky
+00015750: 5f67 6574 685f 6465 765f 6d69 6e69 6e67  _geth_dev_mining
+00015760: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00015770: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+00015780: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
+00015790: 6e63 5f65 7468 5f72 6570 6c61 6365 5f74  nc_eth_replace_t
+000157a0: 7261 6e73 6163 7469 6f6e 5f61 6c72 6561  ransaction_alrea
+000157b0: 6479 5f6d 696e 6564 280a 2020 2020 2020  dy_mined(.      
+000157c0: 2020 7365 6c66 2c20 6173 796e 635f 7733    self, async_w3
+000157d0: 3a20 2241 7379 6e63 5765 6233 222c 2061  : "AsyncWeb3", a
+000157e0: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+000157f0: 636f 756e 745f 6475 616c 5f74 7970 653a  count_dual_type:
+00015800: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+00015810: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00015820: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+00015830: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+00015840: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+00015850: 6f6d 223a 2061 7379 6e63 5f75 6e6c 6f63  om": async_unloc
+00015860: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+00015870: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+00015880: 2020 2022 746f 223a 2061 7379 6e63 5f75     "to": async_u
+00015890: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+000158a0: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+000158b0: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
+000158c0: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
+000158d0: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
+000158e0: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+000158f0: 6178 4665 6550 6572 4761 7322 3a20 6173  axFeePerGas": as
+00015900: 796e 635f 7733 2e74 6f5f 7765 6928 322c  ync_w3.to_wei(2,
+00015910: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
+00015920: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
+00015930: 7479 4665 6550 6572 4761 7322 3a20 6173  tyFeePerGas": as
+00015940: 796e 635f 7733 2e74 6f5f 7765 6928 312c  ync_w3.to_wei(1,
+00015950: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
+00015960: 2020 7d0a 2020 2020 2020 2020 7478 6e5f    }.        txn_
+00015970: 6861 7368 203d 2061 7761 6974 2061 7379  hash = await asy
+00015980: 6e63 5f77 332e 6574 682e 7365 6e64 5f74  nc_w3.eth.send_t
+00015990: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+000159a0: 6172 616d 7329 0a20 2020 2020 2020 2061  arams).        a
+000159b0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+000159c0: 682e 7761 6974 5f66 6f72 5f74 7261 6e73  h.wait_for_trans
+000159d0: 6163 7469 6f6e 5f72 6563 6569 7074 2874  action_receipt(t
+000159e0: 786e 5f68 6173 682c 2074 696d 656f 7574  xn_hash, timeout
+000159f0: 3d31 3029 0a0a 2020 2020 2020 2020 7478  =10)..        tx
+00015a00: 6e5f 7061 7261 6d73 5b22 6d61 7846 6565  n_params["maxFee
+00015a10: 5065 7247 6173 225d 203d 2061 7379 6e63  PerGas"] = async
+00015a20: 5f77 332e 746f 5f77 6569 2833 2c20 2267  _w3.to_wei(3, "g
+00015a30: 7765 6922 290a 2020 2020 2020 2020 7478  wei").        tx
+00015a40: 6e5f 7061 7261 6d73 5b22 6d61 7850 7269  n_params["maxPri
+00015a50: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
+00015a60: 203d 2061 7379 6e63 5f77 332e 746f 5f77   = async_w3.to_w
+00015a70: 6569 2832 2c20 2267 7765 6922 290a 2020  ei(2, "gwei").  
+00015a80: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+00015a90: 742e 7261 6973 6573 2856 616c 7565 4572  t.raises(ValueEr
+00015aa0: 726f 722c 206d 6174 6368 3d22 5375 7070  ror, match="Supp
+00015ab0: 6c69 6564 2074 7261 6e73 6163 7469 6f6e  lied transaction
+00015ac0: 2077 6974 6820 6861 7368 2229 3a0a 2020   with hash"):.  
+00015ad0: 2020 2020 2020 2020 2020 6177 6169 7420            await 
+00015ae0: 6173 796e 635f 7733 2e65 7468 2e72 6570  async_w3.eth.rep
+00015af0: 6c61 6365 5f74 7261 6e73 6163 7469 6f6e  lace_transaction
+00015b00: 2874 786e 5f68 6173 682c 2074 786e 5f70  (txn_hash, txn_p
+00015b10: 6172 616d 7329 0a0a 2020 2020 4066 6c61  arams)..    @fla
+00015b20: 6b79 5f67 6574 685f 6465 765f 6d69 6e69  ky_geth_dev_mini
+00015b30: 6e67 0a20 2020 2040 7079 7465 7374 2e6d  ng.    @pytest.m
+00015b40: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
+00015b50: 6173 796e 6320 6465 6620 7465 7374 5f61  async def test_a
+00015b60: 7379 6e63 5f65 7468 5f72 6570 6c61 6365  sync_eth_replace
+00015b70: 5f74 7261 6e73 6163 7469 6f6e 5f69 6e63  _transaction_inc
+00015b80: 6f72 7265 6374 5f6e 6f6e 6365 280a 2020  orrect_nonce(.  
+00015b90: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
+00015ba0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+00015bb0: 222c 2061 7379 6e63 5f75 6e6c 6f63 6b65  ", async_unlocke
+00015bc0: 645f 6163 636f 756e 743a 2043 6865 636b  d_account: Check
+00015bd0: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
+00015be0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00015bf0: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
+00015c00: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
+00015c10: 2020 2020 2020 2022 6672 6f6d 223a 2061         "from": a
+00015c20: 7379 6e63 5f75 6e6c 6f63 6b65 645f 6163  sync_unlocked_ac
+00015c30: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
+00015c40: 2020 2022 746f 223a 2061 7379 6e63 5f75     "to": async_u
+00015c50: 6e6c 6f63 6b65 645f 6163 636f 756e 742c  nlocked_account,
+00015c60: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
+00015c70: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
+00015c80: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
+00015c90: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
+00015ca0: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
+00015cb0: 7322 3a20 6173 796e 635f 7733 2e74 6f5f  s": async_w3.to_
+00015cc0: 7765 6928 322c 2022 6777 6569 2229 2c0a  wei(2, "gwei"),.
+00015cd0: 2020 2020 2020 2020 2020 2020 226d 6178              "max
+00015ce0: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+00015cf0: 7322 3a20 6173 796e 635f 7733 2e74 6f5f  s": async_w3.to_
+00015d00: 7765 6928 312c 2022 6777 6569 2229 2c0a  wei(1, "gwei"),.
+00015d10: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00015d20: 2020 7478 6e5f 6861 7368 203d 2061 7761    txn_hash = awa
+00015d30: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00015d40: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+00015d50: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
+00015d60: 2020 2020 2074 786e 203d 2061 7761 6974       txn = await
+00015d70: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
+00015d80: 745f 7472 616e 7361 6374 696f 6e28 7478  t_transaction(tx
+00015d90: 6e5f 6861 7368 290a 0a20 2020 2020 2020  n_hash)..       
+00015da0: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
+00015db0: 4665 6550 6572 4761 7322 5d20 3d20 6173  FeePerGas"] = as
+00015dc0: 796e 635f 7733 2e74 6f5f 7765 6928 332c  ync_w3.to_wei(3,
+00015dd0: 2022 6777 6569 2229 0a20 2020 2020 2020   "gwei").       
+00015de0: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
+00015df0: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+00015e00: 7322 5d20 3d20 6173 796e 635f 7733 2e74  s"] = async_w3.t
+00015e10: 6f5f 7765 6928 322c 2022 6777 6569 2229  o_wei(2, "gwei")
+00015e20: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
+00015e30: 616d 735b 226e 6f6e 6365 225d 203d 204e  ams["nonce"] = N
+00015e40: 6f6e 6365 2874 786e 5b22 6e6f 6e63 6522  once(txn["nonce"
+00015e50: 5d20 2b20 3129 0a20 2020 2020 2020 2077  ] + 1).        w
+00015e60: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+00015e70: 7328 5661 6c75 6545 7272 6f72 293a 0a20  s(ValueError):. 
+00015e80: 2020 2020 2020 2020 2020 2061 7761 6974             await
+00015e90: 2061 7379 6e63 5f77 332e 6574 682e 7265   async_w3.eth.re
+00015ea0: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
+00015eb0: 6e28 7478 6e5f 6861 7368 2c20 7478 6e5f  n(txn_hash, txn_
+00015ec0: 7061 7261 6d73 290a 0a20 2020 2040 666c  params)..    @fl
+00015ed0: 616b 795f 6765 7468 5f64 6576 5f6d 696e  aky_geth_dev_min
+00015ee0: 696e 670a 2020 2020 4070 7974 6573 742e  ing.    @pytest.
+00015ef0: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+00015f00: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+00015f10: 6173 796e 635f 6574 685f 7265 706c 6163  async_eth_replac
+00015f20: 655f 7472 616e 7361 6374 696f 6e5f 6761  e_transaction_ga
+00015f30: 735f 7072 6963 655f 746f 6f5f 6c6f 7728  s_price_too_low(
+00015f40: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
+00015f50: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
+00015f60: 6562 3322 2c20 6173 796e 635f 756e 6c6f  eb3", async_unlo
+00015f70: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+00015f80: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
+00015f90: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
+00015fa0: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+00015fb0: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+00015fc0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+00015fd0: 2020 2020 2266 726f 6d22 3a20 6173 796e      "from": asyn
+00015fe0: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
+00015ff0: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
+00016000: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+00016010: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
+00016020: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
+00016030: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
+00016040: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
+00016050: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
+00016060: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
+00016070: 2020 2020 2022 6761 7350 7269 6365 223a       "gasPrice":
+00016080: 2061 7379 6e63 5f77 332e 746f 5f77 6569   async_w3.to_wei
+00016090: 2832 2c20 2267 7765 6922 292c 0a20 2020  (2, "gwei"),.   
+000160a0: 2020 2020 207d 0a20 2020 2020 2020 2074       }.        t
+000160b0: 786e 5f68 6173 6820 3d20 6177 6169 7420  xn_hash = await 
+000160c0: 6173 796e 635f 7733 2e65 7468 2e73 656e  async_w3.eth.sen
+000160d0: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
+000160e0: 6e5f 7061 7261 6d73 290a 0a20 2020 2020  n_params)..     
+000160f0: 2020 2074 786e 5f70 6172 616d 735b 2267     txn_params["g
+00016100: 6173 5072 6963 6522 5d20 3d20 6173 796e  asPrice"] = asyn
+00016110: 635f 7733 2e74 6f5f 7765 6928 312c 2022  c_w3.to_wei(1, "
+00016120: 6777 6569 2229 0a20 2020 2020 2020 2077  gwei").        w
+00016130: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+00016140: 7328 5661 6c75 6545 7272 6f72 293a 0a20  s(ValueError):. 
+00016150: 2020 2020 2020 2020 2020 2061 7761 6974             await
+00016160: 2061 7379 6e63 5f77 332e 6574 682e 7265   async_w3.eth.re
+00016170: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
+00016180: 6e28 7478 6e5f 6861 7368 2c20 7478 6e5f  n(txn_hash, txn_
+00016190: 7061 7261 6d73 290a 0a20 2020 2040 666c  params)..    @fl
+000161a0: 616b 795f 6765 7468 5f64 6576 5f6d 696e  aky_geth_dev_min
+000161b0: 696e 670a 2020 2020 4070 7974 6573 742e  ing.    @pytest.
+000161c0: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+000161d0: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+000161e0: 6173 796e 635f 6574 685f 7265 706c 6163  async_eth_replac
+000161f0: 655f 7472 616e 7361 6374 696f 6e5f 6761  e_transaction_ga
+00016200: 735f 7072 6963 655f 6465 6661 756c 7469  s_price_defaulti
+00016210: 6e67 5f6d 696e 696d 756d 280a 2020 2020  ng_minimum(.    
+00016220: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
+00016230: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+00016240: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+00016250: 6163 636f 756e 743a 2043 6865 636b 7375  account: Checksu
+00016260: 6d41 6464 7265 7373 0a20 2020 2029 202d  mAddress.    ) -
+00016270: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00016280: 6761 735f 7072 6963 6520 3d20 6173 796e  gas_price = asyn
+00016290: 635f 7733 2e74 6f5f 7765 6928 312c 2022  c_w3.to_wei(1, "
+000162a0: 6777 6569 2229 0a0a 2020 2020 2020 2020  gwei")..        
+000162b0: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
+000162c0: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+000162d0: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
+000162e0: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+000162f0: 756e 742c 0a20 2020 2020 2020 2020 2020  unt,.           
+00016300: 2022 746f 223a 2061 7379 6e63 5f75 6e6c   "to": async_unl
+00016310: 6f63 6b65 645f 6163 636f 756e 742c 0a20  ocked_account,. 
+00016320: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+00016330: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+00016340: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
+00016350: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
+00016360: 2020 2267 6173 5072 6963 6522 3a20 6761    "gasPrice": ga
+00016370: 735f 7072 6963 652c 0a20 2020 2020 2020  s_price,.       
+00016380: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
+00016390: 6173 6820 3d20 6177 6169 7420 6173 796e  ash = await asyn
+000163a0: 635f 7733 2e65 7468 2e73 656e 645f 7472  c_w3.eth.send_tr
+000163b0: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
+000163c0: 7261 6d73 290a 0a20 2020 2020 2020 2074  rams)..        t
+000163d0: 786e 5f70 6172 616d 732e 706f 7028 2267  xn_params.pop("g
+000163e0: 6173 5072 6963 6522 290a 2020 2020 2020  asPrice").      
+000163f0: 2020 7265 706c 6163 655f 7478 6e5f 6861    replace_txn_ha
+00016400: 7368 203d 2061 7761 6974 2061 7379 6e63  sh = await async
+00016410: 5f77 332e 6574 682e 7265 706c 6163 655f  _w3.eth.replace_
+00016420: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
+00016430: 6861 7368 2c20 7478 6e5f 7061 7261 6d73  hash, txn_params
+00016440: 290a 2020 2020 2020 2020 7265 706c 6163  ).        replac
+00016450: 655f 7478 6e20 3d20 6177 6169 7420 6173  e_txn = await as
+00016460: 796e 635f 7733 2e65 7468 2e67 6574 5f74  ync_w3.eth.get_t
+00016470: 7261 6e73 6163 7469 6f6e 2872 6570 6c61  ransaction(repla
+00016480: 6365 5f74 786e 5f68 6173 6829 0a0a 2020  ce_txn_hash)..  
+00016490: 2020 2020 2020 6173 7365 7274 2072 6570        assert rep
+000164a0: 6c61 6365 5f74 786e 5b22 6761 7350 7269  lace_txn["gasPri
+000164b0: 6365 225d 203d 3d20 6d61 7468 2e63 6569  ce"] == math.cei
+000164c0: 6c28 0a20 2020 2020 2020 2020 2020 2067  l(.            g
+000164d0: 6173 5f70 7269 6365 202a 2031 2e31 3235  as_price * 1.125
+000164e0: 0a20 2020 2020 2020 2029 2020 2320 6d69  .        )  # mi
+000164f0: 6e69 6d75 6d20 6761 7320 7072 6963 650a  nimum gas price.
+00016500: 0a20 2020 2040 666c 616b 795f 6765 7468  .    @flaky_geth
+00016510: 5f64 6576 5f6d 696e 696e 670a 2020 2020  _dev_mining.    
+00016520: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+00016530: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+00016540: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
+00016550: 685f 7265 706c 6163 655f 7472 616e 7361  h_replace_transa
+00016560: 6374 696f 6e5f 6761 735f 7072 6963 655f  ction_gas_price_
+00016570: 6465 6661 756c 7469 6e67 5f73 7472 6174  defaulting_strat
+00016580: 6567 795f 6869 6768 6572 280a 2020 2020  egy_higher(.    
+00016590: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
+000165a0: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+000165b0: 2061 7379 6e63 5f75 6e6c 6f63 6b65 645f   async_unlocked_
+000165c0: 6163 636f 756e 743a 2043 6865 636b 7375  account: Checksu
+000165d0: 6d41 6464 7265 7373 0a20 2020 2029 202d  mAddress.    ) -
+000165e0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+000165f0: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
+00016600: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+00016610: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
+00016620: 6e63 5f75 6e6c 6f63 6b65 645f 6163 636f  nc_unlocked_acco
+00016630: 756e 742c 0a20 2020 2020 2020 2020 2020  unt,.           
+00016640: 2022 746f 223a 2061 7379 6e63 5f75 6e6c   "to": async_unl
+00016650: 6f63 6b65 645f 6163 636f 756e 742c 0a20  ocked_account,. 
+00016660: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+00016670: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+00016680: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
+00016690: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
+000166a0: 2020 2267 6173 5072 6963 6522 3a20 6173    "gasPrice": as
+000166b0: 796e 635f 7733 2e74 6f5f 7765 6928 312c  ync_w3.to_wei(1,
+000166c0: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
+000166d0: 2020 7d0a 2020 2020 2020 2020 7478 6e5f    }.        txn_
+000166e0: 6861 7368 203d 2061 7761 6974 2061 7379  hash = await asy
+000166f0: 6e63 5f77 332e 6574 682e 7365 6e64 5f74  nc_w3.eth.send_t
+00016700: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+00016710: 6172 616d 7329 0a0a 2020 2020 2020 2020  arams)..        
+00016720: 7477 6f5f 6777 6569 5f69 6e5f 7765 6920  two_gwei_in_wei 
+00016730: 3d20 6173 796e 635f 7733 2e74 6f5f 7765  = async_w3.to_we
+00016740: 6928 322c 2022 6777 6569 2229 0a0a 2020  i(2, "gwei")..  
+00016750: 2020 2020 2020 6465 6620 6869 6768 6572        def higher
+00016760: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
+00016770: 6567 7928 6173 796e 635f 7733 3a20 2241  egy(async_w3: "A
+00016780: 7379 6e63 5765 6233 222c 2074 786e 3a20  syncWeb3", txn: 
+00016790: 5478 5061 7261 6d73 2920 2d3e 2057 6569  TxParams) -> Wei
+000167a0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000167b0: 7475 726e 2074 776f 5f67 7765 695f 696e  turn two_gwei_in
+000167c0: 5f77 6569 0a0a 2020 2020 2020 2020 6173  _wei..        as
+000167d0: 796e 635f 7733 2e65 7468 2e73 6574 5f67  ync_w3.eth.set_g
+000167e0: 6173 5f70 7269 6365 5f73 7472 6174 6567  as_price_strateg
+000167f0: 7928 6869 6768 6572 5f67 6173 5f70 7269  y(higher_gas_pri
+00016800: 6365 5f73 7472 6174 6567 7929 0a0a 2020  ce_strategy)..  
+00016810: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+00016820: 2e70 6f70 2822 6761 7350 7269 6365 2229  .pop("gasPrice")
+00016830: 0a20 2020 2020 2020 2072 6570 6c61 6365  .        replace
+00016840: 5f74 786e 5f68 6173 6820 3d20 6177 6169  _txn_hash = awai
+00016850: 7420 6173 796e 635f 7733 2e65 7468 2e72  t async_w3.eth.r
+00016860: 6570 6c61 6365 5f74 7261 6e73 6163 7469  eplace_transacti
+00016870: 6f6e 2874 786e 5f68 6173 682c 2074 786e  on(txn_hash, txn
+00016880: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
+00016890: 2072 6570 6c61 6365 5f74 786e 203d 2061   replace_txn = a
+000168a0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+000168b0: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
+000168c0: 6e28 7265 706c 6163 655f 7478 6e5f 6861  n(replace_txn_ha
+000168d0: 7368 290a 2020 2020 2020 2020 6173 7365  sh).        asse
+000168e0: 7274 2028 0a20 2020 2020 2020 2020 2020  rt (.           
+000168f0: 2072 6570 6c61 6365 5f74 786e 5b22 6761   replace_txn["ga
+00016900: 7350 7269 6365 225d 203d 3d20 7477 6f5f  sPrice"] == two_
+00016910: 6777 6569 5f69 6e5f 7765 690a 2020 2020  gwei_in_wei.    
+00016920: 2020 2020 2920 2023 2053 7472 6174 6567      )  # Strateg
+00016930: 7920 7072 6f76 6964 6573 2068 6967 6865  y provides highe
+00016940: 7220 6761 7320 7072 6963 650a 2020 2020  r gas price.    
+00016950: 2020 2020 6173 796e 635f 7733 2e65 7468      async_w3.eth
+00016960: 2e73 6574 5f67 6173 5f70 7269 6365 5f73  .set_gas_price_s
+00016970: 7472 6174 6567 7928 4e6f 6e65 2920 2023  trategy(None)  #
+00016980: 2072 6573 6574 2073 7472 6174 6567 790a   reset strategy.
+00016990: 0a20 2020 2040 666c 616b 795f 6765 7468  .    @flaky_geth
+000169a0: 5f64 6576 5f6d 696e 696e 670a 2020 2020  _dev_mining.    
+000169b0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+000169c0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+000169d0: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
+000169e0: 685f 7265 706c 6163 655f 7472 616e 7361  h_replace_transa
+000169f0: 6374 696f 6e5f 6761 735f 7072 6963 655f  ction_gas_price_
+00016a00: 6465 6661 756c 7469 6e67 5f73 7472 6174  defaulting_strat
+00016a10: 6567 795f 6c6f 7765 7228 0a20 2020 2020  egy_lower(.     
+00016a20: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
+00016a30: 333a 2022 4173 796e 6357 6562 3322 2c20  3: "AsyncWeb3", 
+00016a40: 6173 796e 635f 756e 6c6f 636b 6564 5f61  async_unlocked_a
+00016a50: 6363 6f75 6e74 3a20 4368 6563 6b73 756d  ccount: Checksum
+00016a60: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
+00016a70: 204e 6f6e 653a 0a20 2020 2020 2020 2067   None:.        g
+00016a80: 6173 5f70 7269 6365 203d 2061 7379 6e63  as_price = async
+00016a90: 5f77 332e 746f 5f77 6569 2832 2c20 2267  _w3.to_wei(2, "g
+00016aa0: 7765 6922 290a 0a20 2020 2020 2020 2074  wei")..        t
+00016ab0: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+00016ac0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+00016ad0: 2020 2020 2266 726f 6d22 3a20 6173 796e      "from": asyn
+00016ae0: 635f 756e 6c6f 636b 6564 5f61 6363 6f75  c_unlocked_accou
+00016af0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+00016b00: 2274 6f22 3a20 6173 796e 635f 756e 6c6f  "to": async_unlo
+00016b10: 636b 6564 5f61 6363 6f75 6e74 2c0a 2020  cked_account,.  
+00016b20: 2020 2020 2020 2020 2020 2276 616c 7565            "value
+00016b30: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
+00016b40: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
+00016b50: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
+00016b60: 2022 6761 7350 7269 6365 223a 2067 6173   "gasPrice": gas
+00016b70: 5f70 7269 6365 2c0a 2020 2020 2020 2020  _price,.        
+00016b80: 7d0a 2020 2020 2020 2020 7478 6e5f 6861  }.        txn_ha
+00016b90: 7368 203d 2061 7761 6974 2061 7379 6e63  sh = await async
+00016ba0: 5f77 332e 6574 682e 7365 6e64 5f74 7261  _w3.eth.send_tra
+00016bb0: 6e73 6163 7469 6f6e 2874 786e 5f70 6172  nsaction(txn_par
+00016bc0: 616d 7329 0a0a 2020 2020 2020 2020 6465  ams)..        de
+00016bd0: 6620 6c6f 7765 725f 6761 735f 7072 6963  f lower_gas_pric
+00016be0: 655f 7374 7261 7465 6779 2861 7379 6e63  e_strategy(async
+00016bf0: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
+00016c00: 2c20 7478 6e3a 2054 7850 6172 616d 7329  , txn: TxParams)
+00016c10: 202d 3e20 5765 693a 0a20 2020 2020 2020   -> Wei:.       
+00016c20: 2020 2020 2072 6574 7572 6e20 6173 796e       return asyn
+00016c30: 635f 7733 2e74 6f5f 7765 6928 312c 2022  c_w3.to_wei(1, "
+00016c40: 6777 6569 2229 0a0a 2020 2020 2020 2020  gwei")..        
+00016c50: 6173 796e 635f 7733 2e65 7468 2e73 6574  async_w3.eth.set
+00016c60: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
+00016c70: 6567 7928 6c6f 7765 725f 6761 735f 7072  egy(lower_gas_pr
+00016c80: 6963 655f 7374 7261 7465 6779 290a 0a20  ice_strategy).. 
+00016c90: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+00016ca0: 732e 706f 7028 2267 6173 5072 6963 6522  s.pop("gasPrice"
+00016cb0: 290a 2020 2020 2020 2020 7265 706c 6163  ).        replac
+00016cc0: 655f 7478 6e5f 6861 7368 203d 2061 7761  e_txn_hash = awa
+00016cd0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00016ce0: 7265 706c 6163 655f 7472 616e 7361 6374  replace_transact
+00016cf0: 696f 6e28 7478 6e5f 6861 7368 2c20 7478  ion(txn_hash, tx
+00016d00: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
+00016d10: 2020 7265 706c 6163 655f 7478 6e20 3d20    replace_txn = 
+00016d20: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00016d30: 7468 2e67 6574 5f74 7261 6e73 6163 7469  th.get_transacti
+00016d40: 6f6e 2872 6570 6c61 6365 5f74 786e 5f68  on(replace_txn_h
+00016d50: 6173 6829 0a20 2020 2020 2020 2023 2053  ash).        # S
+00016d60: 7472 6174 6567 7920 7072 6f76 6964 6573  trategy provides
+00016d70: 206c 6f77 6572 2067 6173 2070 7269 6365   lower gas price
+00016d80: 202d 206d 696e 696d 756d 2070 7265 6665   - minimum prefe
+00016d90: 7272 6564 0a20 2020 2020 2020 2061 7373  rred.        ass
+00016da0: 6572 7420 7265 706c 6163 655f 7478 6e5b  ert replace_txn[
+00016db0: 2267 6173 5072 6963 6522 5d20 3d3d 206d  "gasPrice"] == m
+00016dc0: 6174 682e 6365 696c 2867 6173 5f70 7269  ath.ceil(gas_pri
+00016dd0: 6365 202a 2031 2e31 3235 290a 2020 2020  ce * 1.125).    
+00016de0: 2020 2020 6173 796e 635f 7733 2e65 7468      async_w3.eth
+00016df0: 2e73 6574 5f67 6173 5f70 7269 6365 5f73  .set_gas_price_s
+00016e00: 7472 6174 6567 7928 4e6f 6e65 2920 2023  trategy(None)  #
+00016e10: 2072 6573 6574 2073 7472 6174 6567 790a   reset strategy.
+00016e20: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00016e30: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+00016e40: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
+00016e50: 6e63 5f65 7468 5f6e 6577 5f66 696c 7465  nc_eth_new_filte
+00016e60: 7228 7365 6c66 2c20 6173 796e 635f 7733  r(self, async_w3
+00016e70: 3a20 2241 7379 6e63 5765 6233 2229 202d  : "AsyncWeb3") -
+00016e80: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00016e90: 6669 6c74 6572 203d 2061 7761 6974 2061  filter = await a
+00016ea0: 7379 6e63 5f77 332e 6574 682e 6669 6c74  sync_w3.eth.filt
+00016eb0: 6572 287b 7d29 0a0a 2020 2020 2020 2020  er({})..        
+00016ec0: 6368 616e 6765 7320 3d20 6177 6169 7420  changes = await 
+00016ed0: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
+00016ee0: 5f66 696c 7465 725f 6368 616e 6765 7328  _filter_changes(
+00016ef0: 6669 6c74 6572 2e66 696c 7465 725f 6964  filter.filter_id
+00016f00: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00016f10: 2069 735f 6c69 7374 5f6c 696b 6528 6368   is_list_like(ch
+00016f20: 616e 6765 7329 0a20 2020 2020 2020 2061  anges).        a
+00016f30: 7373 6572 7420 6e6f 7420 6368 616e 6765  ssert not change
+00016f40: 730a 0a20 2020 2020 2020 206c 6f67 7320  s..        logs 
+00016f50: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00016f60: 2e65 7468 2e67 6574 5f66 696c 7465 725f  .eth.get_filter_
+00016f70: 6c6f 6773 2866 696c 7465 722e 6669 6c74  logs(filter.filt
+00016f80: 6572 5f69 6429 0a20 2020 2020 2020 2061  er_id).        a
+00016f90: 7373 6572 7420 6973 5f6c 6973 745f 6c69  ssert is_list_li
+00016fa0: 6b65 286c 6f67 7329 0a20 2020 2020 2020  ke(logs).       
+00016fb0: 2061 7373 6572 7420 6e6f 7420 6c6f 6773   assert not logs
+00016fc0: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
+00016fd0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00016fe0: 332e 6574 682e 756e 696e 7374 616c 6c5f  3.eth.uninstall_
+00016ff0: 6669 6c74 6572 2866 696c 7465 722e 6669  filter(filter.fi
+00017000: 6c74 6572 5f69 6429 0a20 2020 2020 2020  lter_id).       
+00017010: 2061 7373 6572 7420 7265 7375 6c74 2069   assert result i
+00017020: 7320 5472 7565 0a0a 2020 2020 4070 7974  s True..    @pyt
+00017030: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+00017040: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+00017050: 6573 745f 6173 796e 635f 6574 685f 6e65  est_async_eth_ne
+00017060: 775f 626c 6f63 6b5f 6669 6c74 6572 2873  w_block_filter(s
+00017070: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
+00017080: 4173 796e 6357 6562 3322 2920 2d3e 204e  AsyncWeb3") -> N
+00017090: 6f6e 653a 0a20 2020 2020 2020 2066 696c  one:.        fil
+000170a0: 7465 7220 3d20 6177 6169 7420 6173 796e  ter = await asyn
+000170b0: 635f 7733 2e65 7468 2e66 696c 7465 7228  c_w3.eth.filter(
+000170c0: 226c 6174 6573 7422 290a 2020 2020 2020  "latest").      
+000170d0: 2020 6173 7365 7274 2069 735f 7374 7269    assert is_stri
+000170e0: 6e67 2866 696c 7465 722e 6669 6c74 6572  ng(filter.filter
+000170f0: 5f69 6429 0a0a 2020 2020 2020 2020 6368  _id)..        ch
+00017100: 616e 6765 7320 3d20 6177 6169 7420 6173  anges = await as
+00017110: 796e 635f 7733 2e65 7468 2e67 6574 5f66  ync_w3.eth.get_f
+00017120: 696c 7465 725f 6368 616e 6765 7328 6669  ilter_changes(fi
+00017130: 6c74 6572 2e66 696c 7465 725f 6964 290a  lter.filter_id).
+00017140: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00017150: 735f 6c69 7374 5f6c 696b 6528 6368 616e  s_list_like(chan
+00017160: 6765 7329 0a0a 2020 2020 2020 2020 7265  ges)..        re
+00017170: 7375 6c74 203d 2061 7761 6974 2061 7379  sult = await asy
+00017180: 6e63 5f77 332e 6574 682e 756e 696e 7374  nc_w3.eth.uninst
+00017190: 616c 6c5f 6669 6c74 6572 2866 696c 7465  all_filter(filte
+000171a0: 722e 6669 6c74 6572 5f69 6429 0a20 2020  r.filter_id).   
+000171b0: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
+000171c0: 6c74 2069 7320 5472 7565 0a0a 2020 2020  lt is True..    
+000171d0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+000171e0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+000171f0: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
+00017200: 685f 6e65 775f 7065 6e64 696e 675f 7472  h_new_pending_tr
+00017210: 616e 7361 6374 696f 6e5f 6669 6c74 6572  ansaction_filter
+00017220: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00017230: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+00017240: 5765 6233 220a 2020 2020 2920 2d3e 204e  Web3".    ) -> N
+00017250: 6f6e 653a 0a20 2020 2020 2020 2066 696c  one:.        fil
+00017260: 7465 7220 3d20 6177 6169 7420 6173 796e  ter = await asyn
+00017270: 635f 7733 2e65 7468 2e66 696c 7465 7228  c_w3.eth.filter(
+00017280: 2270 656e 6469 6e67 2229 0a20 2020 2020  "pending").     
+00017290: 2020 2061 7373 6572 7420 6973 5f73 7472     assert is_str
+000172a0: 696e 6728 6669 6c74 6572 2e66 696c 7465  ing(filter.filte
+000172b0: 725f 6964 290a 0a20 2020 2020 2020 2063  r_id)..        c
+000172c0: 6861 6e67 6573 203d 2061 7761 6974 2061  hanges = await a
+000172d0: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+000172e0: 6669 6c74 6572 5f63 6861 6e67 6573 2866  filter_changes(f
+000172f0: 696c 7465 722e 6669 6c74 6572 5f69 6429  ilter.filter_id)
+00017300: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00017310: 6973 5f6c 6973 745f 6c69 6b65 2863 6861  is_list_like(cha
+00017320: 6e67 6573 290a 2020 2020 2020 2020 6173  nges).        as
+00017330: 7365 7274 206e 6f74 2063 6861 6e67 6573  sert not changes
+00017340: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
+00017350: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00017360: 332e 6574 682e 756e 696e 7374 616c 6c5f  3.eth.uninstall_
+00017370: 6669 6c74 6572 2866 696c 7465 722e 6669  filter(filter.fi
+00017380: 6c74 6572 5f69 6429 0a20 2020 2020 2020  lter_id).       
+00017390: 2061 7373 6572 7420 7265 7375 6c74 2069   assert result i
+000173a0: 7320 5472 7565 0a0a 2020 2020 4070 7974  s True..    @pyt
+000173b0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+000173c0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+000173d0: 6573 745f 6173 796e 635f 6574 685f 756e  est_async_eth_un
+000173e0: 696e 7374 616c 6c5f 6669 6c74 6572 2873  install_filter(s
+000173f0: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
+00017400: 4173 796e 6357 6562 3322 2920 2d3e 204e  AsyncWeb3") -> N
+00017410: 6f6e 653a 0a20 2020 2020 2020 2066 696c  one:.        fil
+00017420: 7465 7220 3d20 6177 6169 7420 6173 796e  ter = await asyn
+00017430: 635f 7733 2e65 7468 2e66 696c 7465 7228  c_w3.eth.filter(
+00017440: 7b7d 290a 2020 2020 2020 2020 6173 7365  {}).        asse
+00017450: 7274 2069 735f 7374 7269 6e67 2866 696c  rt is_string(fil
+00017460: 7465 722e 6669 6c74 6572 5f69 6429 0a0a  ter.filter_id)..
+00017470: 2020 2020 2020 2020 7375 6363 6573 7320          success 
+00017480: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00017490: 2e65 7468 2e75 6e69 6e73 7461 6c6c 5f66  .eth.uninstall_f
+000174a0: 696c 7465 7228 6669 6c74 6572 2e66 696c  ilter(filter.fil
+000174b0: 7465 725f 6964 290a 2020 2020 2020 2020  ter_id).        
+000174c0: 6173 7365 7274 2073 7563 6365 7373 2069  assert success i
+000174d0: 7320 5472 7565 0a0a 2020 2020 2020 2020  s True..        
+000174e0: 6661 696c 7572 6520 3d20 6177 6169 7420  failure = await 
+000174f0: 6173 796e 635f 7733 2e65 7468 2e75 6e69  async_w3.eth.uni
+00017500: 6e73 7461 6c6c 5f66 696c 7465 7228 6669  nstall_filter(fi
+00017510: 6c74 6572 2e66 696c 7465 725f 6964 290a  lter.filter_id).
+00017520: 2020 2020 2020 2020 6173 7365 7274 2066          assert f
+00017530: 6169 6c75 7265 2069 7320 4661 6c73 650a  ailure is False.
+00017540: 0a0a 636c 6173 7320 4574 684d 6f64 756c  ..class EthModul
+00017550: 6554 6573 743a 0a20 2020 2064 6566 2074  eTest:.    def t
+00017560: 6573 745f 6574 685f 7379 6e63 696e 6728  est_eth_syncing(
+00017570: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
+00017580: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00017590: 2020 2073 796e 6369 6e67 203d 2077 332e     syncing = w3.
+000175a0: 6574 682e 7379 6e63 696e 670a 0a20 2020  eth.syncing..   
+000175b0: 2020 2020 2061 7373 6572 7420 6973 5f62       assert is_b
+000175c0: 6f6f 6c65 616e 2873 796e 6369 6e67 2920  oolean(syncing) 
+000175d0: 6f72 2069 735f 6469 6374 2873 796e 6369  or is_dict(synci
+000175e0: 6e67 290a 0a20 2020 2020 2020 2069 6620  ng)..        if 
+000175f0: 6973 5f62 6f6f 6c65 616e 2873 796e 6369  is_boolean(synci
+00017600: 6e67 293a 0a20 2020 2020 2020 2020 2020  ng):.           
+00017610: 2061 7373 6572 7420 7379 6e63 696e 6720   assert syncing 
+00017620: 6973 2046 616c 7365 0a20 2020 2020 2020  is False.       
+00017630: 2065 6c69 6620 6973 5f64 6963 7428 7379   elif is_dict(sy
+00017640: 6e63 696e 6729 3a0a 2020 2020 2020 2020  ncing):.        
+00017650: 2020 2020 7379 6e63 5f64 6963 7420 3d20      sync_dict = 
+00017660: 6361 7374 2853 796e 6353 7461 7475 732c  cast(SyncStatus,
+00017670: 2073 796e 6369 6e67 290a 2020 2020 2020   syncing).      
+00017680: 2020 2020 2020 6173 7365 7274 2022 7374        assert "st
+00017690: 6172 7469 6e67 426c 6f63 6b22 2069 6e20  artingBlock" in 
+000176a0: 7379 6e63 5f64 6963 740a 2020 2020 2020  sync_dict.      
+000176b0: 2020 2020 2020 6173 7365 7274 2022 6375        assert "cu
+000176c0: 7272 656e 7442 6c6f 636b 2220 696e 2073  rrentBlock" in s
+000176d0: 796e 635f 6469 6374 0a20 2020 2020 2020  ync_dict.       
+000176e0: 2020 2020 2061 7373 6572 7420 2268 6967       assert "hig
+000176f0: 6865 7374 426c 6f63 6b22 2069 6e20 7379  hestBlock" in sy
+00017700: 6e63 5f64 6963 740a 0a20 2020 2020 2020  nc_dict..       
+00017710: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
+00017720: 6e74 6567 6572 2873 796e 635f 6469 6374  nteger(sync_dict
+00017730: 5b22 7374 6172 7469 6e67 426c 6f63 6b22  ["startingBlock"
+00017740: 5d29 0a20 2020 2020 2020 2020 2020 2061  ]).            a
+00017750: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
+00017760: 2873 796e 635f 6469 6374 5b22 6375 7272  (sync_dict["curr
+00017770: 656e 7442 6c6f 636b 225d 290a 2020 2020  entBlock"]).    
+00017780: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00017790: 735f 696e 7465 6765 7228 7379 6e63 5f64  s_integer(sync_d
+000177a0: 6963 745b 2268 6967 6865 7374 426c 6f63  ict["highestBloc
+000177b0: 6b22 5d29 0a0a 2020 2020 6465 6620 7465  k"])..    def te
+000177c0: 7374 5f65 7468 5f63 6f69 6e62 6173 6528  st_eth_coinbase(
+000177d0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
+000177e0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+000177f0: 2020 2063 6f69 6e62 6173 6520 3d20 7733     coinbase = w3
+00017800: 2e65 7468 2e63 6f69 6e62 6173 650a 2020  .eth.coinbase.  
+00017810: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+00017820: 6368 6563 6b73 756d 5f61 6464 7265 7373  checksum_address
+00017830: 2863 6f69 6e62 6173 6529 0a0a 2020 2020  (coinbase)..    
+00017840: 6465 6620 7465 7374 5f65 7468 5f6d 696e  def test_eth_min
+00017850: 696e 6728 7365 6c66 2c20 7733 3a20 2257  ing(self, w3: "W
+00017860: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
+00017870: 2020 2020 2020 206d 696e 696e 6720 3d20         mining = 
+00017880: 7733 2e65 7468 2e6d 696e 696e 670a 2020  w3.eth.mining.  
+00017890: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+000178a0: 626f 6f6c 6561 6e28 6d69 6e69 6e67 290a  boolean(mining).
+000178b0: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+000178c0: 685f 6861 7368 7261 7465 2873 656c 662c  h_hashrate(self,
+000178d0: 2077 333a 2022 5765 6233 2229 202d 3e20   w3: "Web3") -> 
+000178e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 6861  None:.        ha
+000178f0: 7368 7261 7465 203d 2077 332e 6574 682e  shrate = w3.eth.
+00017900: 6861 7368 7261 7465 0a20 2020 2020 2020  hashrate.       
+00017910: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
+00017920: 6572 2868 6173 6872 6174 6529 0a20 2020  er(hashrate).   
+00017930: 2020 2020 2061 7373 6572 7420 6861 7368       assert hash
+00017940: 7261 7465 203e 3d20 300a 0a20 2020 2064  rate >= 0..    d
+00017950: 6566 2074 6573 745f 6574 685f 6368 6169  ef test_eth_chai
+00017960: 6e5f 6964 2873 656c 662c 2077 333a 2022  n_id(self, w3: "
+00017970: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
+00017980: 2020 2020 2020 2020 6368 6169 6e5f 6964          chain_id
+00017990: 203d 2077 332e 6574 682e 6368 6169 6e5f   = w3.eth.chain_
+000179a0: 6964 0a20 2020 2020 2020 2023 2063 6861  id.        # cha
+000179b0: 696e 2069 6420 7661 6c75 6520 6672 6f6d  in id value from
+000179c0: 2067 6574 6820 6669 7874 7572 6520 6765   geth fixture ge
+000179d0: 6e65 7369 7320 6669 6c65 0a20 2020 2020  nesis file.     
+000179e0: 2020 2061 7373 6572 7420 6368 6169 6e5f     assert chain_
+000179f0: 6964 203d 3d20 3133 3132 3737 3332 3239  id == 1312773229
+00017a00: 3430 3533 370a 0a20 2020 2064 6566 2074  40537..    def t
+00017a10: 6573 745f 6574 685f 6665 655f 6869 7374  est_eth_fee_hist
+00017a20: 6f72 7928 7365 6c66 2c20 7733 3a20 2257  ory(self, w3: "W
+00017a30: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
+00017a40: 2020 2020 2020 2066 6565 5f68 6973 746f         fee_histo
+00017a50: 7279 203d 2077 332e 6574 682e 6665 655f  ry = w3.eth.fee_
+00017a60: 6869 7374 6f72 7928 312c 2022 6c61 7465  history(1, "late
+00017a70: 7374 222c 205b 3530 5d29 0a20 2020 2020  st", [50]).     
+00017a80: 2020 2061 7373 6572 7420 6973 5f6c 6973     assert is_lis
+00017a90: 745f 6c69 6b65 2866 6565 5f68 6973 746f  t_like(fee_histo
+00017aa0: 7279 5b22 6261 7365 4665 6550 6572 4761  ry["baseFeePerGa
+00017ab0: 7322 5d29 0a20 2020 2020 2020 2061 7373  s"]).        ass
+00017ac0: 6572 7420 6973 5f6c 6973 745f 6c69 6b65  ert is_list_like
+00017ad0: 2866 6565 5f68 6973 746f 7279 5b22 6761  (fee_history["ga
+00017ae0: 7355 7365 6452 6174 696f 225d 290a 2020  sUsedRatio"]).  
+00017af0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+00017b00: 696e 7465 6765 7228 6665 655f 6869 7374  integer(fee_hist
+00017b10: 6f72 795b 226f 6c64 6573 7442 6c6f 636b  ory["oldestBlock
+00017b20: 225d 290a 2020 2020 2020 2020 6173 7365  "]).        asse
+00017b30: 7274 2066 6565 5f68 6973 746f 7279 5b22  rt fee_history["
+00017b40: 6f6c 6465 7374 426c 6f63 6b22 5d20 3e3d  oldestBlock"] >=
+00017b50: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
+00017b60: 7420 6973 5f6c 6973 745f 6c69 6b65 2866  t is_list_like(f
+00017b70: 6565 5f68 6973 746f 7279 5b22 7265 7761  ee_history["rewa
+00017b80: 7264 225d 290a 2020 2020 2020 2020 6966  rd"]).        if
+00017b90: 206c 656e 2866 6565 5f68 6973 746f 7279   len(fee_history
+00017ba0: 5b22 7265 7761 7264 225d 2920 3e20 303a  ["reward"]) > 0:
+00017bb0: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+00017bc0: 6572 7420 6973 5f6c 6973 745f 6c69 6b65  ert is_list_like
+00017bd0: 2866 6565 5f68 6973 746f 7279 5b22 7265  (fee_history["re
+00017be0: 7761 7264 225d 5b30 5d29 0a0a 2020 2020  ward"][0])..    
+00017bf0: 6465 6620 7465 7374 5f65 7468 5f66 6565  def test_eth_fee
+00017c00: 5f68 6973 746f 7279 5f77 6974 685f 696e  _history_with_in
+00017c10: 7465 6765 7228 0a20 2020 2020 2020 2073  teger(.        s
+00017c20: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
+00017c30: 2065 6d70 7479 5f62 6c6f 636b 3a20 426c   empty_block: Bl
+00017c40: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+00017c50: 204e 6f6e 653a 0a20 2020 2020 2020 2066   None:.        f
+00017c60: 6565 5f68 6973 746f 7279 203d 2077 332e  ee_history = w3.
+00017c70: 6574 682e 6665 655f 6869 7374 6f72 7928  eth.fee_history(
+00017c80: 312c 2065 6d70 7479 5f62 6c6f 636b 5b22  1, empty_block["
+00017c90: 6e75 6d62 6572 225d 2c20 5b35 305d 290a  number"], [50]).
+00017ca0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00017cb0: 735f 6c69 7374 5f6c 696b 6528 6665 655f  s_list_like(fee_
+00017cc0: 6869 7374 6f72 795b 2262 6173 6546 6565  history["baseFee
+00017cd0: 5065 7247 6173 225d 290a 2020 2020 2020  PerGas"]).      
+00017ce0: 2020 6173 7365 7274 2069 735f 6c69 7374    assert is_list
+00017cf0: 5f6c 696b 6528 6665 655f 6869 7374 6f72  _like(fee_histor
+00017d00: 795b 2267 6173 5573 6564 5261 7469 6f22  y["gasUsedRatio"
+00017d10: 5d29 0a20 2020 2020 2020 2061 7373 6572  ]).        asser
+00017d20: 7420 6973 5f69 6e74 6567 6572 2866 6565  t is_integer(fee
+00017d30: 5f68 6973 746f 7279 5b22 6f6c 6465 7374  _history["oldest
+00017d40: 426c 6f63 6b22 5d29 0a20 2020 2020 2020  Block"]).       
+00017d50: 2061 7373 6572 7420 6665 655f 6869 7374   assert fee_hist
+00017d60: 6f72 795b 226f 6c64 6573 7442 6c6f 636b  ory["oldestBlock
+00017d70: 225d 203e 3d20 300a 2020 2020 2020 2020  "] >= 0.        
+00017d80: 6173 7365 7274 2069 735f 6c69 7374 5f6c  assert is_list_l
+00017d90: 696b 6528 6665 655f 6869 7374 6f72 795b  ike(fee_history[
+00017da0: 2272 6577 6172 6422 5d29 0a20 2020 2020  "reward"]).     
+00017db0: 2020 2069 6620 6c65 6e28 6665 655f 6869     if len(fee_hi
+00017dc0: 7374 6f72 795b 2272 6577 6172 6422 5d29  story["reward"])
+00017dd0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+00017de0: 2020 6173 7365 7274 2069 735f 6c69 7374    assert is_list
+00017df0: 5f6c 696b 6528 6665 655f 6869 7374 6f72  _like(fee_histor
+00017e00: 795b 2272 6577 6172 6422 5d5b 305d 290a  y["reward"][0]).
+00017e10: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+00017e20: 685f 6665 655f 6869 7374 6f72 795f 6e6f  h_fee_history_no
+00017e30: 5f72 6577 6172 645f 7065 7263 656e 7469  _reward_percenti
+00017e40: 6c65 7328 7365 6c66 2c20 7733 3a20 2257  les(self, w3: "W
+00017e50: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
+00017e60: 2020 2020 2020 2066 6565 5f68 6973 746f         fee_histo
+00017e70: 7279 203d 2077 332e 6574 682e 6665 655f  ry = w3.eth.fee_
+00017e80: 6869 7374 6f72 7928 312c 2022 6c61 7465  history(1, "late
+00017e90: 7374 2229 0a20 2020 2020 2020 2061 7373  st").        ass
+00017ea0: 6572 7420 6973 5f6c 6973 745f 6c69 6b65  ert is_list_like
+00017eb0: 2866 6565 5f68 6973 746f 7279 5b22 6261  (fee_history["ba
+00017ec0: 7365 4665 6550 6572 4761 7322 5d29 0a20  seFeePerGas"]). 
+00017ed0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00017ee0: 5f6c 6973 745f 6c69 6b65 2866 6565 5f68  _list_like(fee_h
+00017ef0: 6973 746f 7279 5b22 6761 7355 7365 6452  istory["gasUsedR
+00017f00: 6174 696f 225d 290a 2020 2020 2020 2020  atio"]).        
+00017f10: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
+00017f20: 7228 6665 655f 6869 7374 6f72 795b 226f  r(fee_history["o
+00017f30: 6c64 6573 7442 6c6f 636b 225d 290a 2020  ldestBlock"]).  
+00017f40: 2020 2020 2020 6173 7365 7274 2066 6565        assert fee
+00017f50: 5f68 6973 746f 7279 5b22 6f6c 6465 7374  _history["oldest
+00017f60: 426c 6f63 6b22 5d20 3e3d 2030 0a0a 2020  Block"] >= 0..  
+00017f70: 2020 6465 6620 7465 7374 5f65 7468 5f67    def test_eth_g
+00017f80: 6173 5f70 7269 6365 2873 656c 662c 2077  as_price(self, w
+00017f90: 333a 2022 5765 6233 2229 202d 3e20 4e6f  3: "Web3") -> No
+00017fa0: 6e65 3a0a 2020 2020 2020 2020 6761 735f  ne:.        gas_
+00017fb0: 7072 6963 6520 3d20 7733 2e65 7468 2e67  price = w3.eth.g
+00017fc0: 6173 5f70 7269 6365 0a20 2020 2020 2020  as_price.       
+00017fd0: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
+00017fe0: 6572 2867 6173 5f70 7269 6365 290a 2020  er(gas_price).  
+00017ff0: 2020 2020 2020 6173 7365 7274 2067 6173        assert gas
+00018000: 5f70 7269 6365 203e 2030 0a0a 2020 2020  _price > 0..    
+00018010: 6465 6620 7465 7374 5f65 7468 5f6d 6178  def test_eth_max
+00018020: 5f70 7269 6f72 6974 795f 6665 6528 7365  _priority_fee(se
+00018030: 6c66 2c20 7733 3a20 2257 6562 3322 2920  lf, w3: "Web3") 
+00018040: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00018050: 206d 6178 5f70 7269 6f72 6974 795f 6665   max_priority_fe
+00018060: 6520 3d20 7733 2e65 7468 2e6d 6178 5f70  e = w3.eth.max_p
+00018070: 7269 6f72 6974 795f 6665 650a 2020 2020  riority_fee.    
+00018080: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
+00018090: 7465 6765 7228 6d61 785f 7072 696f 7269  teger(max_priori
+000180a0: 7479 5f66 6565 290a 0a20 2020 2064 6566  ty_fee)..    def
+000180b0: 2074 6573 745f 6574 685f 6d61 785f 7072   test_eth_max_pr
+000180c0: 696f 7269 7479 5f66 6565 5f77 6974 685f  iority_fee_with_
+000180d0: 6665 655f 6869 7374 6f72 795f 6361 6c63  fee_history_calc
+000180e0: 756c 6174 696f 6e28 0a20 2020 2020 2020  ulation(.       
+000180f0: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
+00018100: 222c 2072 6571 7565 7374 5f6d 6f63 6b65  ", request_mocke
+00018110: 723a 2054 7970 655b 5265 7175 6573 744d  r: Type[RequestM
+00018120: 6f63 6b65 725d 0a20 2020 2029 202d 3e20  ocker].    ) -> 
+00018130: 4e6f 6e65 3a0a 2020 2020 2020 2020 7769  None:.        wi
+00018140: 7468 2072 6571 7565 7374 5f6d 6f63 6b65  th request_mocke
+00018150: 7228 0a20 2020 2020 2020 2020 2020 2077  r(.            w
+00018160: 332c 0a20 2020 2020 2020 2020 2020 206d  3,.            m
+00018170: 6f63 6b5f 6572 726f 7273 3d7b 5250 4345  ock_errors={RPCE
+00018180: 6e64 706f 696e 7428 2265 7468 5f6d 6178  ndpoint("eth_max
+00018190: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+000181a0: 7322 293a 207b 7d7d 2c0a 2020 2020 2020  s"): {}},.      
+000181b0: 2020 2020 2020 6d6f 636b 5f72 6573 756c        mock_resul
+000181c0: 7473 3d7b 5250 4345 6e64 706f 696e 7428  ts={RPCEndpoint(
+000181d0: 2265 7468 5f66 6565 4869 7374 6f72 7922  "eth_feeHistory"
+000181e0: 293a 207b 2272 6577 6172 6422 3a20 5b5b  ): {"reward": [[
+000181f0: 305d 5d7d 7d2c 0a20 2020 2020 2020 2029  0]]}},.        )
+00018200: 3a0a 2020 2020 2020 2020 2020 2020 7769  :.            wi
+00018210: 7468 2070 7974 6573 742e 7761 726e 7328  th pytest.warns(
+00018220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018230: 2055 7365 7257 6172 6e69 6e67 2c0a 2020   UserWarning,.  
+00018240: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+00018250: 7463 683d 280a 2020 2020 2020 2020 2020  tch=(.          
+00018260: 2020 2020 2020 2020 2020 2254 6865 7265            "There
+00018270: 2077 6173 2061 6e20 6973 7375 6520 7769   was an issue wi
+00018280: 7468 2074 6865 206d 6574 686f 6420 6574  th the method et
+00018290: 685f 6d61 7850 7269 6f72 6974 7946 6565  h_maxPriorityFee
+000182a0: 5065 7247 6173 2e20 220a 2020 2020 2020  PerGas. ".      
+000182b0: 2020 2020 2020 2020 2020 2020 2020 2243                "C
+000182c0: 616c 6375 6c61 7469 6e67 2075 7369 6e67  alculating using
+000182d0: 2065 7468 5f66 6565 4869 7374 6f72 792e   eth_feeHistory.
+000182e0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000182f0: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+00018300: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+00018310: 2020 2020 6d61 785f 7072 696f 7269 7479      max_priority
+00018320: 5f66 6565 203d 2077 332e 6574 682e 6d61  _fee = w3.eth.ma
+00018330: 785f 7072 696f 7269 7479 5f66 6565 0a20  x_priority_fee. 
+00018340: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00018350: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
+00018360: 286d 6178 5f70 7269 6f72 6974 795f 6665  (max_priority_fe
+00018370: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+00018380: 2020 2061 7373 6572 7420 6d61 785f 7072     assert max_pr
+00018390: 696f 7269 7479 5f66 6565 203d 3d20 5052  iority_fee == PR
+000183a0: 494f 5249 5459 5f46 4545 5f4d 494e 0a0a  IORITY_FEE_MIN..
+000183b0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+000183c0: 5f61 6363 6f75 6e74 7328 7365 6c66 2c20  _accounts(self, 
+000183d0: 7733 3a20 2257 6562 3322 2920 2d3e 204e  w3: "Web3") -> N
+000183e0: 6f6e 653a 0a20 2020 2020 2020 2061 6363  one:.        acc
+000183f0: 6f75 6e74 7320 3d20 7733 2e65 7468 2e61  ounts = w3.eth.a
+00018400: 6363 6f75 6e74 730a 2020 2020 2020 2020  ccounts.        
+00018410: 6173 7365 7274 2069 735f 6c69 7374 5f6c  assert is_list_l
+00018420: 696b 6528 6163 636f 756e 7473 290a 2020  ike(accounts).  
+00018430: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+00018440: 2861 6363 6f75 6e74 7329 2021 3d20 300a  (accounts) != 0.
+00018450: 2020 2020 2020 2020 6173 7365 7274 2061          assert a
+00018460: 6c6c 2869 735f 6368 6563 6b73 756d 5f61  ll(is_checksum_a
+00018470: 6464 7265 7373 2861 6363 6f75 6e74 2920  ddress(account) 
+00018480: 666f 7220 6163 636f 756e 7420 696e 2061  for account in a
+00018490: 6363 6f75 6e74 7329 0a20 2020 2020 2020  ccounts).       
+000184a0: 2061 7373 6572 7420 7733 2e65 7468 2e63   assert w3.eth.c
+000184b0: 6f69 6e62 6173 6520 696e 2061 6363 6f75  oinbase in accou
+000184c0: 6e74 730a 0a20 2020 2064 6566 2074 6573  nts..    def tes
+000184d0: 745f 6574 685f 626c 6f63 6b5f 6e75 6d62  t_eth_block_numb
+000184e0: 6572 2873 656c 662c 2077 333a 2022 5765  er(self, w3: "We
+000184f0: 6233 2229 202d 3e20 4e6f 6e65 3a0a 2020  b3") -> None:.  
+00018500: 2020 2020 2020 626c 6f63 6b5f 6e75 6d62        block_numb
+00018510: 6572 203d 2077 332e 6574 682e 626c 6f63  er = w3.eth.bloc
+00018520: 6b5f 6e75 6d62 6572 0a20 2020 2020 2020  k_number.       
+00018530: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
+00018540: 6572 2862 6c6f 636b 5f6e 756d 6265 7229  er(block_number)
+00018550: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00018560: 626c 6f63 6b5f 6e75 6d62 6572 203e 3d20  block_number >= 
+00018570: 300a 0a20 2020 2064 6566 2074 6573 745f  0..    def test_
+00018580: 6574 685f 6765 745f 626c 6f63 6b5f 6e75  eth_get_block_nu
+00018590: 6d62 6572 2873 656c 662c 2077 333a 2022  mber(self, w3: "
+000185a0: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
+000185b0: 2020 2020 2020 2020 626c 6f63 6b5f 6e75          block_nu
+000185c0: 6d62 6572 203d 2077 332e 6574 682e 6765  mber = w3.eth.ge
+000185d0: 745f 626c 6f63 6b5f 6e75 6d62 6572 2829  t_block_number()
+000185e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+000185f0: 6973 5f69 6e74 6567 6572 2862 6c6f 636b  is_integer(block
+00018600: 5f6e 756d 6265 7229 0a20 2020 2020 2020  _number).       
+00018610: 2061 7373 6572 7420 626c 6f63 6b5f 6e75   assert block_nu
+00018620: 6d62 6572 203e 3d20 300a 0a20 2020 2064  mber >= 0..    d
+00018630: 6566 2074 6573 745f 6574 685f 6765 745f  ef test_eth_get_
+00018640: 6261 6c61 6e63 6528 7365 6c66 2c20 7733  balance(self, w3
+00018650: 3a20 2257 6562 3322 2920 2d3e 204e 6f6e  : "Web3") -> Non
+00018660: 653a 0a20 2020 2020 2020 2063 6f69 6e62  e:.        coinb
+00018670: 6173 6520 3d20 7733 2e65 7468 2e63 6f69  ase = w3.eth.coi
+00018680: 6e62 6173 650a 0a20 2020 2020 2020 2077  nbase..        w
+00018690: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+000186a0: 7328 496e 7661 6c69 6441 6464 7265 7373  s(InvalidAddress
+000186b0: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
+000186c0: 332e 6574 682e 6765 745f 6261 6c61 6e63  3.eth.get_balanc
+000186d0: 6528 4368 6563 6b73 756d 4164 6472 6573  e(ChecksumAddres
+000186e0: 7328 4865 7841 6464 7265 7373 2848 6578  s(HexAddress(Hex
+000186f0: 5374 7228 636f 696e 6261 7365 2e6c 6f77  Str(coinbase.low
+00018700: 6572 2829 2929 2929 0a0a 2020 2020 2020  er()))))..      
+00018710: 2020 6261 6c61 6e63 6520 3d20 7733 2e65    balance = w3.e
+00018720: 7468 2e67 6574 5f62 616c 616e 6365 2863  th.get_balance(c
+00018730: 6f69 6e62 6173 6529 0a0a 2020 2020 2020  oinbase)..      
+00018740: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
+00018750: 6765 7228 6261 6c61 6e63 6529 0a20 2020  ger(balance).   
+00018760: 2020 2020 2061 7373 6572 7420 6261 6c61       assert bala
+00018770: 6e63 6520 3e3d 2030 0a0a 2020 2020 6465  nce >= 0..    de
+00018780: 6620 7465 7374 5f65 7468 5f67 6574 5f62  f test_eth_get_b
+00018790: 616c 616e 6365 5f77 6974 685f 626c 6f63  alance_with_bloc
+000187a0: 6b5f 6964 656e 7469 6669 6572 2873 656c  k_identifier(sel
+000187b0: 662c 2077 333a 2022 5765 6233 2229 202d  f, w3: "Web3") -
+000187c0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+000187d0: 6d69 6e65 725f 6164 6472 6573 7320 3d20  miner_address = 
+000187e0: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
+000187f0: 2831 295b 226d 696e 6572 225d 0a20 2020  (1)["miner"].   
+00018800: 2020 2020 2062 616c 616e 6365 5f70 6f73       balance_pos
+00018810: 745f 6765 6e65 7369 7320 3d20 7733 2e65  t_genesis = w3.e
+00018820: 7468 2e67 6574 5f62 616c 616e 6365 286d  th.get_balance(m
+00018830: 696e 6572 5f61 6464 7265 7373 2c20 3129  iner_address, 1)
+00018840: 0a20 2020 2020 2020 206c 6174 6572 5f62  .        later_b
+00018850: 616c 616e 6365 203d 2077 332e 6574 682e  alance = w3.eth.
+00018860: 6765 745f 6261 6c61 6e63 6528 6d69 6e65  get_balance(mine
+00018870: 725f 6164 6472 6573 732c 2022 6c61 7465  r_address, "late
+00018880: 7374 2229 0a0a 2020 2020 2020 2020 6173  st")..        as
+00018890: 7365 7274 2069 735f 696e 7465 6765 7228  sert is_integer(
+000188a0: 6261 6c61 6e63 655f 706f 7374 5f67 656e  balance_post_gen
+000188b0: 6573 6973 290a 2020 2020 2020 2020 6173  esis).        as
+000188c0: 7365 7274 2069 735f 696e 7465 6765 7228  sert is_integer(
+000188d0: 6c61 7465 725f 6261 6c61 6e63 6529 0a20  later_balance). 
+000188e0: 2020 2020 2020 2061 7373 6572 7420 6c61         assert la
+000188f0: 7465 725f 6261 6c61 6e63 6520 3e20 6261  ter_balance > ba
+00018900: 6c61 6e63 655f 706f 7374 5f67 656e 6573  lance_post_genes
+00018910: 6973 0a0a 2020 2020 4070 7974 6573 742e  is..    @pytest.
+00018920: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
+00018930: 280a 2020 2020 2020 2020 2261 6464 7265  (.        "addre
+00018940: 7373 2c20 6578 7065 6374 5f73 7563 6365  ss, expect_succe
+00018950: 7373 222c 0a20 2020 2020 2020 205b 2822  ss",.        [("
+00018960: 7465 7374 2d61 6464 7265 7373 2e65 7468  test-address.eth
+00018970: 222c 2054 7275 6529 2c20 2822 6e6f 742d  ", True), ("not-
+00018980: 616e 2d61 6464 7265 7373 2e65 7468 222c  an-address.eth",
+00018990: 2046 616c 7365 295d 2c0a 2020 2020 290a   False)],.    ).
+000189a0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+000189b0: 5f67 6574 5f62 616c 616e 6365 5f77 6974  _get_balance_wit
+000189c0: 685f 656e 735f 6e61 6d65 280a 2020 2020  h_ens_name(.    
+000189d0: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
+000189e0: 6562 3322 2c20 6164 6472 6573 733a 2043  eb3", address: C
+000189f0: 6865 636b 7375 6d41 6464 7265 7373 2c20  hecksumAddress, 
+00018a00: 6578 7065 6374 5f73 7563 6365 7373 3a20  expect_success: 
+00018a10: 626f 6f6c 0a20 2020 2029 202d 3e20 4e6f  bool.    ) -> No
+00018a20: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
+00018a30: 2065 6e73 5f61 6464 7265 7373 6573 2877   ens_addresses(w
+00018a40: 332c 207b 2274 6573 742d 6164 6472 6573  3, {"test-addres
+00018a50: 732e 6574 6822 3a20 7733 2e65 7468 2e61  s.eth": w3.eth.a
+00018a60: 6363 6f75 6e74 735b 305d 7d29 3a0a 2020  ccounts[0]}):.  
+00018a70: 2020 2020 2020 2020 2020 6966 2065 7870            if exp
+00018a80: 6563 745f 7375 6363 6573 733a 0a20 2020  ect_success:.   
+00018a90: 2020 2020 2020 2020 2020 2020 2062 616c               bal
+00018aa0: 616e 6365 203d 2077 332e 6574 682e 6765  ance = w3.eth.ge
+00018ab0: 745f 6261 6c61 6e63 6528 6164 6472 6573  t_balance(addres
+00018ac0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+00018ad0: 2020 2061 7373 6572 7420 6973 5f69 6e74     assert is_int
+00018ae0: 6567 6572 2862 616c 616e 6365 290a 2020  eger(balance).  
+00018af0: 2020 2020 2020 2020 2020 2020 2020 6173                as
+00018b00: 7365 7274 2062 616c 616e 6365 203e 3d20  sert balance >= 
+00018b10: 300a 2020 2020 2020 2020 2020 2020 656c  0.            el
+00018b20: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00018b30: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+00018b40: 7261 6973 6573 284e 616d 654e 6f74 466f  raises(NameNotFo
+00018b50: 756e 6429 3a0a 2020 2020 2020 2020 2020  und):.          
+00018b60: 2020 2020 2020 2020 2020 7733 2e65 7468            w3.eth
+00018b70: 2e67 6574 5f62 616c 616e 6365 2861 6464  .get_balance(add
+00018b80: 7265 7373 290a 0a20 2020 2064 6566 2074  ress)..    def t
+00018b90: 6573 745f 6574 685f 6765 745f 7374 6f72  est_eth_get_stor
+00018ba0: 6167 655f 6174 2873 656c 662c 2077 333a  age_at(self, w3:
+00018bb0: 2022 5765 6233 222c 2073 746f 7261 6765   "Web3", storage
+00018bc0: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
+00018bd0: 7261 6374 2229 202d 3e20 4e6f 6e65 3a0a  ract") -> None:.
+00018be0: 2020 2020 2020 2020 7374 6f72 6167 655f          storage_
+00018bf0: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
+00018c00: 203d 2073 746f 7261 6765 5f63 6f6e 7472   = storage_contr
+00018c10: 6163 742e 6164 6472 6573 730a 0a20 2020  act.address..   
+00018c20: 2020 2020 2073 6c6f 745f 3020 3d20 7733       slot_0 = w3
+00018c30: 2e65 7468 2e67 6574 5f73 746f 7261 6765  .eth.get_storage
+00018c40: 5f61 7428 7374 6f72 6167 655f 636f 6e74  _at(storage_cont
+00018c50: 7261 6374 5f61 6464 7265 7373 2c20 3029  ract_address, 0)
+00018c60: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00018c70: 736c 6f74 5f30 203d 3d20 4865 7842 7974  slot_0 == HexByt
+00018c80: 6573 2866 2230 787b 2730 3027 202a 2033  es(f"0x{'00' * 3
+00018c90: 327d 2229 0a0a 2020 2020 2020 2020 736c  2}")..        sl
+00018ca0: 6f74 5f31 203d 2077 332e 6574 682e 6765  ot_1 = w3.eth.ge
+00018cb0: 745f 7374 6f72 6167 655f 6174 2873 746f  t_storage_at(sto
+00018cc0: 7261 6765 5f63 6f6e 7472 6163 745f 6164  rage_contract_ad
+00018cd0: 6472 6573 732c 2031 290a 2020 2020 2020  dress, 1).      
+00018ce0: 2020 6173 7365 7274 2073 6c6f 745f 3120    assert slot_1 
+00018cf0: 3d3d 2048 6578 4279 7465 7328 6622 3078  == HexBytes(f"0x
+00018d00: 7b27 3030 2720 2a20 3331 7d30 3122 290a  {'00' * 31}01").
+00018d10: 0a20 2020 2020 2020 2073 6c6f 745f 3220  .        slot_2 
+00018d20: 3d20 7733 2e65 7468 2e67 6574 5f73 746f  = w3.eth.get_sto
+00018d30: 7261 6765 5f61 7428 7374 6f72 6167 655f  rage_at(storage_
+00018d40: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
+00018d50: 2c20 3229 0a20 2020 2020 2020 2061 7373  , 2).        ass
+00018d60: 6572 7420 736c 6f74 5f32 203d 3d20 4865  ert slot_2 == He
+00018d70: 7842 7974 6573 2866 2230 787b 2730 3027  xBytes(f"0x{'00'
+00018d80: 202a 2033 317d 3032 2229 0a0a 2020 2020   * 31}02")..    
+00018d90: 2020 2020 736c 6f74 5f33 203d 2077 332e      slot_3 = w3.
+00018da0: 6574 682e 6765 745f 7374 6f72 6167 655f  eth.get_storage_
+00018db0: 6174 2873 746f 7261 6765 5f63 6f6e 7472  at(storage_contr
+00018dc0: 6163 745f 6164 6472 6573 732c 2033 290a  act_address, 3).
+00018dd0: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
+00018de0: 6c6f 745f 3320 3d3d 2048 6578 4279 7465  lot_3 == HexByte
+00018df0: 7328 0a20 2020 2020 2020 2020 2020 2022  s(.            "
+00018e00: 3078 3734 3638 3732 3635 3635 3030 3030  0x74687265650000
+00018e10: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 00018e20: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 00018e30: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00018e40: 3030 3030 3030 3061 220a 2020 2020 2020  0000000a".      
-00018e50: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
-00018e60: 7274 2062 7974 6573 2873 6c6f 745f 335b  rt bytes(slot_3[
-00018e70: 3a35 5d29 203d 3d20 6222 7468 7265 6522  :5]) == b"three"
-00018e80: 0a0a 2020 2020 2020 2020 736c 6f74 5f34  ..        slot_4
-00018e90: 203d 2077 332e 6574 682e 6765 745f 7374   = w3.eth.get_st
-00018ea0: 6f72 6167 655f 6174 2873 746f 7261 6765  orage_at(storage
-00018eb0: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
-00018ec0: 732c 2034 290a 2020 2020 2020 2020 6173  s, 4).        as
-00018ed0: 7365 7274 2073 6c6f 745f 3420 3d3d 2048  sert slot_4 == H
-00018ee0: 6578 4279 7465 7328 0a20 2020 2020 2020  exBytes(.       
-00018ef0: 2020 2020 2022 3078 3636 3666 3735 3732       "0x666f7572
+00018e40: 3061 220a 2020 2020 2020 2020 290a 2020  0a".        ).  
+00018e50: 2020 2020 2020 6173 7365 7274 2062 7974        assert byt
+00018e60: 6573 2873 6c6f 745f 335b 3a35 5d29 203d  es(slot_3[:5]) =
+00018e70: 3d20 6222 7468 7265 6522 0a0a 2020 2020  = b"three"..    
+00018e80: 2020 2020 736c 6f74 5f34 203d 2077 332e      slot_4 = w3.
+00018e90: 6574 682e 6765 745f 7374 6f72 6167 655f  eth.get_storage_
+00018ea0: 6174 2873 746f 7261 6765 5f63 6f6e 7472  at(storage_contr
+00018eb0: 6163 745f 6164 6472 6573 732c 2034 290a  act_address, 4).
+00018ec0: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
+00018ed0: 6c6f 745f 3420 3d3d 2048 6578 4279 7465  lot_4 == HexByte
+00018ee0: 7328 0a20 2020 2020 2020 2020 2020 2022  s(.            "
+00018ef0: 3078 3636 3666 3735 3732 3030 3030 3030  0x666f7572000000
 00018f00: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 00018f10: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 00018f20: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00018f30: 3030 3030 3030 3038 220a 2020 2020 2020  00000008".      
-00018f40: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
-00018f50: 7274 2062 7974 6573 2873 6c6f 745f 345b  rt bytes(slot_4[
-00018f60: 3a34 5d29 203d 3d20 6222 666f 7572 220a  :4]) == b"four".
-00018f70: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00018f80: 685f 6765 745f 7374 6f72 6167 655f 6174  h_get_storage_at
-00018f90: 5f65 6e73 5f6e 616d 6528 0a20 2020 2020  _ens_name(.     
-00018fa0: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
-00018fb0: 6233 222c 2073 746f 7261 6765 5f63 6f6e  b3", storage_con
-00018fc0: 7472 6163 743a 2022 436f 6e74 7261 6374  tract: "Contract
-00018fd0: 220a 2020 2020 2920 2d3e 204e 6f6e 653a  ".    ) -> None:
-00018fe0: 0a20 2020 2020 2020 2077 6974 6820 656e  .        with en
-00018ff0: 735f 6164 6472 6573 7365 7328 7733 2c20  s_addresses(w3, 
-00019000: 7b22 7374 6f72 6167 652e 6574 6822 3a20  {"storage.eth": 
-00019010: 7374 6f72 6167 655f 636f 6e74 7261 6374  storage_contract
-00019020: 2e61 6464 7265 7373 7d29 3a0a 2020 2020  .address}):.    
-00019030: 2020 2020 2020 2020 7374 6f72 6167 6520          storage 
-00019040: 3d20 7733 2e65 7468 2e67 6574 5f73 746f  = w3.eth.get_sto
-00019050: 7261 6765 5f61 7428 454e 5328 2273 746f  rage_at(ENS("sto
-00019060: 7261 6765 2e65 7468 2229 2c20 3129 0a20  rage.eth"), 1). 
-00019070: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-00019080: 7420 7374 6f72 6167 6520 3d3d 2048 6578  t storage == Hex
-00019090: 4279 7465 7328 6622 3078 7b27 3030 2720  Bytes(f"0x{'00' 
-000190a0: 2a20 3331 7d30 3122 290a 0a20 2020 2064  * 31}01")..    d
-000190b0: 6566 2074 6573 745f 6574 685f 6765 745f  ef test_eth_get_
-000190c0: 7374 6f72 6167 655f 6174 5f69 6e76 616c  storage_at_inval
-000190d0: 6964 5f61 6464 7265 7373 2873 656c 662c  id_address(self,
-000190e0: 2077 333a 2022 5765 6233 2229 202d 3e20   w3: "Web3") -> 
-000190f0: 4e6f 6e65 3a0a 2020 2020 2020 2020 636f  None:.        co
-00019100: 696e 6261 7365 203d 2077 332e 6574 682e  inbase = w3.eth.
-00019110: 636f 696e 6261 7365 0a20 2020 2020 2020  coinbase.       
-00019120: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-00019130: 7365 7328 496e 7661 6c69 6441 6464 7265  ses(InvalidAddre
-00019140: 7373 293a 0a20 2020 2020 2020 2020 2020  ss):.           
-00019150: 2077 332e 6574 682e 6765 745f 7374 6f72   w3.eth.get_stor
-00019160: 6167 655f 6174 280a 2020 2020 2020 2020  age_at(.        
-00019170: 2020 2020 2020 2020 4368 6563 6b73 756d          Checksum
-00019180: 4164 6472 6573 7328 4865 7841 6464 7265  Address(HexAddre
-00019190: 7373 2848 6578 5374 7228 636f 696e 6261  ss(HexStr(coinba
-000191a0: 7365 2e6c 6f77 6572 2829 2929 292c 2030  se.lower()))), 0
-000191b0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-000191c0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-000191d0: 5f67 6574 5f74 7261 6e73 6163 7469 6f6e  _get_transaction
-000191e0: 5f63 6f75 6e74 280a 2020 2020 2020 2020  _count(.        
-000191f0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-00019200: 2c20 756e 6c6f 636b 6564 5f61 6363 6f75  , unlocked_accou
-00019210: 6e74 5f64 7561 6c5f 7479 7065 3a20 4368  nt_dual_type: Ch
-00019220: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
-00019230: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00019240: 2020 2020 2074 7261 6e73 6163 7469 6f6e       transaction
-00019250: 5f63 6f75 6e74 203d 2077 332e 6574 682e  _count = w3.eth.
-00019260: 6765 745f 7472 616e 7361 6374 696f 6e5f  get_transaction_
-00019270: 636f 756e 7428 756e 6c6f 636b 6564 5f61  count(unlocked_a
-00019280: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-00019290: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-000192a0: 2069 735f 696e 7465 6765 7228 7472 616e   is_integer(tran
-000192b0: 7361 6374 696f 6e5f 636f 756e 7429 0a20  saction_count). 
-000192c0: 2020 2020 2020 2061 7373 6572 7420 7472         assert tr
-000192d0: 616e 7361 6374 696f 6e5f 636f 756e 7420  ansaction_count 
-000192e0: 3e3d 2030 0a0a 2020 2020 6465 6620 7465  >= 0..    def te
-000192f0: 7374 5f65 7468 5f67 6574 5f74 7261 6e73  st_eth_get_trans
-00019300: 6163 7469 6f6e 5f63 6f75 6e74 5f65 6e73  action_count_ens
-00019310: 5f6e 616d 6528 0a20 2020 2020 2020 2073  _name(.        s
-00019320: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
-00019330: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
-00019340: 745f 6475 616c 5f74 7970 653a 2043 6865  t_dual_type: Che
-00019350: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
-00019360: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00019370: 2020 2020 7769 7468 2065 6e73 5f61 6464      with ens_add
-00019380: 7265 7373 6573 280a 2020 2020 2020 2020  resses(.        
-00019390: 2020 2020 7733 2c20 7b22 756e 6c6f 636b      w3, {"unlock
-000193a0: 6564 2d61 6363 742d 6475 616c 2d74 7970  ed-acct-dual-typ
-000193b0: 652e 6574 6822 3a20 756e 6c6f 636b 6564  e.eth": unlocked
-000193c0: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
-000193d0: 7065 7d0a 2020 2020 2020 2020 293a 0a20  pe}.        ):. 
-000193e0: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-000193f0: 6163 7469 6f6e 5f63 6f75 6e74 203d 2077  action_count = w
-00019400: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
-00019410: 6374 696f 6e5f 636f 756e 7428 0a20 2020  ction_count(.   
-00019420: 2020 2020 2020 2020 2020 2020 2045 4e53               ENS
-00019430: 2822 756e 6c6f 636b 6564 2d61 6363 742d  ("unlocked-acct-
-00019440: 6475 616c 2d74 7970 652e 6574 6822 290a  dual-type.eth").
-00019450: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00019460: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-00019470: 2069 735f 696e 7465 6765 7228 7472 616e   is_integer(tran
-00019480: 7361 6374 696f 6e5f 636f 756e 7429 0a20  saction_count). 
-00019490: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-000194a0: 7420 7472 616e 7361 6374 696f 6e5f 636f  t transaction_co
-000194b0: 756e 7420 3e3d 2030 0a0a 2020 2020 6465  unt >= 0..    de
-000194c0: 6620 7465 7374 5f65 7468 5f67 6574 5f74  f test_eth_get_t
-000194d0: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
-000194e0: 5f69 6e76 616c 6964 5f61 6464 7265 7373  _invalid_address
-000194f0: 2873 656c 662c 2077 333a 2022 5765 6233  (self, w3: "Web3
-00019500: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
-00019510: 2020 2020 636f 696e 6261 7365 203d 2077      coinbase = w
-00019520: 332e 6574 682e 636f 696e 6261 7365 0a20  3.eth.coinbase. 
-00019530: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-00019540: 7374 2e72 6169 7365 7328 496e 7661 6c69  st.raises(Invali
-00019550: 6441 6464 7265 7373 293a 0a20 2020 2020  dAddress):.     
-00019560: 2020 2020 2020 2077 332e 6574 682e 6765         w3.eth.ge
-00019570: 745f 7472 616e 7361 6374 696f 6e5f 636f  t_transaction_co
-00019580: 756e 7428 0a20 2020 2020 2020 2020 2020  unt(.           
-00019590: 2020 2020 2043 6865 636b 7375 6d41 6464       ChecksumAdd
-000195a0: 7265 7373 2848 6578 4164 6472 6573 7328  ress(HexAddress(
-000195b0: 4865 7853 7472 2863 6f69 6e62 6173 652e  HexStr(coinbase.
-000195c0: 6c6f 7765 7228 2929 2929 0a20 2020 2020  lower()))).     
-000195d0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-000195e0: 6620 7465 7374 5f65 7468 5f67 6574 426c  f test_eth_getBl
-000195f0: 6f63 6b54 7261 6e73 6163 7469 6f6e 436f  ockTransactionCo
-00019600: 756e 7442 7948 6173 685f 656d 7074 795f  untByHash_empty_
-00019610: 626c 6f63 6b28 0a20 2020 2020 2020 2073  block(.        s
-00019620: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
-00019630: 2065 6d70 7479 5f62 6c6f 636b 3a20 426c   empty_block: Bl
-00019640: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
-00019650: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
-00019660: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
-00019670: 203d 2077 332e 6574 682e 6765 745f 626c   = w3.eth.get_bl
-00019680: 6f63 6b5f 7472 616e 7361 6374 696f 6e5f  ock_transaction_
-00019690: 636f 756e 7428 656d 7074 795f 626c 6f63  count(empty_bloc
-000196a0: 6b5b 2268 6173 6822 5d29 0a0a 2020 2020  k["hash"])..    
-000196b0: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
-000196c0: 7465 6765 7228 7472 616e 7361 6374 696f  teger(transactio
-000196d0: 6e5f 636f 756e 7429 0a20 2020 2020 2020  n_count).       
-000196e0: 2061 7373 6572 7420 7472 616e 7361 6374   assert transact
-000196f0: 696f 6e5f 636f 756e 7420 3d3d 2030 0a0a  ion_count == 0..
-00019700: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-00019710: 5f67 6574 426c 6f63 6b54 7261 6e73 6163  _getBlockTransac
-00019720: 7469 6f6e 436f 756e 7442 794e 756d 6265  tionCountByNumbe
-00019730: 725f 656d 7074 795f 626c 6f63 6b28 0a20  r_empty_block(. 
-00019740: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
-00019750: 2022 5765 6233 222c 2065 6d70 7479 5f62   "Web3", empty_b
-00019760: 6c6f 636b 3a20 426c 6f63 6b44 6174 610a  lock: BlockData.
-00019770: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00019780: 2020 2020 2020 2074 7261 6e73 6163 7469         transacti
-00019790: 6f6e 5f63 6f75 6e74 203d 2077 332e 6574  on_count = w3.et
-000197a0: 682e 6765 745f 626c 6f63 6b5f 7472 616e  h.get_block_tran
-000197b0: 7361 6374 696f 6e5f 636f 756e 7428 656d  saction_count(em
-000197c0: 7074 795f 626c 6f63 6b5b 226e 756d 6265  pty_block["numbe
-000197d0: 7222 5d29 0a0a 2020 2020 2020 2020 6173  r"])..        as
-000197e0: 7365 7274 2069 735f 696e 7465 6765 7228  sert is_integer(
-000197f0: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
-00019800: 7429 0a20 2020 2020 2020 2061 7373 6572  t).        asser
-00019810: 7420 7472 616e 7361 6374 696f 6e5f 636f  t transaction_co
-00019820: 756e 7420 3d3d 2030 0a0a 2020 2020 6465  unt == 0..    de
-00019830: 6620 7465 7374 5f65 7468 5f67 6574 426c  f test_eth_getBl
-00019840: 6f63 6b54 7261 6e73 6163 7469 6f6e 436f  ockTransactionCo
-00019850: 756e 7442 7948 6173 685f 626c 6f63 6b5f  untByHash_block_
-00019860: 7769 7468 5f74 786e 280a 2020 2020 2020  with_txn(.      
-00019870: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
-00019880: 3322 2c20 626c 6f63 6b5f 7769 7468 5f74  3", block_with_t
-00019890: 786e 3a20 426c 6f63 6b44 6174 610a 2020  xn: BlockData.  
-000198a0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-000198b0: 2020 2020 2074 7261 6e73 6163 7469 6f6e       transaction
-000198c0: 5f63 6f75 6e74 203d 2077 332e 6574 682e  _count = w3.eth.
-000198d0: 6765 745f 626c 6f63 6b5f 7472 616e 7361  get_block_transa
-000198e0: 6374 696f 6e5f 636f 756e 7428 626c 6f63  ction_count(bloc
-000198f0: 6b5f 7769 7468 5f74 786e 5b22 6861 7368  k_with_txn["hash
-00019900: 225d 290a 0a20 2020 2020 2020 2061 7373  "])..        ass
-00019910: 6572 7420 6973 5f69 6e74 6567 6572 2874  ert is_integer(t
-00019920: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
-00019930: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00019940: 2074 7261 6e73 6163 7469 6f6e 5f63 6f75   transaction_cou
-00019950: 6e74 203e 3d20 310a 0a20 2020 2064 6566  nt >= 1..    def
-00019960: 2074 6573 745f 6574 685f 6765 7442 6c6f   test_eth_getBlo
-00019970: 636b 5472 616e 7361 6374 696f 6e43 6f75  ckTransactionCou
-00019980: 6e74 4279 4e75 6d62 6572 5f62 6c6f 636b  ntByNumber_block
-00019990: 5f77 6974 685f 7478 6e28 0a20 2020 2020  _with_txn(.     
-000199a0: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
-000199b0: 6233 222c 2062 6c6f 636b 5f77 6974 685f  b3", block_with_
-000199c0: 7478 6e3a 2042 6c6f 636b 4461 7461 0a20  txn: BlockData. 
-000199d0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-000199e0: 2020 2020 2020 7472 616e 7361 6374 696f        transactio
-000199f0: 6e5f 636f 756e 7420 3d20 7733 2e65 7468  n_count = w3.eth
-00019a00: 2e67 6574 5f62 6c6f 636b 5f74 7261 6e73  .get_block_trans
-00019a10: 6163 7469 6f6e 5f63 6f75 6e74 2862 6c6f  action_count(blo
-00019a20: 636b 5f77 6974 685f 7478 6e5b 226e 756d  ck_with_txn["num
-00019a30: 6265 7222 5d29 0a0a 2020 2020 2020 2020  ber"])..        
-00019a40: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
-00019a50: 7228 7472 616e 7361 6374 696f 6e5f 636f  r(transaction_co
-00019a60: 756e 7429 0a20 2020 2020 2020 2061 7373  unt).        ass
-00019a70: 6572 7420 7472 616e 7361 6374 696f 6e5f  ert transaction_
-00019a80: 636f 756e 7420 3e3d 2031 0a0a 2020 2020  count >= 1..    
-00019a90: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-00019aa0: 556e 636c 6543 6f75 6e74 4279 426c 6f63  UncleCountByBloc
-00019ab0: 6b48 6173 6828 0a20 2020 2020 2020 2073  kHash(.        s
-00019ac0: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
-00019ad0: 2065 6d70 7479 5f62 6c6f 636b 3a20 426c   empty_block: Bl
-00019ae0: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
-00019af0: 204e 6f6e 653a 0a20 2020 2020 2020 2075   None:.        u
-00019b00: 6e63 6c65 5f63 6f75 6e74 203d 2077 332e  ncle_count = w3.
-00019b10: 6574 682e 6765 745f 756e 636c 655f 636f  eth.get_uncle_co
-00019b20: 756e 7428 656d 7074 795f 626c 6f63 6b5b  unt(empty_block[
-00019b30: 2268 6173 6822 5d29 0a0a 2020 2020 2020  "hash"])..      
-00019b40: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
-00019b50: 6765 7228 756e 636c 655f 636f 756e 7429  ger(uncle_count)
-00019b60: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00019b70: 756e 636c 655f 636f 756e 7420 3d3d 2030  uncle_count == 0
-00019b80: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-00019b90: 7468 5f67 6574 556e 636c 6543 6f75 6e74  th_getUncleCount
-00019ba0: 4279 426c 6f63 6b4e 756d 6265 7228 0a20  ByBlockNumber(. 
-00019bb0: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
-00019bc0: 2022 5765 6233 222c 2065 6d70 7479 5f62   "Web3", empty_b
-00019bd0: 6c6f 636b 3a20 426c 6f63 6b44 6174 610a  lock: BlockData.
-00019be0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00019bf0: 2020 2020 2020 2075 6e63 6c65 5f63 6f75         uncle_cou
-00019c00: 6e74 203d 2077 332e 6574 682e 6765 745f  nt = w3.eth.get_
-00019c10: 756e 636c 655f 636f 756e 7428 656d 7074  uncle_count(empt
-00019c20: 795f 626c 6f63 6b5b 226e 756d 6265 7222  y_block["number"
-00019c30: 5d29 0a0a 2020 2020 2020 2020 6173 7365  ])..        asse
-00019c40: 7274 2069 735f 696e 7465 6765 7228 756e  rt is_integer(un
-00019c50: 636c 655f 636f 756e 7429 0a20 2020 2020  cle_count).     
-00019c60: 2020 2061 7373 6572 7420 756e 636c 655f     assert uncle_
-00019c70: 636f 756e 7420 3d3d 2030 0a0a 2020 2020  count == 0..    
-00019c80: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-00019c90: 5f63 6f64 6528 0a20 2020 2020 2020 2073  _code(.        s
-00019ca0: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
-00019cb0: 206d 6174 685f 636f 6e74 7261 6374 5f61   math_contract_a
-00019cc0: 6464 7265 7373 3a20 4368 6563 6b73 756d  ddress: Checksum
-00019cd0: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-00019ce0: 204e 6f6e 653a 0a20 2020 2020 2020 2063   None:.        c
-00019cf0: 6f64 6520 3d20 7733 2e65 7468 2e67 6574  ode = w3.eth.get
-00019d00: 5f63 6f64 6528 6d61 7468 5f63 6f6e 7472  _code(math_contr
-00019d10: 6163 745f 6164 6472 6573 7329 0a20 2020  act_address).   
-00019d20: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
-00019d30: 7374 616e 6365 2863 6f64 652c 2048 6578  stance(code, Hex
-00019d40: 4279 7465 7329 0a20 2020 2020 2020 2061  Bytes).        a
-00019d50: 7373 6572 7420 6c65 6e28 636f 6465 2920  ssert len(code) 
-00019d60: 3e20 300a 0a20 2020 2064 6566 2074 6573  > 0..    def tes
-00019d70: 745f 6574 685f 6765 745f 636f 6465 5f65  t_eth_get_code_e
-00019d80: 6e73 5f61 6464 7265 7373 280a 2020 2020  ns_address(.    
-00019d90: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
-00019da0: 6562 3322 2c20 6d61 7468 5f63 6f6e 7472  eb3", math_contr
-00019db0: 6163 745f 6164 6472 6573 733a 2043 6865  act_address: Che
-00019dc0: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
-00019dd0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00019de0: 2020 2020 7769 7468 2065 6e73 5f61 6464      with ens_add
-00019df0: 7265 7373 6573 2877 332c 207b 226d 6174  resses(w3, {"mat
-00019e00: 6863 6f6e 7472 6163 742e 6574 6822 3a20  hcontract.eth": 
-00019e10: 6d61 7468 5f63 6f6e 7472 6163 745f 6164  math_contract_ad
-00019e20: 6472 6573 737d 293a 0a20 2020 2020 2020  dress}):.       
-00019e30: 2020 2020 2063 6f64 6520 3d20 7733 2e65       code = w3.e
-00019e40: 7468 2e67 6574 5f63 6f64 6528 454e 5328  th.get_code(ENS(
-00019e50: 226d 6174 6863 6f6e 7472 6163 742e 6574  "mathcontract.et
-00019e60: 6822 2929 0a20 2020 2020 2020 2020 2020  h")).           
-00019e70: 2061 7373 6572 7420 6973 696e 7374 616e   assert isinstan
-00019e80: 6365 2863 6f64 652c 2048 6578 4279 7465  ce(code, HexByte
-00019e90: 7329 0a20 2020 2020 2020 2020 2020 2061  s).            a
-00019ea0: 7373 6572 7420 6c65 6e28 636f 6465 2920  ssert len(code) 
-00019eb0: 3e20 300a 0a20 2020 2064 6566 2074 6573  > 0..    def tes
-00019ec0: 745f 6574 685f 6765 745f 636f 6465 5f69  t_eth_get_code_i
-00019ed0: 6e76 616c 6964 5f61 6464 7265 7373 280a  nvalid_address(.
-00019ee0: 2020 2020 2020 2020 7365 6c66 2c20 7733          self, w3
-00019ef0: 3a20 2257 6562 3322 2c20 6d61 7468 5f63  : "Web3", math_c
-00019f00: 6f6e 7472 6163 743a 2022 436f 6e74 7261  ontract: "Contra
-00019f10: 6374 220a 2020 2020 2920 2d3e 204e 6f6e  ct".    ) -> Non
-00019f20: 653a 0a20 2020 2020 2020 2077 6974 6820  e:.        with 
-00019f30: 7079 7465 7374 2e72 6169 7365 7328 496e  pytest.raises(In
-00019f40: 7661 6c69 6441 6464 7265 7373 293a 0a20  validAddress):. 
-00019f50: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
-00019f60: 682e 6765 745f 636f 6465 280a 2020 2020  h.get_code(.    
-00019f70: 2020 2020 2020 2020 2020 2020 4368 6563              Chec
-00019f80: 6b73 756d 4164 6472 6573 7328 4865 7841  ksumAddress(HexA
-00019f90: 6464 7265 7373 2848 6578 5374 7228 6d61  ddress(HexStr(ma
-00019fa0: 7468 5f63 6f6e 7472 6163 742e 6164 6472  th_contract.addr
-00019fb0: 6573 732e 6c6f 7765 7228 2929 2929 0a20  ess.lower()))). 
-00019fc0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00019fd0: 2020 6465 6620 7465 7374 5f65 7468 5f67    def test_eth_g
-00019fe0: 6574 5f63 6f64 655f 7769 7468 5f62 6c6f  et_code_with_blo
-00019ff0: 636b 5f69 6465 6e74 6966 6965 7228 0a20  ck_identifier(. 
-0001a000: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
-0001a010: 2022 5765 6233 222c 2065 6d69 7474 6572   "Web3", emitter
-0001a020: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
-0001a030: 7261 6374 220a 2020 2020 2920 2d3e 204e  ract".    ) -> N
-0001a040: 6f6e 653a 0a20 2020 2020 2020 2063 6f64  one:.        cod
-0001a050: 6520 3d20 7733 2e65 7468 2e67 6574 5f63  e = w3.eth.get_c
-0001a060: 6f64 6528 0a20 2020 2020 2020 2020 2020  ode(.           
-0001a070: 2065 6d69 7474 6572 5f63 6f6e 7472 6163   emitter_contrac
-0001a080: 742e 6164 6472 6573 732c 2062 6c6f 636b  t.address, block
-0001a090: 5f69 6465 6e74 6966 6965 723d 7733 2e65  _identifier=w3.e
-0001a0a0: 7468 2e62 6c6f 636b 5f6e 756d 6265 720a  th.block_number.
-0001a0b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001a0c0: 2020 6173 7365 7274 2069 7369 6e73 7461    assert isinsta
-0001a0d0: 6e63 6528 636f 6465 2c20 4865 7842 7974  nce(code, HexByt
-0001a0e0: 6573 290a 2020 2020 2020 2020 6173 7365  es).        asse
-0001a0f0: 7274 206c 656e 2863 6f64 6529 203e 2030  rt len(code) > 0
-0001a100: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-0001a110: 7468 5f63 7265 6174 655f 6163 6365 7373  th_create_access
-0001a120: 5f6c 6973 7428 0a20 2020 2020 2020 2073  _list(.        s
-0001a130: 656c 662c 0a20 2020 2020 2020 2077 333a  elf,.        w3:
-0001a140: 2022 5765 6233 222c 0a20 2020 2020 2020   "Web3",.       
-0001a150: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
-0001a160: 745f 6475 616c 5f74 7970 653a 2043 6865  t_dual_type: Che
-0001a170: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
-0001a180: 2020 2020 2020 6d61 7468 5f63 6f6e 7472        math_contr
-0001a190: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
-0001a1a0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0001a1b0: 2020 2020 2020 2020 2320 496e 6974 6961          # Initia
-0001a1c0: 6c69 7a65 2074 7261 6e73 6163 7469 6f6e  lize transaction
-0001a1d0: 2066 6f72 2067 6173 2065 7374 696d 6174   for gas estimat
-0001a1e0: 696f 6e0a 2020 2020 2020 2020 7478 6e5f  ion.        txn_
-0001a1f0: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-0001a200: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0001a210: 2022 6672 6f6d 223a 2075 6e6c 6f63 6b65   "from": unlocke
-0001a220: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-0001a230: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-0001a240: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
-0001a250: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-0001a260: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
-0001a270: 2020 2020 7d0a 0a20 2020 2020 2020 2074      }..        t
-0001a280: 786e 203d 206d 6174 685f 636f 6e74 7261  xn = math_contra
-0001a290: 6374 2e66 756e 6374 696f 6e73 2e69 6e63  ct.functions.inc
-0001a2a0: 7265 6d65 6e74 436f 756e 7465 7228 3129  rementCounter(1)
-0001a2b0: 2e62 7569 6c64 5f74 7261 6e73 6163 7469  .build_transacti
-0001a2c0: 6f6e 2874 786e 5f70 6172 616d 7329 0a0a  on(txn_params)..
-0001a2d0: 2020 2020 2020 2020 2320 6372 6561 7465          # create
-0001a2e0: 2061 6363 6573 7320 6c69 7374 2075 7369   access list usi
-0001a2f0: 6e67 2064 6174 6120 6672 6f6d 2074 7261  ng data from tra
-0001a300: 6e73 6163 7469 6f6e 0a20 2020 2020 2020  nsaction.       
-0001a310: 2072 6573 706f 6e73 6520 3d20 7733 2e65   response = w3.e
-0001a320: 7468 2e63 7265 6174 655f 6163 6365 7373  th.create_access
-0001a330: 5f6c 6973 7428 0a20 2020 2020 2020 2020  _list(.         
-0001a340: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-0001a350: 2020 2020 2022 6672 6f6d 223a 2075 6e6c       "from": unl
-0001a360: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
-0001a370: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
-0001a380: 2020 2020 2020 2020 2022 746f 223a 206d           "to": m
-0001a390: 6174 685f 636f 6e74 7261 6374 2e61 6464  ath_contract.add
-0001a3a0: 7265 7373 2c0a 2020 2020 2020 2020 2020  ress,.          
-0001a3b0: 2020 2020 2020 2264 6174 6122 3a20 7478        "data": tx
-0001a3c0: 6e5b 2264 6174 6122 5d2c 0a20 2020 2020  n["data"],.     
-0001a3d0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-0001a3e0: 2029 0a0a 2020 2020 2020 2020 6173 7365   )..        asse
-0001a3f0: 7274 2069 735f 6469 6374 2872 6573 706f  rt is_dict(respo
-0001a400: 6e73 6529 0a20 2020 2020 2020 2061 6363  nse).        acc
-0001a410: 6573 735f 6c69 7374 203d 2072 6573 706f  ess_list = respo
-0001a420: 6e73 655b 2261 6363 6573 734c 6973 7422  nse["accessList"
-0001a430: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
-0001a440: 206c 656e 2861 6363 6573 735f 6c69 7374   len(access_list
-0001a450: 2920 3e20 300a 2020 2020 2020 2020 6173  ) > 0.        as
-0001a460: 7365 7274 2061 6363 6573 735f 6c69 7374  sert access_list
-0001a470: 5b30 5d5b 2261 6464 7265 7373 225d 2069  [0]["address"] i
-0001a480: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
-0001a490: 2020 2061 7373 6572 7420 6973 5f63 6865     assert is_che
-0001a4a0: 636b 7375 6d5f 6164 6472 6573 7328 6163  cksum_address(ac
-0001a4b0: 6365 7373 5f6c 6973 745b 305d 5b22 6164  cess_list[0]["ad
-0001a4c0: 6472 6573 7322 5d29 0a20 2020 2020 2020  dress"]).       
-0001a4d0: 2061 7373 6572 7420 6c65 6e28 6163 6365   assert len(acce
-0001a4e0: 7373 5f6c 6973 745b 305d 5b22 7374 6f72  ss_list[0]["stor
-0001a4f0: 6167 654b 6579 7322 5d5b 305d 2920 3d3d  ageKeys"][0]) ==
-0001a500: 2033 320a 2020 2020 2020 2020 6173 7365   32.        asse
-0001a510: 7274 2069 6e74 2872 6573 706f 6e73 655b  rt int(response[
-0001a520: 2267 6173 5573 6564 225d 2920 3e3d 2030  "gasUsed"]) >= 0
-0001a530: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-0001a540: 7468 5f73 6967 6e28 0a20 2020 2020 2020  th_sign(.       
-0001a550: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
-0001a560: 222c 2075 6e6c 6f63 6b65 645f 6163 636f  ", unlocked_acco
-0001a570: 756e 745f 6475 616c 5f74 7970 653a 2043  unt_dual_type: C
-0001a580: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
-0001a590: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0001a5a0: 2020 2020 2020 7369 676e 6174 7572 6520        signature 
-0001a5b0: 3d20 7733 2e65 7468 2e73 6967 6e28 0a20  = w3.eth.sign(. 
-0001a5c0: 2020 2020 2020 2020 2020 2075 6e6c 6f63             unloc
-0001a5d0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-0001a5e0: 5f74 7970 652c 2074 6578 743d 224d 6573  _type, text="Mes
-0001a5f0: 7361 6765 2074 c3b6 2073 6967 6e2e 204c  sage t.. sign. L
-0001a600: 6f6e 6765 7220 7468 616e 2068 6173 6821  onger than hash!
-0001a610: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
-0001a620: 2020 2020 6173 7365 7274 2069 735f 6279      assert is_by
-0001a630: 7465 7328 7369 676e 6174 7572 6529 0a20  tes(signature). 
-0001a640: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-0001a650: 6e28 7369 676e 6174 7572 6529 203d 3d20  n(signature) == 
-0001a660: 3332 202b 2033 3220 2b20 310a 0a20 2020  32 + 32 + 1..   
-0001a670: 2020 2020 2023 2074 6573 7420 6f74 6865       # test othe
-0001a680: 7220 666f 726d 6174 730a 2020 2020 2020  r formats.      
-0001a690: 2020 6865 7873 6967 6e20 3d20 7733 2e65    hexsign = w3.e
-0001a6a0: 7468 2e73 6967 6e28 0a20 2020 2020 2020  th.sign(.       
-0001a6b0: 2020 2020 2075 6e6c 6f63 6b65 645f 6163       unlocked_ac
-0001a6c0: 636f 756e 745f 6475 616c 5f74 7970 652c  count_dual_type,
-0001a6d0: 0a20 2020 2020 2020 2020 2020 2068 6578  .            hex
-0001a6e0: 7374 723d 4865 7853 7472 280a 2020 2020  str=HexStr(.    
-0001a6f0: 2020 2020 2020 2020 2020 2020 2230 7834              "0x4
-0001a700: 6436 3537 3337 3336 3136 3736 3532 3037  d657373616765207
-0001a710: 3463 3362 3632 3037 3336 3936 3736 6532  4c3b6207369676e2
-0001a720: 6532 3034 6336 6636 6536 3736 3537 3232  e204c6f6e6765722
-0001a730: 3037 3436 3836 3136 6532 3036 3836 3137  07468616e2068617
-0001a740: 3336 3832 3122 2020 2320 6e6f 7161 3a20  36821"  # noqa: 
-0001a750: 4535 3031 0a20 2020 2020 2020 2020 2020  E501.           
-0001a760: 2029 2c0a 2020 2020 2020 2020 290a 2020   ),.        ).  
-0001a770: 2020 2020 2020 6173 7365 7274 2068 6578        assert hex
-0001a780: 7369 676e 203d 3d20 7369 676e 6174 7572  sign == signatur
-0001a790: 650a 0a20 2020 2020 2020 2069 6e74 7369  e..        intsi
-0001a7a0: 676e 203d 2077 332e 6574 682e 7369 676e  gn = w3.eth.sign
-0001a7b0: 280a 2020 2020 2020 2020 2020 2020 756e  (.            un
-0001a7c0: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-0001a7d0: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-0001a7e0: 2020 2020 2020 3078 3444 3635 3733 3733        0x4D657373
-0001a7f0: 3631 3637 3635 3230 3734 4333 4236 3230  6167652074C3B620
-0001a800: 3733 3639 3637 3645 3245 3230 3443 3646  7369676E2E204C6F
-0001a810: 3645 3637 3635 3732 3230 3734 3638 3631  6E67657220746861
-0001a820: 3645 3230 3638 3631 3733 3638 3231 2c0a  6E206861736821,.
-0001a830: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001a840: 2020 6173 7365 7274 2069 6e74 7369 676e    assert intsign
-0001a850: 203d 3d20 7369 676e 6174 7572 650a 0a20   == signature.. 
-0001a860: 2020 2020 2020 2062 7974 6573 7369 676e         bytessign
-0001a870: 203d 2077 332e 6574 682e 7369 676e 280a   = w3.eth.sign(.
-0001a880: 2020 2020 2020 2020 2020 2020 756e 6c6f              unlo
-0001a890: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-0001a8a0: 6c5f 7479 7065 2c20 6222 4d65 7373 6167  l_type, b"Messag
-0001a8b0: 6520 745c 7863 335c 7862 3620 7369 676e  e t\xc3\xb6 sign
-0001a8c0: 2e20 4c6f 6e67 6572 2074 6861 6e20 6861  . Longer than ha
-0001a8d0: 7368 2122 0a20 2020 2020 2020 2029 0a20  sh!".        ). 
-0001a8e0: 2020 2020 2020 2061 7373 6572 7420 6279         assert by
-0001a8f0: 7465 7373 6967 6e20 3d3d 2073 6967 6e61  tessign == signa
-0001a900: 7475 7265 0a0a 2020 2020 2020 2020 6e65  ture..        ne
-0001a910: 775f 7369 676e 6174 7572 6520 3d20 7733  w_signature = w3
-0001a920: 2e65 7468 2e73 6967 6e28 0a20 2020 2020  .eth.sign(.     
-0001a930: 2020 2020 2020 2075 6e6c 6f63 6b65 645f         unlocked_
-0001a940: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
-0001a950: 652c 2074 6578 743d 2264 6966 6665 7265  e, text="differe
-0001a960: 6e74 206d 6573 7361 6765 2069 7320 6469  nt message is di
-0001a970: 6666 6572 656e 7422 0a20 2020 2020 2020  fferent".       
-0001a980: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
-0001a990: 7420 6e65 775f 7369 676e 6174 7572 6520  t new_signature 
-0001a9a0: 213d 2073 6967 6e61 7475 7265 0a0a 2020  != signature..  
-0001a9b0: 2020 6465 6620 7465 7374 5f65 7468 5f73    def test_eth_s
-0001a9c0: 6967 6e5f 656e 735f 6e61 6d65 7328 0a20  ign_ens_names(. 
-0001a9d0: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
-0001a9e0: 2022 5765 6233 222c 2075 6e6c 6f63 6b65   "Web3", unlocke
-0001a9f0: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-0001aa00: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-0001aa10: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-0001aa20: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
-0001aa30: 2065 6e73 5f61 6464 7265 7373 6573 2877   ens_addresses(w
-0001aa40: 332c 207b 2275 6e6c 6f63 6b65 642d 6163  3, {"unlocked-ac
-0001aa50: 6374 2e65 7468 223a 2075 6e6c 6f63 6b65  ct.eth": unlocke
-0001aa60: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-0001aa70: 7970 657d 293a 0a20 2020 2020 2020 2020  ype}):.         
-0001aa80: 2020 2073 6967 6e61 7475 7265 203d 2077     signature = w
-0001aa90: 332e 6574 682e 7369 676e 280a 2020 2020  3.eth.sign(.    
-0001aaa0: 2020 2020 2020 2020 2020 2020 2275 6e6c              "unl
-0001aab0: 6f63 6b65 642d 6163 6374 2e65 7468 222c  ocked-acct.eth",
-0001aac0: 2074 6578 743d 224d 6573 7361 6765 2074   text="Message t
-0001aad0: c3b6 2073 6967 6e2e 204c 6f6e 6765 7220  .. sign. Longer 
-0001aae0: 7468 616e 2068 6173 6821 220a 2020 2020  than hash!".    
-0001aaf0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001ab00: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-0001ab10: 6279 7465 7328 7369 676e 6174 7572 6529  bytes(signature)
-0001ab20: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-0001ab30: 6572 7420 6c65 6e28 7369 676e 6174 7572  ert len(signatur
-0001ab40: 6529 203d 3d20 3332 202b 2033 3220 2b20  e) == 32 + 32 + 
-0001ab50: 310a 0a20 2020 2064 6566 2074 6573 745f  1..    def test_
-0001ab60: 6574 685f 7369 676e 5f74 7970 6564 5f64  eth_sign_typed_d
-0001ab70: 6174 6128 0a20 2020 2020 2020 2073 656c  ata(.        sel
-0001ab80: 662c 0a20 2020 2020 2020 2077 333a 2022  f,.        w3: "
-0001ab90: 5765 6233 222c 0a20 2020 2020 2020 2075  Web3",.        u
-0001aba0: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
-0001abb0: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
-0001abc0: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
-0001abd0: 2020 2020 736b 6970 5f69 665f 7465 7374      skip_if_test
-0001abe0: 7270 633a 2043 616c 6c61 626c 655b 5b22  rpc: Callable[["
-0001abf0: 5765 6233 225d 2c20 4e6f 6e65 5d2c 0a20  Web3"], None],. 
-0001ac00: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0001ac10: 2020 2020 2020 7661 6c69 644a 534f 4e4d        validJSONM
-0001ac20: 6573 7361 6765 203d 2022 2222 0a20 2020  essage = """.   
-0001ac30: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-0001ac40: 2020 2020 2020 2020 2020 2022 7479 7065             "type
-0001ac50: 7322 3a20 7b0a 2020 2020 2020 2020 2020  s": {.          
-0001ac60: 2020 2020 2020 2020 2020 2245 4950 3731            "EIP71
-0001ac70: 3244 6f6d 6169 6e22 3a20 5b0a 2020 2020  2Domain": [.    
-0001ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac90: 2020 2020 7b22 6e61 6d65 223a 2022 6e61      {"name": "na
-0001aca0: 6d65 222c 2022 7479 7065 223a 2022 7374  me", "type": "st
-0001acb0: 7269 6e67 227d 2c0a 2020 2020 2020 2020  ring"},.        
-0001acc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001acd0: 7b22 6e61 6d65 223a 2022 7665 7273 696f  {"name": "versio
-0001ace0: 6e22 2c20 2274 7970 6522 3a20 2273 7472  n", "type": "str
-0001acf0: 696e 6722 7d2c 0a20 2020 2020 2020 2020  ing"},.         
-0001ad00: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0001ad10: 226e 616d 6522 3a20 2263 6861 696e 4964  "name": "chainId
-0001ad20: 222c 2022 7479 7065 223a 2022 7569 6e74  ", "type": "uint
-0001ad30: 3235 3622 7d2c 0a20 2020 2020 2020 2020  256"},.         
-0001ad40: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0001ad50: 226e 616d 6522 3a20 2276 6572 6966 7969  "name": "verifyi
-0001ad60: 6e67 436f 6e74 7261 6374 222c 2022 7479  ngContract", "ty
-0001ad70: 7065 223a 2022 6164 6472 6573 7322 7d0a  pe": "address"}.
-0001ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ad90: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
-0001ada0: 2020 2020 2020 2020 2020 2022 5065 7273             "Pers
-0001adb0: 6f6e 223a 205b 0a20 2020 2020 2020 2020  on": [.         
-0001adc0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0001add0: 226e 616d 6522 3a20 226e 616d 6522 2c20  "name": "name", 
-0001ade0: 2274 7970 6522 3a20 2273 7472 696e 6722  "type": "string"
-0001adf0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0001ae00: 2020 2020 2020 2020 2020 207b 226e 616d             {"nam
-0001ae10: 6522 3a20 2277 616c 6c65 7422 2c20 2274  e": "wallet", "t
-0001ae20: 7970 6522 3a20 2261 6464 7265 7373 227d  ype": "address"}
-0001ae30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ae40: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-0001ae50: 2020 2020 2020 2020 2020 2020 224d 6169              "Mai
-0001ae60: 6c22 3a20 5b0a 2020 2020 2020 2020 2020  l": [.          
-0001ae70: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-0001ae80: 6e61 6d65 223a 2022 6672 6f6d 222c 2022  name": "from", "
-0001ae90: 7479 7065 223a 2022 5065 7273 6f6e 227d  type": "Person"}
-0001aea0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001aeb0: 2020 2020 2020 2020 2020 7b22 6e61 6d65            {"name
-0001aec0: 223a 2022 746f 222c 2022 7479 7065 223a  ": "to", "type":
-0001aed0: 2022 5065 7273 6f6e 227d 2c0a 2020 2020   "Person"},.    
-0001aee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aef0: 2020 2020 7b22 6e61 6d65 223a 2022 636f      {"name": "co
-0001af00: 6e74 656e 7473 222c 2022 7479 7065 223a  ntents", "type":
-0001af10: 2022 7374 7269 6e67 227d 0a20 2020 2020   "string"}.     
-0001af20: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0001af30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001af40: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-0001af50: 2020 2020 2270 7269 6d61 7279 5479 7065      "primaryType
-0001af60: 223a 2022 4d61 696c 222c 0a20 2020 2020  ": "Mail",.     
-0001af70: 2020 2020 2020 2020 2020 2022 646f 6d61             "doma
-0001af80: 696e 223a 207b 0a20 2020 2020 2020 2020  in": {.         
-0001af90: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
-0001afa0: 223a 2022 4574 6865 7220 4d61 696c 222c  ": "Ether Mail",
-0001afb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001afc0: 2020 2020 2022 7665 7273 696f 6e22 3a20       "version": 
-0001afd0: 2231 222c 0a20 2020 2020 2020 2020 2020  "1",.           
-0001afe0: 2020 2020 2020 2020 2022 6368 6169 6e49           "chainI
-0001aff0: 6422 3a20 2230 7830 3122 2c0a 2020 2020  d": "0x01",.    
-0001b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b010: 2276 6572 6966 7969 6e67 436f 6e74 7261  "verifyingContra
-0001b020: 6374 223a 2022 3078 4363 4343 6363 6363  ct": "0xCcCCcccc
-0001b030: 4343 4343 6343 4343 4343 4363 4363 4363  CCCCcCCCCCCcCcCc
-0001b040: 6343 6343 4343 6343 6363 6363 6363 6343  cCcCCCcCcccccccC
-0001b050: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0001b060: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-0001b070: 2020 2020 2022 6d65 7373 6167 6522 3a20       "message": 
-0001b080: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-0001b090: 2020 2020 2020 2266 726f 6d22 3a20 7b0a        "from": {.
-0001b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b0b0: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
-0001b0c0: 2243 6f77 222c 0a20 2020 2020 2020 2020  "Cow",.         
-0001b0d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b0e0: 7761 6c6c 6574 223a 2022 3078 4344 3261  wallet": "0xCD2a
-0001b0f0: 3364 3946 3933 3845 3133 4344 3934 3745  3d9F938E13CD947E
-0001b100: 6330 3541 6243 3746 4537 3334 4466 3844  c05AbC7FE734Df8D
-0001b110: 4438 3236 220a 2020 2020 2020 2020 2020  D826".          
-0001b120: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-0001b130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b140: 2022 746f 223a 207b 0a20 2020 2020 2020   "to": {.       
-0001b150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b160: 2022 6e61 6d65 223a 2022 426f 6222 2c0a   "name": "Bob",.
-0001b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b180: 2020 2020 2020 2020 2277 616c 6c65 7422          "wallet"
-0001b190: 3a20 2230 7862 4262 4242 4242 6262 4242  : "0xbBbBBBBbbBB
-0001b1a0: 4262 6262 4262 6242 6262 6262 4242 6242  BbbbBbbBbbbbBBbB
-0001b1b0: 6262 6262 4262 4262 6242 4262 4222 0a20  bbbbBbBbbBBbB". 
-0001b1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b1d0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-0001b1e0: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-0001b1f0: 6e74 7322 3a20 2248 656c 6c6f 2c20 426f  nts": "Hello, Bo
-0001b200: 6221 220a 2020 2020 2020 2020 2020 2020  b!".            
-0001b210: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-0001b220: 2020 7d0a 2020 2020 2020 2020 2222 220a    }.        """.
-0001b230: 2020 2020 2020 2020 736b 6970 5f69 665f          skip_if_
-0001b240: 7465 7374 7270 6328 7733 290a 2020 2020  testrpc(w3).    
-0001b250: 2020 2020 7369 676e 6174 7572 6520 3d20      signature = 
-0001b260: 4865 7842 7974 6573 280a 2020 2020 2020  HexBytes(.      
-0001b270: 2020 2020 2020 7733 2e65 7468 2e73 6967        w3.eth.sig
-0001b280: 6e5f 7479 7065 645f 6461 7461 280a 2020  n_typed_data(.  
-0001b290: 2020 2020 2020 2020 2020 2020 2020 756e                un
-0001b2a0: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-0001b2b0: 7561 6c5f 7479 7065 2c20 6a73 6f6e 2e6c  ual_type, json.l
-0001b2c0: 6f61 6473 2876 616c 6964 4a53 4f4e 4d65  oads(validJSONMe
-0001b2d0: 7373 6167 6529 0a20 2020 2020 2020 2020  ssage).         
-0001b2e0: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
-0001b2f0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-0001b300: 6e28 7369 676e 6174 7572 6529 203d 3d20  n(signature) == 
-0001b310: 3332 202b 2033 3220 2b20 310a 0a20 2020  32 + 32 + 1..   
-0001b320: 2064 6566 2074 6573 745f 696e 7661 6c69   def test_invali
-0001b330: 645f 6574 685f 7369 676e 5f74 7970 6564  d_eth_sign_typed
-0001b340: 5f64 6174 6128 0a20 2020 2020 2020 2073  _data(.        s
-0001b350: 656c 662c 0a20 2020 2020 2020 2077 333a  elf,.        w3:
-0001b360: 2022 5765 6233 222c 0a20 2020 2020 2020   "Web3",.       
-0001b370: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
-0001b380: 745f 6475 616c 5f74 7970 653a 2043 6865  t_dual_type: Che
-0001b390: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
-0001b3a0: 2020 2020 2020 736b 6970 5f69 665f 7465        skip_if_te
-0001b3b0: 7374 7270 633a 2043 616c 6c61 626c 655b  strpc: Callable[
-0001b3c0: 5b22 5765 6233 225d 2c20 4e6f 6e65 5d2c  ["Web3"], None],
-0001b3d0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0001b3e0: 2020 2020 2020 2020 736b 6970 5f69 665f          skip_if_
-0001b3f0: 7465 7374 7270 6328 7733 290a 2020 2020  testrpc(w3).    
-0001b400: 2020 2020 696e 7661 6c69 645f 7479 7065      invalid_type
-0001b410: 645f 6d65 7373 6167 6520 3d20 2222 220a  d_message = """.
-0001b420: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-0001b430: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-0001b440: 7970 6573 223a 207b 0a20 2020 2020 2020  ypes": {.       
-0001b450: 2020 2020 2020 2020 2020 2020 2022 4549               "EI
-0001b460: 5037 3132 446f 6d61 696e 223a 205b 0a20  P712Domain": [. 
-0001b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b480: 2020 2020 2020 207b 226e 616d 6522 3a20         {"name": 
-0001b490: 226e 616d 6522 2c20 2274 7970 6522 3a20  "name", "type": 
-0001b4a0: 2273 7472 696e 6722 7d2c 0a20 2020 2020  "string"},.     
-0001b4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b4c0: 2020 207b 226e 616d 6522 3a20 2276 6572     {"name": "ver
-0001b4d0: 7369 6f6e 222c 2022 7479 7065 223a 2022  sion", "type": "
-0001b4e0: 7374 7269 6e67 227d 2c0a 2020 2020 2020  string"},.      
-0001b4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b500: 2020 7b22 6e61 6d65 223a 2022 6368 6169    {"name": "chai
-0001b510: 6e49 6422 2c20 2274 7970 6522 3a20 2275  nId", "type": "u
-0001b520: 696e 7432 3536 227d 2c0a 2020 2020 2020  int256"},.      
-0001b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b540: 2020 7b22 6e61 6d65 223a 2022 7665 7269    {"name": "veri
-0001b550: 6679 696e 6743 6f6e 7472 6163 7422 2c20  fyingContract", 
-0001b560: 2274 7970 6522 3a20 2261 6464 7265 7373  "type": "address
-0001b570: 227d 0a20 2020 2020 2020 2020 2020 2020  "}.             
-0001b580: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-0001b590: 2020 2020 2020 2020 2020 2020 2020 2250                "P
-0001b5a0: 6572 736f 6e22 3a20 5b0a 2020 2020 2020  erson": [.      
-0001b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b5c0: 2020 7b22 6e61 6d65 223a 2022 6e61 6d65    {"name": "name
-0001b5d0: 222c 2022 7479 7065 223a 2022 7374 7269  ", "type": "stri
-0001b5e0: 6e67 227d 2c0a 2020 2020 2020 2020 2020  ng"},.          
-0001b5f0: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-0001b600: 6e61 6d65 223a 2022 7761 6c6c 6574 222c  name": "wallet",
-0001b610: 2022 7479 7065 223a 2022 6164 6472 6573   "type": "addres
-0001b620: 7322 7d0a 2020 2020 2020 2020 2020 2020  s"}.            
-0001b630: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-0001b640: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b650: 4d61 696c 223a 205b 0a20 2020 2020 2020  Mail": [.       
-0001b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b670: 207b 226e 616d 6522 3a20 2266 726f 6d22   {"name": "from"
-0001b680: 2c20 2274 7970 6522 3a20 2250 6572 736f  , "type": "Perso
-0001b690: 6e22 7d2c 0a20 2020 2020 2020 2020 2020  n"},.           
-0001b6a0: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
-0001b6b0: 616d 6522 3a20 2274 6f22 2c20 2274 7970  ame": "to", "typ
-0001b6c0: 6522 3a20 2250 6572 736f 6e5b 325d 227d  e": "Person[2]"}
-0001b6d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001b6e0: 2020 2020 2020 2020 2020 7b22 6e61 6d65            {"name
-0001b6f0: 223a 2022 636f 6e74 656e 7473 222c 2022  ": "contents", "
-0001b700: 7479 7065 223a 2022 7374 7269 6e67 227d  type": "string"}
-0001b710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b720: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-0001b730: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-0001b740: 2020 2020 2020 2020 2020 2270 7269 6d61            "prima
-0001b750: 7279 5479 7065 223a 2022 4d61 696c 222c  ryType": "Mail",
-0001b760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b770: 2022 646f 6d61 696e 223a 207b 0a20 2020   "domain": {.   
-0001b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b790: 2022 6e61 6d65 223a 2022 4574 6865 7220   "name": "Ether 
-0001b7a0: 4d61 696c 222c 0a20 2020 2020 2020 2020  Mail",.         
-0001b7b0: 2020 2020 2020 2020 2020 2022 7665 7273             "vers
-0001b7c0: 696f 6e22 3a20 2231 222c 0a20 2020 2020  ion": "1",.     
-0001b7d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b7e0: 6368 6169 6e49 6422 3a20 2230 7830 3122  chainId": "0x01"
-0001b7f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001b800: 2020 2020 2020 2276 6572 6966 7969 6e67        "verifying
-0001b810: 436f 6e74 7261 6374 223a 2022 3078 4363  Contract": "0xCc
-0001b820: 4343 6363 6363 4343 4343 6343 4343 4343  CCccccCCCCcCCCCC
-0001b830: 4363 4363 4363 6343 6343 4343 6343 6363  CcCcCccCcCCCcCcc
-0001b840: 6363 6363 6343 220a 2020 2020 2020 2020  cccccC".        
-0001b850: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0001b860: 2020 2020 2020 2020 2020 2022 6d65 7373             "mess
-0001b870: 6167 6522 3a20 7b0a 2020 2020 2020 2020  age": {.        
-0001b880: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-0001b890: 6d22 3a20 7b0a 2020 2020 2020 2020 2020  m": {.          
-0001b8a0: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-0001b8b0: 616d 6522 3a20 2243 6f77 222c 0a20 2020  ame": "Cow",.   
-0001b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b8d0: 2020 2020 2022 7761 6c6c 6574 223a 2022       "wallet": "
-0001b8e0: 3078 4344 3261 3364 3946 3933 3845 3133  0xCD2a3d9F938E13
-0001b8f0: 4344 3934 3745 6330 3541 6243 3746 4537  CD947Ec05AbC7FE7
-0001b900: 3334 4466 3844 4438 3236 220a 2020 2020  34Df8DD826".    
+00018f30: 3038 220a 2020 2020 2020 2020 290a 2020  08".        ).  
+00018f40: 2020 2020 2020 6173 7365 7274 2062 7974        assert byt
+00018f50: 6573 2873 6c6f 745f 345b 3a34 5d29 203d  es(slot_4[:4]) =
+00018f60: 3d20 6222 666f 7572 220a 0a20 2020 2064  = b"four"..    d
+00018f70: 6566 2074 6573 745f 6574 685f 6765 745f  ef test_eth_get_
+00018f80: 7374 6f72 6167 655f 6174 5f65 6e73 5f6e  storage_at_ens_n
+00018f90: 616d 6528 0a20 2020 2020 2020 2073 656c  ame(.        sel
+00018fa0: 662c 2077 333a 2022 5765 6233 222c 2073  f, w3: "Web3", s
+00018fb0: 746f 7261 6765 5f63 6f6e 7472 6163 743a  torage_contract:
+00018fc0: 2022 436f 6e74 7261 6374 220a 2020 2020   "Contract".    
+00018fd0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00018fe0: 2020 2077 6974 6820 656e 735f 6164 6472     with ens_addr
+00018ff0: 6573 7365 7328 7733 2c20 7b22 7374 6f72  esses(w3, {"stor
+00019000: 6167 652e 6574 6822 3a20 7374 6f72 6167  age.eth": storag
+00019010: 655f 636f 6e74 7261 6374 2e61 6464 7265  e_contract.addre
+00019020: 7373 7d29 3a0a 2020 2020 2020 2020 2020  ss}):.          
+00019030: 2020 7374 6f72 6167 6520 3d20 7733 2e65    storage = w3.e
+00019040: 7468 2e67 6574 5f73 746f 7261 6765 5f61  th.get_storage_a
+00019050: 7428 454e 5328 2273 746f 7261 6765 2e65  t(ENS("storage.e
+00019060: 7468 2229 2c20 3129 0a20 2020 2020 2020  th"), 1).       
+00019070: 2020 2020 2061 7373 6572 7420 7374 6f72       assert stor
+00019080: 6167 6520 3d3d 2048 6578 4279 7465 7328  age == HexBytes(
+00019090: 6622 3078 7b27 3030 2720 2a20 3331 7d30  f"0x{'00' * 31}0
+000190a0: 3122 290a 0a20 2020 2064 6566 2074 6573  1")..    def tes
+000190b0: 745f 6574 685f 6765 745f 7374 6f72 6167  t_eth_get_storag
+000190c0: 655f 6174 5f69 6e76 616c 6964 5f61 6464  e_at_invalid_add
+000190d0: 7265 7373 2873 656c 662c 2077 333a 2022  ress(self, w3: "
+000190e0: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
+000190f0: 2020 2020 2020 2020 636f 696e 6261 7365          coinbase
+00019100: 203d 2077 332e 6574 682e 636f 696e 6261   = w3.eth.coinba
+00019110: 7365 0a20 2020 2020 2020 2077 6974 6820  se.        with 
+00019120: 7079 7465 7374 2e72 6169 7365 7328 496e  pytest.raises(In
+00019130: 7661 6c69 6441 6464 7265 7373 293a 0a20  validAddress):. 
+00019140: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
+00019150: 682e 6765 745f 7374 6f72 6167 655f 6174  h.get_storage_at
+00019160: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00019170: 2020 4368 6563 6b73 756d 4164 6472 6573    ChecksumAddres
+00019180: 7328 4865 7841 6464 7265 7373 2848 6578  s(HexAddress(Hex
+00019190: 5374 7228 636f 696e 6261 7365 2e6c 6f77  Str(coinbase.low
+000191a0: 6572 2829 2929 292c 2030 0a20 2020 2020  er()))), 0.     
+000191b0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+000191c0: 6620 7465 7374 5f65 7468 5f67 6574 5f74  f test_eth_get_t
+000191d0: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
+000191e0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+000191f0: 7733 3a20 2257 6562 3322 2c20 756e 6c6f  w3: "Web3", unlo
+00019200: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+00019210: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
+00019220: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
+00019230: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+00019240: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
+00019250: 203d 2077 332e 6574 682e 6765 745f 7472   = w3.eth.get_tr
+00019260: 616e 7361 6374 696f 6e5f 636f 756e 7428  ansaction_count(
+00019270: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+00019280: 5f64 7561 6c5f 7479 7065 290a 2020 2020  _dual_type).    
+00019290: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
+000192a0: 7465 6765 7228 7472 616e 7361 6374 696f  teger(transactio
+000192b0: 6e5f 636f 756e 7429 0a20 2020 2020 2020  n_count).       
+000192c0: 2061 7373 6572 7420 7472 616e 7361 6374   assert transact
+000192d0: 696f 6e5f 636f 756e 7420 3e3d 2030 0a0a  ion_count >= 0..
+000192e0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+000192f0: 5f67 6574 5f74 7261 6e73 6163 7469 6f6e  _get_transaction
+00019300: 5f63 6f75 6e74 5f65 6e73 5f6e 616d 6528  _count_ens_name(
+00019310: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+00019320: 333a 2022 5765 6233 222c 2075 6e6c 6f63  3: "Web3", unloc
+00019330: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+00019340: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+00019350: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
+00019360: 4e6f 6e65 3a0a 2020 2020 2020 2020 7769  None:.        wi
+00019370: 7468 2065 6e73 5f61 6464 7265 7373 6573  th ens_addresses
+00019380: 280a 2020 2020 2020 2020 2020 2020 7733  (.            w3
+00019390: 2c20 7b22 756e 6c6f 636b 6564 2d61 6363  , {"unlocked-acc
+000193a0: 742d 6475 616c 2d74 7970 652e 6574 6822  t-dual-type.eth"
+000193b0: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
+000193c0: 6e74 5f64 7561 6c5f 7479 7065 7d0a 2020  nt_dual_type}.  
+000193d0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+000193e0: 2020 2020 2074 7261 6e73 6163 7469 6f6e       transaction
+000193f0: 5f63 6f75 6e74 203d 2077 332e 6574 682e  _count = w3.eth.
+00019400: 6765 745f 7472 616e 7361 6374 696f 6e5f  get_transaction_
+00019410: 636f 756e 7428 0a20 2020 2020 2020 2020  count(.         
+00019420: 2020 2020 2020 2045 4e53 2822 756e 6c6f         ENS("unlo
+00019430: 636b 6564 2d61 6363 742d 6475 616c 2d74  cked-acct-dual-t
+00019440: 7970 652e 6574 6822 290a 2020 2020 2020  ype.eth").      
+00019450: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00019460: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
+00019470: 7465 6765 7228 7472 616e 7361 6374 696f  teger(transactio
+00019480: 6e5f 636f 756e 7429 0a20 2020 2020 2020  n_count).       
+00019490: 2020 2020 2061 7373 6572 7420 7472 616e       assert tran
+000194a0: 7361 6374 696f 6e5f 636f 756e 7420 3e3d  saction_count >=
+000194b0: 2030 0a0a 2020 2020 6465 6620 7465 7374   0..    def test
+000194c0: 5f65 7468 5f67 6574 5f74 7261 6e73 6163  _eth_get_transac
+000194d0: 7469 6f6e 5f63 6f75 6e74 5f69 6e76 616c  tion_count_inval
+000194e0: 6964 5f61 6464 7265 7373 2873 656c 662c  id_address(self,
+000194f0: 2077 333a 2022 5765 6233 2229 202d 3e20   w3: "Web3") -> 
+00019500: 4e6f 6e65 3a0a 2020 2020 2020 2020 636f  None:.        co
+00019510: 696e 6261 7365 203d 2077 332e 6574 682e  inbase = w3.eth.
+00019520: 636f 696e 6261 7365 0a20 2020 2020 2020  coinbase.       
+00019530: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+00019540: 7365 7328 496e 7661 6c69 6441 6464 7265  ses(InvalidAddre
+00019550: 7373 293a 0a20 2020 2020 2020 2020 2020  ss):.           
+00019560: 2077 332e 6574 682e 6765 745f 7472 616e   w3.eth.get_tran
+00019570: 7361 6374 696f 6e5f 636f 756e 7428 0a20  saction_count(. 
+00019580: 2020 2020 2020 2020 2020 2020 2020 2043                 C
+00019590: 6865 636b 7375 6d41 6464 7265 7373 2848  hecksumAddress(H
+000195a0: 6578 4164 6472 6573 7328 4865 7853 7472  exAddress(HexStr
+000195b0: 2863 6f69 6e62 6173 652e 6c6f 7765 7228  (coinbase.lower(
+000195c0: 2929 2929 0a20 2020 2020 2020 2020 2020  )))).           
+000195d0: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
+000195e0: 5f65 7468 5f67 6574 426c 6f63 6b54 7261  _eth_getBlockTra
+000195f0: 6e73 6163 7469 6f6e 436f 756e 7442 7948  nsactionCountByH
+00019600: 6173 685f 656d 7074 795f 626c 6f63 6b28  ash_empty_block(
+00019610: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+00019620: 333a 2022 5765 6233 222c 2065 6d70 7479  3: "Web3", empty
+00019630: 5f62 6c6f 636b 3a20 426c 6f63 6b44 6174  _block: BlockDat
+00019640: 610a 2020 2020 2920 2d3e 204e 6f6e 653a  a.    ) -> None:
+00019650: 0a20 2020 2020 2020 2074 7261 6e73 6163  .        transac
+00019660: 7469 6f6e 5f63 6f75 6e74 203d 2077 332e  tion_count = w3.
+00019670: 6574 682e 6765 745f 626c 6f63 6b5f 7472  eth.get_block_tr
+00019680: 616e 7361 6374 696f 6e5f 636f 756e 7428  ansaction_count(
+00019690: 656d 7074 795f 626c 6f63 6b5b 2268 6173  empty_block["has
+000196a0: 6822 5d29 0a0a 2020 2020 2020 2020 6173  h"])..        as
+000196b0: 7365 7274 2069 735f 696e 7465 6765 7228  sert is_integer(
+000196c0: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
+000196d0: 7429 0a20 2020 2020 2020 2061 7373 6572  t).        asser
+000196e0: 7420 7472 616e 7361 6374 696f 6e5f 636f  t transaction_co
+000196f0: 756e 7420 3d3d 2030 0a0a 2020 2020 6465  unt == 0..    de
+00019700: 6620 7465 7374 5f65 7468 5f67 6574 426c  f test_eth_getBl
+00019710: 6f63 6b54 7261 6e73 6163 7469 6f6e 436f  ockTransactionCo
+00019720: 756e 7442 794e 756d 6265 725f 656d 7074  untByNumber_empt
+00019730: 795f 626c 6f63 6b28 0a20 2020 2020 2020  y_block(.       
+00019740: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
+00019750: 222c 2065 6d70 7479 5f62 6c6f 636b 3a20  ", empty_block: 
+00019760: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
+00019770: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00019780: 2074 7261 6e73 6163 7469 6f6e 5f63 6f75   transaction_cou
+00019790: 6e74 203d 2077 332e 6574 682e 6765 745f  nt = w3.eth.get_
+000197a0: 626c 6f63 6b5f 7472 616e 7361 6374 696f  block_transactio
+000197b0: 6e5f 636f 756e 7428 656d 7074 795f 626c  n_count(empty_bl
+000197c0: 6f63 6b5b 226e 756d 6265 7222 5d29 0a0a  ock["number"])..
+000197d0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+000197e0: 735f 696e 7465 6765 7228 7472 616e 7361  s_integer(transa
+000197f0: 6374 696f 6e5f 636f 756e 7429 0a20 2020  ction_count).   
+00019800: 2020 2020 2061 7373 6572 7420 7472 616e       assert tran
+00019810: 7361 6374 696f 6e5f 636f 756e 7420 3d3d  saction_count ==
+00019820: 2030 0a0a 2020 2020 6465 6620 7465 7374   0..    def test
+00019830: 5f65 7468 5f67 6574 426c 6f63 6b54 7261  _eth_getBlockTra
+00019840: 6e73 6163 7469 6f6e 436f 756e 7442 7948  nsactionCountByH
+00019850: 6173 685f 626c 6f63 6b5f 7769 7468 5f74  ash_block_with_t
+00019860: 786e 280a 2020 2020 2020 2020 7365 6c66  xn(.        self
+00019870: 2c20 7733 3a20 2257 6562 3322 2c20 626c  , w3: "Web3", bl
+00019880: 6f63 6b5f 7769 7468 5f74 786e 3a20 426c  ock_with_txn: Bl
+00019890: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+000198a0: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+000198b0: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
+000198c0: 203d 2077 332e 6574 682e 6765 745f 626c   = w3.eth.get_bl
+000198d0: 6f63 6b5f 7472 616e 7361 6374 696f 6e5f  ock_transaction_
+000198e0: 636f 756e 7428 626c 6f63 6b5f 7769 7468  count(block_with
+000198f0: 5f74 786e 5b22 6861 7368 225d 290a 0a20  _txn["hash"]).. 
+00019900: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00019910: 5f69 6e74 6567 6572 2874 7261 6e73 6163  _integer(transac
+00019920: 7469 6f6e 5f63 6f75 6e74 290a 2020 2020  tion_count).    
+00019930: 2020 2020 6173 7365 7274 2074 7261 6e73      assert trans
+00019940: 6163 7469 6f6e 5f63 6f75 6e74 203e 3d20  action_count >= 
+00019950: 310a 0a20 2020 2064 6566 2074 6573 745f  1..    def test_
+00019960: 6574 685f 6765 7442 6c6f 636b 5472 616e  eth_getBlockTran
+00019970: 7361 6374 696f 6e43 6f75 6e74 4279 4e75  sactionCountByNu
+00019980: 6d62 6572 5f62 6c6f 636b 5f77 6974 685f  mber_block_with_
+00019990: 7478 6e28 0a20 2020 2020 2020 2073 656c  txn(.        sel
+000199a0: 662c 2077 333a 2022 5765 6233 222c 2062  f, w3: "Web3", b
+000199b0: 6c6f 636b 5f77 6974 685f 7478 6e3a 2042  lock_with_txn: B
+000199c0: 6c6f 636b 4461 7461 0a20 2020 2029 202d  lockData.    ) -
+000199d0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+000199e0: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
+000199f0: 7420 3d20 7733 2e65 7468 2e67 6574 5f62  t = w3.eth.get_b
+00019a00: 6c6f 636b 5f74 7261 6e73 6163 7469 6f6e  lock_transaction
+00019a10: 5f63 6f75 6e74 2862 6c6f 636b 5f77 6974  _count(block_wit
+00019a20: 685f 7478 6e5b 226e 756d 6265 7222 5d29  h_txn["number"])
+00019a30: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+00019a40: 2069 735f 696e 7465 6765 7228 7472 616e   is_integer(tran
+00019a50: 7361 6374 696f 6e5f 636f 756e 7429 0a20  saction_count). 
+00019a60: 2020 2020 2020 2061 7373 6572 7420 7472         assert tr
+00019a70: 616e 7361 6374 696f 6e5f 636f 756e 7420  ansaction_count 
+00019a80: 3e3d 2031 0a0a 2020 2020 6465 6620 7465  >= 1..    def te
+00019a90: 7374 5f65 7468 5f67 6574 556e 636c 6543  st_eth_getUncleC
+00019aa0: 6f75 6e74 4279 426c 6f63 6b48 6173 6828  ountByBlockHash(
+00019ab0: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+00019ac0: 333a 2022 5765 6233 222c 2065 6d70 7479  3: "Web3", empty
+00019ad0: 5f62 6c6f 636b 3a20 426c 6f63 6b44 6174  _block: BlockDat
+00019ae0: 610a 2020 2020 2920 2d3e 204e 6f6e 653a  a.    ) -> None:
+00019af0: 0a20 2020 2020 2020 2075 6e63 6c65 5f63  .        uncle_c
+00019b00: 6f75 6e74 203d 2077 332e 6574 682e 6765  ount = w3.eth.ge
+00019b10: 745f 756e 636c 655f 636f 756e 7428 656d  t_uncle_count(em
+00019b20: 7074 795f 626c 6f63 6b5b 2268 6173 6822  pty_block["hash"
+00019b30: 5d29 0a0a 2020 2020 2020 2020 6173 7365  ])..        asse
+00019b40: 7274 2069 735f 696e 7465 6765 7228 756e  rt is_integer(un
+00019b50: 636c 655f 636f 756e 7429 0a20 2020 2020  cle_count).     
+00019b60: 2020 2061 7373 6572 7420 756e 636c 655f     assert uncle_
+00019b70: 636f 756e 7420 3d3d 2030 0a0a 2020 2020  count == 0..    
+00019b80: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
+00019b90: 556e 636c 6543 6f75 6e74 4279 426c 6f63  UncleCountByBloc
+00019ba0: 6b4e 756d 6265 7228 0a20 2020 2020 2020  kNumber(.       
+00019bb0: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
+00019bc0: 222c 2065 6d70 7479 5f62 6c6f 636b 3a20  ", empty_block: 
+00019bd0: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
+00019be0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00019bf0: 2075 6e63 6c65 5f63 6f75 6e74 203d 2077   uncle_count = w
+00019c00: 332e 6574 682e 6765 745f 756e 636c 655f  3.eth.get_uncle_
+00019c10: 636f 756e 7428 656d 7074 795f 626c 6f63  count(empty_bloc
+00019c20: 6b5b 226e 756d 6265 7222 5d29 0a0a 2020  k["number"])..  
+00019c30: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+00019c40: 696e 7465 6765 7228 756e 636c 655f 636f  integer(uncle_co
+00019c50: 756e 7429 0a20 2020 2020 2020 2061 7373  unt).        ass
+00019c60: 6572 7420 756e 636c 655f 636f 756e 7420  ert uncle_count 
+00019c70: 3d3d 2030 0a0a 2020 2020 6465 6620 7465  == 0..    def te
+00019c80: 7374 5f65 7468 5f67 6574 5f63 6f64 6528  st_eth_get_code(
+00019c90: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+00019ca0: 333a 2022 5765 6233 222c 206d 6174 685f  3: "Web3", math_
+00019cb0: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
+00019cc0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+00019cd0: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
+00019ce0: 0a20 2020 2020 2020 2063 6f64 6520 3d20  .        code = 
+00019cf0: 7733 2e65 7468 2e67 6574 5f63 6f64 6528  w3.eth.get_code(
+00019d00: 6d61 7468 5f63 6f6e 7472 6163 745f 6164  math_contract_ad
+00019d10: 6472 6573 7329 0a20 2020 2020 2020 2061  dress).        a
+00019d20: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
+00019d30: 2863 6f64 652c 2048 6578 4279 7465 7329  (code, HexBytes)
+00019d40: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00019d50: 6c65 6e28 636f 6465 2920 3e20 300a 0a20  len(code) > 0.. 
+00019d60: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+00019d70: 6765 745f 636f 6465 5f65 6e73 5f61 6464  get_code_ens_add
+00019d80: 7265 7373 280a 2020 2020 2020 2020 7365  ress(.        se
+00019d90: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+00019da0: 6d61 7468 5f63 6f6e 7472 6163 745f 6164  math_contract_ad
+00019db0: 6472 6573 733a 2043 6865 636b 7375 6d41  dress: ChecksumA
+00019dc0: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
+00019dd0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7769  None:.        wi
+00019de0: 7468 2065 6e73 5f61 6464 7265 7373 6573  th ens_addresses
+00019df0: 2877 332c 207b 226d 6174 6863 6f6e 7472  (w3, {"mathcontr
+00019e00: 6163 742e 6574 6822 3a20 6d61 7468 5f63  act.eth": math_c
+00019e10: 6f6e 7472 6163 745f 6164 6472 6573 737d  ontract_address}
+00019e20: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
+00019e30: 6f64 6520 3d20 7733 2e65 7468 2e67 6574  ode = w3.eth.get
+00019e40: 5f63 6f64 6528 454e 5328 226d 6174 6863  _code(ENS("mathc
+00019e50: 6f6e 7472 6163 742e 6574 6822 2929 0a20  ontract.eth")). 
+00019e60: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00019e70: 7420 6973 696e 7374 616e 6365 2863 6f64  t isinstance(cod
+00019e80: 652c 2048 6578 4279 7465 7329 0a20 2020  e, HexBytes).   
+00019e90: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+00019ea0: 6c65 6e28 636f 6465 2920 3e20 300a 0a20  len(code) > 0.. 
+00019eb0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+00019ec0: 6765 745f 636f 6465 5f69 6e76 616c 6964  get_code_invalid
+00019ed0: 5f61 6464 7265 7373 280a 2020 2020 2020  _address(.      
+00019ee0: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+00019ef0: 3322 2c20 6d61 7468 5f63 6f6e 7472 6163  3", math_contrac
+00019f00: 743a 2022 436f 6e74 7261 6374 220a 2020  t: "Contract".  
+00019f10: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00019f20: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+00019f30: 2e72 6169 7365 7328 496e 7661 6c69 6441  .raises(InvalidA
+00019f40: 6464 7265 7373 293a 0a20 2020 2020 2020  ddress):.       
+00019f50: 2020 2020 2077 332e 6574 682e 6765 745f       w3.eth.get_
+00019f60: 636f 6465 280a 2020 2020 2020 2020 2020  code(.          
+00019f70: 2020 2020 2020 4368 6563 6b73 756d 4164        ChecksumAd
+00019f80: 6472 6573 7328 4865 7841 6464 7265 7373  dress(HexAddress
+00019f90: 2848 6578 5374 7228 6d61 7468 5f63 6f6e  (HexStr(math_con
+00019fa0: 7472 6163 742e 6164 6472 6573 732e 6c6f  tract.address.lo
+00019fb0: 7765 7228 2929 2929 0a20 2020 2020 2020  wer()))).       
+00019fc0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00019fd0: 7465 7374 5f65 7468 5f67 6574 5f63 6f64  test_eth_get_cod
+00019fe0: 655f 7769 7468 5f62 6c6f 636b 5f69 6465  e_with_block_ide
+00019ff0: 6e74 6966 6965 7228 0a20 2020 2020 2020  ntifier(.       
+0001a000: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
+0001a010: 222c 2065 6d69 7474 6572 5f63 6f6e 7472  ", emitter_contr
+0001a020: 6163 743a 2022 436f 6e74 7261 6374 220a  act: "Contract".
+0001a030: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0001a040: 2020 2020 2020 2063 6f64 6520 3d20 7733         code = w3
+0001a050: 2e65 7468 2e67 6574 5f63 6f64 6528 0a20  .eth.get_code(. 
+0001a060: 2020 2020 2020 2020 2020 2065 6d69 7474             emitt
+0001a070: 6572 5f63 6f6e 7472 6163 742e 6164 6472  er_contract.addr
+0001a080: 6573 732c 2062 6c6f 636b 5f69 6465 6e74  ess, block_ident
+0001a090: 6966 6965 723d 7733 2e65 7468 2e62 6c6f  ifier=w3.eth.blo
+0001a0a0: 636b 5f6e 756d 6265 720a 2020 2020 2020  ck_number.      
+0001a0b0: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
+0001a0c0: 7274 2069 7369 6e73 7461 6e63 6528 636f  rt isinstance(co
+0001a0d0: 6465 2c20 4865 7842 7974 6573 290a 2020  de, HexBytes).  
+0001a0e0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+0001a0f0: 2863 6f64 6529 203e 2030 0a0a 2020 2020  (code) > 0..    
+0001a100: 6465 6620 7465 7374 5f65 7468 5f63 7265  def test_eth_cre
+0001a110: 6174 655f 6163 6365 7373 5f6c 6973 7428  ate_access_list(
+0001a120: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0001a130: 2020 2020 2020 2077 333a 2022 5765 6233         w3: "Web3
+0001a140: 222c 0a20 2020 2020 2020 2075 6e6c 6f63  ",.        unloc
+0001a150: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+0001a160: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+0001a170: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+0001a180: 6d61 7468 5f63 6f6e 7472 6163 743a 2022  math_contract: "
+0001a190: 436f 6e74 7261 6374 222c 0a20 2020 2029  Contract",.    )
+0001a1a0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0001a1b0: 2020 2320 6275 696c 6420 7478 6e0a 2020    # build txn.  
+0001a1c0: 2020 2020 2020 7478 6e20 3d20 6d61 7468        txn = math
+0001a1d0: 5f63 6f6e 7472 6163 742e 6675 6e63 7469  _contract.functi
+0001a1e0: 6f6e 732e 696e 6372 656d 656e 7443 6f75  ons.incrementCou
+0001a1f0: 6e74 6572 2831 292e 6275 696c 645f 7472  nter(1).build_tr
+0001a200: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+0001a210: 2020 2020 2020 207b 2266 726f 6d22 3a20         {"from": 
+0001a220: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+0001a230: 5f64 7561 6c5f 7479 7065 7d0a 2020 2020  _dual_type}.    
+0001a240: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
+0001a250: 2063 7265 6174 6520 6163 6365 7373 206c   create access l
+0001a260: 6973 740a 2020 2020 2020 2020 7265 7370  ist.        resp
+0001a270: 6f6e 7365 203d 2077 332e 6574 682e 6372  onse = w3.eth.cr
+0001a280: 6561 7465 5f61 6363 6573 735f 6c69 7374  eate_access_list
+0001a290: 2874 786e 290a 0a20 2020 2020 2020 2061  (txn)..        a
+0001a2a0: 7373 6572 7420 6973 5f64 6963 7428 7265  ssert is_dict(re
+0001a2b0: 7370 6f6e 7365 290a 2020 2020 2020 2020  sponse).        
+0001a2c0: 6163 6365 7373 5f6c 6973 7420 3d20 7265  access_list = re
+0001a2d0: 7370 6f6e 7365 5b22 6163 6365 7373 4c69  sponse["accessLi
+0001a2e0: 7374 225d 0a20 2020 2020 2020 2061 7373  st"].        ass
+0001a2f0: 6572 7420 6c65 6e28 6163 6365 7373 5f6c  ert len(access_l
+0001a300: 6973 7429 203e 2030 0a20 2020 2020 2020  ist) > 0.       
+0001a310: 2061 7373 6572 7420 6163 6365 7373 5f6c   assert access_l
+0001a320: 6973 745b 305d 5b22 6164 6472 6573 7322  ist[0]["address"
+0001a330: 5d20 6973 206e 6f74 204e 6f6e 650a 2020  ] is not None.  
+0001a340: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+0001a350: 6368 6563 6b73 756d 5f61 6464 7265 7373  checksum_address
+0001a360: 2861 6363 6573 735f 6c69 7374 5b30 5d5b  (access_list[0][
+0001a370: 2261 6464 7265 7373 225d 290a 2020 2020  "address"]).    
+0001a380: 2020 2020 6173 7365 7274 206c 656e 2861      assert len(a
+0001a390: 6363 6573 735f 6c69 7374 5b30 5d5b 2273  ccess_list[0]["s
+0001a3a0: 746f 7261 6765 4b65 7973 225d 5b30 5d29  torageKeys"][0])
+0001a3b0: 203d 3d20 3332 0a20 2020 2020 2020 2061   == 32.        a
+0001a3c0: 7373 6572 7420 696e 7428 7265 7370 6f6e  ssert int(respon
+0001a3d0: 7365 5b22 6761 7355 7365 6422 5d29 203e  se["gasUsed"]) >
+0001a3e0: 3d20 300a 0a20 2020 2020 2020 2023 2061  = 0..        # a
+0001a3f0: 7373 6572 7420 7468 6520 7265 7375 6c74  ssert the result
+0001a400: 2063 616e 2062 6520 7573 6564 2064 6972   can be used dir
+0001a410: 6563 746c 7920 696e 2061 2074 7261 6e73  ectly in a trans
+0001a420: 6163 7469 6f6e 2064 6963 740a 2020 2020  action dict.    
+0001a430: 2020 2020 7478 6e5b 2261 6363 6573 734c      txn["accessL
+0001a440: 6973 7422 5d20 3d20 7265 7370 6f6e 7365  ist"] = response
+0001a450: 5b22 6163 6365 7373 4c69 7374 225d 0a20  ["accessList"]. 
+0001a460: 2020 2020 2020 2074 786e 5b22 6761 7322         txn["gas"
+0001a470: 5d20 3d20 7265 7370 6f6e 7365 5b22 6761  ] = response["ga
+0001a480: 7355 7365 6422 5d0a 0a20 2020 2020 2020  sUsed"]..       
+0001a490: 2023 2073 656e 6420 7478 6e20 7769 7468   # send txn with
+0001a4a0: 2061 6363 6573 7320 6c69 7374 0a20 2020   access list.   
+0001a4b0: 2020 2020 2077 332e 6574 682e 7365 6e64       w3.eth.send
+0001a4c0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+0001a4d0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+0001a4e0: 6574 685f 7369 676e 280a 2020 2020 2020  eth_sign(.      
+0001a4f0: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+0001a500: 3322 2c20 756e 6c6f 636b 6564 5f61 6363  3", unlocked_acc
+0001a510: 6f75 6e74 5f64 7561 6c5f 7479 7065 3a20  ount_dual_type: 
+0001a520: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
+0001a530: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0001a540: 2020 2020 2020 2073 6967 6e61 7475 7265         signature
+0001a550: 203d 2077 332e 6574 682e 7369 676e 280a   = w3.eth.sign(.
+0001a560: 2020 2020 2020 2020 2020 2020 756e 6c6f              unlo
+0001a570: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+0001a580: 6c5f 7479 7065 2c20 7465 7874 3d22 4d65  l_type, text="Me
+0001a590: 7373 6167 6520 74c3 b620 7369 676e 2e20  ssage t.. sign. 
+0001a5a0: 4c6f 6e67 6572 2074 6861 6e20 6861 7368  Longer than hash
+0001a5b0: 2122 0a20 2020 2020 2020 2029 0a20 2020  !".        ).   
+0001a5c0: 2020 2020 2061 7373 6572 7420 6973 5f62       assert is_b
+0001a5d0: 7974 6573 2873 6967 6e61 7475 7265 290a  ytes(signature).
+0001a5e0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+0001a5f0: 656e 2873 6967 6e61 7475 7265 2920 3d3d  en(signature) ==
+0001a600: 2033 3220 2b20 3332 202b 2031 0a0a 2020   32 + 32 + 1..  
+0001a610: 2020 2020 2020 2320 7465 7374 206f 7468        # test oth
+0001a620: 6572 2066 6f72 6d61 7473 0a20 2020 2020  er formats.     
+0001a630: 2020 2068 6578 7369 676e 203d 2077 332e     hexsign = w3.
+0001a640: 6574 682e 7369 676e 280a 2020 2020 2020  eth.sign(.      
+0001a650: 2020 2020 2020 756e 6c6f 636b 6564 5f61        unlocked_a
+0001a660: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
+0001a670: 2c0a 2020 2020 2020 2020 2020 2020 6865  ,.            he
+0001a680: 7873 7472 3d48 6578 5374 7228 0a20 2020  xstr=HexStr(.   
+0001a690: 2020 2020 2020 2020 2020 2020 2022 3078               "0x
+0001a6a0: 3464 3635 3733 3733 3631 3637 3635 3230  4d65737361676520
+0001a6b0: 3734 6333 6236 3230 3733 3639 3637 3665  74c3b6207369676e
+0001a6c0: 3265 3230 3463 3666 3665 3637 3635 3732  2e204c6f6e676572
+0001a6d0: 3230 3734 3638 3631 3665 3230 3638 3631  207468616e206861
+0001a6e0: 3733 3638 3231 2220 2023 206e 6f71 613a  736821"  # noqa:
+0001a6f0: 2045 3530 310a 2020 2020 2020 2020 2020   E501.          
+0001a700: 2020 292c 0a20 2020 2020 2020 2029 0a20    ),.        ). 
+0001a710: 2020 2020 2020 2061 7373 6572 7420 6865         assert he
+0001a720: 7873 6967 6e20 3d3d 2073 6967 6e61 7475  xsign == signatu
+0001a730: 7265 0a0a 2020 2020 2020 2020 696e 7473  re..        ints
+0001a740: 6967 6e20 3d20 7733 2e65 7468 2e73 6967  ign = w3.eth.sig
+0001a750: 6e28 0a20 2020 2020 2020 2020 2020 2075  n(.            u
+0001a760: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+0001a770: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+0001a780: 2020 2020 2020 2030 7834 4436 3537 3337         0x4D65737
+0001a790: 3336 3136 3736 3532 3037 3443 3342 3632  36167652074C3B62
+0001a7a0: 3037 3336 3936 3736 4532 4532 3034 4336  07369676E2E204C6
+0001a7b0: 4636 4536 3736 3537 3232 3037 3436 3836  F6E6765722074686
+0001a7c0: 3136 4532 3036 3836 3137 3336 3832 312c  16E206861736821,
+0001a7d0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0001a7e0: 2020 2061 7373 6572 7420 696e 7473 6967     assert intsig
+0001a7f0: 6e20 3d3d 2073 6967 6e61 7475 7265 0a0a  n == signature..
+0001a800: 2020 2020 2020 2020 6279 7465 7373 6967          bytessig
+0001a810: 6e20 3d20 7733 2e65 7468 2e73 6967 6e28  n = w3.eth.sign(
+0001a820: 0a20 2020 2020 2020 2020 2020 2075 6e6c  .            unl
+0001a830: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+0001a840: 616c 5f74 7970 652c 2062 224d 6573 7361  al_type, b"Messa
+0001a850: 6765 2074 5c78 6333 5c78 6236 2073 6967  ge t\xc3\xb6 sig
+0001a860: 6e2e 204c 6f6e 6765 7220 7468 616e 2068  n. Longer than h
+0001a870: 6173 6821 220a 2020 2020 2020 2020 290a  ash!".        ).
+0001a880: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
+0001a890: 7974 6573 7369 676e 203d 3d20 7369 676e  ytessign == sign
+0001a8a0: 6174 7572 650a 0a20 2020 2020 2020 206e  ature..        n
+0001a8b0: 6577 5f73 6967 6e61 7475 7265 203d 2077  ew_signature = w
+0001a8c0: 332e 6574 682e 7369 676e 280a 2020 2020  3.eth.sign(.    
+0001a8d0: 2020 2020 2020 2020 756e 6c6f 636b 6564          unlocked
+0001a8e0: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+0001a8f0: 7065 2c20 7465 7874 3d22 6469 6666 6572  pe, text="differ
+0001a900: 656e 7420 6d65 7373 6167 6520 6973 2064  ent message is d
+0001a910: 6966 6665 7265 6e74 220a 2020 2020 2020  ifferent".      
+0001a920: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
+0001a930: 7274 206e 6577 5f73 6967 6e61 7475 7265  rt new_signature
+0001a940: 2021 3d20 7369 676e 6174 7572 650a 0a20   != signature.. 
+0001a950: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+0001a960: 7369 676e 5f65 6e73 5f6e 616d 6573 280a  sign_ens_names(.
+0001a970: 2020 2020 2020 2020 7365 6c66 2c20 7733          self, w3
+0001a980: 3a20 2257 6562 3322 2c20 756e 6c6f 636b  : "Web3", unlock
+0001a990: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
+0001a9a0: 7479 7065 3a20 4368 6563 6b73 756d 4164  type: ChecksumAd
+0001a9b0: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
+0001a9c0: 6f6e 653a 0a20 2020 2020 2020 2077 6974  one:.        wit
+0001a9d0: 6820 656e 735f 6164 6472 6573 7365 7328  h ens_addresses(
+0001a9e0: 7733 2c20 7b22 756e 6c6f 636b 6564 2d61  w3, {"unlocked-a
+0001a9f0: 6363 742e 6574 6822 3a20 756e 6c6f 636b  cct.eth": unlock
+0001aa00: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
+0001aa10: 7479 7065 7d29 3a0a 2020 2020 2020 2020  type}):.        
+0001aa20: 2020 2020 7369 676e 6174 7572 6520 3d20      signature = 
+0001aa30: 7733 2e65 7468 2e73 6967 6e28 0a20 2020  w3.eth.sign(.   
+0001aa40: 2020 2020 2020 2020 2020 2020 2022 756e               "un
+0001aa50: 6c6f 636b 6564 2d61 6363 742e 6574 6822  locked-acct.eth"
+0001aa60: 2c20 7465 7874 3d22 4d65 7373 6167 6520  , text="Message 
+0001aa70: 74c3 b620 7369 676e 2e20 4c6f 6e67 6572  t.. sign. Longer
+0001aa80: 2074 6861 6e20 6861 7368 2122 0a20 2020   than hash!".   
+0001aa90: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001aaa0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+0001aab0: 5f62 7974 6573 2873 6967 6e61 7475 7265  _bytes(signature
+0001aac0: 290a 2020 2020 2020 2020 2020 2020 6173  ).            as
+0001aad0: 7365 7274 206c 656e 2873 6967 6e61 7475  sert len(signatu
+0001aae0: 7265 2920 3d3d 2033 3220 2b20 3332 202b  re) == 32 + 32 +
+0001aaf0: 2031 0a0a 2020 2020 6465 6620 7465 7374   1..    def test
+0001ab00: 5f65 7468 5f73 6967 6e5f 7479 7065 645f  _eth_sign_typed_
+0001ab10: 6461 7461 280a 2020 2020 2020 2020 7365  data(.        se
+0001ab20: 6c66 2c0a 2020 2020 2020 2020 7733 3a20  lf,.        w3: 
+0001ab30: 2257 6562 3322 2c0a 2020 2020 2020 2020  "Web3",.        
+0001ab40: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+0001ab50: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
+0001ab60: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
+0001ab70: 2020 2020 2073 6b69 705f 6966 5f74 6573       skip_if_tes
+0001ab80: 7472 7063 3a20 4361 6c6c 6162 6c65 5b5b  trpc: Callable[[
+0001ab90: 2257 6562 3322 5d2c 204e 6f6e 655d 2c0a  "Web3"], None],.
+0001aba0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0001abb0: 2020 2020 2020 2076 616c 6964 4a53 4f4e         validJSON
+0001abc0: 4d65 7373 6167 6520 3d20 2222 220a 2020  Message = """.  
+0001abd0: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+0001abe0: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
+0001abf0: 6573 223a 207b 0a20 2020 2020 2020 2020  es": {.         
+0001ac00: 2020 2020 2020 2020 2020 2022 4549 5037             "EIP7
+0001ac10: 3132 446f 6d61 696e 223a 205b 0a20 2020  12Domain": [.   
+0001ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ac30: 2020 2020 207b 226e 616d 6522 3a20 226e       {"name": "n
+0001ac40: 616d 6522 2c20 2274 7970 6522 3a20 2273  ame", "type": "s
+0001ac50: 7472 696e 6722 7d2c 0a20 2020 2020 2020  tring"},.       
+0001ac60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ac70: 207b 226e 616d 6522 3a20 2276 6572 7369   {"name": "versi
+0001ac80: 6f6e 222c 2022 7479 7065 223a 2022 7374  on", "type": "st
+0001ac90: 7269 6e67 227d 2c0a 2020 2020 2020 2020  ring"},.        
+0001aca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001acb0: 7b22 6e61 6d65 223a 2022 6368 6169 6e49  {"name": "chainI
+0001acc0: 6422 2c20 2274 7970 6522 3a20 2275 696e  d", "type": "uin
+0001acd0: 7432 3536 227d 2c0a 2020 2020 2020 2020  t256"},.        
+0001ace0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001acf0: 7b22 6e61 6d65 223a 2022 7665 7269 6679  {"name": "verify
+0001ad00: 696e 6743 6f6e 7472 6163 7422 2c20 2274  ingContract", "t
+0001ad10: 7970 6522 3a20 2261 6464 7265 7373 227d  ype": "address"}
+0001ad20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ad30: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+0001ad40: 2020 2020 2020 2020 2020 2020 2250 6572              "Per
+0001ad50: 736f 6e22 3a20 5b0a 2020 2020 2020 2020  son": [.        
+0001ad60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ad70: 7b22 6e61 6d65 223a 2022 6e61 6d65 222c  {"name": "name",
+0001ad80: 2022 7479 7065 223a 2022 7374 7269 6e67   "type": "string
+0001ad90: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
+0001ada0: 2020 2020 2020 2020 2020 2020 7b22 6e61              {"na
+0001adb0: 6d65 223a 2022 7761 6c6c 6574 222c 2022  me": "wallet", "
+0001adc0: 7479 7065 223a 2022 6164 6472 6573 7322  type": "address"
+0001add0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+0001ade0: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+0001adf0: 2020 2020 2020 2020 2020 2020 2022 4d61               "Ma
+0001ae00: 696c 223a 205b 0a20 2020 2020 2020 2020  il": [.         
+0001ae10: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0001ae20: 226e 616d 6522 3a20 2266 726f 6d22 2c20  "name": "from", 
+0001ae30: 2274 7970 6522 3a20 2250 6572 736f 6e22  "type": "Person"
+0001ae40: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0001ae50: 2020 2020 2020 2020 2020 207b 226e 616d             {"nam
+0001ae60: 6522 3a20 2274 6f22 2c20 2274 7970 6522  e": "to", "type"
+0001ae70: 3a20 2250 6572 736f 6e22 7d2c 0a20 2020  : "Person"},.   
+0001ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae90: 2020 2020 207b 226e 616d 6522 3a20 2263       {"name": "c
+0001aea0: 6f6e 7465 6e74 7322 2c20 2274 7970 6522  ontents", "type"
+0001aeb0: 3a20 2273 7472 696e 6722 7d0a 2020 2020  : "string"}.    
+0001aec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aed0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0001aee0: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
+0001aef0: 2020 2020 2022 7072 696d 6172 7954 7970       "primaryTyp
+0001af00: 6522 3a20 224d 6169 6c22 2c0a 2020 2020  e": "Mail",.    
+0001af10: 2020 2020 2020 2020 2020 2020 2264 6f6d              "dom
+0001af20: 6169 6e22 3a20 7b0a 2020 2020 2020 2020  ain": {.        
+0001af30: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
+0001af40: 6522 3a20 2245 7468 6572 204d 6169 6c22  e": "Ether Mail"
+0001af50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001af60: 2020 2020 2020 2276 6572 7369 6f6e 223a        "version":
+0001af70: 2022 3122 2c0a 2020 2020 2020 2020 2020   "1",.          
+0001af80: 2020 2020 2020 2020 2020 2263 6861 696e            "chain
+0001af90: 4964 223a 2022 3078 3031 222c 0a20 2020  Id": "0x01",.   
+0001afa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001afb0: 2022 7665 7269 6679 696e 6743 6f6e 7472   "verifyingContr
+0001afc0: 6163 7422 3a20 2230 7843 6343 4363 6363  act": "0xCcCCccc
+0001afd0: 6343 4343 4363 4343 4343 4343 6343 6343  cCCCCcCCCCCCcCcC
+0001afe0: 6363 4363 4343 4363 4363 6363 6363 6363  ccCcCCCcCccccccc
+0001aff0: 4322 0a20 2020 2020 2020 2020 2020 2020  C".             
+0001b000: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+0001b010: 2020 2020 2020 226d 6573 7361 6765 223a        "message":
+0001b020: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0001b030: 2020 2020 2020 2022 6672 6f6d 223a 207b         "from": {
+0001b040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b050: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
+0001b060: 2022 436f 7722 2c0a 2020 2020 2020 2020   "Cow",.        
+0001b070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b080: 2277 616c 6c65 7422 3a20 2230 7843 4432  "wallet": "0xCD2
+0001b090: 6133 6439 4639 3338 4531 3343 4439 3437  a3d9F938E13CD947
+0001b0a0: 4563 3035 4162 4337 4645 3733 3444 6638  Ec05AbC7FE734Df8
+0001b0b0: 4444 3832 3622 0a20 2020 2020 2020 2020  DD826".         
+0001b0c0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+0001b0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b0e0: 2020 2274 6f22 3a20 7b0a 2020 2020 2020    "to": {.      
+0001b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b100: 2020 226e 616d 6522 3a20 2242 6f62 222c    "name": "Bob",
+0001b110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b120: 2020 2020 2020 2020 2022 7761 6c6c 6574           "wallet
+0001b130: 223a 2022 3078 6242 6242 4242 4262 6242  ": "0xbBbBBBBbbB
+0001b140: 4242 6262 6242 6262 4262 6262 6242 4262  BBbbbBbbBbbbbBBb
+0001b150: 4262 6262 6242 6242 6262 4242 6242 220a  BbbbbBbBbbBBbB".
+0001b160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b170: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+0001b180: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
+0001b190: 656e 7473 223a 2022 4865 6c6c 6f2c 2042  ents": "Hello, B
+0001b1a0: 6f62 2122 0a20 2020 2020 2020 2020 2020  ob!".           
+0001b1b0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+0001b1c0: 2020 207d 0a20 2020 2020 2020 2022 2222     }.        """
+0001b1d0: 0a20 2020 2020 2020 2073 6b69 705f 6966  .        skip_if
+0001b1e0: 5f74 6573 7472 7063 2877 3329 0a20 2020  _testrpc(w3).   
+0001b1f0: 2020 2020 2073 6967 6e61 7475 7265 203d       signature =
+0001b200: 2048 6578 4279 7465 7328 0a20 2020 2020   HexBytes(.     
+0001b210: 2020 2020 2020 2077 332e 6574 682e 7369         w3.eth.si
+0001b220: 676e 5f74 7970 6564 5f64 6174 6128 0a20  gn_typed_data(. 
+0001b230: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+0001b240: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+0001b250: 6475 616c 5f74 7970 652c 206a 736f 6e2e  dual_type, json.
+0001b260: 6c6f 6164 7328 7661 6c69 644a 534f 4e4d  loads(validJSONM
+0001b270: 6573 7361 6765 290a 2020 2020 2020 2020  essage).        
+0001b280: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
+0001b290: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+0001b2a0: 656e 2873 6967 6e61 7475 7265 2920 3d3d  en(signature) ==
+0001b2b0: 2033 3220 2b20 3332 202b 2031 0a0a 2020   32 + 32 + 1..  
+0001b2c0: 2020 6465 6620 7465 7374 5f69 6e76 616c    def test_inval
+0001b2d0: 6964 5f65 7468 5f73 6967 6e5f 7479 7065  id_eth_sign_type
+0001b2e0: 645f 6461 7461 280a 2020 2020 2020 2020  d_data(.        
+0001b2f0: 7365 6c66 2c0a 2020 2020 2020 2020 7733  self,.        w3
+0001b300: 3a20 2257 6562 3322 2c0a 2020 2020 2020  : "Web3",.      
+0001b310: 2020 756e 6c6f 636b 6564 5f61 6363 6f75    unlocked_accou
+0001b320: 6e74 5f64 7561 6c5f 7479 7065 3a20 4368  nt_dual_type: Ch
+0001b330: 6563 6b73 756d 4164 6472 6573 732c 0a20  ecksumAddress,. 
+0001b340: 2020 2020 2020 2073 6b69 705f 6966 5f74         skip_if_t
+0001b350: 6573 7472 7063 3a20 4361 6c6c 6162 6c65  estrpc: Callable
+0001b360: 5b5b 2257 6562 3322 5d2c 204e 6f6e 655d  [["Web3"], None]
+0001b370: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+0001b380: 0a20 2020 2020 2020 2073 6b69 705f 6966  .        skip_if
+0001b390: 5f74 6573 7472 7063 2877 3329 0a20 2020  _testrpc(w3).   
+0001b3a0: 2020 2020 2069 6e76 616c 6964 5f74 7970       invalid_typ
+0001b3b0: 6564 5f6d 6573 7361 6765 203d 2022 2222  ed_message = """
+0001b3c0: 0a20 2020 2020 2020 2020 2020 207b 0a20  .            {. 
+0001b3d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001b3e0: 7479 7065 7322 3a20 7b0a 2020 2020 2020  types": {.      
+0001b3f0: 2020 2020 2020 2020 2020 2020 2020 2245                "E
+0001b400: 4950 3731 3244 6f6d 6169 6e22 3a20 5b0a  IP712Domain": [.
+0001b410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b420: 2020 2020 2020 2020 7b22 6e61 6d65 223a          {"name":
+0001b430: 2022 6e61 6d65 222c 2022 7479 7065 223a   "name", "type":
+0001b440: 2022 7374 7269 6e67 227d 2c0a 2020 2020   "string"},.    
+0001b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b460: 2020 2020 7b22 6e61 6d65 223a 2022 7665      {"name": "ve
+0001b470: 7273 696f 6e22 2c20 2274 7970 6522 3a20  rsion", "type": 
+0001b480: 2273 7472 696e 6722 7d2c 0a20 2020 2020  "string"},.     
+0001b490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4a0: 2020 207b 226e 616d 6522 3a20 2263 6861     {"name": "cha
+0001b4b0: 696e 4964 222c 2022 7479 7065 223a 2022  inId", "type": "
+0001b4c0: 7569 6e74 3235 3622 7d2c 0a20 2020 2020  uint256"},.     
+0001b4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4e0: 2020 207b 226e 616d 6522 3a20 2276 6572     {"name": "ver
+0001b4f0: 6966 7969 6e67 436f 6e74 7261 6374 222c  ifyingContract",
+0001b500: 2022 7479 7065 223a 2022 6164 6472 6573   "type": "addres
+0001b510: 7322 7d0a 2020 2020 2020 2020 2020 2020  s"}.            
+0001b520: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+0001b530: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001b540: 5065 7273 6f6e 223a 205b 0a20 2020 2020  Person": [.     
+0001b550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b560: 2020 207b 226e 616d 6522 3a20 226e 616d     {"name": "nam
+0001b570: 6522 2c20 2274 7970 6522 3a20 2273 7472  e", "type": "str
+0001b580: 696e 6722 7d2c 0a20 2020 2020 2020 2020  ing"},.         
+0001b590: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0001b5a0: 226e 616d 6522 3a20 2277 616c 6c65 7422  "name": "wallet"
+0001b5b0: 2c20 2274 7970 6522 3a20 2261 6464 7265  , "type": "addre
+0001b5c0: 7373 227d 0a20 2020 2020 2020 2020 2020  ss"}.           
+0001b5d0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+0001b5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5f0: 224d 6169 6c22 3a20 5b0a 2020 2020 2020  "Mail": [.      
+0001b600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b610: 2020 7b22 6e61 6d65 223a 2022 6672 6f6d    {"name": "from
+0001b620: 222c 2022 7479 7065 223a 2022 5065 7273  ", "type": "Pers
+0001b630: 6f6e 227d 2c0a 2020 2020 2020 2020 2020  on"},.          
+0001b640: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+0001b650: 6e61 6d65 223a 2022 746f 222c 2022 7479  name": "to", "ty
+0001b660: 7065 223a 2022 5065 7273 6f6e 5b32 5d22  pe": "Person[2]"
+0001b670: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0001b680: 2020 2020 2020 2020 2020 207b 226e 616d             {"nam
+0001b690: 6522 3a20 2263 6f6e 7465 6e74 7322 2c20  e": "contents", 
+0001b6a0: 2274 7970 6522 3a20 2273 7472 696e 6722  "type": "string"
+0001b6b0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+0001b6c0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+0001b6d0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+0001b6e0: 2020 2020 2020 2020 2020 2022 7072 696d             "prim
+0001b6f0: 6172 7954 7970 6522 3a20 224d 6169 6c22  aryType": "Mail"
+0001b700: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001b710: 2020 2264 6f6d 6169 6e22 3a20 7b0a 2020    "domain": {.  
+0001b720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b730: 2020 226e 616d 6522 3a20 2245 7468 6572    "name": "Ether
+0001b740: 204d 6169 6c22 2c0a 2020 2020 2020 2020   Mail",.        
+0001b750: 2020 2020 2020 2020 2020 2020 2276 6572              "ver
+0001b760: 7369 6f6e 223a 2022 3122 2c0a 2020 2020  sion": "1",.    
+0001b770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b780: 2263 6861 696e 4964 223a 2022 3078 3031  "chainId": "0x01
+0001b790: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001b7a0: 2020 2020 2020 2022 7665 7269 6679 696e         "verifyin
+0001b7b0: 6743 6f6e 7472 6163 7422 3a20 2230 7843  gContract": "0xC
+0001b7c0: 6343 4363 6363 6343 4343 4363 4343 4343  cCCccccCCCCcCCCC
+0001b7d0: 4343 6343 6343 6363 4363 4343 4363 4363  CCcCcCccCcCCCcCc
+0001b7e0: 6363 6363 6363 4322 0a20 2020 2020 2020  ccccccC".       
+0001b7f0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+0001b800: 2020 2020 2020 2020 2020 2020 226d 6573              "mes
+0001b810: 7361 6765 223a 207b 0a20 2020 2020 2020  sage": {.       
+0001b820: 2020 2020 2020 2020 2020 2020 2022 6672               "fr
+0001b830: 6f6d 223a 207b 0a20 2020 2020 2020 2020  om": {.         
+0001b840: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001b850: 6e61 6d65 223a 2022 436f 7722 2c0a 2020  name": "Cow",.  
+0001b860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b870: 2020 2020 2020 2277 616c 6c65 7422 3a20        "wallet": 
+0001b880: 2230 7843 4432 6133 6439 4639 3338 4531  "0xCD2a3d9F938E1
+0001b890: 3343 4439 3437 4563 3035 4162 4337 4645  3CD947Ec05AbC7FE
+0001b8a0: 3733 3444 6638 4444 3832 3622 0a20 2020  734Df8DD826".   
+0001b8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b8c0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+0001b8d0: 2020 2020 2020 2020 2274 6f22 3a20 5b7b          "to": [{
+0001b8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b8f0: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
+0001b900: 2022 426f 6222 2c0a 2020 2020 2020 2020   "Bob",.        
 0001b910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b920: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0001b930: 2020 2020 2020 2022 746f 223a 205b 7b0a         "to": [{.
-0001b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b950: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
-0001b960: 2242 6f62 222c 0a20 2020 2020 2020 2020  "Bob",.         
-0001b970: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b980: 7761 6c6c 6574 223a 2022 3078 6242 6242  wallet": "0xbBbB
-0001b990: 4242 4262 6242 4242 6262 6242 6262 4262  BBBbbBBBbbbBbbBb
-0001b9a0: 6262 6242 4262 4262 6262 6242 6242 6262  bbbBBbBbbbbBbBbb
-0001b9b0: 4242 6242 220a 2020 2020 2020 2020 2020  BBbB".          
-0001b9c0: 2020 2020 2020 2020 2020 7d5d 2c0a 2020            }],.  
-0001b9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b9e0: 2020 2263 6f6e 7465 6e74 7322 3a20 2248    "contents": "H
-0001b9f0: 656c 6c6f 2c20 426f 6221 220a 2020 2020  ello, Bob!".    
-0001ba00: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-0001ba10: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-0001ba20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001ba30: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-0001ba40: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-0001ba50: 5661 6c75 6545 7272 6f72 2c0a 2020 2020  ValueError,.    
-0001ba60: 2020 2020 2020 2020 6d61 7463 683d 7222          match=r"
-0001ba70: 2e2a 4578 7065 6374 6564 2032 2069 7465  .*Expected 2 ite
-0001ba80: 6d73 2066 6f72 2061 7272 6179 2074 7970  ms for array typ
-0001ba90: 6520 5065 7273 6f6e 5c5b 325c 5d2c 2067  e Person\[2\], g
-0001baa0: 6f74 2031 2069 7465 6d73 2e2a 222c 0a20  ot 1 items.*",. 
-0001bab0: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-0001bac0: 2020 2020 2020 7733 2e65 7468 2e73 6967        w3.eth.sig
-0001bad0: 6e5f 7479 7065 645f 6461 7461 280a 2020  n_typed_data(.  
-0001bae0: 2020 2020 2020 2020 2020 2020 2020 756e                un
-0001baf0: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-0001bb00: 7561 6c5f 7479 7065 2c20 6a73 6f6e 2e6c  ual_type, json.l
-0001bb10: 6f61 6473 2869 6e76 616c 6964 5f74 7970  oads(invalid_typ
-0001bb20: 6564 5f6d 6573 7361 6765 290a 2020 2020  ed_message).    
-0001bb30: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-0001bb40: 6566 2074 6573 745f 6574 685f 7369 676e  ef test_eth_sign
-0001bb50: 5f74 7261 6e73 6163 7469 6f6e 5f6c 6567  _transaction_leg
-0001bb60: 6163 7928 0a20 2020 2020 2020 2073 656c  acy(.        sel
-0001bb70: 662c 2077 333a 2022 5765 6233 222c 2075  f, w3: "Web3", u
-0001bb80: 6e6c 6f63 6b65 645f 6163 636f 756e 743a  nlocked_account:
-0001bb90: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-0001bba0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0001bbb0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-0001bbc0: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
-0001bbd0: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
-0001bbe0: 6f6d 223a 2075 6e6c 6f63 6b65 645f 6163  om": unlocked_ac
-0001bbf0: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
-0001bc00: 2020 2022 746f 223a 2075 6e6c 6f63 6b65     "to": unlocke
-0001bc10: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
-0001bc20: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
-0001bc30: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
-0001bc40: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
-0001bc50: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-0001bc60: 6173 5072 6963 6522 3a20 7733 2e65 7468  asPrice": w3.eth
-0001bc70: 2e67 6173 5f70 7269 6365 2c0a 2020 2020  .gas_price,.    
-0001bc80: 2020 2020 2020 2020 226e 6f6e 6365 223a          "nonce":
-0001bc90: 204e 6f6e 6365 2830 292c 0a20 2020 2020   Nonce(0),.     
-0001bca0: 2020 207d 0a20 2020 2020 2020 2072 6573     }.        res
-0001bcb0: 756c 7420 3d20 7733 2e65 7468 2e73 6967  ult = w3.eth.sig
-0001bcc0: 6e5f 7472 616e 7361 6374 696f 6e28 7478  n_transaction(tx
-0001bcd0: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
-0001bce0: 2020 7369 676e 6174 6f72 795f 6163 636f    signatory_acco
-0001bcf0: 756e 7420 3d20 7733 2e65 7468 2e61 6363  unt = w3.eth.acc
-0001bd00: 6f75 6e74 2e72 6563 6f76 6572 5f74 7261  ount.recover_tra
-0001bd10: 6e73 6163 7469 6f6e 2872 6573 756c 745b  nsaction(result[
-0001bd20: 2272 6177 225d 290a 2020 2020 2020 2020  "raw"]).        
-0001bd30: 6173 7365 7274 2075 6e6c 6f63 6b65 645f  assert unlocked_
-0001bd40: 6163 636f 756e 7420 3d3d 2073 6967 6e61  account == signa
-0001bd50: 746f 7279 5f61 6363 6f75 6e74 0a20 2020  tory_account.   
-0001bd60: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-0001bd70: 6c74 5b22 7478 225d 5b22 746f 225d 203d  lt["tx"]["to"] =
-0001bd80: 3d20 7478 6e5f 7061 7261 6d73 5b22 746f  = txn_params["to
-0001bd90: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
-0001bda0: 7420 7265 7375 6c74 5b22 7478 225d 5b22  t result["tx"]["
-0001bdb0: 7661 6c75 6522 5d20 3d3d 2074 786e 5f70  value"] == txn_p
-0001bdc0: 6172 616d 735b 2276 616c 7565 225d 0a20  arams["value"]. 
-0001bdd0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-0001bde0: 7375 6c74 5b22 7478 225d 5b22 6761 7322  sult["tx"]["gas"
-0001bdf0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
-0001be00: 2267 6173 225d 0a20 2020 2020 2020 2061  "gas"].        a
-0001be10: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
-0001be20: 225d 5b22 6761 7350 7269 6365 225d 203d  "]["gasPrice"] =
-0001be30: 3d20 7478 6e5f 7061 7261 6d73 5b22 6761  = txn_params["ga
-0001be40: 7350 7269 6365 225d 0a20 2020 2020 2020  sPrice"].       
-0001be50: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
-0001be60: 7478 225d 5b22 6e6f 6e63 6522 5d20 3d3d  tx"]["nonce"] ==
-0001be70: 2074 786e 5f70 6172 616d 735b 226e 6f6e   txn_params["non
-0001be80: 6365 225d 0a0a 2020 2020 6465 6620 7465  ce"]..    def te
-0001be90: 7374 5f65 7468 5f73 6967 6e5f 7472 616e  st_eth_sign_tran
-0001bea0: 7361 6374 696f 6e28 0a20 2020 2020 2020  saction(.       
-0001beb0: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
-0001bec0: 222c 2075 6e6c 6f63 6b65 645f 6163 636f  ", unlocked_acco
-0001bed0: 756e 743a 2043 6865 636b 7375 6d41 6464  unt: ChecksumAdd
-0001bee0: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-0001bef0: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-0001bf00: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-0001bf10: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0001bf20: 2022 6672 6f6d 223a 2075 6e6c 6f63 6b65   "from": unlocke
-0001bf30: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
-0001bf40: 2020 2020 2020 2022 746f 223a 2075 6e6c         "to": unl
-0001bf50: 6f63 6b65 645f 6163 636f 756e 742c 0a20  ocked_account,. 
-0001bf60: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
-0001bf70: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
-0001bf80: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
-0001bf90: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
-0001bfa0: 2020 226d 6178 4665 6550 6572 4761 7322    "maxFeePerGas"
-0001bfb0: 3a20 7733 2e74 6f5f 7765 6928 322c 2022  : w3.to_wei(2, "
-0001bfc0: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
-0001bfd0: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
-0001bfe0: 4665 6550 6572 4761 7322 3a20 7733 2e74  FeePerGas": w3.t
-0001bff0: 6f5f 7765 6928 312c 2022 6777 6569 2229  o_wei(1, "gwei")
-0001c000: 2c0a 2020 2020 2020 2020 2020 2020 226e  ,.            "n
-0001c010: 6f6e 6365 223a 204e 6f6e 6365 2830 292c  once": Nonce(0),
-0001c020: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-0001c030: 2020 2072 6573 756c 7420 3d20 7733 2e65     result = w3.e
-0001c040: 7468 2e73 6967 6e5f 7472 616e 7361 6374  th.sign_transact
-0001c050: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
-0001c060: 2020 2020 2020 2020 7369 676e 6174 6f72          signator
-0001c070: 795f 6163 636f 756e 7420 3d20 7733 2e65  y_account = w3.e
-0001c080: 7468 2e61 6363 6f75 6e74 2e72 6563 6f76  th.account.recov
-0001c090: 6572 5f74 7261 6e73 6163 7469 6f6e 2872  er_transaction(r
-0001c0a0: 6573 756c 745b 2272 6177 225d 290a 2020  esult["raw"]).  
-0001c0b0: 2020 2020 2020 6173 7365 7274 2075 6e6c        assert unl
-0001c0c0: 6f63 6b65 645f 6163 636f 756e 7420 3d3d  ocked_account ==
-0001c0d0: 2073 6967 6e61 746f 7279 5f61 6363 6f75   signatory_accou
-0001c0e0: 6e74 0a20 2020 2020 2020 2061 7373 6572  nt.        asser
-0001c0f0: 7420 7265 7375 6c74 5b22 7478 225d 5b22  t result["tx"]["
-0001c100: 746f 225d 203d 3d20 7478 6e5f 7061 7261  to"] == txn_para
-0001c110: 6d73 5b22 746f 225d 0a20 2020 2020 2020  ms["to"].       
-0001c120: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
-0001c130: 7478 225d 5b22 7661 6c75 6522 5d20 3d3d  tx"]["value"] ==
-0001c140: 2074 786e 5f70 6172 616d 735b 2276 616c   txn_params["val
-0001c150: 7565 225d 0a20 2020 2020 2020 2061 7373  ue"].        ass
-0001c160: 6572 7420 7265 7375 6c74 5b22 7478 225d  ert result["tx"]
-0001c170: 5b22 6761 7322 5d20 3d3d 2074 786e 5f70  ["gas"] == txn_p
-0001c180: 6172 616d 735b 2267 6173 225d 0a20 2020  arams["gas"].   
-0001c190: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-0001c1a0: 6c74 5b22 7478 225d 5b22 6d61 7846 6565  lt["tx"]["maxFee
-0001c1b0: 5065 7247 6173 225d 203d 3d20 7478 6e5f  PerGas"] == txn_
-0001c1c0: 7061 7261 6d73 5b22 6d61 7846 6565 5065  params["maxFeePe
-0001c1d0: 7247 6173 225d 0a20 2020 2020 2020 2061  rGas"].        a
-0001c1e0: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
-0001c1f0: 2020 2020 7265 7375 6c74 5b22 7478 225d      result["tx"]
-0001c200: 5b22 6d61 7850 7269 6f72 6974 7946 6565  ["maxPriorityFee
-0001c210: 5065 7247 6173 225d 203d 3d20 7478 6e5f  PerGas"] == txn_
-0001c220: 7061 7261 6d73 5b22 6d61 7850 7269 6f72  params["maxPrior
-0001c230: 6974 7946 6565 5065 7247 6173 225d 0a20  ityFeePerGas"]. 
-0001c240: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001c250: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
-0001c260: 7478 225d 5b22 6e6f 6e63 6522 5d20 3d3d  tx"]["nonce"] ==
-0001c270: 2074 786e 5f70 6172 616d 735b 226e 6f6e   txn_params["non
-0001c280: 6365 225d 0a0a 2020 2020 6465 6620 7465  ce"]..    def te
-0001c290: 7374 5f65 7468 5f73 6967 6e5f 7472 616e  st_eth_sign_tran
-0001c2a0: 7361 6374 696f 6e5f 6865 785f 6665 6573  saction_hex_fees
-0001c2b0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-0001c2c0: 7733 3a20 2257 6562 3322 2c20 756e 6c6f  w3: "Web3", unlo
-0001c2d0: 636b 6564 5f61 6363 6f75 6e74 3a20 4368  cked_account: Ch
-0001c2e0: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
-0001c2f0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-0001c300: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-0001c310: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-0001c320: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-0001c330: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
-0001c340: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-0001c350: 2274 6f22 3a20 756e 6c6f 636b 6564 5f61  "to": unlocked_a
-0001c360: 6363 6f75 6e74 2c0a 2020 2020 2020 2020  ccount,.        
-0001c370: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
-0001c380: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
-0001c390: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
-0001c3a0: 2020 2020 2020 2020 2020 2022 6d61 7846             "maxF
-0001c3b0: 6565 5065 7247 6173 223a 2068 6578 2877  eePerGas": hex(w
-0001c3c0: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
-0001c3d0: 6922 2929 2c0a 2020 2020 2020 2020 2020  i")),.          
-0001c3e0: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
-0001c3f0: 6550 6572 4761 7322 3a20 6865 7828 7733  ePerGas": hex(w3
-0001c400: 2e74 6f5f 7765 6928 312c 2022 6777 6569  .to_wei(1, "gwei
-0001c410: 2229 292c 0a20 2020 2020 2020 2020 2020  ")),.           
-0001c420: 2022 6e6f 6e63 6522 3a20 4e6f 6e63 6528   "nonce": Nonce(
-0001c430: 3029 2c0a 2020 2020 2020 2020 7d0a 2020  0),.        }.  
-0001c440: 2020 2020 2020 7265 7375 6c74 203d 2077        result = w
-0001c450: 332e 6574 682e 7369 676e 5f74 7261 6e73  3.eth.sign_trans
-0001c460: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
-0001c470: 7329 0a20 2020 2020 2020 2073 6967 6e61  s).        signa
-0001c480: 746f 7279 5f61 6363 6f75 6e74 203d 2077  tory_account = w
-0001c490: 332e 6574 682e 6163 636f 756e 742e 7265  3.eth.account.re
-0001c4a0: 636f 7665 725f 7472 616e 7361 6374 696f  cover_transactio
-0001c4b0: 6e28 7265 7375 6c74 5b22 7261 7722 5d29  n(result["raw"])
-0001c4c0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001c4d0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-0001c4e0: 203d 3d20 7369 676e 6174 6f72 795f 6163   == signatory_ac
-0001c4f0: 636f 756e 740a 2020 2020 2020 2020 6173  count.        as
-0001c500: 7365 7274 2072 6573 756c 745b 2274 7822  sert result["tx"
-0001c510: 5d5b 2274 6f22 5d20 3d3d 2074 786e 5f70  ]["to"] == txn_p
-0001c520: 6172 616d 735b 2274 6f22 5d0a 2020 2020  arams["to"].    
-0001c530: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
-0001c540: 745b 2274 7822 5d5b 2276 616c 7565 225d  t["tx"]["value"]
-0001c550: 203d 3d20 7478 6e5f 7061 7261 6d73 5b22   == txn_params["
-0001c560: 7661 6c75 6522 5d0a 2020 2020 2020 2020  value"].        
-0001c570: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
-0001c580: 7822 5d5b 2267 6173 225d 203d 3d20 7478  x"]["gas"] == tx
-0001c590: 6e5f 7061 7261 6d73 5b22 6761 7322 5d0a  n_params["gas"].
-0001c5a0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-0001c5b0: 6573 756c 745b 2274 7822 5d5b 226d 6178  esult["tx"]["max
-0001c5c0: 4665 6550 6572 4761 7322 5d20 3d3d 2069  FeePerGas"] == i
-0001c5d0: 6e74 2873 7472 2874 786e 5f70 6172 616d  nt(str(txn_param
-0001c5e0: 735b 226d 6178 4665 6550 6572 4761 7322  s["maxFeePerGas"
-0001c5f0: 5d29 2c20 3136 290a 2020 2020 2020 2020  ]), 16).        
-0001c600: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
-0001c610: 7822 5d5b 226d 6178 5072 696f 7269 7479  x"]["maxPriority
-0001c620: 4665 6550 6572 4761 7322 5d20 3d3d 2069  FeePerGas"] == i
-0001c630: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
-0001c640: 7374 7228 7478 6e5f 7061 7261 6d73 5b22  str(txn_params["
-0001c650: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-0001c660: 7247 6173 225d 292c 2031 360a 2020 2020  rGas"]), 16.    
-0001c670: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
-0001c680: 7365 7274 2072 6573 756c 745b 2274 7822  sert result["tx"
-0001c690: 5d5b 226e 6f6e 6365 225d 203d 3d20 7478  ]["nonce"] == tx
-0001c6a0: 6e5f 7061 7261 6d73 5b22 6e6f 6e63 6522  n_params["nonce"
-0001c6b0: 5d0a 0a20 2020 2064 6566 2074 6573 745f  ]..    def test_
-0001c6c0: 6574 685f 7369 676e 5f74 7261 6e73 6163  eth_sign_transac
-0001c6d0: 7469 6f6e 5f65 6e73 5f6e 616d 6573 280a  tion_ens_names(.
-0001c6e0: 2020 2020 2020 2020 7365 6c66 2c20 7733          self, w3
-0001c6f0: 3a20 2257 6562 3322 2c20 756e 6c6f 636b  : "Web3", unlock
-0001c700: 6564 5f61 6363 6f75 6e74 3a20 4368 6563  ed_account: Chec
-0001c710: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
-0001c720: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0001c730: 2020 2077 6974 6820 656e 735f 6164 6472     with ens_addr
-0001c740: 6573 7365 7328 7733 2c20 7b22 756e 6c6f  esses(w3, {"unlo
-0001c750: 636b 6564 2d61 6363 6f75 6e74 2e65 7468  cked-account.eth
-0001c760: 223a 2075 6e6c 6f63 6b65 645f 6163 636f  ": unlocked_acco
-0001c770: 756e 747d 293a 0a20 2020 2020 2020 2020  unt}):.         
-0001c780: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
-0001c790: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
-0001c7a0: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-0001c7b0: 6d22 3a20 2275 6e6c 6f63 6b65 642d 6163  m": "unlocked-ac
-0001c7c0: 636f 756e 742e 6574 6822 2c0a 2020 2020  count.eth",.    
-0001c7d0: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
-0001c7e0: 3a20 2275 6e6c 6f63 6b65 642d 6163 636f  : "unlocked-acco
-0001c7f0: 756e 742e 6574 6822 2c0a 2020 2020 2020  unt.eth",.      
-0001c800: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-0001c810: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-0001c820: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-0001c830: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-0001c840: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
-0001c850: 5065 7247 6173 223a 2077 332e 746f 5f77  PerGas": w3.to_w
-0001c860: 6569 2832 2c20 2267 7765 6922 292c 0a20  ei(2, "gwei"),. 
-0001c870: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001c880: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-0001c890: 7247 6173 223a 2077 332e 746f 5f77 6569  rGas": w3.to_wei
-0001c8a0: 2831 2c20 2267 7765 6922 292c 0a20 2020  (1, "gwei"),.   
-0001c8b0: 2020 2020 2020 2020 2020 2020 2022 6e6f               "no
-0001c8c0: 6e63 6522 3a20 4e6f 6e63 6528 3029 2c0a  nce": Nonce(0),.
-0001c8d0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-0001c8e0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-0001c8f0: 203d 2077 332e 6574 682e 7369 676e 5f74   = w3.eth.sign_t
-0001c900: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
-0001c910: 6172 616d 7329 0a20 2020 2020 2020 2020  arams).         
-0001c920: 2020 2073 6967 6e61 746f 7279 5f61 6363     signatory_acc
-0001c930: 6f75 6e74 203d 2077 332e 6574 682e 6163  ount = w3.eth.ac
-0001c940: 636f 756e 742e 7265 636f 7665 725f 7472  count.recover_tr
-0001c950: 616e 7361 6374 696f 6e28 7265 7375 6c74  ansaction(result
-0001c960: 5b22 7261 7722 5d29 0a20 2020 2020 2020  ["raw"]).       
-0001c970: 2020 2020 2061 7373 6572 7420 756e 6c6f       assert unlo
-0001c980: 636b 6564 5f61 6363 6f75 6e74 203d 3d20  cked_account == 
-0001c990: 7369 676e 6174 6f72 795f 6163 636f 756e  signatory_accoun
-0001c9a0: 740a 2020 2020 2020 2020 2020 2020 6173  t.            as
-0001c9b0: 7365 7274 2072 6573 756c 745b 2274 7822  sert result["tx"
-0001c9c0: 5d5b 2274 6f22 5d20 3d3d 2075 6e6c 6f63  ]["to"] == unloc
-0001c9d0: 6b65 645f 6163 636f 756e 740a 2020 2020  ked_account.    
-0001c9e0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-0001c9f0: 6573 756c 745b 2274 7822 5d5b 2276 616c  esult["tx"]["val
-0001ca00: 7565 225d 203d 3d20 7478 6e5f 7061 7261  ue"] == txn_para
-0001ca10: 6d73 5b22 7661 6c75 6522 5d0a 2020 2020  ms["value"].    
-0001ca20: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-0001ca30: 6573 756c 745b 2274 7822 5d5b 2267 6173  esult["tx"]["gas
-0001ca40: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
-0001ca50: 5b22 6761 7322 5d0a 2020 2020 2020 2020  ["gas"].        
-0001ca60: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
-0001ca70: 745b 2274 7822 5d5b 226d 6178 4665 6550  t["tx"]["maxFeeP
-0001ca80: 6572 4761 7322 5d20 3d3d 2074 786e 5f70  erGas"] == txn_p
-0001ca90: 6172 616d 735b 226d 6178 4665 6550 6572  arams["maxFeePer
-0001caa0: 4761 7322 5d0a 2020 2020 2020 2020 2020  Gas"].          
-0001cab0: 2020 6173 7365 7274 2028 0a20 2020 2020    assert (.     
-0001cac0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-0001cad0: 745b 2274 7822 5d5b 226d 6178 5072 696f  t["tx"]["maxPrio
-0001cae0: 7269 7479 4665 6550 6572 4761 7322 5d0a  rityFeePerGas"].
-0001caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb00: 3d3d 2074 786e 5f70 6172 616d 735b 226d  == txn_params["m
-0001cb10: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
-0001cb20: 4761 7322 5d0a 2020 2020 2020 2020 2020  Gas"].          
-0001cb30: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0001cb40: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
-0001cb50: 7822 5d5b 226e 6f6e 6365 225d 203d 3d20  x"]["nonce"] == 
-0001cb60: 7478 6e5f 7061 7261 6d73 5b22 6e6f 6e63  txn_params["nonc
-0001cb70: 6522 5d0a 0a20 2020 2064 6566 2074 6573  e"]..    def tes
-0001cb80: 745f 6574 685f 7365 6e64 5f74 7261 6e73  t_eth_send_trans
-0001cb90: 6163 7469 6f6e 5f61 6464 725f 6368 6563  action_addr_chec
-0001cba0: 6b73 756d 5f72 6571 7569 7265 6428 0a20  ksum_required(. 
-0001cbb0: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
-0001cbc0: 2022 5765 6233 222c 2075 6e6c 6f63 6b65   "Web3", unlocke
-0001cbd0: 645f 6163 636f 756e 743a 2043 6865 636b  d_account: Check
-0001cbe0: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
-0001cbf0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-0001cc00: 2020 6e6f 6e5f 6368 6563 6b73 756d 5f61    non_checksum_a
-0001cc10: 6464 7220 3d20 756e 6c6f 636b 6564 5f61  ddr = unlocked_a
-0001cc20: 6363 6f75 6e74 2e6c 6f77 6572 2829 0a20  ccount.lower(). 
-0001cc30: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-0001cc40: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-0001cc50: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-0001cc60: 6d22 3a20 756e 6c6f 636b 6564 5f61 6363  m": unlocked_acc
-0001cc70: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
-0001cc80: 2020 2274 6f22 3a20 756e 6c6f 636b 6564    "to": unlocked
-0001cc90: 5f61 6363 6f75 6e74 2c0a 2020 2020 2020  _account,.      
-0001cca0: 2020 2020 2020 2276 616c 7565 223a 2057        "value": W
-0001ccb0: 6569 2831 292c 0a20 2020 2020 2020 2020  ei(1),.         
-0001ccc0: 2020 2022 6761 7322 3a20 3231 3030 302c     "gas": 21000,
-0001ccd0: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
-0001cce0: 7846 6565 5065 7247 6173 223a 2077 332e  xFeePerGas": w3.
-0001ccf0: 746f 5f77 6569 2832 2c20 2267 7765 6922  to_wei(2, "gwei"
-0001cd00: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-0001cd10: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-0001cd20: 7247 6173 223a 2077 332e 746f 5f77 6569  rGas": w3.to_wei
-0001cd30: 2831 2c20 2267 7765 6922 292c 0a20 2020  (1, "gwei"),.   
-0001cd40: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
-0001cd50: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-0001cd60: 6573 2849 6e76 616c 6964 4164 6472 6573  es(InvalidAddres
-0001cd70: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0001cd80: 696e 7661 6c69 645f 7061 7261 6d73 203d  invalid_params =
-0001cd90: 2063 6173 7428 0a20 2020 2020 2020 2020   cast(.         
-0001cda0: 2020 2020 2020 2054 7850 6172 616d 732c         TxParams,
-0001cdb0: 2064 6963 7428 7478 6e5f 7061 7261 6d73   dict(txn_params
-0001cdc0: 2c20 2a2a 7b22 6672 6f6d 223a 206e 6f6e  , **{"from": non
-0001cdd0: 5f63 6865 636b 7375 6d5f 6164 6472 7d29  _checksum_addr})
-0001cde0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001cdf0: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
-0001ce00: 682e 7365 6e64 5f74 7261 6e73 6163 7469  h.send_transacti
-0001ce10: 6f6e 2869 6e76 616c 6964 5f70 6172 616d  on(invalid_param
-0001ce20: 7329 0a0a 2020 2020 2020 2020 7769 7468  s)..        with
-0001ce30: 2070 7974 6573 742e 7261 6973 6573 2849   pytest.raises(I
-0001ce40: 6e76 616c 6964 4164 6472 6573 7329 3a0a  nvalidAddress):.
-0001ce50: 2020 2020 2020 2020 2020 2020 696e 7661              inva
-0001ce60: 6c69 645f 7061 7261 6d73 203d 2063 6173  lid_params = cas
-0001ce70: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-0001ce80: 2020 2054 7850 6172 616d 732c 2064 6963     TxParams, dic
-0001ce90: 7428 7478 6e5f 7061 7261 6d73 2c20 2a2a  t(txn_params, **
-0001cea0: 7b22 746f 223a 206e 6f6e 5f63 6865 636b  {"to": non_check
-0001ceb0: 7375 6d5f 6164 6472 7d29 0a20 2020 2020  sum_addr}).     
-0001cec0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001ced0: 2020 2020 2077 332e 6574 682e 7365 6e64       w3.eth.send
-0001cee0: 5f74 7261 6e73 6163 7469 6f6e 2869 6e76  _transaction(inv
-0001cef0: 616c 6964 5f70 6172 616d 7329 0a0a 2020  alid_params)..  
-0001cf00: 2020 6465 6620 7465 7374 5f65 7468 5f73    def test_eth_s
-0001cf10: 656e 645f 7472 616e 7361 6374 696f 6e5f  end_transaction_
-0001cf20: 6c65 6761 6379 280a 2020 2020 2020 2020  legacy(.        
-0001cf30: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-0001cf40: 2c20 756e 6c6f 636b 6564 5f61 6363 6f75  , unlocked_accou
-0001cf50: 6e74 5f64 7561 6c5f 7479 7065 3a20 4368  nt_dual_type: Ch
-0001cf60: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
-0001cf70: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-0001cf80: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-0001cf90: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-0001cfa0: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-0001cfb0: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
-0001cfc0: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
-0001cfd0: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
-0001cfe0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-0001cff0: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-0001d000: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
-0001d010: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
-0001d020: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
-0001d030: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
-0001d040: 6761 7350 7269 6365 223a 2077 332e 746f  gasPrice": w3.to
-0001d050: 5f77 6569 280a 2020 2020 2020 2020 2020  _wei(.          
-0001d060: 2020 2020 2020 312c 2022 6777 6569 220a        1, "gwei".
-0001d070: 2020 2020 2020 2020 2020 2020 292c 2020              ),  
-0001d080: 2320 706f 7374 2d6c 6f6e 646f 6e20 6e65  # post-london ne
-0001d090: 6564 7320 746f 2062 6520 6d6f 7265 2074  eds to be more t
-0001d0a0: 6861 6e20 7468 6520 6261 7365 2066 6565  han the base fee
-0001d0b0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-0001d0c0: 2020 2074 786e 5f68 6173 6820 3d20 7733     txn_hash = w3
-0001d0d0: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
-0001d0e0: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
-0001d0f0: 290a 2020 2020 2020 2020 7478 6e20 3d20  ).        txn = 
-0001d100: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
-0001d110: 6163 7469 6f6e 2874 786e 5f68 6173 6829  action(txn_hash)
-0001d120: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-0001d130: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
-0001d140: 2874 786e 5b22 6672 6f6d 225d 2c20 6361  (txn["from"], ca
-0001d150: 7374 2843 6865 636b 7375 6d41 6464 7265  st(ChecksumAddre
-0001d160: 7373 2c20 7478 6e5f 7061 7261 6d73 5b22  ss, txn_params["
-0001d170: 6672 6f6d 225d 2929 0a20 2020 2020 2020  from"])).       
-0001d180: 2061 7373 6572 7420 6973 5f73 616d 655f   assert is_same_
-0001d190: 6164 6472 6573 7328 7478 6e5b 2274 6f22  address(txn["to"
-0001d1a0: 5d2c 2063 6173 7428 4368 6563 6b73 756d  ], cast(Checksum
-0001d1b0: 4164 6472 6573 732c 2074 786e 5f70 6172  Address, txn_par
-0001d1c0: 616d 735b 2274 6f22 5d29 290a 2020 2020  ams["to"])).    
-0001d1d0: 2020 2020 6173 7365 7274 2074 786e 5b22      assert txn["
-0001d1e0: 7661 6c75 6522 5d20 3d3d 2031 0a20 2020  value"] == 1.   
-0001d1f0: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
-0001d200: 2267 6173 225d 203d 3d20 3231 3030 300a  "gas"] == 21000.
-0001d210: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-0001d220: 786e 5b22 6761 7350 7269 6365 225d 203d  xn["gasPrice"] =
-0001d230: 3d20 7478 6e5f 7061 7261 6d73 5b22 6761  = txn_params["ga
-0001d240: 7350 7269 6365 225d 0a0a 2020 2020 6465  sPrice"]..    de
-0001d250: 6620 7465 7374 5f65 7468 5f73 656e 645f  f test_eth_send_
-0001d260: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
-0001d270: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
-0001d280: 5765 6233 222c 2075 6e6c 6f63 6b65 645f  Web3", unlocked_
-0001d290: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
-0001d2a0: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
-0001d2b0: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
-0001d2c0: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
-0001d2d0: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
-0001d2e0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-0001d2f0: 6672 6f6d 223a 2075 6e6c 6f63 6b65 645f  from": unlocked_
-0001d300: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
-0001d310: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-0001d320: 746f 223a 2075 6e6c 6f63 6b65 645f 6163  to": unlocked_ac
-0001d330: 636f 756e 745f 6475 616c 5f74 7970 652c  count_dual_type,
-0001d340: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
-0001d350: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
-0001d360: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
-0001d370: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
-0001d380: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
-0001d390: 7322 3a20 7733 2e74 6f5f 7765 6928 332c  s": w3.to_wei(3,
-0001d3a0: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
-0001d3b0: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
-0001d3c0: 7479 4665 6550 6572 4761 7322 3a20 7733  tyFeePerGas": w3
-0001d3d0: 2e74 6f5f 7765 6928 312c 2022 6777 6569  .to_wei(1, "gwei
-0001d3e0: 2229 2c0a 2020 2020 2020 2020 7d0a 2020  "),.        }.  
-0001d3f0: 2020 2020 2020 7478 6e5f 6861 7368 203d        txn_hash =
-0001d400: 2077 332e 6574 682e 7365 6e64 5f74 7261   w3.eth.send_tra
-0001d410: 6e73 6163 7469 6f6e 2874 786e 5f70 6172  nsaction(txn_par
-0001d420: 616d 7329 0a20 2020 2020 2020 2074 786e  ams).        txn
-0001d430: 203d 2077 332e 6574 682e 6765 745f 7472   = w3.eth.get_tr
-0001d440: 616e 7361 6374 696f 6e28 7478 6e5f 6861  ansaction(txn_ha
-0001d450: 7368 290a 0a20 2020 2020 2020 2061 7373  sh)..        ass
-0001d460: 6572 7420 6973 5f73 616d 655f 6164 6472  ert is_same_addr
-0001d470: 6573 7328 7478 6e5b 2266 726f 6d22 5d2c  ess(txn["from"],
-0001d480: 2063 6173 7428 4368 6563 6b73 756d 4164   cast(ChecksumAd
-0001d490: 6472 6573 732c 2074 786e 5f70 6172 616d  dress, txn_param
-0001d4a0: 735b 2266 726f 6d22 5d29 290a 2020 2020  s["from"])).    
-0001d4b0: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
-0001d4c0: 6d65 5f61 6464 7265 7373 2874 786e 5b22  me_address(txn["
-0001d4d0: 746f 225d 2c20 6361 7374 2843 6865 636b  to"], cast(Check
-0001d4e0: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
-0001d4f0: 7061 7261 6d73 5b22 746f 225d 2929 0a20  params["to"])). 
-0001d500: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
-0001d510: 6e5b 2276 616c 7565 225d 203d 3d20 310a  n["value"] == 1.
-0001d520: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-0001d530: 786e 5b22 6761 7322 5d20 3d3d 2032 3130  xn["gas"] == 210
-0001d540: 3030 0a20 2020 2020 2020 2061 7373 6572  00.        asser
-0001d550: 7420 7478 6e5b 226d 6178 4665 6550 6572  t txn["maxFeePer
-0001d560: 4761 7322 5d20 3d3d 2074 786e 5f70 6172  Gas"] == txn_par
-0001d570: 616d 735b 226d 6178 4665 6550 6572 4761  ams["maxFeePerGa
-0001d580: 7322 5d0a 2020 2020 2020 2020 6173 7365  s"].        asse
-0001d590: 7274 2074 786e 5b22 6d61 7850 7269 6f72  rt txn["maxPrior
-0001d5a0: 6974 7946 6565 5065 7247 6173 225d 203d  ityFeePerGas"] =
-0001d5b0: 3d20 7478 6e5f 7061 7261 6d73 5b22 6d61  = txn_params["ma
-0001d5c0: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-0001d5d0: 6173 225d 0a20 2020 2020 2020 2061 7373  as"].        ass
-0001d5e0: 6572 7420 7478 6e5b 2267 6173 5072 6963  ert txn["gasPric
-0001d5f0: 6522 5d20 3d3d 2074 786e 5f70 6172 616d  e"] == txn_param
-0001d600: 735b 226d 6178 4665 6550 6572 4761 7322  s["maxFeePerGas"
-0001d610: 5d0a 0a20 2020 2064 6566 2074 6573 745f  ]..    def test_
-0001d620: 6574 685f 7365 6e64 5f74 7261 6e73 6163  eth_send_transac
-0001d630: 7469 6f6e 5f77 6974 685f 6e6f 6e63 6528  tion_with_nonce(
-0001d640: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-0001d650: 333a 2022 5765 6233 222c 2075 6e6c 6f63  3: "Web3", unloc
-0001d660: 6b65 645f 6163 636f 756e 743a 2043 6865  ked_account: Che
-0001d670: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
-0001d680: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-0001d690: 2020 2020 6d61 785f 7072 696f 7269 7479      max_priority
-0001d6a0: 5f66 6565 5f70 6572 5f67 6173 203d 2077  _fee_per_gas = w
-0001d6b0: 332e 746f 5f77 6569 2831 2e32 3334 2c20  3.to_wei(1.234, 
-0001d6c0: 2267 7765 6922 290a 2020 2020 2020 2020  "gwei").        
-0001d6d0: 6d61 785f 6665 655f 7065 725f 6761 7320  max_fee_per_gas 
-0001d6e0: 3d20 5765 6928 0a20 2020 2020 2020 2020  = Wei(.         
-0001d6f0: 2020 2077 332e 6574 682e 6765 745f 626c     w3.eth.get_bl
-0001d700: 6f63 6b28 226c 6174 6573 7422 295b 2262  ock("latest")["b
-0001d710: 6173 6546 6565 5065 7247 6173 225d 202b  aseFeePerGas"] +
-0001d720: 206d 6178 5f70 7269 6f72 6974 795f 6665   max_priority_fe
-0001d730: 655f 7065 725f 6761 730a 2020 2020 2020  e_per_gas.      
-0001d740: 2020 290a 2020 2020 2020 2020 7478 6e5f    ).        txn_
-0001d750: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-0001d760: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0001d770: 2022 6672 6f6d 223a 2075 6e6c 6f63 6b65   "from": unlocke
-0001d780: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
-0001d790: 2020 2020 2020 2022 746f 223a 2075 6e6c         "to": unl
-0001d7a0: 6f63 6b65 645f 6163 636f 756e 742c 0a20  ocked_account,. 
-0001d7b0: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
-0001d7c0: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
-0001d7d0: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
-0001d7e0: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
-0001d7f0: 2020 226d 6178 4665 6550 6572 4761 7322    "maxFeePerGas"
-0001d800: 3a20 6d61 785f 6665 655f 7065 725f 6761  : max_fee_per_ga
-0001d810: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
-0001d820: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-0001d830: 7247 6173 223a 206d 6178 5f70 7269 6f72  rGas": max_prior
-0001d840: 6974 795f 6665 655f 7065 725f 6761 732c  ity_fee_per_gas,
-0001d850: 0a20 2020 2020 2020 2020 2020 2022 6e6f  .            "no
-0001d860: 6e63 6522 3a20 4e6f 6e63 6528 7733 2e65  nce": Nonce(w3.e
-0001d870: 7468 2e67 6574 5f74 7261 6e73 6163 7469  th.get_transacti
-0001d880: 6f6e 5f63 6f75 6e74 2875 6e6c 6f63 6b65  on_count(unlocke
-0001d890: 645f 6163 636f 756e 742c 2022 7065 6e64  d_account, "pend
-0001d8a0: 696e 6722 2929 2c0a 2020 2020 2020 2020  ing")),.        
-0001d8b0: 7d0a 2020 2020 2020 2020 7478 6e5f 6861  }.        txn_ha
-0001d8c0: 7368 203d 2077 332e 6574 682e 7365 6e64  sh = w3.eth.send
-0001d8d0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-0001d8e0: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
-0001d8f0: 2074 786e 203d 2077 332e 6574 682e 6765   txn = w3.eth.ge
-0001d900: 745f 7472 616e 7361 6374 696f 6e28 7478  t_transaction(tx
-0001d910: 6e5f 6861 7368 290a 0a20 2020 2020 2020  n_hash)..       
-0001d920: 2061 7373 6572 7420 6973 5f73 616d 655f   assert is_same_
-0001d930: 6164 6472 6573 7328 7478 6e5b 2266 726f  address(txn["fro
-0001d940: 6d22 5d2c 2063 6173 7428 4368 6563 6b73  m"], cast(Checks
-0001d950: 756d 4164 6472 6573 732c 2074 786e 5f70  umAddress, txn_p
-0001d960: 6172 616d 735b 2266 726f 6d22 5d29 290a  arams["from"])).
-0001d970: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-0001d980: 735f 7361 6d65 5f61 6464 7265 7373 2874  s_same_address(t
-0001d990: 786e 5b22 746f 225d 2c20 6361 7374 2843  xn["to"], cast(C
-0001d9a0: 6865 636b 7375 6d41 6464 7265 7373 2c20  hecksumAddress, 
-0001d9b0: 7478 6e5f 7061 7261 6d73 5b22 746f 225d  txn_params["to"]
-0001d9c0: 2929 0a20 2020 2020 2020 2061 7373 6572  )).        asser
-0001d9d0: 7420 7478 6e5b 2276 616c 7565 225d 203d  t txn["value"] =
-0001d9e0: 3d20 310a 2020 2020 2020 2020 6173 7365  = 1.        asse
-0001d9f0: 7274 2074 786e 5b22 6761 7322 5d20 3d3d  rt txn["gas"] ==
-0001da00: 2032 3130 3030 0a20 2020 2020 2020 2061   21000.        a
-0001da10: 7373 6572 7420 7478 6e5b 226d 6178 4665  ssert txn["maxFe
-0001da20: 6550 6572 4761 7322 5d20 3d3d 2074 786e  ePerGas"] == txn
-0001da30: 5f70 6172 616d 735b 226d 6178 4665 6550  _params["maxFeeP
-0001da40: 6572 4761 7322 5d0a 2020 2020 2020 2020  erGas"].        
-0001da50: 6173 7365 7274 2074 786e 5b22 6d61 7850  assert txn["maxP
-0001da60: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
-0001da70: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
-0001da80: 5b22 6d61 7850 7269 6f72 6974 7946 6565  ["maxPriorityFee
-0001da90: 5065 7247 6173 225d 0a20 2020 2020 2020  PerGas"].       
-0001daa0: 2061 7373 6572 7420 7478 6e5b 226e 6f6e   assert txn["non
-0001dab0: 6365 225d 203d 3d20 7478 6e5f 7061 7261  ce"] == txn_para
-0001dac0: 6d73 5b22 6e6f 6e63 6522 5d0a 2020 2020  ms["nonce"].    
-0001dad0: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
-0001dae0: 7465 6765 7228 7478 6e5b 2267 6173 5072  teger(txn["gasPr
-0001daf0: 6963 6522 5d29 0a20 2020 2020 2020 2061  ice"]).        a
-0001db00: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
-0001db10: 2874 786e 5f70 6172 616d 735b 226d 6178  (txn_params["max
-0001db20: 4665 6550 6572 4761 7322 5d29 0a0a 2020  FeePerGas"])..  
-0001db30: 2020 6465 6620 7465 7374 5f65 7468 5f73    def test_eth_s
-0001db40: 656e 645f 7472 616e 7361 6374 696f 6e5f  end_transaction_
-0001db50: 6465 6661 756c 745f 6665 6573 280a 2020  default_fees(.  
-0001db60: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
-0001db70: 2257 6562 3322 2c20 756e 6c6f 636b 6564  "Web3", unlocked
-0001db80: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
-0001db90: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
-0001dba0: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
-0001dbb0: 653a 0a20 2020 2020 2020 2074 786e 5f70  e:.        txn_p
-0001dbc0: 6172 616d 733a 2054 7850 6172 616d 7320  arams: TxParams 
-0001dbd0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0001dbe0: 2266 726f 6d22 3a20 756e 6c6f 636b 6564  "from": unlocked
-0001dbf0: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
-0001dc00: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-0001dc10: 2274 6f22 3a20 756e 6c6f 636b 6564 5f61  "to": unlocked_a
-0001dc20: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-0001dc30: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-0001dc40: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-0001dc50: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-0001dc60: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-0001dc70: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
-0001dc80: 6173 6820 3d20 7733 2e65 7468 2e73 656e  ash = w3.eth.sen
-0001dc90: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
-0001dca0: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
-0001dcb0: 2020 7478 6e20 3d20 7733 2e65 7468 2e67    txn = w3.eth.g
-0001dcc0: 6574 5f74 7261 6e73 6163 7469 6f6e 2874  et_transaction(t
-0001dcd0: 786e 5f68 6173 6829 0a0a 2020 2020 2020  xn_hash)..      
-0001dce0: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
-0001dcf0: 5f61 6464 7265 7373 2874 786e 5b22 6672  _address(txn["fr
-0001dd00: 6f6d 225d 2c20 6361 7374 2843 6865 636b  om"], cast(Check
-0001dd10: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
-0001dd20: 7061 7261 6d73 5b22 6672 6f6d 225d 2929  params["from"]))
-0001dd30: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001dd40: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
-0001dd50: 7478 6e5b 2274 6f22 5d2c 2063 6173 7428  txn["to"], cast(
-0001dd60: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-0001dd70: 2074 786e 5f70 6172 616d 735b 2274 6f22   txn_params["to"
-0001dd80: 5d29 290a 2020 2020 2020 2020 6173 7365  ])).        asse
-0001dd90: 7274 2074 786e 5b22 7661 6c75 6522 5d20  rt txn["value"] 
-0001dda0: 3d3d 2031 0a20 2020 2020 2020 2061 7373  == 1.        ass
-0001ddb0: 6572 7420 7478 6e5b 2267 6173 225d 203d  ert txn["gas"] =
-0001ddc0: 3d20 3231 3030 300a 2020 2020 2020 2020  = 21000.        
-0001ddd0: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
-0001dde0: 7228 7478 6e5b 226d 6178 5072 696f 7269  r(txn["maxPriori
-0001ddf0: 7479 4665 6550 6572 4761 7322 5d29 0a20  tyFeePerGas"]). 
-0001de00: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-0001de10: 5f69 6e74 6567 6572 2874 786e 5b22 6d61  _integer(txn["ma
-0001de20: 7846 6565 5065 7247 6173 225d 290a 2020  xFeePerGas"]).  
-0001de30: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
-0001de40: 5b22 6761 7350 7269 6365 225d 203d 3d20  ["gasPrice"] == 
-0001de50: 7478 6e5b 226d 6178 4665 6550 6572 4761  txn["maxFeePerGa
-0001de60: 7322 5d0a 0a20 2020 2064 6566 2074 6573  s"]..    def tes
-0001de70: 745f 6574 685f 7365 6e64 5f74 7261 6e73  t_eth_send_trans
-0001de80: 6163 7469 6f6e 5f68 6578 5f66 6565 7328  action_hex_fees(
-0001de90: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-0001dea0: 333a 2022 5765 6233 222c 2075 6e6c 6f63  3: "Web3", unloc
-0001deb0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-0001dec0: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
-0001ded0: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
-0001dee0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
-0001def0: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
-0001df00: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-0001df10: 2020 2022 6672 6f6d 223a 2075 6e6c 6f63     "from": unloc
-0001df20: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-0001df30: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-0001df40: 2020 2022 746f 223a 2075 6e6c 6f63 6b65     "to": unlocke
-0001df50: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-0001df60: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-0001df70: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
-0001df80: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-0001df90: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
-0001dfa0: 2020 2020 2020 2020 226d 6178 4665 6550          "maxFeeP
-0001dfb0: 6572 4761 7322 3a20 6865 7828 3235 3020  erGas": hex(250 
-0001dfc0: 2a20 3130 2a2a 3929 2c0a 2020 2020 2020  * 10**9),.      
-0001dfd0: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
-0001dfe0: 7479 4665 6550 6572 4761 7322 3a20 6865  tyFeePerGas": he
-0001dff0: 7828 3220 2a20 3130 2a2a 3929 2c0a 2020  x(2 * 10**9),.  
-0001e000: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0001e010: 7478 6e5f 6861 7368 203d 2077 332e 6574  txn_hash = w3.et
-0001e020: 682e 7365 6e64 5f74 7261 6e73 6163 7469  h.send_transacti
-0001e030: 6f6e 2874 786e 5f70 6172 616d 7329 0a20  on(txn_params). 
-0001e040: 2020 2020 2020 2074 786e 203d 2077 332e         txn = w3.
-0001e050: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
-0001e060: 696f 6e28 7478 6e5f 6861 7368 290a 0a20  ion(txn_hash).. 
-0001e070: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-0001e080: 5f73 616d 655f 6164 6472 6573 7328 7478  _same_address(tx
-0001e090: 6e5b 2266 726f 6d22 5d2c 2063 6173 7428  n["from"], cast(
-0001e0a0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-0001e0b0: 2074 786e 5f70 6172 616d 735b 2266 726f   txn_params["fro
-0001e0c0: 6d22 5d29 290a 2020 2020 2020 2020 6173  m"])).        as
-0001e0d0: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
-0001e0e0: 7265 7373 2874 786e 5b22 746f 225d 2c20  ress(txn["to"], 
-0001e0f0: 6361 7374 2843 6865 636b 7375 6d41 6464  cast(ChecksumAdd
-0001e100: 7265 7373 2c20 7478 6e5f 7061 7261 6d73  ress, txn_params
-0001e110: 5b22 746f 225d 2929 0a20 2020 2020 2020  ["to"])).       
-0001e120: 2061 7373 6572 7420 7478 6e5b 2276 616c   assert txn["val
-0001e130: 7565 225d 203d 3d20 310a 2020 2020 2020  ue"] == 1.      
-0001e140: 2020 6173 7365 7274 2074 786e 5b22 6761    assert txn["ga
-0001e150: 7322 5d20 3d3d 2032 3130 3030 0a20 2020  s"] == 21000.   
-0001e160: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
-0001e170: 226d 6178 4665 6550 6572 4761 7322 5d20  "maxFeePerGas"] 
-0001e180: 3d3d 2032 3530 202a 2031 302a 2a39 0a20  == 250 * 10**9. 
-0001e190: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
-0001e1a0: 6e5b 226d 6178 5072 696f 7269 7479 4665  n["maxPriorityFe
-0001e1b0: 6550 6572 4761 7322 5d20 3d3d 2032 202a  ePerGas"] == 2 *
-0001e1c0: 2031 302a 2a39 0a0a 2020 2020 6465 6620   10**9..    def 
-0001e1d0: 7465 7374 5f65 7468 5f73 656e 645f 7472  test_eth_send_tr
-0001e1e0: 616e 7361 6374 696f 6e5f 6e6f 5f67 6173  ansaction_no_gas
-0001e1f0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-0001e200: 7733 3a20 2257 6562 3322 2c20 756e 6c6f  w3: "Web3", unlo
-0001e210: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-0001e220: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-0001e230: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-0001e240: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
-0001e250: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
-0001e260: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-0001e270: 2020 2020 2266 726f 6d22 3a20 756e 6c6f      "from": unlo
-0001e280: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-0001e290: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-0001e2a0: 2020 2020 2274 6f22 3a20 756e 6c6f 636b      "to": unlock
-0001e2b0: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
-0001e2c0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-0001e2d0: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
-0001e2e0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-0001e2f0: 6d61 7846 6565 5065 7247 6173 223a 2057  maxFeePerGas": W
-0001e300: 6569 2832 3530 202a 2031 302a 2a39 292c  ei(250 * 10**9),
-0001e310: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
-0001e320: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-0001e330: 6173 223a 2057 6569 2832 202a 2031 302a  as": Wei(2 * 10*
-0001e340: 2a39 292c 0a20 2020 2020 2020 207d 0a20  *9),.        }. 
-0001e350: 2020 2020 2020 2074 786e 5f68 6173 6820         txn_hash 
-0001e360: 3d20 7733 2e65 7468 2e73 656e 645f 7472  = w3.eth.send_tr
-0001e370: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
-0001e380: 7261 6d73 290a 2020 2020 2020 2020 7478  rams).        tx
-0001e390: 6e20 3d20 7733 2e65 7468 2e67 6574 5f74  n = w3.eth.get_t
-0001e3a0: 7261 6e73 6163 7469 6f6e 2874 786e 5f68  ransaction(txn_h
-0001e3b0: 6173 6829 0a0a 2020 2020 2020 2020 6173  ash)..        as
-0001e3c0: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
-0001e3d0: 7265 7373 2874 786e 5b22 6672 6f6d 225d  ress(txn["from"]
-0001e3e0: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
-0001e3f0: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
-0001e400: 6d73 5b22 6672 6f6d 225d 2929 0a20 2020  ms["from"])).   
-0001e410: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
-0001e420: 616d 655f 6164 6472 6573 7328 7478 6e5b  ame_address(txn[
-0001e430: 2274 6f22 5d2c 2063 6173 7428 4368 6563  "to"], cast(Chec
-0001e440: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
-0001e450: 5f70 6172 616d 735b 2274 6f22 5d29 290a  _params["to"])).
-0001e460: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-0001e470: 786e 5b22 7661 6c75 6522 5d20 3d3d 2031  xn["value"] == 1
-0001e480: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001e490: 7478 6e5b 2267 6173 225d 203d 3d20 3132  txn["gas"] == 12
-0001e4a0: 3130 3030 2020 2320 3231 3030 3020 2b20  1000  # 21000 + 
-0001e4b0: 6275 6666 6572 0a0a 2020 2020 6465 6620  buffer..    def 
-0001e4c0: 7465 7374 5f65 7468 5f73 656e 645f 7472  test_eth_send_tr
-0001e4d0: 616e 7361 6374 696f 6e5f 7769 7468 5f67  ansaction_with_g
-0001e4e0: 6173 5f70 7269 6365 280a 2020 2020 2020  as_price(.      
-0001e4f0: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
-0001e500: 3322 2c20 756e 6c6f 636b 6564 5f61 6363  3", unlocked_acc
-0001e510: 6f75 6e74 5f64 7561 6c5f 7479 7065 3a20  ount_dual_type: 
-0001e520: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
-0001e530: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-0001e540: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-0001e550: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-0001e560: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-0001e570: 6d22 3a20 756e 6c6f 636b 6564 5f61 6363  m": unlocked_acc
-0001e580: 6f75 6e74 5f64 7561 6c5f 7479 7065 2c0a  ount_dual_type,.
-0001e590: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
-0001e5a0: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
-0001e5b0: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
-0001e5c0: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-0001e5d0: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-0001e5e0: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
-0001e5f0: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
-0001e600: 2022 6761 7350 7269 6365 223a 2057 6569   "gasPrice": Wei
-0001e610: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
-0001e620: 2022 6d61 7846 6565 5065 7247 6173 223a   "maxFeePerGas":
-0001e630: 2057 6569 2832 3530 202a 2031 302a 2a39   Wei(250 * 10**9
-0001e640: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-0001e650: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-0001e660: 7247 6173 223a 2057 6569 2832 202a 2031  rGas": Wei(2 * 1
-0001e670: 302a 2a39 292c 0a20 2020 2020 2020 207d  0**9),.        }
-0001e680: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-0001e690: 7465 7374 2e72 6169 7365 7328 5472 616e  test.raises(Tran
-0001e6a0: 7361 6374 696f 6e54 7970 654d 6973 6d61  sactionTypeMisma
-0001e6b0: 7463 6829 3a0a 2020 2020 2020 2020 2020  tch):.          
-0001e6c0: 2020 7733 2e65 7468 2e73 656e 645f 7472    w3.eth.send_tr
-0001e6d0: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
-0001e6e0: 7261 6d73 290a 0a20 2020 2064 6566 2074  rams)..    def t
-0001e6f0: 6573 745f 6574 685f 7365 6e64 5f74 7261  est_eth_send_tra
-0001e700: 6e73 6163 7469 6f6e 5f6e 6f5f 7072 696f  nsaction_no_prio
-0001e710: 7269 7479 5f66 6565 280a 2020 2020 2020  rity_fee(.      
-0001e720: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
-0001e730: 3322 2c20 756e 6c6f 636b 6564 5f61 6363  3", unlocked_acc
-0001e740: 6f75 6e74 5f64 7561 6c5f 7479 7065 3a20  ount_dual_type: 
-0001e750: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
-0001e760: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-0001e770: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-0001e780: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-0001e790: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-0001e7a0: 6d22 3a20 756e 6c6f 636b 6564 5f61 6363  m": unlocked_acc
-0001e7b0: 6f75 6e74 5f64 7561 6c5f 7479 7065 2c0a  ount_dual_type,.
-0001e7c0: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
-0001e7d0: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
-0001e7e0: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
-0001e7f0: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-0001e800: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-0001e810: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
-0001e820: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
-0001e830: 2022 6d61 7846 6565 5065 7247 6173 223a   "maxFeePerGas":
-0001e840: 2057 6569 2832 3530 202a 2031 302a 2a39   Wei(250 * 10**9
-0001e850: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
-0001e860: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-0001e870: 2e72 6169 7365 7328 0a20 2020 2020 2020  .raises(.       
-0001e880: 2020 2020 2049 6e76 616c 6964 5472 616e       InvalidTran
-0001e890: 7361 6374 696f 6e2c 206d 6174 6368 3d22  saction, match="
-0001e8a0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-0001e8b0: 7247 6173 206d 7573 7420 6265 2064 6566  rGas must be def
-0001e8c0: 696e 6564 220a 2020 2020 2020 2020 293a  ined".        ):
-0001e8d0: 0a20 2020 2020 2020 2020 2020 2077 332e  .            w3.
-0001e8e0: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
-0001e8f0: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
-0001e900: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-0001e910: 7468 5f73 656e 645f 7472 616e 7361 6374  th_send_transact
-0001e920: 696f 6e5f 6e6f 5f6d 6178 5f66 6565 280a  ion_no_max_fee(.
-0001e930: 2020 2020 2020 2020 7365 6c66 2c20 7733          self, w3
-0001e940: 3a20 2257 6562 3322 2c20 756e 6c6f 636b  : "Web3", unlock
-0001e950: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
-0001e960: 7479 7065 3a20 4368 6563 6b73 756d 4164  type: ChecksumAd
-0001e970: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
-0001e980: 6f6e 653a 0a20 2020 2020 2020 206d 6178  one:.        max
-0001e990: 5f70 7269 6f72 6974 795f 6665 655f 7065  _priority_fee_pe
-0001e9a0: 725f 6761 7320 3d20 7733 2e74 6f5f 7765  r_gas = w3.to_we
-0001e9b0: 6928 322c 2022 6777 6569 2229 0a20 2020  i(2, "gwei").   
-0001e9c0: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-0001e9d0: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-0001e9e0: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-0001e9f0: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
-0001ea00: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
-0001ea10: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
-0001ea20: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-0001ea30: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-0001ea40: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
-0001ea50: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
-0001ea60: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
-0001ea70: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
-0001ea80: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-0001ea90: 7247 6173 223a 206d 6178 5f70 7269 6f72  rGas": max_prior
-0001eaa0: 6974 795f 6665 655f 7065 725f 6761 732c  ity_fee_per_gas,
-0001eab0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-0001eac0: 2020 2074 786e 5f68 6173 6820 3d20 7733     txn_hash = w3
-0001ead0: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
-0001eae0: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
-0001eaf0: 290a 2020 2020 2020 2020 7478 6e20 3d20  ).        txn = 
-0001eb00: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
-0001eb10: 6163 7469 6f6e 2874 786e 5f68 6173 6829  action(txn_hash)
-0001eb20: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-0001eb30: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
-0001eb40: 2874 786e 5b22 6672 6f6d 225d 2c20 6361  (txn["from"], ca
-0001eb50: 7374 2843 6865 636b 7375 6d41 6464 7265  st(ChecksumAddre
-0001eb60: 7373 2c20 7478 6e5f 7061 7261 6d73 5b22  ss, txn_params["
-0001eb70: 6672 6f6d 225d 2929 0a20 2020 2020 2020  from"])).       
-0001eb80: 2061 7373 6572 7420 6973 5f73 616d 655f   assert is_same_
-0001eb90: 6164 6472 6573 7328 7478 6e5b 2274 6f22  address(txn["to"
-0001eba0: 5d2c 2063 6173 7428 4368 6563 6b73 756d  ], cast(Checksum
-0001ebb0: 4164 6472 6573 732c 2074 786e 5f70 6172  Address, txn_par
-0001ebc0: 616d 735b 2274 6f22 5d29 290a 2020 2020  ams["to"])).    
-0001ebd0: 2020 2020 6173 7365 7274 2074 786e 5b22      assert txn["
-0001ebe0: 7661 6c75 6522 5d20 3d3d 2031 0a20 2020  value"] == 1.   
-0001ebf0: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
-0001ec00: 2267 6173 225d 203d 3d20 3231 3030 300a  "gas"] == 21000.
-0001ec10: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-0001ec20: 735f 696e 7465 6765 7228 7478 6e5b 226d  s_integer(txn["m
-0001ec30: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
-0001ec40: 4761 7322 5d29 0a20 2020 2020 2020 2061  Gas"]).        a
-0001ec50: 7373 6572 7420 7478 6e5b 226d 6178 5072  ssert txn["maxPr
-0001ec60: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
-0001ec70: 5d20 3d3d 206d 6178 5f70 7269 6f72 6974  ] == max_priorit
-0001ec80: 795f 6665 655f 7065 725f 6761 730a 2020  y_fee_per_gas.  
-0001ec90: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-0001eca0: 696e 7465 6765 7228 7478 6e5b 226d 6178  integer(txn["max
-0001ecb0: 4665 6550 6572 4761 7322 5d29 0a0a 2020  FeePerGas"])..  
-0001ecc0: 2020 6465 6620 7465 7374 5f65 7468 5f73    def test_eth_s
-0001ecd0: 656e 645f 7472 616e 7361 6374 696f 6e5f  end_transaction_
-0001ece0: 6d61 785f 6665 655f 6c65 7373 5f74 6861  max_fee_less_tha
-0001ecf0: 6e5f 7469 7028 0a20 2020 2020 2020 2073  n_tip(.        s
-0001ed00: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
-0001ed10: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
-0001ed20: 745f 6475 616c 5f74 7970 653a 2043 6865  t_dual_type: Che
-0001ed30: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
-0001ed40: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-0001ed50: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
-0001ed60: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
-0001ed70: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
-0001ed80: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
-0001ed90: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
-0001eda0: 2020 2020 2020 2020 2022 746f 223a 2075           "to": u
-0001edb0: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
-0001edc0: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
-0001edd0: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
-0001ede0: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
-0001edf0: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
-0001ee00: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
-0001ee10: 6178 4665 6550 6572 4761 7322 3a20 5765  axFeePerGas": We
-0001ee20: 6928 3120 2a20 3130 2a2a 3929 2c0a 2020  i(1 * 10**9),.  
-0001ee30: 2020 2020 2020 2020 2020 226d 6178 5072            "maxPr
-0001ee40: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
-0001ee50: 3a20 5765 6928 3220 2a20 3130 2a2a 3929  : Wei(2 * 10**9)
-0001ee60: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-0001ee70: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-0001ee80: 7261 6973 6573 280a 2020 2020 2020 2020  raises(.        
-0001ee90: 2020 2020 496e 7661 6c69 6454 7261 6e73      InvalidTrans
-0001eea0: 6163 7469 6f6e 2c20 6d61 7463 683d 226d  action, match="m
-0001eeb0: 6178 4665 6550 6572 4761 7320 6d75 7374  axFeePerGas must
-0001eec0: 2062 6520 3e3d 206d 6178 5072 696f 7269   be >= maxPriori
-0001eed0: 7479 4665 6550 6572 4761 7322 0a20 2020  tyFeePerGas".   
-0001eee0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-0001eef0: 2020 2020 7733 2e65 7468 2e73 656e 645f      w3.eth.send_
-0001ef00: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
-0001ef10: 7061 7261 6d73 290a 0a20 2020 2064 6566  params)..    def
-0001ef20: 2074 6573 745f 7661 6c69 6461 7469 6f6e   test_validation
-0001ef30: 5f6d 6964 646c 6577 6172 655f 6368 6169  _middleware_chai
-0001ef40: 6e5f 6964 5f6d 6973 6d61 7463 6828 0a20  n_id_mismatch(. 
-0001ef50: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
-0001ef60: 2022 5765 6233 222c 2075 6e6c 6f63 6b65   "Web3", unlocke
-0001ef70: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-0001ef80: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-0001ef90: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-0001efa0: 6e65 3a0a 2020 2020 2020 2020 7772 6f6e  ne:.        wron
-0001efb0: 675f 6368 6169 6e5f 6964 203d 2031 3233  g_chain_id = 123
-0001efc0: 3435 3637 3839 300a 2020 2020 2020 2020  4567890.        
-0001efd0: 6163 7475 616c 5f63 6861 696e 5f69 6420  actual_chain_id 
-0001efe0: 3d20 7733 2e65 7468 2e63 6861 696e 5f69  = w3.eth.chain_i
-0001eff0: 640a 0a20 2020 2020 2020 2074 786e 5f70  d..        txn_p
-0001f000: 6172 616d 733a 2054 7850 6172 616d 7320  arams: TxParams 
-0001f010: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0001f020: 2266 726f 6d22 3a20 756e 6c6f 636b 6564  "from": unlocked
-0001f030: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
-0001f040: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-0001f050: 2274 6f22 3a20 756e 6c6f 636b 6564 5f61  "to": unlocked_a
-0001f060: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-0001f070: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-0001f080: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-0001f090: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-0001f0a0: 3a20 5765 6928 3231 3030 3029 2c0a 2020  : Wei(21000),.  
-0001f0b0: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
-0001f0c0: 6550 6572 4761 7322 3a20 7733 2e74 6f5f  ePerGas": w3.to_
-0001f0d0: 7765 6928 322c 2022 6777 6569 2229 2c0a  wei(2, "gwei"),.
-0001f0e0: 2020 2020 2020 2020 2020 2020 226d 6178              "max
-0001f0f0: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
-0001f100: 7322 3a20 7733 2e74 6f5f 7765 6928 312c  s": w3.to_wei(1,
-0001f110: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
-0001f120: 2020 2020 2020 2263 6861 696e 4964 223a        "chainId":
-0001f130: 2077 726f 6e67 5f63 6861 696e 5f69 642c   wrong_chain_id,
-0001f140: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-0001f150: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-0001f160: 6169 7365 7328 0a20 2020 2020 2020 2020  aises(.         
-0001f170: 2020 2057 6562 3356 616c 6964 6174 696f     Web3Validatio
-0001f180: 6e45 7272 6f72 2c0a 2020 2020 2020 2020  nError,.        
-0001f190: 2020 2020 6d61 7463 683d 6622 5468 6520      match=f"The 
-0001f1a0: 7472 616e 7361 6374 696f 6e20 6465 636c  transaction decl
-0001f1b0: 6172 6564 2063 6861 696e 2049 4420 7b77  ared chain ID {w
-0001f1c0: 726f 6e67 5f63 6861 696e 5f69 647d 2c20  rong_chain_id}, 
-0001f1d0: 220a 2020 2020 2020 2020 2020 2020 6622  ".            f"
-0001f1e0: 6275 7420 7468 6520 636f 6e6e 6563 7465  but the connecte
-0001f1f0: 6420 6e6f 6465 2069 7320 6f6e 207b 6163  d node is on {ac
-0001f200: 7475 616c 5f63 6861 696e 5f69 647d 222c  tual_chain_id}",
-0001f210: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-0001f220: 2020 2020 2020 2020 7733 2e65 7468 2e73          w3.eth.s
-0001f230: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
-0001f240: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
-0001f250: 2040 7079 7465 7374 2e6d 6172 6b2e 7061   @pytest.mark.pa
-0001f260: 7261 6d65 7472 697a 6528 0a20 2020 2020  rametrize(.     
-0001f270: 2020 2022 6d61 785f 6665 6522 2c20 2831     "max_fee", (1
-0001f280: 3030 3030 3030 3030 302c 204e 6f6e 6529  000000000, None)
-0001f290: 2c20 6964 733d 5b22 7769 7468 5f6d 6178  , ids=["with_max
-0001f2a0: 5f66 6565 222c 2022 7769 7468 6f75 745f  _fee", "without_
-0001f2b0: 6d61 785f 6665 6522 5d0a 2020 2020 290a  max_fee"].    ).
-0001f2c0: 2020 2020 6465 6620 7465 7374 5f67 6173      def test_gas
-0001f2d0: 5f70 7269 6365 5f66 726f 6d5f 7374 7261  _price_from_stra
-0001f2e0: 7465 6779 5f62 7970 6173 7365 645f 666f  tegy_bypassed_fo
-0001f2f0: 725f 6479 6e61 6d69 635f 6665 655f 7478  r_dynamic_fee_tx
-0001f300: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
-0001f310: 2077 333a 2022 5765 6233 222c 2075 6e6c   w3: "Web3", unl
-0001f320: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
-0001f330: 616c 5f74 7970 653a 2043 6865 636b 7375  al_type: Checksu
-0001f340: 6d41 6464 7265 7373 2c20 6d61 785f 6665  mAddress, max_fe
-0001f350: 653a 2057 6569 0a20 2020 2029 202d 3e20  e: Wei.    ) -> 
-0001f360: 4e6f 6e65 3a0a 2020 2020 2020 2020 6d61  None:.        ma
-0001f370: 785f 7072 696f 7269 7479 5f66 6565 203d  x_priority_fee =
-0001f380: 2077 332e 746f 5f77 6569 2831 2c20 2267   w3.to_wei(1, "g
-0001f390: 7765 6922 290a 2020 2020 2020 2020 7478  wei").        tx
-0001f3a0: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
-0001f3b0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-0001f3c0: 2020 2022 6672 6f6d 223a 2075 6e6c 6f63     "from": unloc
-0001f3d0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-0001f3e0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-0001f3f0: 2020 2022 746f 223a 2075 6e6c 6f63 6b65     "to": unlocke
-0001f400: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-0001f410: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-0001f420: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
-0001f430: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-0001f440: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
-0001f450: 2020 2020 2020 2020 226d 6178 5072 696f          "maxPrio
-0001f460: 7269 7479 4665 6550 6572 4761 7322 3a20  rityFeePerGas": 
-0001f470: 6d61 785f 7072 696f 7269 7479 5f66 6565  max_priority_fee
-0001f480: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-0001f490: 2020 2020 6966 206d 6178 5f66 6565 2069      if max_fee i
-0001f4a0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0001f4b0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-0001f4c0: 6d73 203d 2061 7373 6f63 2874 786e 5f70  ms = assoc(txn_p
-0001f4d0: 6172 616d 732c 2022 6d61 7846 6565 5065  arams, "maxFeePe
-0001f4e0: 7247 6173 222c 206d 6178 5f66 6565 290a  rGas", max_fee).
-0001f4f0: 0a20 2020 2020 2020 2064 6566 2067 6173  .        def gas
-0001f500: 5f70 7269 6365 5f73 7472 6174 6567 7928  _price_strategy(
-0001f510: 5f77 333a 2022 5765 6233 222c 205f 7478  _w3: "Web3", _tx
-0001f520: 6e3a 2054 7850 6172 616d 7329 202d 3e20  n: TxParams) -> 
-0001f530: 5765 693a 0a20 2020 2020 2020 2020 2020  Wei:.           
-0001f540: 2072 6574 7572 6e20 7733 2e74 6f5f 7765   return w3.to_we
-0001f550: 6928 322c 2022 6777 6569 2229 0a0a 2020  i(2, "gwei")..  
-0001f560: 2020 2020 2020 7733 2e65 7468 2e73 6574        w3.eth.set
-0001f570: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
-0001f580: 6567 7928 6761 735f 7072 6963 655f 7374  egy(gas_price_st
-0001f590: 7261 7465 6779 290a 0a20 2020 2020 2020  rategy)..       
-0001f5a0: 2074 786e 5f68 6173 6820 3d20 7733 2e65   txn_hash = w3.e
-0001f5b0: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
-0001f5c0: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
-0001f5d0: 2020 2020 2020 2020 7478 6e20 3d20 7733          txn = w3
-0001f5e0: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
-0001f5f0: 7469 6f6e 2874 786e 5f68 6173 6829 0a0a  tion(txn_hash)..
-0001f600: 2020 2020 2020 2020 6c61 7465 7374 5f62          latest_b
-0001f610: 6c6f 636b 203d 2077 332e 6574 682e 6765  lock = w3.eth.ge
-0001f620: 745f 626c 6f63 6b28 226c 6174 6573 7422  t_block("latest"
-0001f630: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-0001f640: 2028 0a20 2020 2020 2020 2020 2020 2074   (.            t
-0001f650: 786e 5b22 6d61 7846 6565 5065 7247 6173  xn["maxFeePerGas
-0001f660: 225d 203d 3d20 6d61 785f 6665 650a 2020  "] == max_fee.  
-0001f670: 2020 2020 2020 2020 2020 6966 206d 6178            if max
-0001f680: 5f66 6565 2069 7320 6e6f 7420 4e6f 6e65  _fee is not None
-0001f690: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0001f6a0: 6520 3220 2a20 6c61 7465 7374 5f62 6c6f  e 2 * latest_blo
-0001f6b0: 636b 5b22 6261 7365 4665 6550 6572 4761  ck["baseFeePerGa
-0001f6c0: 7322 5d20 2b20 6d61 785f 7072 696f 7269  s"] + max_priori
-0001f6d0: 7479 5f66 6565 0a20 2020 2020 2020 2029  ty_fee.        )
-0001f6e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001f6f0: 7478 6e5b 226d 6178 5072 696f 7269 7479  txn["maxPriority
-0001f700: 4665 6550 6572 4761 7322 5d20 3d3d 206d  FeePerGas"] == m
-0001f710: 6178 5f70 7269 6f72 6974 795f 6665 650a  ax_priority_fee.
-0001f720: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-0001f730: 786e 5b22 6761 7350 7269 6365 225d 203d  xn["gasPrice"] =
-0001f740: 3d20 7478 6e5b 226d 6178 4665 6550 6572  = txn["maxFeePer
-0001f750: 4761 7322 5d0a 0a20 2020 2020 2020 2077  Gas"]..        w
-0001f760: 332e 6574 682e 7365 745f 6761 735f 7072  3.eth.set_gas_pr
-0001f770: 6963 655f 7374 7261 7465 6779 284e 6f6e  ice_strategy(Non
-0001f780: 6529 2020 2320 7265 7365 7420 7374 7261  e)  # reset stra
-0001f790: 7465 6779 0a0a 2020 2020 6465 6620 7465  tegy..    def te
-0001f7a0: 7374 5f67 6173 5f70 7269 6365 5f66 726f  st_gas_price_fro
-0001f7b0: 6d5f 7374 7261 7465 6779 5f62 7970 6173  m_strategy_bypas
-0001f7c0: 7365 645f 666f 725f 6479 6e61 6d69 635f  sed_for_dynamic_
-0001f7d0: 6665 655f 7478 6e5f 6e6f 5f74 6970 280a  fee_txn_no_tip(.
-0001f7e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0001f7f0: 2020 2020 2020 7733 3a20 2257 6562 3322        w3: "Web3"
-0001f800: 2c0a 2020 2020 2020 2020 756e 6c6f 636b  ,.        unlock
-0001f810: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
-0001f820: 7479 7065 3a20 4368 6563 6b73 756d 4164  type: ChecksumAd
-0001f830: 6472 6573 732c 0a20 2020 2029 202d 3e20  dress,.    ) -> 
-0001f840: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
-0001f850: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
-0001f860: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-0001f870: 2020 2022 6672 6f6d 223a 2075 6e6c 6f63     "from": unloc
-0001f880: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-0001f890: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-0001f8a0: 2020 2022 746f 223a 2075 6e6c 6f63 6b65     "to": unlocke
-0001f8b0: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-0001f8c0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-0001f8d0: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
-0001f8e0: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-0001f8f0: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
-0001f900: 2020 2020 2020 2020 226d 6178 4665 6550          "maxFeeP
-0001f910: 6572 4761 7322 3a20 5765 6928 3130 3030  erGas": Wei(1000
-0001f920: 3030 3030 3030 292c 0a20 2020 2020 2020  000000),.       
-0001f930: 207d 0a0a 2020 2020 2020 2020 6465 6620   }..        def 
-0001f940: 6761 735f 7072 6963 655f 7374 7261 7465  gas_price_strate
-0001f950: 6779 285f 7733 3a20 2257 6562 3322 2c20  gy(_w3: "Web3", 
-0001f960: 5f74 786e 3a20 5478 5061 7261 6d73 2920  _txn: TxParams) 
-0001f970: 2d3e 2057 6569 3a0a 2020 2020 2020 2020  -> Wei:.        
-0001f980: 2020 2020 7265 7475 726e 2077 332e 746f      return w3.to
-0001f990: 5f77 6569 2832 2c20 2267 7765 6922 290a  _wei(2, "gwei").
-0001f9a0: 0a20 2020 2020 2020 2077 332e 6574 682e  .        w3.eth.
-0001f9b0: 7365 745f 6761 735f 7072 6963 655f 7374  set_gas_price_st
-0001f9c0: 7261 7465 6779 2867 6173 5f70 7269 6365  rategy(gas_price
-0001f9d0: 5f73 7472 6174 6567 7929 0a0a 2020 2020  _strategy)..    
-0001f9e0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-0001f9f0: 7261 6973 6573 280a 2020 2020 2020 2020  raises(.        
-0001fa00: 2020 2020 496e 7661 6c69 6454 7261 6e73      InvalidTrans
-0001fa10: 6163 7469 6f6e 2c20 6d61 7463 683d 226d  action, match="m
-0001fa20: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
-0001fa30: 4761 7320 6d75 7374 2062 6520 6465 6669  Gas must be defi
-0001fa40: 6e65 6422 0a20 2020 2020 2020 2029 3a0a  ned".        ):.
-0001fa50: 2020 2020 2020 2020 2020 2020 7733 2e65              w3.e
-0001fa60: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
-0001fa70: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
-0001fa80: 0a20 2020 2020 2020 2077 332e 6574 682e  .        w3.eth.
-0001fa90: 7365 745f 6761 735f 7072 6963 655f 7374  set_gas_price_st
-0001faa0: 7261 7465 6779 284e 6f6e 6529 2020 2320  rategy(None)  # 
-0001fab0: 7265 7365 7420 7374 7261 7465 6779 0a0a  reset strategy..
-0001fac0: 2020 2020 6465 6620 7465 7374 5f67 6173      def test_gas
-0001fad0: 5f70 7269 6365 5f73 7472 6174 6567 795f  _price_strategy_
-0001fae0: 6865 785f 7661 6c75 6528 0a20 2020 2020  hex_value(.     
-0001faf0: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
-0001fb00: 6233 222c 2075 6e6c 6f63 6b65 645f 6163  b3", unlocked_ac
-0001fb10: 636f 756e 745f 6475 616c 5f74 7970 653a  count_dual_type:
-0001fb20: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-0001fb30: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0001fb40: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-0001fb50: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
-0001fb60: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
-0001fb70: 6f6d 223a 2075 6e6c 6f63 6b65 645f 6163  om": unlocked_ac
-0001fb80: 636f 756e 745f 6475 616c 5f74 7970 652c  count_dual_type,
-0001fb90: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
-0001fba0: 223a 2075 6e6c 6f63 6b65 645f 6163 636f  ": unlocked_acco
-0001fbb0: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
-0001fbc0: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
-0001fbd0: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
-0001fbe0: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
-0001fbf0: 3130 3030 2c0a 2020 2020 2020 2020 7d0a  1000,.        }.
-0001fc00: 2020 2020 2020 2020 7477 6f5f 6777 6569          two_gwei
-0001fc10: 5f69 6e5f 7765 6920 3d20 7733 2e74 6f5f  _in_wei = w3.to_
-0001fc20: 7765 6928 322c 2022 6777 6569 2229 0a0a  wei(2, "gwei")..
-0001fc30: 2020 2020 2020 2020 6465 6620 6761 735f          def gas_
-0001fc40: 7072 6963 655f 7374 7261 7465 6779 285f  price_strategy(_
-0001fc50: 7733 3a20 2257 6562 3322 2c20 5f74 786e  w3: "Web3", _txn
-0001fc60: 3a20 5478 5061 7261 6d73 2920 2d3e 2073  : TxParams) -> s
-0001fc70: 7472 3a0a 2020 2020 2020 2020 2020 2020  tr:.            
-0001fc80: 7265 7475 726e 2068 6578 2874 776f 5f67  return hex(two_g
-0001fc90: 7765 695f 696e 5f77 6569 290a 0a20 2020  wei_in_wei)..   
-0001fca0: 2020 2020 2077 332e 6574 682e 7365 745f       w3.eth.set_
-0001fcb0: 6761 735f 7072 6963 655f 7374 7261 7465  gas_price_strate
-0001fcc0: 6779 2867 6173 5f70 7269 6365 5f73 7472  gy(gas_price_str
-0001fcd0: 6174 6567 7929 2020 2320 7479 7065 3a20  ategy)  # type: 
-0001fce0: 6967 6e6f 7265 0a0a 2020 2020 2020 2020  ignore..        
-0001fcf0: 7478 6e5f 6861 7368 203d 2077 332e 6574  txn_hash = w3.et
-0001fd00: 682e 7365 6e64 5f74 7261 6e73 6163 7469  h.send_transacti
-0001fd10: 6f6e 2874 786e 5f70 6172 616d 7329 0a20  on(txn_params). 
-0001fd20: 2020 2020 2020 2074 786e 203d 2077 332e         txn = w3.
-0001fd30: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
-0001fd40: 696f 6e28 7478 6e5f 6861 7368 290a 0a20  ion(txn_hash).. 
-0001fd50: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
-0001fd60: 6e5b 2267 6173 5072 6963 6522 5d20 3d3d  n["gasPrice"] ==
-0001fd70: 2074 776f 5f67 7765 695f 696e 5f77 6569   two_gwei_in_wei
-0001fd80: 0a20 2020 2020 2020 2077 332e 6574 682e  .        w3.eth.
-0001fd90: 7365 745f 6761 735f 7072 6963 655f 7374  set_gas_price_st
-0001fda0: 7261 7465 6779 284e 6f6e 6529 2020 2320  rategy(None)  # 
-0001fdb0: 7265 7365 7420 7374 7261 7465 6779 0a0a  reset strategy..
-0001fdc0: 2020 2020 4066 6c61 6b79 5f67 6574 685f      @flaky_geth_
-0001fdd0: 6465 765f 6d69 6e69 6e67 0a20 2020 2064  dev_mining.    d
-0001fde0: 6566 2074 6573 745f 6574 685f 7265 706c  ef test_eth_repl
-0001fdf0: 6163 655f 7472 616e 7361 6374 696f 6e5f  ace_transaction_
-0001fe00: 6c65 6761 6379 280a 2020 2020 2020 2020  legacy(.        
-0001fe10: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-0001fe20: 2c20 756e 6c6f 636b 6564 5f61 6363 6f75  , unlocked_accou
-0001fe30: 6e74 5f64 7561 6c5f 7479 7065 3a20 4368  nt_dual_type: Ch
-0001fe40: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
-0001fe50: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-0001fe60: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-0001fe70: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-0001fe80: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-0001fe90: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
-0001fea0: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
-0001feb0: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
-0001fec0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-0001fed0: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-0001fee0: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
-0001fef0: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
-0001ff00: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
-0001ff10: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
-0001ff20: 6761 7350 7269 6365 223a 2077 332e 746f  gasPrice": w3.to
-0001ff30: 5f77 6569 280a 2020 2020 2020 2020 2020  _wei(.          
-0001ff40: 2020 2020 2020 312c 2022 6777 6569 220a        1, "gwei".
-0001ff50: 2020 2020 2020 2020 2020 2020 292c 2020              ),  
-0001ff60: 2320 6d75 7374 2062 6520 6772 6561 7465  # must be greate
-0001ff70: 7220 7468 616e 2062 6173 655f 6665 6520  r than base_fee 
-0001ff80: 706f 7374 204c 6f6e 646f 6e0a 2020 2020  post London.    
-0001ff90: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
-0001ffa0: 6e5f 6861 7368 203d 2077 332e 6574 682e  n_hash = w3.eth.
-0001ffb0: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-0001ffc0: 2874 786e 5f70 6172 616d 7329 0a0a 2020  (txn_params)..  
-0001ffd0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-0001ffe0: 5b22 6761 7350 7269 6365 225d 203d 2077  ["gasPrice"] = w
-0001fff0: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
-00020000: 6922 290a 2020 2020 2020 2020 7265 706c  i").        repl
-00020010: 6163 655f 7478 6e5f 6861 7368 203d 2077  ace_txn_hash = w
-00020020: 332e 6574 682e 7265 706c 6163 655f 7472  3.eth.replace_tr
-00020030: 616e 7361 6374 696f 6e28 7478 6e5f 6861  ansaction(txn_ha
-00020040: 7368 2c20 7478 6e5f 7061 7261 6d73 290a  sh, txn_params).
-00020050: 2020 2020 2020 2020 7265 706c 6163 655f          replace_
-00020060: 7478 6e20 3d20 7733 2e65 7468 2e67 6574  txn = w3.eth.get
-00020070: 5f74 7261 6e73 6163 7469 6f6e 2872 6570  _transaction(rep
-00020080: 6c61 6365 5f74 786e 5f68 6173 6829 0a0a  lace_txn_hash)..
-00020090: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-000200a0: 735f 7361 6d65 5f61 6464 7265 7373 280a  s_same_address(.
-000200b0: 2020 2020 2020 2020 2020 2020 7265 706c              repl
-000200c0: 6163 655f 7478 6e5b 2266 726f 6d22 5d2c  ace_txn["from"],
-000200d0: 2063 6173 7428 4368 6563 6b73 756d 4164   cast(ChecksumAd
-000200e0: 6472 6573 732c 2074 786e 5f70 6172 616d  dress, txn_param
-000200f0: 735b 2266 726f 6d22 5d29 0a20 2020 2020  s["from"]).     
-00020100: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
-00020110: 6572 7420 6973 5f73 616d 655f 6164 6472  ert is_same_addr
-00020120: 6573 7328 0a20 2020 2020 2020 2020 2020  ess(.           
-00020130: 2072 6570 6c61 6365 5f74 786e 5b22 746f   replace_txn["to
-00020140: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
-00020150: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
-00020160: 7261 6d73 5b22 746f 225d 290a 2020 2020  rams["to"]).    
-00020170: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
-00020180: 7365 7274 2072 6570 6c61 6365 5f74 786e  sert replace_txn
-00020190: 5b22 7661 6c75 6522 5d20 3d3d 2031 0a20  ["value"] == 1. 
-000201a0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-000201b0: 706c 6163 655f 7478 6e5b 2267 6173 225d  place_txn["gas"]
-000201c0: 203d 3d20 3231 3030 300a 2020 2020 2020   == 21000.      
-000201d0: 2020 6173 7365 7274 2072 6570 6c61 6365    assert replace
-000201e0: 5f74 786e 5b22 6761 7350 7269 6365 225d  _txn["gasPrice"]
-000201f0: 203d 3d20 7478 6e5f 7061 7261 6d73 5b22   == txn_params["
-00020200: 6761 7350 7269 6365 225d 0a0a 2020 2020  gasPrice"]..    
-00020210: 4066 6c61 6b79 5f67 6574 685f 6465 765f  @flaky_geth_dev_
-00020220: 6d69 6e69 6e67 0a20 2020 2064 6566 2074  mining.    def t
-00020230: 6573 745f 6574 685f 7265 706c 6163 655f  est_eth_replace_
-00020240: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
-00020250: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
-00020260: 5765 6233 222c 2075 6e6c 6f63 6b65 645f  Web3", unlocked_
-00020270: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
-00020280: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
-00020290: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
-000202a0: 3a0a 2020 2020 2020 2020 7477 6f5f 6777  :.        two_gw
-000202b0: 6569 5f69 6e5f 7765 6920 3d20 7733 2e74  ei_in_wei = w3.t
-000202c0: 6f5f 7765 6928 322c 2022 6777 6569 2229  o_wei(2, "gwei")
-000202d0: 0a20 2020 2020 2020 2074 6872 6565 5f67  .        three_g
-000202e0: 7765 695f 696e 5f77 6569 203d 2077 332e  wei_in_wei = w3.
-000202f0: 746f 5f77 6569 2833 2c20 2267 7765 6922  to_wei(3, "gwei"
-00020300: 290a 0a20 2020 2020 2020 2074 786e 5f70  )..        txn_p
-00020310: 6172 616d 733a 2054 7850 6172 616d 7320  arams: TxParams 
-00020320: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00020330: 2266 726f 6d22 3a20 756e 6c6f 636b 6564  "from": unlocked
-00020340: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
-00020350: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00020360: 2274 6f22 3a20 756e 6c6f 636b 6564 5f61  "to": unlocked_a
-00020370: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-00020380: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-00020390: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-000203a0: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-000203b0: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-000203c0: 2020 2020 2022 6d61 7846 6565 5065 7247       "maxFeePerG
-000203d0: 6173 223a 2074 776f 5f67 7765 695f 696e  as": two_gwei_in
-000203e0: 5f77 6569 2c0a 2020 2020 2020 2020 2020  _wei,.          
-000203f0: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
-00020400: 6550 6572 4761 7322 3a20 7733 2e74 6f5f  ePerGas": w3.to_
-00020410: 7765 6928 312c 2022 6777 6569 2229 2c0a  wei(1, "gwei"),.
-00020420: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00020430: 2020 7478 6e5f 6861 7368 203d 2077 332e    txn_hash = w3.
-00020440: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
-00020450: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
-00020460: 0a0a 2020 2020 2020 2020 7478 6e5f 7061  ..        txn_pa
-00020470: 7261 6d73 5b22 6d61 7846 6565 5065 7247  rams["maxFeePerG
-00020480: 6173 225d 203d 2074 6872 6565 5f67 7765  as"] = three_gwe
-00020490: 695f 696e 5f77 6569 0a20 2020 2020 2020  i_in_wei.       
-000204a0: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
-000204b0: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
-000204c0: 7322 5d20 3d20 7477 6f5f 6777 6569 5f69  s"] = two_gwei_i
-000204d0: 6e5f 7765 690a 0a20 2020 2020 2020 2072  n_wei..        r
-000204e0: 6570 6c61 6365 5f74 786e 5f68 6173 6820  eplace_txn_hash 
-000204f0: 3d20 7733 2e65 7468 2e72 6570 6c61 6365  = w3.eth.replace
-00020500: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00020510: 5f68 6173 682c 2074 786e 5f70 6172 616d  _hash, txn_param
-00020520: 7329 0a20 2020 2020 2020 2072 6570 6c61  s).        repla
-00020530: 6365 5f74 786e 203d 2077 332e 6574 682e  ce_txn = w3.eth.
-00020540: 6765 745f 7472 616e 7361 6374 696f 6e28  get_transaction(
-00020550: 7265 706c 6163 655f 7478 6e5f 6861 7368  replace_txn_hash
-00020560: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
-00020570: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
-00020580: 7328 0a20 2020 2020 2020 2020 2020 2072  s(.            r
-00020590: 6570 6c61 6365 5f74 786e 5b22 6672 6f6d  eplace_txn["from
-000205a0: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
-000205b0: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
-000205c0: 7261 6d73 5b22 6672 6f6d 225d 290a 2020  rams["from"]).  
-000205d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000205e0: 6173 7365 7274 2069 735f 7361 6d65 5f61  assert is_same_a
-000205f0: 6464 7265 7373 280a 2020 2020 2020 2020  ddress(.        
-00020600: 2020 2020 7265 706c 6163 655f 7478 6e5b      replace_txn[
-00020610: 2274 6f22 5d2c 2063 6173 7428 4368 6563  "to"], cast(Chec
-00020620: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
-00020630: 5f70 6172 616d 735b 2274 6f22 5d29 0a20  _params["to"]). 
-00020640: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00020650: 2061 7373 6572 7420 7265 706c 6163 655f   assert replace_
-00020660: 7478 6e5b 2276 616c 7565 225d 203d 3d20  txn["value"] == 
-00020670: 310a 2020 2020 2020 2020 6173 7365 7274  1.        assert
-00020680: 2072 6570 6c61 6365 5f74 786e 5b22 6761   replace_txn["ga
-00020690: 7322 5d20 3d3d 2032 3130 3030 0a20 2020  s"] == 21000.   
-000206a0: 2020 2020 2061 7373 6572 7420 7265 706c       assert repl
-000206b0: 6163 655f 7478 6e5b 226d 6178 4665 6550  ace_txn["maxFeeP
-000206c0: 6572 4761 7322 5d20 3d3d 2074 6872 6565  erGas"] == three
-000206d0: 5f67 7765 695f 696e 5f77 6569 0a20 2020  _gwei_in_wei.   
-000206e0: 2020 2020 2061 7373 6572 7420 7265 706c       assert repl
-000206f0: 6163 655f 7478 6e5b 226d 6178 5072 696f  ace_txn["maxPrio
-00020700: 7269 7479 4665 6550 6572 4761 7322 5d20  rityFeePerGas"] 
-00020710: 3d3d 2074 776f 5f67 7765 695f 696e 5f77  == two_gwei_in_w
-00020720: 6569 0a0a 2020 2020 4066 6c61 6b79 5f67  ei..    @flaky_g
-00020730: 6574 685f 6465 765f 6d69 6e69 6e67 0a20  eth_dev_mining. 
-00020740: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-00020750: 7265 706c 6163 655f 7472 616e 7361 6374  replace_transact
-00020760: 696f 6e5f 756e 6465 7270 7269 6365 6428  ion_underpriced(
-00020770: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-00020780: 333a 2022 5765 6233 222c 2075 6e6c 6f63  3: "Web3", unloc
-00020790: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-000207a0: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
-000207b0: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
-000207c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
-000207d0: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
-000207e0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-000207f0: 2020 2022 6672 6f6d 223a 2075 6e6c 6f63     "from": unloc
-00020800: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-00020810: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-00020820: 2020 2022 746f 223a 2075 6e6c 6f63 6b65     "to": unlocke
-00020830: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-00020840: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-00020850: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
-00020860: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-00020870: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
-00020880: 2020 2020 2020 2020 226d 6178 4665 6550          "maxFeeP
-00020890: 6572 4761 7322 3a20 7733 2e74 6f5f 7765  erGas": w3.to_we
-000208a0: 6928 332c 2022 6777 6569 2229 2c0a 2020  i(3, "gwei"),.  
-000208b0: 2020 2020 2020 2020 2020 226d 6178 5072            "maxPr
-000208c0: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
-000208d0: 3a20 7733 2e74 6f5f 7765 6928 322c 2022  : w3.to_wei(2, "
-000208e0: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
-000208f0: 7d0a 2020 2020 2020 2020 7478 6e5f 6861  }.        txn_ha
-00020900: 7368 203d 2077 332e 6574 682e 7365 6e64  sh = w3.eth.send
-00020910: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00020920: 5f70 6172 616d 7329 0a0a 2020 2020 2020  _params)..      
-00020930: 2020 6f6e 655f 6777 6569 5f69 6e5f 7765    one_gwei_in_we
-00020940: 6920 3d20 7733 2e74 6f5f 7765 6928 312c  i = w3.to_wei(1,
-00020950: 2022 6777 6569 2229 0a20 2020 2020 2020   "gwei").       
-00020960: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
-00020970: 4665 6550 6572 4761 7322 5d20 3d20 6f6e  FeePerGas"] = on
-00020980: 655f 6777 6569 5f69 6e5f 7765 690a 2020  e_gwei_in_wei.  
-00020990: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-000209a0: 5b22 6d61 7850 7269 6f72 6974 7946 6565  ["maxPriorityFee
-000209b0: 5065 7247 6173 225d 203d 206f 6e65 5f67  PerGas"] = one_g
-000209c0: 7765 695f 696e 5f77 6569 0a0a 2020 2020  wei_in_wei..    
-000209d0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-000209e0: 7261 6973 6573 2856 616c 7565 4572 726f  raises(ValueErro
-000209f0: 722c 206d 6174 6368 3d22 7265 706c 6163  r, match="replac
-00020a00: 656d 656e 7420 7472 616e 7361 6374 696f  ement transactio
-00020a10: 6e20 756e 6465 7270 7269 6365 6422 293a  n underpriced"):
-00020a20: 0a20 2020 2020 2020 2020 2020 2077 332e  .            w3.
-00020a30: 6574 682e 7265 706c 6163 655f 7472 616e  eth.replace_tran
-00020a40: 7361 6374 696f 6e28 7478 6e5f 6861 7368  saction(txn_hash
-00020a50: 2c20 7478 6e5f 7061 7261 6d73 290a 0a20  , txn_params).. 
-00020a60: 2020 2040 666c 616b 795f 6765 7468 5f64     @flaky_geth_d
-00020a70: 6576 5f6d 696e 696e 670a 2020 2020 6465  ev_mining.    de
-00020a80: 6620 7465 7374 5f65 7468 5f72 6570 6c61  f test_eth_repla
-00020a90: 6365 5f74 7261 6e73 6163 7469 6f6e 5f6e  ce_transaction_n
-00020aa0: 6f6e 5f65 7869 7374 696e 675f 7472 616e  on_existing_tran
-00020ab0: 7361 6374 696f 6e28 0a20 2020 2020 2020  saction(.       
-00020ac0: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
-00020ad0: 222c 2075 6e6c 6f63 6b65 645f 6163 636f  ", unlocked_acco
-00020ae0: 756e 745f 6475 616c 5f74 7970 653a 2043  unt_dual_type: C
-00020af0: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
-00020b00: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-00020b10: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-00020b20: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
-00020b30: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-00020b40: 223a 2075 6e6c 6f63 6b65 645f 6163 636f  ": unlocked_acco
-00020b50: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
-00020b60: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
-00020b70: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
-00020b80: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
-00020b90: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
-00020ba0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-00020bb0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
-00020bc0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-00020bd0: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
-00020be0: 7733 2e74 6f5f 7765 6928 332c 2022 6777  w3.to_wei(3, "gw
-00020bf0: 6569 2229 2c0a 2020 2020 2020 2020 2020  ei"),.          
-00020c00: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
-00020c10: 6550 6572 4761 7322 3a20 7733 2e74 6f5f  ePerGas": w3.to_
-00020c20: 7765 6928 312c 2022 6777 6569 2229 2c0a  wei(1, "gwei"),.
-00020c30: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00020c40: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-00020c50: 6973 6573 2854 7261 6e73 6163 7469 6f6e  ises(Transaction
-00020c60: 4e6f 7446 6f75 6e64 293a 0a20 2020 2020  NotFound):.     
-00020c70: 2020 2020 2020 2077 332e 6574 682e 7265         w3.eth.re
-00020c80: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
-00020c90: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00020ca0: 2020 2048 6578 5374 7228 0a20 2020 2020     HexStr(.     
-00020cb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00020cc0: 3078 3938 6538 6363 3039 6233 3131 3538  0x98e8cc09b31158
-00020cd0: 3363 3530 3739 6661 3630 3066 3663 3261  3c5079fa600f6c2a
-00020ce0: 3362 6561 3836 3131 6166 3136 3863 3532  3bea8611af168c52
-00020cf0: 6534 6236 3062 3562 3234 3361 3434 3139  e4b60b5b243a4419
-00020d00: 3937 220a 2020 2020 2020 2020 2020 2020  97".            
-00020d10: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-00020d20: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00020d30: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-00020d40: 0a0a 2020 2020 4066 6c61 6b79 5f67 6574  ..    @flaky_get
-00020d50: 685f 6465 765f 6d69 6e69 6e67 0a20 2020  h_dev_mining.   
-00020d60: 2064 6566 2074 6573 745f 6574 685f 7265   def test_eth_re
-00020d70: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
-00020d80: 6e5f 616c 7265 6164 795f 6d69 6e65 6428  n_already_mined(
-00020d90: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-00020da0: 333a 2022 5765 6233 222c 2075 6e6c 6f63  3: "Web3", unloc
-00020db0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-00020dc0: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
-00020dd0: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
-00020de0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
-00020df0: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
-00020e00: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-00020e10: 2020 2022 6672 6f6d 223a 2075 6e6c 6f63     "from": unloc
-00020e20: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-00020e30: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-00020e40: 2020 2022 746f 223a 2075 6e6c 6f63 6b65     "to": unlocke
-00020e50: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-00020e60: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-00020e70: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
-00020e80: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-00020e90: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
-00020ea0: 2020 2020 2020 2020 226d 6178 4665 6550          "maxFeeP
-00020eb0: 6572 4761 7322 3a20 7733 2e74 6f5f 7765  erGas": w3.to_we
-00020ec0: 6928 322c 2022 6777 6569 2229 2c0a 2020  i(2, "gwei"),.  
-00020ed0: 2020 2020 2020 2020 2020 226d 6178 5072            "maxPr
-00020ee0: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
-00020ef0: 3a20 7733 2e74 6f5f 7765 6928 312c 2022  : w3.to_wei(1, "
-00020f00: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
-00020f10: 7d0a 2020 2020 2020 2020 7478 6e5f 6861  }.        txn_ha
-00020f20: 7368 203d 2077 332e 6574 682e 7365 6e64  sh = w3.eth.send
-00020f30: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00020f40: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
-00020f50: 2077 332e 6574 682e 7761 6974 5f66 6f72   w3.eth.wait_for
-00020f60: 5f74 7261 6e73 6163 7469 6f6e 5f72 6563  _transaction_rec
-00020f70: 6569 7074 2874 786e 5f68 6173 682c 2074  eipt(txn_hash, t
-00020f80: 696d 656f 7574 3d31 3029 0a0a 2020 2020  imeout=10)..    
-00020f90: 2020 2020 7478 6e5f 7061 7261 6d73 5b22      txn_params["
-00020fa0: 6d61 7846 6565 5065 7247 6173 225d 203d  maxFeePerGas"] =
-00020fb0: 2077 332e 746f 5f77 6569 2833 2c20 2267   w3.to_wei(3, "g
-00020fc0: 7765 6922 290a 2020 2020 2020 2020 7478  wei").        tx
-00020fd0: 6e5f 7061 7261 6d73 5b22 6d61 7850 7269  n_params["maxPri
-00020fe0: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
-00020ff0: 203d 2077 332e 746f 5f77 6569 2832 2c20   = w3.to_wei(2, 
-00021000: 2267 7765 6922 290a 2020 2020 2020 2020  "gwei").        
-00021010: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-00021020: 6573 2856 616c 7565 4572 726f 722c 206d  es(ValueError, m
-00021030: 6174 6368 3d22 5375 7070 6c69 6564 2074  atch="Supplied t
-00021040: 7261 6e73 6163 7469 6f6e 2077 6974 6820  ransaction with 
-00021050: 6861 7368 2229 3a0a 2020 2020 2020 2020  hash"):.        
-00021060: 2020 2020 7733 2e65 7468 2e72 6570 6c61      w3.eth.repla
-00021070: 6365 5f74 7261 6e73 6163 7469 6f6e 2874  ce_transaction(t
-00021080: 786e 5f68 6173 682c 2074 786e 5f70 6172  xn_hash, txn_par
-00021090: 616d 7329 0a0a 2020 2020 4066 6c61 6b79  ams)..    @flaky
-000210a0: 5f67 6574 685f 6465 765f 6d69 6e69 6e67  _geth_dev_mining
-000210b0: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-000210c0: 685f 7265 706c 6163 655f 7472 616e 7361  h_replace_transa
-000210d0: 6374 696f 6e5f 696e 636f 7272 6563 745f  ction_incorrect_
-000210e0: 6e6f 6e63 6528 0a20 2020 2020 2020 2073  nonce(.        s
-000210f0: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
-00021100: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
-00021110: 743a 2043 6865 636b 7375 6d41 6464 7265  t: ChecksumAddre
-00021120: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
-00021130: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
-00021140: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
-00021150: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-00021160: 6672 6f6d 223a 2075 6e6c 6f63 6b65 645f  from": unlocked_
-00021170: 6163 636f 756e 742c 0a20 2020 2020 2020  account,.       
-00021180: 2020 2020 2022 746f 223a 2075 6e6c 6f63       "to": unloc
-00021190: 6b65 645f 6163 636f 756e 742c 0a20 2020  ked_account,.   
-000211a0: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
-000211b0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-000211c0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
-000211d0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-000211e0: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
-000211f0: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
-00021200: 6569 2229 2c0a 2020 2020 2020 2020 2020  ei"),.          
-00021210: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
-00021220: 6550 6572 4761 7322 3a20 7733 2e74 6f5f  ePerGas": w3.to_
-00021230: 7765 6928 312c 2022 6777 6569 2229 2c0a  wei(1, "gwei"),.
-00021240: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00021250: 2020 7478 6e5f 6861 7368 203d 2077 332e    txn_hash = w3.
-00021260: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
-00021270: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
-00021280: 0a20 2020 2020 2020 2074 786e 203d 2077  .        txn = w
-00021290: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
-000212a0: 6374 696f 6e28 7478 6e5f 6861 7368 290a  ction(txn_hash).
-000212b0: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
-000212c0: 616d 735b 226d 6178 4665 6550 6572 4761  ams["maxFeePerGa
-000212d0: 7322 5d20 3d20 7733 2e74 6f5f 7765 6928  s"] = w3.to_wei(
-000212e0: 332c 2022 6777 6569 2229 0a20 2020 2020  3, "gwei").     
-000212f0: 2020 2074 786e 5f70 6172 616d 735b 226d     txn_params["m
-00021300: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
-00021310: 4761 7322 5d20 3d20 7733 2e74 6f5f 7765  Gas"] = w3.to_we
-00021320: 6928 322c 2022 6777 6569 2229 0a20 2020  i(2, "gwei").   
-00021330: 2020 2020 2074 786e 5f70 6172 616d 735b       txn_params[
-00021340: 226e 6f6e 6365 225d 203d 204e 6f6e 6365  "nonce"] = Nonce
-00021350: 2874 786e 5b22 6e6f 6e63 6522 5d20 2b20  (txn["nonce"] + 
-00021360: 3129 0a20 2020 2020 2020 2077 6974 6820  1).        with 
-00021370: 7079 7465 7374 2e72 6169 7365 7328 5661  pytest.raises(Va
-00021380: 6c75 6545 7272 6f72 293a 0a20 2020 2020  lueError):.     
-00021390: 2020 2020 2020 2077 332e 6574 682e 7265         w3.eth.re
-000213a0: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
-000213b0: 6e28 7478 6e5f 6861 7368 2c20 7478 6e5f  n(txn_hash, txn_
-000213c0: 7061 7261 6d73 290a 0a20 2020 2040 666c  params)..    @fl
-000213d0: 616b 795f 6765 7468 5f64 6576 5f6d 696e  aky_geth_dev_min
-000213e0: 696e 670a 2020 2020 6465 6620 7465 7374  ing.    def test
-000213f0: 5f65 7468 5f72 6570 6c61 6365 5f74 7261  _eth_replace_tra
-00021400: 6e73 6163 7469 6f6e 5f67 6173 5f70 7269  nsaction_gas_pri
-00021410: 6365 5f74 6f6f 5f6c 6f77 280a 2020 2020  ce_too_low(.    
-00021420: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
-00021430: 6562 3322 2c20 756e 6c6f 636b 6564 5f61  eb3", unlocked_a
-00021440: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-00021450: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-00021460: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
-00021470: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
-00021480: 616d 733a 2054 7850 6172 616d 7320 3d20  ams: TxParams = 
-00021490: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
-000214a0: 726f 6d22 3a20 756e 6c6f 636b 6564 5f61  rom": unlocked_a
-000214b0: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-000214c0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-000214d0: 6f22 3a20 756e 6c6f 636b 6564 5f61 6363  o": unlocked_acc
-000214e0: 6f75 6e74 5f64 7561 6c5f 7479 7065 2c0a  ount_dual_type,.
-000214f0: 2020 2020 2020 2020 2020 2020 2276 616c              "val
-00021500: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
-00021510: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
-00021520: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
-00021530: 2020 2022 6761 7350 7269 6365 223a 2077     "gasPrice": w
-00021540: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
-00021550: 6922 292c 0a20 2020 2020 2020 207d 0a20  i"),.        }. 
-00021560: 2020 2020 2020 2074 786e 5f68 6173 6820         txn_hash 
-00021570: 3d20 7733 2e65 7468 2e73 656e 645f 7472  = w3.eth.send_tr
-00021580: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
-00021590: 7261 6d73 290a 0a20 2020 2020 2020 2074  rams)..        t
-000215a0: 786e 5f70 6172 616d 735b 2267 6173 5072  xn_params["gasPr
-000215b0: 6963 6522 5d20 3d20 7733 2e74 6f5f 7765  ice"] = w3.to_we
-000215c0: 6928 312c 2022 6777 6569 2229 0a20 2020  i(1, "gwei").   
-000215d0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-000215e0: 2e72 6169 7365 7328 5661 6c75 6545 7272  .raises(ValueErr
-000215f0: 6f72 293a 0a20 2020 2020 2020 2020 2020  or):.           
-00021600: 2077 332e 6574 682e 7265 706c 6163 655f   w3.eth.replace_
-00021610: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
-00021620: 6861 7368 2c20 7478 6e5f 7061 7261 6d73  hash, txn_params
-00021630: 290a 0a20 2020 2040 666c 616b 795f 6765  )..    @flaky_ge
-00021640: 7468 5f64 6576 5f6d 696e 696e 670a 2020  th_dev_mining.  
-00021650: 2020 6465 6620 7465 7374 5f65 7468 5f72    def test_eth_r
-00021660: 6570 6c61 6365 5f74 7261 6e73 6163 7469  eplace_transacti
-00021670: 6f6e 5f67 6173 5f70 7269 6365 5f64 6566  on_gas_price_def
-00021680: 6175 6c74 696e 675f 6d69 6e69 6d75 6d28  aulting_minimum(
-00021690: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-000216a0: 333a 2022 5765 6233 222c 2075 6e6c 6f63  3: "Web3", unloc
-000216b0: 6b65 645f 6163 636f 756e 743a 2043 6865  ked_account: Che
-000216c0: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
-000216d0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-000216e0: 2020 2020 6761 735f 7072 6963 6520 3d20      gas_price = 
-000216f0: 7733 2e74 6f5f 7765 6928 312c 2022 6777  w3.to_wei(1, "gw
-00021700: 6569 2229 0a0a 2020 2020 2020 2020 7478  ei")..        tx
-00021710: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
-00021720: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-00021730: 2020 2022 6672 6f6d 223a 2075 6e6c 6f63     "from": unloc
-00021740: 6b65 645f 6163 636f 756e 742c 0a20 2020  ked_account,.   
-00021750: 2020 2020 2020 2020 2022 746f 223a 2075           "to": u
-00021760: 6e6c 6f63 6b65 645f 6163 636f 756e 742c  nlocked_account,
-00021770: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
-00021780: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
-00021790: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
-000217a0: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
-000217b0: 2020 2020 2267 6173 5072 6963 6522 3a20      "gasPrice": 
-000217c0: 6761 735f 7072 6963 652c 0a20 2020 2020  gas_price,.     
-000217d0: 2020 207d 0a20 2020 2020 2020 2074 786e     }.        txn
-000217e0: 5f68 6173 6820 3d20 7733 2e65 7468 2e73  _hash = w3.eth.s
-000217f0: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
-00021800: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
-00021810: 2020 2020 2074 786e 5f70 6172 616d 732e       txn_params.
-00021820: 706f 7028 2267 6173 5072 6963 6522 290a  pop("gasPrice").
-00021830: 2020 2020 2020 2020 7265 706c 6163 655f          replace_
-00021840: 7478 6e5f 6861 7368 203d 2077 332e 6574  txn_hash = w3.et
-00021850: 682e 7265 706c 6163 655f 7472 616e 7361  h.replace_transa
-00021860: 6374 696f 6e28 7478 6e5f 6861 7368 2c20  ction(txn_hash, 
-00021870: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
-00021880: 2020 2020 7265 706c 6163 655f 7478 6e20      replace_txn 
-00021890: 3d20 7733 2e65 7468 2e67 6574 5f74 7261  = w3.eth.get_tra
-000218a0: 6e73 6163 7469 6f6e 2872 6570 6c61 6365  nsaction(replace
-000218b0: 5f74 786e 5f68 6173 6829 0a0a 2020 2020  _txn_hash)..    
-000218c0: 2020 2020 6173 7365 7274 2072 6570 6c61      assert repla
-000218d0: 6365 5f74 786e 5b22 6761 7350 7269 6365  ce_txn["gasPrice
-000218e0: 225d 203d 3d20 6d61 7468 2e63 6569 6c28  "] == math.ceil(
-000218f0: 0a20 2020 2020 2020 2020 2020 2067 6173  .            gas
-00021900: 5f70 7269 6365 202a 2031 2e31 3235 0a20  _price * 1.125. 
-00021910: 2020 2020 2020 2029 2020 2320 6d69 6e69         )  # mini
-00021920: 6d75 6d20 6761 7320 7072 6963 650a 0a20  mum gas price.. 
-00021930: 2020 2040 666c 616b 795f 6765 7468 5f64     @flaky_geth_d
-00021940: 6576 5f6d 696e 696e 670a 2020 2020 6465  ev_mining.    de
-00021950: 6620 7465 7374 5f65 7468 5f72 6570 6c61  f test_eth_repla
-00021960: 6365 5f74 7261 6e73 6163 7469 6f6e 5f67  ce_transaction_g
-00021970: 6173 5f70 7269 6365 5f64 6566 6175 6c74  as_price_default
-00021980: 696e 675f 7374 7261 7465 6779 5f68 6967  ing_strategy_hig
-00021990: 6865 7228 0a20 2020 2020 2020 2073 656c  her(.        sel
-000219a0: 662c 2077 333a 2022 5765 6233 222c 2075  f, w3: "Web3", u
-000219b0: 6e6c 6f63 6b65 645f 6163 636f 756e 743a  nlocked_account:
-000219c0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-000219d0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-000219e0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-000219f0: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
-00021a00: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
-00021a10: 6f6d 223a 2075 6e6c 6f63 6b65 645f 6163  om": unlocked_ac
-00021a20: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
-00021a30: 2020 2022 746f 223a 2075 6e6c 6f63 6b65     "to": unlocke
-00021a40: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
-00021a50: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
-00021a60: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
-00021a70: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
-00021a80: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-00021a90: 6173 5072 6963 6522 3a20 7733 2e74 6f5f  asPrice": w3.to_
-00021aa0: 7765 6928 312c 2022 6777 6569 2229 2c0a  wei(1, "gwei"),.
-00021ab0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00021ac0: 2020 7478 6e5f 6861 7368 203d 2077 332e    txn_hash = w3.
-00021ad0: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
-00021ae0: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
-00021af0: 0a0a 2020 2020 2020 2020 7477 6f5f 6777  ..        two_gw
-00021b00: 6569 5f69 6e5f 7765 6920 3d20 7733 2e74  ei_in_wei = w3.t
-00021b10: 6f5f 7765 6928 322c 2022 6777 6569 2229  o_wei(2, "gwei")
-00021b20: 0a0a 2020 2020 2020 2020 6465 6620 6869  ..        def hi
-00021b30: 6768 6572 5f67 6173 5f70 7269 6365 5f73  gher_gas_price_s
-00021b40: 7472 6174 6567 7928 7733 3a20 2257 6562  trategy(w3: "Web
-00021b50: 3322 2c20 7478 6e3a 2054 7850 6172 616d  3", txn: TxParam
-00021b60: 7329 202d 3e20 5765 693a 0a20 2020 2020  s) -> Wei:.     
-00021b70: 2020 2020 2020 2072 6574 7572 6e20 7477         return tw
-00021b80: 6f5f 6777 6569 5f69 6e5f 7765 690a 0a20  o_gwei_in_wei.. 
-00021b90: 2020 2020 2020 2077 332e 6574 682e 7365         w3.eth.se
-00021ba0: 745f 6761 735f 7072 6963 655f 7374 7261  t_gas_price_stra
-00021bb0: 7465 6779 2868 6967 6865 725f 6761 735f  tegy(higher_gas_
-00021bc0: 7072 6963 655f 7374 7261 7465 6779 290a  price_strategy).
-00021bd0: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
-00021be0: 616d 732e 706f 7028 2267 6173 5072 6963  ams.pop("gasPric
-00021bf0: 6522 290a 2020 2020 2020 2020 7265 706c  e").        repl
-00021c00: 6163 655f 7478 6e5f 6861 7368 203d 2077  ace_txn_hash = w
-00021c10: 332e 6574 682e 7265 706c 6163 655f 7472  3.eth.replace_tr
-00021c20: 616e 7361 6374 696f 6e28 7478 6e5f 6861  ansaction(txn_ha
-00021c30: 7368 2c20 7478 6e5f 7061 7261 6d73 290a  sh, txn_params).
-00021c40: 2020 2020 2020 2020 7265 706c 6163 655f          replace_
-00021c50: 7478 6e20 3d20 7733 2e65 7468 2e67 6574  txn = w3.eth.get
-00021c60: 5f74 7261 6e73 6163 7469 6f6e 2872 6570  _transaction(rep
-00021c70: 6c61 6365 5f74 786e 5f68 6173 6829 0a20  lace_txn_hash). 
-00021c80: 2020 2020 2020 2061 7373 6572 7420 280a         assert (.
-00021c90: 2020 2020 2020 2020 2020 2020 7265 706c              repl
-00021ca0: 6163 655f 7478 6e5b 2267 6173 5072 6963  ace_txn["gasPric
-00021cb0: 6522 5d20 3d3d 2074 776f 5f67 7765 695f  e"] == two_gwei_
-00021cc0: 696e 5f77 6569 0a20 2020 2020 2020 2029  in_wei.        )
-00021cd0: 2020 2320 5374 7261 7465 6779 2070 726f    # Strategy pro
-00021ce0: 7669 6465 7320 6869 6768 6572 2067 6173  vides higher gas
-00021cf0: 2070 7269 6365 0a20 2020 2020 2020 2077   price.        w
-00021d00: 332e 6574 682e 7365 745f 6761 735f 7072  3.eth.set_gas_pr
-00021d10: 6963 655f 7374 7261 7465 6779 284e 6f6e  ice_strategy(Non
-00021d20: 6529 2020 2320 7265 7365 7420 7374 7261  e)  # reset stra
-00021d30: 7465 6779 0a0a 2020 2020 4066 6c61 6b79  tegy..    @flaky
-00021d40: 5f67 6574 685f 6465 765f 6d69 6e69 6e67  _geth_dev_mining
-00021d50: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00021d60: 685f 7265 706c 6163 655f 7472 616e 7361  h_replace_transa
-00021d70: 6374 696f 6e5f 6761 735f 7072 6963 655f  ction_gas_price_
-00021d80: 6465 6661 756c 7469 6e67 5f73 7472 6174  defaulting_strat
-00021d90: 6567 795f 6c6f 7765 7228 0a20 2020 2020  egy_lower(.     
-00021da0: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
-00021db0: 6233 222c 2075 6e6c 6f63 6b65 645f 6163  b3", unlocked_ac
-00021dc0: 636f 756e 743a 2043 6865 636b 7375 6d41  count: ChecksumA
-00021dd0: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
-00021de0: 4e6f 6e65 3a0a 2020 2020 2020 2020 6761  None:.        ga
-00021df0: 735f 7072 6963 6520 3d20 7733 2e74 6f5f  s_price = w3.to_
-00021e00: 7765 6928 322c 2022 6777 6569 2229 0a0a  wei(2, "gwei")..
-00021e10: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-00021e20: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
-00021e30: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
-00021e40: 6f6d 223a 2075 6e6c 6f63 6b65 645f 6163  om": unlocked_ac
-00021e50: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
-00021e60: 2020 2022 746f 223a 2075 6e6c 6f63 6b65     "to": unlocke
-00021e70: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
-00021e80: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
-00021e90: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
-00021ea0: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
-00021eb0: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-00021ec0: 6173 5072 6963 6522 3a20 6761 735f 7072  asPrice": gas_pr
-00021ed0: 6963 652c 0a20 2020 2020 2020 207d 0a20  ice,.        }. 
-00021ee0: 2020 2020 2020 2074 786e 5f68 6173 6820         txn_hash 
-00021ef0: 3d20 7733 2e65 7468 2e73 656e 645f 7472  = w3.eth.send_tr
-00021f00: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
-00021f10: 7261 6d73 290a 0a20 2020 2020 2020 2064  rams)..        d
-00021f20: 6566 206c 6f77 6572 5f67 6173 5f70 7269  ef lower_gas_pri
-00021f30: 6365 5f73 7472 6174 6567 7928 7733 3a20  ce_strategy(w3: 
-00021f40: 2257 6562 3322 2c20 7478 6e3a 2054 7850  "Web3", txn: TxP
-00021f50: 6172 616d 7329 202d 3e20 5765 693a 0a20  arams) -> Wei:. 
-00021f60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00021f70: 6e20 7733 2e74 6f5f 7765 6928 312c 2022  n w3.to_wei(1, "
-00021f80: 6777 6569 2229 0a0a 2020 2020 2020 2020  gwei")..        
-00021f90: 7733 2e65 7468 2e73 6574 5f67 6173 5f70  w3.eth.set_gas_p
-00021fa0: 7269 6365 5f73 7472 6174 6567 7928 6c6f  rice_strategy(lo
-00021fb0: 7765 725f 6761 735f 7072 6963 655f 7374  wer_gas_price_st
-00021fc0: 7261 7465 6779 290a 0a20 2020 2020 2020  rategy)..       
-00021fd0: 2074 786e 5f70 6172 616d 732e 706f 7028   txn_params.pop(
-00021fe0: 2267 6173 5072 6963 6522 290a 2020 2020  "gasPrice").    
-00021ff0: 2020 2020 7265 706c 6163 655f 7478 6e5f      replace_txn_
-00022000: 6861 7368 203d 2077 332e 6574 682e 7265  hash = w3.eth.re
-00022010: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
-00022020: 6e28 7478 6e5f 6861 7368 2c20 7478 6e5f  n(txn_hash, txn_
-00022030: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-00022040: 7265 706c 6163 655f 7478 6e20 3d20 7733  replace_txn = w3
-00022050: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
-00022060: 7469 6f6e 2872 6570 6c61 6365 5f74 786e  tion(replace_txn
-00022070: 5f68 6173 6829 0a20 2020 2020 2020 2023  _hash).        #
-00022080: 2053 7472 6174 6567 7920 7072 6f76 6964   Strategy provid
-00022090: 6573 206c 6f77 6572 2067 6173 2070 7269  es lower gas pri
-000220a0: 6365 202d 206d 696e 696d 756d 2070 7265  ce - minimum pre
-000220b0: 6665 7272 6564 0a20 2020 2020 2020 2061  ferred.        a
-000220c0: 7373 6572 7420 7265 706c 6163 655f 7478  ssert replace_tx
-000220d0: 6e5b 2267 6173 5072 6963 6522 5d20 3d3d  n["gasPrice"] ==
-000220e0: 206d 6174 682e 6365 696c 2867 6173 5f70   math.ceil(gas_p
-000220f0: 7269 6365 202a 2031 2e31 3235 290a 2020  rice * 1.125).  
-00022100: 2020 2020 2020 7733 2e65 7468 2e73 6574        w3.eth.set
-00022110: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
-00022120: 6567 7928 4e6f 6e65 2920 2023 2072 6573  egy(None)  # res
-00022130: 6574 2073 7472 6174 6567 790a 0a20 2020  et strategy..   
-00022140: 2064 6566 2074 6573 745f 6574 685f 6d6f   def test_eth_mo
-00022150: 6469 6679 5f74 7261 6e73 6163 7469 6f6e  dify_transaction
-00022160: 5f6c 6567 6163 7928 0a20 2020 2020 2020  _legacy(.       
-00022170: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
-00022180: 222c 2075 6e6c 6f63 6b65 645f 6163 636f  ", unlocked_acco
-00022190: 756e 743a 2043 6865 636b 7375 6d41 6464  unt: ChecksumAdd
-000221a0: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-000221b0: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-000221c0: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-000221d0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-000221e0: 2022 6672 6f6d 223a 2075 6e6c 6f63 6b65   "from": unlocke
-000221f0: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
-00022200: 2020 2020 2020 2022 746f 223a 2075 6e6c         "to": unl
-00022210: 6f63 6b65 645f 6163 636f 756e 742c 0a20  ocked_account,. 
-00022220: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
-00022230: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
-00022240: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
-00022250: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
-00022260: 2020 2267 6173 5072 6963 6522 3a20 7733    "gasPrice": w3
-00022270: 2e74 6f5f 7765 6928 0a20 2020 2020 2020  .to_wei(.       
-00022280: 2020 2020 2020 2020 2031 2c20 2267 7765           1, "gwe
-00022290: 6922 0a20 2020 2020 2020 2020 2020 2029  i".            )
-000222a0: 2c20 2023 206d 7573 7420 6265 2067 7265  ,  # must be gre
-000222b0: 6174 6572 2074 6861 6e20 6261 7365 5f66  ater than base_f
-000222c0: 6565 2070 6f73 7420 4c6f 6e64 6f6e 0a20  ee post London. 
-000222d0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-000222e0: 2074 786e 5f68 6173 6820 3d20 7733 2e65   txn_hash = w3.e
-000222f0: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
-00022300: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
-00022310: 0a20 2020 2020 2020 206d 6f64 6966 6965  .        modifie
-00022320: 645f 7478 6e5f 6861 7368 203d 2077 332e  d_txn_hash = w3.
-00022330: 6574 682e 6d6f 6469 6679 5f74 7261 6e73  eth.modify_trans
-00022340: 6163 7469 6f6e 280a 2020 2020 2020 2020  action(.        
-00022350: 2020 2020 7478 6e5f 6861 7368 2c20 6761      txn_hash, ga
-00022360: 7350 7269 6365 3d28 6361 7374 2869 6e74  sPrice=(cast(int
-00022370: 2c20 7478 6e5f 7061 7261 6d73 5b22 6761  , txn_params["ga
-00022380: 7350 7269 6365 225d 2920 2a20 3229 2c20  sPrice"]) * 2), 
-00022390: 7661 6c75 653d 320a 2020 2020 2020 2020  value=2.        
-000223a0: 290a 2020 2020 2020 2020 6d6f 6469 6669  ).        modifi
-000223b0: 6564 5f74 786e 203d 2077 332e 6574 682e  ed_txn = w3.eth.
-000223c0: 6765 745f 7472 616e 7361 6374 696f 6e28  get_transaction(
-000223d0: 6d6f 6469 6669 6564 5f74 786e 5f68 6173  modified_txn_has
-000223e0: 6829 0a0a 2020 2020 2020 2020 6173 7365  h)..        asse
-000223f0: 7274 2069 735f 7361 6d65 5f61 6464 7265  rt is_same_addre
-00022400: 7373 280a 2020 2020 2020 2020 2020 2020  ss(.            
-00022410: 6d6f 6469 6669 6564 5f74 786e 5b22 6672  modified_txn["fr
-00022420: 6f6d 225d 2c20 6361 7374 2843 6865 636b  om"], cast(Check
-00022430: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
-00022440: 7061 7261 6d73 5b22 6672 6f6d 225d 290a  params["from"]).
-00022450: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00022460: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
-00022470: 5f61 6464 7265 7373 280a 2020 2020 2020  _address(.      
-00022480: 2020 2020 2020 6d6f 6469 6669 6564 5f74        modified_t
-00022490: 786e 5b22 746f 225d 2c20 6361 7374 2843  xn["to"], cast(C
-000224a0: 6865 636b 7375 6d41 6464 7265 7373 2c20  hecksumAddress, 
-000224b0: 7478 6e5f 7061 7261 6d73 5b22 746f 225d  txn_params["to"]
-000224c0: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-000224d0: 2020 2020 6173 7365 7274 206d 6f64 6966      assert modif
-000224e0: 6965 645f 7478 6e5b 2276 616c 7565 225d  ied_txn["value"]
-000224f0: 203d 3d20 320a 2020 2020 2020 2020 6173   == 2.        as
-00022500: 7365 7274 206d 6f64 6966 6965 645f 7478  sert modified_tx
-00022510: 6e5b 2267 6173 225d 203d 3d20 3231 3030  n["gas"] == 2100
-00022520: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
-00022530: 206d 6f64 6966 6965 645f 7478 6e5b 2267   modified_txn["g
-00022540: 6173 5072 6963 6522 5d20 3d3d 2063 6173  asPrice"] == cas
-00022550: 7428 696e 742c 2074 786e 5f70 6172 616d  t(int, txn_param
-00022560: 735b 2267 6173 5072 6963 6522 5d29 202a  s["gasPrice"]) *
-00022570: 2032 0a0a 2020 2020 6465 6620 7465 7374   2..    def test
-00022580: 5f65 7468 5f6d 6f64 6966 795f 7472 616e  _eth_modify_tran
-00022590: 7361 6374 696f 6e28 0a20 2020 2020 2020  saction(.       
-000225a0: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
-000225b0: 222c 2075 6e6c 6f63 6b65 645f 6163 636f  ", unlocked_acco
-000225c0: 756e 743a 2043 6865 636b 7375 6d41 6464  unt: ChecksumAdd
-000225d0: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-000225e0: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-000225f0: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-00022600: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00022610: 2022 6672 6f6d 223a 2075 6e6c 6f63 6b65   "from": unlocke
-00022620: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
-00022630: 2020 2020 2020 2022 746f 223a 2075 6e6c         "to": unl
-00022640: 6f63 6b65 645f 6163 636f 756e 742c 0a20  ocked_account,. 
-00022650: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
-00022660: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
-00022670: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
-00022680: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
-00022690: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
-000226a0: 6550 6572 4761 7322 3a20 7733 2e74 6f5f  ePerGas": w3.to_
-000226b0: 7765 6928 312c 2022 6777 6569 2229 2c0a  wei(1, "gwei"),.
-000226c0: 2020 2020 2020 2020 2020 2020 226d 6178              "max
-000226d0: 4665 6550 6572 4761 7322 3a20 7733 2e74  FeePerGas": w3.t
-000226e0: 6f5f 7765 6928 322c 2022 6777 6569 2229  o_wei(2, "gwei")
-000226f0: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-00022700: 2020 2020 7478 6e5f 6861 7368 203d 2077      txn_hash = w
-00022710: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
-00022720: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
-00022730: 7329 0a0a 2020 2020 2020 2020 6d6f 6469  s)..        modi
-00022740: 6669 6564 5f74 786e 5f68 6173 6820 3d20  fied_txn_hash = 
-00022750: 7733 2e65 7468 2e6d 6f64 6966 795f 7472  w3.eth.modify_tr
-00022760: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
-00022770: 2020 2020 2020 2074 786e 5f68 6173 682c         txn_hash,
-00022780: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-00022790: 7565 3d32 2c0a 2020 2020 2020 2020 2020  ue=2,.          
-000227a0: 2020 6d61 7850 7269 6f72 6974 7946 6565    maxPriorityFee
-000227b0: 5065 7247 6173 3d28 6361 7374 2857 6569  PerGas=(cast(Wei
-000227c0: 2c20 7478 6e5f 7061 7261 6d73 5b22 6d61  , txn_params["ma
-000227d0: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-000227e0: 6173 225d 2920 2a20 3229 2c0a 2020 2020  as"]) * 2),.    
-000227f0: 2020 2020 2020 2020 6d61 7846 6565 5065          maxFeePe
-00022800: 7247 6173 3d28 6361 7374 2857 6569 2c20  rGas=(cast(Wei, 
-00022810: 7478 6e5f 7061 7261 6d73 5b22 6d61 7846  txn_params["maxF
-00022820: 6565 5065 7247 6173 225d 2920 2a20 3229  eePerGas"]) * 2)
-00022830: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00022840: 2020 2020 6d6f 6469 6669 6564 5f74 786e      modified_txn
-00022850: 203d 2077 332e 6574 682e 6765 745f 7472   = w3.eth.get_tr
-00022860: 616e 7361 6374 696f 6e28 6d6f 6469 6669  ansaction(modifi
-00022870: 6564 5f74 786e 5f68 6173 6829 0a0a 2020  ed_txn_hash)..  
-00022880: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00022890: 7361 6d65 5f61 6464 7265 7373 280a 2020  same_address(.  
-000228a0: 2020 2020 2020 2020 2020 6d6f 6469 6669            modifi
-000228b0: 6564 5f74 786e 5b22 6672 6f6d 225d 2c20  ed_txn["from"], 
-000228c0: 6361 7374 2843 6865 636b 7375 6d41 6464  cast(ChecksumAdd
-000228d0: 7265 7373 2c20 7478 6e5f 7061 7261 6d73  ress, txn_params
-000228e0: 5b22 6672 6f6d 225d 290a 2020 2020 2020  ["from"]).      
-000228f0: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
-00022900: 7274 2069 735f 7361 6d65 5f61 6464 7265  rt is_same_addre
-00022910: 7373 280a 2020 2020 2020 2020 2020 2020  ss(.            
-00022920: 6d6f 6469 6669 6564 5f74 786e 5b22 746f  modified_txn["to
-00022930: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
-00022940: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
-00022950: 7261 6d73 5b22 746f 225d 290a 2020 2020  rams["to"]).    
-00022960: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
-00022970: 7365 7274 206d 6f64 6966 6965 645f 7478  sert modified_tx
-00022980: 6e5b 2276 616c 7565 225d 203d 3d20 320a  n["value"] == 2.
-00022990: 2020 2020 2020 2020 6173 7365 7274 206d          assert m
-000229a0: 6f64 6966 6965 645f 7478 6e5b 2267 6173  odified_txn["gas
-000229b0: 225d 203d 3d20 3231 3030 300a 2020 2020  "] == 21000.    
-000229c0: 2020 2020 6173 7365 7274 2028 0a20 2020      assert (.   
-000229d0: 2020 2020 2020 2020 206d 6f64 6966 6965           modifie
-000229e0: 645f 7478 6e5b 226d 6178 5072 696f 7269  d_txn["maxPriori
-000229f0: 7479 4665 6550 6572 4761 7322 5d0a 2020  tyFeePerGas"].  
-00022a00: 2020 2020 2020 2020 2020 3d3d 2063 6173            == cas
-00022a10: 7428 5765 692c 2074 786e 5f70 6172 616d  t(Wei, txn_param
-00022a20: 735b 226d 6178 5072 696f 7269 7479 4665  s["maxPriorityFe
-00022a30: 6550 6572 4761 7322 5d29 202a 2032 0a20  ePerGas"]) * 2. 
-00022a40: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00022a50: 2061 7373 6572 7420 6d6f 6469 6669 6564   assert modified
-00022a60: 5f74 786e 5b22 6d61 7846 6565 5065 7247  _txn["maxFeePerG
-00022a70: 6173 225d 203d 3d20 6361 7374 2857 6569  as"] == cast(Wei
-00022a80: 2c20 7478 6e5f 7061 7261 6d73 5b22 6d61  , txn_params["ma
-00022a90: 7846 6565 5065 7247 6173 225d 2920 2a20  xFeePerGas"]) * 
-00022aa0: 320a 0a20 2020 2064 6566 2074 6573 745f  2..    def test_
-00022ab0: 6574 685f 7365 6e64 5f72 6177 5f74 7261  eth_send_raw_tra
-00022ac0: 6e73 6163 7469 6f6e 280a 2020 2020 2020  nsaction(.      
-00022ad0: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
-00022ae0: 3322 2c20 756e 6c6f 636b 6564 5f61 6363  3", unlocked_acc
-00022af0: 6f75 6e74 3a20 4368 6563 6b73 756d 4164  ount: ChecksumAd
-00022b00: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
-00022b10: 6f6e 653a 0a20 2020 2020 2020 2073 6967  one:.        sig
-00022b20: 6e65 645f 7478 203d 2077 332e 6574 682e  ned_tx = w3.eth.
-00022b30: 6163 636f 756e 742e 7369 676e 5f74 7261  account.sign_tra
-00022b40: 6e73 6163 7469 6f6e 280a 2020 2020 2020  nsaction(.      
-00022b50: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-00022b60: 2020 2020 2020 2020 2274 6f22 3a20 2230          "to": "0
-00022b70: 7830 3030 3030 3030 3030 3030 3030 3030  x000000000000000
-00022b80: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00022b90: 3030 3030 3030 3030 3022 2c0a 2020 2020  000000000",.    
-00022ba0: 2020 2020 2020 2020 2020 2020 2276 616c              "val
-00022bb0: 7565 223a 2030 2c0a 2020 2020 2020 2020  ue": 0,.        
-00022bc0: 2020 2020 2020 2020 226e 6f6e 6365 223a          "nonce":
-00022bd0: 2077 332e 6574 682e 6765 745f 7472 616e   w3.eth.get_tran
-00022be0: 7361 6374 696f 6e5f 636f 756e 7428 756e  saction_count(un
-00022bf0: 6c6f 636b 6564 5f61 6363 6f75 6e74 292c  locked_account),
-00022c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022c10: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
-00022c20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00022c30: 6d61 7846 6565 5065 7247 6173 223a 2031  maxFeePerGas": 1
-00022c40: 3030 3030 3030 3030 302c 0a20 2020 2020  000000000,.     
-00022c50: 2020 2020 2020 2020 2020 2022 6d61 7850             "maxP
-00022c60: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
-00022c70: 223a 2031 3030 3030 3030 3030 302c 0a20  ": 1000000000,. 
-00022c80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00022c90: 6368 6169 6e49 6422 3a20 3133 3132 3737  chainId": 131277
-00022ca0: 3332 3239 3430 3533 372c 0a20 2020 2020  322940537,.     
-00022cb0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00022cc0: 2020 2020 2020 2320 756e 6c6f 636b 6564        # unlocked
-00022cd0: 5f61 6363 6f75 6e74 2070 7269 7661 7465  _account private
-00022ce0: 206b 6579 3a0a 2020 2020 2020 2020 2020   key:.          
-00022cf0: 2020 2230 7833 3932 6636 3361 3739 6231    "0x392f63a79b1
-00022d00: 6666 3837 3734 3834 3566 3366 6136 3964  ff8774845f3fa69d
-00022d10: 6534 6131 3338 3030 6135 3965 3730 3833  e4a13800a59e7083
-00022d20: 6635 3138 3766 3135 3538 6630 3739 3761  f5187f1558f0797a
-00022d30: 6430 6630 3122 2c0a 2020 2020 2020 2020  d0f01",.        
-00022d40: 290a 2020 2020 2020 2020 7478 6e5f 6861  ).        txn_ha
-00022d50: 7368 203d 2077 332e 6574 682e 7365 6e64  sh = w3.eth.send
-00022d60: 5f72 6177 5f74 7261 6e73 6163 7469 6f6e  _raw_transaction
-00022d70: 2873 6967 6e65 645f 7478 2e72 6177 5472  (signed_tx.rawTr
-00022d80: 616e 7361 6374 696f 6e29 0a20 2020 2020  ansaction).     
-00022d90: 2020 2061 7373 6572 7420 7478 6e5f 6861     assert txn_ha
-00022da0: 7368 203d 3d20 7369 676e 6564 5f74 782e  sh == signed_tx.
-00022db0: 6861 7368 0a0a 2020 2020 6465 6620 7465  hash..    def te
-00022dc0: 7374 5f65 7468 5f63 616c 6c28 7365 6c66  st_eth_call(self
-00022dd0: 2c20 7733 3a20 2257 6562 3322 2c20 6d61  , w3: "Web3", ma
-00022de0: 7468 5f63 6f6e 7472 6163 743a 2022 436f  th_contract: "Co
-00022df0: 6e74 7261 6374 2229 202d 3e20 4e6f 6e65  ntract") -> None
-00022e00: 3a0a 2020 2020 2020 2020 636f 696e 6261  :.        coinba
-00022e10: 7365 203d 2077 332e 6574 682e 636f 696e  se = w3.eth.coin
-00022e20: 6261 7365 0a20 2020 2020 2020 2074 786e  base.        txn
-00022e30: 5f70 6172 616d 7320 3d20 6d61 7468 5f63  _params = math_c
-00022e40: 6f6e 7472 6163 742e 5f70 7265 7061 7265  ontract._prepare
-00022e50: 5f74 7261 6e73 6163 7469 6f6e 280a 2020  _transaction(.  
-00022e60: 2020 2020 2020 2020 2020 666e 5f6e 616d            fn_nam
-00022e70: 653d 2261 6464 222c 0a20 2020 2020 2020  e="add",.       
-00022e80: 2020 2020 2066 6e5f 6172 6773 3d28 372c       fn_args=(7,
-00022e90: 2031 3129 2c0a 2020 2020 2020 2020 2020   11),.          
-00022ea0: 2020 7472 616e 7361 6374 696f 6e3d 7b22    transaction={"
-00022eb0: 6672 6f6d 223a 2063 6f69 6e62 6173 652c  from": coinbase,
-00022ec0: 2022 746f 223a 206d 6174 685f 636f 6e74   "to": math_cont
-00022ed0: 7261 6374 2e61 6464 7265 7373 7d2c 0a20  ract.address},. 
-00022ee0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00022ef0: 2063 616c 6c5f 7265 7375 6c74 203d 2077   call_result = w
-00022f00: 332e 6574 682e 6361 6c6c 2874 786e 5f70  3.eth.call(txn_p
-00022f10: 6172 616d 7329 0a20 2020 2020 2020 2061  arams).        a
-00022f20: 7373 6572 7420 6973 5f73 7472 696e 6728  ssert is_string(
-00022f30: 6361 6c6c 5f72 6573 756c 7429 0a20 2020  call_result).   
-00022f40: 2020 2020 2028 7265 7375 6c74 2c29 203d       (result,) =
-00022f50: 2077 332e 636f 6465 632e 6465 636f 6465   w3.codec.decode
-00022f60: 285b 2275 696e 7432 3536 225d 2c20 6361  (["uint256"], ca
-00022f70: 6c6c 5f72 6573 756c 7429 0a20 2020 2020  ll_result).     
-00022f80: 2020 2061 7373 6572 7420 7265 7375 6c74     assert result
-00022f90: 203d 3d20 3138 0a0a 2020 2020 6465 6620   == 18..    def 
-00022fa0: 7465 7374 5f65 7468 5f63 616c 6c5f 7769  test_eth_call_wi
-00022fb0: 7468 5f6f 7665 7272 6964 655f 636f 6465  th_override_code
-00022fc0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-00022fd0: 7733 3a20 2257 6562 3322 2c20 7265 7665  w3: "Web3", reve
-00022fe0: 7274 5f63 6f6e 7472 6163 743a 2022 436f  rt_contract: "Co
-00022ff0: 6e74 7261 6374 220a 2020 2020 2920 2d3e  ntract".    ) ->
-00023000: 204e 6f6e 653a 0a20 2020 2020 2020 2063   None:.        c
-00023010: 6f69 6e62 6173 6520 3d20 7733 2e65 7468  oinbase = w3.eth
-00023020: 2e63 6f69 6e62 6173 650a 2020 2020 2020  .coinbase.      
-00023030: 2020 7478 6e5f 7061 7261 6d73 203d 2072    txn_params = r
-00023040: 6576 6572 745f 636f 6e74 7261 6374 2e5f  evert_contract._
-00023050: 7072 6570 6172 655f 7472 616e 7361 6374  prepare_transact
-00023060: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-00023070: 2066 6e5f 6e61 6d65 3d22 6e6f 726d 616c   fn_name="normal
-00023080: 4675 6e63 7469 6f6e 222c 0a20 2020 2020  Function",.     
-00023090: 2020 2020 2020 2074 7261 6e73 6163 7469         transacti
-000230a0: 6f6e 3d7b 2266 726f 6d22 3a20 636f 696e  on={"from": coin
-000230b0: 6261 7365 2c20 2274 6f22 3a20 7265 7665  base, "to": reve
-000230c0: 7274 5f63 6f6e 7472 6163 742e 6164 6472  rt_contract.addr
-000230d0: 6573 737d 2c0a 2020 2020 2020 2020 290a  ess},.        ).
-000230e0: 2020 2020 2020 2020 6361 6c6c 5f72 6573          call_res
-000230f0: 756c 7420 3d20 7733 2e65 7468 2e63 616c  ult = w3.eth.cal
-00023100: 6c28 7478 6e5f 7061 7261 6d73 290a 2020  l(txn_params).  
-00023110: 2020 2020 2020 2872 6573 756c 742c 2920        (result,) 
-00023120: 3d20 7733 2e63 6f64 6563 2e64 6563 6f64  = w3.codec.decod
-00023130: 6528 5b22 626f 6f6c 225d 2c20 6361 6c6c  e(["bool"], call
-00023140: 5f72 6573 756c 7429 0a20 2020 2020 2020  _result).       
-00023150: 2061 7373 6572 7420 7265 7375 6c74 2069   assert result i
-00023160: 7320 5472 7565 0a0a 2020 2020 2020 2020  s True..        
-00023170: 2320 6f76 6572 7269 6465 2072 756e 7469  # override runti
-00023180: 6d65 2062 7974 6563 6f64 653a 2060 6e6f  me bytecode: `no
-00023190: 726d 616c 4675 6e63 7469 6f6e 6020 7265  rmalFunction` re
-000231a0: 7475 726e 7320 6066 616c 7365 600a 2020  turns `false`.  
-000231b0: 2020 2020 2020 6f76 6572 7269 6465 5f63        override_c
-000231c0: 6f64 6520 3d20 4865 7853 7472 280a 2020  ode = HexStr(.  
-000231d0: 2020 2020 2020 2020 2020 2230 7836 3038            "0x608
-000231e0: 3036 3034 3035 3233 3438 3031 3536 3030  0604052348015600
-000231f0: 6635 3736 3030 3038 3066 6435 6235 3036  f57600080fd5b506
-00023200: 3030 3433 3631 3036 3033 6335 3736 3030  0043610603c57600
-00023210: 3033 3536 3065 3031 6338 3036 3331 3835  03560e01c8063185
-00023220: 6333 3861 3431 3436 3034 3135 3738 3036  c38a414604157806
-00023230: 3363 3036 6139 3763 6231 3436 3034 3935  3c06a97cb1460495
-00023240: 3738 3036 3364 3637 6534 6238 3431 3436  78063d67e4b84146
-00023250: 3035 3135 3735 6236 3030 3038 3066 6435  051575b600080fd5
-00023260: 6236 3034 3736 3037 3135 3635 6230 3035  b60476071565b005
-00023270: 6236 3034 6636 3064 6635 3635 6230 3035  b604f60df565b005
-00023280: 6236 3035 3736 3065 3435 3635 6236 3034  b605760e4565b604
-00023290: 3035 3138 3038 3231 3531 3531 3531 3538  0518082151515158
-000232a0: 3135 3236 3032 3030 3139 3135 3035 3036  1526020019150506
-000232b0: 3034 3035 3138 3039 3130 3339 3066 3335  0405180910390f35
-000232c0: 6236 3034 3035 3137 6630 3863 3337 3961  b6040517f08c379a
-000232d0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-000232e0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-000232f0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00023300: 3030 3030 3030 3030 3038 3135 3236 3030  0000000008152600
-00023310: 3430 3138 3038 3036 3032 3030 3138 3238  4018080602001828
-00023320: 3130 3338 3235 3236 3031 6238 3135 3236  1038252601b81526
-00023330: 3032 3030 3138 3037 6634 3637 3536 6536  02001807f46756e6
-00023340: 3337 3436 3936 6636 6532 3036 3836 3137  374696f6e2068617
-00023350: 3332 3036 3236 3536 3536 6532 3037 3236  3206265656e20726
-00023360: 3537 3636 3537 3237 3436 3536 3432 6530  57665727465642e0
-00023370: 3030 3030 3030 3030 3038 3135 3235 3036  0000000008152506
-00023380: 3032 3030 3139 3135 3035 3036 3034 3035  0200191505060405
-00023390: 3138 3039 3130 3339 3066 6435 6236 3030  180910390fd5b600
-000233a0: 3038 3066 6435 6236 3030 3038 3039 3035  080fd5b600080905
-000233b0: 3039 3035 3666 6561 3236 3436 3937 3036  09056fea26469706
-000233c0: 3637 3335 3832 3231 3232 3062 6237 3165  67358221220bb71e
-000233d0: 3965 3961 3265 3237 3163 6430 6662 6538  9e9a2e271cd0fbe8
-000233e0: 3333 3532 3461 3365 6136 3764 6639 3566  33524a3ea67df95f
-000233f0: 3235 6561 3133 6165 6635 6230 6137 3631  25ea13aef5b0a761
-00023400: 6661 3532 6235 3338 6631 3036 3437 3336  fa52b538f1064736
-00023410: 6636 6336 3334 3330 3030 3630 3130 3033  f6c6343000601003
-00023420: 3322 2020 2320 6e6f 7161 3a20 4535 3031  3"  # noqa: E501
-00023430: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00023440: 2020 2063 616c 6c5f 7265 7375 6c74 203d     call_result =
-00023450: 2077 332e 6574 682e 6361 6c6c 280a 2020   w3.eth.call(.  
-00023460: 2020 2020 2020 2020 2020 7478 6e5f 7061            txn_pa
-00023470: 7261 6d73 2c20 226c 6174 6573 7422 2c20  rams, "latest", 
-00023480: 7b72 6576 6572 745f 636f 6e74 7261 6374  {revert_contract
-00023490: 2e61 6464 7265 7373 3a20 7b22 636f 6465  .address: {"code
-000234a0: 223a 206f 7665 7272 6964 655f 636f 6465  ": override_code
-000234b0: 7d7d 0a20 2020 2020 2020 2029 0a20 2020  }}.        ).   
-000234c0: 2020 2020 2028 7265 7375 6c74 2c29 203d       (result,) =
-000234d0: 2077 332e 636f 6465 632e 6465 636f 6465   w3.codec.decode
-000234e0: 285b 2262 6f6f 6c22 5d2c 2063 616c 6c5f  (["bool"], call_
-000234f0: 7265 7375 6c74 290a 2020 2020 2020 2020  result).        
-00023500: 6173 7365 7274 2072 6573 756c 7420 6973  assert result is
-00023510: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
-00023520: 2320 7465 7374 2062 7974 6573 0a0a 2020  # test bytes..  
-00023530: 2020 2020 2020 6279 7465 735f 6361 6c6c        bytes_call
-00023540: 5f72 6573 756c 7420 3d20 7733 2e65 7468  _result = w3.eth
-00023550: 2e63 616c 6c28 0a20 2020 2020 2020 2020  .call(.         
-00023560: 2020 2074 786e 5f70 6172 616d 732c 0a20     txn_params,. 
-00023570: 2020 2020 2020 2020 2020 2022 6c61 7465             "late
-00023580: 7374 222c 0a20 2020 2020 2020 2020 2020  st",.           
-00023590: 207b 7265 7665 7274 5f63 6f6e 7472 6163   {revert_contrac
-000235a0: 742e 6164 6472 6573 733a 207b 2263 6f64  t.address: {"cod
-000235b0: 6522 3a20 746f 5f62 7974 6573 2868 6578  e": to_bytes(hex
-000235c0: 7374 723d 6f76 6572 7269 6465 5f63 6f64  str=override_cod
-000235d0: 6529 7d7d 2c0a 2020 2020 2020 2020 290a  e)}},.        ).
-000235e0: 2020 2020 2020 2020 2862 7974 6573 5f72          (bytes_r
-000235f0: 6573 756c 742c 2920 3d20 7733 2e63 6f64  esult,) = w3.cod
-00023600: 6563 2e64 6563 6f64 6528 5b22 626f 6f6c  ec.decode(["bool
-00023610: 225d 2c20 6279 7465 735f 6361 6c6c 5f72  "], bytes_call_r
-00023620: 6573 756c 7429 0a20 2020 2020 2020 2061  esult).        a
-00023630: 7373 6572 7420 6279 7465 735f 7265 7375  ssert bytes_resu
-00023640: 6c74 2069 7320 4661 6c73 650a 0a20 2020  lt is False..   
-00023650: 2040 7079 7465 7374 2e6d 6172 6b2e 7061   @pytest.mark.pa
-00023660: 7261 6d65 7472 697a 6528 0a20 2020 2020  rametrize(.     
-00023670: 2020 2022 7061 7261 6d73 222c 0a20 2020     "params",.   
-00023680: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-00023690: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-000236a0: 2020 2020 2022 6e6f 6e63 6522 3a20 312c       "nonce": 1,
-000236b0: 2020 2320 696e 740a 2020 2020 2020 2020    # int.        
-000236c0: 2020 2020 2020 2020 2262 616c 616e 6365          "balance
-000236d0: 223a 2031 2c20 2023 2069 6e74 0a20 2020  ": 1,  # int.   
-000236e0: 2020 2020 2020 2020 2020 2020 2022 636f               "co
-000236f0: 6465 223a 2048 6578 5374 7228 2230 7822  de": HexStr("0x"
-00023700: 292c 2020 2320 4865 7853 7472 0a20 2020  ),  # HexStr.   
-00023710: 2020 2020 2020 2020 2020 2020 2023 2077               # w
-00023720: 6974 6820 7374 6174 650a 2020 2020 2020  ith state.      
-00023730: 2020 2020 2020 2020 2020 2273 7461 7465            "state
-00023740: 223a 207b 4865 7853 7472 2866 2230 787b  ": {HexStr(f"0x{
-00023750: 2730 3027 202a 2033 327d 2229 3a20 4865  '00' * 32}"): He
-00023760: 7853 7472 2866 2230 787b 2730 3027 202a  xStr(f"0x{'00' *
-00023770: 2033 327d 2229 7d2c 0a20 2020 2020 2020   32}")},.       
-00023780: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-00023790: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
-000237a0: 2020 2020 2020 226e 6f6e 6365 223a 2048        "nonce": H
-000237b0: 6578 5374 7228 2230 7831 2229 2c20 2023  exStr("0x1"),  #
-000237c0: 2048 6578 5374 720a 2020 2020 2020 2020   HexStr.        
-000237d0: 2020 2020 2020 2020 2262 616c 616e 6365          "balance
-000237e0: 223a 2048 6578 5374 7228 2230 7831 2229  ": HexStr("0x1")
-000237f0: 2c20 2023 2048 6578 5374 720a 2020 2020  ,  # HexStr.    
-00023800: 2020 2020 2020 2020 2020 2020 2263 6f64              "cod
-00023810: 6522 3a20 6222 5c78 3030 222c 2020 2320  e": b"\x00",  # 
-00023820: 6279 7465 730a 2020 2020 2020 2020 2020  bytes.          
-00023830: 2020 2020 2020 2320 7769 7468 2073 7461        # with sta
-00023840: 7465 4469 6666 0a20 2020 2020 2020 2020  teDiff.         
-00023850: 2020 2020 2020 2022 7374 6174 6544 6966         "stateDif
-00023860: 6622 3a20 7b48 6578 5374 7228 6622 3078  f": {HexStr(f"0x
-00023870: 7b27 3030 2720 2a20 3332 7d22 293a 2048  {'00' * 32}"): H
-00023880: 6578 5374 7228 6622 3078 7b27 3030 2720  exStr(f"0x{'00' 
-00023890: 2a20 3332 7d22 297d 2c0a 2020 2020 2020  * 32}")},.      
-000238a0: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-000238b0: 2029 2c0a 2020 2020 290a 2020 2020 6465   ),.    ).    de
-000238c0: 6620 7465 7374 5f65 7468 5f63 616c 6c5f  f test_eth_call_
-000238d0: 7769 7468 5f6f 7665 7272 6964 655f 7061  with_override_pa
-000238e0: 7261 6d5f 7479 7065 5f63 6865 636b 280a  ram_type_check(.
-000238f0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00023900: 2020 2020 2020 7733 3a20 2257 6562 3322        w3: "Web3"
-00023910: 2c0a 2020 2020 2020 2020 6d61 7468 5f63  ,.        math_c
-00023920: 6f6e 7472 6163 743a 2022 436f 6e74 7261  ontract: "Contra
-00023930: 6374 222c 0a20 2020 2020 2020 2070 6172  ct",.        par
-00023940: 616d 733a 2053 7461 7465 4f76 6572 7269  ams: StateOverri
-00023950: 6465 5061 7261 6d73 2c0a 2020 2020 2920  deParams,.    ) 
-00023960: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00023970: 2074 786e 5f70 6172 616d 733a 2054 7850   txn_params: TxP
-00023980: 6172 616d 7320 3d20 7b22 6672 6f6d 223a  arams = {"from":
-00023990: 2077 332e 6574 682e 636f 696e 6261 7365   w3.eth.coinbase
-000239a0: 7d0a 0a20 2020 2020 2020 2023 2061 7373  }..        # ass
-000239b0: 6572 7420 646f 6573 206e 6f74 2072 6169  ert does not rai
-000239c0: 7365 0a20 2020 2020 2020 2077 332e 6574  se.        w3.et
-000239d0: 682e 6361 6c6c 2874 786e 5f70 6172 616d  h.call(txn_param
-000239e0: 732c 2022 6c61 7465 7374 222c 207b 6d61  s, "latest", {ma
-000239f0: 7468 5f63 6f6e 7472 6163 742e 6164 6472  th_contract.addr
-00023a00: 6573 733a 2070 6172 616d 737d 290a 0a20  ess: params}).. 
-00023a10: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-00023a20: 6361 6c6c 5f77 6974 685f 305f 7265 7375  call_with_0_resu
-00023a30: 6c74 280a 2020 2020 2020 2020 7365 6c66  lt(.        self
-00023a40: 2c20 7733 3a20 2257 6562 3322 2c20 6d61  , w3: "Web3", ma
-00023a50: 7468 5f63 6f6e 7472 6163 743a 2022 436f  th_contract: "Co
-00023a60: 6e74 7261 6374 220a 2020 2020 2920 2d3e  ntract".    ) ->
-00023a70: 204e 6f6e 653a 0a20 2020 2020 2020 2063   None:.        c
-00023a80: 6f69 6e62 6173 6520 3d20 7733 2e65 7468  oinbase = w3.eth
-00023a90: 2e63 6f69 6e62 6173 650a 2020 2020 2020  .coinbase.      
-00023aa0: 2020 7478 6e5f 7061 7261 6d73 203d 206d    txn_params = m
-00023ab0: 6174 685f 636f 6e74 7261 6374 2e5f 7072  ath_contract._pr
-00023ac0: 6570 6172 655f 7472 616e 7361 6374 696f  epare_transactio
-00023ad0: 6e28 0a20 2020 2020 2020 2020 2020 2066  n(.            f
-00023ae0: 6e5f 6e61 6d65 3d22 6164 6422 2c0a 2020  n_name="add",.  
-00023af0: 2020 2020 2020 2020 2020 666e 5f61 7267            fn_arg
-00023b00: 733d 2830 2c20 3029 2c0a 2020 2020 2020  s=(0, 0),.      
-00023b10: 2020 2020 2020 7472 616e 7361 6374 696f        transactio
-00023b20: 6e3d 7b22 6672 6f6d 223a 2063 6f69 6e62  n={"from": coinb
-00023b30: 6173 652c 2022 746f 223a 206d 6174 685f  ase, "to": math_
-00023b40: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
-00023b50: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
-00023b60: 2020 2020 2063 616c 6c5f 7265 7375 6c74       call_result
-00023b70: 203d 2077 332e 6574 682e 6361 6c6c 2874   = w3.eth.call(t
-00023b80: 786e 5f70 6172 616d 7329 0a20 2020 2020  xn_params).     
-00023b90: 2020 2061 7373 6572 7420 6973 5f73 7472     assert is_str
-00023ba0: 696e 6728 6361 6c6c 5f72 6573 756c 7429  ing(call_result)
-00023bb0: 0a20 2020 2020 2020 2028 7265 7375 6c74  .        (result
-00023bc0: 2c29 203d 2077 332e 636f 6465 632e 6465  ,) = w3.codec.de
-00023bd0: 636f 6465 285b 2275 696e 7432 3536 225d  code(["uint256"]
-00023be0: 2c20 6361 6c6c 5f72 6573 756c 7429 0a20  , call_result). 
-00023bf0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-00023c00: 7375 6c74 203d 3d20 300a 0a20 2020 2064  sult == 0..    d
-00023c10: 6566 2074 6573 745f 6574 685f 6361 6c6c  ef test_eth_call
-00023c20: 5f72 6576 6572 745f 7769 7468 5f6d 7367  _revert_with_msg
-00023c30: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00023c40: 2020 2020 2020 2020 7733 3a20 2257 6562          w3: "Web
-00023c50: 3322 2c0a 2020 2020 2020 2020 7265 7665  3",.        reve
-00023c60: 7274 5f63 6f6e 7472 6163 743a 2022 436f  rt_contract: "Co
-00023c70: 6e74 7261 6374 222c 0a20 2020 2020 2020  ntract",.       
-00023c80: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
-00023c90: 743a 2043 6865 636b 7375 6d41 6464 7265  t: ChecksumAddre
-00023ca0: 7373 2c0a 2020 2020 2920 2d3e 204e 6f6e  ss,.    ) -> Non
-00023cb0: 653a 0a20 2020 2020 2020 2074 786e 5f70  e:.        txn_p
-00023cc0: 6172 616d 7320 3d20 7265 7665 7274 5f63  arams = revert_c
-00023cd0: 6f6e 7472 6163 742e 5f70 7265 7061 7265  ontract._prepare
-00023ce0: 5f74 7261 6e73 6163 7469 6f6e 280a 2020  _transaction(.  
-00023cf0: 2020 2020 2020 2020 2020 666e 5f6e 616d            fn_nam
-00023d00: 653d 2272 6576 6572 7457 6974 684d 6573  e="revertWithMes
-00023d10: 7361 6765 222c 0a20 2020 2020 2020 2020  sage",.         
-00023d20: 2020 2074 7261 6e73 6163 7469 6f6e 3d7b     transaction={
-00023d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023d40: 2022 6672 6f6d 223a 2075 6e6c 6f63 6b65   "from": unlocke
-00023d50: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
-00023d60: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
-00023d70: 2072 6576 6572 745f 636f 6e74 7261 6374   revert_contract
-00023d80: 2e61 6464 7265 7373 2c0a 2020 2020 2020  .address,.      
-00023d90: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-00023da0: 2029 0a20 2020 2020 2020 2064 6174 6120   ).        data 
-00023db0: 3d20 2230 7830 3863 3337 3961 3030 3030  = "0x08c379a0000
+0001b920: 2277 616c 6c65 7422 3a20 2230 7862 4262  "wallet": "0xbBb
+0001b930: 4242 4242 6262 4242 4262 6262 4262 6242  BBBBbbBBBbbbBbbB
+0001b940: 6262 6262 4242 6242 6262 6262 4262 4262  bbbbBBbBbbbbBbBb
+0001b950: 6242 4262 4222 0a20 2020 2020 2020 2020  bBBbB".         
+0001b960: 2020 2020 2020 2020 2020 207d 5d2c 0a20             }],. 
+0001b970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b980: 2020 2022 636f 6e74 656e 7473 223a 2022     "contents": "
+0001b990: 4865 6c6c 6f2c 2042 6f62 2122 0a20 2020  Hello, Bob!".   
+0001b9a0: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+0001b9b0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+0001b9c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001b9d0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+0001b9e0: 7365 7328 0a20 2020 2020 2020 2020 2020  ses(.           
+0001b9f0: 2056 616c 7565 4572 726f 722c 0a20 2020   ValueError,.   
+0001ba00: 2020 2020 2020 2020 206d 6174 6368 3d72           match=r
+0001ba10: 222e 2a45 7870 6563 7465 6420 3220 6974  ".*Expected 2 it
+0001ba20: 656d 7320 666f 7220 6172 7261 7920 7479  ems for array ty
+0001ba30: 7065 2050 6572 736f 6e5c 5b32 5c5d 2c20  pe Person\[2\], 
+0001ba40: 676f 7420 3120 6974 656d 732e 2a22 2c0a  got 1 items.*",.
+0001ba50: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+0001ba60: 2020 2020 2020 2077 332e 6574 682e 7369         w3.eth.si
+0001ba70: 676e 5f74 7970 6564 5f64 6174 6128 0a20  gn_typed_data(. 
+0001ba80: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+0001ba90: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+0001baa0: 6475 616c 5f74 7970 652c 206a 736f 6e2e  dual_type, json.
+0001bab0: 6c6f 6164 7328 696e 7661 6c69 645f 7479  loads(invalid_ty
+0001bac0: 7065 645f 6d65 7373 6167 6529 0a20 2020  ped_message).   
+0001bad0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0001bae0: 6465 6620 7465 7374 5f65 7468 5f73 6967  def test_eth_sig
+0001baf0: 6e5f 7472 616e 7361 6374 696f 6e5f 6c65  n_transaction_le
+0001bb00: 6761 6379 280a 2020 2020 2020 2020 7365  gacy(.        se
+0001bb10: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+0001bb20: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+0001bb30: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+0001bb40: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
+0001bb50: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
+0001bb60: 616d 733a 2054 7850 6172 616d 7320 3d20  ams: TxParams = 
+0001bb70: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
+0001bb80: 726f 6d22 3a20 756e 6c6f 636b 6564 5f61  rom": unlocked_a
+0001bb90: 6363 6f75 6e74 2c0a 2020 2020 2020 2020  ccount,.        
+0001bba0: 2020 2020 2274 6f22 3a20 756e 6c6f 636b      "to": unlock
+0001bbb0: 6564 5f61 6363 6f75 6e74 2c0a 2020 2020  ed_account,.    
+0001bbc0: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
+0001bbd0: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
+0001bbe0: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
+0001bbf0: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
+0001bc00: 6761 7350 7269 6365 223a 2077 332e 6574  gasPrice": w3.et
+0001bc10: 682e 6761 735f 7072 6963 652c 0a20 2020  h.gas_price,.   
+0001bc20: 2020 2020 2020 2020 2022 6e6f 6e63 6522           "nonce"
+0001bc30: 3a20 4e6f 6e63 6528 3029 2c0a 2020 2020  : Nonce(0),.    
+0001bc40: 2020 2020 7d0a 2020 2020 2020 2020 7265      }.        re
+0001bc50: 7375 6c74 203d 2077 332e 6574 682e 7369  sult = w3.eth.si
+0001bc60: 676e 5f74 7261 6e73 6163 7469 6f6e 2874  gn_transaction(t
+0001bc70: 786e 5f70 6172 616d 7329 0a20 2020 2020  xn_params).     
+0001bc80: 2020 2073 6967 6e61 746f 7279 5f61 6363     signatory_acc
+0001bc90: 6f75 6e74 203d 2077 332e 6574 682e 6163  ount = w3.eth.ac
+0001bca0: 636f 756e 742e 7265 636f 7665 725f 7472  count.recover_tr
+0001bcb0: 616e 7361 6374 696f 6e28 7265 7375 6c74  ansaction(result
+0001bcc0: 5b22 7261 7722 5d29 0a20 2020 2020 2020  ["raw"]).       
+0001bcd0: 2061 7373 6572 7420 756e 6c6f 636b 6564   assert unlocked
+0001bce0: 5f61 6363 6f75 6e74 203d 3d20 7369 676e  _account == sign
+0001bcf0: 6174 6f72 795f 6163 636f 756e 740a 2020  atory_account.  
+0001bd00: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
+0001bd10: 756c 745b 2274 7822 5d5b 2274 6f22 5d20  ult["tx"]["to"] 
+0001bd20: 3d3d 2074 786e 5f70 6172 616d 735b 2274  == txn_params["t
+0001bd30: 6f22 5d0a 2020 2020 2020 2020 6173 7365  o"].        asse
+0001bd40: 7274 2072 6573 756c 745b 2274 7822 5d5b  rt result["tx"][
+0001bd50: 2276 616c 7565 225d 203d 3d20 7478 6e5f  "value"] == txn_
+0001bd60: 7061 7261 6d73 5b22 7661 6c75 6522 5d0a  params["value"].
+0001bd70: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+0001bd80: 6573 756c 745b 2274 7822 5d5b 2267 6173  esult["tx"]["gas
+0001bd90: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
+0001bda0: 5b22 6761 7322 5d0a 2020 2020 2020 2020  ["gas"].        
+0001bdb0: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
+0001bdc0: 7822 5d5b 2267 6173 5072 6963 6522 5d20  x"]["gasPrice"] 
+0001bdd0: 3d3d 2074 786e 5f70 6172 616d 735b 2267  == txn_params["g
+0001bde0: 6173 5072 6963 6522 5d0a 2020 2020 2020  asPrice"].      
+0001bdf0: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
+0001be00: 2274 7822 5d5b 226e 6f6e 6365 225d 203d  "tx"]["nonce"] =
+0001be10: 3d20 7478 6e5f 7061 7261 6d73 5b22 6e6f  = txn_params["no
+0001be20: 6e63 6522 5d0a 0a20 2020 2064 6566 2074  nce"]..    def t
+0001be30: 6573 745f 6574 685f 7369 676e 5f74 7261  est_eth_sign_tra
+0001be40: 6e73 6163 7469 6f6e 280a 2020 2020 2020  nsaction(.      
+0001be50: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+0001be60: 3322 2c20 756e 6c6f 636b 6564 5f61 6363  3", unlocked_acc
+0001be70: 6f75 6e74 3a20 4368 6563 6b73 756d 4164  ount: ChecksumAd
+0001be80: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
+0001be90: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
+0001bea0: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+0001beb0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+0001bec0: 2020 2266 726f 6d22 3a20 756e 6c6f 636b    "from": unlock
+0001bed0: 6564 5f61 6363 6f75 6e74 2c0a 2020 2020  ed_account,.    
+0001bee0: 2020 2020 2020 2020 2274 6f22 3a20 756e          "to": un
+0001bef0: 6c6f 636b 6564 5f61 6363 6f75 6e74 2c0a  locked_account,.
+0001bf00: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+0001bf10: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
+0001bf20: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
+0001bf30: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
+0001bf40: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
+0001bf50: 223a 2077 332e 746f 5f77 6569 2832 2c20  ": w3.to_wei(2, 
+0001bf60: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
+0001bf70: 2020 2020 2022 6d61 7850 7269 6f72 6974       "maxPriorit
+0001bf80: 7946 6565 5065 7247 6173 223a 2077 332e  yFeePerGas": w3.
+0001bf90: 746f 5f77 6569 2831 2c20 2267 7765 6922  to_wei(1, "gwei"
+0001bfa0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+0001bfb0: 6e6f 6e63 6522 3a20 4e6f 6e63 6528 3029  nonce": Nonce(0)
+0001bfc0: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+0001bfd0: 2020 2020 7265 7375 6c74 203d 2077 332e      result = w3.
+0001bfe0: 6574 682e 7369 676e 5f74 7261 6e73 6163  eth.sign_transac
+0001bff0: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+0001c000: 0a20 2020 2020 2020 2073 6967 6e61 746f  .        signato
+0001c010: 7279 5f61 6363 6f75 6e74 203d 2077 332e  ry_account = w3.
+0001c020: 6574 682e 6163 636f 756e 742e 7265 636f  eth.account.reco
+0001c030: 7665 725f 7472 616e 7361 6374 696f 6e28  ver_transaction(
+0001c040: 7265 7375 6c74 5b22 7261 7722 5d29 0a20  result["raw"]). 
+0001c050: 2020 2020 2020 2061 7373 6572 7420 756e         assert un
+0001c060: 6c6f 636b 6564 5f61 6363 6f75 6e74 203d  locked_account =
+0001c070: 3d20 7369 676e 6174 6f72 795f 6163 636f  = signatory_acco
+0001c080: 756e 740a 2020 2020 2020 2020 6173 7365  unt.        asse
+0001c090: 7274 2072 6573 756c 745b 2274 7822 5d5b  rt result["tx"][
+0001c0a0: 2274 6f22 5d20 3d3d 2074 786e 5f70 6172  "to"] == txn_par
+0001c0b0: 616d 735b 2274 6f22 5d0a 2020 2020 2020  ams["to"].      
+0001c0c0: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
+0001c0d0: 2274 7822 5d5b 2276 616c 7565 225d 203d  "tx"]["value"] =
+0001c0e0: 3d20 7478 6e5f 7061 7261 6d73 5b22 7661  = txn_params["va
+0001c0f0: 6c75 6522 5d0a 2020 2020 2020 2020 6173  lue"].        as
+0001c100: 7365 7274 2072 6573 756c 745b 2274 7822  sert result["tx"
+0001c110: 5d5b 2267 6173 225d 203d 3d20 7478 6e5f  ]["gas"] == txn_
+0001c120: 7061 7261 6d73 5b22 6761 7322 5d0a 2020  params["gas"].  
+0001c130: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
+0001c140: 756c 745b 2274 7822 5d5b 226d 6178 4665  ult["tx"]["maxFe
+0001c150: 6550 6572 4761 7322 5d20 3d3d 2074 786e  ePerGas"] == txn
+0001c160: 5f70 6172 616d 735b 226d 6178 4665 6550  _params["maxFeeP
+0001c170: 6572 4761 7322 5d0a 2020 2020 2020 2020  erGas"].        
+0001c180: 6173 7365 7274 2028 0a20 2020 2020 2020  assert (.       
+0001c190: 2020 2020 2072 6573 756c 745b 2274 7822       result["tx"
+0001c1a0: 5d5b 226d 6178 5072 696f 7269 7479 4665  ]["maxPriorityFe
+0001c1b0: 6550 6572 4761 7322 5d20 3d3d 2074 786e  ePerGas"] == txn
+0001c1c0: 5f70 6172 616d 735b 226d 6178 5072 696f  _params["maxPrio
+0001c1d0: 7269 7479 4665 6550 6572 4761 7322 5d0a  rityFeePerGas"].
+0001c1e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001c1f0: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
+0001c200: 2274 7822 5d5b 226e 6f6e 6365 225d 203d  "tx"]["nonce"] =
+0001c210: 3d20 7478 6e5f 7061 7261 6d73 5b22 6e6f  = txn_params["no
+0001c220: 6e63 6522 5d0a 0a20 2020 2064 6566 2074  nce"]..    def t
+0001c230: 6573 745f 6574 685f 7369 676e 5f74 7261  est_eth_sign_tra
+0001c240: 6e73 6163 7469 6f6e 5f68 6578 5f66 6565  nsaction_hex_fee
+0001c250: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+0001c260: 2077 333a 2022 5765 6233 222c 2075 6e6c   w3: "Web3", unl
+0001c270: 6f63 6b65 645f 6163 636f 756e 743a 2043  ocked_account: C
+0001c280: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
+0001c290: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+0001c2a0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+0001c2b0: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
+0001c2c0: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+0001c2d0: 223a 2075 6e6c 6f63 6b65 645f 6163 636f  ": unlocked_acco
+0001c2e0: 756e 742c 0a20 2020 2020 2020 2020 2020  unt,.           
+0001c2f0: 2022 746f 223a 2075 6e6c 6f63 6b65 645f   "to": unlocked_
+0001c300: 6163 636f 756e 742c 0a20 2020 2020 2020  account,.       
+0001c310: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+0001c320: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+0001c330: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
+0001c340: 2020 2020 2020 2020 2020 2020 226d 6178              "max
+0001c350: 4665 6550 6572 4761 7322 3a20 6865 7828  FeePerGas": hex(
+0001c360: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
+0001c370: 6569 2229 292c 0a20 2020 2020 2020 2020  ei")),.         
+0001c380: 2020 2022 6d61 7850 7269 6f72 6974 7946     "maxPriorityF
+0001c390: 6565 5065 7247 6173 223a 2068 6578 2877  eePerGas": hex(w
+0001c3a0: 332e 746f 5f77 6569 2831 2c20 2267 7765  3.to_wei(1, "gwe
+0001c3b0: 6922 2929 2c0a 2020 2020 2020 2020 2020  i")),.          
+0001c3c0: 2020 226e 6f6e 6365 223a 204e 6f6e 6365    "nonce": Nonce
+0001c3d0: 2830 292c 0a20 2020 2020 2020 207d 0a20  (0),.        }. 
+0001c3e0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0001c3f0: 7733 2e65 7468 2e73 6967 6e5f 7472 616e  w3.eth.sign_tran
+0001c400: 7361 6374 696f 6e28 7478 6e5f 7061 7261  saction(txn_para
+0001c410: 6d73 290a 2020 2020 2020 2020 7369 676e  ms).        sign
+0001c420: 6174 6f72 795f 6163 636f 756e 7420 3d20  atory_account = 
+0001c430: 7733 2e65 7468 2e61 6363 6f75 6e74 2e72  w3.eth.account.r
+0001c440: 6563 6f76 6572 5f74 7261 6e73 6163 7469  ecover_transacti
+0001c450: 6f6e 2872 6573 756c 745b 2272 6177 225d  on(result["raw"]
+0001c460: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0001c470: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
+0001c480: 7420 3d3d 2073 6967 6e61 746f 7279 5f61  t == signatory_a
+0001c490: 6363 6f75 6e74 0a20 2020 2020 2020 2061  ccount.        a
+0001c4a0: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
+0001c4b0: 225d 5b22 746f 225d 203d 3d20 7478 6e5f  "]["to"] == txn_
+0001c4c0: 7061 7261 6d73 5b22 746f 225d 0a20 2020  params["to"].   
+0001c4d0: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
+0001c4e0: 6c74 5b22 7478 225d 5b22 7661 6c75 6522  lt["tx"]["value"
+0001c4f0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
+0001c500: 2276 616c 7565 225d 0a20 2020 2020 2020  "value"].       
+0001c510: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
+0001c520: 7478 225d 5b22 6761 7322 5d20 3d3d 2074  tx"]["gas"] == t
+0001c530: 786e 5f70 6172 616d 735b 2267 6173 225d  xn_params["gas"]
+0001c540: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001c550: 7265 7375 6c74 5b22 7478 225d 5b22 6d61  result["tx"]["ma
+0001c560: 7846 6565 5065 7247 6173 225d 203d 3d20  xFeePerGas"] == 
+0001c570: 696e 7428 7374 7228 7478 6e5f 7061 7261  int(str(txn_para
+0001c580: 6d73 5b22 6d61 7846 6565 5065 7247 6173  ms["maxFeePerGas
+0001c590: 225d 292c 2031 3629 0a20 2020 2020 2020  "]), 16).       
+0001c5a0: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
+0001c5b0: 7478 225d 5b22 6d61 7850 7269 6f72 6974  tx"]["maxPriorit
+0001c5c0: 7946 6565 5065 7247 6173 225d 203d 3d20  yFeePerGas"] == 
+0001c5d0: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
+0001c5e0: 2073 7472 2874 786e 5f70 6172 616d 735b   str(txn_params[
+0001c5f0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+0001c600: 6572 4761 7322 5d29 2c20 3136 0a20 2020  erGas"]), 16.   
+0001c610: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
+0001c620: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
+0001c630: 225d 5b22 6e6f 6e63 6522 5d20 3d3d 2074  "]["nonce"] == t
+0001c640: 786e 5f70 6172 616d 735b 226e 6f6e 6365  xn_params["nonce
+0001c650: 225d 0a0a 2020 2020 6465 6620 7465 7374  "]..    def test
+0001c660: 5f65 7468 5f73 6967 6e5f 7472 616e 7361  _eth_sign_transa
+0001c670: 6374 696f 6e5f 656e 735f 6e61 6d65 7328  ction_ens_names(
+0001c680: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+0001c690: 333a 2022 5765 6233 222c 2075 6e6c 6f63  3: "Web3", unloc
+0001c6a0: 6b65 645f 6163 636f 756e 743a 2043 6865  ked_account: Che
+0001c6b0: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
+0001c6c0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+0001c6d0: 2020 2020 7769 7468 2065 6e73 5f61 6464      with ens_add
+0001c6e0: 7265 7373 6573 2877 332c 207b 2275 6e6c  resses(w3, {"unl
+0001c6f0: 6f63 6b65 642d 6163 636f 756e 742e 6574  ocked-account.et
+0001c700: 6822 3a20 756e 6c6f 636b 6564 5f61 6363  h": unlocked_acc
+0001c710: 6f75 6e74 7d29 3a0a 2020 2020 2020 2020  ount}):.        
+0001c720: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
+0001c730: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
+0001c740: 2020 2020 2020 2020 2020 2020 2022 6672               "fr
+0001c750: 6f6d 223a 2022 756e 6c6f 636b 6564 2d61  om": "unlocked-a
+0001c760: 6363 6f75 6e74 2e65 7468 222c 0a20 2020  ccount.eth",.   
+0001c770: 2020 2020 2020 2020 2020 2020 2022 746f               "to
+0001c780: 223a 2022 756e 6c6f 636b 6564 2d61 6363  ": "unlocked-acc
+0001c790: 6f75 6e74 2e65 7468 222c 0a20 2020 2020  ount.eth",.     
+0001c7a0: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+0001c7b0: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+0001c7c0: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+0001c7d0: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
+0001c7e0: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
+0001c7f0: 6550 6572 4761 7322 3a20 7733 2e74 6f5f  ePerGas": w3.to_
+0001c800: 7765 6928 322c 2022 6777 6569 2229 2c0a  wei(2, "gwei"),.
+0001c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c820: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+0001c830: 6572 4761 7322 3a20 7733 2e74 6f5f 7765  erGas": w3.to_we
+0001c840: 6928 312c 2022 6777 6569 2229 2c0a 2020  i(1, "gwei"),.  
+0001c850: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+0001c860: 6f6e 6365 223a 204e 6f6e 6365 2830 292c  once": Nonce(0),
+0001c870: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
+0001c880: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+0001c890: 7420 3d20 7733 2e65 7468 2e73 6967 6e5f  t = w3.eth.sign_
+0001c8a0: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
+0001c8b0: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+0001c8c0: 2020 2020 7369 676e 6174 6f72 795f 6163      signatory_ac
+0001c8d0: 636f 756e 7420 3d20 7733 2e65 7468 2e61  count = w3.eth.a
+0001c8e0: 6363 6f75 6e74 2e72 6563 6f76 6572 5f74  ccount.recover_t
+0001c8f0: 7261 6e73 6163 7469 6f6e 2872 6573 756c  ransaction(resul
+0001c900: 745b 2272 6177 225d 290a 2020 2020 2020  t["raw"]).      
+0001c910: 2020 2020 2020 6173 7365 7274 2075 6e6c        assert unl
+0001c920: 6f63 6b65 645f 6163 636f 756e 7420 3d3d  ocked_account ==
+0001c930: 2073 6967 6e61 746f 7279 5f61 6363 6f75   signatory_accou
+0001c940: 6e74 0a20 2020 2020 2020 2020 2020 2061  nt.            a
+0001c950: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
+0001c960: 225d 5b22 746f 225d 203d 3d20 756e 6c6f  "]["to"] == unlo
+0001c970: 636b 6564 5f61 6363 6f75 6e74 0a20 2020  cked_account.   
+0001c980: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0001c990: 7265 7375 6c74 5b22 7478 225d 5b22 7661  result["tx"]["va
+0001c9a0: 6c75 6522 5d20 3d3d 2074 786e 5f70 6172  lue"] == txn_par
+0001c9b0: 616d 735b 2276 616c 7565 225d 0a20 2020  ams["value"].   
+0001c9c0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0001c9d0: 7265 7375 6c74 5b22 7478 225d 5b22 6761  result["tx"]["ga
+0001c9e0: 7322 5d20 3d3d 2074 786e 5f70 6172 616d  s"] == txn_param
+0001c9f0: 735b 2267 6173 225d 0a20 2020 2020 2020  s["gas"].       
+0001ca00: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
+0001ca10: 6c74 5b22 7478 225d 5b22 6d61 7846 6565  lt["tx"]["maxFee
+0001ca20: 5065 7247 6173 225d 203d 3d20 7478 6e5f  PerGas"] == txn_
+0001ca30: 7061 7261 6d73 5b22 6d61 7846 6565 5065  params["maxFeePe
+0001ca40: 7247 6173 225d 0a20 2020 2020 2020 2020  rGas"].         
+0001ca50: 2020 2061 7373 6572 7420 280a 2020 2020     assert (.    
+0001ca60: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+0001ca70: 6c74 5b22 7478 225d 5b22 6d61 7850 7269  lt["tx"]["maxPri
+0001ca80: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
+0001ca90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001caa0: 203d 3d20 7478 6e5f 7061 7261 6d73 5b22   == txn_params["
+0001cab0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
+0001cac0: 7247 6173 225d 0a20 2020 2020 2020 2020  rGas"].         
+0001cad0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001cae0: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
+0001caf0: 7478 225d 5b22 6e6f 6e63 6522 5d20 3d3d  tx"]["nonce"] ==
+0001cb00: 2074 786e 5f70 6172 616d 735b 226e 6f6e   txn_params["non
+0001cb10: 6365 225d 0a0a 2020 2020 6465 6620 7465  ce"]..    def te
+0001cb20: 7374 5f65 7468 5f73 656e 645f 7472 616e  st_eth_send_tran
+0001cb30: 7361 6374 696f 6e5f 6164 6472 5f63 6865  saction_addr_che
+0001cb40: 636b 7375 6d5f 7265 7175 6972 6564 280a  cksum_required(.
+0001cb50: 2020 2020 2020 2020 7365 6c66 2c20 7733          self, w3
+0001cb60: 3a20 2257 6562 3322 2c20 756e 6c6f 636b  : "Web3", unlock
+0001cb70: 6564 5f61 6363 6f75 6e74 3a20 4368 6563  ed_account: Chec
+0001cb80: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
+0001cb90: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0001cba0: 2020 206e 6f6e 5f63 6865 636b 7375 6d5f     non_checksum_
+0001cbb0: 6164 6472 203d 2075 6e6c 6f63 6b65 645f  addr = unlocked_
+0001cbc0: 6163 636f 756e 742e 6c6f 7765 7228 290a  account.lower().
+0001cbd0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+0001cbe0: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+0001cbf0: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+0001cc00: 6f6d 223a 2075 6e6c 6f63 6b65 645f 6163  om": unlocked_ac
+0001cc10: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
+0001cc20: 2020 2022 746f 223a 2075 6e6c 6f63 6b65     "to": unlocke
+0001cc30: 645f 6163 636f 756e 742c 0a20 2020 2020  d_account,.     
+0001cc40: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
+0001cc50: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
+0001cc60: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
+0001cc70: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+0001cc80: 6178 4665 6550 6572 4761 7322 3a20 7733  axFeePerGas": w3
+0001cc90: 2e74 6f5f 7765 6928 322c 2022 6777 6569  .to_wei(2, "gwei
+0001cca0: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+0001ccb0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+0001ccc0: 6572 4761 7322 3a20 7733 2e74 6f5f 7765  erGas": w3.to_we
+0001ccd0: 6928 312c 2022 6777 6569 2229 2c0a 2020  i(1, "gwei"),.  
+0001cce0: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
+0001ccf0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+0001cd00: 7365 7328 496e 7661 6c69 6441 6464 7265  ses(InvalidAddre
+0001cd10: 7373 293a 0a20 2020 2020 2020 2020 2020  ss):.           
+0001cd20: 2069 6e76 616c 6964 5f70 6172 616d 7320   invalid_params 
+0001cd30: 3d20 6361 7374 280a 2020 2020 2020 2020  = cast(.        
+0001cd40: 2020 2020 2020 2020 5478 5061 7261 6d73          TxParams
+0001cd50: 2c20 6469 6374 2874 786e 5f70 6172 616d  , dict(txn_param
+0001cd60: 732c 202a 2a7b 2266 726f 6d22 3a20 6e6f  s, **{"from": no
+0001cd70: 6e5f 6368 6563 6b73 756d 5f61 6464 727d  n_checksum_addr}
+0001cd80: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+0001cd90: 2020 2020 2020 2020 2020 2020 7733 2e65              w3.e
+0001cda0: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
+0001cdb0: 696f 6e28 696e 7661 6c69 645f 7061 7261  ion(invalid_para
+0001cdc0: 6d73 290a 0a20 2020 2020 2020 2077 6974  ms)..        wit
+0001cdd0: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+0001cde0: 496e 7661 6c69 6441 6464 7265 7373 293a  InvalidAddress):
+0001cdf0: 0a20 2020 2020 2020 2020 2020 2069 6e76  .            inv
+0001ce00: 616c 6964 5f70 6172 616d 7320 3d20 6361  alid_params = ca
+0001ce10: 7374 280a 2020 2020 2020 2020 2020 2020  st(.            
+0001ce20: 2020 2020 5478 5061 7261 6d73 2c20 6469      TxParams, di
+0001ce30: 6374 2874 786e 5f70 6172 616d 732c 202a  ct(txn_params, *
+0001ce40: 2a7b 2274 6f22 3a20 6e6f 6e5f 6368 6563  *{"to": non_chec
+0001ce50: 6b73 756d 5f61 6464 727d 290a 2020 2020  ksum_addr}).    
+0001ce60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001ce70: 2020 2020 2020 7733 2e65 7468 2e73 656e        w3.eth.sen
+0001ce80: 645f 7472 616e 7361 6374 696f 6e28 696e  d_transaction(in
+0001ce90: 7661 6c69 645f 7061 7261 6d73 290a 0a20  valid_params).. 
+0001cea0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+0001ceb0: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+0001cec0: 5f6c 6567 6163 7928 0a20 2020 2020 2020  _legacy(.       
+0001ced0: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
+0001cee0: 222c 2075 6e6c 6f63 6b65 645f 6163 636f  ", unlocked_acco
+0001cef0: 756e 745f 6475 616c 5f74 7970 653a 2043  unt_dual_type: C
+0001cf00: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
+0001cf10: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+0001cf20: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+0001cf30: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
+0001cf40: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+0001cf50: 223a 2075 6e6c 6f63 6b65 645f 6163 636f  ": unlocked_acco
+0001cf60: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
+0001cf70: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
+0001cf80: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
+0001cf90: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
+0001cfa0: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+0001cfb0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+0001cfc0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+0001cfd0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+0001cfe0: 2267 6173 5072 6963 6522 3a20 7733 2e74  "gasPrice": w3.t
+0001cff0: 6f5f 7765 6928 0a20 2020 2020 2020 2020  o_wei(.         
+0001d000: 2020 2020 2020 2031 2c20 2267 7765 6922         1, "gwei"
+0001d010: 0a20 2020 2020 2020 2020 2020 2029 2c20  .            ), 
+0001d020: 2023 2070 6f73 742d 6c6f 6e64 6f6e 206e   # post-london n
+0001d030: 6565 6473 2074 6f20 6265 206d 6f72 6520  eeds to be more 
+0001d040: 7468 616e 2074 6865 2062 6173 6520 6665  than the base fe
+0001d050: 650a 2020 2020 2020 2020 7d0a 2020 2020  e.        }.    
+0001d060: 2020 2020 7478 6e5f 6861 7368 203d 2077      txn_hash = w
+0001d070: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+0001d080: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
+0001d090: 7329 0a20 2020 2020 2020 2074 786e 203d  s).        txn =
+0001d0a0: 2077 332e 6574 682e 6765 745f 7472 616e   w3.eth.get_tran
+0001d0b0: 7361 6374 696f 6e28 7478 6e5f 6861 7368  saction(txn_hash
+0001d0c0: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+0001d0d0: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
+0001d0e0: 7328 7478 6e5b 2266 726f 6d22 5d2c 2063  s(txn["from"], c
+0001d0f0: 6173 7428 4368 6563 6b73 756d 4164 6472  ast(ChecksumAddr
+0001d100: 6573 732c 2074 786e 5f70 6172 616d 735b  ess, txn_params[
+0001d110: 2266 726f 6d22 5d29 290a 2020 2020 2020  "from"])).      
+0001d120: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+0001d130: 5f61 6464 7265 7373 2874 786e 5b22 746f  _address(txn["to
+0001d140: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
+0001d150: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
+0001d160: 7261 6d73 5b22 746f 225d 2929 0a20 2020  rams["to"])).   
+0001d170: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
+0001d180: 2276 616c 7565 225d 203d 3d20 310a 2020  "value"] == 1.  
+0001d190: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
+0001d1a0: 5b22 6761 7322 5d20 3d3d 2032 3130 3030  ["gas"] == 21000
+0001d1b0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001d1c0: 7478 6e5b 2267 6173 5072 6963 6522 5d20  txn["gasPrice"] 
+0001d1d0: 3d3d 2074 786e 5f70 6172 616d 735b 2267  == txn_params["g
+0001d1e0: 6173 5072 6963 6522 5d0a 0a20 2020 2064  asPrice"]..    d
+0001d1f0: 6566 2074 6573 745f 6574 685f 7365 6e64  ef test_eth_send
+0001d200: 5f74 7261 6e73 6163 7469 6f6e 280a 2020  _transaction(.  
+0001d210: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+0001d220: 2257 6562 3322 2c20 756e 6c6f 636b 6564  "Web3", unlocked
+0001d230: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+0001d240: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
+0001d250: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
+0001d260: 653a 0a20 2020 2020 2020 2074 786e 5f70  e:.        txn_p
+0001d270: 6172 616d 733a 2054 7850 6172 616d 7320  arams: TxParams 
+0001d280: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0001d290: 2266 726f 6d22 3a20 756e 6c6f 636b 6564  "from": unlocked
+0001d2a0: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+0001d2b0: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+0001d2c0: 2274 6f22 3a20 756e 6c6f 636b 6564 5f61  "to": unlocked_a
+0001d2d0: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
+0001d2e0: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
+0001d2f0: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
+0001d300: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
+0001d310: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
+0001d320: 2020 2020 2022 6d61 7846 6565 5065 7247       "maxFeePerG
+0001d330: 6173 223a 2077 332e 746f 5f77 6569 2833  as": w3.to_wei(3
+0001d340: 2c20 2267 7765 6922 292c 0a20 2020 2020  , "gwei"),.     
+0001d350: 2020 2020 2020 2022 6d61 7850 7269 6f72         "maxPrior
+0001d360: 6974 7946 6565 5065 7247 6173 223a 2077  ityFeePerGas": w
+0001d370: 332e 746f 5f77 6569 2831 2c20 2267 7765  3.to_wei(1, "gwe
+0001d380: 6922 292c 0a20 2020 2020 2020 207d 0a20  i"),.        }. 
+0001d390: 2020 2020 2020 2074 786e 5f68 6173 6820         txn_hash 
+0001d3a0: 3d20 7733 2e65 7468 2e73 656e 645f 7472  = w3.eth.send_tr
+0001d3b0: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
+0001d3c0: 7261 6d73 290a 2020 2020 2020 2020 7478  rams).        tx
+0001d3d0: 6e20 3d20 7733 2e65 7468 2e67 6574 5f74  n = w3.eth.get_t
+0001d3e0: 7261 6e73 6163 7469 6f6e 2874 786e 5f68  ransaction(txn_h
+0001d3f0: 6173 6829 0a0a 2020 2020 2020 2020 6173  ash)..        as
+0001d400: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
+0001d410: 7265 7373 2874 786e 5b22 6672 6f6d 225d  ress(txn["from"]
+0001d420: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
+0001d430: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
+0001d440: 6d73 5b22 6672 6f6d 225d 2929 0a20 2020  ms["from"])).   
+0001d450: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
+0001d460: 616d 655f 6164 6472 6573 7328 7478 6e5b  ame_address(txn[
+0001d470: 2274 6f22 5d2c 2063 6173 7428 4368 6563  "to"], cast(Chec
+0001d480: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
+0001d490: 5f70 6172 616d 735b 2274 6f22 5d29 290a  _params["to"])).
+0001d4a0: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+0001d4b0: 786e 5b22 7661 6c75 6522 5d20 3d3d 2031  xn["value"] == 1
+0001d4c0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001d4d0: 7478 6e5b 2267 6173 225d 203d 3d20 3231  txn["gas"] == 21
+0001d4e0: 3030 300a 2020 2020 2020 2020 6173 7365  000.        asse
+0001d4f0: 7274 2074 786e 5b22 6d61 7846 6565 5065  rt txn["maxFeePe
+0001d500: 7247 6173 225d 203d 3d20 7478 6e5f 7061  rGas"] == txn_pa
+0001d510: 7261 6d73 5b22 6d61 7846 6565 5065 7247  rams["maxFeePerG
+0001d520: 6173 225d 0a20 2020 2020 2020 2061 7373  as"].        ass
+0001d530: 6572 7420 7478 6e5b 226d 6178 5072 696f  ert txn["maxPrio
+0001d540: 7269 7479 4665 6550 6572 4761 7322 5d20  rityFeePerGas"] 
+0001d550: 3d3d 2074 786e 5f70 6172 616d 735b 226d  == txn_params["m
+0001d560: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
+0001d570: 4761 7322 5d0a 2020 2020 2020 2020 6173  Gas"].        as
+0001d580: 7365 7274 2074 786e 5b22 6761 7350 7269  sert txn["gasPri
+0001d590: 6365 225d 203d 3d20 7478 6e5f 7061 7261  ce"] == txn_para
+0001d5a0: 6d73 5b22 6d61 7846 6565 5065 7247 6173  ms["maxFeePerGas
+0001d5b0: 225d 0a0a 2020 2020 6465 6620 7465 7374  "]..    def test
+0001d5c0: 5f65 7468 5f73 656e 645f 7472 616e 7361  _eth_send_transa
+0001d5d0: 6374 696f 6e5f 7769 7468 5f6e 6f6e 6365  ction_with_nonce
+0001d5e0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+0001d5f0: 7733 3a20 2257 6562 3322 2c20 756e 6c6f  w3: "Web3", unlo
+0001d600: 636b 6564 5f61 6363 6f75 6e74 3a20 4368  cked_account: Ch
+0001d610: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
+0001d620: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+0001d630: 2020 2020 206d 6178 5f70 7269 6f72 6974       max_priorit
+0001d640: 795f 6665 655f 7065 725f 6761 7320 3d20  y_fee_per_gas = 
+0001d650: 7733 2e74 6f5f 7765 6928 312e 3233 342c  w3.to_wei(1.234,
+0001d660: 2022 6777 6569 2229 0a20 2020 2020 2020   "gwei").       
+0001d670: 206d 6178 5f66 6565 5f70 6572 5f67 6173   max_fee_per_gas
+0001d680: 203d 2057 6569 280a 2020 2020 2020 2020   = Wei(.        
+0001d690: 2020 2020 7733 2e65 7468 2e67 6574 5f62      w3.eth.get_b
+0001d6a0: 6c6f 636b 2822 6c61 7465 7374 2229 5b22  lock("latest")["
+0001d6b0: 6261 7365 4665 6550 6572 4761 7322 5d20  baseFeePerGas"] 
+0001d6c0: 2b20 6d61 785f 7072 696f 7269 7479 5f66  + max_priority_f
+0001d6d0: 6565 5f70 6572 5f67 6173 0a20 2020 2020  ee_per_gas.     
+0001d6e0: 2020 2029 0a20 2020 2020 2020 2074 786e     ).        txn
+0001d6f0: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+0001d700: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+0001d710: 2020 2266 726f 6d22 3a20 756e 6c6f 636b    "from": unlock
+0001d720: 6564 5f61 6363 6f75 6e74 2c0a 2020 2020  ed_account,.    
+0001d730: 2020 2020 2020 2020 2274 6f22 3a20 756e          "to": un
+0001d740: 6c6f 636b 6564 5f61 6363 6f75 6e74 2c0a  locked_account,.
+0001d750: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+0001d760: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
+0001d770: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
+0001d780: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
+0001d790: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
+0001d7a0: 223a 206d 6178 5f66 6565 5f70 6572 5f67  ": max_fee_per_g
+0001d7b0: 6173 2c0a 2020 2020 2020 2020 2020 2020  as,.            
+0001d7c0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+0001d7d0: 6572 4761 7322 3a20 6d61 785f 7072 696f  erGas": max_prio
+0001d7e0: 7269 7479 5f66 6565 5f70 6572 5f67 6173  rity_fee_per_gas
+0001d7f0: 2c0a 2020 2020 2020 2020 2020 2020 226e  ,.            "n
+0001d800: 6f6e 6365 223a 204e 6f6e 6365 2877 332e  once": Nonce(w3.
+0001d810: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
+0001d820: 696f 6e5f 636f 756e 7428 756e 6c6f 636b  ion_count(unlock
+0001d830: 6564 5f61 6363 6f75 6e74 2c20 2270 656e  ed_account, "pen
+0001d840: 6469 6e67 2229 292c 0a20 2020 2020 2020  ding")),.       
+0001d850: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
+0001d860: 6173 6820 3d20 7733 2e65 7468 2e73 656e  ash = w3.eth.sen
+0001d870: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
+0001d880: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
+0001d890: 2020 7478 6e20 3d20 7733 2e65 7468 2e67    txn = w3.eth.g
+0001d8a0: 6574 5f74 7261 6e73 6163 7469 6f6e 2874  et_transaction(t
+0001d8b0: 786e 5f68 6173 6829 0a0a 2020 2020 2020  xn_hash)..      
+0001d8c0: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+0001d8d0: 5f61 6464 7265 7373 2874 786e 5b22 6672  _address(txn["fr
+0001d8e0: 6f6d 225d 2c20 6361 7374 2843 6865 636b  om"], cast(Check
+0001d8f0: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
+0001d900: 7061 7261 6d73 5b22 6672 6f6d 225d 2929  params["from"]))
+0001d910: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001d920: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
+0001d930: 7478 6e5b 2274 6f22 5d2c 2063 6173 7428  txn["to"], cast(
+0001d940: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+0001d950: 2074 786e 5f70 6172 616d 735b 2274 6f22   txn_params["to"
+0001d960: 5d29 290a 2020 2020 2020 2020 6173 7365  ])).        asse
+0001d970: 7274 2074 786e 5b22 7661 6c75 6522 5d20  rt txn["value"] 
+0001d980: 3d3d 2031 0a20 2020 2020 2020 2061 7373  == 1.        ass
+0001d990: 6572 7420 7478 6e5b 2267 6173 225d 203d  ert txn["gas"] =
+0001d9a0: 3d20 3231 3030 300a 2020 2020 2020 2020  = 21000.        
+0001d9b0: 6173 7365 7274 2074 786e 5b22 6d61 7846  assert txn["maxF
+0001d9c0: 6565 5065 7247 6173 225d 203d 3d20 7478  eePerGas"] == tx
+0001d9d0: 6e5f 7061 7261 6d73 5b22 6d61 7846 6565  n_params["maxFee
+0001d9e0: 5065 7247 6173 225d 0a20 2020 2020 2020  PerGas"].       
+0001d9f0: 2061 7373 6572 7420 7478 6e5b 226d 6178   assert txn["max
+0001da00: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+0001da10: 7322 5d20 3d3d 2074 786e 5f70 6172 616d  s"] == txn_param
+0001da20: 735b 226d 6178 5072 696f 7269 7479 4665  s["maxPriorityFe
+0001da30: 6550 6572 4761 7322 5d0a 2020 2020 2020  ePerGas"].      
+0001da40: 2020 6173 7365 7274 2074 786e 5b22 6e6f    assert txn["no
+0001da50: 6e63 6522 5d20 3d3d 2074 786e 5f70 6172  nce"] == txn_par
+0001da60: 616d 735b 226e 6f6e 6365 225d 0a20 2020  ams["nonce"].   
+0001da70: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
+0001da80: 6e74 6567 6572 2874 786e 5b22 6761 7350  nteger(txn["gasP
+0001da90: 7269 6365 225d 290a 2020 2020 2020 2020  rice"]).        
+0001daa0: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
+0001dab0: 7228 7478 6e5f 7061 7261 6d73 5b22 6d61  r(txn_params["ma
+0001dac0: 7846 6565 5065 7247 6173 225d 290a 0a20  xFeePerGas"]).. 
+0001dad0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+0001dae0: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+0001daf0: 5f64 6566 6175 6c74 5f66 6565 7328 0a20  _default_fees(. 
+0001db00: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
+0001db10: 2022 5765 6233 222c 2075 6e6c 6f63 6b65   "Web3", unlocke
+0001db20: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
+0001db30: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
+0001db40: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
+0001db50: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
+0001db60: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
+0001db70: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+0001db80: 2022 6672 6f6d 223a 2075 6e6c 6f63 6b65   "from": unlocke
+0001db90: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
+0001dba0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+0001dbb0: 2022 746f 223a 2075 6e6c 6f63 6b65 645f   "to": unlocked_
+0001dbc0: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+0001dbd0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+0001dbe0: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
+0001dbf0: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+0001dc00: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
+0001dc10: 2020 7d0a 2020 2020 2020 2020 7478 6e5f    }.        txn_
+0001dc20: 6861 7368 203d 2077 332e 6574 682e 7365  hash = w3.eth.se
+0001dc30: 6e64 5f74 7261 6e73 6163 7469 6f6e 2874  nd_transaction(t
+0001dc40: 786e 5f70 6172 616d 7329 0a20 2020 2020  xn_params).     
+0001dc50: 2020 2074 786e 203d 2077 332e 6574 682e     txn = w3.eth.
+0001dc60: 6765 745f 7472 616e 7361 6374 696f 6e28  get_transaction(
+0001dc70: 7478 6e5f 6861 7368 290a 0a20 2020 2020  txn_hash)..     
+0001dc80: 2020 2061 7373 6572 7420 6973 5f73 616d     assert is_sam
+0001dc90: 655f 6164 6472 6573 7328 7478 6e5b 2266  e_address(txn["f
+0001dca0: 726f 6d22 5d2c 2063 6173 7428 4368 6563  rom"], cast(Chec
+0001dcb0: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
+0001dcc0: 5f70 6172 616d 735b 2266 726f 6d22 5d29  _params["from"])
+0001dcd0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0001dce0: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
+0001dcf0: 2874 786e 5b22 746f 225d 2c20 6361 7374  (txn["to"], cast
+0001dd00: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
+0001dd10: 2c20 7478 6e5f 7061 7261 6d73 5b22 746f  , txn_params["to
+0001dd20: 225d 2929 0a20 2020 2020 2020 2061 7373  "])).        ass
+0001dd30: 6572 7420 7478 6e5b 2276 616c 7565 225d  ert txn["value"]
+0001dd40: 203d 3d20 310a 2020 2020 2020 2020 6173   == 1.        as
+0001dd50: 7365 7274 2074 786e 5b22 6761 7322 5d20  sert txn["gas"] 
+0001dd60: 3d3d 2032 3130 3030 0a20 2020 2020 2020  == 21000.       
+0001dd70: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
+0001dd80: 6572 2874 786e 5b22 6d61 7850 7269 6f72  er(txn["maxPrior
+0001dd90: 6974 7946 6565 5065 7247 6173 225d 290a  ityFeePerGas"]).
+0001dda0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+0001ddb0: 735f 696e 7465 6765 7228 7478 6e5b 226d  s_integer(txn["m
+0001ddc0: 6178 4665 6550 6572 4761 7322 5d29 0a20  axFeePerGas"]). 
+0001ddd0: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
+0001dde0: 6e5b 2267 6173 5072 6963 6522 5d20 3d3d  n["gasPrice"] ==
+0001ddf0: 2074 786e 5b22 6d61 7846 6565 5065 7247   txn["maxFeePerG
+0001de00: 6173 225d 0a0a 2020 2020 6465 6620 7465  as"]..    def te
+0001de10: 7374 5f65 7468 5f73 656e 645f 7472 616e  st_eth_send_tran
+0001de20: 7361 6374 696f 6e5f 6865 785f 6665 6573  saction_hex_fees
+0001de30: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+0001de40: 7733 3a20 2257 6562 3322 2c20 756e 6c6f  w3: "Web3", unlo
+0001de50: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+0001de60: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
+0001de70: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
+0001de80: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+0001de90: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+0001dea0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+0001deb0: 2020 2020 2266 726f 6d22 3a20 756e 6c6f      "from": unlo
+0001dec0: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+0001ded0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+0001dee0: 2020 2020 2274 6f22 3a20 756e 6c6f 636b      "to": unlock
+0001def0: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
+0001df00: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+0001df10: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
+0001df20: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+0001df30: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
+0001df40: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
+0001df50: 5065 7247 6173 223a 2068 6578 2832 3530  PerGas": hex(250
+0001df60: 202a 2031 302a 2a39 292c 0a20 2020 2020   * 10**9),.     
+0001df70: 2020 2020 2020 2022 6d61 7850 7269 6f72         "maxPrior
+0001df80: 6974 7946 6565 5065 7247 6173 223a 2068  ityFeePerGas": h
+0001df90: 6578 2832 202a 2031 302a 2a39 292c 0a20  ex(2 * 10**9),. 
+0001dfa0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0001dfb0: 2074 786e 5f68 6173 6820 3d20 7733 2e65   txn_hash = w3.e
+0001dfc0: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
+0001dfd0: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
+0001dfe0: 2020 2020 2020 2020 7478 6e20 3d20 7733          txn = w3
+0001dff0: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
+0001e000: 7469 6f6e 2874 786e 5f68 6173 6829 0a0a  tion(txn_hash)..
+0001e010: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+0001e020: 735f 7361 6d65 5f61 6464 7265 7373 2874  s_same_address(t
+0001e030: 786e 5b22 6672 6f6d 225d 2c20 6361 7374  xn["from"], cast
+0001e040: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
+0001e050: 2c20 7478 6e5f 7061 7261 6d73 5b22 6672  , txn_params["fr
+0001e060: 6f6d 225d 2929 0a20 2020 2020 2020 2061  om"])).        a
+0001e070: 7373 6572 7420 6973 5f73 616d 655f 6164  ssert is_same_ad
+0001e080: 6472 6573 7328 7478 6e5b 2274 6f22 5d2c  dress(txn["to"],
+0001e090: 2063 6173 7428 4368 6563 6b73 756d 4164   cast(ChecksumAd
+0001e0a0: 6472 6573 732c 2074 786e 5f70 6172 616d  dress, txn_param
+0001e0b0: 735b 2274 6f22 5d29 290a 2020 2020 2020  s["to"])).      
+0001e0c0: 2020 6173 7365 7274 2074 786e 5b22 7661    assert txn["va
+0001e0d0: 6c75 6522 5d20 3d3d 2031 0a20 2020 2020  lue"] == 1.     
+0001e0e0: 2020 2061 7373 6572 7420 7478 6e5b 2267     assert txn["g
+0001e0f0: 6173 225d 203d 3d20 3231 3030 300a 2020  as"] == 21000.  
+0001e100: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
+0001e110: 5b22 6d61 7846 6565 5065 7247 6173 225d  ["maxFeePerGas"]
+0001e120: 203d 3d20 3235 3020 2a20 3130 2a2a 390a   == 250 * 10**9.
+0001e130: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+0001e140: 786e 5b22 6d61 7850 7269 6f72 6974 7946  xn["maxPriorityF
+0001e150: 6565 5065 7247 6173 225d 203d 3d20 3220  eePerGas"] == 2 
+0001e160: 2a20 3130 2a2a 390a 0a20 2020 2064 6566  * 10**9..    def
+0001e170: 2074 6573 745f 6574 685f 7365 6e64 5f74   test_eth_send_t
+0001e180: 7261 6e73 6163 7469 6f6e 5f6e 6f5f 6761  ransaction_no_ga
+0001e190: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+0001e1a0: 2077 333a 2022 5765 6233 222c 2075 6e6c   w3: "Web3", unl
+0001e1b0: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+0001e1c0: 616c 5f74 7970 653a 2043 6865 636b 7375  al_type: Checksu
+0001e1d0: 6d41 6464 7265 7373 0a20 2020 2029 202d  mAddress.    ) -
+0001e1e0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0001e1f0: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
+0001e200: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+0001e210: 2020 2020 2022 6672 6f6d 223a 2075 6e6c       "from": unl
+0001e220: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+0001e230: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+0001e240: 2020 2020 2022 746f 223a 2075 6e6c 6f63       "to": unloc
+0001e250: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+0001e260: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+0001e270: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
+0001e280: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+0001e290: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
+0001e2a0: 5765 6928 3235 3020 2a20 3130 2a2a 3929  Wei(250 * 10**9)
+0001e2b0: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+0001e2c0: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
+0001e2d0: 4761 7322 3a20 5765 6928 3220 2a20 3130  Gas": Wei(2 * 10
+0001e2e0: 2a2a 3929 2c0a 2020 2020 2020 2020 7d0a  **9),.        }.
+0001e2f0: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+0001e300: 203d 2077 332e 6574 682e 7365 6e64 5f74   = w3.eth.send_t
+0001e310: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+0001e320: 6172 616d 7329 0a20 2020 2020 2020 2074  arams).        t
+0001e330: 786e 203d 2077 332e 6574 682e 6765 745f  xn = w3.eth.get_
+0001e340: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
+0001e350: 6861 7368 290a 0a20 2020 2020 2020 2061  hash)..        a
+0001e360: 7373 6572 7420 6973 5f73 616d 655f 6164  ssert is_same_ad
+0001e370: 6472 6573 7328 7478 6e5b 2266 726f 6d22  dress(txn["from"
+0001e380: 5d2c 2063 6173 7428 4368 6563 6b73 756d  ], cast(Checksum
+0001e390: 4164 6472 6573 732c 2074 786e 5f70 6172  Address, txn_par
+0001e3a0: 616d 735b 2266 726f 6d22 5d29 290a 2020  ams["from"])).  
+0001e3b0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+0001e3c0: 7361 6d65 5f61 6464 7265 7373 2874 786e  same_address(txn
+0001e3d0: 5b22 746f 225d 2c20 6361 7374 2843 6865  ["to"], cast(Che
+0001e3e0: 636b 7375 6d41 6464 7265 7373 2c20 7478  cksumAddress, tx
+0001e3f0: 6e5f 7061 7261 6d73 5b22 746f 225d 2929  n_params["to"]))
+0001e400: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001e410: 7478 6e5b 2276 616c 7565 225d 203d 3d20  txn["value"] == 
+0001e420: 310a 2020 2020 2020 2020 6173 7365 7274  1.        assert
+0001e430: 2074 786e 5b22 6761 7322 5d20 3d3d 2031   txn["gas"] == 1
+0001e440: 3231 3030 3020 2023 2032 3130 3030 202b  21000  # 21000 +
+0001e450: 2062 7566 6665 720a 0a20 2020 2064 6566   buffer..    def
+0001e460: 2074 6573 745f 6574 685f 7365 6e64 5f74   test_eth_send_t
+0001e470: 7261 6e73 6163 7469 6f6e 5f77 6974 685f  ransaction_with_
+0001e480: 6761 735f 7072 6963 6528 0a20 2020 2020  gas_price(.     
+0001e490: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
+0001e4a0: 6233 222c 2075 6e6c 6f63 6b65 645f 6163  b3", unlocked_ac
+0001e4b0: 636f 756e 745f 6475 616c 5f74 7970 653a  count_dual_type:
+0001e4c0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+0001e4d0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+0001e4e0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+0001e4f0: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+0001e500: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+0001e510: 6f6d 223a 2075 6e6c 6f63 6b65 645f 6163  om": unlocked_ac
+0001e520: 636f 756e 745f 6475 616c 5f74 7970 652c  count_dual_type,
+0001e530: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
+0001e540: 223a 2075 6e6c 6f63 6b65 645f 6163 636f  ": unlocked_acco
+0001e550: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
+0001e560: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+0001e570: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+0001e580: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
+0001e590: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
+0001e5a0: 2020 2267 6173 5072 6963 6522 3a20 5765    "gasPrice": We
+0001e5b0: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+0001e5c0: 2020 226d 6178 4665 6550 6572 4761 7322    "maxFeePerGas"
+0001e5d0: 3a20 5765 6928 3235 3020 2a20 3130 2a2a  : Wei(250 * 10**
+0001e5e0: 3929 2c0a 2020 2020 2020 2020 2020 2020  9),.            
+0001e5f0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+0001e600: 6572 4761 7322 3a20 5765 6928 3220 2a20  erGas": Wei(2 * 
+0001e610: 3130 2a2a 3929 2c0a 2020 2020 2020 2020  10**9),.        
+0001e620: 7d0a 2020 2020 2020 2020 7769 7468 2070  }.        with p
+0001e630: 7974 6573 742e 7261 6973 6573 2854 7261  ytest.raises(Tra
+0001e640: 6e73 6163 7469 6f6e 5479 7065 4d69 736d  nsactionTypeMism
+0001e650: 6174 6368 293a 0a20 2020 2020 2020 2020  atch):.         
+0001e660: 2020 2077 332e 6574 682e 7365 6e64 5f74     w3.eth.send_t
+0001e670: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+0001e680: 6172 616d 7329 0a0a 2020 2020 6465 6620  arams)..    def 
+0001e690: 7465 7374 5f65 7468 5f73 656e 645f 7472  test_eth_send_tr
+0001e6a0: 616e 7361 6374 696f 6e5f 6e6f 5f70 7269  ansaction_no_pri
+0001e6b0: 6f72 6974 795f 6665 6528 0a20 2020 2020  ority_fee(.     
+0001e6c0: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
+0001e6d0: 6233 222c 2075 6e6c 6f63 6b65 645f 6163  b3", unlocked_ac
+0001e6e0: 636f 756e 745f 6475 616c 5f74 7970 653a  count_dual_type:
+0001e6f0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+0001e700: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+0001e710: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+0001e720: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+0001e730: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+0001e740: 6f6d 223a 2075 6e6c 6f63 6b65 645f 6163  om": unlocked_ac
+0001e750: 636f 756e 745f 6475 616c 5f74 7970 652c  count_dual_type,
+0001e760: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
+0001e770: 223a 2075 6e6c 6f63 6b65 645f 6163 636f  ": unlocked_acco
+0001e780: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
+0001e790: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+0001e7a0: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+0001e7b0: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
+0001e7c0: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
+0001e7d0: 2020 226d 6178 4665 6550 6572 4761 7322    "maxFeePerGas"
+0001e7e0: 3a20 5765 6928 3235 3020 2a20 3130 2a2a  : Wei(250 * 10**
+0001e7f0: 3929 2c0a 2020 2020 2020 2020 7d0a 2020  9),.        }.  
+0001e800: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+0001e810: 742e 7261 6973 6573 280a 2020 2020 2020  t.raises(.      
+0001e820: 2020 2020 2020 496e 7661 6c69 6454 7261        InvalidTra
+0001e830: 6e73 6163 7469 6f6e 2c20 6d61 7463 683d  nsaction, match=
+0001e840: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+0001e850: 6572 4761 7320 6d75 7374 2062 6520 6465  erGas must be de
+0001e860: 6669 6e65 6422 0a20 2020 2020 2020 2029  fined".        )
+0001e870: 3a0a 2020 2020 2020 2020 2020 2020 7733  :.            w3
+0001e880: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+0001e890: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
+0001e8a0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+0001e8b0: 6574 685f 7365 6e64 5f74 7261 6e73 6163  eth_send_transac
+0001e8c0: 7469 6f6e 5f6e 6f5f 6d61 785f 6665 6528  tion_no_max_fee(
+0001e8d0: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+0001e8e0: 333a 2022 5765 6233 222c 2075 6e6c 6f63  3: "Web3", unloc
+0001e8f0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+0001e900: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+0001e910: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
+0001e920: 4e6f 6e65 3a0a 2020 2020 2020 2020 6d61  None:.        ma
+0001e930: 785f 7072 696f 7269 7479 5f66 6565 5f70  x_priority_fee_p
+0001e940: 6572 5f67 6173 203d 2077 332e 746f 5f77  er_gas = w3.to_w
+0001e950: 6569 2832 2c20 2267 7765 6922 290a 2020  ei(2, "gwei").  
+0001e960: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+0001e970: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
+0001e980: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+0001e990: 223a 2075 6e6c 6f63 6b65 645f 6163 636f  ": unlocked_acco
+0001e9a0: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
+0001e9b0: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
+0001e9c0: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
+0001e9d0: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
+0001e9e0: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+0001e9f0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+0001ea00: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+0001ea10: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+0001ea20: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+0001ea30: 6572 4761 7322 3a20 6d61 785f 7072 696f  erGas": max_prio
+0001ea40: 7269 7479 5f66 6565 5f70 6572 5f67 6173  rity_fee_per_gas
+0001ea50: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+0001ea60: 2020 2020 7478 6e5f 6861 7368 203d 2077      txn_hash = w
+0001ea70: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+0001ea80: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
+0001ea90: 7329 0a20 2020 2020 2020 2074 786e 203d  s).        txn =
+0001eaa0: 2077 332e 6574 682e 6765 745f 7472 616e   w3.eth.get_tran
+0001eab0: 7361 6374 696f 6e28 7478 6e5f 6861 7368  saction(txn_hash
+0001eac0: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+0001ead0: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
+0001eae0: 7328 7478 6e5b 2266 726f 6d22 5d2c 2063  s(txn["from"], c
+0001eaf0: 6173 7428 4368 6563 6b73 756d 4164 6472  ast(ChecksumAddr
+0001eb00: 6573 732c 2074 786e 5f70 6172 616d 735b  ess, txn_params[
+0001eb10: 2266 726f 6d22 5d29 290a 2020 2020 2020  "from"])).      
+0001eb20: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+0001eb30: 5f61 6464 7265 7373 2874 786e 5b22 746f  _address(txn["to
+0001eb40: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
+0001eb50: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
+0001eb60: 7261 6d73 5b22 746f 225d 2929 0a20 2020  rams["to"])).   
+0001eb70: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
+0001eb80: 2276 616c 7565 225d 203d 3d20 310a 2020  "value"] == 1.  
+0001eb90: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
+0001eba0: 5b22 6761 7322 5d20 3d3d 2032 3130 3030  ["gas"] == 21000
+0001ebb0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001ebc0: 6973 5f69 6e74 6567 6572 2874 786e 5b22  is_integer(txn["
+0001ebd0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
+0001ebe0: 7247 6173 225d 290a 2020 2020 2020 2020  rGas"]).        
+0001ebf0: 6173 7365 7274 2074 786e 5b22 6d61 7850  assert txn["maxP
+0001ec00: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+0001ec10: 225d 203d 3d20 6d61 785f 7072 696f 7269  "] == max_priori
+0001ec20: 7479 5f66 6565 5f70 6572 5f67 6173 0a20  ty_fee_per_gas. 
+0001ec30: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+0001ec40: 5f69 6e74 6567 6572 2874 786e 5b22 6d61  _integer(txn["ma
+0001ec50: 7846 6565 5065 7247 6173 225d 290a 0a20  xFeePerGas"]).. 
+0001ec60: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+0001ec70: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+0001ec80: 5f6d 6178 5f66 6565 5f6c 6573 735f 7468  _max_fee_less_th
+0001ec90: 616e 5f74 6970 280a 2020 2020 2020 2020  an_tip(.        
+0001eca0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
+0001ecb0: 2c20 756e 6c6f 636b 6564 5f61 6363 6f75  , unlocked_accou
+0001ecc0: 6e74 5f64 7561 6c5f 7479 7065 3a20 4368  nt_dual_type: Ch
+0001ecd0: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
+0001ece0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+0001ecf0: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
+0001ed00: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
+0001ed10: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
+0001ed20: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
+0001ed30: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
+0001ed40: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+0001ed50: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+0001ed60: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
+0001ed70: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
+0001ed80: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
+0001ed90: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
+0001eda0: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
+0001edb0: 6d61 7846 6565 5065 7247 6173 223a 2057  maxFeePerGas": W
+0001edc0: 6569 2831 202a 2031 302a 2a39 292c 0a20  ei(1 * 10**9),. 
+0001edd0: 2020 2020 2020 2020 2020 2022 6d61 7850             "maxP
+0001ede0: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+0001edf0: 223a 2057 6569 2832 202a 2031 302a 2a39  ": Wei(2 * 10**9
+0001ee00: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
+0001ee10: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+0001ee20: 2e72 6169 7365 7328 0a20 2020 2020 2020  .raises(.       
+0001ee30: 2020 2020 2049 6e76 616c 6964 5472 616e       InvalidTran
+0001ee40: 7361 6374 696f 6e2c 206d 6174 6368 3d22  saction, match="
+0001ee50: 6d61 7846 6565 5065 7247 6173 206d 7573  maxFeePerGas mus
+0001ee60: 7420 6265 203e 3d20 6d61 7850 7269 6f72  t be >= maxPrior
+0001ee70: 6974 7946 6565 5065 7247 6173 220a 2020  ityFeePerGas".  
+0001ee80: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+0001ee90: 2020 2020 2077 332e 6574 682e 7365 6e64       w3.eth.send
+0001eea0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+0001eeb0: 5f70 6172 616d 7329 0a0a 2020 2020 6465  _params)..    de
+0001eec0: 6620 7465 7374 5f76 616c 6964 6174 696f  f test_validatio
+0001eed0: 6e5f 6d69 6464 6c65 7761 7265 5f63 6861  n_middleware_cha
+0001eee0: 696e 5f69 645f 6d69 736d 6174 6368 280a  in_id_mismatch(.
+0001eef0: 2020 2020 2020 2020 7365 6c66 2c20 7733          self, w3
+0001ef00: 3a20 2257 6562 3322 2c20 756e 6c6f 636b  : "Web3", unlock
+0001ef10: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
+0001ef20: 7479 7065 3a20 4368 6563 6b73 756d 4164  type: ChecksumAd
+0001ef30: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
+0001ef40: 6f6e 653a 0a20 2020 2020 2020 2077 726f  one:.        wro
+0001ef50: 6e67 5f63 6861 696e 5f69 6420 3d20 3132  ng_chain_id = 12
+0001ef60: 3334 3536 3738 3930 0a20 2020 2020 2020  34567890.       
+0001ef70: 2061 6374 7561 6c5f 6368 6169 6e5f 6964   actual_chain_id
+0001ef80: 203d 2077 332e 6574 682e 6368 6169 6e5f   = w3.eth.chain_
+0001ef90: 6964 0a0a 2020 2020 2020 2020 7478 6e5f  id..        txn_
+0001efa0: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
+0001efb0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+0001efc0: 2022 6672 6f6d 223a 2075 6e6c 6f63 6b65   "from": unlocke
+0001efd0: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
+0001efe0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+0001eff0: 2022 746f 223a 2075 6e6c 6f63 6b65 645f   "to": unlocked_
+0001f000: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+0001f010: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+0001f020: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
+0001f030: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+0001f040: 223a 2057 6569 2832 3130 3030 292c 0a20  ": Wei(21000),. 
+0001f050: 2020 2020 2020 2020 2020 2022 6d61 7846             "maxF
+0001f060: 6565 5065 7247 6173 223a 2077 332e 746f  eePerGas": w3.to
+0001f070: 5f77 6569 2832 2c20 2267 7765 6922 292c  _wei(2, "gwei"),
+0001f080: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
+0001f090: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+0001f0a0: 6173 223a 2077 332e 746f 5f77 6569 2831  as": w3.to_wei(1
+0001f0b0: 2c20 2267 7765 6922 292c 0a20 2020 2020  , "gwei"),.     
+0001f0c0: 2020 2020 2020 2022 6368 6169 6e49 6422         "chainId"
+0001f0d0: 3a20 7772 6f6e 675f 6368 6169 6e5f 6964  : wrong_chain_id
+0001f0e0: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+0001f0f0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+0001f100: 7261 6973 6573 280a 2020 2020 2020 2020  raises(.        
+0001f110: 2020 2020 5765 6233 5661 6c69 6461 7469      Web3Validati
+0001f120: 6f6e 4572 726f 722c 0a20 2020 2020 2020  onError,.       
+0001f130: 2020 2020 206d 6174 6368 3d66 2254 6865       match=f"The
+0001f140: 2074 7261 6e73 6163 7469 6f6e 2064 6563   transaction dec
+0001f150: 6c61 7265 6420 6368 6169 6e20 4944 207b  lared chain ID {
+0001f160: 7772 6f6e 675f 6368 6169 6e5f 6964 7d2c  wrong_chain_id},
+0001f170: 2022 0a20 2020 2020 2020 2020 2020 2066   ".            f
+0001f180: 2262 7574 2074 6865 2063 6f6e 6e65 6374  "but the connect
+0001f190: 6564 206e 6f64 6520 6973 206f 6e20 7b61  ed node is on {a
+0001f1a0: 6374 7561 6c5f 6368 6169 6e5f 6964 7d22  ctual_chain_id}"
+0001f1b0: 2c0a 2020 2020 2020 2020 293a 0a20 2020  ,.        ):.   
+0001f1c0: 2020 2020 2020 2020 2077 332e 6574 682e           w3.eth.
+0001f1d0: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+0001f1e0: 2874 786e 5f70 6172 616d 7329 0a0a 2020  (txn_params)..  
+0001f1f0: 2020 4070 7974 6573 742e 6d61 726b 2e70    @pytest.mark.p
+0001f200: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
+0001f210: 2020 2020 226d 6178 5f66 6565 222c 2028      "max_fee", (
+0001f220: 3130 3030 3030 3030 3030 2c20 4e6f 6e65  1000000000, None
+0001f230: 292c 2069 6473 3d5b 2277 6974 685f 6d61  ), ids=["with_ma
+0001f240: 785f 6665 6522 2c20 2277 6974 686f 7574  x_fee", "without
+0001f250: 5f6d 6178 5f66 6565 225d 0a20 2020 2029  _max_fee"].    )
+0001f260: 0a20 2020 2064 6566 2074 6573 745f 6761  .    def test_ga
+0001f270: 735f 7072 6963 655f 6672 6f6d 5f73 7472  s_price_from_str
+0001f280: 6174 6567 795f 6279 7061 7373 6564 5f66  ategy_bypassed_f
+0001f290: 6f72 5f64 796e 616d 6963 5f66 6565 5f74  or_dynamic_fee_t
+0001f2a0: 786e 280a 2020 2020 2020 2020 7365 6c66  xn(.        self
+0001f2b0: 2c20 7733 3a20 2257 6562 3322 2c20 756e  , w3: "Web3", un
+0001f2c0: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
+0001f2d0: 7561 6c5f 7479 7065 3a20 4368 6563 6b73  ual_type: Checks
+0001f2e0: 756d 4164 6472 6573 732c 206d 6178 5f66  umAddress, max_f
+0001f2f0: 6565 3a20 5765 690a 2020 2020 2920 2d3e  ee: Wei.    ) ->
+0001f300: 204e 6f6e 653a 0a20 2020 2020 2020 206d   None:.        m
+0001f310: 6178 5f70 7269 6f72 6974 795f 6665 6520  ax_priority_fee 
+0001f320: 3d20 7733 2e74 6f5f 7765 6928 312c 2022  = w3.to_wei(1, "
+0001f330: 6777 6569 2229 0a20 2020 2020 2020 2074  gwei").        t
+0001f340: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+0001f350: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+0001f360: 2020 2020 2266 726f 6d22 3a20 756e 6c6f      "from": unlo
+0001f370: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+0001f380: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+0001f390: 2020 2020 2274 6f22 3a20 756e 6c6f 636b      "to": unlock
+0001f3a0: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
+0001f3b0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+0001f3c0: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
+0001f3d0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+0001f3e0: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
+0001f3f0: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
+0001f400: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
+0001f410: 206d 6178 5f70 7269 6f72 6974 795f 6665   max_priority_fe
+0001f420: 652c 0a20 2020 2020 2020 207d 0a20 2020  e,.        }.   
+0001f430: 2020 2020 2069 6620 6d61 785f 6665 6520       if max_fee 
+0001f440: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0001f450: 2020 2020 2020 2020 2074 786e 5f70 6172           txn_par
+0001f460: 616d 7320 3d20 6173 736f 6328 7478 6e5f  ams = assoc(txn_
+0001f470: 7061 7261 6d73 2c20 226d 6178 4665 6550  params, "maxFeeP
+0001f480: 6572 4761 7322 2c20 6d61 785f 6665 6529  erGas", max_fee)
+0001f490: 0a0a 2020 2020 2020 2020 6465 6620 6761  ..        def ga
+0001f4a0: 735f 7072 6963 655f 7374 7261 7465 6779  s_price_strategy
+0001f4b0: 285f 7733 3a20 2257 6562 3322 2c20 5f74  (_w3: "Web3", _t
+0001f4c0: 786e 3a20 5478 5061 7261 6d73 2920 2d3e  xn: TxParams) ->
+0001f4d0: 2057 6569 3a0a 2020 2020 2020 2020 2020   Wei:.          
+0001f4e0: 2020 7265 7475 726e 2077 332e 746f 5f77    return w3.to_w
+0001f4f0: 6569 2832 2c20 2267 7765 6922 290a 0a20  ei(2, "gwei").. 
+0001f500: 2020 2020 2020 2077 332e 6574 682e 7365         w3.eth.se
+0001f510: 745f 6761 735f 7072 6963 655f 7374 7261  t_gas_price_stra
+0001f520: 7465 6779 2867 6173 5f70 7269 6365 5f73  tegy(gas_price_s
+0001f530: 7472 6174 6567 7929 0a0a 2020 2020 2020  trategy)..      
+0001f540: 2020 7478 6e5f 6861 7368 203d 2077 332e    txn_hash = w3.
+0001f550: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+0001f560: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+0001f570: 0a20 2020 2020 2020 2074 786e 203d 2077  .        txn = w
+0001f580: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
+0001f590: 6374 696f 6e28 7478 6e5f 6861 7368 290a  ction(txn_hash).
+0001f5a0: 0a20 2020 2020 2020 206c 6174 6573 745f  .        latest_
+0001f5b0: 626c 6f63 6b20 3d20 7733 2e65 7468 2e67  block = w3.eth.g
+0001f5c0: 6574 5f62 6c6f 636b 2822 6c61 7465 7374  et_block("latest
+0001f5d0: 2229 0a20 2020 2020 2020 2061 7373 6572  ").        asser
+0001f5e0: 7420 280a 2020 2020 2020 2020 2020 2020  t (.            
+0001f5f0: 7478 6e5b 226d 6178 4665 6550 6572 4761  txn["maxFeePerGa
+0001f600: 7322 5d20 3d3d 206d 6178 5f66 6565 0a20  s"] == max_fee. 
+0001f610: 2020 2020 2020 2020 2020 2069 6620 6d61             if ma
+0001f620: 785f 6665 6520 6973 206e 6f74 204e 6f6e  x_fee is not Non
+0001f630: 650a 2020 2020 2020 2020 2020 2020 656c  e.            el
+0001f640: 7365 2032 202a 206c 6174 6573 745f 626c  se 2 * latest_bl
+0001f650: 6f63 6b5b 2262 6173 6546 6565 5065 7247  ock["baseFeePerG
+0001f660: 6173 225d 202b 206d 6178 5f70 7269 6f72  as"] + max_prior
+0001f670: 6974 795f 6665 650a 2020 2020 2020 2020  ity_fee.        
+0001f680: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0001f690: 2074 786e 5b22 6d61 7850 7269 6f72 6974   txn["maxPriorit
+0001f6a0: 7946 6565 5065 7247 6173 225d 203d 3d20  yFeePerGas"] == 
+0001f6b0: 6d61 785f 7072 696f 7269 7479 5f66 6565  max_priority_fee
+0001f6c0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001f6d0: 7478 6e5b 2267 6173 5072 6963 6522 5d20  txn["gasPrice"] 
+0001f6e0: 3d3d 2074 786e 5b22 6d61 7846 6565 5065  == txn["maxFeePe
+0001f6f0: 7247 6173 225d 0a0a 2020 2020 2020 2020  rGas"]..        
+0001f700: 7733 2e65 7468 2e73 6574 5f67 6173 5f70  w3.eth.set_gas_p
+0001f710: 7269 6365 5f73 7472 6174 6567 7928 4e6f  rice_strategy(No
+0001f720: 6e65 2920 2023 2072 6573 6574 2073 7472  ne)  # reset str
+0001f730: 6174 6567 790a 0a20 2020 2064 6566 2074  ategy..    def t
+0001f740: 6573 745f 6761 735f 7072 6963 655f 6672  est_gas_price_fr
+0001f750: 6f6d 5f73 7472 6174 6567 795f 6279 7061  om_strategy_bypa
+0001f760: 7373 6564 5f66 6f72 5f64 796e 616d 6963  ssed_for_dynamic
+0001f770: 5f66 6565 5f74 786e 5f6e 6f5f 7469 7028  _fee_txn_no_tip(
+0001f780: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0001f790: 2020 2020 2020 2077 333a 2022 5765 6233         w3: "Web3
+0001f7a0: 222c 0a20 2020 2020 2020 2075 6e6c 6f63  ",.        unloc
+0001f7b0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+0001f7c0: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+0001f7d0: 6464 7265 7373 2c0a 2020 2020 2920 2d3e  ddress,.    ) ->
+0001f7e0: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+0001f7f0: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+0001f800: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+0001f810: 2020 2020 2266 726f 6d22 3a20 756e 6c6f      "from": unlo
+0001f820: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+0001f830: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+0001f840: 2020 2020 2274 6f22 3a20 756e 6c6f 636b      "to": unlock
+0001f850: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
+0001f860: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+0001f870: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
+0001f880: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+0001f890: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
+0001f8a0: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
+0001f8b0: 5065 7247 6173 223a 2057 6569 2831 3030  PerGas": Wei(100
+0001f8c0: 3030 3030 3030 3029 2c0a 2020 2020 2020  0000000),.      
+0001f8d0: 2020 7d0a 0a20 2020 2020 2020 2064 6566    }..        def
+0001f8e0: 2067 6173 5f70 7269 6365 5f73 7472 6174   gas_price_strat
+0001f8f0: 6567 7928 5f77 333a 2022 5765 6233 222c  egy(_w3: "Web3",
+0001f900: 205f 7478 6e3a 2054 7850 6172 616d 7329   _txn: TxParams)
+0001f910: 202d 3e20 5765 693a 0a20 2020 2020 2020   -> Wei:.       
+0001f920: 2020 2020 2072 6574 7572 6e20 7733 2e74       return w3.t
+0001f930: 6f5f 7765 6928 322c 2022 6777 6569 2229  o_wei(2, "gwei")
+0001f940: 0a0a 2020 2020 2020 2020 7733 2e65 7468  ..        w3.eth
+0001f950: 2e73 6574 5f67 6173 5f70 7269 6365 5f73  .set_gas_price_s
+0001f960: 7472 6174 6567 7928 6761 735f 7072 6963  trategy(gas_pric
+0001f970: 655f 7374 7261 7465 6779 290a 0a20 2020  e_strategy)..   
+0001f980: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+0001f990: 2e72 6169 7365 7328 0a20 2020 2020 2020  .raises(.       
+0001f9a0: 2020 2020 2049 6e76 616c 6964 5472 616e       InvalidTran
+0001f9b0: 7361 6374 696f 6e2c 206d 6174 6368 3d22  saction, match="
+0001f9c0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
+0001f9d0: 7247 6173 206d 7573 7420 6265 2064 6566  rGas must be def
+0001f9e0: 696e 6564 220a 2020 2020 2020 2020 293a  ined".        ):
+0001f9f0: 0a20 2020 2020 2020 2020 2020 2077 332e  .            w3.
+0001fa00: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+0001fa10: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+0001fa20: 0a0a 2020 2020 2020 2020 7733 2e65 7468  ..        w3.eth
+0001fa30: 2e73 6574 5f67 6173 5f70 7269 6365 5f73  .set_gas_price_s
+0001fa40: 7472 6174 6567 7928 4e6f 6e65 2920 2023  trategy(None)  #
+0001fa50: 2072 6573 6574 2073 7472 6174 6567 790a   reset strategy.
+0001fa60: 0a20 2020 2064 6566 2074 6573 745f 6761  .    def test_ga
+0001fa70: 735f 7072 6963 655f 7374 7261 7465 6779  s_price_strategy
+0001fa80: 5f68 6578 5f76 616c 7565 280a 2020 2020  _hex_value(.    
+0001fa90: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
+0001faa0: 6562 3322 2c20 756e 6c6f 636b 6564 5f61  eb3", unlocked_a
+0001fab0: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
+0001fac0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+0001fad0: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
+0001fae0: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
+0001faf0: 616d 733a 2054 7850 6172 616d 7320 3d20  ams: TxParams = 
+0001fb00: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
+0001fb10: 726f 6d22 3a20 756e 6c6f 636b 6564 5f61  rom": unlocked_a
+0001fb20: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
+0001fb30: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+0001fb40: 6f22 3a20 756e 6c6f 636b 6564 5f61 6363  o": unlocked_acc
+0001fb50: 6f75 6e74 5f64 7561 6c5f 7479 7065 2c0a  ount_dual_type,.
+0001fb60: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+0001fb70: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
+0001fb80: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
+0001fb90: 3231 3030 302c 0a20 2020 2020 2020 207d  21000,.        }
+0001fba0: 0a20 2020 2020 2020 2074 776f 5f67 7765  .        two_gwe
+0001fbb0: 695f 696e 5f77 6569 203d 2077 332e 746f  i_in_wei = w3.to
+0001fbc0: 5f77 6569 2832 2c20 2267 7765 6922 290a  _wei(2, "gwei").
+0001fbd0: 0a20 2020 2020 2020 2064 6566 2067 6173  .        def gas
+0001fbe0: 5f70 7269 6365 5f73 7472 6174 6567 7928  _price_strategy(
+0001fbf0: 5f77 333a 2022 5765 6233 222c 205f 7478  _w3: "Web3", _tx
+0001fc00: 6e3a 2054 7850 6172 616d 7329 202d 3e20  n: TxParams) -> 
+0001fc10: 7374 723a 0a20 2020 2020 2020 2020 2020  str:.           
+0001fc20: 2072 6574 7572 6e20 6865 7828 7477 6f5f   return hex(two_
+0001fc30: 6777 6569 5f69 6e5f 7765 6929 0a0a 2020  gwei_in_wei)..  
+0001fc40: 2020 2020 2020 7733 2e65 7468 2e73 6574        w3.eth.set
+0001fc50: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
+0001fc60: 6567 7928 6761 735f 7072 6963 655f 7374  egy(gas_price_st
+0001fc70: 7261 7465 6779 2920 2023 2074 7970 653a  rategy)  # type:
+0001fc80: 2069 676e 6f72 650a 0a20 2020 2020 2020   ignore..       
+0001fc90: 2074 786e 5f68 6173 6820 3d20 7733 2e65   txn_hash = w3.e
+0001fca0: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
+0001fcb0: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
+0001fcc0: 2020 2020 2020 2020 7478 6e20 3d20 7733          txn = w3
+0001fcd0: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
+0001fce0: 7469 6f6e 2874 786e 5f68 6173 6829 0a0a  tion(txn_hash)..
+0001fcf0: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+0001fd00: 786e 5b22 6761 7350 7269 6365 225d 203d  xn["gasPrice"] =
+0001fd10: 3d20 7477 6f5f 6777 6569 5f69 6e5f 7765  = two_gwei_in_we
+0001fd20: 690a 2020 2020 2020 2020 7733 2e65 7468  i.        w3.eth
+0001fd30: 2e73 6574 5f67 6173 5f70 7269 6365 5f73  .set_gas_price_s
+0001fd40: 7472 6174 6567 7928 4e6f 6e65 2920 2023  trategy(None)  #
+0001fd50: 2072 6573 6574 2073 7472 6174 6567 790a   reset strategy.
+0001fd60: 0a20 2020 2040 666c 616b 795f 6765 7468  .    @flaky_geth
+0001fd70: 5f64 6576 5f6d 696e 696e 670a 2020 2020  _dev_mining.    
+0001fd80: 6465 6620 7465 7374 5f65 7468 5f72 6570  def test_eth_rep
+0001fd90: 6c61 6365 5f74 7261 6e73 6163 7469 6f6e  lace_transaction
+0001fda0: 5f6c 6567 6163 7928 0a20 2020 2020 2020  _legacy(.       
+0001fdb0: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
+0001fdc0: 222c 2075 6e6c 6f63 6b65 645f 6163 636f  ", unlocked_acco
+0001fdd0: 756e 745f 6475 616c 5f74 7970 653a 2043  unt_dual_type: C
+0001fde0: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
+0001fdf0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+0001fe00: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+0001fe10: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
+0001fe20: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+0001fe30: 223a 2075 6e6c 6f63 6b65 645f 6163 636f  ": unlocked_acco
+0001fe40: 756e 745f 6475 616c 5f74 7970 652c 0a20  unt_dual_type,. 
+0001fe50: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
+0001fe60: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
+0001fe70: 745f 6475 616c 5f74 7970 652c 0a20 2020  t_dual_type,.   
+0001fe80: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+0001fe90: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+0001fea0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+0001feb0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+0001fec0: 2267 6173 5072 6963 6522 3a20 7733 2e74  "gasPrice": w3.t
+0001fed0: 6f5f 7765 6928 0a20 2020 2020 2020 2020  o_wei(.         
+0001fee0: 2020 2020 2020 2031 2c20 2267 7765 6922         1, "gwei"
+0001fef0: 0a20 2020 2020 2020 2020 2020 2029 2c20  .            ), 
+0001ff00: 2023 206d 7573 7420 6265 2067 7265 6174   # must be great
+0001ff10: 6572 2074 6861 6e20 6261 7365 5f66 6565  er than base_fee
+0001ff20: 2070 6f73 7420 4c6f 6e64 6f6e 0a20 2020   post London.   
+0001ff30: 2020 2020 207d 0a20 2020 2020 2020 2074       }.        t
+0001ff40: 786e 5f68 6173 6820 3d20 7733 2e65 7468  xn_hash = w3.eth
+0001ff50: 2e73 656e 645f 7472 616e 7361 6374 696f  .send_transactio
+0001ff60: 6e28 7478 6e5f 7061 7261 6d73 290a 0a20  n(txn_params).. 
+0001ff70: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+0001ff80: 735b 2267 6173 5072 6963 6522 5d20 3d20  s["gasPrice"] = 
+0001ff90: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
+0001ffa0: 6569 2229 0a20 2020 2020 2020 2072 6570  ei").        rep
+0001ffb0: 6c61 6365 5f74 786e 5f68 6173 6820 3d20  lace_txn_hash = 
+0001ffc0: 7733 2e65 7468 2e72 6570 6c61 6365 5f74  w3.eth.replace_t
+0001ffd0: 7261 6e73 6163 7469 6f6e 2874 786e 5f68  ransaction(txn_h
+0001ffe0: 6173 682c 2074 786e 5f70 6172 616d 7329  ash, txn_params)
+0001fff0: 0a20 2020 2020 2020 2072 6570 6c61 6365  .        replace
+00020000: 5f74 786e 203d 2077 332e 6574 682e 6765  _txn = w3.eth.ge
+00020010: 745f 7472 616e 7361 6374 696f 6e28 7265  t_transaction(re
+00020020: 706c 6163 655f 7478 6e5f 6861 7368 290a  place_txn_hash).
+00020030: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00020040: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
+00020050: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
+00020060: 6c61 6365 5f74 786e 5b22 6672 6f6d 225d  lace_txn["from"]
+00020070: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
+00020080: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
+00020090: 6d73 5b22 6672 6f6d 225d 290a 2020 2020  ms["from"]).    
+000200a0: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+000200b0: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
+000200c0: 7265 7373 280a 2020 2020 2020 2020 2020  ress(.          
+000200d0: 2020 7265 706c 6163 655f 7478 6e5b 2274    replace_txn["t
+000200e0: 6f22 5d2c 2063 6173 7428 4368 6563 6b73  o"], cast(Checks
+000200f0: 756d 4164 6472 6573 732c 2074 786e 5f70  umAddress, txn_p
+00020100: 6172 616d 735b 2274 6f22 5d29 0a20 2020  arams["to"]).   
+00020110: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
+00020120: 7373 6572 7420 7265 706c 6163 655f 7478  ssert replace_tx
+00020130: 6e5b 2276 616c 7565 225d 203d 3d20 310a  n["value"] == 1.
+00020140: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00020150: 6570 6c61 6365 5f74 786e 5b22 6761 7322  eplace_txn["gas"
+00020160: 5d20 3d3d 2032 3130 3030 0a20 2020 2020  ] == 21000.     
+00020170: 2020 2061 7373 6572 7420 7265 706c 6163     assert replac
+00020180: 655f 7478 6e5b 2267 6173 5072 6963 6522  e_txn["gasPrice"
+00020190: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
+000201a0: 2267 6173 5072 6963 6522 5d0a 0a20 2020  "gasPrice"]..   
+000201b0: 2040 666c 616b 795f 6765 7468 5f64 6576   @flaky_geth_dev
+000201c0: 5f6d 696e 696e 670a 2020 2020 6465 6620  _mining.    def 
+000201d0: 7465 7374 5f65 7468 5f72 6570 6c61 6365  test_eth_replace
+000201e0: 5f74 7261 6e73 6163 7469 6f6e 280a 2020  _transaction(.  
+000201f0: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+00020200: 2257 6562 3322 2c20 756e 6c6f 636b 6564  "Web3", unlocked
+00020210: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+00020220: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
+00020230: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
+00020240: 653a 0a20 2020 2020 2020 2074 776f 5f67  e:.        two_g
+00020250: 7765 695f 696e 5f77 6569 203d 2077 332e  wei_in_wei = w3.
+00020260: 746f 5f77 6569 2832 2c20 2267 7765 6922  to_wei(2, "gwei"
+00020270: 290a 2020 2020 2020 2020 7468 7265 655f  ).        three_
+00020280: 6777 6569 5f69 6e5f 7765 6920 3d20 7733  gwei_in_wei = w3
+00020290: 2e74 6f5f 7765 6928 332c 2022 6777 6569  .to_wei(3, "gwei
+000202a0: 2229 0a0a 2020 2020 2020 2020 7478 6e5f  ")..        txn_
+000202b0: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
+000202c0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+000202d0: 2022 6672 6f6d 223a 2075 6e6c 6f63 6b65   "from": unlocke
+000202e0: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
+000202f0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00020300: 2022 746f 223a 2075 6e6c 6f63 6b65 645f   "to": unlocked_
+00020310: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+00020320: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00020330: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
+00020340: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+00020350: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
+00020360: 2020 2020 2020 226d 6178 4665 6550 6572        "maxFeePer
+00020370: 4761 7322 3a20 7477 6f5f 6777 6569 5f69  Gas": two_gwei_i
+00020380: 6e5f 7765 692c 0a20 2020 2020 2020 2020  n_wei,.         
+00020390: 2020 2022 6d61 7850 7269 6f72 6974 7946     "maxPriorityF
+000203a0: 6565 5065 7247 6173 223a 2077 332e 746f  eePerGas": w3.to
+000203b0: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
+000203c0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+000203d0: 2020 2074 786e 5f68 6173 6820 3d20 7733     txn_hash = w3
+000203e0: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+000203f0: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
+00020400: 290a 0a20 2020 2020 2020 2074 786e 5f70  )..        txn_p
+00020410: 6172 616d 735b 226d 6178 4665 6550 6572  arams["maxFeePer
+00020420: 4761 7322 5d20 3d20 7468 7265 655f 6777  Gas"] = three_gw
+00020430: 6569 5f69 6e5f 7765 690a 2020 2020 2020  ei_in_wei.      
+00020440: 2020 7478 6e5f 7061 7261 6d73 5b22 6d61    txn_params["ma
+00020450: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+00020460: 6173 225d 203d 2074 776f 5f67 7765 695f  as"] = two_gwei_
+00020470: 696e 5f77 6569 0a0a 2020 2020 2020 2020  in_wei..        
+00020480: 7265 706c 6163 655f 7478 6e5f 6861 7368  replace_txn_hash
+00020490: 203d 2077 332e 6574 682e 7265 706c 6163   = w3.eth.replac
+000204a0: 655f 7472 616e 7361 6374 696f 6e28 7478  e_transaction(tx
+000204b0: 6e5f 6861 7368 2c20 7478 6e5f 7061 7261  n_hash, txn_para
+000204c0: 6d73 290a 2020 2020 2020 2020 7265 706c  ms).        repl
+000204d0: 6163 655f 7478 6e20 3d20 7733 2e65 7468  ace_txn = w3.eth
+000204e0: 2e67 6574 5f74 7261 6e73 6163 7469 6f6e  .get_transaction
+000204f0: 2872 6570 6c61 6365 5f74 786e 5f68 6173  (replace_txn_has
+00020500: 6829 0a0a 2020 2020 2020 2020 6173 7365  h)..        asse
+00020510: 7274 2069 735f 7361 6d65 5f61 6464 7265  rt is_same_addre
+00020520: 7373 280a 2020 2020 2020 2020 2020 2020  ss(.            
+00020530: 7265 706c 6163 655f 7478 6e5b 2266 726f  replace_txn["fro
+00020540: 6d22 5d2c 2063 6173 7428 4368 6563 6b73  m"], cast(Checks
+00020550: 756d 4164 6472 6573 732c 2074 786e 5f70  umAddress, txn_p
+00020560: 6172 616d 735b 2266 726f 6d22 5d29 0a20  arams["from"]). 
+00020570: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00020580: 2061 7373 6572 7420 6973 5f73 616d 655f   assert is_same_
+00020590: 6164 6472 6573 7328 0a20 2020 2020 2020  address(.       
+000205a0: 2020 2020 2072 6570 6c61 6365 5f74 786e       replace_txn
+000205b0: 5b22 746f 225d 2c20 6361 7374 2843 6865  ["to"], cast(Che
+000205c0: 636b 7375 6d41 6464 7265 7373 2c20 7478  cksumAddress, tx
+000205d0: 6e5f 7061 7261 6d73 5b22 746f 225d 290a  n_params["to"]).
+000205e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000205f0: 2020 6173 7365 7274 2072 6570 6c61 6365    assert replace
+00020600: 5f74 786e 5b22 7661 6c75 6522 5d20 3d3d  _txn["value"] ==
+00020610: 2031 0a20 2020 2020 2020 2061 7373 6572   1.        asser
+00020620: 7420 7265 706c 6163 655f 7478 6e5b 2267  t replace_txn["g
+00020630: 6173 225d 203d 3d20 3231 3030 300a 2020  as"] == 21000.  
+00020640: 2020 2020 2020 6173 7365 7274 2072 6570        assert rep
+00020650: 6c61 6365 5f74 786e 5b22 6d61 7846 6565  lace_txn["maxFee
+00020660: 5065 7247 6173 225d 203d 3d20 7468 7265  PerGas"] == thre
+00020670: 655f 6777 6569 5f69 6e5f 7765 690a 2020  e_gwei_in_wei.  
+00020680: 2020 2020 2020 6173 7365 7274 2072 6570        assert rep
+00020690: 6c61 6365 5f74 786e 5b22 6d61 7850 7269  lace_txn["maxPri
+000206a0: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
+000206b0: 203d 3d20 7477 6f5f 6777 6569 5f69 6e5f   == two_gwei_in_
+000206c0: 7765 690a 0a20 2020 2040 666c 616b 795f  wei..    @flaky_
+000206d0: 6765 7468 5f64 6576 5f6d 696e 696e 670a  geth_dev_mining.
+000206e0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+000206f0: 5f72 6570 6c61 6365 5f74 7261 6e73 6163  _replace_transac
+00020700: 7469 6f6e 5f75 6e64 6572 7072 6963 6564  tion_underpriced
+00020710: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00020720: 7733 3a20 2257 6562 3322 2c20 756e 6c6f  w3: "Web3", unlo
+00020730: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+00020740: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
+00020750: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
+00020760: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+00020770: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+00020780: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+00020790: 2020 2020 2266 726f 6d22 3a20 756e 6c6f      "from": unlo
+000207a0: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+000207b0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+000207c0: 2020 2020 2274 6f22 3a20 756e 6c6f 636b      "to": unlock
+000207d0: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
+000207e0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+000207f0: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
+00020800: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+00020810: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
+00020820: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
+00020830: 5065 7247 6173 223a 2077 332e 746f 5f77  PerGas": w3.to_w
+00020840: 6569 2833 2c20 2267 7765 6922 292c 0a20  ei(3, "gwei"),. 
+00020850: 2020 2020 2020 2020 2020 2022 6d61 7850             "maxP
+00020860: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+00020870: 223a 2077 332e 746f 5f77 6569 2832 2c20  ": w3.to_wei(2, 
+00020880: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
+00020890: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
+000208a0: 6173 6820 3d20 7733 2e65 7468 2e73 656e  ash = w3.eth.sen
+000208b0: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
+000208c0: 6e5f 7061 7261 6d73 290a 0a20 2020 2020  n_params)..     
+000208d0: 2020 206f 6e65 5f67 7765 695f 696e 5f77     one_gwei_in_w
+000208e0: 6569 203d 2077 332e 746f 5f77 6569 2831  ei = w3.to_wei(1
+000208f0: 2c20 2267 7765 6922 290a 2020 2020 2020  , "gwei").      
+00020900: 2020 7478 6e5f 7061 7261 6d73 5b22 6d61    txn_params["ma
+00020910: 7846 6565 5065 7247 6173 225d 203d 206f  xFeePerGas"] = o
+00020920: 6e65 5f67 7765 695f 696e 5f77 6569 0a20  ne_gwei_in_wei. 
+00020930: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+00020940: 735b 226d 6178 5072 696f 7269 7479 4665  s["maxPriorityFe
+00020950: 6550 6572 4761 7322 5d20 3d20 6f6e 655f  ePerGas"] = one_
+00020960: 6777 6569 5f69 6e5f 7765 690a 0a20 2020  gwei_in_wei..   
+00020970: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+00020980: 2e72 6169 7365 7328 5661 6c75 6545 7272  .raises(ValueErr
+00020990: 6f72 2c20 6d61 7463 683d 2272 6570 6c61  or, match="repla
+000209a0: 6365 6d65 6e74 2074 7261 6e73 6163 7469  cement transacti
+000209b0: 6f6e 2075 6e64 6572 7072 6963 6564 2229  on underpriced")
+000209c0: 3a0a 2020 2020 2020 2020 2020 2020 7733  :.            w3
+000209d0: 2e65 7468 2e72 6570 6c61 6365 5f74 7261  .eth.replace_tra
+000209e0: 6e73 6163 7469 6f6e 2874 786e 5f68 6173  nsaction(txn_has
+000209f0: 682c 2074 786e 5f70 6172 616d 7329 0a0a  h, txn_params)..
+00020a00: 2020 2020 4066 6c61 6b79 5f67 6574 685f      @flaky_geth_
+00020a10: 6465 765f 6d69 6e69 6e67 0a20 2020 2064  dev_mining.    d
+00020a20: 6566 2074 6573 745f 6574 685f 7265 706c  ef test_eth_repl
+00020a30: 6163 655f 7472 616e 7361 6374 696f 6e5f  ace_transaction_
+00020a40: 6e6f 6e5f 6578 6973 7469 6e67 5f74 7261  non_existing_tra
+00020a50: 6e73 6163 7469 6f6e 280a 2020 2020 2020  nsaction(.      
+00020a60: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+00020a70: 3322 2c20 756e 6c6f 636b 6564 5f61 6363  3", unlocked_acc
+00020a80: 6f75 6e74 5f64 7561 6c5f 7479 7065 3a20  ount_dual_type: 
+00020a90: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
+00020aa0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00020ab0: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+00020ac0: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
+00020ad0: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+00020ae0: 6d22 3a20 756e 6c6f 636b 6564 5f61 6363  m": unlocked_acc
+00020af0: 6f75 6e74 5f64 7561 6c5f 7479 7065 2c0a  ount_dual_type,.
+00020b00: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+00020b10: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
+00020b20: 6e74 5f64 7561 6c5f 7479 7065 2c0a 2020  nt_dual_type,.  
+00020b30: 2020 2020 2020 2020 2020 2276 616c 7565            "value
+00020b40: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
+00020b50: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
+00020b60: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
+00020b70: 2022 6d61 7846 6565 5065 7247 6173 223a   "maxFeePerGas":
+00020b80: 2077 332e 746f 5f77 6569 2833 2c20 2267   w3.to_wei(3, "g
+00020b90: 7765 6922 292c 0a20 2020 2020 2020 2020  wei"),.         
+00020ba0: 2020 2022 6d61 7850 7269 6f72 6974 7946     "maxPriorityF
+00020bb0: 6565 5065 7247 6173 223a 2077 332e 746f  eePerGas": w3.to
+00020bc0: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
+00020bd0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00020be0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+00020bf0: 6169 7365 7328 5472 616e 7361 6374 696f  aises(Transactio
+00020c00: 6e4e 6f74 466f 756e 6429 3a0a 2020 2020  nNotFound):.    
+00020c10: 2020 2020 2020 2020 7733 2e65 7468 2e72          w3.eth.r
+00020c20: 6570 6c61 6365 5f74 7261 6e73 6163 7469  eplace_transacti
+00020c30: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+00020c40: 2020 2020 4865 7853 7472 280a 2020 2020      HexStr(.    
+00020c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020c60: 2230 7839 3865 3863 6330 3962 3331 3135  "0x98e8cc09b3115
+00020c70: 3833 6335 3037 3966 6136 3030 6636 6332  83c5079fa600f6c2
+00020c80: 6133 6265 6138 3631 3161 6631 3638 6335  a3bea8611af168c5
+00020c90: 3265 3462 3630 6235 6232 3433 6134 3431  2e4b60b5b243a441
+00020ca0: 3939 3722 0a20 2020 2020 2020 2020 2020  997".           
+00020cb0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+00020cc0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+00020cd0: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
+00020ce0: 290a 0a20 2020 2040 666c 616b 795f 6765  )..    @flaky_ge
+00020cf0: 7468 5f64 6576 5f6d 696e 696e 670a 2020  th_dev_mining.  
+00020d00: 2020 6465 6620 7465 7374 5f65 7468 5f72    def test_eth_r
+00020d10: 6570 6c61 6365 5f74 7261 6e73 6163 7469  eplace_transacti
+00020d20: 6f6e 5f61 6c72 6561 6479 5f6d 696e 6564  on_already_mined
+00020d30: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00020d40: 7733 3a20 2257 6562 3322 2c20 756e 6c6f  w3: "Web3", unlo
+00020d50: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+00020d60: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
+00020d70: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
+00020d80: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+00020d90: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+00020da0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+00020db0: 2020 2020 2266 726f 6d22 3a20 756e 6c6f      "from": unlo
+00020dc0: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+00020dd0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+00020de0: 2020 2020 2274 6f22 3a20 756e 6c6f 636b      "to": unlock
+00020df0: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
+00020e00: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+00020e10: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
+00020e20: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+00020e30: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
+00020e40: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
+00020e50: 5065 7247 6173 223a 2077 332e 746f 5f77  PerGas": w3.to_w
+00020e60: 6569 2832 2c20 2267 7765 6922 292c 0a20  ei(2, "gwei"),. 
+00020e70: 2020 2020 2020 2020 2020 2022 6d61 7850             "maxP
+00020e80: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+00020e90: 223a 2077 332e 746f 5f77 6569 2831 2c20  ": w3.to_wei(1, 
+00020ea0: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
+00020eb0: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
+00020ec0: 6173 6820 3d20 7733 2e65 7468 2e73 656e  ash = w3.eth.sen
+00020ed0: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
+00020ee0: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
+00020ef0: 2020 7733 2e65 7468 2e77 6169 745f 666f    w3.eth.wait_fo
+00020f00: 725f 7472 616e 7361 6374 696f 6e5f 7265  r_transaction_re
+00020f10: 6365 6970 7428 7478 6e5f 6861 7368 2c20  ceipt(txn_hash, 
+00020f20: 7469 6d65 6f75 743d 3130 290a 0a20 2020  timeout=10)..   
+00020f30: 2020 2020 2074 786e 5f70 6172 616d 735b       txn_params[
+00020f40: 226d 6178 4665 6550 6572 4761 7322 5d20  "maxFeePerGas"] 
+00020f50: 3d20 7733 2e74 6f5f 7765 6928 332c 2022  = w3.to_wei(3, "
+00020f60: 6777 6569 2229 0a20 2020 2020 2020 2074  gwei").        t
+00020f70: 786e 5f70 6172 616d 735b 226d 6178 5072  xn_params["maxPr
+00020f80: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
+00020f90: 5d20 3d20 7733 2e74 6f5f 7765 6928 322c  ] = w3.to_wei(2,
+00020fa0: 2022 6777 6569 2229 0a20 2020 2020 2020   "gwei").       
+00020fb0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+00020fc0: 7365 7328 5661 6c75 6545 7272 6f72 2c20  ses(ValueError, 
+00020fd0: 6d61 7463 683d 2253 7570 706c 6965 6420  match="Supplied 
+00020fe0: 7472 616e 7361 6374 696f 6e20 7769 7468  transaction with
+00020ff0: 2068 6173 6822 293a 0a20 2020 2020 2020   hash"):.       
+00021000: 2020 2020 2077 332e 6574 682e 7265 706c       w3.eth.repl
+00021010: 6163 655f 7472 616e 7361 6374 696f 6e28  ace_transaction(
+00021020: 7478 6e5f 6861 7368 2c20 7478 6e5f 7061  txn_hash, txn_pa
+00021030: 7261 6d73 290a 0a20 2020 2040 666c 616b  rams)..    @flak
+00021040: 795f 6765 7468 5f64 6576 5f6d 696e 696e  y_geth_dev_minin
+00021050: 670a 2020 2020 6465 6620 7465 7374 5f65  g.    def test_e
+00021060: 7468 5f72 6570 6c61 6365 5f74 7261 6e73  th_replace_trans
+00021070: 6163 7469 6f6e 5f69 6e63 6f72 7265 6374  action_incorrect
+00021080: 5f6e 6f6e 6365 280a 2020 2020 2020 2020  _nonce(.        
+00021090: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
+000210a0: 2c20 756e 6c6f 636b 6564 5f61 6363 6f75  , unlocked_accou
+000210b0: 6e74 3a20 4368 6563 6b73 756d 4164 6472  nt: ChecksumAddr
+000210c0: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
+000210d0: 653a 0a20 2020 2020 2020 2074 786e 5f70  e:.        txn_p
+000210e0: 6172 616d 733a 2054 7850 6172 616d 7320  arams: TxParams 
+000210f0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00021100: 2266 726f 6d22 3a20 756e 6c6f 636b 6564  "from": unlocked
+00021110: 5f61 6363 6f75 6e74 2c0a 2020 2020 2020  _account,.      
+00021120: 2020 2020 2020 2274 6f22 3a20 756e 6c6f        "to": unlo
+00021130: 636b 6564 5f61 6363 6f75 6e74 2c0a 2020  cked_account,.  
+00021140: 2020 2020 2020 2020 2020 2276 616c 7565            "value
+00021150: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
+00021160: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
+00021170: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
+00021180: 2022 6d61 7846 6565 5065 7247 6173 223a   "maxFeePerGas":
+00021190: 2077 332e 746f 5f77 6569 2832 2c20 2267   w3.to_wei(2, "g
+000211a0: 7765 6922 292c 0a20 2020 2020 2020 2020  wei"),.         
+000211b0: 2020 2022 6d61 7850 7269 6f72 6974 7946     "maxPriorityF
+000211c0: 6565 5065 7247 6173 223a 2077 332e 746f  eePerGas": w3.to
+000211d0: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
+000211e0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+000211f0: 2020 2074 786e 5f68 6173 6820 3d20 7733     txn_hash = w3
+00021200: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+00021210: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
+00021220: 290a 2020 2020 2020 2020 7478 6e20 3d20  ).        txn = 
+00021230: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
+00021240: 6163 7469 6f6e 2874 786e 5f68 6173 6829  action(txn_hash)
+00021250: 0a0a 2020 2020 2020 2020 7478 6e5f 7061  ..        txn_pa
+00021260: 7261 6d73 5b22 6d61 7846 6565 5065 7247  rams["maxFeePerG
+00021270: 6173 225d 203d 2077 332e 746f 5f77 6569  as"] = w3.to_wei
+00021280: 2833 2c20 2267 7765 6922 290a 2020 2020  (3, "gwei").    
+00021290: 2020 2020 7478 6e5f 7061 7261 6d73 5b22      txn_params["
+000212a0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
+000212b0: 7247 6173 225d 203d 2077 332e 746f 5f77  rGas"] = w3.to_w
+000212c0: 6569 2832 2c20 2267 7765 6922 290a 2020  ei(2, "gwei").  
+000212d0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+000212e0: 5b22 6e6f 6e63 6522 5d20 3d20 4e6f 6e63  ["nonce"] = Nonc
+000212f0: 6528 7478 6e5b 226e 6f6e 6365 225d 202b  e(txn["nonce"] +
+00021300: 2031 290a 2020 2020 2020 2020 7769 7468   1).        with
+00021310: 2070 7974 6573 742e 7261 6973 6573 2856   pytest.raises(V
+00021320: 616c 7565 4572 726f 7229 3a0a 2020 2020  alueError):.    
+00021330: 2020 2020 2020 2020 7733 2e65 7468 2e72          w3.eth.r
+00021340: 6570 6c61 6365 5f74 7261 6e73 6163 7469  eplace_transacti
+00021350: 6f6e 2874 786e 5f68 6173 682c 2074 786e  on(txn_hash, txn
+00021360: 5f70 6172 616d 7329 0a0a 2020 2020 4066  _params)..    @f
+00021370: 6c61 6b79 5f67 6574 685f 6465 765f 6d69  laky_geth_dev_mi
+00021380: 6e69 6e67 0a20 2020 2064 6566 2074 6573  ning.    def tes
+00021390: 745f 6574 685f 7265 706c 6163 655f 7472  t_eth_replace_tr
+000213a0: 616e 7361 6374 696f 6e5f 6761 735f 7072  ansaction_gas_pr
+000213b0: 6963 655f 746f 6f5f 6c6f 7728 0a20 2020  ice_too_low(.   
+000213c0: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
+000213d0: 5765 6233 222c 2075 6e6c 6f63 6b65 645f  Web3", unlocked_
+000213e0: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+000213f0: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
+00021400: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
+00021410: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
+00021420: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
+00021430: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00021440: 6672 6f6d 223a 2075 6e6c 6f63 6b65 645f  from": unlocked_
+00021450: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+00021460: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00021470: 746f 223a 2075 6e6c 6f63 6b65 645f 6163  to": unlocked_ac
+00021480: 636f 756e 745f 6475 616c 5f74 7970 652c  count_dual_type,
+00021490: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
+000214a0: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
+000214b0: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
+000214c0: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
+000214d0: 2020 2020 2267 6173 5072 6963 6522 3a20      "gasPrice": 
+000214e0: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
+000214f0: 6569 2229 2c0a 2020 2020 2020 2020 7d0a  ei"),.        }.
+00021500: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+00021510: 203d 2077 332e 6574 682e 7365 6e64 5f74   = w3.eth.send_t
+00021520: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+00021530: 6172 616d 7329 0a0a 2020 2020 2020 2020  arams)..        
+00021540: 7478 6e5f 7061 7261 6d73 5b22 6761 7350  txn_params["gasP
+00021550: 7269 6365 225d 203d 2077 332e 746f 5f77  rice"] = w3.to_w
+00021560: 6569 2831 2c20 2267 7765 6922 290a 2020  ei(1, "gwei").  
+00021570: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+00021580: 742e 7261 6973 6573 2856 616c 7565 4572  t.raises(ValueEr
+00021590: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
+000215a0: 2020 7733 2e65 7468 2e72 6570 6c61 6365    w3.eth.replace
+000215b0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+000215c0: 5f68 6173 682c 2074 786e 5f70 6172 616d  _hash, txn_param
+000215d0: 7329 0a0a 2020 2020 4066 6c61 6b79 5f67  s)..    @flaky_g
+000215e0: 6574 685f 6465 765f 6d69 6e69 6e67 0a20  eth_dev_mining. 
+000215f0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+00021600: 7265 706c 6163 655f 7472 616e 7361 6374  replace_transact
+00021610: 696f 6e5f 6761 735f 7072 6963 655f 6465  ion_gas_price_de
+00021620: 6661 756c 7469 6e67 5f6d 696e 696d 756d  faulting_minimum
+00021630: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00021640: 7733 3a20 2257 6562 3322 2c20 756e 6c6f  w3: "Web3", unlo
+00021650: 636b 6564 5f61 6363 6f75 6e74 3a20 4368  cked_account: Ch
+00021660: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
+00021670: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00021680: 2020 2020 2067 6173 5f70 7269 6365 203d       gas_price =
+00021690: 2077 332e 746f 5f77 6569 2831 2c20 2267   w3.to_wei(1, "g
+000216a0: 7765 6922 290a 0a20 2020 2020 2020 2074  wei")..        t
+000216b0: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+000216c0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+000216d0: 2020 2020 2266 726f 6d22 3a20 756e 6c6f      "from": unlo
+000216e0: 636b 6564 5f61 6363 6f75 6e74 2c0a 2020  cked_account,.  
+000216f0: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+00021700: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+00021710: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
+00021720: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
+00021730: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
+00021740: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
+00021750: 2020 2020 2022 6761 7350 7269 6365 223a       "gasPrice":
+00021760: 2067 6173 5f70 7269 6365 2c0a 2020 2020   gas_price,.    
+00021770: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
+00021780: 6e5f 6861 7368 203d 2077 332e 6574 682e  n_hash = w3.eth.
+00021790: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+000217a0: 2874 786e 5f70 6172 616d 7329 0a0a 2020  (txn_params)..  
+000217b0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+000217c0: 2e70 6f70 2822 6761 7350 7269 6365 2229  .pop("gasPrice")
+000217d0: 0a20 2020 2020 2020 2072 6570 6c61 6365  .        replace
+000217e0: 5f74 786e 5f68 6173 6820 3d20 7733 2e65  _txn_hash = w3.e
+000217f0: 7468 2e72 6570 6c61 6365 5f74 7261 6e73  th.replace_trans
+00021800: 6163 7469 6f6e 2874 786e 5f68 6173 682c  action(txn_hash,
+00021810: 2074 786e 5f70 6172 616d 7329 0a20 2020   txn_params).   
+00021820: 2020 2020 2072 6570 6c61 6365 5f74 786e       replace_txn
+00021830: 203d 2077 332e 6574 682e 6765 745f 7472   = w3.eth.get_tr
+00021840: 616e 7361 6374 696f 6e28 7265 706c 6163  ansaction(replac
+00021850: 655f 7478 6e5f 6861 7368 290a 0a20 2020  e_txn_hash)..   
+00021860: 2020 2020 2061 7373 6572 7420 7265 706c       assert repl
+00021870: 6163 655f 7478 6e5b 2267 6173 5072 6963  ace_txn["gasPric
+00021880: 6522 5d20 3d3d 206d 6174 682e 6365 696c  e"] == math.ceil
+00021890: 280a 2020 2020 2020 2020 2020 2020 6761  (.            ga
+000218a0: 735f 7072 6963 6520 2a20 312e 3132 350a  s_price * 1.125.
+000218b0: 2020 2020 2020 2020 2920 2023 206d 696e          )  # min
+000218c0: 696d 756d 2067 6173 2070 7269 6365 0a0a  imum gas price..
+000218d0: 2020 2020 4066 6c61 6b79 5f67 6574 685f      @flaky_geth_
+000218e0: 6465 765f 6d69 6e69 6e67 0a20 2020 2064  dev_mining.    d
+000218f0: 6566 2074 6573 745f 6574 685f 7265 706c  ef test_eth_repl
+00021900: 6163 655f 7472 616e 7361 6374 696f 6e5f  ace_transaction_
+00021910: 6761 735f 7072 6963 655f 6465 6661 756c  gas_price_defaul
+00021920: 7469 6e67 5f73 7472 6174 6567 795f 6869  ting_strategy_hi
+00021930: 6768 6572 280a 2020 2020 2020 2020 7365  gher(.        se
+00021940: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+00021950: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+00021960: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+00021970: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
+00021980: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
+00021990: 616d 733a 2054 7850 6172 616d 7320 3d20  ams: TxParams = 
+000219a0: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
+000219b0: 726f 6d22 3a20 756e 6c6f 636b 6564 5f61  rom": unlocked_a
+000219c0: 6363 6f75 6e74 2c0a 2020 2020 2020 2020  ccount,.        
+000219d0: 2020 2020 2274 6f22 3a20 756e 6c6f 636b      "to": unlock
+000219e0: 6564 5f61 6363 6f75 6e74 2c0a 2020 2020  ed_account,.    
+000219f0: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
+00021a00: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
+00021a10: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
+00021a20: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
+00021a30: 6761 7350 7269 6365 223a 2077 332e 746f  gasPrice": w3.to
+00021a40: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
+00021a50: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00021a60: 2020 2074 786e 5f68 6173 6820 3d20 7733     txn_hash = w3
+00021a70: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+00021a80: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
+00021a90: 290a 0a20 2020 2020 2020 2074 776f 5f67  )..        two_g
+00021aa0: 7765 695f 696e 5f77 6569 203d 2077 332e  wei_in_wei = w3.
+00021ab0: 746f 5f77 6569 2832 2c20 2267 7765 6922  to_wei(2, "gwei"
+00021ac0: 290a 0a20 2020 2020 2020 2064 6566 2068  )..        def h
+00021ad0: 6967 6865 725f 6761 735f 7072 6963 655f  igher_gas_price_
+00021ae0: 7374 7261 7465 6779 2877 333a 2022 5765  strategy(w3: "We
+00021af0: 6233 222c 2074 786e 3a20 5478 5061 7261  b3", txn: TxPara
+00021b00: 6d73 2920 2d3e 2057 6569 3a0a 2020 2020  ms) -> Wei:.    
+00021b10: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+00021b20: 776f 5f67 7765 695f 696e 5f77 6569 0a0a  wo_gwei_in_wei..
+00021b30: 2020 2020 2020 2020 7733 2e65 7468 2e73          w3.eth.s
+00021b40: 6574 5f67 6173 5f70 7269 6365 5f73 7472  et_gas_price_str
+00021b50: 6174 6567 7928 6869 6768 6572 5f67 6173  ategy(higher_gas
+00021b60: 5f70 7269 6365 5f73 7472 6174 6567 7929  _price_strategy)
+00021b70: 0a0a 2020 2020 2020 2020 7478 6e5f 7061  ..        txn_pa
+00021b80: 7261 6d73 2e70 6f70 2822 6761 7350 7269  rams.pop("gasPri
+00021b90: 6365 2229 0a20 2020 2020 2020 2072 6570  ce").        rep
+00021ba0: 6c61 6365 5f74 786e 5f68 6173 6820 3d20  lace_txn_hash = 
+00021bb0: 7733 2e65 7468 2e72 6570 6c61 6365 5f74  w3.eth.replace_t
+00021bc0: 7261 6e73 6163 7469 6f6e 2874 786e 5f68  ransaction(txn_h
+00021bd0: 6173 682c 2074 786e 5f70 6172 616d 7329  ash, txn_params)
+00021be0: 0a20 2020 2020 2020 2072 6570 6c61 6365  .        replace
+00021bf0: 5f74 786e 203d 2077 332e 6574 682e 6765  _txn = w3.eth.ge
+00021c00: 745f 7472 616e 7361 6374 696f 6e28 7265  t_transaction(re
+00021c10: 706c 6163 655f 7478 6e5f 6861 7368 290a  place_txn_hash).
+00021c20: 2020 2020 2020 2020 6173 7365 7274 2028          assert (
+00021c30: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
+00021c40: 6c61 6365 5f74 786e 5b22 6761 7350 7269  lace_txn["gasPri
+00021c50: 6365 225d 203d 3d20 7477 6f5f 6777 6569  ce"] == two_gwei
+00021c60: 5f69 6e5f 7765 690a 2020 2020 2020 2020  _in_wei.        
+00021c70: 2920 2023 2053 7472 6174 6567 7920 7072  )  # Strategy pr
+00021c80: 6f76 6964 6573 2068 6967 6865 7220 6761  ovides higher ga
+00021c90: 7320 7072 6963 650a 2020 2020 2020 2020  s price.        
+00021ca0: 7733 2e65 7468 2e73 6574 5f67 6173 5f70  w3.eth.set_gas_p
+00021cb0: 7269 6365 5f73 7472 6174 6567 7928 4e6f  rice_strategy(No
+00021cc0: 6e65 2920 2023 2072 6573 6574 2073 7472  ne)  # reset str
+00021cd0: 6174 6567 790a 0a20 2020 2040 666c 616b  ategy..    @flak
+00021ce0: 795f 6765 7468 5f64 6576 5f6d 696e 696e  y_geth_dev_minin
+00021cf0: 670a 2020 2020 6465 6620 7465 7374 5f65  g.    def test_e
+00021d00: 7468 5f72 6570 6c61 6365 5f74 7261 6e73  th_replace_trans
+00021d10: 6163 7469 6f6e 5f67 6173 5f70 7269 6365  action_gas_price
+00021d20: 5f64 6566 6175 6c74 696e 675f 7374 7261  _defaulting_stra
+00021d30: 7465 6779 5f6c 6f77 6572 280a 2020 2020  tegy_lower(.    
+00021d40: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
+00021d50: 6562 3322 2c20 756e 6c6f 636b 6564 5f61  eb3", unlocked_a
+00021d60: 6363 6f75 6e74 3a20 4368 6563 6b73 756d  ccount: Checksum
+00021d70: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
+00021d80: 204e 6f6e 653a 0a20 2020 2020 2020 2067   None:.        g
+00021d90: 6173 5f70 7269 6365 203d 2077 332e 746f  as_price = w3.to
+00021da0: 5f77 6569 2832 2c20 2267 7765 6922 290a  _wei(2, "gwei").
+00021db0: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
+00021dc0: 616d 733a 2054 7850 6172 616d 7320 3d20  ams: TxParams = 
+00021dd0: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
+00021de0: 726f 6d22 3a20 756e 6c6f 636b 6564 5f61  rom": unlocked_a
+00021df0: 6363 6f75 6e74 2c0a 2020 2020 2020 2020  ccount,.        
+00021e00: 2020 2020 2274 6f22 3a20 756e 6c6f 636b      "to": unlock
+00021e10: 6564 5f61 6363 6f75 6e74 2c0a 2020 2020  ed_account,.    
+00021e20: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
+00021e30: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
+00021e40: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
+00021e50: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
+00021e60: 6761 7350 7269 6365 223a 2067 6173 5f70  gasPrice": gas_p
+00021e70: 7269 6365 2c0a 2020 2020 2020 2020 7d0a  rice,.        }.
+00021e80: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+00021e90: 203d 2077 332e 6574 682e 7365 6e64 5f74   = w3.eth.send_t
+00021ea0: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+00021eb0: 6172 616d 7329 0a0a 2020 2020 2020 2020  arams)..        
+00021ec0: 6465 6620 6c6f 7765 725f 6761 735f 7072  def lower_gas_pr
+00021ed0: 6963 655f 7374 7261 7465 6779 2877 333a  ice_strategy(w3:
+00021ee0: 2022 5765 6233 222c 2074 786e 3a20 5478   "Web3", txn: Tx
+00021ef0: 5061 7261 6d73 2920 2d3e 2057 6569 3a0a  Params) -> Wei:.
+00021f00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00021f10: 726e 2077 332e 746f 5f77 6569 2831 2c20  rn w3.to_wei(1, 
+00021f20: 2267 7765 6922 290a 0a20 2020 2020 2020  "gwei")..       
+00021f30: 2077 332e 6574 682e 7365 745f 6761 735f   w3.eth.set_gas_
+00021f40: 7072 6963 655f 7374 7261 7465 6779 286c  price_strategy(l
+00021f50: 6f77 6572 5f67 6173 5f70 7269 6365 5f73  ower_gas_price_s
+00021f60: 7472 6174 6567 7929 0a0a 2020 2020 2020  trategy)..      
+00021f70: 2020 7478 6e5f 7061 7261 6d73 2e70 6f70    txn_params.pop
+00021f80: 2822 6761 7350 7269 6365 2229 0a20 2020  ("gasPrice").   
+00021f90: 2020 2020 2072 6570 6c61 6365 5f74 786e       replace_txn
+00021fa0: 5f68 6173 6820 3d20 7733 2e65 7468 2e72  _hash = w3.eth.r
+00021fb0: 6570 6c61 6365 5f74 7261 6e73 6163 7469  eplace_transacti
+00021fc0: 6f6e 2874 786e 5f68 6173 682c 2074 786e  on(txn_hash, txn
+00021fd0: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
+00021fe0: 2072 6570 6c61 6365 5f74 786e 203d 2077   replace_txn = w
+00021ff0: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
+00022000: 6374 696f 6e28 7265 706c 6163 655f 7478  ction(replace_tx
+00022010: 6e5f 6861 7368 290a 2020 2020 2020 2020  n_hash).        
+00022020: 2320 5374 7261 7465 6779 2070 726f 7669  # Strategy provi
+00022030: 6465 7320 6c6f 7765 7220 6761 7320 7072  des lower gas pr
+00022040: 6963 6520 2d20 6d69 6e69 6d75 6d20 7072  ice - minimum pr
+00022050: 6566 6572 7265 640a 2020 2020 2020 2020  eferred.        
+00022060: 6173 7365 7274 2072 6570 6c61 6365 5f74  assert replace_t
+00022070: 786e 5b22 6761 7350 7269 6365 225d 203d  xn["gasPrice"] =
+00022080: 3d20 6d61 7468 2e63 6569 6c28 6761 735f  = math.ceil(gas_
+00022090: 7072 6963 6520 2a20 312e 3132 3529 0a20  price * 1.125). 
+000220a0: 2020 2020 2020 2077 332e 6574 682e 7365         w3.eth.se
+000220b0: 745f 6761 735f 7072 6963 655f 7374 7261  t_gas_price_stra
+000220c0: 7465 6779 284e 6f6e 6529 2020 2320 7265  tegy(None)  # re
+000220d0: 7365 7420 7374 7261 7465 6779 0a0a 2020  set strategy..  
+000220e0: 2020 6465 6620 7465 7374 5f65 7468 5f6d    def test_eth_m
+000220f0: 6f64 6966 795f 7472 616e 7361 6374 696f  odify_transactio
+00022100: 6e5f 6c65 6761 6379 280a 2020 2020 2020  n_legacy(.      
+00022110: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+00022120: 3322 2c20 756e 6c6f 636b 6564 5f61 6363  3", unlocked_acc
+00022130: 6f75 6e74 3a20 4368 6563 6b73 756d 4164  ount: ChecksumAd
+00022140: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
+00022150: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
+00022160: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+00022170: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00022180: 2020 2266 726f 6d22 3a20 756e 6c6f 636b    "from": unlock
+00022190: 6564 5f61 6363 6f75 6e74 2c0a 2020 2020  ed_account,.    
+000221a0: 2020 2020 2020 2020 2274 6f22 3a20 756e          "to": un
+000221b0: 6c6f 636b 6564 5f61 6363 6f75 6e74 2c0a  locked_account,.
+000221c0: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+000221d0: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
+000221e0: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
+000221f0: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
+00022200: 2020 2022 6761 7350 7269 6365 223a 2077     "gasPrice": w
+00022210: 332e 746f 5f77 6569 280a 2020 2020 2020  3.to_wei(.      
+00022220: 2020 2020 2020 2020 2020 312c 2022 6777            1, "gw
+00022230: 6569 220a 2020 2020 2020 2020 2020 2020  ei".            
+00022240: 292c 2020 2320 6d75 7374 2062 6520 6772  ),  # must be gr
+00022250: 6561 7465 7220 7468 616e 2062 6173 655f  eater than base_
+00022260: 6665 6520 706f 7374 204c 6f6e 646f 6e0a  fee post London.
+00022270: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00022280: 2020 7478 6e5f 6861 7368 203d 2077 332e    txn_hash = w3.
+00022290: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+000222a0: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+000222b0: 0a0a 2020 2020 2020 2020 6d6f 6469 6669  ..        modifi
+000222c0: 6564 5f74 786e 5f68 6173 6820 3d20 7733  ed_txn_hash = w3
+000222d0: 2e65 7468 2e6d 6f64 6966 795f 7472 616e  .eth.modify_tran
+000222e0: 7361 6374 696f 6e28 0a20 2020 2020 2020  saction(.       
+000222f0: 2020 2020 2074 786e 5f68 6173 682c 2067       txn_hash, g
+00022300: 6173 5072 6963 653d 2863 6173 7428 696e  asPrice=(cast(in
+00022310: 742c 2074 786e 5f70 6172 616d 735b 2267  t, txn_params["g
+00022320: 6173 5072 6963 6522 5d29 202a 2032 292c  asPrice"]) * 2),
+00022330: 2076 616c 7565 3d32 0a20 2020 2020 2020   value=2.       
+00022340: 2029 0a20 2020 2020 2020 206d 6f64 6966   ).        modif
+00022350: 6965 645f 7478 6e20 3d20 7733 2e65 7468  ied_txn = w3.eth
+00022360: 2e67 6574 5f74 7261 6e73 6163 7469 6f6e  .get_transaction
+00022370: 286d 6f64 6966 6965 645f 7478 6e5f 6861  (modified_txn_ha
+00022380: 7368 290a 0a20 2020 2020 2020 2061 7373  sh)..        ass
+00022390: 6572 7420 6973 5f73 616d 655f 6164 6472  ert is_same_addr
+000223a0: 6573 7328 0a20 2020 2020 2020 2020 2020  ess(.           
+000223b0: 206d 6f64 6966 6965 645f 7478 6e5b 2266   modified_txn["f
+000223c0: 726f 6d22 5d2c 2063 6173 7428 4368 6563  rom"], cast(Chec
+000223d0: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
+000223e0: 5f70 6172 616d 735b 2266 726f 6d22 5d29  _params["from"])
+000223f0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00022400: 2020 2061 7373 6572 7420 6973 5f73 616d     assert is_sam
+00022410: 655f 6164 6472 6573 7328 0a20 2020 2020  e_address(.     
+00022420: 2020 2020 2020 206d 6f64 6966 6965 645f         modified_
+00022430: 7478 6e5b 2274 6f22 5d2c 2063 6173 7428  txn["to"], cast(
+00022440: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+00022450: 2074 786e 5f70 6172 616d 735b 2274 6f22   txn_params["to"
+00022460: 5d29 0a20 2020 2020 2020 2029 0a20 2020  ]).        ).   
+00022470: 2020 2020 2061 7373 6572 7420 6d6f 6469       assert modi
+00022480: 6669 6564 5f74 786e 5b22 7661 6c75 6522  fied_txn["value"
+00022490: 5d20 3d3d 2032 0a20 2020 2020 2020 2061  ] == 2.        a
+000224a0: 7373 6572 7420 6d6f 6469 6669 6564 5f74  ssert modified_t
+000224b0: 786e 5b22 6761 7322 5d20 3d3d 2032 3130  xn["gas"] == 210
+000224c0: 3030 0a20 2020 2020 2020 2061 7373 6572  00.        asser
+000224d0: 7420 6d6f 6469 6669 6564 5f74 786e 5b22  t modified_txn["
+000224e0: 6761 7350 7269 6365 225d 203d 3d20 6361  gasPrice"] == ca
+000224f0: 7374 2869 6e74 2c20 7478 6e5f 7061 7261  st(int, txn_para
+00022500: 6d73 5b22 6761 7350 7269 6365 225d 2920  ms["gasPrice"]) 
+00022510: 2a20 320a 0a20 2020 2064 6566 2074 6573  * 2..    def tes
+00022520: 745f 6574 685f 6d6f 6469 6679 5f74 7261  t_eth_modify_tra
+00022530: 6e73 6163 7469 6f6e 280a 2020 2020 2020  nsaction(.      
+00022540: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+00022550: 3322 2c20 756e 6c6f 636b 6564 5f61 6363  3", unlocked_acc
+00022560: 6f75 6e74 3a20 4368 6563 6b73 756d 4164  ount: ChecksumAd
+00022570: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
+00022580: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
+00022590: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+000225a0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+000225b0: 2020 2266 726f 6d22 3a20 756e 6c6f 636b    "from": unlock
+000225c0: 6564 5f61 6363 6f75 6e74 2c0a 2020 2020  ed_account,.    
+000225d0: 2020 2020 2020 2020 2274 6f22 3a20 756e          "to": un
+000225e0: 6c6f 636b 6564 5f61 6363 6f75 6e74 2c0a  locked_account,.
+000225f0: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+00022600: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
+00022610: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
+00022620: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
+00022630: 2020 2022 6d61 7850 7269 6f72 6974 7946     "maxPriorityF
+00022640: 6565 5065 7247 6173 223a 2077 332e 746f  eePerGas": w3.to
+00022650: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
+00022660: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
+00022670: 7846 6565 5065 7247 6173 223a 2077 332e  xFeePerGas": w3.
+00022680: 746f 5f77 6569 2832 2c20 2267 7765 6922  to_wei(2, "gwei"
+00022690: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
+000226a0: 2020 2020 2074 786e 5f68 6173 6820 3d20       txn_hash = 
+000226b0: 7733 2e65 7468 2e73 656e 645f 7472 616e  w3.eth.send_tran
+000226c0: 7361 6374 696f 6e28 7478 6e5f 7061 7261  saction(txn_para
+000226d0: 6d73 290a 0a20 2020 2020 2020 206d 6f64  ms)..        mod
+000226e0: 6966 6965 645f 7478 6e5f 6861 7368 203d  ified_txn_hash =
+000226f0: 2077 332e 6574 682e 6d6f 6469 6679 5f74   w3.eth.modify_t
+00022700: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
+00022710: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+00022720: 2c0a 2020 2020 2020 2020 2020 2020 7661  ,.            va
+00022730: 6c75 653d 322c 0a20 2020 2020 2020 2020  lue=2,.         
+00022740: 2020 206d 6178 5072 696f 7269 7479 4665     maxPriorityFe
+00022750: 6550 6572 4761 733d 2863 6173 7428 5765  ePerGas=(cast(We
+00022760: 692c 2074 786e 5f70 6172 616d 735b 226d  i, txn_params["m
+00022770: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
+00022780: 4761 7322 5d29 202a 2032 292c 0a20 2020  Gas"]) * 2),.   
+00022790: 2020 2020 2020 2020 206d 6178 4665 6550           maxFeeP
+000227a0: 6572 4761 733d 2863 6173 7428 5765 692c  erGas=(cast(Wei,
+000227b0: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
+000227c0: 4665 6550 6572 4761 7322 5d29 202a 2032  FeePerGas"]) * 2
+000227d0: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
+000227e0: 2020 2020 206d 6f64 6966 6965 645f 7478       modified_tx
+000227f0: 6e20 3d20 7733 2e65 7468 2e67 6574 5f74  n = w3.eth.get_t
+00022800: 7261 6e73 6163 7469 6f6e 286d 6f64 6966  ransaction(modif
+00022810: 6965 645f 7478 6e5f 6861 7368 290a 0a20  ied_txn_hash).. 
+00022820: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00022830: 5f73 616d 655f 6164 6472 6573 7328 0a20  _same_address(. 
+00022840: 2020 2020 2020 2020 2020 206d 6f64 6966             modif
+00022850: 6965 645f 7478 6e5b 2266 726f 6d22 5d2c  ied_txn["from"],
+00022860: 2063 6173 7428 4368 6563 6b73 756d 4164   cast(ChecksumAd
+00022870: 6472 6573 732c 2074 786e 5f70 6172 616d  dress, txn_param
+00022880: 735b 2266 726f 6d22 5d29 0a20 2020 2020  s["from"]).     
+00022890: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
+000228a0: 6572 7420 6973 5f73 616d 655f 6164 6472  ert is_same_addr
+000228b0: 6573 7328 0a20 2020 2020 2020 2020 2020  ess(.           
+000228c0: 206d 6f64 6966 6965 645f 7478 6e5b 2274   modified_txn["t
+000228d0: 6f22 5d2c 2063 6173 7428 4368 6563 6b73  o"], cast(Checks
+000228e0: 756d 4164 6472 6573 732c 2074 786e 5f70  umAddress, txn_p
+000228f0: 6172 616d 735b 2274 6f22 5d29 0a20 2020  arams["to"]).   
+00022900: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
+00022910: 7373 6572 7420 6d6f 6469 6669 6564 5f74  ssert modified_t
+00022920: 786e 5b22 7661 6c75 6522 5d20 3d3d 2032  xn["value"] == 2
+00022930: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00022940: 6d6f 6469 6669 6564 5f74 786e 5b22 6761  modified_txn["ga
+00022950: 7322 5d20 3d3d 2032 3130 3030 0a20 2020  s"] == 21000.   
+00022960: 2020 2020 2061 7373 6572 7420 280a 2020       assert (.  
+00022970: 2020 2020 2020 2020 2020 6d6f 6469 6669            modifi
+00022980: 6564 5f74 786e 5b22 6d61 7850 7269 6f72  ed_txn["maxPrior
+00022990: 6974 7946 6565 5065 7247 6173 225d 0a20  ityFeePerGas"]. 
+000229a0: 2020 2020 2020 2020 2020 203d 3d20 6361             == ca
+000229b0: 7374 2857 6569 2c20 7478 6e5f 7061 7261  st(Wei, txn_para
+000229c0: 6d73 5b22 6d61 7850 7269 6f72 6974 7946  ms["maxPriorityF
+000229d0: 6565 5065 7247 6173 225d 2920 2a20 320a  eePerGas"]) * 2.
+000229e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000229f0: 2020 6173 7365 7274 206d 6f64 6966 6965    assert modifie
+00022a00: 645f 7478 6e5b 226d 6178 4665 6550 6572  d_txn["maxFeePer
+00022a10: 4761 7322 5d20 3d3d 2063 6173 7428 5765  Gas"] == cast(We
+00022a20: 692c 2074 786e 5f70 6172 616d 735b 226d  i, txn_params["m
+00022a30: 6178 4665 6550 6572 4761 7322 5d29 202a  axFeePerGas"]) *
+00022a40: 2032 0a0a 2020 2020 6465 6620 7465 7374   2..    def test
+00022a50: 5f65 7468 5f73 656e 645f 7261 775f 7472  _eth_send_raw_tr
+00022a60: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+00022a70: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
+00022a80: 6233 222c 2075 6e6c 6f63 6b65 645f 6163  b3", unlocked_ac
+00022a90: 636f 756e 743a 2043 6865 636b 7375 6d41  count: ChecksumA
+00022aa0: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
+00022ab0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7369  None:.        si
+00022ac0: 676e 6564 5f74 7820 3d20 7733 2e65 7468  gned_tx = w3.eth
+00022ad0: 2e61 6363 6f75 6e74 2e73 6967 6e5f 7472  .account.sign_tr
+00022ae0: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+00022af0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+00022b00: 2020 2020 2020 2020 2022 746f 223a 2022           "to": "
+00022b10: 3078 3030 3030 3030 3030 3030 3030 3030  0x00000000000000
+00022b20: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00022b30: 3030 3030 3030 3030 3030 222c 0a20 2020  0000000000",.   
+00022b40: 2020 2020 2020 2020 2020 2020 2022 7661               "va
+00022b50: 6c75 6522 3a20 302c 0a20 2020 2020 2020  lue": 0,.       
+00022b60: 2020 2020 2020 2020 2022 6e6f 6e63 6522           "nonce"
+00022b70: 3a20 7733 2e65 7468 2e67 6574 5f74 7261  : w3.eth.get_tra
+00022b80: 6e73 6163 7469 6f6e 5f63 6f75 6e74 2875  nsaction_count(u
+00022b90: 6e6c 6f63 6b65 645f 6163 636f 756e 7429  nlocked_account)
+00022ba0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00022bb0: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
+00022bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022bd0: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
+00022be0: 3130 3030 3030 3030 3030 2c0a 2020 2020  1000000000,.    
+00022bf0: 2020 2020 2020 2020 2020 2020 226d 6178              "max
+00022c00: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+00022c10: 7322 3a20 3130 3030 3030 3030 3030 2c0a  s": 1000000000,.
+00022c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c30: 2263 6861 696e 4964 223a 2031 3331 3237  "chainId": 13127
+00022c40: 3733 3232 3934 3035 3337 2c0a 2020 2020  7322940537,.    
+00022c50: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+00022c60: 2020 2020 2020 2023 2075 6e6c 6f63 6b65         # unlocke
+00022c70: 645f 6163 636f 756e 7420 7072 6976 6174  d_account privat
+00022c80: 6520 6b65 793a 0a20 2020 2020 2020 2020  e key:.         
+00022c90: 2020 2022 3078 3339 3266 3633 6137 3962     "0x392f63a79b
+00022ca0: 3166 6638 3737 3438 3435 6633 6661 3639  1ff8774845f3fa69
+00022cb0: 6465 3461 3133 3830 3061 3539 6537 3038  de4a13800a59e708
+00022cc0: 3366 3531 3837 6631 3535 3866 3037 3937  3f5187f1558f0797
+00022cd0: 6164 3066 3031 222c 0a20 2020 2020 2020  ad0f01",.       
+00022ce0: 2029 0a20 2020 2020 2020 2074 786e 5f68   ).        txn_h
+00022cf0: 6173 6820 3d20 7733 2e65 7468 2e73 656e  ash = w3.eth.sen
+00022d00: 645f 7261 775f 7472 616e 7361 6374 696f  d_raw_transactio
+00022d10: 6e28 7369 676e 6564 5f74 782e 7261 7754  n(signed_tx.rawT
+00022d20: 7261 6e73 6163 7469 6f6e 290a 2020 2020  ransaction).    
+00022d30: 2020 2020 6173 7365 7274 2074 786e 5f68      assert txn_h
+00022d40: 6173 6820 3d3d 2073 6967 6e65 645f 7478  ash == signed_tx
+00022d50: 2e68 6173 680a 0a20 2020 2064 6566 2074  .hash..    def t
+00022d60: 6573 745f 6574 685f 6361 6c6c 2873 656c  est_eth_call(sel
+00022d70: 662c 2077 333a 2022 5765 6233 222c 206d  f, w3: "Web3", m
+00022d80: 6174 685f 636f 6e74 7261 6374 3a20 2243  ath_contract: "C
+00022d90: 6f6e 7472 6163 7422 2920 2d3e 204e 6f6e  ontract") -> Non
+00022da0: 653a 0a20 2020 2020 2020 2063 6f69 6e62  e:.        coinb
+00022db0: 6173 6520 3d20 7733 2e65 7468 2e63 6f69  ase = w3.eth.coi
+00022dc0: 6e62 6173 650a 2020 2020 2020 2020 7478  nbase.        tx
+00022dd0: 6e5f 7061 7261 6d73 203d 206d 6174 685f  n_params = math_
+00022de0: 636f 6e74 7261 6374 2e5f 7072 6570 6172  contract._prepar
+00022df0: 655f 7472 616e 7361 6374 696f 6e28 0a20  e_transaction(. 
+00022e00: 2020 2020 2020 2020 2020 2066 6e5f 6e61             fn_na
+00022e10: 6d65 3d22 6164 6422 2c0a 2020 2020 2020  me="add",.      
+00022e20: 2020 2020 2020 666e 5f61 7267 733d 2837        fn_args=(7
+00022e30: 2c20 3131 292c 0a20 2020 2020 2020 2020  , 11),.         
+00022e40: 2020 2074 7261 6e73 6163 7469 6f6e 3d7b     transaction={
+00022e50: 2266 726f 6d22 3a20 636f 696e 6261 7365  "from": coinbase
+00022e60: 2c20 2274 6f22 3a20 6d61 7468 5f63 6f6e  , "to": math_con
+00022e70: 7472 6163 742e 6164 6472 6573 737d 2c0a  tract.address},.
+00022e80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00022e90: 2020 6361 6c6c 5f72 6573 756c 7420 3d20    call_result = 
+00022ea0: 7733 2e65 7468 2e63 616c 6c28 7478 6e5f  w3.eth.call(txn_
+00022eb0: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+00022ec0: 6173 7365 7274 2069 735f 7374 7269 6e67  assert is_string
+00022ed0: 2863 616c 6c5f 7265 7375 6c74 290a 2020  (call_result).  
+00022ee0: 2020 2020 2020 2872 6573 756c 742c 2920        (result,) 
+00022ef0: 3d20 7733 2e63 6f64 6563 2e64 6563 6f64  = w3.codec.decod
+00022f00: 6528 5b22 7569 6e74 3235 3622 5d2c 2063  e(["uint256"], c
+00022f10: 616c 6c5f 7265 7375 6c74 290a 2020 2020  all_result).    
+00022f20: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
+00022f30: 7420 3d3d 2031 380a 0a20 2020 2064 6566  t == 18..    def
+00022f40: 2074 6573 745f 6574 685f 6361 6c6c 5f77   test_eth_call_w
+00022f50: 6974 685f 6f76 6572 7269 6465 5f63 6f64  ith_override_cod
+00022f60: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+00022f70: 2077 333a 2022 5765 6233 222c 2072 6576   w3: "Web3", rev
+00022f80: 6572 745f 636f 6e74 7261 6374 3a20 2243  ert_contract: "C
+00022f90: 6f6e 7472 6163 7422 0a20 2020 2029 202d  ontract".    ) -
+00022fa0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00022fb0: 636f 696e 6261 7365 203d 2077 332e 6574  coinbase = w3.et
+00022fc0: 682e 636f 696e 6261 7365 0a20 2020 2020  h.coinbase.     
+00022fd0: 2020 2074 786e 5f70 6172 616d 7320 3d20     txn_params = 
+00022fe0: 7265 7665 7274 5f63 6f6e 7472 6163 742e  revert_contract.
+00022ff0: 5f70 7265 7061 7265 5f74 7261 6e73 6163  _prepare_transac
+00023000: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+00023010: 2020 666e 5f6e 616d 653d 226e 6f72 6d61    fn_name="norma
+00023020: 6c46 756e 6374 696f 6e22 2c0a 2020 2020  lFunction",.    
+00023030: 2020 2020 2020 2020 7472 616e 7361 6374          transact
+00023040: 696f 6e3d 7b22 6672 6f6d 223a 2063 6f69  ion={"from": coi
+00023050: 6e62 6173 652c 2022 746f 223a 2072 6576  nbase, "to": rev
+00023060: 6572 745f 636f 6e74 7261 6374 2e61 6464  ert_contract.add
+00023070: 7265 7373 7d2c 0a20 2020 2020 2020 2029  ress},.        )
+00023080: 0a20 2020 2020 2020 2063 616c 6c5f 7265  .        call_re
+00023090: 7375 6c74 203d 2077 332e 6574 682e 6361  sult = w3.eth.ca
+000230a0: 6c6c 2874 786e 5f70 6172 616d 7329 0a20  ll(txn_params). 
+000230b0: 2020 2020 2020 2028 7265 7375 6c74 2c29         (result,)
+000230c0: 203d 2077 332e 636f 6465 632e 6465 636f   = w3.codec.deco
+000230d0: 6465 285b 2262 6f6f 6c22 5d2c 2063 616c  de(["bool"], cal
+000230e0: 6c5f 7265 7375 6c74 290a 2020 2020 2020  l_result).      
+000230f0: 2020 6173 7365 7274 2072 6573 756c 7420    assert result 
+00023100: 6973 2054 7275 650a 0a20 2020 2020 2020  is True..       
+00023110: 2023 206f 7665 7272 6964 6520 7275 6e74   # override runt
+00023120: 696d 6520 6279 7465 636f 6465 3a20 606e  ime bytecode: `n
+00023130: 6f72 6d61 6c46 756e 6374 696f 6e60 2072  ormalFunction` r
+00023140: 6574 7572 6e73 2060 6661 6c73 6560 0a20  eturns `false`. 
+00023150: 2020 2020 2020 206f 7665 7272 6964 655f         override_
+00023160: 636f 6465 203d 2048 6578 5374 7228 0a20  code = HexStr(. 
+00023170: 2020 2020 2020 2020 2020 2022 3078 3630             "0x60
+00023180: 3830 3630 3430 3532 3334 3830 3135 3630  8060405234801560
+00023190: 3066 3537 3630 3030 3830 6664 3562 3530  0f57600080fd5b50
+000231a0: 3630 3034 3336 3130 3630 3363 3537 3630  60043610603c5760
+000231b0: 3030 3335 3630 6530 3163 3830 3633 3138  003560e01c806318
+000231c0: 3563 3338 6134 3134 3630 3431 3537 3830  5c38a41460415780
+000231d0: 3633 6330 3661 3937 6362 3134 3630 3439  63c06a97cb146049
+000231e0: 3537 3830 3633 6436 3765 3462 3834 3134  578063d67e4b8414
+000231f0: 3630 3531 3537 3562 3630 3030 3830 6664  6051575b600080fd
+00023200: 3562 3630 3437 3630 3731 3536 3562 3030  5b60476071565b00
+00023210: 3562 3630 3466 3630 6466 3536 3562 3030  5b604f60df565b00
+00023220: 3562 3630 3537 3630 6534 3536 3562 3630  5b605760e4565b60
+00023230: 3430 3531 3830 3832 3135 3135 3135 3135  4051808215151515
+00023240: 3831 3532 3630 3230 3031 3931 3530 3530  8152602001915050
+00023250: 3630 3430 3531 3830 3931 3033 3930 6633  60405180910390f3
+00023260: 3562 3630 3430 3531 3766 3038 6333 3739  5b6040517f08c379
+00023270: 6130 3030 3030 3030 3030 3030 3030 3030  a000000000000000
+00023280: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00023290: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+000232a0: 3030 3030 3030 3030 3030 3831 3532 3630  0000000000815260
+000232b0: 3034 3031 3830 3830 3630 3230 3031 3832  0401808060200182
+000232c0: 3831 3033 3832 3532 3630 3162 3831 3532  81038252601b8152
+000232d0: 3630 3230 3031 3830 3766 3436 3735 3665  602001807f46756e
+000232e0: 3633 3734 3639 3666 3665 3230 3638 3631  6374696f6e206861
+000232f0: 3733 3230 3632 3635 3635 3665 3230 3732  73206265656e2072
+00023300: 3635 3736 3635 3732 3734 3635 3634 3265  657665727465642e
+00023310: 3030 3030 3030 3030 3030 3831 3532 3530  0000000000815250
+00023320: 3630 3230 3031 3931 3530 3530 3630 3430  6020019150506040
+00023330: 3531 3830 3931 3033 3930 6664 3562 3630  5180910390fd5b60
+00023340: 3030 3830 6664 3562 3630 3030 3830 3930  0080fd5b60008090
+00023350: 3530 3930 3536 6665 6132 3634 3639 3730  509056fea2646970
+00023360: 3636 3733 3538 3232 3132 3230 6262 3731  667358221220bb71
+00023370: 6539 6539 6132 6532 3731 6364 3066 6265  e9e9a2e271cd0fbe
+00023380: 3833 3335 3234 6133 6561 3637 6466 3935  833524a3ea67df95
+00023390: 6632 3565 6131 3361 6566 3562 3061 3736  f25ea13aef5b0a76
+000233a0: 3166 6135 3262 3533 3866 3130 3634 3733  1fa52b538f106473
+000233b0: 3666 3663 3633 3433 3030 3036 3031 3030  6f6c634300060100
+000233c0: 3333 2220 2023 206e 6f71 613a 2045 3530  33"  # noqa: E50
+000233d0: 310a 2020 2020 2020 2020 290a 2020 2020  1.        ).    
+000233e0: 2020 2020 6361 6c6c 5f72 6573 756c 7420      call_result 
+000233f0: 3d20 7733 2e65 7468 2e63 616c 6c28 0a20  = w3.eth.call(. 
+00023400: 2020 2020 2020 2020 2020 2074 786e 5f70             txn_p
+00023410: 6172 616d 732c 2022 6c61 7465 7374 222c  arams, "latest",
+00023420: 207b 7265 7665 7274 5f63 6f6e 7472 6163   {revert_contrac
+00023430: 742e 6164 6472 6573 733a 207b 2263 6f64  t.address: {"cod
+00023440: 6522 3a20 6f76 6572 7269 6465 5f63 6f64  e": override_cod
+00023450: 657d 7d0a 2020 2020 2020 2020 290a 2020  e}}.        ).  
+00023460: 2020 2020 2020 2872 6573 756c 742c 2920        (result,) 
+00023470: 3d20 7733 2e63 6f64 6563 2e64 6563 6f64  = w3.codec.decod
+00023480: 6528 5b22 626f 6f6c 225d 2c20 6361 6c6c  e(["bool"], call
+00023490: 5f72 6573 756c 7429 0a20 2020 2020 2020  _result).       
+000234a0: 2061 7373 6572 7420 7265 7375 6c74 2069   assert result i
+000234b0: 7320 4661 6c73 650a 0a20 2020 2020 2020  s False..       
+000234c0: 2023 2074 6573 7420 6279 7465 730a 0a20   # test bytes.. 
+000234d0: 2020 2020 2020 2062 7974 6573 5f63 616c         bytes_cal
+000234e0: 6c5f 7265 7375 6c74 203d 2077 332e 6574  l_result = w3.et
+000234f0: 682e 6361 6c6c 280a 2020 2020 2020 2020  h.call(.        
+00023500: 2020 2020 7478 6e5f 7061 7261 6d73 2c0a      txn_params,.
+00023510: 2020 2020 2020 2020 2020 2020 226c 6174              "lat
+00023520: 6573 7422 2c0a 2020 2020 2020 2020 2020  est",.          
+00023530: 2020 7b72 6576 6572 745f 636f 6e74 7261    {revert_contra
+00023540: 6374 2e61 6464 7265 7373 3a20 7b22 636f  ct.address: {"co
+00023550: 6465 223a 2074 6f5f 6279 7465 7328 6865  de": to_bytes(he
+00023560: 7873 7472 3d6f 7665 7272 6964 655f 636f  xstr=override_co
+00023570: 6465 297d 7d2c 0a20 2020 2020 2020 2029  de)}},.        )
+00023580: 0a20 2020 2020 2020 2028 6279 7465 735f  .        (bytes_
+00023590: 7265 7375 6c74 2c29 203d 2077 332e 636f  result,) = w3.co
+000235a0: 6465 632e 6465 636f 6465 285b 2262 6f6f  dec.decode(["boo
+000235b0: 6c22 5d2c 2062 7974 6573 5f63 616c 6c5f  l"], bytes_call_
+000235c0: 7265 7375 6c74 290a 2020 2020 2020 2020  result).        
+000235d0: 6173 7365 7274 2062 7974 6573 5f72 6573  assert bytes_res
+000235e0: 756c 7420 6973 2046 616c 7365 0a0a 2020  ult is False..  
+000235f0: 2020 4070 7974 6573 742e 6d61 726b 2e70    @pytest.mark.p
+00023600: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
+00023610: 2020 2020 2270 6172 616d 7322 2c0a 2020      "params",.  
+00023620: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
+00023630: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00023640: 2020 2020 2020 226e 6f6e 6365 223a 2031        "nonce": 1
+00023650: 2c20 2023 2069 6e74 0a20 2020 2020 2020  ,  # int.       
+00023660: 2020 2020 2020 2020 2022 6261 6c61 6e63           "balanc
+00023670: 6522 3a20 312c 2020 2320 696e 740a 2020  e": 1,  # int.  
+00023680: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00023690: 6f64 6522 3a20 4865 7853 7472 2822 3078  ode": HexStr("0x
+000236a0: 2229 2c20 2023 2048 6578 5374 720a 2020  "),  # HexStr.  
+000236b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000236c0: 7769 7468 2073 7461 7465 0a20 2020 2020  with state.     
+000236d0: 2020 2020 2020 2020 2020 2022 7374 6174             "stat
+000236e0: 6522 3a20 7b48 6578 5374 7228 6622 3078  e": {HexStr(f"0x
+000236f0: 7b27 3030 2720 2a20 3332 7d22 293a 2048  {'00' * 32}"): H
+00023700: 6578 5374 7228 6622 3078 7b27 3030 2720  exStr(f"0x{'00' 
+00023710: 2a20 3332 7d22 297d 2c0a 2020 2020 2020  * 32}")},.      
+00023720: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+00023730: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+00023740: 2020 2020 2020 2022 6e6f 6e63 6522 3a20         "nonce": 
+00023750: 4865 7853 7472 2822 3078 3122 292c 2020  HexStr("0x1"),  
+00023760: 2320 4865 7853 7472 0a20 2020 2020 2020  # HexStr.       
+00023770: 2020 2020 2020 2020 2022 6261 6c61 6e63           "balanc
+00023780: 6522 3a20 4865 7853 7472 2822 3078 3122  e": HexStr("0x1"
+00023790: 292c 2020 2320 4865 7853 7472 0a20 2020  ),  # HexStr.   
+000237a0: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+000237b0: 6465 223a 2062 225c 7830 3022 2c20 2023  de": b"\x00",  #
+000237c0: 2062 7974 6573 0a20 2020 2020 2020 2020   bytes.         
+000237d0: 2020 2020 2020 2023 2077 6974 6820 7374         # with st
+000237e0: 6174 6544 6966 660a 2020 2020 2020 2020  ateDiff.        
+000237f0: 2020 2020 2020 2020 2273 7461 7465 4469          "stateDi
+00023800: 6666 223a 207b 4865 7853 7472 2866 2230  ff": {HexStr(f"0
+00023810: 787b 2730 3027 202a 2033 327d 2229 3a20  x{'00' * 32}"): 
+00023820: 4865 7853 7472 2866 2230 787b 2730 3027  HexStr(f"0x{'00'
+00023830: 202a 2033 327d 2229 7d2c 0a20 2020 2020   * 32}")},.     
+00023840: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00023850: 2020 292c 0a20 2020 2029 0a20 2020 2064    ),.    ).    d
+00023860: 6566 2074 6573 745f 6574 685f 6361 6c6c  ef test_eth_call
+00023870: 5f77 6974 685f 6f76 6572 7269 6465 5f70  _with_override_p
+00023880: 6172 616d 5f74 7970 655f 6368 6563 6b28  aram_type_check(
+00023890: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000238a0: 2020 2020 2020 2077 333a 2022 5765 6233         w3: "Web3
+000238b0: 222c 0a20 2020 2020 2020 206d 6174 685f  ",.        math_
+000238c0: 636f 6e74 7261 6374 3a20 2243 6f6e 7472  contract: "Contr
+000238d0: 6163 7422 2c0a 2020 2020 2020 2020 7061  act",.        pa
+000238e0: 7261 6d73 3a20 5374 6174 654f 7665 7272  rams: StateOverr
+000238f0: 6964 6550 6172 616d 732c 0a20 2020 2029  ideParams,.    )
+00023900: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00023910: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
+00023920: 5061 7261 6d73 203d 207b 2266 726f 6d22  Params = {"from"
+00023930: 3a20 7733 2e65 7468 2e63 6f69 6e62 6173  : w3.eth.coinbas
+00023940: 657d 0a0a 2020 2020 2020 2020 2320 6173  e}..        # as
+00023950: 7365 7274 2064 6f65 7320 6e6f 7420 7261  sert does not ra
+00023960: 6973 650a 2020 2020 2020 2020 7733 2e65  ise.        w3.e
+00023970: 7468 2e63 616c 6c28 7478 6e5f 7061 7261  th.call(txn_para
+00023980: 6d73 2c20 226c 6174 6573 7422 2c20 7b6d  ms, "latest", {m
+00023990: 6174 685f 636f 6e74 7261 6374 2e61 6464  ath_contract.add
+000239a0: 7265 7373 3a20 7061 7261 6d73 7d29 0a0a  ress: params})..
+000239b0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+000239c0: 5f63 616c 6c5f 7769 7468 5f30 5f72 6573  _call_with_0_res
+000239d0: 756c 7428 0a20 2020 2020 2020 2073 656c  ult(.        sel
+000239e0: 662c 2077 333a 2022 5765 6233 222c 206d  f, w3: "Web3", m
+000239f0: 6174 685f 636f 6e74 7261 6374 3a20 2243  ath_contract: "C
+00023a00: 6f6e 7472 6163 7422 0a20 2020 2029 202d  ontract".    ) -
+00023a10: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00023a20: 636f 696e 6261 7365 203d 2077 332e 6574  coinbase = w3.et
+00023a30: 682e 636f 696e 6261 7365 0a20 2020 2020  h.coinbase.     
+00023a40: 2020 2074 786e 5f70 6172 616d 7320 3d20     txn_params = 
+00023a50: 6d61 7468 5f63 6f6e 7472 6163 742e 5f70  math_contract._p
+00023a60: 7265 7061 7265 5f74 7261 6e73 6163 7469  repare_transacti
+00023a70: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+00023a80: 666e 5f6e 616d 653d 2261 6464 222c 0a20  fn_name="add",. 
+00023a90: 2020 2020 2020 2020 2020 2066 6e5f 6172             fn_ar
+00023aa0: 6773 3d28 302c 2030 292c 0a20 2020 2020  gs=(0, 0),.     
+00023ab0: 2020 2020 2020 2074 7261 6e73 6163 7469         transacti
+00023ac0: 6f6e 3d7b 2266 726f 6d22 3a20 636f 696e  on={"from": coin
+00023ad0: 6261 7365 2c20 2274 6f22 3a20 6d61 7468  base, "to": math
+00023ae0: 5f63 6f6e 7472 6163 742e 6164 6472 6573  _contract.addres
+00023af0: 737d 2c0a 2020 2020 2020 2020 290a 2020  s},.        ).  
+00023b00: 2020 2020 2020 6361 6c6c 5f72 6573 756c        call_resul
+00023b10: 7420 3d20 7733 2e65 7468 2e63 616c 6c28  t = w3.eth.call(
+00023b20: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
+00023b30: 2020 2020 6173 7365 7274 2069 735f 7374      assert is_st
+00023b40: 7269 6e67 2863 616c 6c5f 7265 7375 6c74  ring(call_result
+00023b50: 290a 2020 2020 2020 2020 2872 6573 756c  ).        (resul
+00023b60: 742c 2920 3d20 7733 2e63 6f64 6563 2e64  t,) = w3.codec.d
+00023b70: 6563 6f64 6528 5b22 7569 6e74 3235 3622  ecode(["uint256"
+00023b80: 5d2c 2063 616c 6c5f 7265 7375 6c74 290a  ], call_result).
+00023b90: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00023ba0: 6573 756c 7420 3d3d 2030 0a0a 2020 2020  esult == 0..    
+00023bb0: 6465 6620 7465 7374 5f65 7468 5f63 616c  def test_eth_cal
+00023bc0: 6c5f 7265 7665 7274 5f77 6974 685f 6d73  l_revert_with_ms
+00023bd0: 6728 0a20 2020 2020 2020 2073 656c 662c  g(.        self,
+00023be0: 0a20 2020 2020 2020 2077 333a 2022 5765  .        w3: "We
+00023bf0: 6233 222c 0a20 2020 2020 2020 2072 6576  b3",.        rev
+00023c00: 6572 745f 636f 6e74 7261 6374 3a20 2243  ert_contract: "C
+00023c10: 6f6e 7472 6163 7422 2c0a 2020 2020 2020  ontract",.      
+00023c20: 2020 756e 6c6f 636b 6564 5f61 6363 6f75    unlocked_accou
+00023c30: 6e74 3a20 4368 6563 6b73 756d 4164 6472  nt: ChecksumAddr
+00023c40: 6573 732c 0a20 2020 2029 202d 3e20 4e6f  ess,.    ) -> No
+00023c50: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
+00023c60: 7061 7261 6d73 203d 2072 6576 6572 745f  params = revert_
+00023c70: 636f 6e74 7261 6374 2e5f 7072 6570 6172  contract._prepar
+00023c80: 655f 7472 616e 7361 6374 696f 6e28 0a20  e_transaction(. 
+00023c90: 2020 2020 2020 2020 2020 2066 6e5f 6e61             fn_na
+00023ca0: 6d65 3d22 7265 7665 7274 5769 7468 4d65  me="revertWithMe
+00023cb0: 7373 6167 6522 2c0a 2020 2020 2020 2020  ssage",.        
+00023cc0: 2020 2020 7472 616e 7361 6374 696f 6e3d      transaction=
+00023cd0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00023ce0: 2020 2266 726f 6d22 3a20 756e 6c6f 636b    "from": unlock
+00023cf0: 6564 5f61 6363 6f75 6e74 2c0a 2020 2020  ed_account,.    
+00023d00: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+00023d10: 3a20 7265 7665 7274 5f63 6f6e 7472 6163  : revert_contrac
+00023d20: 742e 6164 6472 6573 732c 0a20 2020 2020  t.address,.     
+00023d30: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00023d40: 2020 290a 2020 2020 2020 2020 6461 7461    ).        data
+00023d50: 203d 2022 3078 3038 6333 3739 6130 3030   = "0x08c379a000
+00023d60: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00023d70: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00023d80: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00023d90: 3030 3030 3030 3030 3030 3030 3230 3030  0000000000002000
+00023da0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00023db0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 00023dc0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00023dd0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00023de0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00023df0: 3030 3030 3030 3030 3030 3032 3030 3030  0000000000020000
-00023e00: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00023e10: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00023e20: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00023e30: 3030 3030 3030 3030 3030 3031 6234 3637  000000000001b467
-00023e40: 3536 6536 3337 3436 3936 6636 6532 3036  56e6374696f6e206
-00023e50: 3836 3137 3332 3036 3236 3536 3536 6532  86173206265656e2
-00023e60: 3037 3236 3537 3636 3537 3237 3436 3536  0726576657274656
-00023e70: 3432 6530 3030 3030 3030 3030 3022 2020  42e0000000000"  
-00023e80: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
-00023e90: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-00023ea0: 2e72 6169 7365 7328 0a20 2020 2020 2020  .raises(.       
-00023eb0: 2020 2020 2043 6f6e 7472 6163 744c 6f67       ContractLog
-00023ec0: 6963 4572 726f 722c 206d 6174 6368 3d22  icError, match="
-00023ed0: 6578 6563 7574 696f 6e20 7265 7665 7274  execution revert
-00023ee0: 6564 3a20 4675 6e63 7469 6f6e 2068 6173  ed: Function has
-00023ef0: 2062 6565 6e20 7265 7665 7274 6564 220a   been reverted".
-00023f00: 2020 2020 2020 2020 2920 6173 2065 7863          ) as exc
-00023f10: 696e 666f 3a0a 2020 2020 2020 2020 2020  info:.          
-00023f20: 2020 7733 2e65 7468 2e63 616c 6c28 7478    w3.eth.call(tx
-00023f30: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
-00023f40: 2020 6173 7365 7274 2065 7863 696e 666f    assert excinfo
-00023f50: 2e76 616c 7565 2e64 6174 6120 3d3d 2064  .value.data == d
-00023f60: 6174 610a 0a20 2020 2064 6566 2074 6573  ata..    def tes
-00023f70: 745f 6574 685f 6361 6c6c 5f72 6576 6572  t_eth_call_rever
-00023f80: 745f 7769 7468 6f75 745f 6d73 6728 0a20  t_without_msg(. 
-00023f90: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00023fa0: 2020 2020 2077 333a 2022 5765 6233 222c       w3: "Web3",
-00023fb0: 0a20 2020 2020 2020 2072 6576 6572 745f  .        revert_
-00023fc0: 636f 6e74 7261 6374 3a20 2243 6f6e 7472  contract: "Contr
-00023fd0: 6163 7422 2c0a 2020 2020 2020 2020 756e  act",.        un
-00023fe0: 6c6f 636b 6564 5f61 6363 6f75 6e74 3a20  locked_account: 
-00023ff0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-00024000: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00024010: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-00024020: 6573 742e 7261 6973 6573 2843 6f6e 7472  est.raises(Contr
-00024030: 6163 744c 6f67 6963 4572 726f 722c 206d  actLogicError, m
-00024040: 6174 6368 3d22 6578 6563 7574 696f 6e20  atch="execution 
-00024050: 7265 7665 7274 6564 2229 3a0a 2020 2020  reverted"):.    
-00024060: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-00024070: 6d73 203d 2072 6576 6572 745f 636f 6e74  ms = revert_cont
-00024080: 7261 6374 2e5f 7072 6570 6172 655f 7472  ract._prepare_tr
-00024090: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
-000240a0: 2020 2020 2020 2020 2020 2066 6e5f 6e61             fn_na
-000240b0: 6d65 3d22 7265 7665 7274 5769 7468 6f75  me="revertWithou
-000240c0: 744d 6573 7361 6765 222c 0a20 2020 2020  tMessage",.     
-000240d0: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-000240e0: 6163 7469 6f6e 3d7b 0a20 2020 2020 2020  action={.       
-000240f0: 2020 2020 2020 2020 2020 2020 2022 6672               "fr
-00024100: 6f6d 223a 2075 6e6c 6f63 6b65 645f 6163  om": unlocked_ac
-00024110: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
-00024120: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
-00024130: 2072 6576 6572 745f 636f 6e74 7261 6374   revert_contract
-00024140: 2e61 6464 7265 7373 2c0a 2020 2020 2020  .address,.      
-00024150: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-00024160: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00024170: 2020 2020 2020 2077 332e 6574 682e 6361         w3.eth.ca
-00024180: 6c6c 2874 786e 5f70 6172 616d 7329 0a0a  ll(txn_params)..
-00024190: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-000241a0: 5f63 616c 6c5f 6375 7374 6f6d 5f65 7272  _call_custom_err
-000241b0: 6f72 5f72 6576 6572 745f 7769 7468 5f6d  or_revert_with_m
-000241c0: 7367 280a 2020 2020 2020 2020 7365 6c66  sg(.        self
-000241d0: 2c0a 2020 2020 2020 2020 7733 3a20 2257  ,.        w3: "W
-000241e0: 6562 3322 2c0a 2020 2020 2020 2020 7265  eb3",.        re
-000241f0: 7665 7274 5f63 6f6e 7472 6163 743a 2022  vert_contract: "
-00024200: 436f 6e74 7261 6374 222c 0a20 2020 2020  Contract",.     
-00024210: 2020 2075 6e6c 6f63 6b65 645f 6163 636f     unlocked_acco
-00024220: 756e 743a 2043 6865 636b 7375 6d41 6464  unt: ChecksumAdd
-00024230: 7265 7373 2c0a 2020 2020 2920 2d3e 204e  ress,.    ) -> N
-00024240: 6f6e 653a 0a20 2020 2020 2020 2064 6174  one:.        dat
-00024250: 6120 3d20 7265 7665 7274 5f63 6f6e 7472  a = revert_contr
-00024260: 6163 742e 656e 636f 6465 5f61 6269 280a  act.encode_abi(.
-00024270: 2020 2020 2020 2020 2020 2020 666e 5f6e              fn_n
-00024280: 616d 653d 2255 6e61 7574 686f 7269 7a65  ame="Unauthorize
-00024290: 6457 6974 684d 6573 7361 6765 222c 2061  dWithMessage", a
-000242a0: 7267 733d 5b22 596f 7520 6172 6520 6e6f  rgs=["You are no
-000242b0: 7420 6175 7468 6f72 697a 6564 225d 0a20  t authorized"]. 
-000242c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000242d0: 2074 786e 5f70 6172 616d 7320 3d20 7265   txn_params = re
-000242e0: 7665 7274 5f63 6f6e 7472 6163 742e 5f70  vert_contract._p
-000242f0: 7265 7061 7265 5f74 7261 6e73 6163 7469  repare_transacti
-00024300: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-00024310: 666e 5f6e 616d 653d 2263 7573 746f 6d45  fn_name="customE
-00024320: 7272 6f72 5769 7468 4d65 7373 6167 6522  rrorWithMessage"
-00024330: 2c0a 2020 2020 2020 2020 2020 2020 7472  ,.            tr
-00024340: 616e 7361 6374 696f 6e3d 7b0a 2020 2020  ansaction={.    
-00024350: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-00024360: 6d22 3a20 756e 6c6f 636b 6564 5f61 6363  m": unlocked_acc
-00024370: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
-00024380: 2020 2020 2020 2274 6f22 3a20 7265 7665        "to": reve
-00024390: 7274 5f63 6f6e 7472 6163 742e 6164 6472  rt_contract.addr
-000243a0: 6573 732c 0a20 2020 2020 2020 2020 2020  ess,.           
-000243b0: 207d 2c0a 2020 2020 2020 2020 290a 2020   },.        ).  
-000243c0: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
-000243d0: 742e 7261 6973 6573 2843 6f6e 7472 6163  t.raises(Contrac
-000243e0: 7443 7573 746f 6d45 7272 6f72 2c20 6d61  tCustomError, ma
-000243f0: 7463 683d 6461 7461 2920 6173 2065 7863  tch=data) as exc
-00024400: 696e 666f 3a0a 2020 2020 2020 2020 2020  info:.          
-00024410: 2020 7733 2e65 7468 2e63 616c 6c28 7478    w3.eth.call(tx
-00024420: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
-00024430: 2020 6173 7365 7274 2065 7863 696e 666f    assert excinfo
-00024440: 2e76 616c 7565 2e64 6174 6120 3d3d 2064  .value.data == d
-00024450: 6174 610a 0a20 2020 2064 6566 2074 6573  ata..    def tes
-00024460: 745f 6574 685f 6361 6c6c 5f63 7573 746f  t_eth_call_custo
-00024470: 6d5f 6572 726f 725f 7265 7665 7274 5f77  m_error_revert_w
-00024480: 6974 686f 7574 5f6d 7367 280a 2020 2020  ithout_msg(.    
-00024490: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000244a0: 2020 7733 3a20 2257 6562 3322 2c0a 2020    w3: "Web3",.  
-000244b0: 2020 2020 2020 7265 7665 7274 5f63 6f6e        revert_con
-000244c0: 7472 6163 743a 2022 436f 6e74 7261 6374  tract: "Contract
-000244d0: 222c 0a20 2020 2020 2020 2075 6e6c 6f63  ",.        unloc
-000244e0: 6b65 645f 6163 636f 756e 743a 2043 6865  ked_account: Che
-000244f0: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
-00024500: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00024510: 2020 2020 2064 6174 6120 3d20 7265 7665       data = reve
-00024520: 7274 5f63 6f6e 7472 6163 742e 656e 636f  rt_contract.enco
-00024530: 6465 5f61 6269 2866 6e5f 6e61 6d65 3d22  de_abi(fn_name="
-00024540: 556e 6175 7468 6f72 697a 6564 2229 0a20  Unauthorized"). 
-00024550: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00024560: 7320 3d20 7265 7665 7274 5f63 6f6e 7472  s = revert_contr
-00024570: 6163 742e 5f70 7265 7061 7265 5f74 7261  act._prepare_tra
-00024580: 6e73 6163 7469 6f6e 280a 2020 2020 2020  nsaction(.      
-00024590: 2020 2020 2020 666e 5f6e 616d 653d 2263        fn_name="c
-000245a0: 7573 746f 6d45 7272 6f72 5769 7468 6f75  ustomErrorWithou
-000245b0: 744d 6573 7361 6765 222c 0a20 2020 2020  tMessage",.     
-000245c0: 2020 2020 2020 2074 7261 6e73 6163 7469         transacti
-000245d0: 6f6e 3d7b 0a20 2020 2020 2020 2020 2020  on={.           
-000245e0: 2020 2020 2022 6672 6f6d 223a 2075 6e6c       "from": unl
-000245f0: 6f63 6b65 645f 6163 636f 756e 742c 0a20  ocked_account,. 
-00024600: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00024610: 746f 223a 2072 6576 6572 745f 636f 6e74  to": revert_cont
-00024620: 7261 6374 2e61 6464 7265 7373 2c0a 2020  ract.address,.  
-00024630: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-00024640: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
-00024650: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-00024660: 7328 436f 6e74 7261 6374 4375 7374 6f6d  s(ContractCustom
-00024670: 4572 726f 722c 206d 6174 6368 3d64 6174  Error, match=dat
-00024680: 6129 2061 7320 6578 6369 6e66 6f3a 0a20  a) as excinfo:. 
-00024690: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
-000246a0: 682e 6361 6c6c 2874 786e 5f70 6172 616d  h.call(txn_param
-000246b0: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
-000246c0: 7420 6578 6369 6e66 6f2e 7661 6c75 652e  t excinfo.value.
-000246d0: 6461 7461 203d 3d20 6461 7461 0a0a 2020  data == data..  
-000246e0: 2020 4070 7974 6573 742e 6d61 726b 2e70    @pytest.mark.p
-000246f0: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
-00024700: 2020 2020 2270 616e 6963 5f65 7272 6f72      "panic_error
-00024710: 2c70 6172 616d 7322 2c0a 2020 2020 2020  ,params",.      
-00024720: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-00024730: 2822 3031 222c 205b 5d29 2c0a 2020 2020  ("01", []),.    
-00024740: 2020 2020 2020 2020 2822 3131 222c 205b          ("11", [
-00024750: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-00024760: 2822 3132 222c 205b 305d 292c 0a20 2020  ("12", [0]),.   
-00024770: 2020 2020 2020 2020 2028 2232 3122 2c20           ("21", 
-00024780: 5b2d 315d 292c 0a20 2020 2020 2020 2020  [-1]),.         
-00024790: 2020 2028 2232 3222 2c20 5b5d 292c 0a20     ("22", []),. 
-000247a0: 2020 2020 2020 2020 2020 2028 2233 3122             ("31"
-000247b0: 2c20 5b5d 292c 0a20 2020 2020 2020 2020  , []),.         
-000247c0: 2020 2028 2233 3222 2c20 5b5d 292c 0a20     ("32", []),. 
-000247d0: 2020 2020 2020 2020 2020 2028 2234 3122             ("41"
-000247e0: 2c20 5b5d 292c 0a20 2020 2020 2020 2020  , []),.         
-000247f0: 2020 2028 2235 3122 2c20 5b5d 292c 0a20     ("51", []),. 
-00024800: 2020 2020 2020 2029 2c0a 2020 2020 290a         ),.    ).
-00024810: 2020 2020 6465 6620 7465 7374 5f63 6f6e      def test_con
-00024820: 7472 6163 745f 7061 6e69 635f 6572 726f  tract_panic_erro
-00024830: 7273 280a 2020 2020 2020 2020 7365 6c66  rs(.        self
-00024840: 2c0a 2020 2020 2020 2020 7733 3a20 2257  ,.        w3: "W
-00024850: 6562 3322 2c0a 2020 2020 2020 2020 7061  eb3",.        pa
-00024860: 6e69 635f 6572 726f 7273 5f63 6f6e 7472  nic_errors_contr
-00024870: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
-00024880: 0a20 2020 2020 2020 2070 616e 6963 5f65  .        panic_e
-00024890: 7272 6f72 3a20 7374 722c 0a20 2020 2020  rror: str,.     
-000248a0: 2020 2070 6172 616d 733a 204c 6973 745b     params: List[
-000248b0: 416e 795d 2c0a 2020 2020 2920 2d3e 204e  Any],.    ) -> N
-000248c0: 6f6e 653a 0a20 2020 2020 2020 206d 6574  one:.        met
-000248d0: 686f 6420 3d20 6765 7461 7474 7228 0a20  hod = getattr(. 
-000248e0: 2020 2020 2020 2020 2020 2070 616e 6963             panic
-000248f0: 5f65 7272 6f72 735f 636f 6e74 7261 6374  _errors_contract
-00024900: 2e66 756e 6374 696f 6e73 2c0a 2020 2020  .functions,.    
-00024910: 2020 2020 2020 2020 6622 6572 726f 7243          f"errorC
-00024920: 6f64 657b 7061 6e69 635f 6572 726f 727d  ode{panic_error}
-00024930: 222c 0a20 2020 2020 2020 2029 0a20 2020  ",.        ).   
-00024940: 2020 2020 2065 7272 6f72 5f6d 7367 203d       error_msg =
-00024950: 2050 414e 4943 5f45 5252 4f52 5f43 4f44   PANIC_ERROR_COD
-00024960: 4553 5b70 616e 6963 5f65 7272 6f72 5d0a  ES[panic_error].
-00024970: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-00024980: 7465 7374 2e72 6169 7365 7328 436f 6e74  test.raises(Cont
-00024990: 7261 6374 5061 6e69 6345 7272 6f72 2c20  ractPanicError, 
-000249a0: 6d61 7463 683d 7265 2e65 7363 6170 6528  match=re.escape(
-000249b0: 6572 726f 725f 6d73 6729 293a 0a20 2020  error_msg)):.   
-000249c0: 2020 2020 2020 2020 206d 6574 686f 6428           method(
-000249d0: 2a70 6172 616d 7329 2e63 616c 6c28 290a  *params).call().
-000249e0: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-000249f0: 685f 6361 6c6c 5f6f 6666 6368 6169 6e5f  h_call_offchain_
-00024a00: 6c6f 6f6b 7570 280a 2020 2020 2020 2020  lookup(.        
-00024a10: 7365 6c66 2c0a 2020 2020 2020 2020 7733  self,.        w3
-00024a20: 3a20 2257 6562 3322 2c0a 2020 2020 2020  : "Web3",.      
-00024a30: 2020 6f66 6663 6861 696e 5f6c 6f6f 6b75    offchain_looku
-00024a40: 705f 636f 6e74 7261 6374 3a20 2243 6f6e  p_contract: "Con
-00024a50: 7472 6163 7422 2c0a 2020 2020 2020 2020  tract",.        
-00024a60: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-00024a70: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-00024a80: 732c 0a20 2020 2020 2020 206d 6f6e 6b65  s,.        monke
-00024a90: 7970 6174 6368 3a20 224d 6f6e 6b65 7950  ypatch: "MonkeyP
-00024aa0: 6174 6368 222c 0a20 2020 2029 202d 3e20  atch",.    ) -> 
-00024ab0: 4e6f 6e65 3a0a 2020 2020 2020 2020 6e6f  None:.        no
-00024ac0: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
-00024ad0: 745f 6164 6472 6573 7320 3d20 746f 5f68  t_address = to_h
-00024ae0: 6578 5f69 665f 6279 7465 7328 0a20 2020  ex_if_bytes(.   
-00024af0: 2020 2020 2020 2020 206f 6666 6368 6169           offchai
-00024b00: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
-00024b10: 742e 6164 6472 6573 730a 2020 2020 2020  t.address.      
-00024b20: 2020 292e 6c6f 7765 7228 290a 2020 2020    ).lower().    
-00024b30: 2020 2020 6d6f 636b 5f6f 6666 6368 6169      mock_offchai
-00024b40: 6e5f 6c6f 6f6b 7570 5f72 6571 7565 7374  n_lookup_request
-00024b50: 5f72 6573 706f 6e73 6528 0a20 2020 2020  _response(.     
-00024b60: 2020 2020 2020 206d 6f6e 6b65 7970 6174         monkeypat
-00024b70: 6368 2c0a 2020 2020 2020 2020 2020 2020  ch,.            
-00024b80: 6d6f 636b 6564 5f72 6571 7565 7374 5f75  mocked_request_u
-00024b90: 726c 3d66 2268 7474 7073 3a2f 2f77 6562  rl=f"https://web
-00024ba0: 332e 7079 2f67 6174 6577 6179 2f7b 6e6f  3.py/gateway/{no
-00024bb0: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
-00024bc0: 745f 6164 6472 6573 737d 2f7b 4f46 4643  t_address}/{OFFC
-00024bd0: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
-00024be0: 5f44 4154 417d 2e6a 736f 6e22 2c20 2023  _DATA}.json",  #
-00024bf0: 206e 6f71 613a 2045 3530 310a 2020 2020   noqa: E501.    
-00024c00: 2020 2020 2020 2020 6d6f 636b 6564 5f6a          mocked_j
-00024c10: 736f 6e5f 6461 7461 3d57 4542 3350 595f  son_data=WEB3PY_
-00024c20: 4153 5f48 4558 4259 5445 532c 0a20 2020  AS_HEXBYTES,.   
-00024c30: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-00024c40: 6573 706f 6e73 6520 3d20 6f66 6663 6861  esponse = offcha
-00024c50: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
-00024c60: 6374 2e66 756e 6374 696f 6e73 2e74 6573  ct.functions.tes
-00024c70: 744f 6666 6368 6169 6e4c 6f6f 6b75 7028  tOffchainLookup(
-00024c80: 0a20 2020 2020 2020 2020 2020 204f 4646  .            OFF
-00024c90: 4348 4149 4e5f 4c4f 4f4b 5550 5f54 4553  CHAIN_LOOKUP_TES
-00024ca0: 545f 4441 5441 0a20 2020 2020 2020 2029  T_DATA.        )
-00024cb0: 2e63 616c 6c28 290a 2020 2020 2020 2020  .call().        
-00024cc0: 6173 7365 7274 2077 332e 636f 6465 632e  assert w3.codec.
-00024cd0: 6465 636f 6465 285b 2273 7472 696e 6722  decode(["string"
-00024ce0: 5d2c 2072 6573 706f 6e73 6529 5b30 5d20  ], response)[0] 
-00024cf0: 3d3d 2022 7765 6233 7079 220a 0a20 2020  == "web3py"..   
-00024d00: 2064 6566 2074 6573 745f 6574 685f 6361   def test_eth_ca
-00024d10: 6c6c 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  ll_offchain_look
-00024d20: 7570 5f72 6169 7365 735f 7768 656e 5f63  up_raises_when_c
-00024d30: 6369 705f 7265 6164 5f69 735f 6469 7361  cip_read_is_disa
-00024d40: 626c 6564 280a 2020 2020 2020 2020 7365  bled(.        se
-00024d50: 6c66 2c0a 2020 2020 2020 2020 7733 3a20  lf,.        w3: 
-00024d60: 2257 6562 3322 2c0a 2020 2020 2020 2020  "Web3",.        
-00024d70: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-00024d80: 636f 6e74 7261 6374 3a20 2243 6f6e 7472  contract: "Contr
-00024d90: 6163 7422 2c0a 2020 2020 2920 2d3e 204e  act",.    ) -> N
-00024da0: 6f6e 653a 0a20 2020 2020 2020 2072 6574  one:.        ret
-00024db0: 7572 6e5f 6461 7461 203d 2028 0a20 2020  urn_data = (.   
-00024dc0: 2020 2020 2020 2020 204f 4646 4348 4149           OFFCHAI
-00024dd0: 4e5f 4c4f 4f4b 5550 5f34 4259 5445 5f44  N_LOOKUP_4BYTE_D
-00024de0: 4154 410a 2020 2020 2020 2020 2020 2020  ATA.            
-00024df0: 2b20 6162 695f 656e 636f 6465 645f 6f66  + abi_encoded_of
-00024e00: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
-00024e10: 6e74 7261 6374 5f61 6464 7265 7373 2877  ntract_address(w
-00024e20: 332c 206f 6666 6368 6169 6e5f 6c6f 6f6b  3, offchain_look
-00024e30: 7570 5f63 6f6e 7472 6163 7429 0a20 2020  up_contract).   
-00024e40: 2020 2020 2020 2020 202b 204f 4646 4348           + OFFCH
-00024e50: 4149 4e5f 4c4f 4f4b 5550 5f52 4554 5552  AIN_LOOKUP_RETUR
-00024e60: 4e5f 4441 5441 0a20 2020 2020 2020 2029  N_DATA.        )
-00024e70: 0a20 2020 2020 2020 2023 2074 6573 7420  .        # test 
-00024e80: 436f 6e74 7261 6374 4675 6e63 7469 6f6e  ContractFunction
-00024e90: 2063 616c 6c0a 2020 2020 2020 2020 7769   call.        wi
-00024ea0: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-00024eb0: 284f 6666 6368 6169 6e4c 6f6f 6b75 7029  (OffchainLookup)
-00024ec0: 2061 7320 653a 0a20 2020 2020 2020 2020   as e:.         
-00024ed0: 2020 206f 6666 6368 6169 6e5f 6c6f 6f6b     offchain_look
-00024ee0: 7570 5f63 6f6e 7472 6163 742e 6675 6e63  up_contract.func
-00024ef0: 7469 6f6e 732e 7465 7374 4f66 6663 6861  tions.testOffcha
-00024f00: 696e 4c6f 6f6b 7570 280a 2020 2020 2020  inLookup(.      
-00024f10: 2020 2020 2020 2020 2020 4f46 4643 4841            OFFCHA
-00024f20: 494e 5f4c 4f4f 4b55 505f 5445 5354 5f44  IN_LOOKUP_TEST_D
-00024f30: 4154 410a 2020 2020 2020 2020 2020 2020  ATA.            
-00024f40: 292e 6361 6c6c 2863 6369 705f 7265 6164  ).call(ccip_read
-00024f50: 5f65 6e61 626c 6564 3d46 616c 7365 290a  _enabled=False).
-00024f60: 2020 2020 2020 2020 6173 7365 7274 2065          assert e
-00024f70: 2e76 616c 7565 2e64 6174 6120 3d3d 2072  .value.data == r
-00024f80: 6574 7572 6e5f 6461 7461 0a0a 2020 2020  eturn_data..    
-00024f90: 2020 2020 2320 7465 7374 2043 6f6e 7472      # test Contr
-00024fa0: 6163 7443 616c 6c65 7220 6361 6c6c 0a20  actCaller call. 
-00024fb0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-00024fc0: 7374 2e72 6169 7365 7328 4f66 6663 6861  st.raises(Offcha
-00024fd0: 696e 4c6f 6f6b 7570 2920 6173 2065 7863  inLookup) as exc
-00024fe0: 696e 666f 3a0a 2020 2020 2020 2020 2020  info:.          
-00024ff0: 2020 6f66 6663 6861 696e 5f6c 6f6f 6b75    offchain_looku
-00025000: 705f 636f 6e74 7261 6374 2e63 616c 6c65  p_contract.calle
-00025010: 7228 6363 6970 5f72 6561 645f 656e 6162  r(ccip_read_enab
-00025020: 6c65 643d 4661 6c73 6529 2e74 6573 744f  led=False).testO
-00025030: 6666 6368 6169 6e4c 6f6f 6b75 7028 0a20  ffchainLookup(. 
-00025040: 2020 2020 2020 2020 2020 2020 2020 204f                 O
-00025050: 4646 4348 4149 4e5f 4c4f 4f4b 5550 5f54  FFCHAIN_LOOKUP_T
-00025060: 4553 545f 4441 5441 0a20 2020 2020 2020  EST_DATA.       
-00025070: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
-00025080: 7373 6572 7420 6578 6369 6e66 6f2e 7661  ssert excinfo.va
-00025090: 6c75 652e 6461 7461 203d 3d20 7265 7475  lue.data == retu
-000250a0: 726e 5f64 6174 610a 0a20 2020 2020 2020  rn_data..       
-000250b0: 2023 2074 6573 7420 676c 6f62 616c 2066   # test global f
-000250c0: 6c61 6720 6f6e 2074 6865 2070 726f 7669  lag on the provi
-000250d0: 6465 720a 2020 2020 2020 2020 7733 2e70  der.        w3.p
-000250e0: 726f 7669 6465 722e 676c 6f62 616c 5f63  rovider.global_c
-000250f0: 6369 705f 7265 6164 5f65 6e61 626c 6564  cip_read_enabled
-00025100: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
-00025110: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-00025120: 6973 6573 284f 6666 6368 6169 6e4c 6f6f  ises(OffchainLoo
-00025130: 6b75 7029 2061 7320 6578 635f 696e 666f  kup) as exc_info
-00025140: 3a0a 2020 2020 2020 2020 2020 2020 6f66  :.            of
-00025150: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
-00025160: 6e74 7261 6374 2e66 756e 6374 696f 6e73  ntract.functions
-00025170: 2e74 6573 744f 6666 6368 6169 6e4c 6f6f  .testOffchainLoo
-00025180: 6b75 7028 0a20 2020 2020 2020 2020 2020  kup(.           
-00025190: 2020 2020 204f 4646 4348 4149 4e5f 4c4f       OFFCHAIN_LO
-000251a0: 4f4b 5550 5f54 4553 545f 4441 5441 0a20  OKUP_TEST_DATA. 
-000251b0: 2020 2020 2020 2020 2020 2029 2e63 616c             ).cal
-000251c0: 6c28 290a 2020 2020 2020 2020 6173 7365  l().        asse
-000251d0: 7274 2065 7863 5f69 6e66 6f2e 7661 6c75  rt exc_info.valu
-000251e0: 652e 6461 7461 203d 3d20 7265 7475 726e  e.data == return
-000251f0: 5f64 6174 610a 0a20 2020 2020 2020 2077  _data..        w
-00025200: 332e 7072 6f76 6964 6572 2e67 6c6f 6261  3.provider.globa
-00025210: 6c5f 6363 6970 5f72 6561 645f 656e 6162  l_ccip_read_enab
-00025220: 6c65 6420 3d20 5472 7565 2020 2320 636c  led = True  # cl
-00025230: 6561 6e75 700a 0a20 2020 2064 6566 2074  eanup..    def t
-00025240: 6573 745f 6574 685f 6361 6c6c 5f6f 6666  est_eth_call_off
-00025250: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 616c  chain_lookup_cal
-00025260: 6c5f 666c 6167 5f6f 7665 7272 6964 6573  l_flag_overrides
-00025270: 5f70 726f 7669 6465 725f 666c 6167 280a  _provider_flag(.
-00025280: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00025290: 2020 2020 2020 7733 3a20 2257 6562 3322        w3: "Web3"
-000252a0: 2c0a 2020 2020 2020 2020 6f66 6663 6861  ,.        offcha
-000252b0: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
-000252c0: 6374 3a20 2243 6f6e 7472 6163 7422 2c0a  ct: "Contract",.
-000252d0: 2020 2020 2020 2020 756e 6c6f 636b 6564          unlocked
-000252e0: 5f61 6363 6f75 6e74 3a20 4368 6563 6b73  _account: Checks
-000252f0: 756d 4164 6472 6573 732c 0a20 2020 2020  umAddress,.     
-00025300: 2020 206d 6f6e 6b65 7970 6174 6368 3a20     monkeypatch: 
-00025310: 224d 6f6e 6b65 7950 6174 6368 222c 0a20  "MonkeyPatch",. 
-00025320: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-00025330: 2020 2020 2020 6e6f 726d 616c 697a 6564        normalized
-00025340: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
-00025350: 7320 3d20 746f 5f68 6578 5f69 665f 6279  s = to_hex_if_by
-00025360: 7465 7328 0a20 2020 2020 2020 2020 2020  tes(.           
-00025370: 206f 6666 6368 6169 6e5f 6c6f 6f6b 7570   offchain_lookup
-00025380: 5f63 6f6e 7472 6163 742e 6164 6472 6573  _contract.addres
-00025390: 730a 2020 2020 2020 2020 292e 6c6f 7765  s.        ).lowe
-000253a0: 7228 290a 2020 2020 2020 2020 6d6f 636b  r().        mock
-000253b0: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
-000253c0: 5f72 6571 7565 7374 5f72 6573 706f 6e73  _request_respons
-000253d0: 6528 0a20 2020 2020 2020 2020 2020 206d  e(.            m
-000253e0: 6f6e 6b65 7970 6174 6368 2c0a 2020 2020  onkeypatch,.    
-000253f0: 2020 2020 2020 2020 6d6f 636b 6564 5f72          mocked_r
-00025400: 6571 7565 7374 5f75 726c 3d66 2268 7474  equest_url=f"htt
-00025410: 7073 3a2f 2f77 6562 332e 7079 2f67 6174  ps://web3.py/gat
-00025420: 6577 6179 2f7b 6e6f 726d 616c 697a 6564  eway/{normalized
-00025430: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
-00025440: 737d 2f7b 4f46 4643 4841 494e 5f4c 4f4f  s}/{OFFCHAIN_LOO
-00025450: 4b55 505f 5445 5354 5f44 4154 417d 2e6a  KUP_TEST_DATA}.j
-00025460: 736f 6e22 2c20 2023 206e 6f71 613a 2045  son",  # noqa: E
-00025470: 3530 310a 2020 2020 2020 2020 2020 2020  501.            
-00025480: 6d6f 636b 6564 5f6a 736f 6e5f 6461 7461  mocked_json_data
-00025490: 3d57 4542 3350 595f 4153 5f48 4558 4259  =WEB3PY_AS_HEXBY
-000254a0: 5445 532c 0a20 2020 2020 2020 2029 0a0a  TES,.        )..
-000254b0: 2020 2020 2020 2020 7733 2e70 726f 7669          w3.provi
-000254c0: 6465 722e 676c 6f62 616c 5f63 6369 705f  der.global_ccip_
-000254d0: 7265 6164 5f65 6e61 626c 6564 203d 2046  read_enabled = F
-000254e0: 616c 7365 0a0a 2020 2020 2020 2020 7265  alse..        re
-000254f0: 7370 6f6e 7365 203d 206f 6666 6368 6169  sponse = offchai
-00025500: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
-00025510: 742e 6675 6e63 7469 6f6e 732e 7465 7374  t.functions.test
-00025520: 4f66 6663 6861 696e 4c6f 6f6b 7570 280a  OffchainLookup(.
-00025530: 2020 2020 2020 2020 2020 2020 4f46 4643              OFFC
-00025540: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
-00025550: 5f44 4154 410a 2020 2020 2020 2020 292e  _DATA.        ).
-00025560: 6361 6c6c 2863 6369 705f 7265 6164 5f65  call(ccip_read_e
-00025570: 6e61 626c 6564 3d54 7275 6529 0a20 2020  nabled=True).   
-00025580: 2020 2020 2061 7373 6572 7420 7733 2e63       assert w3.c
-00025590: 6f64 6563 2e64 6563 6f64 6528 5b22 7374  odec.decode(["st
-000255a0: 7269 6e67 225d 2c20 7265 7370 6f6e 7365  ring"], response
-000255b0: 295b 305d 203d 3d20 2277 6562 3370 7922  )[0] == "web3py"
-000255c0: 0a0a 2020 2020 2020 2020 7733 2e70 726f  ..        w3.pro
-000255d0: 7669 6465 722e 676c 6f62 616c 5f63 6369  vider.global_cci
-000255e0: 705f 7265 6164 5f65 6e61 626c 6564 203d  p_read_enabled =
-000255f0: 2054 7275 6520 2023 2063 6c65 616e 7570   True  # cleanup
-00025600: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-00025610: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
-00025620: 6d61 785f 7265 6469 7265 6374 7322 2c20  max_redirects", 
-00025630: 7261 6e67 6528 2d31 2c20 3429 290a 2020  range(-1, 4)).  
-00025640: 2020 6465 6620 7465 7374 5f65 7468 5f63    def test_eth_c
-00025650: 616c 6c5f 6f66 6663 6861 696e 5f6c 6f6f  all_offchain_loo
-00025660: 6b75 705f 7261 6973 6573 5f69 665f 6d61  kup_raises_if_ma
-00025670: 785f 7265 6469 7265 6374 735f 6973 5f6c  x_redirects_is_l
-00025680: 6573 735f 7468 616e 5f34 280a 2020 2020  ess_than_4(.    
-00025690: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000256a0: 2020 7733 3a20 2257 6562 3322 2c0a 2020    w3: "Web3",.  
-000256b0: 2020 2020 2020 6f66 6663 6861 696e 5f6c        offchain_l
-000256c0: 6f6f 6b75 705f 636f 6e74 7261 6374 3a20  ookup_contract: 
-000256d0: 2243 6f6e 7472 6163 7422 2c0a 2020 2020  "Contract",.    
-000256e0: 2020 2020 6d61 785f 7265 6469 7265 6374      max_redirect
-000256f0: 733a 2069 6e74 2c0a 2020 2020 2920 2d3e  s: int,.    ) ->
-00025700: 204e 6f6e 653a 0a20 2020 2020 2020 2064   None:.        d
-00025710: 6566 6175 6c74 5f6d 6178 5f72 6564 6972  efault_max_redir
-00025720: 6563 7473 203d 2077 332e 7072 6f76 6964  ects = w3.provid
-00025730: 6572 2e63 6369 705f 7265 6164 5f6d 6178  er.ccip_read_max
-00025740: 5f72 6564 6972 6563 7473 0a0a 2020 2020  _redirects..    
-00025750: 2020 2020 7733 2e70 726f 7669 6465 722e      w3.provider.
-00025760: 6363 6970 5f72 6561 645f 6d61 785f 7265  ccip_read_max_re
-00025770: 6469 7265 6374 7320 3d20 6d61 785f 7265  directs = max_re
-00025780: 6469 7265 6374 730a 2020 2020 2020 2020  directs.        
-00025790: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-000257a0: 6573 2856 616c 7565 4572 726f 722c 206d  es(ValueError, m
-000257b0: 6174 6368 3d22 6174 206c 6561 7374 2034  atch="at least 4
-000257c0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
-000257d0: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-000257e0: 636f 6e74 7261 6374 2e66 756e 6374 696f  contract.functio
-000257f0: 6e73 2e74 6573 744f 6666 6368 6169 6e4c  ns.testOffchainL
-00025800: 6f6f 6b75 7028 0a20 2020 2020 2020 2020  ookup(.         
-00025810: 2020 2020 2020 204f 4646 4348 4149 4e5f         OFFCHAIN_
-00025820: 4c4f 4f4b 5550 5f54 4553 545f 4441 5441  LOOKUP_TEST_DATA
-00025830: 0a20 2020 2020 2020 2020 2020 2029 2e63  .            ).c
-00025840: 616c 6c28 290a 0a20 2020 2020 2020 2077  all()..        w
-00025850: 332e 7072 6f76 6964 6572 2e63 6369 705f  3.provider.ccip_
-00025860: 7265 6164 5f6d 6178 5f72 6564 6972 6563  read_max_redirec
-00025870: 7473 203d 2064 6566 6175 6c74 5f6d 6178  ts = default_max
-00025880: 5f72 6564 6972 6563 7473 2020 2320 636c  _redirects  # cl
-00025890: 6561 6e75 700a 0a20 2020 2064 6566 2074  eanup..    def t
-000258a0: 6573 745f 6574 685f 6361 6c6c 5f6f 6666  est_eth_call_off
-000258b0: 6368 6169 6e5f 6c6f 6f6b 7570 5f72 6169  chain_lookup_rai
-000258c0: 7365 735f 666f 725f 696d 7072 6f70 6572  ses_for_improper
-000258d0: 6c79 5f66 6f72 6d61 7474 6564 5f72 6573  ly_formatted_res
-000258e0: 745f 7265 7175 6573 745f 7265 7370 6f6e  t_request_respon
-000258f0: 7365 2820 2023 206e 6f71 613a 2045 3530  se(  # noqa: E50
-00025900: 310a 2020 2020 2020 2020 7365 6c66 2c0a  1.        self,.
-00025910: 2020 2020 2020 2020 7733 3a20 2257 6562          w3: "Web
-00025920: 3322 2c0a 2020 2020 2020 2020 6f66 6663  3",.        offc
-00025930: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
-00025940: 7261 6374 3a20 2243 6f6e 7472 6163 7422  ract: "Contract"
-00025950: 2c0a 2020 2020 2020 2020 756e 6c6f 636b  ,.        unlock
-00025960: 6564 5f61 6363 6f75 6e74 3a20 4368 6563  ed_account: Chec
-00025970: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
-00025980: 2020 2020 206d 6f6e 6b65 7970 6174 6368       monkeypatch
-00025990: 3a20 224d 6f6e 6b65 7950 6174 6368 222c  : "MonkeyPatch",
-000259a0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-000259b0: 2020 2020 2020 2020 6e6f 726d 616c 697a          normaliz
-000259c0: 6564 5f63 6f6e 7472 6163 745f 6164 6472  ed_contract_addr
-000259d0: 6573 7320 3d20 746f 5f68 6578 5f69 665f  ess = to_hex_if_
-000259e0: 6279 7465 7328 0a20 2020 2020 2020 2020  bytes(.         
-000259f0: 2020 206f 6666 6368 6169 6e5f 6c6f 6f6b     offchain_look
-00025a00: 7570 5f63 6f6e 7472 6163 742e 6164 6472  up_contract.addr
-00025a10: 6573 730a 2020 2020 2020 2020 292e 6c6f  ess.        ).lo
-00025a20: 7765 7228 290a 2020 2020 2020 2020 6d6f  wer().        mo
-00025a30: 636b 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  ck_offchain_look
-00025a40: 7570 5f72 6571 7565 7374 5f72 6573 706f  up_request_respo
-00025a50: 6e73 6528 0a20 2020 2020 2020 2020 2020  nse(.           
-00025a60: 206d 6f6e 6b65 7970 6174 6368 2c0a 2020   monkeypatch,.  
-00025a70: 2020 2020 2020 2020 2020 6d6f 636b 6564            mocked
-00025a80: 5f72 6571 7565 7374 5f75 726c 3d66 2268  _request_url=f"h
-00025a90: 7474 7073 3a2f 2f77 6562 332e 7079 2f67  ttps://web3.py/g
-00025aa0: 6174 6577 6179 2f7b 6e6f 726d 616c 697a  ateway/{normaliz
-00025ab0: 6564 5f63 6f6e 7472 6163 745f 6164 6472  ed_contract_addr
-00025ac0: 6573 737d 2f7b 4f46 4643 4841 494e 5f4c  ess}/{OFFCHAIN_L
-00025ad0: 4f4f 4b55 505f 5445 5354 5f44 4154 417d  OOKUP_TEST_DATA}
-00025ae0: 2e6a 736f 6e22 2c20 2023 206e 6f71 613a  .json",  # noqa:
-00025af0: 2045 3530 310a 2020 2020 2020 2020 2020   E501.          
-00025b00: 2020 6d6f 636b 6564 5f6a 736f 6e5f 6461    mocked_json_da
-00025b10: 7461 3d57 4542 3350 595f 4153 5f48 4558  ta=WEB3PY_AS_HEX
-00025b20: 4259 5445 532c 0a20 2020 2020 2020 2020  BYTES,.         
-00025b30: 2020 206a 736f 6e5f 6461 7461 5f66 6965     json_data_fie
-00025b40: 6c64 3d22 6e6f 745f 6461 7461 222c 0a20  ld="not_data",. 
-00025b50: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00025b60: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-00025b70: 7365 7328 5765 6233 5661 6c69 6461 7469  ses(Web3Validati
-00025b80: 6f6e 4572 726f 722c 206d 6174 6368 3d22  onError, match="
-00025b90: 6d69 7373 696e 6720 2764 6174 6127 2066  missing 'data' f
-00025ba0: 6965 6c64 2229 3a0a 2020 2020 2020 2020  ield"):.        
-00025bb0: 2020 2020 6f66 6663 6861 696e 5f6c 6f6f      offchain_loo
-00025bc0: 6b75 705f 636f 6e74 7261 6374 2e66 756e  kup_contract.fun
-00025bd0: 6374 696f 6e73 2e74 6573 744f 6666 6368  ctions.testOffch
-00025be0: 6169 6e4c 6f6f 6b75 7028 0a20 2020 2020  ainLookup(.     
-00025bf0: 2020 2020 2020 2020 2020 204f 4646 4348             OFFCH
-00025c00: 4149 4e5f 4c4f 4f4b 5550 5f54 4553 545f  AIN_LOOKUP_TEST_
-00025c10: 4441 5441 0a20 2020 2020 2020 2020 2020  DATA.           
-00025c20: 2029 2e63 616c 6c28 290a 0a20 2020 2040   ).call()..    @
-00025c30: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-00025c40: 6d65 7472 697a 6528 2273 7461 7475 735f  metrize("status_
-00025c50: 636f 6465 5f6e 6f6e 5f34 7878 5f65 7272  code_non_4xx_err
-00025c60: 6f72 222c 205b 3130 302c 2033 3030 2c20  or", [100, 300, 
-00025c70: 3530 302c 2036 3030 5d29 0a20 2020 2064  500, 600]).    d
-00025c80: 6566 2074 6573 745f 6574 685f 6361 6c6c  ef test_eth_call
-00025c90: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
-00025ca0: 5f74 7269 6573 5f6e 6578 745f 7572 6c5f  _tries_next_url_
-00025cb0: 666f 725f 6e6f 6e5f 3478 785f 6572 726f  for_non_4xx_erro
-00025cc0: 725f 7374 6174 7573 5f61 6e64 5f74 6573  r_status_and_tes
-00025cd0: 7473 5f50 4f53 5428 2020 2320 6e6f 7161  ts_POST(  # noqa
-00025ce0: 3a20 4535 3031 0a20 2020 2020 2020 2073  : E501.        s
-00025cf0: 656c 662c 0a20 2020 2020 2020 2077 333a  elf,.        w3:
-00025d00: 2022 5765 6233 222c 0a20 2020 2020 2020   "Web3",.       
-00025d10: 206f 6666 6368 6169 6e5f 6c6f 6f6b 7570   offchain_lookup
-00025d20: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
-00025d30: 7261 6374 222c 0a20 2020 2020 2020 2075  ract",.        u
-00025d40: 6e6c 6f63 6b65 645f 6163 636f 756e 743a  nlocked_account:
-00025d50: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-00025d60: 2c0a 2020 2020 2020 2020 6d6f 6e6b 6579  ,.        monkey
-00025d70: 7061 7463 683a 2022 4d6f 6e6b 6579 5061  patch: "MonkeyPa
-00025d80: 7463 6822 2c0a 2020 2020 2020 2020 7374  tch",.        st
-00025d90: 6174 7573 5f63 6f64 655f 6e6f 6e5f 3478  atus_code_non_4x
-00025da0: 785f 6572 726f 723a 2069 6e74 2c0a 2020  x_error: int,.  
-00025db0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00025dc0: 2020 2020 206e 6f72 6d61 6c69 7a65 645f       normalized_
-00025dd0: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
-00025de0: 203d 2074 6f5f 6865 785f 6966 5f62 7974   = to_hex_if_byt
-00025df0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-00025e00: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-00025e10: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
-00025e20: 0a20 2020 2020 2020 2029 2e6c 6f77 6572  .        ).lower
-00025e30: 2829 0a0a 2020 2020 2020 2020 2320 5468  ()..        # Th
-00025e40: 6520 6e65 7874 2075 726c 2069 6e20 6f75  e next url in ou
-00025e50: 7220 7465 7374 2063 6f6e 7472 6163 7420  r test contract 
-00025e60: 646f 6573 6e27 7420 636f 6e74 6169 6e20  doesn't contain 
-00025e70: 277b 6461 7461 7d27 2c20 7472 6967 6765  '{data}', trigge
-00025e80: 7269 6e67 0a20 2020 2020 2020 2023 2074  ring.        # t
-00025e90: 6865 2050 4f53 5420 7265 7175 6573 7420  he POST request 
-00025ea0: 6c6f 6769 632e 2054 6865 2069 6465 6120  logic. The idea 
-00025eb0: 6865 7265 2069 7320 746f 2072 6574 7572  here is to retur
-00025ec0: 6e20 6120 6261 6420 7374 6174 7573 2066  n a bad status f
-00025ed0: 6f72 0a20 2020 2020 2020 2023 2074 6865  or.        # the
-00025ee0: 2066 6972 7374 2075 726c 2028 4745 5429   first url (GET)
-00025ef0: 2061 6e64 2061 2073 7563 6365 7373 2073   and a success s
-00025f00: 7461 7475 7320 6672 6f6d 2074 6865 2073  tatus from the s
-00025f10: 6563 6f6e 6420 6361 6c6c 2028 504f 5354  econd call (POST
-00025f20: 290a 2020 2020 2020 2020 2320 746f 2074  ).        # to t
-00025f30: 6573 7420 626f 7468 2074 6861 7420 7765  est both that we
-00025f40: 206d 6f76 6520 6f6e 2074 6f20 7468 6520   move on to the 
-00025f50: 6e65 7874 2075 726c 2077 6974 6820 6e6f  next url with no
-00025f60: 6e20 3478 7820 7374 6174 7573 2061 6e64  n 4xx status and
-00025f70: 0a20 2020 2020 2020 2023 2074 6861 7420  .        # that 
-00025f80: 7468 6520 504f 5354 206c 6f67 6963 2069  the POST logic i
-00025f90: 7320 616c 736f 2077 6f72 6b69 6e67 2061  s also working a
-00025fa0: 7320 6578 7065 6374 6564 2e0a 2020 2020  s expected..    
-00025fb0: 2020 2020 6d6f 636b 5f6f 6666 6368 6169      mock_offchai
-00025fc0: 6e5f 6c6f 6f6b 7570 5f72 6571 7565 7374  n_lookup_request
-00025fd0: 5f72 6573 706f 6e73 6528 0a20 2020 2020  _response(.     
-00025fe0: 2020 2020 2020 206d 6f6e 6b65 7970 6174         monkeypat
-00025ff0: 6368 2c0a 2020 2020 2020 2020 2020 2020  ch,.            
-00026000: 6d6f 636b 6564 5f72 6571 7565 7374 5f75  mocked_request_u
-00026010: 726c 3d66 2268 7474 7073 3a2f 2f77 6562  rl=f"https://web
-00026020: 332e 7079 2f67 6174 6577 6179 2f7b 6e6f  3.py/gateway/{no
-00026030: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
-00026040: 745f 6164 6472 6573 737d 2f7b 4f46 4643  t_address}/{OFFC
-00026050: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
-00026060: 5f44 4154 417d 2e6a 736f 6e22 2c20 2023  _DATA}.json",  #
-00026070: 206e 6f71 613a 2045 3530 310a 2020 2020   noqa: E501.    
-00026080: 2020 2020 2020 2020 6d6f 636b 6564 5f73          mocked_s
-00026090: 7461 7475 735f 636f 6465 3d73 7461 7475  tatus_code=statu
-000260a0: 735f 636f 6465 5f6e 6f6e 5f34 7878 5f65  s_code_non_4xx_e
-000260b0: 7272 6f72 2c0a 2020 2020 2020 2020 2020  rror,.          
-000260c0: 2020 6d6f 636b 6564 5f6a 736f 6e5f 6461    mocked_json_da
-000260d0: 7461 3d57 4542 3350 595f 4153 5f48 4558  ta=WEB3PY_AS_HEX
-000260e0: 4259 5445 532c 0a20 2020 2020 2020 2029  BYTES,.        )
-000260f0: 0a20 2020 2020 2020 206d 6f63 6b5f 6f66  .        mock_of
-00026100: 6663 6861 696e 5f6c 6f6f 6b75 705f 7265  fchain_lookup_re
-00026110: 7175 6573 745f 7265 7370 6f6e 7365 280a  quest_response(.
-00026120: 2020 2020 2020 2020 2020 2020 6d6f 6e6b              monk
-00026130: 6579 7061 7463 682c 0a20 2020 2020 2020  eypatch,.       
-00026140: 2020 2020 2068 7474 705f 6d65 7468 6f64       http_method
-00026150: 3d22 504f 5354 222c 0a20 2020 2020 2020  ="POST",.       
-00026160: 2020 2020 206d 6f63 6b65 645f 7265 7175       mocked_requ
-00026170: 6573 745f 7572 6c3d 6622 6874 7470 733a  est_url=f"https:
-00026180: 2f2f 7765 6233 2e70 792f 6761 7465 7761  //web3.py/gatewa
-00026190: 792f 7b6e 6f72 6d61 6c69 7a65 645f 636f  y/{normalized_co
-000261a0: 6e74 7261 6374 5f61 6464 7265 7373 7d2e  ntract_address}.
-000261b0: 6a73 6f6e 222c 2020 2320 6e6f 7161 3a20  json",  # noqa: 
-000261c0: 4535 3031 0a20 2020 2020 2020 2020 2020  E501.           
-000261d0: 206d 6f63 6b65 645f 7374 6174 7573 5f63   mocked_status_c
-000261e0: 6f64 653d 3230 302c 0a20 2020 2020 2020  ode=200,.       
-000261f0: 2020 2020 206d 6f63 6b65 645f 6a73 6f6e       mocked_json
-00026200: 5f64 6174 613d 5745 4233 5059 5f41 535f  _data=WEB3PY_AS_
-00026210: 4845 5842 5954 4553 2c0a 2020 2020 2020  HEXBYTES,.      
-00026220: 2020 2020 2020 7365 6e64 6572 3d6e 6f72        sender=nor
-00026230: 6d61 6c69 7a65 645f 636f 6e74 7261 6374  malized_contract
-00026240: 5f61 6464 7265 7373 2c0a 2020 2020 2020  _address,.      
-00026250: 2020 2020 2020 6361 6c6c 6461 7461 3d4f        calldata=O
-00026260: 4646 4348 4149 4e5f 4c4f 4f4b 5550 5f54  FFCHAIN_LOOKUP_T
-00026270: 4553 545f 4441 5441 2c0a 2020 2020 2020  EST_DATA,.      
-00026280: 2020 290a 2020 2020 2020 2020 7265 7370    ).        resp
-00026290: 6f6e 7365 203d 206f 6666 6368 6169 6e5f  onse = offchain_
-000262a0: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
-000262b0: 6675 6e63 7469 6f6e 732e 7465 7374 4f66  functions.testOf
-000262c0: 6663 6861 696e 4c6f 6f6b 7570 280a 2020  fchainLookup(.  
-000262d0: 2020 2020 2020 2020 2020 4f46 4643 4841            OFFCHA
-000262e0: 494e 5f4c 4f4f 4b55 505f 5445 5354 5f44  IN_LOOKUP_TEST_D
-000262f0: 4154 410a 2020 2020 2020 2020 292e 6361  ATA.        ).ca
-00026300: 6c6c 2829 0a20 2020 2020 2020 2061 7373  ll().        ass
-00026310: 6572 7420 7733 2e63 6f64 6563 2e64 6563  ert w3.codec.dec
-00026320: 6f64 6528 5b22 7374 7269 6e67 225d 2c20  ode(["string"], 
-00026330: 7265 7370 6f6e 7365 295b 305d 203d 3d20  response)[0] == 
-00026340: 2277 6562 3370 7922 0a0a 2020 2020 6465  "web3py"..    de
-00026350: 6620 7465 7374 5f65 7468 5f63 616c 6c5f  f test_eth_call_
-00026360: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-00026370: 6361 6c6c 735f 7261 6973 655f 666f 725f  calls_raise_for_
-00026380: 7374 6174 7573 5f66 6f72 5f34 7878 5f73  status_for_4xx_s
-00026390: 7461 7475 735f 636f 6465 280a 2020 2020  tatus_code(.    
-000263a0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000263b0: 2020 7733 3a20 2257 6562 3322 2c0a 2020    w3: "Web3",.  
-000263c0: 2020 2020 2020 6f66 6663 6861 696e 5f6c        offchain_l
-000263d0: 6f6f 6b75 705f 636f 6e74 7261 6374 3a20  ookup_contract: 
-000263e0: 2243 6f6e 7472 6163 7422 2c0a 2020 2020  "Contract",.    
-000263f0: 2020 2020 756e 6c6f 636b 6564 5f61 6363      unlocked_acc
-00026400: 6f75 6e74 3a20 4368 6563 6b73 756d 4164  ount: ChecksumAd
-00026410: 6472 6573 732c 0a20 2020 2020 2020 206d  dress,.        m
-00026420: 6f6e 6b65 7970 6174 6368 3a20 224d 6f6e  onkeypatch: "Mon
-00026430: 6b65 7950 6174 6368 222c 0a20 2020 2029  keyPatch",.    )
-00026440: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00026450: 2020 6e6f 726d 616c 697a 6564 5f63 6f6e    normalized_con
-00026460: 7472 6163 745f 6164 6472 6573 7320 3d20  tract_address = 
-00026470: 746f 5f68 6578 5f69 665f 6279 7465 7328  to_hex_if_bytes(
-00026480: 0a20 2020 2020 2020 2020 2020 206f 6666  .            off
-00026490: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
-000264a0: 7472 6163 742e 6164 6472 6573 730a 2020  tract.address.  
-000264b0: 2020 2020 2020 292e 6c6f 7765 7228 290a        ).lower().
-000264c0: 2020 2020 2020 2020 6d6f 636b 5f6f 6666          mock_off
-000264d0: 6368 6169 6e5f 6c6f 6f6b 7570 5f72 6571  chain_lookup_req
-000264e0: 7565 7374 5f72 6573 706f 6e73 6528 0a20  uest_response(. 
-000264f0: 2020 2020 2020 2020 2020 206d 6f6e 6b65             monke
-00026500: 7970 6174 6368 2c0a 2020 2020 2020 2020  ypatch,.        
-00026510: 2020 2020 6d6f 636b 6564 5f72 6571 7565      mocked_reque
-00026520: 7374 5f75 726c 3d66 2268 7474 7073 3a2f  st_url=f"https:/
-00026530: 2f77 6562 332e 7079 2f67 6174 6577 6179  /web3.py/gateway
-00026540: 2f7b 6e6f 726d 616c 697a 6564 5f63 6f6e  /{normalized_con
-00026550: 7472 6163 745f 6164 6472 6573 737d 2f7b  tract_address}/{
-00026560: 4f46 4643 4841 494e 5f4c 4f4f 4b55 505f  OFFCHAIN_LOOKUP_
-00026570: 5445 5354 5f44 4154 417d 2e6a 736f 6e22  TEST_DATA}.json"
-00026580: 2c20 2023 206e 6f71 613a 2045 3530 310a  ,  # noqa: E501.
-00026590: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
-000265a0: 6564 5f73 7461 7475 735f 636f 6465 3d72  ed_status_code=r
-000265b0: 616e 6469 6e74 2834 3030 2c20 3439 3929  andint(400, 499)
-000265c0: 2c0a 2020 2020 2020 2020 2020 2020 6d6f  ,.            mo
-000265d0: 636b 6564 5f6a 736f 6e5f 6461 7461 3d57  cked_json_data=W
-000265e0: 4542 3350 595f 4153 5f48 4558 4259 5445  EB3PY_AS_HEXBYTE
-000265f0: 532c 0a20 2020 2020 2020 2029 0a20 2020  S,.        ).   
-00026600: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-00026610: 2e72 6169 7365 7328 4578 6365 7074 696f  .raises(Exceptio
-00026620: 6e2c 206d 6174 6368 3d22 6361 6c6c 6564  n, match="called
-00026630: 2072 6169 7365 5f66 6f72 5f73 7461 7475   raise_for_statu
-00026640: 735c 5c28 5c5c 2922 293a 0a20 2020 2020  s\\(\\)"):.     
-00026650: 2020 2020 2020 206f 6666 6368 6169 6e5f         offchain_
-00026660: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
-00026670: 6675 6e63 7469 6f6e 732e 7465 7374 4f66  functions.testOf
-00026680: 6663 6861 696e 4c6f 6f6b 7570 280a 2020  fchainLookup(.  
-00026690: 2020 2020 2020 2020 2020 2020 2020 4f46                OF
-000266a0: 4643 4841 494e 5f4c 4f4f 4b55 505f 5445  FCHAIN_LOOKUP_TE
-000266b0: 5354 5f44 4154 410a 2020 2020 2020 2020  ST_DATA.        
-000266c0: 2020 2020 292e 6361 6c6c 2829 0a0a 2020      ).call()..  
-000266d0: 2020 6465 6620 7465 7374 5f65 7468 5f63    def test_eth_c
-000266e0: 616c 6c5f 6f66 6663 6861 696e 5f6c 6f6f  all_offchain_loo
-000266f0: 6b75 705f 7261 6973 6573 5f77 6865 6e5f  kup_raises_when_
-00026700: 616c 6c5f 7375 7070 6c69 6564 5f75 726c  all_supplied_url
-00026710: 735f 6661 696c 280a 2020 2020 2020 2020  s_fail(.        
-00026720: 7365 6c66 2c0a 2020 2020 2020 2020 7733  self,.        w3
-00026730: 3a20 2257 6562 3322 2c0a 2020 2020 2020  : "Web3",.      
-00026740: 2020 6f66 6663 6861 696e 5f6c 6f6f 6b75    offchain_looku
-00026750: 705f 636f 6e74 7261 6374 3a20 2243 6f6e  p_contract: "Con
-00026760: 7472 6163 7422 2c0a 2020 2020 2920 2d3e  tract",.    ) ->
-00026770: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
-00026780: 2047 4554 2061 6e64 2050 4f53 5420 7265   GET and POST re
-00026790: 7175 6573 7473 2073 686f 756c 6420 6661  quests should fa
-000267a0: 696c 2073 696e 6365 2072 6573 706f 6e73  il since respons
-000267b0: 6573 2061 7265 206e 6f74 206d 6f63 6b65  es are not mocke
-000267c0: 640a 2020 2020 2020 2020 7769 7468 2070  d.        with p
-000267d0: 7974 6573 742e 7261 6973 6573 280a 2020  ytest.raises(.  
-000267e0: 2020 2020 2020 2020 2020 4d75 6c74 6970            Multip
-000267f0: 6c65 4661 696c 6564 5265 7175 6573 7473  leFailedRequests
-00026800: 2c20 6d61 7463 683d 224f 6666 6368 6169  , match="Offchai
-00026810: 6e20 6c6f 6f6b 7570 2066 6169 6c65 6420  n lookup failed 
-00026820: 666f 7220 7375 7070 6c69 6564 2075 726c  for supplied url
-00026830: 7322 0a20 2020 2020 2020 2029 3a0a 2020  s".        ):.  
-00026840: 2020 2020 2020 2020 2020 6f66 6663 6861            offcha
-00026850: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
-00026860: 6374 2e66 756e 6374 696f 6e73 2e74 6573  ct.functions.tes
-00026870: 744f 6666 6368 6169 6e4c 6f6f 6b75 7028  tOffchainLookup(
-00026880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026890: 204f 4646 4348 4149 4e5f 4c4f 4f4b 5550   OFFCHAIN_LOOKUP
-000268a0: 5f54 4553 545f 4441 5441 0a20 2020 2020  _TEST_DATA.     
-000268b0: 2020 2020 2020 2029 2e63 616c 6c28 290a         ).call().
-000268c0: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-000268d0: 685f 6361 6c6c 5f63 6f6e 7469 6e75 6f75  h_call_continuou
-000268e0: 735f 6f66 6663 6861 696e 5f6c 6f6f 6b75  s_offchain_looku
-000268f0: 705f 7261 6973 6573 5f77 6974 685f 746f  p_raises_with_to
-00026900: 6f5f 6d61 6e79 5f72 6571 7565 7374 7328  o_many_requests(
-00026910: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00026920: 2020 2020 2020 2077 333a 2022 5765 6233         w3: "Web3
-00026930: 222c 0a20 2020 2020 2020 206f 6666 6368  ",.        offch
-00026940: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
-00026950: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
-00026960: 0a20 2020 2020 2020 2075 6e6c 6f63 6b65  .        unlocke
-00026970: 645f 6163 636f 756e 743a 2043 6865 636b  d_account: Check
-00026980: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
-00026990: 2020 2020 6d6f 6e6b 6579 7061 7463 683a      monkeypatch:
-000269a0: 2022 4d6f 6e6b 6579 5061 7463 6822 2c0a   "MonkeyPatch",.
-000269b0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-000269c0: 2020 2020 2020 206e 6f72 6d61 6c69 7a65         normalize
-000269d0: 645f 636f 6e74 7261 6374 5f61 6464 7265  d_contract_addre
-000269e0: 7373 203d 2074 6f5f 6865 785f 6966 5f62  ss = to_hex_if_b
-000269f0: 7974 6573 280a 2020 2020 2020 2020 2020  ytes(.          
-00026a00: 2020 6f66 6663 6861 696e 5f6c 6f6f 6b75    offchain_looku
-00026a10: 705f 636f 6e74 7261 6374 2e61 6464 7265  p_contract.addre
-00026a20: 7373 0a20 2020 2020 2020 2029 2e6c 6f77  ss.        ).low
-00026a30: 6572 2829 0a20 2020 2020 2020 206d 6f63  er().        moc
-00026a40: 6b5f 6f66 6663 6861 696e 5f6c 6f6f 6b75  k_offchain_looku
-00026a50: 705f 7265 7175 6573 745f 7265 7370 6f6e  p_request_respon
-00026a60: 7365 280a 2020 2020 2020 2020 2020 2020  se(.            
-00026a70: 6d6f 6e6b 6579 7061 7463 682c 0a20 2020  monkeypatch,.   
-00026a80: 2020 2020 2020 2020 206d 6f63 6b65 645f           mocked_
-00026a90: 7265 7175 6573 745f 7572 6c3d 6622 6874  request_url=f"ht
-00026aa0: 7470 733a 2f2f 7765 6233 2e70 792f 6761  tps://web3.py/ga
-00026ab0: 7465 7761 792f 7b6e 6f72 6d61 6c69 7a65  teway/{normalize
-00026ac0: 645f 636f 6e74 7261 6374 5f61 6464 7265  d_contract_addre
-00026ad0: 7373 7d2f 3078 2e6a 736f 6e22 2c20 2023  ss}/0x.json",  #
-00026ae0: 206e 6f71 613a 2045 3530 310a 2020 2020   noqa: E501.    
-00026af0: 2020 2020 290a 2020 2020 2020 2020 7769      ).        wi
-00026b00: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-00026b10: 2854 6f6f 4d61 6e79 5265 7175 6573 7473  (TooManyRequests
-00026b20: 2c20 6d61 7463 683d 2254 6f6f 206d 616e  , match="Too man
-00026b30: 7920 4343 4950 2072 6561 6420 7265 6469  y CCIP read redi
-00026b40: 7265 6374 7322 293a 0a20 2020 2020 2020  rects"):.       
-00026b50: 2020 2020 206f 6666 6368 6169 6e5f 6c6f       offchain_lo
-00026b60: 6f6b 7570 5f63 6f6e 7472 6163 742e 6361  okup_contract.ca
-00026b70: 6c6c 6572 2829 2e63 6f6e 7469 6e75 6f75  ller().continuou
-00026b80: 734f 6666 6368 6169 6e4c 6f6f 6b75 7028  sOffchainLookup(
-00026b90: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-00026ba0: 6574 685f 6573 7469 6d61 7465 5f67 6173  eth_estimate_gas
-00026bb0: 5f72 6576 6572 745f 7769 7468 5f6d 7367  _revert_with_msg
-00026bc0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00026bd0: 2020 2020 2020 2020 7733 3a20 2257 6562          w3: "Web
-00026be0: 3322 2c0a 2020 2020 2020 2020 7265 7665  3",.        reve
-00026bf0: 7274 5f63 6f6e 7472 6163 743a 2022 436f  rt_contract: "Co
-00026c00: 6e74 7261 6374 222c 0a20 2020 2020 2020  ntract",.       
-00026c10: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
-00026c20: 743a 2043 6865 636b 7375 6d41 6464 7265  t: ChecksumAddre
-00026c30: 7373 2c0a 2020 2020 2920 2d3e 204e 6f6e  ss,.    ) -> Non
-00026c40: 653a 0a20 2020 2020 2020 2077 6974 6820  e:.        with 
-00026c50: 7079 7465 7374 2e72 6169 7365 7328 0a20  pytest.raises(. 
-00026c60: 2020 2020 2020 2020 2020 2043 6f6e 7472             Contr
-00026c70: 6163 744c 6f67 6963 4572 726f 722c 206d  actLogicError, m
-00026c80: 6174 6368 3d22 6578 6563 7574 696f 6e20  atch="execution 
-00026c90: 7265 7665 7274 6564 3a20 4675 6e63 7469  reverted: Functi
-00026ca0: 6f6e 2068 6173 2062 6565 6e20 7265 7665  on has been reve
-00026cb0: 7274 6564 220a 2020 2020 2020 2020 293a  rted".        ):
-00026cc0: 0a20 2020 2020 2020 2020 2020 2074 786e  .            txn
-00026cd0: 5f70 6172 616d 7320 3d20 7265 7665 7274  _params = revert
-00026ce0: 5f63 6f6e 7472 6163 742e 5f70 7265 7061  _contract._prepa
-00026cf0: 7265 5f74 7261 6e73 6163 7469 6f6e 280a  re_transaction(.
-00026d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026d10: 666e 5f6e 616d 653d 2272 6576 6572 7457  fn_name="revertW
-00026d20: 6974 684d 6573 7361 6765 222c 0a20 2020  ithMessage",.   
-00026d30: 2020 2020 2020 2020 2020 2020 2074 7261               tra
-00026d40: 6e73 6163 7469 6f6e 3d7b 0a20 2020 2020  nsaction={.     
-00026d50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00026d60: 6672 6f6d 223a 2075 6e6c 6f63 6b65 645f  from": unlocked_
-00026d70: 6163 636f 756e 742c 0a20 2020 2020 2020  account,.       
-00026d80: 2020 2020 2020 2020 2020 2020 2022 746f               "to
-00026d90: 223a 2072 6576 6572 745f 636f 6e74 7261  ": revert_contra
-00026da0: 6374 2e61 6464 7265 7373 2c0a 2020 2020  ct.address,.    
-00026db0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-00026dc0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00026dd0: 2020 2020 2020 2020 2077 332e 6574 682e           w3.eth.
-00026de0: 6573 7469 6d61 7465 5f67 6173 2874 786e  estimate_gas(txn
-00026df0: 5f70 6172 616d 7329 0a0a 2020 2020 6465  _params)..    de
-00026e00: 6620 7465 7374 5f65 7468 5f65 7374 696d  f test_eth_estim
-00026e10: 6174 655f 6761 735f 7265 7665 7274 5f77  ate_gas_revert_w
-00026e20: 6974 686f 7574 5f6d 7367 280a 2020 2020  ithout_msg(.    
-00026e30: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00026e40: 2020 7733 3a20 2257 6562 3322 2c0a 2020    w3: "Web3",.  
-00026e50: 2020 2020 2020 7265 7665 7274 5f63 6f6e        revert_con
-00026e60: 7472 6163 743a 2022 436f 6e74 7261 6374  tract: "Contract
-00026e70: 222c 0a20 2020 2020 2020 2075 6e6c 6f63  ",.        unloc
-00026e80: 6b65 645f 6163 636f 756e 743a 2043 6865  ked_account: Che
-00026e90: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
-00026ea0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00026eb0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-00026ec0: 2e72 6169 7365 7328 436f 6e74 7261 6374  .raises(Contract
-00026ed0: 4c6f 6769 6345 7272 6f72 2c20 6d61 7463  LogicError, matc
-00026ee0: 683d 2265 7865 6375 7469 6f6e 2072 6576  h="execution rev
-00026ef0: 6572 7465 6422 293a 0a20 2020 2020 2020  erted"):.       
-00026f00: 2020 2020 2074 786e 5f70 6172 616d 7320       txn_params 
-00026f10: 3d20 7265 7665 7274 5f63 6f6e 7472 6163  = revert_contrac
-00026f20: 742e 5f70 7265 7061 7265 5f74 7261 6e73  t._prepare_trans
-00026f30: 6163 7469 6f6e 280a 2020 2020 2020 2020  action(.        
-00026f40: 2020 2020 2020 2020 666e 5f6e 616d 653d          fn_name=
-00026f50: 2272 6576 6572 7457 6974 686f 7574 4d65  "revertWithoutMe
-00026f60: 7373 6167 6522 2c0a 2020 2020 2020 2020  ssage",.        
-00026f70: 2020 2020 2020 2020 7472 616e 7361 6374          transact
-00026f80: 696f 6e3d 7b0a 2020 2020 2020 2020 2020  ion={.          
-00026f90: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-00026fa0: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
-00026fb0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-00026fc0: 2020 2020 2020 2020 2274 6f22 3a20 7265          "to": re
-00026fd0: 7665 7274 5f63 6f6e 7472 6163 742e 6164  vert_contract.ad
-00026fe0: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
-00026ff0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00027000: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00027010: 2020 2020 7733 2e65 7468 2e65 7374 696d      w3.eth.estim
-00027020: 6174 655f 6761 7328 7478 6e5f 7061 7261  ate_gas(txn_para
-00027030: 6d73 290a 0a20 2020 2064 6566 2074 6573  ms)..    def tes
-00027040: 745f 6574 685f 6573 7469 6d61 7465 5f67  t_eth_estimate_g
-00027050: 6173 5f63 7573 746f 6d5f 6572 726f 725f  as_custom_error_
-00027060: 7265 7665 7274 5f77 6974 685f 6d73 6728  revert_with_msg(
-00027070: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00027080: 2020 2020 2020 2077 333a 2022 5765 6233         w3: "Web3
-00027090: 222c 0a20 2020 2020 2020 2072 6576 6572  ",.        rever
-000270a0: 745f 636f 6e74 7261 6374 3a20 2243 6f6e  t_contract: "Con
-000270b0: 7472 6163 7422 2c0a 2020 2020 2020 2020  tract",.        
-000270c0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
-000270d0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-000270e0: 732c 0a20 2020 2029 202d 3e20 4e6f 6e65  s,.    ) -> None
-000270f0: 3a0a 2020 2020 2020 2020 6461 7461 203d  :.        data =
-00027100: 2072 6576 6572 745f 636f 6e74 7261 6374   revert_contract
-00027110: 2e65 6e63 6f64 655f 6162 6928 0a20 2020  .encode_abi(.   
-00027120: 2020 2020 2020 2020 2066 6e5f 6e61 6d65           fn_name
-00027130: 3d22 556e 6175 7468 6f72 697a 6564 5769  ="UnauthorizedWi
-00027140: 7468 4d65 7373 6167 6522 2c20 6172 6773  thMessage", args
-00027150: 3d5b 2259 6f75 2061 7265 206e 6f74 2061  =["You are not a
-00027160: 7574 686f 7269 7a65 6422 5d0a 2020 2020  uthorized"].    
-00027170: 2020 2020 290a 2020 2020 2020 2020 7478      ).        tx
-00027180: 6e5f 7061 7261 6d73 203d 2072 6576 6572  n_params = rever
-00027190: 745f 636f 6e74 7261 6374 2e5f 7072 6570  t_contract._prep
-000271a0: 6172 655f 7472 616e 7361 6374 696f 6e28  are_transaction(
-000271b0: 0a20 2020 2020 2020 2020 2020 2066 6e5f  .            fn_
-000271c0: 6e61 6d65 3d22 6375 7374 6f6d 4572 726f  name="customErro
-000271d0: 7257 6974 684d 6573 7361 6765 222c 0a20  rWithMessage",. 
-000271e0: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-000271f0: 6163 7469 6f6e 3d7b 0a20 2020 2020 2020  action={.       
-00027200: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
-00027210: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
-00027220: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00027230: 2020 2022 746f 223a 2072 6576 6572 745f     "to": revert_
-00027240: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
-00027250: 2c0a 2020 2020 2020 2020 2020 2020 7d2c  ,.            },
-00027260: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00027270: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-00027280: 6169 7365 7328 436f 6e74 7261 6374 4375  aises(ContractCu
-00027290: 7374 6f6d 4572 726f 722c 206d 6174 6368  stomError, match
-000272a0: 3d64 6174 6129 2061 7320 6578 6369 6e66  =data) as excinf
-000272b0: 6f3a 0a20 2020 2020 2020 2020 2020 2077  o:.            w
-000272c0: 332e 6574 682e 6573 7469 6d61 7465 5f67  3.eth.estimate_g
-000272d0: 6173 2874 786e 5f70 6172 616d 7329 0a20  as(txn_params). 
-000272e0: 2020 2020 2020 2061 7373 6572 7420 6578         assert ex
-000272f0: 6369 6e66 6f2e 7661 6c75 652e 6461 7461  cinfo.value.data
-00027300: 203d 3d20 6461 7461 0a0a 2020 2020 6465   == data..    de
-00027310: 6620 7465 7374 5f65 7468 5f65 7374 696d  f test_eth_estim
-00027320: 6174 655f 6761 735f 6375 7374 6f6d 5f65  ate_gas_custom_e
-00027330: 7272 6f72 5f72 6576 6572 745f 7769 7468  rror_revert_with
-00027340: 6f75 745f 6d73 6728 0a20 2020 2020 2020  out_msg(.       
-00027350: 2073 656c 662c 0a20 2020 2020 2020 2077   self,.        w
-00027360: 333a 2022 5765 6233 222c 0a20 2020 2020  3: "Web3",.     
-00027370: 2020 2072 6576 6572 745f 636f 6e74 7261     revert_contra
-00027380: 6374 3a20 2243 6f6e 7472 6163 7422 2c0a  ct: "Contract",.
-00027390: 2020 2020 2020 2020 756e 6c6f 636b 6564          unlocked
-000273a0: 5f61 6363 6f75 6e74 3a20 4368 6563 6b73  _account: Checks
-000273b0: 756d 4164 6472 6573 732c 0a20 2020 2029  umAddress,.    )
-000273c0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-000273d0: 2020 6461 7461 203d 2072 6576 6572 745f    data = revert_
-000273e0: 636f 6e74 7261 6374 2e65 6e63 6f64 655f  contract.encode_
-000273f0: 6162 6928 666e 5f6e 616d 653d 2255 6e61  abi(fn_name="Una
-00027400: 7574 686f 7269 7a65 6422 290a 2020 2020  uthorized").    
-00027410: 2020 2020 7478 6e5f 7061 7261 6d73 203d      txn_params =
-00027420: 2072 6576 6572 745f 636f 6e74 7261 6374   revert_contract
-00027430: 2e5f 7072 6570 6172 655f 7472 616e 7361  ._prepare_transa
-00027440: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
-00027450: 2020 2066 6e5f 6e61 6d65 3d22 6375 7374     fn_name="cust
-00027460: 6f6d 4572 726f 7257 6974 686f 7574 4d65  omErrorWithoutMe
-00027470: 7373 6167 6522 2c0a 2020 2020 2020 2020  ssage",.        
-00027480: 2020 2020 7472 616e 7361 6374 696f 6e3d      transaction=
-00027490: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-000274a0: 2020 2266 726f 6d22 3a20 756e 6c6f 636b    "from": unlock
-000274b0: 6564 5f61 6363 6f75 6e74 2c0a 2020 2020  ed_account,.    
-000274c0: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
-000274d0: 3a20 7265 7665 7274 5f63 6f6e 7472 6163  : revert_contrac
-000274e0: 742e 6164 6472 6573 732c 0a20 2020 2020  t.address,.     
-000274f0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00027500: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
-00027510: 2070 7974 6573 742e 7261 6973 6573 2843   pytest.raises(C
-00027520: 6f6e 7472 6163 7443 7573 746f 6d45 7272  ontractCustomErr
-00027530: 6f72 2c20 6d61 7463 683d 6461 7461 2920  or, match=data) 
-00027540: 6173 2065 7863 696e 666f 3a0a 2020 2020  as excinfo:.    
-00027550: 2020 2020 2020 2020 7733 2e65 7468 2e65          w3.eth.e
-00027560: 7374 696d 6174 655f 6761 7328 7478 6e5f  stimate_gas(txn_
-00027570: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-00027580: 6173 7365 7274 2065 7863 696e 666f 2e76  assert excinfo.v
-00027590: 616c 7565 2e64 6174 6120 3d3d 2064 6174  alue.data == dat
-000275a0: 610a 0a20 2020 2064 6566 2074 6573 745f  a..    def test_
-000275b0: 6574 685f 6573 7469 6d61 7465 5f67 6173  eth_estimate_gas
-000275c0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-000275d0: 7733 3a20 2257 6562 3322 2c20 756e 6c6f  w3: "Web3", unlo
-000275e0: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-000275f0: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-00027600: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-00027610: 204e 6f6e 653a 0a20 2020 2020 2020 2067   None:.        g
-00027620: 6173 5f65 7374 696d 6174 6520 3d20 7733  as_estimate = w3
-00027630: 2e65 7468 2e65 7374 696d 6174 655f 6761  .eth.estimate_ga
-00027640: 7328 0a20 2020 2020 2020 2020 2020 207b  s(.            {
-00027650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027660: 2022 6672 6f6d 223a 2075 6e6c 6f63 6b65   "from": unlocke
-00027670: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
-00027680: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-00027690: 2020 2020 2022 746f 223a 2075 6e6c 6f63       "to": unloc
-000276a0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
-000276b0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-000276c0: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
-000276d0: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
-000276e0: 2020 2020 7d0a 2020 2020 2020 2020 290a      }.        ).
-000276f0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00027700: 735f 696e 7465 6765 7228 6761 735f 6573  s_integer(gas_es
-00027710: 7469 6d61 7465 290a 2020 2020 2020 2020  timate).        
-00027720: 6173 7365 7274 2067 6173 5f65 7374 696d  assert gas_estim
-00027730: 6174 6520 3e20 300a 0a20 2020 2064 6566  ate > 0..    def
-00027740: 2074 6573 745f 6574 685f 6573 7469 6d61   test_eth_estima
-00027750: 7465 5f67 6173 5f77 6974 685f 626c 6f63  te_gas_with_bloc
-00027760: 6b28 0a20 2020 2020 2020 2073 656c 662c  k(.        self,
-00027770: 2077 333a 2022 5765 6233 222c 2075 6e6c   w3: "Web3", unl
-00027780: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
-00027790: 616c 5f74 7970 653a 2043 6865 636b 7375  al_type: Checksu
-000277a0: 6d41 6464 7265 7373 0a20 2020 2029 202d  mAddress.    ) -
-000277b0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-000277c0: 6761 735f 6573 7469 6d61 7465 203d 2077  gas_estimate = w
-000277d0: 332e 6574 682e 6573 7469 6d61 7465 5f67  3.eth.estimate_g
-000277e0: 6173 280a 2020 2020 2020 2020 2020 2020  as(.            
-000277f0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00027800: 2020 2266 726f 6d22 3a20 756e 6c6f 636b    "from": unlock
-00027810: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
-00027820: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00027830: 2020 2020 2020 2274 6f22 3a20 756e 6c6f        "to": unlo
-00027840: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-00027850: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-00027860: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
-00027870: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
-00027880: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-00027890: 2020 2020 226c 6174 6573 7422 2c0a 2020      "latest",.  
-000278a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000278b0: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
-000278c0: 7228 6761 735f 6573 7469 6d61 7465 290a  r(gas_estimate).
-000278d0: 2020 2020 2020 2020 6173 7365 7274 2067          assert g
-000278e0: 6173 5f65 7374 696d 6174 6520 3e20 300a  as_estimate > 0.
-000278f0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-00027900: 6b2e 7061 7261 6d65 7472 697a 6528 0a20  k.parametrize(. 
-00027910: 2020 2020 2020 2022 7061 7261 6d73 222c         "params",
-00027920: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-00027930: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-00027940: 2020 2020 2020 2020 2022 6e6f 6e63 6522           "nonce"
-00027950: 3a20 312c 2020 2320 696e 740a 2020 2020  : 1,  # int.    
-00027960: 2020 2020 2020 2020 2020 2020 2262 616c              "bal
-00027970: 616e 6365 223a 2031 2c20 2023 2069 6e74  ance": 1,  # int
-00027980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027990: 2022 636f 6465 223a 2048 6578 5374 7228   "code": HexStr(
-000279a0: 2230 7822 292c 2020 2320 4865 7853 7472  "0x"),  # HexStr
-000279b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000279c0: 2023 2077 6974 6820 7374 6174 650a 2020   # with state.  
-000279d0: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-000279e0: 7461 7465 223a 207b 4865 7853 7472 2866  tate": {HexStr(f
-000279f0: 2230 787b 2730 3027 202a 2033 327d 2229  "0x{'00' * 32}")
-00027a00: 3a20 4865 7853 7472 2866 2230 787b 2730  : HexStr(f"0x{'0
-00027a10: 3027 202a 2033 327d 2229 7d2c 0a20 2020  0' * 32}")},.   
-00027a20: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-00027a30: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00027a40: 2020 2020 2020 2020 2020 226e 6f6e 6365            "nonce
-00027a50: 223a 2048 6578 5374 7228 2230 7831 2229  ": HexStr("0x1")
-00027a60: 2c20 2023 2048 6578 5374 720a 2020 2020  ,  # HexStr.    
-00027a70: 2020 2020 2020 2020 2020 2020 2262 616c              "bal
-00027a80: 616e 6365 223a 2048 6578 5374 7228 2230  ance": HexStr("0
-00027a90: 7831 2229 2c20 2023 2048 6578 5374 720a  x1"),  # HexStr.
-00027aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ab0: 2263 6f64 6522 3a20 6222 5c78 3030 222c  "code": b"\x00",
-00027ac0: 2020 2320 6279 7465 730a 2020 2020 2020    # bytes.      
-00027ad0: 2020 2020 2020 2020 2020 2320 7769 7468            # with
-00027ae0: 2073 7461 7465 4469 6666 0a20 2020 2020   stateDiff.     
-00027af0: 2020 2020 2020 2020 2020 2022 7374 6174             "stat
-00027b00: 6544 6966 6622 3a20 7b48 6578 5374 7228  eDiff": {HexStr(
-00027b10: 6622 3078 7b27 3030 2720 2a20 3332 7d22  f"0x{'00' * 32}"
-00027b20: 293a 2048 6578 5374 7228 6622 3078 7b27  ): HexStr(f"0x{'
-00027b30: 3030 2720 2a20 3332 7d22 297d 2c0a 2020  00' * 32}")},.  
-00027b40: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-00027b50: 2020 2020 2029 2c0a 2020 2020 290a 2020       ),.    ).  
-00027b60: 2020 6465 6620 7465 7374 5f65 7468 5f65    def test_eth_e
-00027b70: 7374 696d 6174 655f 6761 735f 7769 7468  stimate_gas_with
-00027b80: 5f6f 7665 7272 6964 655f 7061 7261 6d5f  _override_param_
-00027b90: 7479 7065 5f63 6865 636b 280a 2020 2020  type_check(.    
-00027ba0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00027bb0: 2020 7733 3a20 2257 6562 3322 2c0a 2020    w3: "Web3",.  
-00027bc0: 2020 2020 2020 6d61 7468 5f63 6f6e 7472        math_contr
-00027bd0: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
-00027be0: 0a20 2020 2020 2020 2070 6172 616d 733a  .        params:
-00027bf0: 2053 7461 7465 4f76 6572 7269 6465 5061   StateOverridePa
-00027c00: 7261 6d73 2c0a 2020 2020 2920 2d3e 204e  rams,.    ) -> N
-00027c10: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
-00027c20: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-00027c30: 7320 3d20 7b22 6672 6f6d 223a 2077 332e  s = {"from": w3.
-00027c40: 6574 682e 636f 696e 6261 7365 7d0a 0a20  eth.coinbase}.. 
-00027c50: 2020 2020 2020 2023 2061 7373 6572 7420         # assert 
-00027c60: 646f 6573 206e 6f74 2072 6169 7365 0a20  does not raise. 
-00027c70: 2020 2020 2020 2077 332e 6574 682e 6573         w3.eth.es
-00027c80: 7469 6d61 7465 5f67 6173 2874 786e 5f70  timate_gas(txn_p
-00027c90: 6172 616d 732c 204e 6f6e 652c 207b 6d61  arams, None, {ma
-00027ca0: 7468 5f63 6f6e 7472 6163 742e 6164 6472  th_contract.addr
-00027cb0: 6573 733a 2070 6172 616d 737d 290a 0a20  ess: params}).. 
-00027cc0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-00027cd0: 6765 7442 6c6f 636b 4279 4861 7368 2873  getBlockByHash(s
-00027ce0: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
-00027cf0: 2065 6d70 7479 5f62 6c6f 636b 3a20 426c   empty_block: Bl
-00027d00: 6f63 6b44 6174 6129 202d 3e20 4e6f 6e65  ockData) -> None
-00027d10: 3a0a 2020 2020 2020 2020 626c 6f63 6b20  :.        block 
-00027d20: 3d20 7733 2e65 7468 2e67 6574 5f62 6c6f  = w3.eth.get_blo
-00027d30: 636b 2865 6d70 7479 5f62 6c6f 636b 5b22  ck(empty_block["
-00027d40: 6861 7368 225d 290a 2020 2020 2020 2020  hash"]).        
-00027d50: 6173 7365 7274 2062 6c6f 636b 5b22 6861  assert block["ha
-00027d60: 7368 225d 203d 3d20 656d 7074 795f 626c  sh"] == empty_bl
-00027d70: 6f63 6b5b 2268 6173 6822 5d0a 2020 2020  ock["hash"].    
-00027d80: 2020 2020 6173 7365 7274 2062 6c6f 636b      assert block
-00027d90: 5b22 7265 6365 6970 7473 526f 6f74 225d  ["receiptsRoot"]
-00027da0: 203d 3d20 656d 7074 795f 626c 6f63 6b5b   == empty_block[
-00027db0: 2272 6563 6569 7074 7352 6f6f 7422 5d0a  "receiptsRoot"].
-00027dc0: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
-00027dd0: 6c6f 636b 5b22 6c6f 6773 426c 6f6f 6d22  lock["logsBloom"
-00027de0: 5d20 3d3d 2065 6d70 7479 5f62 6c6f 636b  ] == empty_block
-00027df0: 5b22 6c6f 6773 426c 6f6f 6d22 5d0a 0a20  ["logsBloom"].. 
-00027e00: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-00027e10: 6765 7442 6c6f 636b 4279 4861 7368 5f6e  getBlockByHash_n
-00027e20: 6f74 5f66 6f75 6e64 280a 2020 2020 2020  ot_found(.      
-00027e30: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
-00027e40: 3322 2c20 656d 7074 795f 626c 6f63 6b3a  3", empty_block:
-00027e50: 2042 6c6f 636b 4461 7461 0a20 2020 2029   BlockData.    )
-00027e60: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00027e70: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-00027e80: 6973 6573 2842 6c6f 636b 4e6f 7446 6f75  ises(BlockNotFou
-00027e90: 6e64 293a 0a20 2020 2020 2020 2020 2020  nd):.           
-00027ea0: 2077 332e 6574 682e 6765 745f 626c 6f63   w3.eth.get_bloc
-00027eb0: 6b28 554e 4b4e 4f57 4e5f 4841 5348 290a  k(UNKNOWN_HASH).
-00027ec0: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00027ed0: 685f 6765 7442 6c6f 636b 4279 4861 7368  h_getBlockByHash
-00027ee0: 5f70 656e 6469 6e67 2873 656c 662c 2077  _pending(self, w
-00027ef0: 333a 2022 5765 6233 2229 202d 3e20 4e6f  3: "Web3") -> No
-00027f00: 6e65 3a0a 2020 2020 2020 2020 626c 6f63  ne:.        bloc
-00027f10: 6b20 3d20 7733 2e65 7468 2e67 6574 5f62  k = w3.eth.get_b
-00027f20: 6c6f 636b 2822 7065 6e64 696e 6722 290a  lock("pending").
-00027f30: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
-00027f40: 6c6f 636b 5b22 6861 7368 225d 2069 7320  lock["hash"] is 
-00027f50: 4e6f 6e65 0a0a 2020 2020 6465 6620 7465  None..    def te
-00027f60: 7374 5f65 7468 5f67 6574 426c 6f63 6b42  st_eth_getBlockB
-00027f70: 794e 756d 6265 725f 7769 7468 5f69 6e74  yNumber_with_int
-00027f80: 6567 6572 280a 2020 2020 2020 2020 7365  eger(.        se
-00027f90: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
-00027fa0: 656d 7074 795f 626c 6f63 6b3a 2042 6c6f  empty_block: Blo
-00027fb0: 636b 4461 7461 0a20 2020 2029 202d 3e20  ckData.    ) -> 
-00027fc0: 4e6f 6e65 3a0a 2020 2020 2020 2020 626c  None:.        bl
-00027fd0: 6f63 6b20 3d20 7733 2e65 7468 2e67 6574  ock = w3.eth.get
-00027fe0: 5f62 6c6f 636b 2865 6d70 7479 5f62 6c6f  _block(empty_blo
-00027ff0: 636b 5b22 6e75 6d62 6572 225d 290a 2020  ck["number"]).  
-00028000: 2020 2020 2020 6173 7365 7274 2062 6c6f        assert blo
-00028010: 636b 5b22 6e75 6d62 6572 225d 203d 3d20  ck["number"] == 
-00028020: 656d 7074 795f 626c 6f63 6b5b 226e 756d  empty_block["num
-00028030: 6265 7222 5d0a 0a20 2020 2064 6566 2074  ber"]..    def t
-00028040: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
-00028050: 4279 4e75 6d62 6572 5f6c 6174 6573 7428  ByNumber_latest(
-00028060: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-00028070: 333a 2022 5765 6233 222c 2065 6d70 7479  3: "Web3", empty
-00028080: 5f62 6c6f 636b 3a20 426c 6f63 6b44 6174  _block: BlockDat
-00028090: 610a 2020 2020 2920 2d3e 204e 6f6e 653a  a.    ) -> None:
-000280a0: 0a20 2020 2020 2020 2063 7572 7265 6e74  .        current
-000280b0: 5f62 6c6f 636b 5f6e 756d 6265 7220 3d20  _block_number = 
-000280c0: 7733 2e65 7468 2e62 6c6f 636b 5f6e 756d  w3.eth.block_num
-000280d0: 6265 720a 2020 2020 2020 2020 626c 6f63  ber.        bloc
-000280e0: 6b20 3d20 7733 2e65 7468 2e67 6574 5f62  k = w3.eth.get_b
-000280f0: 6c6f 636b 2822 6c61 7465 7374 2229 0a20  lock("latest"). 
-00028100: 2020 2020 2020 2061 7373 6572 7420 626c         assert bl
-00028110: 6f63 6b5b 226e 756d 6265 7222 5d20 3d3d  ock["number"] ==
-00028120: 2063 7572 7265 6e74 5f62 6c6f 636b 5f6e   current_block_n
-00028130: 756d 6265 720a 0a20 2020 2064 6566 2074  umber..    def t
-00028140: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
-00028150: 4279 4e75 6d62 6572 5f6e 6f74 5f66 6f75  ByNumber_not_fou
-00028160: 6e64 280a 2020 2020 2020 2020 7365 6c66  nd(.        self
-00028170: 2c20 7733 3a20 2257 6562 3322 2c20 656d  , w3: "Web3", em
-00028180: 7074 795f 626c 6f63 6b3a 2042 6c6f 636b  pty_block: Block
-00028190: 4461 7461 0a20 2020 2029 202d 3e20 4e6f  Data.    ) -> No
-000281a0: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
-000281b0: 2070 7974 6573 742e 7261 6973 6573 2842   pytest.raises(B
-000281c0: 6c6f 636b 4e6f 7446 6f75 6e64 293a 0a20  lockNotFound):. 
-000281d0: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
-000281e0: 682e 6765 745f 626c 6f63 6b28 426c 6f63  h.get_block(Bloc
-000281f0: 6b4e 756d 6265 7228 3132 3334 3529 290a  kNumber(12345)).
-00028200: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00028210: 685f 6765 7442 6c6f 636b 4279 4e75 6d62  h_getBlockByNumb
-00028220: 6572 5f70 656e 6469 6e67 280a 2020 2020  er_pending(.    
-00028230: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
-00028240: 6562 3322 2c20 656d 7074 795f 626c 6f63  eb3", empty_bloc
-00028250: 6b3a 2042 6c6f 636b 4461 7461 0a20 2020  k: BlockData.   
-00028260: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00028270: 2020 2020 6375 7272 656e 745f 626c 6f63      current_bloc
-00028280: 6b5f 6e75 6d62 6572 203d 2077 332e 6574  k_number = w3.et
-00028290: 682e 626c 6f63 6b5f 6e75 6d62 6572 0a20  h.block_number. 
-000282a0: 2020 2020 2020 2062 6c6f 636b 203d 2077         block = w
-000282b0: 332e 6574 682e 6765 745f 626c 6f63 6b28  3.eth.get_block(
-000282c0: 2270 656e 6469 6e67 2229 0a20 2020 2020  "pending").     
-000282d0: 2020 2061 7373 6572 7420 626c 6f63 6b5b     assert block[
-000282e0: 226e 756d 6265 7222 5d20 3d3d 2063 7572  "number"] == cur
-000282f0: 7265 6e74 5f62 6c6f 636b 5f6e 756d 6265  rent_block_numbe
-00028300: 7220 2b20 310a 0a20 2020 2064 6566 2074  r + 1..    def t
-00028310: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
-00028320: 4279 4e75 6d62 6572 5f65 6172 6c69 6573  ByNumber_earlies
-00028330: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
-00028340: 2077 333a 2022 5765 6233 222c 2065 6d70   w3: "Web3", emp
-00028350: 7479 5f62 6c6f 636b 3a20 426c 6f63 6b44  ty_block: BlockD
-00028360: 6174 610a 2020 2020 2920 2d3e 204e 6f6e  ata.    ) -> Non
-00028370: 653a 0a20 2020 2020 2020 2067 656e 6573  e:.        genes
-00028380: 6973 5f62 6c6f 636b 203d 2077 332e 6574  is_block = w3.et
-00028390: 682e 6765 745f 626c 6f63 6b28 426c 6f63  h.get_block(Bloc
-000283a0: 6b4e 756d 6265 7228 3029 290a 2020 2020  kNumber(0)).    
-000283b0: 2020 2020 626c 6f63 6b20 3d20 7733 2e65      block = w3.e
-000283c0: 7468 2e67 6574 5f62 6c6f 636b 2822 6561  th.get_block("ea
-000283d0: 726c 6965 7374 2229 0a20 2020 2020 2020  rliest").       
-000283e0: 2061 7373 6572 7420 626c 6f63 6b5b 226e   assert block["n
-000283f0: 756d 6265 7222 5d20 3d3d 2030 0a20 2020  umber"] == 0.   
-00028400: 2020 2020 2061 7373 6572 7420 626c 6f63       assert bloc
-00028410: 6b5b 2268 6173 6822 5d20 3d3d 2067 656e  k["hash"] == gen
-00028420: 6573 6973 5f62 6c6f 636b 5b22 6861 7368  esis_block["hash
-00028430: 225d 0a0a 2020 2020 6465 6620 7465 7374  "]..    def test
-00028440: 5f65 7468 5f67 6574 426c 6f63 6b42 794e  _eth_getBlockByN
-00028450: 756d 6265 725f 7361 6665 280a 2020 2020  umber_safe(.    
-00028460: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
-00028470: 6562 3322 2c20 656d 7074 795f 626c 6f63  eb3", empty_bloc
-00028480: 6b3a 2042 6c6f 636b 4461 7461 0a20 2020  k: BlockData.   
-00028490: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-000284a0: 2020 2020 626c 6f63 6b20 3d20 7733 2e65      block = w3.e
-000284b0: 7468 2e67 6574 5f62 6c6f 636b 2822 7361  th.get_block("sa
-000284c0: 6665 2229 0a20 2020 2020 2020 2061 7373  fe").        ass
-000284d0: 6572 7420 626c 6f63 6b20 6973 206e 6f74  ert block is not
-000284e0: 204e 6f6e 650a 2020 2020 2020 2020 6173   None.        as
-000284f0: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
-00028500: 626c 6f63 6b5b 226e 756d 6265 7222 5d2c  block["number"],
-00028510: 2069 6e74 290a 0a20 2020 2064 6566 2074   int)..    def t
-00028520: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
-00028530: 4279 4e75 6d62 6572 5f66 696e 616c 697a  ByNumber_finaliz
-00028540: 6564 280a 2020 2020 2020 2020 7365 6c66  ed(.        self
-00028550: 2c20 7733 3a20 2257 6562 3322 2c20 656d  , w3: "Web3", em
-00028560: 7074 795f 626c 6f63 6b3a 2042 6c6f 636b  pty_block: Block
-00028570: 4461 7461 0a20 2020 2029 202d 3e20 4e6f  Data.    ) -> No
-00028580: 6e65 3a0a 2020 2020 2020 2020 626c 6f63  ne:.        bloc
-00028590: 6b20 3d20 7733 2e65 7468 2e67 6574 5f62  k = w3.eth.get_b
-000285a0: 6c6f 636b 2822 6669 6e61 6c69 7a65 6422  lock("finalized"
-000285b0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-000285c0: 2062 6c6f 636b 2069 7320 6e6f 7420 4e6f   block is not No
-000285d0: 6e65 0a20 2020 2020 2020 2061 7373 6572  ne.        asser
-000285e0: 7420 6973 696e 7374 616e 6365 2862 6c6f  t isinstance(blo
-000285f0: 636b 5b22 6e75 6d62 6572 225d 2c20 696e  ck["number"], in
-00028600: 7429 0a0a 2020 2020 6465 6620 7465 7374  t)..    def test
-00028610: 5f65 7468 5f67 6574 426c 6f63 6b42 794e  _eth_getBlockByN
-00028620: 756d 6265 725f 6675 6c6c 5f74 7261 6e73  umber_full_trans
-00028630: 6163 7469 6f6e 7328 0a20 2020 2020 2020  actions(.       
-00028640: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
-00028650: 222c 2062 6c6f 636b 5f77 6974 685f 7478  ", block_with_tx
-00028660: 6e3a 2042 6c6f 636b 4461 7461 0a20 2020  n: BlockData.   
-00028670: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00028680: 2020 2020 626c 6f63 6b20 3d20 7733 2e65      block = w3.e
-00028690: 7468 2e67 6574 5f62 6c6f 636b 2862 6c6f  th.get_block(blo
-000286a0: 636b 5f77 6974 685f 7478 6e5b 226e 756d  ck_with_txn["num
-000286b0: 6265 7222 5d2c 2054 7275 6529 0a20 2020  ber"], True).   
-000286c0: 2020 2020 2074 7261 6e73 6163 7469 6f6e       transaction
-000286d0: 203d 2062 6c6f 636b 5b22 7472 616e 7361   = block["transa
-000286e0: 6374 696f 6e73 225d 5b30 5d0a 2020 2020  ctions"][0].    
-000286f0: 2020 2020 6173 7365 7274 2074 7261 6e73      assert trans
-00028700: 6163 7469 6f6e 5b22 6861 7368 225d 203d  action["hash"] =
-00028710: 3d20 626c 6f63 6b5f 7769 7468 5f74 786e  = block_with_txn
-00028720: 5b22 7472 616e 7361 6374 696f 6e73 225d  ["transactions"]
-00028730: 5b30 5d20 2023 2074 7970 653a 2069 676e  [0]  # type: ign
-00028740: 6f72 650a 0a20 2020 2064 6566 2074 6573  ore..    def tes
-00028750: 745f 6574 685f 6765 7442 6c6f 636b 5265  t_eth_getBlockRe
-00028760: 6365 6970 7473 5f68 6173 6828 0a20 2020  ceipts_hash(.   
-00028770: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
-00028780: 5765 6233 222c 2065 6d70 7479 5f62 6c6f  Web3", empty_blo
-00028790: 636b 3a20 426c 6f63 6b44 6174 610a 2020  ck: BlockData.  
-000287a0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-000287b0: 2020 2020 2072 6563 6569 7074 7320 3d20       receipts = 
-000287c0: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
-000287d0: 5f72 6563 6569 7074 7328 656d 7074 795f  _receipts(empty_
-000287e0: 626c 6f63 6b5b 2268 6173 6822 5d29 0a20  block["hash"]). 
-000287f0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00028800: 696e 7374 616e 6365 2872 6563 6569 7074  instance(receipt
-00028810: 732c 206c 6973 7429 0a0a 2020 2020 6465  s, list)..    de
-00028820: 6620 7465 7374 5f65 7468 5f67 6574 426c  f test_eth_getBl
-00028830: 6f63 6b52 6563 6569 7074 735f 6e6f 745f  ockReceipts_not_
-00028840: 666f 756e 6428 7365 6c66 2c20 7733 3a20  found(self, w3: 
-00028850: 2257 6562 3322 2920 2d3e 204e 6f6e 653a  "Web3") -> None:
-00028860: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-00028870: 7465 7374 2e72 6169 7365 7328 426c 6f63  test.raises(Bloc
-00028880: 6b4e 6f74 466f 756e 6429 3a0a 2020 2020  kNotFound):.    
-00028890: 2020 2020 2020 2020 7733 2e65 7468 2e67          w3.eth.g
-000288a0: 6574 5f62 6c6f 636b 5f72 6563 6569 7074  et_block_receipt
-000288b0: 7328 554e 4b4e 4f57 4e5f 4841 5348 290a  s(UNKNOWN_HASH).
-000288c0: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-000288d0: 685f 6765 7442 6c6f 636b 5265 6365 6970  h_getBlockReceip
-000288e0: 7473 5f77 6974 685f 696e 7465 6765 7228  ts_with_integer(
-000288f0: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-00028900: 333a 2022 5765 6233 222c 2065 6d70 7479  3: "Web3", empty
-00028910: 5f62 6c6f 636b 3a20 426c 6f63 6b44 6174  _block: BlockDat
-00028920: 610a 2020 2020 2920 2d3e 204e 6f6e 653a  a.    ) -> None:
-00028930: 0a20 2020 2020 2020 2072 6563 6569 7074  .        receipt
-00028940: 7320 3d20 7733 2e65 7468 2e67 6574 5f62  s = w3.eth.get_b
-00028950: 6c6f 636b 5f72 6563 6569 7074 7328 656d  lock_receipts(em
-00028960: 7074 795f 626c 6f63 6b5b 226e 756d 6265  pty_block["numbe
-00028970: 7222 5d29 0a20 2020 2020 2020 2061 7373  r"]).        ass
-00028980: 6572 7420 6973 696e 7374 616e 6365 2872  ert isinstance(r
-00028990: 6563 6569 7074 732c 206c 6973 7429 0a0a  eceipts, list)..
-000289a0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-000289b0: 5f67 6574 426c 6f63 6b52 6563 6569 7074  _getBlockReceipt
-000289c0: 735f 7361 6665 280a 2020 2020 2020 2020  s_safe(.        
-000289d0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-000289e0: 2c20 656d 7074 795f 626c 6f63 6b3a 2042  , empty_block: B
-000289f0: 6c6f 636b 4461 7461 0a20 2020 2029 202d  lockData.    ) -
-00028a00: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00028a10: 7265 6365 6970 7473 203d 2077 332e 6574  receipts = w3.et
-00028a20: 682e 6765 745f 626c 6f63 6b5f 7265 6365  h.get_block_rece
-00028a30: 6970 7473 2822 7361 6665 2229 0a20 2020  ipts("safe").   
-00028a40: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
-00028a50: 7374 616e 6365 2872 6563 6569 7074 732c  stance(receipts,
-00028a60: 206c 6973 7429 0a0a 2020 2020 6465 6620   list)..    def 
-00028a70: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
-00028a80: 6b52 6563 6569 7074 735f 6669 6e61 6c69  kReceipts_finali
-00028a90: 7a65 6428 0a20 2020 2020 2020 2073 656c  zed(.        sel
-00028aa0: 662c 2077 333a 2022 5765 6233 222c 2065  f, w3: "Web3", e
-00028ab0: 6d70 7479 5f62 6c6f 636b 3a20 426c 6f63  mpty_block: Bloc
-00028ac0: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
-00028ad0: 6f6e 653a 0a20 2020 2020 2020 2072 6563  one:.        rec
-00028ae0: 6569 7074 7320 3d20 7733 2e65 7468 2e67  eipts = w3.eth.g
-00028af0: 6574 5f62 6c6f 636b 5f72 6563 6569 7074  et_block_receipt
-00028b00: 7328 2266 696e 616c 697a 6564 2229 0a20  s("finalized"). 
-00028b10: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00028b20: 696e 7374 616e 6365 2872 6563 6569 7074  instance(receipt
-00028b30: 732c 206c 6973 7429 0a0a 2020 2020 6465  s, list)..    de
-00028b40: 6620 7465 7374 5f65 7468 5f67 6574 5472  f test_eth_getTr
-00028b50: 616e 7361 6374 696f 6e42 7948 6173 6828  ansactionByHash(
-00028b60: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-00028b70: 2c20 6d69 6e65 645f 7478 6e5f 6861 7368  , mined_txn_hash
-00028b80: 3a20 4865 7853 7472 2920 2d3e 204e 6f6e  : HexStr) -> Non
-00028b90: 653a 0a20 2020 2020 2020 2074 7261 6e73  e:.        trans
-00028ba0: 6163 7469 6f6e 203d 2077 332e 6574 682e  action = w3.eth.
-00028bb0: 6765 745f 7472 616e 7361 6374 696f 6e28  get_transaction(
-00028bc0: 6d69 6e65 645f 7478 6e5f 6861 7368 290a  mined_txn_hash).
-00028bd0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00028be0: 735f 6469 6374 2874 7261 6e73 6163 7469  s_dict(transacti
-00028bf0: 6f6e 290a 2020 2020 2020 2020 6173 7365  on).        asse
-00028c00: 7274 2074 7261 6e73 6163 7469 6f6e 5b22  rt transaction["
-00028c10: 6861 7368 225d 203d 3d20 4865 7842 7974  hash"] == HexByt
-00028c20: 6573 286d 696e 6564 5f74 786e 5f68 6173  es(mined_txn_has
-00028c30: 6829 0a0a 2020 2020 6465 6620 7465 7374  h)..    def test
-00028c40: 5f65 7468 5f67 6574 5472 616e 7361 6374  _eth_getTransact
-00028c50: 696f 6e42 7948 6173 685f 636f 6e74 7261  ionByHash_contra
-00028c60: 6374 5f63 7265 6174 696f 6e28 0a20 2020  ct_creation(.   
-00028c70: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
-00028c80: 5765 6233 222c 206d 6174 685f 636f 6e74  Web3", math_cont
-00028c90: 7261 6374 5f64 6570 6c6f 795f 7478 6e5f  ract_deploy_txn_
-00028ca0: 6861 7368 3a20 4865 7853 7472 0a20 2020  hash: HexStr.   
-00028cb0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00028cc0: 2020 2020 7472 616e 7361 6374 696f 6e20      transaction 
-00028cd0: 3d20 7733 2e65 7468 2e67 6574 5f74 7261  = w3.eth.get_tra
-00028ce0: 6e73 6163 7469 6f6e 286d 6174 685f 636f  nsaction(math_co
-00028cf0: 6e74 7261 6374 5f64 6570 6c6f 795f 7478  ntract_deploy_tx
-00028d00: 6e5f 6861 7368 290a 2020 2020 2020 2020  n_hash).        
-00028d10: 6173 7365 7274 2069 735f 6469 6374 2874  assert is_dict(t
-00028d20: 7261 6e73 6163 7469 6f6e 290a 2020 2020  ransaction).    
-00028d30: 2020 2020 6173 7365 7274 2074 7261 6e73      assert trans
-00028d40: 6163 7469 6f6e 5b22 746f 225d 2069 7320  action["to"] is 
-00028d50: 4e6f 6e65 2c20 6622 746f 2066 6965 6c64  None, f"to field
-00028d60: 2069 7320 7b74 7261 6e73 6163 7469 6f6e   is {transaction
-00028d70: 5b27 746f 275d 2172 7d22 0a0a 2020 2020  ['to']!r}"..    
-00028d80: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-00028d90: 5472 616e 7361 6374 696f 6e42 7942 6c6f  TransactionByBlo
-00028da0: 636b 4861 7368 416e 6449 6e64 6578 280a  ckHashAndIndex(.
-00028db0: 2020 2020 2020 2020 7365 6c66 2c20 7733          self, w3
-00028dc0: 3a20 2257 6562 3322 2c20 626c 6f63 6b5f  : "Web3", block_
-00028dd0: 7769 7468 5f74 786e 3a20 426c 6f63 6b44  with_txn: BlockD
-00028de0: 6174 612c 206d 696e 6564 5f74 786e 5f68  ata, mined_txn_h
-00028df0: 6173 683a 2048 6578 5374 720a 2020 2020  ash: HexStr.    
-00028e00: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00028e10: 2020 2074 7261 6e73 6163 7469 6f6e 203d     transaction =
-00028e20: 2077 332e 6574 682e 6765 745f 7472 616e   w3.eth.get_tran
-00028e30: 7361 6374 696f 6e5f 6279 5f62 6c6f 636b  saction_by_block
-00028e40: 2862 6c6f 636b 5f77 6974 685f 7478 6e5b  (block_with_txn[
-00028e50: 2268 6173 6822 5d2c 2030 290a 2020 2020  "hash"], 0).    
-00028e60: 2020 2020 6173 7365 7274 2069 735f 6469      assert is_di
-00028e70: 6374 2874 7261 6e73 6163 7469 6f6e 290a  ct(transaction).
-00028e80: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-00028e90: 7261 6e73 6163 7469 6f6e 5b22 6861 7368  ransaction["hash
-00028ea0: 225d 203d 3d20 4865 7842 7974 6573 286d  "] == HexBytes(m
-00028eb0: 696e 6564 5f74 786e 5f68 6173 6829 0a0a  ined_txn_hash)..
-00028ec0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-00028ed0: 5f67 6574 5472 616e 7361 6374 696f 6e42  _getTransactionB
-00028ee0: 7942 6c6f 636b 4e75 6d62 6572 416e 6449  yBlockNumberAndI
-00028ef0: 6e64 6578 280a 2020 2020 2020 2020 7365  ndex(.        se
-00028f00: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
-00028f10: 626c 6f63 6b5f 7769 7468 5f74 786e 3a20  block_with_txn: 
-00028f20: 426c 6f63 6b44 6174 612c 206d 696e 6564  BlockData, mined
-00028f30: 5f74 786e 5f68 6173 683a 2048 6578 5374  _txn_hash: HexSt
-00028f40: 720a 2020 2020 2920 2d3e 204e 6f6e 653a  r.    ) -> None:
-00028f50: 0a20 2020 2020 2020 2074 7261 6e73 6163  .        transac
-00028f60: 7469 6f6e 203d 2077 332e 6574 682e 6765  tion = w3.eth.ge
-00028f70: 745f 7472 616e 7361 6374 696f 6e5f 6279  t_transaction_by
-00028f80: 5f62 6c6f 636b 2862 6c6f 636b 5f77 6974  _block(block_wit
-00028f90: 685f 7478 6e5b 226e 756d 6265 7222 5d2c  h_txn["number"],
-00028fa0: 2030 290a 2020 2020 2020 2020 6173 7365   0).        asse
-00028fb0: 7274 2069 735f 6469 6374 2874 7261 6e73  rt is_dict(trans
-00028fc0: 6163 7469 6f6e 290a 2020 2020 2020 2020  action).        
-00028fd0: 6173 7365 7274 2074 7261 6e73 6163 7469  assert transacti
-00028fe0: 6f6e 5b22 6861 7368 225d 203d 3d20 4865  on["hash"] == He
-00028ff0: 7842 7974 6573 286d 696e 6564 5f74 786e  xBytes(mined_txn
-00029000: 5f68 6173 6829 0a0a 2020 2020 6465 6620  _hash)..    def 
-00029010: 7465 7374 5f65 7468 5f67 6574 5f74 7261  test_eth_get_tra
-00029020: 6e73 6163 7469 6f6e 5f72 6563 6569 7074  nsaction_receipt
-00029030: 5f6d 696e 6564 280a 2020 2020 2020 2020  _mined(.        
-00029040: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-00029050: 2c20 626c 6f63 6b5f 7769 7468 5f74 786e  , block_with_txn
-00029060: 3a20 426c 6f63 6b44 6174 612c 206d 696e  : BlockData, min
-00029070: 6564 5f74 786e 5f68 6173 683a 2048 6578  ed_txn_hash: Hex
-00029080: 5374 720a 2020 2020 2920 2d3e 204e 6f6e  Str.    ) -> Non
-00029090: 653a 0a20 2020 2020 2020 2072 6563 6569  e:.        recei
-000290a0: 7074 203d 2077 332e 6574 682e 6765 745f  pt = w3.eth.get_
-000290b0: 7472 616e 7361 6374 696f 6e5f 7265 6365  transaction_rece
-000290c0: 6970 7428 6d69 6e65 645f 7478 6e5f 6861  ipt(mined_txn_ha
-000290d0: 7368 290a 2020 2020 2020 2020 6173 7365  sh).        asse
-000290e0: 7274 2069 735f 6469 6374 2872 6563 6569  rt is_dict(recei
-000290f0: 7074 290a 2020 2020 2020 2020 6173 7365  pt).        asse
-00029100: 7274 2072 6563 6569 7074 5b22 626c 6f63  rt receipt["bloc
-00029110: 6b4e 756d 6265 7222 5d20 3d3d 2062 6c6f  kNumber"] == blo
-00029120: 636b 5f77 6974 685f 7478 6e5b 226e 756d  ck_with_txn["num
-00029130: 6265 7222 5d0a 2020 2020 2020 2020 6173  ber"].        as
-00029140: 7365 7274 2072 6563 6569 7074 5b22 626c  sert receipt["bl
-00029150: 6f63 6b48 6173 6822 5d20 3d3d 2062 6c6f  ockHash"] == blo
-00029160: 636b 5f77 6974 685f 7478 6e5b 2268 6173  ck_with_txn["has
-00029170: 6822 5d0a 2020 2020 2020 2020 6173 7365  h"].        asse
-00029180: 7274 2072 6563 6569 7074 5b22 7472 616e  rt receipt["tran
-00029190: 7361 6374 696f 6e49 6e64 6578 225d 203d  sactionIndex"] =
-000291a0: 3d20 300a 2020 2020 2020 2020 6173 7365  = 0.        asse
-000291b0: 7274 2072 6563 6569 7074 5b22 7472 616e  rt receipt["tran
-000291c0: 7361 6374 696f 6e48 6173 6822 5d20 3d3d  sactionHash"] ==
-000291d0: 2048 6578 4279 7465 7328 6d69 6e65 645f   HexBytes(mined_
-000291e0: 7478 6e5f 6861 7368 290a 2020 2020 2020  txn_hash).      
-000291f0: 2020 6173 7365 7274 2069 735f 6368 6563    assert is_chec
-00029200: 6b73 756d 5f61 6464 7265 7373 2872 6563  ksum_address(rec
-00029210: 6569 7074 5b22 746f 225d 290a 2020 2020  eipt["to"]).    
-00029220: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
-00029230: 7074 5b22 6672 6f6d 225d 2069 7320 6e6f  pt["from"] is no
-00029240: 7420 4e6f 6e65 0a20 2020 2020 2020 2061  t None.        a
-00029250: 7373 6572 7420 6973 5f63 6865 636b 7375  ssert is_checksu
-00029260: 6d5f 6164 6472 6573 7328 7265 6365 6970  m_address(receip
-00029270: 745b 2266 726f 6d22 5d29 0a0a 2020 2020  t["from"])..    
-00029280: 2020 2020 6566 6665 6374 6976 655f 6761      effective_ga
-00029290: 735f 7072 6963 6520 3d20 7265 6365 6970  s_price = receip
-000292a0: 745b 2265 6666 6563 7469 7665 4761 7350  t["effectiveGasP
-000292b0: 7269 6365 225d 0a20 2020 2020 2020 2061  rice"].        a
-000292c0: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-000292d0: 2865 6666 6563 7469 7665 5f67 6173 5f70  (effective_gas_p
-000292e0: 7269 6365 2c20 696e 7429 0a20 2020 2020  rice, int).     
-000292f0: 2020 2061 7373 6572 7420 6566 6665 6374     assert effect
-00029300: 6976 655f 6761 735f 7072 6963 6520 3e20  ive_gas_price > 
-00029310: 300a 0a20 2020 2064 6566 2074 6573 745f  0..    def test_
-00029320: 6574 685f 6765 745f 7472 616e 7361 6374  eth_get_transact
-00029330: 696f 6e5f 7265 6365 6970 745f 756e 6d69  ion_receipt_unmi
-00029340: 6e65 6428 0a20 2020 2020 2020 2073 656c  ned(.        sel
-00029350: 662c 2077 333a 2022 5765 6233 222c 2075  f, w3: "Web3", u
-00029360: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
-00029370: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
-00029380: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
-00029390: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-000293a0: 2020 7478 6e5f 6861 7368 203d 2077 332e    txn_hash = w3.
-000293b0: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
-000293c0: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-000293d0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-000293e0: 2020 2020 2266 726f 6d22 3a20 756e 6c6f      "from": unlo
-000293f0: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-00029400: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-00029410: 2020 2020 2020 2020 2274 6f22 3a20 756e          "to": un
-00029420: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-00029430: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-00029440: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-00029450: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-00029460: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-00029470: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00029480: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
-00029490: 5065 7247 6173 223a 2077 332e 746f 5f77  PerGas": w3.to_w
-000294a0: 6569 2833 2c20 2267 7765 6922 292c 0a20  ei(3, "gwei"),. 
-000294b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000294c0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-000294d0: 7247 6173 223a 2077 332e 746f 5f77 6569  rGas": w3.to_wei
-000294e0: 2831 2c20 2267 7765 6922 292c 0a20 2020  (1, "gwei"),.   
-000294f0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00029500: 2020 2029 0a20 2020 2020 2020 2077 6974     ).        wit
-00029510: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-00029520: 5472 616e 7361 6374 696f 6e4e 6f74 466f  TransactionNotFo
-00029530: 756e 6429 3a0a 2020 2020 2020 2020 2020  und):.          
-00029540: 2020 7733 2e65 7468 2e67 6574 5f74 7261    w3.eth.get_tra
-00029550: 6e73 6163 7469 6f6e 5f72 6563 6569 7074  nsaction_receipt
-00029560: 2874 786e 5f68 6173 6829 0a0a 2020 2020  (txn_hash)..    
-00029570: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-00029580: 5f74 7261 6e73 6163 7469 6f6e 5f72 6563  _transaction_rec
-00029590: 6569 7074 5f77 6974 685f 6c6f 675f 656e  eipt_with_log_en
-000295a0: 7472 7928 0a20 2020 2020 2020 2073 656c  try(.        sel
-000295b0: 662c 0a20 2020 2020 2020 2077 333a 2022  f,.        w3: "
-000295c0: 5765 6233 222c 0a20 2020 2020 2020 2062  Web3",.        b
-000295d0: 6c6f 636b 5f77 6974 685f 7478 6e5f 7769  lock_with_txn_wi
-000295e0: 7468 5f6c 6f67 3a20 426c 6f63 6b44 6174  th_log: BlockDat
-000295f0: 612c 0a20 2020 2020 2020 2065 6d69 7474  a,.        emitt
-00029600: 6572 5f63 6f6e 7472 6163 743a 2022 436f  er_contract: "Co
-00029610: 6e74 7261 6374 222c 0a20 2020 2020 2020  ntract",.       
-00029620: 2074 786e 5f68 6173 685f 7769 7468 5f6c   txn_hash_with_l
-00029630: 6f67 3a20 4865 7853 7472 2c0a 2020 2020  og: HexStr,.    
-00029640: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00029650: 2020 2072 6563 6569 7074 203d 2077 332e     receipt = w3.
-00029660: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
-00029670: 696f 6e5f 7265 6365 6970 7428 7478 6e5f  ion_receipt(txn_
-00029680: 6861 7368 5f77 6974 685f 6c6f 6729 0a20  hash_with_log). 
-00029690: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-000296a0: 5f64 6963 7428 7265 6365 6970 7429 0a20  _dict(receipt). 
-000296b0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-000296c0: 6365 6970 745b 2262 6c6f 636b 4e75 6d62  ceipt["blockNumb
-000296d0: 6572 225d 203d 3d20 626c 6f63 6b5f 7769  er"] == block_wi
-000296e0: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
-000296f0: 226e 756d 6265 7222 5d0a 2020 2020 2020  "number"].      
-00029700: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
-00029710: 5b22 626c 6f63 6b48 6173 6822 5d20 3d3d  ["blockHash"] ==
-00029720: 2062 6c6f 636b 5f77 6974 685f 7478 6e5f   block_with_txn_
-00029730: 7769 7468 5f6c 6f67 5b22 6861 7368 225d  with_log["hash"]
-00029740: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00029750: 7265 6365 6970 745b 2274 7261 6e73 6163  receipt["transac
-00029760: 7469 6f6e 496e 6465 7822 5d20 3d3d 2030  tionIndex"] == 0
-00029770: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00029780: 7265 6365 6970 745b 2274 7261 6e73 6163  receipt["transac
-00029790: 7469 6f6e 4861 7368 225d 203d 3d20 4865  tionHash"] == He
-000297a0: 7842 7974 6573 2874 786e 5f68 6173 685f  xBytes(txn_hash_
-000297b0: 7769 7468 5f6c 6f67 290a 0a20 2020 2020  with_log)..     
-000297c0: 2020 2061 7373 6572 7420 6c65 6e28 7265     assert len(re
-000297d0: 6365 6970 745b 226c 6f67 7322 5d29 203d  ceipt["logs"]) =
-000297e0: 3d20 310a 2020 2020 2020 2020 6c6f 675f  = 1.        log_
-000297f0: 656e 7472 7920 3d20 7265 6365 6970 745b  entry = receipt[
-00029800: 226c 6f67 7322 5d5b 305d 0a0a 2020 2020  "logs"][0]..    
-00029810: 2020 2020 6173 7365 7274 206c 6f67 5f65      assert log_e
-00029820: 6e74 7279 5b22 626c 6f63 6b4e 756d 6265  ntry["blockNumbe
-00029830: 7222 5d20 3d3d 2062 6c6f 636b 5f77 6974  r"] == block_wit
-00029840: 685f 7478 6e5f 7769 7468 5f6c 6f67 5b22  h_txn_with_log["
-00029850: 6e75 6d62 6572 225d 0a20 2020 2020 2020  number"].       
-00029860: 2061 7373 6572 7420 6c6f 675f 656e 7472   assert log_entr
-00029870: 795b 2262 6c6f 636b 4861 7368 225d 203d  y["blockHash"] =
-00029880: 3d20 626c 6f63 6b5f 7769 7468 5f74 786e  = block_with_txn
-00029890: 5f77 6974 685f 6c6f 675b 2268 6173 6822  _with_log["hash"
-000298a0: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
-000298b0: 206c 6f67 5f65 6e74 7279 5b22 6c6f 6749   log_entry["logI
-000298c0: 6e64 6578 225d 203d 3d20 300a 2020 2020  ndex"] == 0.    
-000298d0: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
-000298e0: 6d65 5f61 6464 7265 7373 286c 6f67 5f65  me_address(log_e
-000298f0: 6e74 7279 5b22 6164 6472 6573 7322 5d2c  ntry["address"],
-00029900: 2065 6d69 7474 6572 5f63 6f6e 7472 6163   emitter_contrac
-00029910: 742e 6164 6472 6573 7329 0a20 2020 2020  t.address).     
-00029920: 2020 2061 7373 6572 7420 6c6f 675f 656e     assert log_en
-00029930: 7472 795b 2274 7261 6e73 6163 7469 6f6e  try["transaction
-00029940: 496e 6465 7822 5d20 3d3d 2030 0a20 2020  Index"] == 0.   
-00029950: 2020 2020 2061 7373 6572 7420 6c6f 675f       assert log_
-00029960: 656e 7472 795b 2274 7261 6e73 6163 7469  entry["transacti
-00029970: 6f6e 4861 7368 225d 203d 3d20 4865 7842  onHash"] == HexB
-00029980: 7974 6573 2874 786e 5f68 6173 685f 7769  ytes(txn_hash_wi
-00029990: 7468 5f6c 6f67 290a 0a20 2020 2064 6566  th_log)..    def
-000299a0: 2074 6573 745f 6574 685f 7761 6974 5f66   test_eth_wait_f
-000299b0: 6f72 5f74 7261 6e73 6163 7469 6f6e 5f72  or_transaction_r
-000299c0: 6563 6569 7074 5f6d 696e 6564 280a 2020  eceipt_mined(.  
-000299d0: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
-000299e0: 2257 6562 3322 2c20 626c 6f63 6b5f 7769  "Web3", block_wi
-000299f0: 7468 5f74 786e 3a20 426c 6f63 6b44 6174  th_txn: BlockDat
-00029a00: 612c 206d 696e 6564 5f74 786e 5f68 6173  a, mined_txn_has
-00029a10: 683a 2048 6578 5374 720a 2020 2020 2920  h: HexStr.    ) 
-00029a20: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00029a30: 2072 6563 6569 7074 203d 2077 332e 6574   receipt = w3.et
-00029a40: 682e 7761 6974 5f66 6f72 5f74 7261 6e73  h.wait_for_trans
-00029a50: 6163 7469 6f6e 5f72 6563 6569 7074 286d  action_receipt(m
-00029a60: 696e 6564 5f74 786e 5f68 6173 6829 0a20  ined_txn_hash). 
-00029a70: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00029a80: 5f64 6963 7428 7265 6365 6970 7429 0a20  _dict(receipt). 
-00029a90: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-00029aa0: 6365 6970 745b 2262 6c6f 636b 4e75 6d62  ceipt["blockNumb
-00029ab0: 6572 225d 203d 3d20 626c 6f63 6b5f 7769  er"] == block_wi
-00029ac0: 7468 5f74 786e 5b22 6e75 6d62 6572 225d  th_txn["number"]
-00029ad0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00029ae0: 7265 6365 6970 745b 2262 6c6f 636b 4861  receipt["blockHa
-00029af0: 7368 225d 203d 3d20 626c 6f63 6b5f 7769  sh"] == block_wi
-00029b00: 7468 5f74 786e 5b22 6861 7368 225d 0a20  th_txn["hash"]. 
-00029b10: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-00029b20: 6365 6970 745b 2274 7261 6e73 6163 7469  ceipt["transacti
-00029b30: 6f6e 496e 6465 7822 5d20 3d3d 2030 0a20  onIndex"] == 0. 
-00029b40: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-00029b50: 6365 6970 745b 2274 7261 6e73 6163 7469  ceipt["transacti
-00029b60: 6f6e 4861 7368 225d 203d 3d20 4865 7842  onHash"] == HexB
-00029b70: 7974 6573 286d 696e 6564 5f74 786e 5f68  ytes(mined_txn_h
-00029b80: 6173 6829 0a20 2020 2020 2020 2061 7373  ash).        ass
-00029b90: 6572 7420 6973 5f63 6865 636b 7375 6d5f  ert is_checksum_
-00029ba0: 6164 6472 6573 7328 7265 6365 6970 745b  address(receipt[
-00029bb0: 2274 6f22 5d29 0a20 2020 2020 2020 2061  "to"]).        a
-00029bc0: 7373 6572 7420 7265 6365 6970 745b 2266  ssert receipt["f
-00029bd0: 726f 6d22 5d20 6973 206e 6f74 204e 6f6e  rom"] is not Non
-00029be0: 650a 2020 2020 2020 2020 6173 7365 7274  e.        assert
-00029bf0: 2069 735f 6368 6563 6b73 756d 5f61 6464   is_checksum_add
-00029c00: 7265 7373 2872 6563 6569 7074 5b22 6672  ress(receipt["fr
-00029c10: 6f6d 225d 290a 0a20 2020 2020 2020 2065  om"])..        e
-00029c20: 6666 6563 7469 7665 5f67 6173 5f70 7269  ffective_gas_pri
-00029c30: 6365 203d 2072 6563 6569 7074 5b22 6566  ce = receipt["ef
-00029c40: 6665 6374 6976 6547 6173 5072 6963 6522  fectiveGasPrice"
-00029c50: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
-00029c60: 2069 7369 6e73 7461 6e63 6528 6566 6665   isinstance(effe
-00029c70: 6374 6976 655f 6761 735f 7072 6963 652c  ctive_gas_price,
-00029c80: 2069 6e74 290a 2020 2020 2020 2020 6173   int).        as
-00029c90: 7365 7274 2065 6666 6563 7469 7665 5f67  sert effective_g
-00029ca0: 6173 5f70 7269 6365 203e 2030 0a0a 2020  as_price > 0..  
-00029cb0: 2020 6465 6620 7465 7374 5f65 7468 5f77    def test_eth_w
-00029cc0: 6169 745f 666f 725f 7472 616e 7361 6374  ait_for_transact
-00029cd0: 696f 6e5f 7265 6365 6970 745f 756e 6d69  ion_receipt_unmi
-00029ce0: 6e65 6428 0a20 2020 2020 2020 2073 656c  ned(.        sel
-00029cf0: 662c 2077 333a 2022 5765 6233 222c 2075  f, w3: "Web3", u
-00029d00: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
-00029d10: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
-00029d20: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
-00029d30: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00029d40: 2020 7478 6e5f 6861 7368 203d 2077 332e    txn_hash = w3.
-00029d50: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
-00029d60: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-00029d70: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-00029d80: 2020 2020 2266 726f 6d22 3a20 756e 6c6f      "from": unlo
-00029d90: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
-00029da0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-00029db0: 2020 2020 2020 2020 2274 6f22 3a20 756e          "to": un
-00029dc0: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
-00029dd0: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-00029de0: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-00029df0: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-00029e00: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-00029e10: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00029e20: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
-00029e30: 5065 7247 6173 223a 2077 332e 746f 5f77  PerGas": w3.to_w
-00029e40: 6569 2833 2c20 2267 7765 6922 292c 0a20  ei(3, "gwei"),. 
-00029e50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00029e60: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-00029e70: 7247 6173 223a 2077 332e 746f 5f77 6569  rGas": w3.to_wei
-00029e80: 2831 2c20 2267 7765 6922 292c 0a20 2020  (1, "gwei"),.   
-00029e90: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00029ea0: 2020 2029 0a0a 2020 2020 2020 2020 7469     )..        ti
-00029eb0: 6d65 6f75 7420 3d20 302e 3031 0a20 2020  meout = 0.01.   
-00029ec0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-00029ed0: 2e72 6169 7365 7328 5469 6d65 4578 6861  .raises(TimeExha
-00029ee0: 7573 7465 6429 2061 7320 6578 635f 696e  usted) as exc_in
-00029ef0: 666f 3a0a 2020 2020 2020 2020 2020 2020  fo:.            
-00029f00: 7733 2e65 7468 2e77 6169 745f 666f 725f  w3.eth.wait_for_
-00029f10: 7472 616e 7361 6374 696f 6e5f 7265 6365  transaction_rece
-00029f20: 6970 7428 7478 6e5f 6861 7368 2c20 7469  ipt(txn_hash, ti
-00029f30: 6d65 6f75 743d 7469 6d65 6f75 7429 0a0a  meout=timeout)..
-00029f40: 2020 2020 2020 2020 6173 7365 7274 2028          assert (
-00029f50: 5f20 696e 2073 7472 2865 7863 5f69 6e66  _ in str(exc_inf
-00029f60: 6f29 2066 6f72 205f 2069 6e20 5b72 6570  o) for _ in [rep
-00029f70: 7228 7478 6e5f 6861 7368 292c 2074 696d  r(txn_hash), tim
-00029f80: 656f 7574 5d29 0a0a 2020 2020 6465 6620  eout])..    def 
-00029f90: 7465 7374 5f65 7468 5f77 6169 745f 666f  test_eth_wait_fo
-00029fa0: 725f 7472 616e 7361 6374 696f 6e5f 7265  r_transaction_re
-00029fb0: 6365 6970 745f 7769 7468 5f6c 6f67 5f65  ceipt_with_log_e
-00029fc0: 6e74 7279 280a 2020 2020 2020 2020 7365  ntry(.        se
-00029fd0: 6c66 2c0a 2020 2020 2020 2020 7733 3a20  lf,.        w3: 
-00029fe0: 2257 6562 3322 2c0a 2020 2020 2020 2020  "Web3",.        
-00029ff0: 626c 6f63 6b5f 7769 7468 5f74 786e 5f77  block_with_txn_w
-0002a000: 6974 685f 6c6f 673a 2042 6c6f 636b 4461  ith_log: BlockDa
-0002a010: 7461 2c0a 2020 2020 2020 2020 656d 6974  ta,.        emit
-0002a020: 7465 725f 636f 6e74 7261 6374 3a20 2243  ter_contract: "C
-0002a030: 6f6e 7472 6163 7422 2c0a 2020 2020 2020  ontract",.      
-0002a040: 2020 7478 6e5f 6861 7368 5f77 6974 685f    txn_hash_with_
-0002a050: 6c6f 673a 2048 6578 5374 722c 0a20 2020  log: HexStr,.   
-0002a060: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-0002a070: 2020 2020 7265 6365 6970 7420 3d20 7733      receipt = w3
-0002a080: 2e65 7468 2e77 6169 745f 666f 725f 7472  .eth.wait_for_tr
-0002a090: 616e 7361 6374 696f 6e5f 7265 6365 6970  ansaction_receip
-0002a0a0: 7428 7478 6e5f 6861 7368 5f77 6974 685f  t(txn_hash_with_
-0002a0b0: 6c6f 6729 0a20 2020 2020 2020 2061 7373  log).        ass
-0002a0c0: 6572 7420 6973 5f64 6963 7428 7265 6365  ert is_dict(rece
-0002a0d0: 6970 7429 0a20 2020 2020 2020 2061 7373  ipt).        ass
-0002a0e0: 6572 7420 7265 6365 6970 745b 2262 6c6f  ert receipt["blo
-0002a0f0: 636b 4e75 6d62 6572 225d 203d 3d20 626c  ckNumber"] == bl
-0002a100: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
-0002a110: 685f 6c6f 675b 226e 756d 6265 7222 5d0a  h_log["number"].
-0002a120: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-0002a130: 6563 6569 7074 5b22 626c 6f63 6b48 6173  eceipt["blockHas
-0002a140: 6822 5d20 3d3d 2062 6c6f 636b 5f77 6974  h"] == block_wit
-0002a150: 685f 7478 6e5f 7769 7468 5f6c 6f67 5b22  h_txn_with_log["
-0002a160: 6861 7368 225d 0a20 2020 2020 2020 2061  hash"].        a
-0002a170: 7373 6572 7420 7265 6365 6970 745b 2274  ssert receipt["t
-0002a180: 7261 6e73 6163 7469 6f6e 496e 6465 7822  ransactionIndex"
-0002a190: 5d20 3d3d 2030 0a20 2020 2020 2020 2061  ] == 0.        a
-0002a1a0: 7373 6572 7420 7265 6365 6970 745b 2274  ssert receipt["t
-0002a1b0: 7261 6e73 6163 7469 6f6e 4861 7368 225d  ransactionHash"]
-0002a1c0: 203d 3d20 4865 7842 7974 6573 2874 786e   == HexBytes(txn
-0002a1d0: 5f68 6173 685f 7769 7468 5f6c 6f67 290a  _hash_with_log).
-0002a1e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0002a1f0: 6c65 6e28 7265 6365 6970 745b 226c 6f67  len(receipt["log
-0002a200: 7322 5d29 203d 3d20 310a 2020 2020 2020  s"]) == 1.      
-0002a210: 2020 6c6f 675f 656e 7472 7920 3d20 7265    log_entry = re
-0002a220: 6365 6970 745b 226c 6f67 7322 5d5b 305d  ceipt["logs"][0]
-0002a230: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-0002a240: 206c 6f67 5f65 6e74 7279 5b22 626c 6f63   log_entry["bloc
-0002a250: 6b4e 756d 6265 7222 5d20 3d3d 2062 6c6f  kNumber"] == blo
-0002a260: 636b 5f77 6974 685f 7478 6e5f 7769 7468  ck_with_txn_with
-0002a270: 5f6c 6f67 5b22 6e75 6d62 6572 225d 0a20  _log["number"]. 
-0002a280: 2020 2020 2020 2061 7373 6572 7420 6c6f         assert lo
-0002a290: 675f 656e 7472 795b 2262 6c6f 636b 4861  g_entry["blockHa
-0002a2a0: 7368 225d 203d 3d20 626c 6f63 6b5f 7769  sh"] == block_wi
-0002a2b0: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
-0002a2c0: 2268 6173 6822 5d0a 2020 2020 2020 2020  "hash"].        
-0002a2d0: 6173 7365 7274 206c 6f67 5f65 6e74 7279  assert log_entry
-0002a2e0: 5b22 6c6f 6749 6e64 6578 225d 203d 3d20  ["logIndex"] == 
-0002a2f0: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
-0002a300: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
-0002a310: 286c 6f67 5f65 6e74 7279 5b22 6164 6472  (log_entry["addr
-0002a320: 6573 7322 5d2c 2065 6d69 7474 6572 5f63  ess"], emitter_c
-0002a330: 6f6e 7472 6163 742e 6164 6472 6573 7329  ontract.address)
-0002a340: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0002a350: 6c6f 675f 656e 7472 795b 2274 7261 6e73  log_entry["trans
-0002a360: 6163 7469 6f6e 496e 6465 7822 5d20 3d3d  actionIndex"] ==
-0002a370: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
-0002a380: 7420 6c6f 675f 656e 7472 795b 2274 7261  t log_entry["tra
-0002a390: 6e73 6163 7469 6f6e 4861 7368 225d 203d  nsactionHash"] =
-0002a3a0: 3d20 4865 7842 7974 6573 2874 786e 5f68  = HexBytes(txn_h
-0002a3b0: 6173 685f 7769 7468 5f6c 6f67 290a 0a20  ash_with_log).. 
-0002a3c0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-0002a3d0: 6765 7455 6e63 6c65 4279 426c 6f63 6b48  getUncleByBlockH
-0002a3e0: 6173 6841 6e64 496e 6465 7828 7365 6c66  ashAndIndex(self
-0002a3f0: 2c20 7733 3a20 2257 6562 3322 2920 2d3e  , w3: "Web3") ->
-0002a400: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
-0002a410: 2054 4f44 4f3a 2068 6f77 2064 6f20 7765   TODO: how do we
-0002a420: 206d 616b 6520 756e 636c 6573 2e2e 2e2e   make uncles....
-0002a430: 0a20 2020 2020 2020 2070 6173 730a 0a20  .        pass.. 
-0002a440: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-0002a450: 6765 7455 6e63 6c65 4279 426c 6f63 6b4e  getUncleByBlockN
-0002a460: 756d 6265 7241 6e64 496e 6465 7828 7365  umberAndIndex(se
+00023dd0: 3030 3030 3030 3030 3030 3030 3162 3436  0000000000001b46
+00023de0: 3735 3665 3633 3734 3639 3666 3665 3230  756e6374696f6e20
+00023df0: 3638 3631 3733 3230 3632 3635 3635 3665  686173206265656e
+00023e00: 3230 3732 3635 3736 3635 3732 3734 3635  2072657665727465
+00023e10: 3634 3265 3030 3030 3030 3030 3030 2220  642e0000000000" 
+00023e20: 2023 206e 6f71 613a 2045 3530 310a 2020   # noqa: E501.  
+00023e30: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+00023e40: 742e 7261 6973 6573 280a 2020 2020 2020  t.raises(.      
+00023e50: 2020 2020 2020 436f 6e74 7261 6374 4c6f        ContractLo
+00023e60: 6769 6345 7272 6f72 2c20 6d61 7463 683d  gicError, match=
+00023e70: 2265 7865 6375 7469 6f6e 2072 6576 6572  "execution rever
+00023e80: 7465 643a 2046 756e 6374 696f 6e20 6861  ted: Function ha
+00023e90: 7320 6265 656e 2072 6576 6572 7465 6422  s been reverted"
+00023ea0: 0a20 2020 2020 2020 2029 2061 7320 6578  .        ) as ex
+00023eb0: 6369 6e66 6f3a 0a20 2020 2020 2020 2020  cinfo:.         
+00023ec0: 2020 2077 332e 6574 682e 6361 6c6c 2874     w3.eth.call(t
+00023ed0: 786e 5f70 6172 616d 7329 0a20 2020 2020  xn_params).     
+00023ee0: 2020 2061 7373 6572 7420 6578 6369 6e66     assert excinf
+00023ef0: 6f2e 7661 6c75 652e 6461 7461 203d 3d20  o.value.data == 
+00023f00: 6461 7461 0a0a 2020 2020 6465 6620 7465  data..    def te
+00023f10: 7374 5f65 7468 5f63 616c 6c5f 7265 7665  st_eth_call_reve
+00023f20: 7274 5f77 6974 686f 7574 5f6d 7367 280a  rt_without_msg(.
+00023f30: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00023f40: 2020 2020 2020 7733 3a20 2257 6562 3322        w3: "Web3"
+00023f50: 2c0a 2020 2020 2020 2020 7265 7665 7274  ,.        revert
+00023f60: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
+00023f70: 7261 6374 222c 0a20 2020 2020 2020 2075  ract",.        u
+00023f80: 6e6c 6f63 6b65 645f 6163 636f 756e 743a  nlocked_account:
+00023f90: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+00023fa0: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+00023fb0: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+00023fc0: 7465 7374 2e72 6169 7365 7328 436f 6e74  test.raises(Cont
+00023fd0: 7261 6374 4c6f 6769 6345 7272 6f72 2c20  ractLogicError, 
+00023fe0: 6d61 7463 683d 2265 7865 6375 7469 6f6e  match="execution
+00023ff0: 2072 6576 6572 7465 6422 293a 0a20 2020   reverted"):.   
+00024000: 2020 2020 2020 2020 2074 786e 5f70 6172           txn_par
+00024010: 616d 7320 3d20 7265 7665 7274 5f63 6f6e  ams = revert_con
+00024020: 7472 6163 742e 5f70 7265 7061 7265 5f74  tract._prepare_t
+00024030: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
+00024040: 2020 2020 2020 2020 2020 2020 666e 5f6e              fn_n
+00024050: 616d 653d 2272 6576 6572 7457 6974 686f  ame="revertWitho
+00024060: 7574 4d65 7373 6167 6522 2c0a 2020 2020  utMessage",.    
+00024070: 2020 2020 2020 2020 2020 2020 7472 616e              tran
+00024080: 7361 6374 696f 6e3d 7b0a 2020 2020 2020  saction={.      
+00024090: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+000240a0: 726f 6d22 3a20 756e 6c6f 636b 6564 5f61  rom": unlocked_a
+000240b0: 6363 6f75 6e74 2c0a 2020 2020 2020 2020  ccount,.        
+000240c0: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+000240d0: 3a20 7265 7665 7274 5f63 6f6e 7472 6163  : revert_contrac
+000240e0: 742e 6164 6472 6573 732c 0a20 2020 2020  t.address,.     
+000240f0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+00024100: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00024110: 2020 2020 2020 2020 7733 2e65 7468 2e63          w3.eth.c
+00024120: 616c 6c28 7478 6e5f 7061 7261 6d73 290a  all(txn_params).
+00024130: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+00024140: 685f 6361 6c6c 5f63 7573 746f 6d5f 6572  h_call_custom_er
+00024150: 726f 725f 7265 7665 7274 5f77 6974 685f  ror_revert_with_
+00024160: 6d73 6728 0a20 2020 2020 2020 2073 656c  msg(.        sel
+00024170: 662c 0a20 2020 2020 2020 2077 333a 2022  f,.        w3: "
+00024180: 5765 6233 222c 0a20 2020 2020 2020 2072  Web3",.        r
+00024190: 6576 6572 745f 636f 6e74 7261 6374 3a20  evert_contract: 
+000241a0: 2243 6f6e 7472 6163 7422 2c0a 2020 2020  "Contract",.    
+000241b0: 2020 2020 756e 6c6f 636b 6564 5f61 6363      unlocked_acc
+000241c0: 6f75 6e74 3a20 4368 6563 6b73 756d 4164  ount: ChecksumAd
+000241d0: 6472 6573 732c 0a20 2020 2029 202d 3e20  dress,.    ) -> 
+000241e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 6461  None:.        da
+000241f0: 7461 203d 2072 6576 6572 745f 636f 6e74  ta = revert_cont
+00024200: 7261 6374 2e65 6e63 6f64 655f 6162 6928  ract.encode_abi(
+00024210: 0a20 2020 2020 2020 2020 2020 2066 6e5f  .            fn_
+00024220: 6e61 6d65 3d22 556e 6175 7468 6f72 697a  name="Unauthoriz
+00024230: 6564 5769 7468 4d65 7373 6167 6522 2c20  edWithMessage", 
+00024240: 6172 6773 3d5b 2259 6f75 2061 7265 206e  args=["You are n
+00024250: 6f74 2061 7574 686f 7269 7a65 6422 5d0a  ot authorized"].
+00024260: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00024270: 2020 7478 6e5f 7061 7261 6d73 203d 2072    txn_params = r
+00024280: 6576 6572 745f 636f 6e74 7261 6374 2e5f  evert_contract._
+00024290: 7072 6570 6172 655f 7472 616e 7361 6374  prepare_transact
+000242a0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+000242b0: 2066 6e5f 6e61 6d65 3d22 6375 7374 6f6d   fn_name="custom
+000242c0: 4572 726f 7257 6974 684d 6573 7361 6765  ErrorWithMessage
+000242d0: 222c 0a20 2020 2020 2020 2020 2020 2074  ",.            t
+000242e0: 7261 6e73 6163 7469 6f6e 3d7b 0a20 2020  ransaction={.   
+000242f0: 2020 2020 2020 2020 2020 2020 2022 6672               "fr
+00024300: 6f6d 223a 2075 6e6c 6f63 6b65 645f 6163  om": unlocked_ac
+00024310: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
+00024320: 2020 2020 2020 2022 746f 223a 2072 6576         "to": rev
+00024330: 6572 745f 636f 6e74 7261 6374 2e61 6464  ert_contract.add
+00024340: 7265 7373 2c0a 2020 2020 2020 2020 2020  ress,.          
+00024350: 2020 7d2c 0a20 2020 2020 2020 2029 0a20    },.        ). 
+00024360: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+00024370: 7374 2e72 6169 7365 7328 436f 6e74 7261  st.raises(Contra
+00024380: 6374 4375 7374 6f6d 4572 726f 722c 206d  ctCustomError, m
+00024390: 6174 6368 3d64 6174 6129 2061 7320 6578  atch=data) as ex
+000243a0: 6369 6e66 6f3a 0a20 2020 2020 2020 2020  cinfo:.         
+000243b0: 2020 2077 332e 6574 682e 6361 6c6c 2874     w3.eth.call(t
+000243c0: 786e 5f70 6172 616d 7329 0a20 2020 2020  xn_params).     
+000243d0: 2020 2061 7373 6572 7420 6578 6369 6e66     assert excinf
+000243e0: 6f2e 7661 6c75 652e 6461 7461 203d 3d20  o.value.data == 
+000243f0: 6461 7461 0a0a 2020 2020 6465 6620 7465  data..    def te
+00024400: 7374 5f65 7468 5f63 616c 6c5f 6375 7374  st_eth_call_cust
+00024410: 6f6d 5f65 7272 6f72 5f72 6576 6572 745f  om_error_revert_
+00024420: 7769 7468 6f75 745f 6d73 6728 0a20 2020  without_msg(.   
+00024430: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00024440: 2020 2077 333a 2022 5765 6233 222c 0a20     w3: "Web3",. 
+00024450: 2020 2020 2020 2072 6576 6572 745f 636f         revert_co
+00024460: 6e74 7261 6374 3a20 2243 6f6e 7472 6163  ntract: "Contrac
+00024470: 7422 2c0a 2020 2020 2020 2020 756e 6c6f  t",.        unlo
+00024480: 636b 6564 5f61 6363 6f75 6e74 3a20 4368  cked_account: Ch
+00024490: 6563 6b73 756d 4164 6472 6573 732c 0a20  ecksumAddress,. 
+000244a0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+000244b0: 2020 2020 2020 6461 7461 203d 2072 6576        data = rev
+000244c0: 6572 745f 636f 6e74 7261 6374 2e65 6e63  ert_contract.enc
+000244d0: 6f64 655f 6162 6928 666e 5f6e 616d 653d  ode_abi(fn_name=
+000244e0: 2255 6e61 7574 686f 7269 7a65 6422 290a  "Unauthorized").
+000244f0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+00024500: 6d73 203d 2072 6576 6572 745f 636f 6e74  ms = revert_cont
+00024510: 7261 6374 2e5f 7072 6570 6172 655f 7472  ract._prepare_tr
+00024520: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+00024530: 2020 2020 2020 2066 6e5f 6e61 6d65 3d22         fn_name="
+00024540: 6375 7374 6f6d 4572 726f 7257 6974 686f  customErrorWitho
+00024550: 7574 4d65 7373 6167 6522 2c0a 2020 2020  utMessage",.    
+00024560: 2020 2020 2020 2020 7472 616e 7361 6374          transact
+00024570: 696f 6e3d 7b0a 2020 2020 2020 2020 2020  ion={.          
+00024580: 2020 2020 2020 2266 726f 6d22 3a20 756e        "from": un
+00024590: 6c6f 636b 6564 5f61 6363 6f75 6e74 2c0a  locked_account,.
+000245a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000245b0: 2274 6f22 3a20 7265 7665 7274 5f63 6f6e  "to": revert_con
+000245c0: 7472 6163 742e 6164 6472 6573 732c 0a20  tract.address,. 
+000245d0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+000245e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000245f0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+00024600: 6573 2843 6f6e 7472 6163 7443 7573 746f  es(ContractCusto
+00024610: 6d45 7272 6f72 2c20 6d61 7463 683d 6461  mError, match=da
+00024620: 7461 2920 6173 2065 7863 696e 666f 3a0a  ta) as excinfo:.
+00024630: 2020 2020 2020 2020 2020 2020 7733 2e65              w3.e
+00024640: 7468 2e63 616c 6c28 7478 6e5f 7061 7261  th.call(txn_para
+00024650: 6d73 290a 2020 2020 2020 2020 6173 7365  ms).        asse
+00024660: 7274 2065 7863 696e 666f 2e76 616c 7565  rt excinfo.value
+00024670: 2e64 6174 6120 3d3d 2064 6174 610a 0a20  .data == data.. 
+00024680: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
+00024690: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
+000246a0: 2020 2020 2022 7061 6e69 635f 6572 726f       "panic_erro
+000246b0: 722c 7061 7261 6d73 222c 0a20 2020 2020  r,params",.     
+000246c0: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
+000246d0: 2028 2230 3122 2c20 5b5d 292c 0a20 2020   ("01", []),.   
+000246e0: 2020 2020 2020 2020 2028 2231 3122 2c20           ("11", 
+000246f0: 5b5d 292c 0a20 2020 2020 2020 2020 2020  []),.           
+00024700: 2028 2231 3222 2c20 5b30 5d29 2c0a 2020   ("12", [0]),.  
+00024710: 2020 2020 2020 2020 2020 2822 3231 222c            ("21",
+00024720: 205b 2d31 5d29 2c0a 2020 2020 2020 2020   [-1]),.        
+00024730: 2020 2020 2822 3232 222c 205b 5d29 2c0a      ("22", []),.
+00024740: 2020 2020 2020 2020 2020 2020 2822 3331              ("31
+00024750: 222c 205b 5d29 2c0a 2020 2020 2020 2020  ", []),.        
+00024760: 2020 2020 2822 3332 222c 205b 5d29 2c0a      ("32", []),.
+00024770: 2020 2020 2020 2020 2020 2020 2822 3431              ("41
+00024780: 222c 205b 5d29 2c0a 2020 2020 2020 2020  ", []),.        
+00024790: 2020 2020 2822 3531 222c 205b 5d29 2c0a      ("51", []),.
+000247a0: 2020 2020 2020 2020 292c 0a20 2020 2029          ),.    )
+000247b0: 0a20 2020 2064 6566 2074 6573 745f 636f  .    def test_co
+000247c0: 6e74 7261 6374 5f70 616e 6963 5f65 7272  ntract_panic_err
+000247d0: 6f72 7328 0a20 2020 2020 2020 2073 656c  ors(.        sel
+000247e0: 662c 0a20 2020 2020 2020 2077 333a 2022  f,.        w3: "
+000247f0: 5765 6233 222c 0a20 2020 2020 2020 2070  Web3",.        p
+00024800: 616e 6963 5f65 7272 6f72 735f 636f 6e74  anic_errors_cont
+00024810: 7261 6374 3a20 2243 6f6e 7472 6163 7422  ract: "Contract"
+00024820: 2c0a 2020 2020 2020 2020 7061 6e69 635f  ,.        panic_
+00024830: 6572 726f 723a 2073 7472 2c0a 2020 2020  error: str,.    
+00024840: 2020 2020 7061 7261 6d73 3a20 4c69 7374      params: List
+00024850: 5b41 6e79 5d2c 0a20 2020 2029 202d 3e20  [Any],.    ) -> 
+00024860: 4e6f 6e65 3a0a 2020 2020 2020 2020 6d65  None:.        me
+00024870: 7468 6f64 203d 2067 6574 6174 7472 280a  thod = getattr(.
+00024880: 2020 2020 2020 2020 2020 2020 7061 6e69              pani
+00024890: 635f 6572 726f 7273 5f63 6f6e 7472 6163  c_errors_contrac
+000248a0: 742e 6675 6e63 7469 6f6e 732c 0a20 2020  t.functions,.   
+000248b0: 2020 2020 2020 2020 2066 2265 7272 6f72           f"error
+000248c0: 436f 6465 7b70 616e 6963 5f65 7272 6f72  Code{panic_error
+000248d0: 7d22 2c0a 2020 2020 2020 2020 290a 2020  }",.        ).  
+000248e0: 2020 2020 2020 6572 726f 725f 6d73 6720        error_msg 
+000248f0: 3d20 5041 4e49 435f 4552 524f 525f 434f  = PANIC_ERROR_CO
+00024900: 4445 535b 7061 6e69 635f 6572 726f 725d  DES[panic_error]
+00024910: 0a0a 2020 2020 2020 2020 7769 7468 2070  ..        with p
+00024920: 7974 6573 742e 7261 6973 6573 2843 6f6e  ytest.raises(Con
+00024930: 7472 6163 7450 616e 6963 4572 726f 722c  tractPanicError,
+00024940: 206d 6174 6368 3d72 652e 6573 6361 7065   match=re.escape
+00024950: 2865 7272 6f72 5f6d 7367 2929 3a0a 2020  (error_msg)):.  
+00024960: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00024970: 282a 7061 7261 6d73 292e 6361 6c6c 2829  (*params).call()
+00024980: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+00024990: 7468 5f63 616c 6c5f 6f66 6663 6861 696e  th_call_offchain
+000249a0: 5f6c 6f6f 6b75 7028 0a20 2020 2020 2020  _lookup(.       
+000249b0: 2073 656c 662c 0a20 2020 2020 2020 2077   self,.        w
+000249c0: 333a 2022 5765 6233 222c 0a20 2020 2020  3: "Web3",.     
+000249d0: 2020 206f 6666 6368 6169 6e5f 6c6f 6f6b     offchain_look
+000249e0: 7570 5f63 6f6e 7472 6163 743a 2022 436f  up_contract: "Co
+000249f0: 6e74 7261 6374 222c 0a20 2020 2020 2020  ntract",.       
+00024a00: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
+00024a10: 743a 2043 6865 636b 7375 6d41 6464 7265  t: ChecksumAddre
+00024a20: 7373 2c0a 2020 2020 2020 2020 6d6f 6e6b  ss,.        monk
+00024a30: 6579 7061 7463 683a 2022 4d6f 6e6b 6579  eypatch: "Monkey
+00024a40: 5061 7463 6822 2c0a 2020 2020 2920 2d3e  Patch",.    ) ->
+00024a50: 204e 6f6e 653a 0a20 2020 2020 2020 206e   None:.        n
+00024a60: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
+00024a70: 6374 5f61 6464 7265 7373 203d 2074 6f5f  ct_address = to_
+00024a80: 6865 785f 6966 5f62 7974 6573 280a 2020  hex_if_bytes(.  
+00024a90: 2020 2020 2020 2020 2020 6f66 6663 6861            offcha
+00024aa0: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
+00024ab0: 6374 2e61 6464 7265 7373 0a20 2020 2020  ct.address.     
+00024ac0: 2020 2029 2e6c 6f77 6572 2829 0a20 2020     ).lower().   
+00024ad0: 2020 2020 206d 6f63 6b5f 6f66 6663 6861       mock_offcha
+00024ae0: 696e 5f6c 6f6f 6b75 705f 7265 7175 6573  in_lookup_reques
+00024af0: 745f 7265 7370 6f6e 7365 280a 2020 2020  t_response(.    
+00024b00: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
+00024b10: 7463 682c 0a20 2020 2020 2020 2020 2020  tch,.           
+00024b20: 206d 6f63 6b65 645f 7265 7175 6573 745f   mocked_request_
+00024b30: 7572 6c3d 6622 6874 7470 733a 2f2f 7765  url=f"https://we
+00024b40: 6233 2e70 792f 6761 7465 7761 792f 7b6e  b3.py/gateway/{n
+00024b50: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
+00024b60: 6374 5f61 6464 7265 7373 7d2f 7b4f 4646  ct_address}/{OFF
+00024b70: 4348 4149 4e5f 4c4f 4f4b 5550 5f54 4553  CHAIN_LOOKUP_TES
+00024b80: 545f 4441 5441 7d2e 6a73 6f6e 222c 2020  T_DATA}.json",  
+00024b90: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
+00024ba0: 2020 2020 2020 2020 206d 6f63 6b65 645f           mocked_
+00024bb0: 6a73 6f6e 5f64 6174 613d 5745 4233 5059  json_data=WEB3PY
+00024bc0: 5f41 535f 4845 5842 5954 4553 2c0a 2020  _AS_HEXBYTES,.  
+00024bd0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00024be0: 7265 7370 6f6e 7365 203d 206f 6666 6368  response = offch
+00024bf0: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
+00024c00: 6163 742e 6675 6e63 7469 6f6e 732e 7465  act.functions.te
+00024c10: 7374 4f66 6663 6861 696e 4c6f 6f6b 7570  stOffchainLookup
+00024c20: 280a 2020 2020 2020 2020 2020 2020 4f46  (.            OF
+00024c30: 4643 4841 494e 5f4c 4f4f 4b55 505f 5445  FCHAIN_LOOKUP_TE
+00024c40: 5354 5f44 4154 410a 2020 2020 2020 2020  ST_DATA.        
+00024c50: 292e 6361 6c6c 2829 0a20 2020 2020 2020  ).call().       
+00024c60: 2061 7373 6572 7420 7733 2e63 6f64 6563   assert w3.codec
+00024c70: 2e64 6563 6f64 6528 5b22 7374 7269 6e67  .decode(["string
+00024c80: 225d 2c20 7265 7370 6f6e 7365 295b 305d  "], response)[0]
+00024c90: 203d 3d20 2277 6562 3370 7922 0a0a 2020   == "web3py"..  
+00024ca0: 2020 6465 6620 7465 7374 5f65 7468 5f63    def test_eth_c
+00024cb0: 616c 6c5f 6f66 6663 6861 696e 5f6c 6f6f  all_offchain_loo
+00024cc0: 6b75 705f 7261 6973 6573 5f77 6865 6e5f  kup_raises_when_
+00024cd0: 6363 6970 5f72 6561 645f 6973 5f64 6973  ccip_read_is_dis
+00024ce0: 6162 6c65 6428 0a20 2020 2020 2020 2073  abled(.        s
+00024cf0: 656c 662c 0a20 2020 2020 2020 2077 333a  elf,.        w3:
+00024d00: 2022 5765 6233 222c 0a20 2020 2020 2020   "Web3",.       
+00024d10: 206f 6666 6368 6169 6e5f 6c6f 6f6b 7570   offchain_lookup
+00024d20: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
+00024d30: 7261 6374 222c 0a20 2020 2029 202d 3e20  ract",.    ) -> 
+00024d40: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
+00024d50: 7475 726e 5f64 6174 6120 3d20 280a 2020  turn_data = (.  
+00024d60: 2020 2020 2020 2020 2020 4f46 4643 4841            OFFCHA
+00024d70: 494e 5f4c 4f4f 4b55 505f 3442 5954 455f  IN_LOOKUP_4BYTE_
+00024d80: 4441 5441 0a20 2020 2020 2020 2020 2020  DATA.           
+00024d90: 202b 2061 6269 5f65 6e63 6f64 6564 5f6f   + abi_encoded_o
+00024da0: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
+00024db0: 6f6e 7472 6163 745f 6164 6472 6573 7328  ontract_address(
+00024dc0: 7733 2c20 6f66 6663 6861 696e 5f6c 6f6f  w3, offchain_loo
+00024dd0: 6b75 705f 636f 6e74 7261 6374 290a 2020  kup_contract).  
+00024de0: 2020 2020 2020 2020 2020 2b20 4f46 4643            + OFFC
+00024df0: 4841 494e 5f4c 4f4f 4b55 505f 5245 5455  HAIN_LOOKUP_RETU
+00024e00: 524e 5f44 4154 410a 2020 2020 2020 2020  RN_DATA.        
+00024e10: 290a 2020 2020 2020 2020 2320 7465 7374  ).        # test
+00024e20: 2043 6f6e 7472 6163 7446 756e 6374 696f   ContractFunctio
+00024e30: 6e20 6361 6c6c 0a20 2020 2020 2020 2077  n call.        w
+00024e40: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+00024e50: 7328 4f66 6663 6861 696e 4c6f 6f6b 7570  s(OffchainLookup
+00024e60: 2920 6173 2065 3a0a 2020 2020 2020 2020  ) as e:.        
+00024e70: 2020 2020 6f66 6663 6861 696e 5f6c 6f6f      offchain_loo
+00024e80: 6b75 705f 636f 6e74 7261 6374 2e66 756e  kup_contract.fun
+00024e90: 6374 696f 6e73 2e74 6573 744f 6666 6368  ctions.testOffch
+00024ea0: 6169 6e4c 6f6f 6b75 7028 0a20 2020 2020  ainLookup(.     
+00024eb0: 2020 2020 2020 2020 2020 204f 4646 4348             OFFCH
+00024ec0: 4149 4e5f 4c4f 4f4b 5550 5f54 4553 545f  AIN_LOOKUP_TEST_
+00024ed0: 4441 5441 0a20 2020 2020 2020 2020 2020  DATA.           
+00024ee0: 2029 2e63 616c 6c28 6363 6970 5f72 6561   ).call(ccip_rea
+00024ef0: 645f 656e 6162 6c65 643d 4661 6c73 6529  d_enabled=False)
+00024f00: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00024f10: 652e 7661 6c75 652e 6461 7461 203d 3d20  e.value.data == 
+00024f20: 7265 7475 726e 5f64 6174 610a 0a20 2020  return_data..   
+00024f30: 2020 2020 2023 2074 6573 7420 436f 6e74       # test Cont
+00024f40: 7261 6374 4361 6c6c 6572 2063 616c 6c0a  ractCaller call.
+00024f50: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+00024f60: 6573 742e 7261 6973 6573 284f 6666 6368  est.raises(Offch
+00024f70: 6169 6e4c 6f6f 6b75 7029 2061 7320 6578  ainLookup) as ex
+00024f80: 6369 6e66 6f3a 0a20 2020 2020 2020 2020  cinfo:.         
+00024f90: 2020 206f 6666 6368 6169 6e5f 6c6f 6f6b     offchain_look
+00024fa0: 7570 5f63 6f6e 7472 6163 742e 6361 6c6c  up_contract.call
+00024fb0: 6572 2863 6369 705f 7265 6164 5f65 6e61  er(ccip_read_ena
+00024fc0: 626c 6564 3d46 616c 7365 292e 7465 7374  bled=False).test
+00024fd0: 4f66 6663 6861 696e 4c6f 6f6b 7570 280a  OffchainLookup(.
+00024fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ff0: 4f46 4643 4841 494e 5f4c 4f4f 4b55 505f  OFFCHAIN_LOOKUP_
+00025000: 5445 5354 5f44 4154 410a 2020 2020 2020  TEST_DATA.      
+00025010: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00025020: 6173 7365 7274 2065 7863 696e 666f 2e76  assert excinfo.v
+00025030: 616c 7565 2e64 6174 6120 3d3d 2072 6574  alue.data == ret
+00025040: 7572 6e5f 6461 7461 0a0a 2020 2020 2020  urn_data..      
+00025050: 2020 2320 7465 7374 2067 6c6f 6261 6c20    # test global 
+00025060: 666c 6167 206f 6e20 7468 6520 7072 6f76  flag on the prov
+00025070: 6964 6572 0a20 2020 2020 2020 2077 332e  ider.        w3.
+00025080: 7072 6f76 6964 6572 2e67 6c6f 6261 6c5f  provider.global_
+00025090: 6363 6970 5f72 6561 645f 656e 6162 6c65  ccip_read_enable
+000250a0: 6420 3d20 4661 6c73 650a 0a20 2020 2020  d = False..     
+000250b0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+000250c0: 6169 7365 7328 4f66 6663 6861 696e 4c6f  aises(OffchainLo
+000250d0: 6f6b 7570 2920 6173 2065 7863 5f69 6e66  okup) as exc_inf
+000250e0: 6f3a 0a20 2020 2020 2020 2020 2020 206f  o:.            o
+000250f0: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
+00025100: 6f6e 7472 6163 742e 6675 6e63 7469 6f6e  ontract.function
+00025110: 732e 7465 7374 4f66 6663 6861 696e 4c6f  s.testOffchainLo
+00025120: 6f6b 7570 280a 2020 2020 2020 2020 2020  okup(.          
+00025130: 2020 2020 2020 4f46 4643 4841 494e 5f4c        OFFCHAIN_L
+00025140: 4f4f 4b55 505f 5445 5354 5f44 4154 410a  OOKUP_TEST_DATA.
+00025150: 2020 2020 2020 2020 2020 2020 292e 6361              ).ca
+00025160: 6c6c 2829 0a20 2020 2020 2020 2061 7373  ll().        ass
+00025170: 6572 7420 6578 635f 696e 666f 2e76 616c  ert exc_info.val
+00025180: 7565 2e64 6174 6120 3d3d 2072 6574 7572  ue.data == retur
+00025190: 6e5f 6461 7461 0a0a 2020 2020 2020 2020  n_data..        
+000251a0: 7733 2e70 726f 7669 6465 722e 676c 6f62  w3.provider.glob
+000251b0: 616c 5f63 6369 705f 7265 6164 5f65 6e61  al_ccip_read_ena
+000251c0: 626c 6564 203d 2054 7275 6520 2023 2063  bled = True  # c
+000251d0: 6c65 616e 7570 0a0a 2020 2020 6465 6620  leanup..    def 
+000251e0: 7465 7374 5f65 7468 5f63 616c 6c5f 6f66  test_eth_call_of
+000251f0: 6663 6861 696e 5f6c 6f6f 6b75 705f 6361  fchain_lookup_ca
+00025200: 6c6c 5f66 6c61 675f 6f76 6572 7269 6465  ll_flag_override
+00025210: 735f 7072 6f76 6964 6572 5f66 6c61 6728  s_provider_flag(
+00025220: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00025230: 2020 2020 2020 2077 333a 2022 5765 6233         w3: "Web3
+00025240: 222c 0a20 2020 2020 2020 206f 6666 6368  ",.        offch
+00025250: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
+00025260: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
+00025270: 0a20 2020 2020 2020 2075 6e6c 6f63 6b65  .        unlocke
+00025280: 645f 6163 636f 756e 743a 2043 6865 636b  d_account: Check
+00025290: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
+000252a0: 2020 2020 6d6f 6e6b 6579 7061 7463 683a      monkeypatch:
+000252b0: 2022 4d6f 6e6b 6579 5061 7463 6822 2c0a   "MonkeyPatch",.
+000252c0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+000252d0: 2020 2020 2020 206e 6f72 6d61 6c69 7a65         normalize
+000252e0: 645f 636f 6e74 7261 6374 5f61 6464 7265  d_contract_addre
+000252f0: 7373 203d 2074 6f5f 6865 785f 6966 5f62  ss = to_hex_if_b
+00025300: 7974 6573 280a 2020 2020 2020 2020 2020  ytes(.          
+00025310: 2020 6f66 6663 6861 696e 5f6c 6f6f 6b75    offchain_looku
+00025320: 705f 636f 6e74 7261 6374 2e61 6464 7265  p_contract.addre
+00025330: 7373 0a20 2020 2020 2020 2029 2e6c 6f77  ss.        ).low
+00025340: 6572 2829 0a20 2020 2020 2020 206d 6f63  er().        moc
+00025350: 6b5f 6f66 6663 6861 696e 5f6c 6f6f 6b75  k_offchain_looku
+00025360: 705f 7265 7175 6573 745f 7265 7370 6f6e  p_request_respon
+00025370: 7365 280a 2020 2020 2020 2020 2020 2020  se(.            
+00025380: 6d6f 6e6b 6579 7061 7463 682c 0a20 2020  monkeypatch,.   
+00025390: 2020 2020 2020 2020 206d 6f63 6b65 645f           mocked_
+000253a0: 7265 7175 6573 745f 7572 6c3d 6622 6874  request_url=f"ht
+000253b0: 7470 733a 2f2f 7765 6233 2e70 792f 6761  tps://web3.py/ga
+000253c0: 7465 7761 792f 7b6e 6f72 6d61 6c69 7a65  teway/{normalize
+000253d0: 645f 636f 6e74 7261 6374 5f61 6464 7265  d_contract_addre
+000253e0: 7373 7d2f 7b4f 4646 4348 4149 4e5f 4c4f  ss}/{OFFCHAIN_LO
+000253f0: 4f4b 5550 5f54 4553 545f 4441 5441 7d2e  OKUP_TEST_DATA}.
+00025400: 6a73 6f6e 222c 2020 2320 6e6f 7161 3a20  json",  # noqa: 
+00025410: 4535 3031 0a20 2020 2020 2020 2020 2020  E501.           
+00025420: 206d 6f63 6b65 645f 6a73 6f6e 5f64 6174   mocked_json_dat
+00025430: 613d 5745 4233 5059 5f41 535f 4845 5842  a=WEB3PY_AS_HEXB
+00025440: 5954 4553 2c0a 2020 2020 2020 2020 290a  YTES,.        ).
+00025450: 0a20 2020 2020 2020 2077 332e 7072 6f76  .        w3.prov
+00025460: 6964 6572 2e67 6c6f 6261 6c5f 6363 6970  ider.global_ccip
+00025470: 5f72 6561 645f 656e 6162 6c65 6420 3d20  _read_enabled = 
+00025480: 4661 6c73 650a 0a20 2020 2020 2020 2072  False..        r
+00025490: 6573 706f 6e73 6520 3d20 6f66 6663 6861  esponse = offcha
+000254a0: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
+000254b0: 6374 2e66 756e 6374 696f 6e73 2e74 6573  ct.functions.tes
+000254c0: 744f 6666 6368 6169 6e4c 6f6f 6b75 7028  tOffchainLookup(
+000254d0: 0a20 2020 2020 2020 2020 2020 204f 4646  .            OFF
+000254e0: 4348 4149 4e5f 4c4f 4f4b 5550 5f54 4553  CHAIN_LOOKUP_TES
+000254f0: 545f 4441 5441 0a20 2020 2020 2020 2029  T_DATA.        )
+00025500: 2e63 616c 6c28 6363 6970 5f72 6561 645f  .call(ccip_read_
+00025510: 656e 6162 6c65 643d 5472 7565 290a 2020  enabled=True).  
+00025520: 2020 2020 2020 6173 7365 7274 2077 332e        assert w3.
+00025530: 636f 6465 632e 6465 636f 6465 285b 2273  codec.decode(["s
+00025540: 7472 696e 6722 5d2c 2072 6573 706f 6e73  tring"], respons
+00025550: 6529 5b30 5d20 3d3d 2022 7765 6233 7079  e)[0] == "web3py
+00025560: 220a 0a20 2020 2020 2020 2077 332e 7072  "..        w3.pr
+00025570: 6f76 6964 6572 2e67 6c6f 6261 6c5f 6363  ovider.global_cc
+00025580: 6970 5f72 6561 645f 656e 6162 6c65 6420  ip_read_enabled 
+00025590: 3d20 5472 7565 2020 2320 636c 6561 6e75  = True  # cleanu
+000255a0: 700a 0a20 2020 2040 7079 7465 7374 2e6d  p..    @pytest.m
+000255b0: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+000255c0: 226d 6178 5f72 6564 6972 6563 7473 222c  "max_redirects",
+000255d0: 2072 616e 6765 282d 312c 2034 2929 0a20   range(-1, 4)). 
+000255e0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+000255f0: 6361 6c6c 5f6f 6666 6368 6169 6e5f 6c6f  call_offchain_lo
+00025600: 6f6b 7570 5f72 6169 7365 735f 6966 5f6d  okup_raises_if_m
+00025610: 6178 5f72 6564 6972 6563 7473 5f69 735f  ax_redirects_is_
+00025620: 6c65 7373 5f74 6861 6e5f 3428 0a20 2020  less_than_4(.   
+00025630: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00025640: 2020 2077 333a 2022 5765 6233 222c 0a20     w3: "Web3",. 
+00025650: 2020 2020 2020 206f 6666 6368 6169 6e5f         offchain_
+00025660: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 743a  lookup_contract:
+00025670: 2022 436f 6e74 7261 6374 222c 0a20 2020   "Contract",.   
+00025680: 2020 2020 206d 6178 5f72 6564 6972 6563       max_redirec
+00025690: 7473 3a20 696e 742c 0a20 2020 2029 202d  ts: int,.    ) -
+000256a0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+000256b0: 6465 6661 756c 745f 6d61 785f 7265 6469  default_max_redi
+000256c0: 7265 6374 7320 3d20 7733 2e70 726f 7669  rects = w3.provi
+000256d0: 6465 722e 6363 6970 5f72 6561 645f 6d61  der.ccip_read_ma
+000256e0: 785f 7265 6469 7265 6374 730a 0a20 2020  x_redirects..   
+000256f0: 2020 2020 2077 332e 7072 6f76 6964 6572       w3.provider
+00025700: 2e63 6369 705f 7265 6164 5f6d 6178 5f72  .ccip_read_max_r
+00025710: 6564 6972 6563 7473 203d 206d 6178 5f72  edirects = max_r
+00025720: 6564 6972 6563 7473 0a20 2020 2020 2020  edirects.       
+00025730: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+00025740: 7365 7328 5661 6c75 6545 7272 6f72 2c20  ses(ValueError, 
+00025750: 6d61 7463 683d 2261 7420 6c65 6173 7420  match="at least 
+00025760: 3422 293a 0a20 2020 2020 2020 2020 2020  4"):.           
+00025770: 206f 6666 6368 6169 6e5f 6c6f 6f6b 7570   offchain_lookup
+00025780: 5f63 6f6e 7472 6163 742e 6675 6e63 7469  _contract.functi
+00025790: 6f6e 732e 7465 7374 4f66 6663 6861 696e  ons.testOffchain
+000257a0: 4c6f 6f6b 7570 280a 2020 2020 2020 2020  Lookup(.        
+000257b0: 2020 2020 2020 2020 4f46 4643 4841 494e          OFFCHAIN
+000257c0: 5f4c 4f4f 4b55 505f 5445 5354 5f44 4154  _LOOKUP_TEST_DAT
+000257d0: 410a 2020 2020 2020 2020 2020 2020 292e  A.            ).
+000257e0: 6361 6c6c 2829 0a0a 2020 2020 2020 2020  call()..        
+000257f0: 7733 2e70 726f 7669 6465 722e 6363 6970  w3.provider.ccip
+00025800: 5f72 6561 645f 6d61 785f 7265 6469 7265  _read_max_redire
+00025810: 6374 7320 3d20 6465 6661 756c 745f 6d61  cts = default_ma
+00025820: 785f 7265 6469 7265 6374 7320 2023 2063  x_redirects  # c
+00025830: 6c65 616e 7570 0a0a 2020 2020 6465 6620  leanup..    def 
+00025840: 7465 7374 5f65 7468 5f63 616c 6c5f 6f66  test_eth_call_of
+00025850: 6663 6861 696e 5f6c 6f6f 6b75 705f 7261  fchain_lookup_ra
+00025860: 6973 6573 5f66 6f72 5f69 6d70 726f 7065  ises_for_imprope
+00025870: 726c 795f 666f 726d 6174 7465 645f 7265  rly_formatted_re
+00025880: 7374 5f72 6571 7565 7374 5f72 6573 706f  st_request_respo
+00025890: 6e73 6528 2020 2320 6e6f 7161 3a20 4535  nse(  # noqa: E5
+000258a0: 3031 0a20 2020 2020 2020 2073 656c 662c  01.        self,
+000258b0: 0a20 2020 2020 2020 2077 333a 2022 5765  .        w3: "We
+000258c0: 6233 222c 0a20 2020 2020 2020 206f 6666  b3",.        off
+000258d0: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
+000258e0: 7472 6163 743a 2022 436f 6e74 7261 6374  tract: "Contract
+000258f0: 222c 0a20 2020 2020 2020 2075 6e6c 6f63  ",.        unloc
+00025900: 6b65 645f 6163 636f 756e 743a 2043 6865  ked_account: Che
+00025910: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
+00025920: 2020 2020 2020 6d6f 6e6b 6579 7061 7463        monkeypatc
+00025930: 683a 2022 4d6f 6e6b 6579 5061 7463 6822  h: "MonkeyPatch"
+00025940: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+00025950: 0a20 2020 2020 2020 206e 6f72 6d61 6c69  .        normali
+00025960: 7a65 645f 636f 6e74 7261 6374 5f61 6464  zed_contract_add
+00025970: 7265 7373 203d 2074 6f5f 6865 785f 6966  ress = to_hex_if
+00025980: 5f62 7974 6573 280a 2020 2020 2020 2020  _bytes(.        
+00025990: 2020 2020 6f66 6663 6861 696e 5f6c 6f6f      offchain_loo
+000259a0: 6b75 705f 636f 6e74 7261 6374 2e61 6464  kup_contract.add
+000259b0: 7265 7373 0a20 2020 2020 2020 2029 2e6c  ress.        ).l
+000259c0: 6f77 6572 2829 0a20 2020 2020 2020 206d  ower().        m
+000259d0: 6f63 6b5f 6f66 6663 6861 696e 5f6c 6f6f  ock_offchain_loo
+000259e0: 6b75 705f 7265 7175 6573 745f 7265 7370  kup_request_resp
+000259f0: 6f6e 7365 280a 2020 2020 2020 2020 2020  onse(.          
+00025a00: 2020 6d6f 6e6b 6579 7061 7463 682c 0a20    monkeypatch,. 
+00025a10: 2020 2020 2020 2020 2020 206d 6f63 6b65             mocke
+00025a20: 645f 7265 7175 6573 745f 7572 6c3d 6622  d_request_url=f"
+00025a30: 6874 7470 733a 2f2f 7765 6233 2e70 792f  https://web3.py/
+00025a40: 6761 7465 7761 792f 7b6e 6f72 6d61 6c69  gateway/{normali
+00025a50: 7a65 645f 636f 6e74 7261 6374 5f61 6464  zed_contract_add
+00025a60: 7265 7373 7d2f 7b4f 4646 4348 4149 4e5f  ress}/{OFFCHAIN_
+00025a70: 4c4f 4f4b 5550 5f54 4553 545f 4441 5441  LOOKUP_TEST_DATA
+00025a80: 7d2e 6a73 6f6e 222c 2020 2320 6e6f 7161  }.json",  # noqa
+00025a90: 3a20 4535 3031 0a20 2020 2020 2020 2020  : E501.         
+00025aa0: 2020 206d 6f63 6b65 645f 6a73 6f6e 5f64     mocked_json_d
+00025ab0: 6174 613d 5745 4233 5059 5f41 535f 4845  ata=WEB3PY_AS_HE
+00025ac0: 5842 5954 4553 2c0a 2020 2020 2020 2020  XBYTES,.        
+00025ad0: 2020 2020 6a73 6f6e 5f64 6174 615f 6669      json_data_fi
+00025ae0: 656c 643d 226e 6f74 5f64 6174 6122 2c0a  eld="not_data",.
+00025af0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00025b00: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+00025b10: 6973 6573 2857 6562 3356 616c 6964 6174  ises(Web3Validat
+00025b20: 696f 6e45 7272 6f72 2c20 6d61 7463 683d  ionError, match=
+00025b30: 226d 6973 7369 6e67 2027 6461 7461 2720  "missing 'data' 
+00025b40: 6669 656c 6422 293a 0a20 2020 2020 2020  field"):.       
+00025b50: 2020 2020 206f 6666 6368 6169 6e5f 6c6f       offchain_lo
+00025b60: 6f6b 7570 5f63 6f6e 7472 6163 742e 6675  okup_contract.fu
+00025b70: 6e63 7469 6f6e 732e 7465 7374 4f66 6663  nctions.testOffc
+00025b80: 6861 696e 4c6f 6f6b 7570 280a 2020 2020  hainLookup(.    
+00025b90: 2020 2020 2020 2020 2020 2020 4f46 4643              OFFC
+00025ba0: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
+00025bb0: 5f44 4154 410a 2020 2020 2020 2020 2020  _DATA.          
+00025bc0: 2020 292e 6361 6c6c 2829 0a0a 2020 2020    ).call()..    
+00025bd0: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
+00025be0: 616d 6574 7269 7a65 2822 7374 6174 7573  ametrize("status
+00025bf0: 5f63 6f64 655f 6e6f 6e5f 3478 785f 6572  _code_non_4xx_er
+00025c00: 726f 7222 2c20 5b31 3030 2c20 3330 302c  ror", [100, 300,
+00025c10: 2035 3030 2c20 3630 305d 290a 2020 2020   500, 600]).    
+00025c20: 6465 6620 7465 7374 5f65 7468 5f63 616c  def test_eth_cal
+00025c30: 6c5f 6f66 6663 6861 696e 5f6c 6f6f 6b75  l_offchain_looku
+00025c40: 705f 7472 6965 735f 6e65 7874 5f75 726c  p_tries_next_url
+00025c50: 5f66 6f72 5f6e 6f6e 5f34 7878 5f65 7272  _for_non_4xx_err
+00025c60: 6f72 5f73 7461 7475 735f 616e 645f 7465  or_status_and_te
+00025c70: 7374 735f 504f 5354 2820 2023 206e 6f71  sts_POST(  # noq
+00025c80: 613a 2045 3530 310a 2020 2020 2020 2020  a: E501.        
+00025c90: 7365 6c66 2c0a 2020 2020 2020 2020 7733  self,.        w3
+00025ca0: 3a20 2257 6562 3322 2c0a 2020 2020 2020  : "Web3",.      
+00025cb0: 2020 6f66 6663 6861 696e 5f6c 6f6f 6b75    offchain_looku
+00025cc0: 705f 636f 6e74 7261 6374 3a20 2243 6f6e  p_contract: "Con
+00025cd0: 7472 6163 7422 2c0a 2020 2020 2020 2020  tract",.        
+00025ce0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+00025cf0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+00025d00: 732c 0a20 2020 2020 2020 206d 6f6e 6b65  s,.        monke
+00025d10: 7970 6174 6368 3a20 224d 6f6e 6b65 7950  ypatch: "MonkeyP
+00025d20: 6174 6368 222c 0a20 2020 2020 2020 2073  atch",.        s
+00025d30: 7461 7475 735f 636f 6465 5f6e 6f6e 5f34  tatus_code_non_4
+00025d40: 7878 5f65 7272 6f72 3a20 696e 742c 0a20  xx_error: int,. 
+00025d50: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00025d60: 2020 2020 2020 6e6f 726d 616c 697a 6564        normalized
+00025d70: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
+00025d80: 7320 3d20 746f 5f68 6578 5f69 665f 6279  s = to_hex_if_by
+00025d90: 7465 7328 0a20 2020 2020 2020 2020 2020  tes(.           
+00025da0: 206f 6666 6368 6169 6e5f 6c6f 6f6b 7570   offchain_lookup
+00025db0: 5f63 6f6e 7472 6163 742e 6164 6472 6573  _contract.addres
+00025dc0: 730a 2020 2020 2020 2020 292e 6c6f 7765  s.        ).lowe
+00025dd0: 7228 290a 0a20 2020 2020 2020 2023 2054  r()..        # T
+00025de0: 6865 206e 6578 7420 7572 6c20 696e 206f  he next url in o
+00025df0: 7572 2074 6573 7420 636f 6e74 7261 6374  ur test contract
+00025e00: 2064 6f65 736e 2774 2063 6f6e 7461 696e   doesn't contain
+00025e10: 2027 7b64 6174 617d 272c 2074 7269 6767   '{data}', trigg
+00025e20: 6572 696e 670a 2020 2020 2020 2020 2320  ering.        # 
+00025e30: 7468 6520 504f 5354 2072 6571 7565 7374  the POST request
+00025e40: 206c 6f67 6963 2e20 5468 6520 6964 6561   logic. The idea
+00025e50: 2068 6572 6520 6973 2074 6f20 7265 7475   here is to retu
+00025e60: 726e 2061 2062 6164 2073 7461 7475 7320  rn a bad status 
+00025e70: 666f 720a 2020 2020 2020 2020 2320 7468  for.        # th
+00025e80: 6520 6669 7273 7420 7572 6c20 2847 4554  e first url (GET
+00025e90: 2920 616e 6420 6120 7375 6363 6573 7320  ) and a success 
+00025ea0: 7374 6174 7573 2066 726f 6d20 7468 6520  status from the 
+00025eb0: 7365 636f 6e64 2063 616c 6c20 2850 4f53  second call (POS
+00025ec0: 5429 0a20 2020 2020 2020 2023 2074 6f20  T).        # to 
+00025ed0: 7465 7374 2062 6f74 6820 7468 6174 2077  test both that w
+00025ee0: 6520 6d6f 7665 206f 6e20 746f 2074 6865  e move on to the
+00025ef0: 206e 6578 7420 7572 6c20 7769 7468 206e   next url with n
+00025f00: 6f6e 2034 7878 2073 7461 7475 7320 616e  on 4xx status an
+00025f10: 640a 2020 2020 2020 2020 2320 7468 6174  d.        # that
+00025f20: 2074 6865 2050 4f53 5420 6c6f 6769 6320   the POST logic 
+00025f30: 6973 2061 6c73 6f20 776f 726b 696e 6720  is also working 
+00025f40: 6173 2065 7870 6563 7465 642e 0a20 2020  as expected..   
+00025f50: 2020 2020 206d 6f63 6b5f 6f66 6663 6861       mock_offcha
+00025f60: 696e 5f6c 6f6f 6b75 705f 7265 7175 6573  in_lookup_reques
+00025f70: 745f 7265 7370 6f6e 7365 280a 2020 2020  t_response(.    
+00025f80: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
+00025f90: 7463 682c 0a20 2020 2020 2020 2020 2020  tch,.           
+00025fa0: 206d 6f63 6b65 645f 7265 7175 6573 745f   mocked_request_
+00025fb0: 7572 6c3d 6622 6874 7470 733a 2f2f 7765  url=f"https://we
+00025fc0: 6233 2e70 792f 6761 7465 7761 792f 7b6e  b3.py/gateway/{n
+00025fd0: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
+00025fe0: 6374 5f61 6464 7265 7373 7d2f 7b4f 4646  ct_address}/{OFF
+00025ff0: 4348 4149 4e5f 4c4f 4f4b 5550 5f54 4553  CHAIN_LOOKUP_TES
+00026000: 545f 4441 5441 7d2e 6a73 6f6e 222c 2020  T_DATA}.json",  
+00026010: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
+00026020: 2020 2020 2020 2020 206d 6f63 6b65 645f           mocked_
+00026030: 7374 6174 7573 5f63 6f64 653d 7374 6174  status_code=stat
+00026040: 7573 5f63 6f64 655f 6e6f 6e5f 3478 785f  us_code_non_4xx_
+00026050: 6572 726f 722c 0a20 2020 2020 2020 2020  error,.         
+00026060: 2020 206d 6f63 6b65 645f 6a73 6f6e 5f64     mocked_json_d
+00026070: 6174 613d 5745 4233 5059 5f41 535f 4845  ata=WEB3PY_AS_HE
+00026080: 5842 5954 4553 2c0a 2020 2020 2020 2020  XBYTES,.        
+00026090: 290a 2020 2020 2020 2020 6d6f 636b 5f6f  ).        mock_o
+000260a0: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f72  ffchain_lookup_r
+000260b0: 6571 7565 7374 5f72 6573 706f 6e73 6528  equest_response(
+000260c0: 0a20 2020 2020 2020 2020 2020 206d 6f6e  .            mon
+000260d0: 6b65 7970 6174 6368 2c0a 2020 2020 2020  keypatch,.      
+000260e0: 2020 2020 2020 6874 7470 5f6d 6574 686f        http_metho
+000260f0: 643d 2250 4f53 5422 2c0a 2020 2020 2020  d="POST",.      
+00026100: 2020 2020 2020 6d6f 636b 6564 5f72 6571        mocked_req
+00026110: 7565 7374 5f75 726c 3d66 2268 7474 7073  uest_url=f"https
+00026120: 3a2f 2f77 6562 332e 7079 2f67 6174 6577  ://web3.py/gatew
+00026130: 6179 2f7b 6e6f 726d 616c 697a 6564 5f63  ay/{normalized_c
+00026140: 6f6e 7472 6163 745f 6164 6472 6573 737d  ontract_address}
+00026150: 2e6a 736f 6e22 2c20 2023 206e 6f71 613a  .json",  # noqa:
+00026160: 2045 3530 310a 2020 2020 2020 2020 2020   E501.          
+00026170: 2020 6d6f 636b 6564 5f73 7461 7475 735f    mocked_status_
+00026180: 636f 6465 3d32 3030 2c0a 2020 2020 2020  code=200,.      
+00026190: 2020 2020 2020 6d6f 636b 6564 5f6a 736f        mocked_jso
+000261a0: 6e5f 6461 7461 3d57 4542 3350 595f 4153  n_data=WEB3PY_AS
+000261b0: 5f48 4558 4259 5445 532c 0a20 2020 2020  _HEXBYTES,.     
+000261c0: 2020 2020 2020 2073 656e 6465 723d 6e6f         sender=no
+000261d0: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
+000261e0: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
+000261f0: 2020 2020 2020 2063 616c 6c64 6174 613d         calldata=
+00026200: 4f46 4643 4841 494e 5f4c 4f4f 4b55 505f  OFFCHAIN_LOOKUP_
+00026210: 5445 5354 5f44 4154 412c 0a20 2020 2020  TEST_DATA,.     
+00026220: 2020 2029 0a20 2020 2020 2020 2072 6573     ).        res
+00026230: 706f 6e73 6520 3d20 6f66 6663 6861 696e  ponse = offchain
+00026240: 5f6c 6f6f 6b75 705f 636f 6e74 7261 6374  _lookup_contract
+00026250: 2e66 756e 6374 696f 6e73 2e74 6573 744f  .functions.testO
+00026260: 6666 6368 6169 6e4c 6f6f 6b75 7028 0a20  ffchainLookup(. 
+00026270: 2020 2020 2020 2020 2020 204f 4646 4348             OFFCH
+00026280: 4149 4e5f 4c4f 4f4b 5550 5f54 4553 545f  AIN_LOOKUP_TEST_
+00026290: 4441 5441 0a20 2020 2020 2020 2029 2e63  DATA.        ).c
+000262a0: 616c 6c28 290a 2020 2020 2020 2020 6173  all().        as
+000262b0: 7365 7274 2077 332e 636f 6465 632e 6465  sert w3.codec.de
+000262c0: 636f 6465 285b 2273 7472 696e 6722 5d2c  code(["string"],
+000262d0: 2072 6573 706f 6e73 6529 5b30 5d20 3d3d   response)[0] ==
+000262e0: 2022 7765 6233 7079 220a 0a20 2020 2064   "web3py"..    d
+000262f0: 6566 2074 6573 745f 6574 685f 6361 6c6c  ef test_eth_call
+00026300: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
+00026310: 5f63 616c 6c73 5f72 6169 7365 5f66 6f72  _calls_raise_for
+00026320: 5f73 7461 7475 735f 666f 725f 3478 785f  _status_for_4xx_
+00026330: 7374 6174 7573 5f63 6f64 6528 0a20 2020  status_code(.   
+00026340: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00026350: 2020 2077 333a 2022 5765 6233 222c 0a20     w3: "Web3",. 
+00026360: 2020 2020 2020 206f 6666 6368 6169 6e5f         offchain_
+00026370: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 743a  lookup_contract:
+00026380: 2022 436f 6e74 7261 6374 222c 0a20 2020   "Contract",.   
+00026390: 2020 2020 2075 6e6c 6f63 6b65 645f 6163       unlocked_ac
+000263a0: 636f 756e 743a 2043 6865 636b 7375 6d41  count: ChecksumA
+000263b0: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+000263c0: 6d6f 6e6b 6579 7061 7463 683a 2022 4d6f  monkeypatch: "Mo
+000263d0: 6e6b 6579 5061 7463 6822 2c0a 2020 2020  nkeyPatch",.    
+000263e0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+000263f0: 2020 206e 6f72 6d61 6c69 7a65 645f 636f     normalized_co
+00026400: 6e74 7261 6374 5f61 6464 7265 7373 203d  ntract_address =
+00026410: 2074 6f5f 6865 785f 6966 5f62 7974 6573   to_hex_if_bytes
+00026420: 280a 2020 2020 2020 2020 2020 2020 6f66  (.            of
+00026430: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
+00026440: 6e74 7261 6374 2e61 6464 7265 7373 0a20  ntract.address. 
+00026450: 2020 2020 2020 2029 2e6c 6f77 6572 2829         ).lower()
+00026460: 0a20 2020 2020 2020 206d 6f63 6b5f 6f66  .        mock_of
+00026470: 6663 6861 696e 5f6c 6f6f 6b75 705f 7265  fchain_lookup_re
+00026480: 7175 6573 745f 7265 7370 6f6e 7365 280a  quest_response(.
+00026490: 2020 2020 2020 2020 2020 2020 6d6f 6e6b              monk
+000264a0: 6579 7061 7463 682c 0a20 2020 2020 2020  eypatch,.       
+000264b0: 2020 2020 206d 6f63 6b65 645f 7265 7175       mocked_requ
+000264c0: 6573 745f 7572 6c3d 6622 6874 7470 733a  est_url=f"https:
+000264d0: 2f2f 7765 6233 2e70 792f 6761 7465 7761  //web3.py/gatewa
+000264e0: 792f 7b6e 6f72 6d61 6c69 7a65 645f 636f  y/{normalized_co
+000264f0: 6e74 7261 6374 5f61 6464 7265 7373 7d2f  ntract_address}/
+00026500: 7b4f 4646 4348 4149 4e5f 4c4f 4f4b 5550  {OFFCHAIN_LOOKUP
+00026510: 5f54 4553 545f 4441 5441 7d2e 6a73 6f6e  _TEST_DATA}.json
+00026520: 222c 2020 2320 6e6f 7161 3a20 4535 3031  ",  # noqa: E501
+00026530: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
+00026540: 6b65 645f 7374 6174 7573 5f63 6f64 653d  ked_status_code=
+00026550: 7261 6e64 696e 7428 3430 302c 2034 3939  randint(400, 499
+00026560: 292c 0a20 2020 2020 2020 2020 2020 206d  ),.            m
+00026570: 6f63 6b65 645f 6a73 6f6e 5f64 6174 613d  ocked_json_data=
+00026580: 5745 4233 5059 5f41 535f 4845 5842 5954  WEB3PY_AS_HEXBYT
+00026590: 4553 2c0a 2020 2020 2020 2020 290a 2020  ES,.        ).  
+000265a0: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+000265b0: 742e 7261 6973 6573 2845 7863 6570 7469  t.raises(Excepti
+000265c0: 6f6e 2c20 6d61 7463 683d 2263 616c 6c65  on, match="calle
+000265d0: 6420 7261 6973 655f 666f 725f 7374 6174  d raise_for_stat
+000265e0: 7573 5c5c 285c 5c29 2229 3a0a 2020 2020  us\\(\\)"):.    
+000265f0: 2020 2020 2020 2020 6f66 6663 6861 696e          offchain
+00026600: 5f6c 6f6f 6b75 705f 636f 6e74 7261 6374  _lookup_contract
+00026610: 2e66 756e 6374 696f 6e73 2e74 6573 744f  .functions.testO
+00026620: 6666 6368 6169 6e4c 6f6f 6b75 7028 0a20  ffchainLookup(. 
+00026630: 2020 2020 2020 2020 2020 2020 2020 204f                 O
+00026640: 4646 4348 4149 4e5f 4c4f 4f4b 5550 5f54  FFCHAIN_LOOKUP_T
+00026650: 4553 545f 4441 5441 0a20 2020 2020 2020  EST_DATA.       
+00026660: 2020 2020 2029 2e63 616c 6c28 290a 0a20       ).call().. 
+00026670: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+00026680: 6361 6c6c 5f6f 6666 6368 6169 6e5f 6c6f  call_offchain_lo
+00026690: 6f6b 7570 5f72 6169 7365 735f 7768 656e  okup_raises_when
+000266a0: 5f61 6c6c 5f73 7570 706c 6965 645f 7572  _all_supplied_ur
+000266b0: 6c73 5f66 6169 6c28 0a20 2020 2020 2020  ls_fail(.       
+000266c0: 2073 656c 662c 0a20 2020 2020 2020 2077   self,.        w
+000266d0: 333a 2022 5765 6233 222c 0a20 2020 2020  3: "Web3",.     
+000266e0: 2020 206f 6666 6368 6169 6e5f 6c6f 6f6b     offchain_look
+000266f0: 7570 5f63 6f6e 7472 6163 743a 2022 436f  up_contract: "Co
+00026700: 6e74 7261 6374 222c 0a20 2020 2029 202d  ntract",.    ) -
+00026710: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00026720: 2320 4745 5420 616e 6420 504f 5354 2072  # GET and POST r
+00026730: 6571 7565 7374 7320 7368 6f75 6c64 2066  equests should f
+00026740: 6169 6c20 7369 6e63 6520 7265 7370 6f6e  ail since respon
+00026750: 7365 7320 6172 6520 6e6f 7420 6d6f 636b  ses are not mock
+00026760: 6564 0a20 2020 2020 2020 2077 6974 6820  ed.        with 
+00026770: 7079 7465 7374 2e72 6169 7365 7328 0a20  pytest.raises(. 
+00026780: 2020 2020 2020 2020 2020 204d 756c 7469             Multi
+00026790: 706c 6546 6169 6c65 6452 6571 7565 7374  pleFailedRequest
+000267a0: 732c 206d 6174 6368 3d22 4f66 6663 6861  s, match="Offcha
+000267b0: 696e 206c 6f6f 6b75 7020 6661 696c 6564  in lookup failed
+000267c0: 2066 6f72 2073 7570 706c 6965 6420 7572   for supplied ur
+000267d0: 6c73 220a 2020 2020 2020 2020 293a 0a20  ls".        ):. 
+000267e0: 2020 2020 2020 2020 2020 206f 6666 6368             offch
+000267f0: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
+00026800: 6163 742e 6675 6e63 7469 6f6e 732e 7465  act.functions.te
+00026810: 7374 4f66 6663 6861 696e 4c6f 6f6b 7570  stOffchainLookup
+00026820: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00026830: 2020 4f46 4643 4841 494e 5f4c 4f4f 4b55    OFFCHAIN_LOOKU
+00026840: 505f 5445 5354 5f44 4154 410a 2020 2020  P_TEST_DATA.    
+00026850: 2020 2020 2020 2020 292e 6361 6c6c 2829          ).call()
+00026860: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+00026870: 7468 5f63 616c 6c5f 636f 6e74 696e 756f  th_call_continuo
+00026880: 7573 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  us_offchain_look
+00026890: 7570 5f72 6169 7365 735f 7769 7468 5f74  up_raises_with_t
+000268a0: 6f6f 5f6d 616e 795f 7265 7175 6573 7473  oo_many_requests
+000268b0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+000268c0: 2020 2020 2020 2020 7733 3a20 2257 6562          w3: "Web
+000268d0: 3322 2c0a 2020 2020 2020 2020 6f66 6663  3",.        offc
+000268e0: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
+000268f0: 7261 6374 3a20 2243 6f6e 7472 6163 7422  ract: "Contract"
+00026900: 2c0a 2020 2020 2020 2020 756e 6c6f 636b  ,.        unlock
+00026910: 6564 5f61 6363 6f75 6e74 3a20 4368 6563  ed_account: Chec
+00026920: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
+00026930: 2020 2020 206d 6f6e 6b65 7970 6174 6368       monkeypatch
+00026940: 3a20 224d 6f6e 6b65 7950 6174 6368 222c  : "MonkeyPatch",
+00026950: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00026960: 2020 2020 2020 2020 6e6f 726d 616c 697a          normaliz
+00026970: 6564 5f63 6f6e 7472 6163 745f 6164 6472  ed_contract_addr
+00026980: 6573 7320 3d20 746f 5f68 6578 5f69 665f  ess = to_hex_if_
+00026990: 6279 7465 7328 0a20 2020 2020 2020 2020  bytes(.         
+000269a0: 2020 206f 6666 6368 6169 6e5f 6c6f 6f6b     offchain_look
+000269b0: 7570 5f63 6f6e 7472 6163 742e 6164 6472  up_contract.addr
+000269c0: 6573 730a 2020 2020 2020 2020 292e 6c6f  ess.        ).lo
+000269d0: 7765 7228 290a 2020 2020 2020 2020 6d6f  wer().        mo
+000269e0: 636b 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  ck_offchain_look
+000269f0: 7570 5f72 6571 7565 7374 5f72 6573 706f  up_request_respo
+00026a00: 6e73 6528 0a20 2020 2020 2020 2020 2020  nse(.           
+00026a10: 206d 6f6e 6b65 7970 6174 6368 2c0a 2020   monkeypatch,.  
+00026a20: 2020 2020 2020 2020 2020 6d6f 636b 6564            mocked
+00026a30: 5f72 6571 7565 7374 5f75 726c 3d66 2268  _request_url=f"h
+00026a40: 7474 7073 3a2f 2f77 6562 332e 7079 2f67  ttps://web3.py/g
+00026a50: 6174 6577 6179 2f7b 6e6f 726d 616c 697a  ateway/{normaliz
+00026a60: 6564 5f63 6f6e 7472 6163 745f 6164 6472  ed_contract_addr
+00026a70: 6573 737d 2f30 782e 6a73 6f6e 222c 2020  ess}/0x.json",  
+00026a80: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
+00026a90: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
+00026aa0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+00026ab0: 7328 546f 6f4d 616e 7952 6571 7565 7374  s(TooManyRequest
+00026ac0: 732c 206d 6174 6368 3d22 546f 6f20 6d61  s, match="Too ma
+00026ad0: 6e79 2043 4349 5020 7265 6164 2072 6564  ny CCIP read red
+00026ae0: 6972 6563 7473 2229 3a0a 2020 2020 2020  irects"):.      
+00026af0: 2020 2020 2020 6f66 6663 6861 696e 5f6c        offchain_l
+00026b00: 6f6f 6b75 705f 636f 6e74 7261 6374 2e63  ookup_contract.c
+00026b10: 616c 6c65 7228 292e 636f 6e74 696e 756f  aller().continuo
+00026b20: 7573 4f66 6663 6861 696e 4c6f 6f6b 7570  usOffchainLookup
+00026b30: 2829 0a0a 2020 2020 6465 6620 7465 7374  ()..    def test
+00026b40: 5f65 7468 5f65 7374 696d 6174 655f 6761  _eth_estimate_ga
+00026b50: 735f 7265 7665 7274 5f77 6974 685f 6d73  s_revert_with_ms
+00026b60: 6728 0a20 2020 2020 2020 2073 656c 662c  g(.        self,
+00026b70: 0a20 2020 2020 2020 2077 333a 2022 5765  .        w3: "We
+00026b80: 6233 222c 0a20 2020 2020 2020 2072 6576  b3",.        rev
+00026b90: 6572 745f 636f 6e74 7261 6374 3a20 2243  ert_contract: "C
+00026ba0: 6f6e 7472 6163 7422 2c0a 2020 2020 2020  ontract",.      
+00026bb0: 2020 756e 6c6f 636b 6564 5f61 6363 6f75    unlocked_accou
+00026bc0: 6e74 3a20 4368 6563 6b73 756d 4164 6472  nt: ChecksumAddr
+00026bd0: 6573 732c 0a20 2020 2029 202d 3e20 4e6f  ess,.    ) -> No
+00026be0: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
+00026bf0: 2070 7974 6573 742e 7261 6973 6573 280a   pytest.raises(.
+00026c00: 2020 2020 2020 2020 2020 2020 436f 6e74              Cont
+00026c10: 7261 6374 4c6f 6769 6345 7272 6f72 2c20  ractLogicError, 
+00026c20: 6d61 7463 683d 2265 7865 6375 7469 6f6e  match="execution
+00026c30: 2072 6576 6572 7465 643a 2046 756e 6374   reverted: Funct
+00026c40: 696f 6e20 6861 7320 6265 656e 2072 6576  ion has been rev
+00026c50: 6572 7465 6422 0a20 2020 2020 2020 2029  erted".        )
+00026c60: 3a0a 2020 2020 2020 2020 2020 2020 7478  :.            tx
+00026c70: 6e5f 7061 7261 6d73 203d 2072 6576 6572  n_params = rever
+00026c80: 745f 636f 6e74 7261 6374 2e5f 7072 6570  t_contract._prep
+00026c90: 6172 655f 7472 616e 7361 6374 696f 6e28  are_transaction(
+00026ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026cb0: 2066 6e5f 6e61 6d65 3d22 7265 7665 7274   fn_name="revert
+00026cc0: 5769 7468 4d65 7373 6167 6522 2c0a 2020  WithMessage",.  
+00026cd0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00026ce0: 616e 7361 6374 696f 6e3d 7b0a 2020 2020  ansaction={.    
+00026cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d00: 2266 726f 6d22 3a20 756e 6c6f 636b 6564  "from": unlocked
+00026d10: 5f61 6363 6f75 6e74 2c0a 2020 2020 2020  _account,.      
+00026d20: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00026d30: 6f22 3a20 7265 7665 7274 5f63 6f6e 7472  o": revert_contr
+00026d40: 6163 742e 6164 6472 6573 732c 0a20 2020  act.address,.   
+00026d50: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+00026d60: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00026d70: 2020 2020 2020 2020 2020 7733 2e65 7468            w3.eth
+00026d80: 2e65 7374 696d 6174 655f 6761 7328 7478  .estimate_gas(tx
+00026d90: 6e5f 7061 7261 6d73 290a 0a20 2020 2064  n_params)..    d
+00026da0: 6566 2074 6573 745f 6574 685f 6573 7469  ef test_eth_esti
+00026db0: 6d61 7465 5f67 6173 5f72 6576 6572 745f  mate_gas_revert_
+00026dc0: 7769 7468 6f75 745f 6d73 6728 0a20 2020  without_msg(.   
+00026dd0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00026de0: 2020 2077 333a 2022 5765 6233 222c 0a20     w3: "Web3",. 
+00026df0: 2020 2020 2020 2072 6576 6572 745f 636f         revert_co
+00026e00: 6e74 7261 6374 3a20 2243 6f6e 7472 6163  ntract: "Contrac
+00026e10: 7422 2c0a 2020 2020 2020 2020 756e 6c6f  t",.        unlo
+00026e20: 636b 6564 5f61 6363 6f75 6e74 3a20 4368  cked_account: Ch
+00026e30: 6563 6b73 756d 4164 6472 6573 732c 0a20  ecksumAddress,. 
+00026e40: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00026e50: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+00026e60: 742e 7261 6973 6573 2843 6f6e 7472 6163  t.raises(Contrac
+00026e70: 744c 6f67 6963 4572 726f 722c 206d 6174  tLogicError, mat
+00026e80: 6368 3d22 6578 6563 7574 696f 6e20 7265  ch="execution re
+00026e90: 7665 7274 6564 2229 3a0a 2020 2020 2020  verted"):.      
+00026ea0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+00026eb0: 203d 2072 6576 6572 745f 636f 6e74 7261   = revert_contra
+00026ec0: 6374 2e5f 7072 6570 6172 655f 7472 616e  ct._prepare_tran
+00026ed0: 7361 6374 696f 6e28 0a20 2020 2020 2020  saction(.       
+00026ee0: 2020 2020 2020 2020 2066 6e5f 6e61 6d65           fn_name
+00026ef0: 3d22 7265 7665 7274 5769 7468 6f75 744d  ="revertWithoutM
+00026f00: 6573 7361 6765 222c 0a20 2020 2020 2020  essage",.       
+00026f10: 2020 2020 2020 2020 2074 7261 6e73 6163           transac
+00026f20: 7469 6f6e 3d7b 0a20 2020 2020 2020 2020  tion={.         
+00026f30: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+00026f40: 223a 2075 6e6c 6f63 6b65 645f 6163 636f  ": unlocked_acco
+00026f50: 756e 742c 0a20 2020 2020 2020 2020 2020  unt,.           
+00026f60: 2020 2020 2020 2020 2022 746f 223a 2072           "to": r
+00026f70: 6576 6572 745f 636f 6e74 7261 6374 2e61  evert_contract.a
+00026f80: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+00026f90: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+00026fa0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00026fb0: 2020 2020 2077 332e 6574 682e 6573 7469       w3.eth.esti
+00026fc0: 6d61 7465 5f67 6173 2874 786e 5f70 6172  mate_gas(txn_par
+00026fd0: 616d 7329 0a0a 2020 2020 6465 6620 7465  ams)..    def te
+00026fe0: 7374 5f65 7468 5f65 7374 696d 6174 655f  st_eth_estimate_
+00026ff0: 6761 735f 6375 7374 6f6d 5f65 7272 6f72  gas_custom_error
+00027000: 5f72 6576 6572 745f 7769 7468 5f6d 7367  _revert_with_msg
+00027010: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00027020: 2020 2020 2020 2020 7733 3a20 2257 6562          w3: "Web
+00027030: 3322 2c0a 2020 2020 2020 2020 7265 7665  3",.        reve
+00027040: 7274 5f63 6f6e 7472 6163 743a 2022 436f  rt_contract: "Co
+00027050: 6e74 7261 6374 222c 0a20 2020 2020 2020  ntract",.       
+00027060: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
+00027070: 743a 2043 6865 636b 7375 6d41 6464 7265  t: ChecksumAddre
+00027080: 7373 2c0a 2020 2020 2920 2d3e 204e 6f6e  ss,.    ) -> Non
+00027090: 653a 0a20 2020 2020 2020 2064 6174 6120  e:.        data 
+000270a0: 3d20 7265 7665 7274 5f63 6f6e 7472 6163  = revert_contrac
+000270b0: 742e 656e 636f 6465 5f61 6269 280a 2020  t.encode_abi(.  
+000270c0: 2020 2020 2020 2020 2020 666e 5f6e 616d            fn_nam
+000270d0: 653d 2255 6e61 7574 686f 7269 7a65 6457  e="UnauthorizedW
+000270e0: 6974 684d 6573 7361 6765 222c 2061 7267  ithMessage", arg
+000270f0: 733d 5b22 596f 7520 6172 6520 6e6f 7420  s=["You are not 
+00027100: 6175 7468 6f72 697a 6564 225d 0a20 2020  authorized"].   
+00027110: 2020 2020 2029 0a20 2020 2020 2020 2074       ).        t
+00027120: 786e 5f70 6172 616d 7320 3d20 7265 7665  xn_params = reve
+00027130: 7274 5f63 6f6e 7472 6163 742e 5f70 7265  rt_contract._pre
+00027140: 7061 7265 5f74 7261 6e73 6163 7469 6f6e  pare_transaction
+00027150: 280a 2020 2020 2020 2020 2020 2020 666e  (.            fn
+00027160: 5f6e 616d 653d 2263 7573 746f 6d45 7272  _name="customErr
+00027170: 6f72 5769 7468 4d65 7373 6167 6522 2c0a  orWithMessage",.
+00027180: 2020 2020 2020 2020 2020 2020 7472 616e              tran
+00027190: 7361 6374 696f 6e3d 7b0a 2020 2020 2020  saction={.      
+000271a0: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
+000271b0: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
+000271c0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+000271d0: 2020 2020 2274 6f22 3a20 7265 7665 7274      "to": revert
+000271e0: 5f63 6f6e 7472 6163 742e 6164 6472 6573  _contract.addres
+000271f0: 732c 0a20 2020 2020 2020 2020 2020 207d  s,.            }
+00027200: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00027210: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+00027220: 7261 6973 6573 2843 6f6e 7472 6163 7443  raises(ContractC
+00027230: 7573 746f 6d45 7272 6f72 2c20 6d61 7463  ustomError, matc
+00027240: 683d 6461 7461 2920 6173 2065 7863 696e  h=data) as excin
+00027250: 666f 3a0a 2020 2020 2020 2020 2020 2020  fo:.            
+00027260: 7733 2e65 7468 2e65 7374 696d 6174 655f  w3.eth.estimate_
+00027270: 6761 7328 7478 6e5f 7061 7261 6d73 290a  gas(txn_params).
+00027280: 2020 2020 2020 2020 6173 7365 7274 2065          assert e
+00027290: 7863 696e 666f 2e76 616c 7565 2e64 6174  xcinfo.value.dat
+000272a0: 6120 3d3d 2064 6174 610a 0a20 2020 2064  a == data..    d
+000272b0: 6566 2074 6573 745f 6574 685f 6573 7469  ef test_eth_esti
+000272c0: 6d61 7465 5f67 6173 5f63 7573 746f 6d5f  mate_gas_custom_
+000272d0: 6572 726f 725f 7265 7665 7274 5f77 6974  error_revert_wit
+000272e0: 686f 7574 5f6d 7367 280a 2020 2020 2020  hout_msg(.      
+000272f0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00027300: 7733 3a20 2257 6562 3322 2c0a 2020 2020  w3: "Web3",.    
+00027310: 2020 2020 7265 7665 7274 5f63 6f6e 7472      revert_contr
+00027320: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
+00027330: 0a20 2020 2020 2020 2075 6e6c 6f63 6b65  .        unlocke
+00027340: 645f 6163 636f 756e 743a 2043 6865 636b  d_account: Check
+00027350: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
+00027360: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00027370: 2020 2064 6174 6120 3d20 7265 7665 7274     data = revert
+00027380: 5f63 6f6e 7472 6163 742e 656e 636f 6465  _contract.encode
+00027390: 5f61 6269 2866 6e5f 6e61 6d65 3d22 556e  _abi(fn_name="Un
+000273a0: 6175 7468 6f72 697a 6564 2229 0a20 2020  authorized").   
+000273b0: 2020 2020 2074 786e 5f70 6172 616d 7320       txn_params 
+000273c0: 3d20 7265 7665 7274 5f63 6f6e 7472 6163  = revert_contrac
+000273d0: 742e 5f70 7265 7061 7265 5f74 7261 6e73  t._prepare_trans
+000273e0: 6163 7469 6f6e 280a 2020 2020 2020 2020  action(.        
+000273f0: 2020 2020 666e 5f6e 616d 653d 2263 7573      fn_name="cus
+00027400: 746f 6d45 7272 6f72 5769 7468 6f75 744d  tomErrorWithoutM
+00027410: 6573 7361 6765 222c 0a20 2020 2020 2020  essage",.       
+00027420: 2020 2020 2074 7261 6e73 6163 7469 6f6e       transaction
+00027430: 3d7b 0a20 2020 2020 2020 2020 2020 2020  ={.             
+00027440: 2020 2022 6672 6f6d 223a 2075 6e6c 6f63     "from": unloc
+00027450: 6b65 645f 6163 636f 756e 742c 0a20 2020  ked_account,.   
+00027460: 2020 2020 2020 2020 2020 2020 2022 746f               "to
+00027470: 223a 2072 6576 6572 745f 636f 6e74 7261  ": revert_contra
+00027480: 6374 2e61 6464 7265 7373 2c0a 2020 2020  ct.address,.    
+00027490: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+000274a0: 2020 2029 0a20 2020 2020 2020 2077 6974     ).        wit
+000274b0: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+000274c0: 436f 6e74 7261 6374 4375 7374 6f6d 4572  ContractCustomEr
+000274d0: 726f 722c 206d 6174 6368 3d64 6174 6129  ror, match=data)
+000274e0: 2061 7320 6578 6369 6e66 6f3a 0a20 2020   as excinfo:.   
+000274f0: 2020 2020 2020 2020 2077 332e 6574 682e           w3.eth.
+00027500: 6573 7469 6d61 7465 5f67 6173 2874 786e  estimate_gas(txn
+00027510: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
+00027520: 2061 7373 6572 7420 6578 6369 6e66 6f2e   assert excinfo.
+00027530: 7661 6c75 652e 6461 7461 203d 3d20 6461  value.data == da
+00027540: 7461 0a0a 2020 2020 6465 6620 7465 7374  ta..    def test
+00027550: 5f65 7468 5f65 7374 696d 6174 655f 6761  _eth_estimate_ga
+00027560: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+00027570: 2077 333a 2022 5765 6233 222c 2075 6e6c   w3: "Web3", unl
+00027580: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+00027590: 616c 5f74 7970 653a 2043 6865 636b 7375  al_type: Checksu
+000275a0: 6d41 6464 7265 7373 0a20 2020 2029 202d  mAddress.    ) -
+000275b0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+000275c0: 6761 735f 6573 7469 6d61 7465 203d 2077  gas_estimate = w
+000275d0: 332e 6574 682e 6573 7469 6d61 7465 5f67  3.eth.estimate_g
+000275e0: 6173 280a 2020 2020 2020 2020 2020 2020  as(.            
+000275f0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00027600: 2020 2266 726f 6d22 3a20 756e 6c6f 636b    "from": unlock
+00027610: 6564 5f61 6363 6f75 6e74 5f64 7561 6c5f  ed_account_dual_
+00027620: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+00027630: 2020 2020 2020 2274 6f22 3a20 756e 6c6f        "to": unlo
+00027640: 636b 6564 5f61 6363 6f75 6e74 5f64 7561  cked_account_dua
+00027650: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+00027660: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
+00027670: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
+00027680: 2020 2020 207d 0a20 2020 2020 2020 2029       }.        )
+00027690: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+000276a0: 6973 5f69 6e74 6567 6572 2867 6173 5f65  is_integer(gas_e
+000276b0: 7374 696d 6174 6529 0a20 2020 2020 2020  stimate).       
+000276c0: 2061 7373 6572 7420 6761 735f 6573 7469   assert gas_esti
+000276d0: 6d61 7465 203e 2030 0a0a 2020 2020 6465  mate > 0..    de
+000276e0: 6620 7465 7374 5f65 7468 5f65 7374 696d  f test_eth_estim
+000276f0: 6174 655f 6761 735f 7769 7468 5f62 6c6f  ate_gas_with_blo
+00027700: 636b 280a 2020 2020 2020 2020 7365 6c66  ck(.        self
+00027710: 2c20 7733 3a20 2257 6562 3322 2c20 756e  , w3: "Web3", un
+00027720: 6c6f 636b 6564 5f61 6363 6f75 6e74 5f64  locked_account_d
+00027730: 7561 6c5f 7479 7065 3a20 4368 6563 6b73  ual_type: Checks
+00027740: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
+00027750: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00027760: 2067 6173 5f65 7374 696d 6174 6520 3d20   gas_estimate = 
+00027770: 7733 2e65 7468 2e65 7374 696d 6174 655f  w3.eth.estimate_
+00027780: 6761 7328 0a20 2020 2020 2020 2020 2020  gas(.           
+00027790: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+000277a0: 2020 2022 6672 6f6d 223a 2075 6e6c 6f63     "from": unloc
+000277b0: 6b65 645f 6163 636f 756e 745f 6475 616c  ked_account_dual
+000277c0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+000277d0: 2020 2020 2020 2022 746f 223a 2075 6e6c         "to": unl
+000277e0: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+000277f0: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00027800: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+00027810: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+00027820: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+00027830: 2020 2020 2022 6c61 7465 7374 222c 0a20       "latest",. 
+00027840: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00027850: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
+00027860: 6572 2867 6173 5f65 7374 696d 6174 6529  er(gas_estimate)
+00027870: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00027880: 6761 735f 6573 7469 6d61 7465 203e 2030  gas_estimate > 0
+00027890: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
+000278a0: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
+000278b0: 2020 2020 2020 2020 2270 6172 616d 7322          "params"
+000278c0: 2c0a 2020 2020 2020 2020 280a 2020 2020  ,.        (.    
+000278d0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+000278e0: 2020 2020 2020 2020 2020 226e 6f6e 6365            "nonce
+000278f0: 223a 2031 2c20 2023 2069 6e74 0a20 2020  ": 1,  # int.   
+00027900: 2020 2020 2020 2020 2020 2020 2022 6261               "ba
+00027910: 6c61 6e63 6522 3a20 312c 2020 2320 696e  lance": 1,  # in
+00027920: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+00027930: 2020 2263 6f64 6522 3a20 4865 7853 7472    "code": HexStr
+00027940: 2822 3078 2229 2c20 2023 2048 6578 5374  ("0x"),  # HexSt
+00027950: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00027960: 2020 2320 7769 7468 2073 7461 7465 0a20    # with state. 
+00027970: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00027980: 7374 6174 6522 3a20 7b48 6578 5374 7228  state": {HexStr(
+00027990: 6622 3078 7b27 3030 2720 2a20 3332 7d22  f"0x{'00' * 32}"
+000279a0: 293a 2048 6578 5374 7228 6622 3078 7b27  ): HexStr(f"0x{'
+000279b0: 3030 2720 2a20 3332 7d22 297d 2c0a 2020  00' * 32}")},.  
+000279c0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+000279d0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+000279e0: 2020 2020 2020 2020 2020 2022 6e6f 6e63             "nonc
+000279f0: 6522 3a20 4865 7853 7472 2822 3078 3122  e": HexStr("0x1"
+00027a00: 292c 2020 2320 4865 7853 7472 0a20 2020  ),  # HexStr.   
+00027a10: 2020 2020 2020 2020 2020 2020 2022 6261               "ba
+00027a20: 6c61 6e63 6522 3a20 4865 7853 7472 2822  lance": HexStr("
+00027a30: 3078 3122 292c 2020 2320 4865 7853 7472  0x1"),  # HexStr
+00027a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027a50: 2022 636f 6465 223a 2062 225c 7830 3022   "code": b"\x00"
+00027a60: 2c20 2023 2062 7974 6573 0a20 2020 2020  ,  # bytes.     
+00027a70: 2020 2020 2020 2020 2020 2023 2077 6974             # wit
+00027a80: 6820 7374 6174 6544 6966 660a 2020 2020  h stateDiff.    
+00027a90: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
+00027aa0: 7465 4469 6666 223a 207b 4865 7853 7472  teDiff": {HexStr
+00027ab0: 2866 2230 787b 2730 3027 202a 2033 327d  (f"0x{'00' * 32}
+00027ac0: 2229 3a20 4865 7853 7472 2866 2230 787b  "): HexStr(f"0x{
+00027ad0: 2730 3027 202a 2033 327d 2229 7d2c 0a20  '00' * 32}")},. 
+00027ae0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+00027af0: 2020 2020 2020 292c 0a20 2020 2029 0a20        ),.    ). 
+00027b00: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+00027b10: 6573 7469 6d61 7465 5f67 6173 5f77 6974  estimate_gas_wit
+00027b20: 685f 6f76 6572 7269 6465 5f70 6172 616d  h_override_param
+00027b30: 5f74 7970 655f 6368 6563 6b28 0a20 2020  _type_check(.   
+00027b40: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00027b50: 2020 2077 333a 2022 5765 6233 222c 0a20     w3: "Web3",. 
+00027b60: 2020 2020 2020 206d 6174 685f 636f 6e74         math_cont
+00027b70: 7261 6374 3a20 2243 6f6e 7472 6163 7422  ract: "Contract"
+00027b80: 2c0a 2020 2020 2020 2020 7061 7261 6d73  ,.        params
+00027b90: 3a20 5374 6174 654f 7665 7272 6964 6550  : StateOverrideP
+00027ba0: 6172 616d 732c 0a20 2020 2029 202d 3e20  arams,.    ) -> 
+00027bb0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
+00027bc0: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
+00027bd0: 6d73 203d 207b 2266 726f 6d22 3a20 7733  ms = {"from": w3
+00027be0: 2e65 7468 2e63 6f69 6e62 6173 657d 0a0a  .eth.coinbase}..
+00027bf0: 2020 2020 2020 2020 2320 6173 7365 7274          # assert
+00027c00: 2064 6f65 7320 6e6f 7420 7261 6973 650a   does not raise.
+00027c10: 2020 2020 2020 2020 7733 2e65 7468 2e65          w3.eth.e
+00027c20: 7374 696d 6174 655f 6761 7328 7478 6e5f  stimate_gas(txn_
+00027c30: 7061 7261 6d73 2c20 4e6f 6e65 2c20 7b6d  params, None, {m
+00027c40: 6174 685f 636f 6e74 7261 6374 2e61 6464  ath_contract.add
+00027c50: 7265 7373 3a20 7061 7261 6d73 7d29 0a0a  ress: params})..
+00027c60: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+00027c70: 5f67 6574 426c 6f63 6b42 7948 6173 6828  _getBlockByHash(
+00027c80: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
+00027c90: 2c20 656d 7074 795f 626c 6f63 6b3a 2042  , empty_block: B
+00027ca0: 6c6f 636b 4461 7461 2920 2d3e 204e 6f6e  lockData) -> Non
+00027cb0: 653a 0a20 2020 2020 2020 2062 6c6f 636b  e:.        block
+00027cc0: 203d 2077 332e 6574 682e 6765 745f 626c   = w3.eth.get_bl
+00027cd0: 6f63 6b28 656d 7074 795f 626c 6f63 6b5b  ock(empty_block[
+00027ce0: 2268 6173 6822 5d29 0a20 2020 2020 2020  "hash"]).       
+00027cf0: 2061 7373 6572 7420 626c 6f63 6b5b 2268   assert block["h
+00027d00: 6173 6822 5d20 3d3d 2065 6d70 7479 5f62  ash"] == empty_b
+00027d10: 6c6f 636b 5b22 6861 7368 225d 0a20 2020  lock["hash"].   
+00027d20: 2020 2020 2061 7373 6572 7420 626c 6f63       assert bloc
+00027d30: 6b5b 2272 6563 6569 7074 7352 6f6f 7422  k["receiptsRoot"
+00027d40: 5d20 3d3d 2065 6d70 7479 5f62 6c6f 636b  ] == empty_block
+00027d50: 5b22 7265 6365 6970 7473 526f 6f74 225d  ["receiptsRoot"]
+00027d60: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00027d70: 626c 6f63 6b5b 226c 6f67 7342 6c6f 6f6d  block["logsBloom
+00027d80: 225d 203d 3d20 656d 7074 795f 626c 6f63  "] == empty_bloc
+00027d90: 6b5b 226c 6f67 7342 6c6f 6f6d 225d 0a0a  k["logsBloom"]..
+00027da0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+00027db0: 5f67 6574 426c 6f63 6b42 7948 6173 685f  _getBlockByHash_
+00027dc0: 6e6f 745f 666f 756e 6428 0a20 2020 2020  not_found(.     
+00027dd0: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
+00027de0: 6233 222c 2065 6d70 7479 5f62 6c6f 636b  b3", empty_block
+00027df0: 3a20 426c 6f63 6b44 6174 610a 2020 2020  : BlockData.    
+00027e00: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00027e10: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+00027e20: 6169 7365 7328 426c 6f63 6b4e 6f74 466f  aises(BlockNotFo
+00027e30: 756e 6429 3a0a 2020 2020 2020 2020 2020  und):.          
+00027e40: 2020 7733 2e65 7468 2e67 6574 5f62 6c6f    w3.eth.get_blo
+00027e50: 636b 2855 4e4b 4e4f 574e 5f48 4153 4829  ck(UNKNOWN_HASH)
+00027e60: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+00027e70: 7468 5f67 6574 426c 6f63 6b42 7948 6173  th_getBlockByHas
+00027e80: 685f 7065 6e64 696e 6728 7365 6c66 2c20  h_pending(self, 
+00027e90: 7733 3a20 2257 6562 3322 2920 2d3e 204e  w3: "Web3") -> N
+00027ea0: 6f6e 653a 0a20 2020 2020 2020 2062 6c6f  one:.        blo
+00027eb0: 636b 203d 2077 332e 6574 682e 6765 745f  ck = w3.eth.get_
+00027ec0: 626c 6f63 6b28 2270 656e 6469 6e67 2229  block("pending")
+00027ed0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00027ee0: 626c 6f63 6b5b 2268 6173 6822 5d20 6973  block["hash"] is
+00027ef0: 204e 6f6e 650a 0a20 2020 2064 6566 2074   None..    def t
+00027f00: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
+00027f10: 4279 4e75 6d62 6572 5f77 6974 685f 696e  ByNumber_with_in
+00027f20: 7465 6765 7228 0a20 2020 2020 2020 2073  teger(.        s
+00027f30: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
+00027f40: 2065 6d70 7479 5f62 6c6f 636b 3a20 426c   empty_block: Bl
+00027f50: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+00027f60: 204e 6f6e 653a 0a20 2020 2020 2020 2062   None:.        b
+00027f70: 6c6f 636b 203d 2077 332e 6574 682e 6765  lock = w3.eth.ge
+00027f80: 745f 626c 6f63 6b28 656d 7074 795f 626c  t_block(empty_bl
+00027f90: 6f63 6b5b 226e 756d 6265 7222 5d29 0a20  ock["number"]). 
+00027fa0: 2020 2020 2020 2061 7373 6572 7420 626c         assert bl
+00027fb0: 6f63 6b5b 226e 756d 6265 7222 5d20 3d3d  ock["number"] ==
+00027fc0: 2065 6d70 7479 5f62 6c6f 636b 5b22 6e75   empty_block["nu
+00027fd0: 6d62 6572 225d 0a0a 2020 2020 6465 6620  mber"]..    def 
+00027fe0: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
+00027ff0: 6b42 794e 756d 6265 725f 6c61 7465 7374  kByNumber_latest
+00028000: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00028010: 7733 3a20 2257 6562 3322 2c20 656d 7074  w3: "Web3", empt
+00028020: 795f 626c 6f63 6b3a 2042 6c6f 636b 4461  y_block: BlockDa
+00028030: 7461 0a20 2020 2029 202d 3e20 4e6f 6e65  ta.    ) -> None
+00028040: 3a0a 2020 2020 2020 2020 6375 7272 656e  :.        curren
+00028050: 745f 626c 6f63 6b5f 6e75 6d62 6572 203d  t_block_number =
+00028060: 2077 332e 6574 682e 626c 6f63 6b5f 6e75   w3.eth.block_nu
+00028070: 6d62 6572 0a20 2020 2020 2020 2062 6c6f  mber.        blo
+00028080: 636b 203d 2077 332e 6574 682e 6765 745f  ck = w3.eth.get_
+00028090: 626c 6f63 6b28 226c 6174 6573 7422 290a  block("latest").
+000280a0: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
+000280b0: 6c6f 636b 5b22 6e75 6d62 6572 225d 203d  lock["number"] =
+000280c0: 3d20 6375 7272 656e 745f 626c 6f63 6b5f  = current_block_
+000280d0: 6e75 6d62 6572 0a0a 2020 2020 6465 6620  number..    def 
+000280e0: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
+000280f0: 6b42 794e 756d 6265 725f 6e6f 745f 666f  kByNumber_not_fo
+00028100: 756e 6428 0a20 2020 2020 2020 2073 656c  und(.        sel
+00028110: 662c 2077 333a 2022 5765 6233 222c 2065  f, w3: "Web3", e
+00028120: 6d70 7479 5f62 6c6f 636b 3a20 426c 6f63  mpty_block: Bloc
+00028130: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
+00028140: 6f6e 653a 0a20 2020 2020 2020 2077 6974  one:.        wit
+00028150: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+00028160: 426c 6f63 6b4e 6f74 466f 756e 6429 3a0a  BlockNotFound):.
+00028170: 2020 2020 2020 2020 2020 2020 7733 2e65              w3.e
+00028180: 7468 2e67 6574 5f62 6c6f 636b 2842 6c6f  th.get_block(Blo
+00028190: 636b 4e75 6d62 6572 2831 3233 3435 2929  ckNumber(12345))
+000281a0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+000281b0: 7468 5f67 6574 426c 6f63 6b42 794e 756d  th_getBlockByNum
+000281c0: 6265 725f 7065 6e64 696e 6728 0a20 2020  ber_pending(.   
+000281d0: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
+000281e0: 5765 6233 222c 2065 6d70 7479 5f62 6c6f  Web3", empty_blo
+000281f0: 636b 3a20 426c 6f63 6b44 6174 610a 2020  ck: BlockData.  
+00028200: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00028210: 2020 2020 2063 7572 7265 6e74 5f62 6c6f       current_blo
+00028220: 636b 5f6e 756d 6265 7220 3d20 7733 2e65  ck_number = w3.e
+00028230: 7468 2e62 6c6f 636b 5f6e 756d 6265 720a  th.block_number.
+00028240: 2020 2020 2020 2020 626c 6f63 6b20 3d20          block = 
+00028250: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
+00028260: 2822 7065 6e64 696e 6722 290a 2020 2020  ("pending").    
+00028270: 2020 2020 6173 7365 7274 2062 6c6f 636b      assert block
+00028280: 5b22 6e75 6d62 6572 225d 203d 3d20 6375  ["number"] == cu
+00028290: 7272 656e 745f 626c 6f63 6b5f 6e75 6d62  rrent_block_numb
+000282a0: 6572 202b 2031 0a0a 2020 2020 6465 6620  er + 1..    def 
+000282b0: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
+000282c0: 6b42 794e 756d 6265 725f 6561 726c 6965  kByNumber_earlie
+000282d0: 7374 280a 2020 2020 2020 2020 7365 6c66  st(.        self
+000282e0: 2c20 7733 3a20 2257 6562 3322 2c20 656d  , w3: "Web3", em
+000282f0: 7074 795f 626c 6f63 6b3a 2042 6c6f 636b  pty_block: Block
+00028300: 4461 7461 0a20 2020 2029 202d 3e20 4e6f  Data.    ) -> No
+00028310: 6e65 3a0a 2020 2020 2020 2020 6765 6e65  ne:.        gene
+00028320: 7369 735f 626c 6f63 6b20 3d20 7733 2e65  sis_block = w3.e
+00028330: 7468 2e67 6574 5f62 6c6f 636b 2842 6c6f  th.get_block(Blo
+00028340: 636b 4e75 6d62 6572 2830 2929 0a20 2020  ckNumber(0)).   
+00028350: 2020 2020 2062 6c6f 636b 203d 2077 332e       block = w3.
+00028360: 6574 682e 6765 745f 626c 6f63 6b28 2265  eth.get_block("e
+00028370: 6172 6c69 6573 7422 290a 2020 2020 2020  arliest").      
+00028380: 2020 6173 7365 7274 2062 6c6f 636b 5b22    assert block["
+00028390: 6e75 6d62 6572 225d 203d 3d20 300a 2020  number"] == 0.  
+000283a0: 2020 2020 2020 6173 7365 7274 2062 6c6f        assert blo
+000283b0: 636b 5b22 6861 7368 225d 203d 3d20 6765  ck["hash"] == ge
+000283c0: 6e65 7369 735f 626c 6f63 6b5b 2268 6173  nesis_block["has
+000283d0: 6822 5d0a 0a20 2020 2064 6566 2074 6573  h"]..    def tes
+000283e0: 745f 6574 685f 6765 7442 6c6f 636b 4279  t_eth_getBlockBy
+000283f0: 4e75 6d62 6572 5f73 6166 6528 0a20 2020  Number_safe(.   
+00028400: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
+00028410: 5765 6233 222c 2065 6d70 7479 5f62 6c6f  Web3", empty_blo
+00028420: 636b 3a20 426c 6f63 6b44 6174 610a 2020  ck: BlockData.  
+00028430: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00028440: 2020 2020 2062 6c6f 636b 203d 2077 332e       block = w3.
+00028450: 6574 682e 6765 745f 626c 6f63 6b28 2273  eth.get_block("s
+00028460: 6166 6522 290a 2020 2020 2020 2020 6173  afe").        as
+00028470: 7365 7274 2062 6c6f 636b 2069 7320 6e6f  sert block is no
+00028480: 7420 4e6f 6e65 0a20 2020 2020 2020 2061  t None.        a
+00028490: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
+000284a0: 2862 6c6f 636b 5b22 6e75 6d62 6572 225d  (block["number"]
+000284b0: 2c20 696e 7429 0a0a 2020 2020 6465 6620  , int)..    def 
+000284c0: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
+000284d0: 6b42 794e 756d 6265 725f 6669 6e61 6c69  kByNumber_finali
+000284e0: 7a65 6428 0a20 2020 2020 2020 2073 656c  zed(.        sel
+000284f0: 662c 2077 333a 2022 5765 6233 222c 2065  f, w3: "Web3", e
+00028500: 6d70 7479 5f62 6c6f 636b 3a20 426c 6f63  mpty_block: Bloc
+00028510: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
+00028520: 6f6e 653a 0a20 2020 2020 2020 2062 6c6f  one:.        blo
+00028530: 636b 203d 2077 332e 6574 682e 6765 745f  ck = w3.eth.get_
+00028540: 626c 6f63 6b28 2266 696e 616c 697a 6564  block("finalized
+00028550: 2229 0a20 2020 2020 2020 2061 7373 6572  ").        asser
+00028560: 7420 626c 6f63 6b20 6973 206e 6f74 204e  t block is not N
+00028570: 6f6e 650a 2020 2020 2020 2020 6173 7365  one.        asse
+00028580: 7274 2069 7369 6e73 7461 6e63 6528 626c  rt isinstance(bl
+00028590: 6f63 6b5b 226e 756d 6265 7222 5d2c 2069  ock["number"], i
+000285a0: 6e74 290a 0a20 2020 2064 6566 2074 6573  nt)..    def tes
+000285b0: 745f 6574 685f 6765 7442 6c6f 636b 4279  t_eth_getBlockBy
+000285c0: 4e75 6d62 6572 5f66 756c 6c5f 7472 616e  Number_full_tran
+000285d0: 7361 6374 696f 6e73 280a 2020 2020 2020  sactions(.      
+000285e0: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+000285f0: 3322 2c20 626c 6f63 6b5f 7769 7468 5f74  3", block_with_t
+00028600: 786e 3a20 426c 6f63 6b44 6174 610a 2020  xn: BlockData.  
+00028610: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00028620: 2020 2020 2062 6c6f 636b 203d 2077 332e       block = w3.
+00028630: 6574 682e 6765 745f 626c 6f63 6b28 626c  eth.get_block(bl
+00028640: 6f63 6b5f 7769 7468 5f74 786e 5b22 6e75  ock_with_txn["nu
+00028650: 6d62 6572 225d 2c20 5472 7565 290a 2020  mber"], True).  
+00028660: 2020 2020 2020 7472 616e 7361 6374 696f        transactio
+00028670: 6e20 3d20 626c 6f63 6b5b 2274 7261 6e73  n = block["trans
+00028680: 6163 7469 6f6e 7322 5d5b 305d 0a20 2020  actions"][0].   
+00028690: 2020 2020 2061 7373 6572 7420 7472 616e       assert tran
+000286a0: 7361 6374 696f 6e5b 2268 6173 6822 5d20  saction["hash"] 
+000286b0: 3d3d 2062 6c6f 636b 5f77 6974 685f 7478  == block_with_tx
+000286c0: 6e5b 2274 7261 6e73 6163 7469 6f6e 7322  n["transactions"
+000286d0: 5d5b 305d 0a0a 2020 2020 6465 6620 7465  ][0]..    def te
+000286e0: 7374 5f65 7468 5f67 6574 426c 6f63 6b52  st_eth_getBlockR
+000286f0: 6563 6569 7074 735f 6861 7368 280a 2020  eceipts_hash(.  
+00028700: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+00028710: 2257 6562 3322 2c20 656d 7074 795f 626c  "Web3", empty_bl
+00028720: 6f63 6b3a 2042 6c6f 636b 4461 7461 0a20  ock: BlockData. 
+00028730: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00028740: 2020 2020 2020 7265 6365 6970 7473 203d        receipts =
+00028750: 2077 332e 6574 682e 6765 745f 626c 6f63   w3.eth.get_bloc
+00028760: 6b5f 7265 6365 6970 7473 2865 6d70 7479  k_receipts(empty
+00028770: 5f62 6c6f 636b 5b22 6861 7368 225d 290a  _block["hash"]).
+00028780: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00028790: 7369 6e73 7461 6e63 6528 7265 6365 6970  sinstance(receip
+000287a0: 7473 2c20 6c69 7374 290a 0a20 2020 2064  ts, list)..    d
+000287b0: 6566 2074 6573 745f 6574 685f 6765 7442  ef test_eth_getB
+000287c0: 6c6f 636b 5265 6365 6970 7473 5f6e 6f74  lockReceipts_not
+000287d0: 5f66 6f75 6e64 2873 656c 662c 2077 333a  _found(self, w3:
+000287e0: 2022 5765 6233 2229 202d 3e20 4e6f 6e65   "Web3") -> None
+000287f0: 3a0a 2020 2020 2020 2020 7769 7468 2070  :.        with p
+00028800: 7974 6573 742e 7261 6973 6573 2842 6c6f  ytest.raises(Blo
+00028810: 636b 4e6f 7446 6f75 6e64 293a 0a20 2020  ckNotFound):.   
+00028820: 2020 2020 2020 2020 2077 332e 6574 682e           w3.eth.
+00028830: 6765 745f 626c 6f63 6b5f 7265 6365 6970  get_block_receip
+00028840: 7473 2855 4e4b 4e4f 574e 5f48 4153 4829  ts(UNKNOWN_HASH)
+00028850: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+00028860: 7468 5f67 6574 426c 6f63 6b52 6563 6569  th_getBlockRecei
+00028870: 7074 735f 7769 7468 5f69 6e74 6567 6572  pts_with_integer
+00028880: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00028890: 7733 3a20 2257 6562 3322 2c20 656d 7074  w3: "Web3", empt
+000288a0: 795f 626c 6f63 6b3a 2042 6c6f 636b 4461  y_block: BlockDa
+000288b0: 7461 0a20 2020 2029 202d 3e20 4e6f 6e65  ta.    ) -> None
+000288c0: 3a0a 2020 2020 2020 2020 7265 6365 6970  :.        receip
+000288d0: 7473 203d 2077 332e 6574 682e 6765 745f  ts = w3.eth.get_
+000288e0: 626c 6f63 6b5f 7265 6365 6970 7473 2865  block_receipts(e
+000288f0: 6d70 7479 5f62 6c6f 636b 5b22 6e75 6d62  mpty_block["numb
+00028900: 6572 225d 290a 2020 2020 2020 2020 6173  er"]).        as
+00028910: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
+00028920: 7265 6365 6970 7473 2c20 6c69 7374 290a  receipts, list).
+00028930: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+00028940: 685f 6765 7442 6c6f 636b 5265 6365 6970  h_getBlockReceip
+00028950: 7473 5f73 6166 6528 0a20 2020 2020 2020  ts_safe(.       
+00028960: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
+00028970: 222c 2065 6d70 7479 5f62 6c6f 636b 3a20  ", empty_block: 
+00028980: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
+00028990: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+000289a0: 2072 6563 6569 7074 7320 3d20 7733 2e65   receipts = w3.e
+000289b0: 7468 2e67 6574 5f62 6c6f 636b 5f72 6563  th.get_block_rec
+000289c0: 6569 7074 7328 2273 6166 6522 290a 2020  eipts("safe").  
+000289d0: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
+000289e0: 6e73 7461 6e63 6528 7265 6365 6970 7473  nstance(receipts
+000289f0: 2c20 6c69 7374 290a 0a20 2020 2064 6566  , list)..    def
+00028a00: 2074 6573 745f 6574 685f 6765 7442 6c6f   test_eth_getBlo
+00028a10: 636b 5265 6365 6970 7473 5f66 696e 616c  ckReceipts_final
+00028a20: 697a 6564 280a 2020 2020 2020 2020 7365  ized(.        se
+00028a30: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+00028a40: 656d 7074 795f 626c 6f63 6b3a 2042 6c6f  empty_block: Blo
+00028a50: 636b 4461 7461 0a20 2020 2029 202d 3e20  ckData.    ) -> 
+00028a60: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
+00028a70: 6365 6970 7473 203d 2077 332e 6574 682e  ceipts = w3.eth.
+00028a80: 6765 745f 626c 6f63 6b5f 7265 6365 6970  get_block_receip
+00028a90: 7473 2822 6669 6e61 6c69 7a65 6422 290a  ts("finalized").
+00028aa0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00028ab0: 7369 6e73 7461 6e63 6528 7265 6365 6970  sinstance(receip
+00028ac0: 7473 2c20 6c69 7374 290a 0a20 2020 2064  ts, list)..    d
+00028ad0: 6566 2074 6573 745f 6574 685f 6765 7454  ef test_eth_getT
+00028ae0: 7261 6e73 6163 7469 6f6e 4279 4861 7368  ransactionByHash
+00028af0: 2873 656c 662c 2077 333a 2022 5765 6233  (self, w3: "Web3
+00028b00: 222c 206d 696e 6564 5f74 786e 5f68 6173  ", mined_txn_has
+00028b10: 683a 2048 6578 5374 7229 202d 3e20 4e6f  h: HexStr) -> No
+00028b20: 6e65 3a0a 2020 2020 2020 2020 7472 616e  ne:.        tran
+00028b30: 7361 6374 696f 6e20 3d20 7733 2e65 7468  saction = w3.eth
+00028b40: 2e67 6574 5f74 7261 6e73 6163 7469 6f6e  .get_transaction
+00028b50: 286d 696e 6564 5f74 786e 5f68 6173 6829  (mined_txn_hash)
+00028b60: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00028b70: 6973 5f64 6963 7428 7472 616e 7361 6374  is_dict(transact
+00028b80: 696f 6e29 0a20 2020 2020 2020 2061 7373  ion).        ass
+00028b90: 6572 7420 7472 616e 7361 6374 696f 6e5b  ert transaction[
+00028ba0: 2268 6173 6822 5d20 3d3d 2048 6578 4279  "hash"] == HexBy
+00028bb0: 7465 7328 6d69 6e65 645f 7478 6e5f 6861  tes(mined_txn_ha
+00028bc0: 7368 290a 0a20 2020 2064 6566 2074 6573  sh)..    def tes
+00028bd0: 745f 6574 685f 6765 7454 7261 6e73 6163  t_eth_getTransac
+00028be0: 7469 6f6e 4279 4861 7368 5f63 6f6e 7472  tionByHash_contr
+00028bf0: 6163 745f 6372 6561 7469 6f6e 280a 2020  act_creation(.  
+00028c00: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+00028c10: 2257 6562 3322 2c20 6d61 7468 5f63 6f6e  "Web3", math_con
+00028c20: 7472 6163 745f 6465 706c 6f79 5f74 786e  tract_deploy_txn
+00028c30: 5f68 6173 683a 2048 6578 5374 720a 2020  _hash: HexStr.  
+00028c40: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00028c50: 2020 2020 2074 7261 6e73 6163 7469 6f6e       transaction
+00028c60: 203d 2077 332e 6574 682e 6765 745f 7472   = w3.eth.get_tr
+00028c70: 616e 7361 6374 696f 6e28 6d61 7468 5f63  ansaction(math_c
+00028c80: 6f6e 7472 6163 745f 6465 706c 6f79 5f74  ontract_deploy_t
+00028c90: 786e 5f68 6173 6829 0a20 2020 2020 2020  xn_hash).       
+00028ca0: 2061 7373 6572 7420 6973 5f64 6963 7428   assert is_dict(
+00028cb0: 7472 616e 7361 6374 696f 6e29 0a20 2020  transaction).   
+00028cc0: 2020 2020 2061 7373 6572 7420 7472 616e       assert tran
+00028cd0: 7361 6374 696f 6e5b 2274 6f22 5d20 6973  saction["to"] is
+00028ce0: 204e 6f6e 652c 2066 2274 6f20 6669 656c   None, f"to fiel
+00028cf0: 6420 6973 207b 7472 616e 7361 6374 696f  d is {transactio
+00028d00: 6e5b 2774 6f27 5d21 727d 220a 0a20 2020  n['to']!r}"..   
+00028d10: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+00028d20: 7454 7261 6e73 6163 7469 6f6e 4279 426c  tTransactionByBl
+00028d30: 6f63 6b48 6173 6841 6e64 496e 6465 7828  ockHashAndIndex(
+00028d40: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+00028d50: 333a 2022 5765 6233 222c 2062 6c6f 636b  3: "Web3", block
+00028d60: 5f77 6974 685f 7478 6e3a 2042 6c6f 636b  _with_txn: Block
+00028d70: 4461 7461 2c20 6d69 6e65 645f 7478 6e5f  Data, mined_txn_
+00028d80: 6861 7368 3a20 4865 7853 7472 0a20 2020  hash: HexStr.   
+00028d90: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00028da0: 2020 2020 7472 616e 7361 6374 696f 6e20      transaction 
+00028db0: 3d20 7733 2e65 7468 2e67 6574 5f74 7261  = w3.eth.get_tra
+00028dc0: 6e73 6163 7469 6f6e 5f62 795f 626c 6f63  nsaction_by_bloc
+00028dd0: 6b28 626c 6f63 6b5f 7769 7468 5f74 786e  k(block_with_txn
+00028de0: 5b22 6861 7368 225d 2c20 3029 0a20 2020  ["hash"], 0).   
+00028df0: 2020 2020 2061 7373 6572 7420 6973 5f64       assert is_d
+00028e00: 6963 7428 7472 616e 7361 6374 696f 6e29  ict(transaction)
+00028e10: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00028e20: 7472 616e 7361 6374 696f 6e5b 2268 6173  transaction["has
+00028e30: 6822 5d20 3d3d 2048 6578 4279 7465 7328  h"] == HexBytes(
+00028e40: 6d69 6e65 645f 7478 6e5f 6861 7368 290a  mined_txn_hash).
+00028e50: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+00028e60: 685f 6765 7454 7261 6e73 6163 7469 6f6e  h_getTransaction
+00028e70: 4279 426c 6f63 6b4e 756d 6265 7241 6e64  ByBlockNumberAnd
+00028e80: 496e 6465 7828 0a20 2020 2020 2020 2073  Index(.        s
+00028e90: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
+00028ea0: 2062 6c6f 636b 5f77 6974 685f 7478 6e3a   block_with_txn:
+00028eb0: 2042 6c6f 636b 4461 7461 2c20 6d69 6e65   BlockData, mine
+00028ec0: 645f 7478 6e5f 6861 7368 3a20 4865 7853  d_txn_hash: HexS
+00028ed0: 7472 0a20 2020 2029 202d 3e20 4e6f 6e65  tr.    ) -> None
+00028ee0: 3a0a 2020 2020 2020 2020 7472 616e 7361  :.        transa
+00028ef0: 6374 696f 6e20 3d20 7733 2e65 7468 2e67  ction = w3.eth.g
+00028f00: 6574 5f74 7261 6e73 6163 7469 6f6e 5f62  et_transaction_b
+00028f10: 795f 626c 6f63 6b28 626c 6f63 6b5f 7769  y_block(block_wi
+00028f20: 7468 5f74 786e 5b22 6e75 6d62 6572 225d  th_txn["number"]
+00028f30: 2c20 3029 0a20 2020 2020 2020 2061 7373  , 0).        ass
+00028f40: 6572 7420 6973 5f64 6963 7428 7472 616e  ert is_dict(tran
+00028f50: 7361 6374 696f 6e29 0a20 2020 2020 2020  saction).       
+00028f60: 2061 7373 6572 7420 7472 616e 7361 6374   assert transact
+00028f70: 696f 6e5b 2268 6173 6822 5d20 3d3d 2048  ion["hash"] == H
+00028f80: 6578 4279 7465 7328 6d69 6e65 645f 7478  exBytes(mined_tx
+00028f90: 6e5f 6861 7368 290a 0a20 2020 2064 6566  n_hash)..    def
+00028fa0: 2074 6573 745f 6574 685f 6765 745f 7472   test_eth_get_tr
+00028fb0: 616e 7361 6374 696f 6e5f 7265 6365 6970  ansaction_receip
+00028fc0: 745f 6d69 6e65 6428 0a20 2020 2020 2020  t_mined(.       
+00028fd0: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
+00028fe0: 222c 2062 6c6f 636b 5f77 6974 685f 7478  ", block_with_tx
+00028ff0: 6e3a 2042 6c6f 636b 4461 7461 2c20 6d69  n: BlockData, mi
+00029000: 6e65 645f 7478 6e5f 6861 7368 3a20 4865  ned_txn_hash: He
+00029010: 7853 7472 0a20 2020 2029 202d 3e20 4e6f  xStr.    ) -> No
+00029020: 6e65 3a0a 2020 2020 2020 2020 7265 6365  ne:.        rece
+00029030: 6970 7420 3d20 7733 2e65 7468 2e67 6574  ipt = w3.eth.get
+00029040: 5f74 7261 6e73 6163 7469 6f6e 5f72 6563  _transaction_rec
+00029050: 6569 7074 286d 696e 6564 5f74 786e 5f68  eipt(mined_txn_h
+00029060: 6173 6829 0a20 2020 2020 2020 2061 7373  ash).        ass
+00029070: 6572 7420 6973 5f64 6963 7428 7265 6365  ert is_dict(rece
+00029080: 6970 7429 0a20 2020 2020 2020 2061 7373  ipt).        ass
+00029090: 6572 7420 7265 6365 6970 745b 2262 6c6f  ert receipt["blo
+000290a0: 636b 4e75 6d62 6572 225d 203d 3d20 626c  ckNumber"] == bl
+000290b0: 6f63 6b5f 7769 7468 5f74 786e 5b22 6e75  ock_with_txn["nu
+000290c0: 6d62 6572 225d 0a20 2020 2020 2020 2061  mber"].        a
+000290d0: 7373 6572 7420 7265 6365 6970 745b 2262  ssert receipt["b
+000290e0: 6c6f 636b 4861 7368 225d 203d 3d20 626c  lockHash"] == bl
+000290f0: 6f63 6b5f 7769 7468 5f74 786e 5b22 6861  ock_with_txn["ha
+00029100: 7368 225d 0a20 2020 2020 2020 2061 7373  sh"].        ass
+00029110: 6572 7420 7265 6365 6970 745b 2274 7261  ert receipt["tra
+00029120: 6e73 6163 7469 6f6e 496e 6465 7822 5d20  nsactionIndex"] 
+00029130: 3d3d 2030 0a20 2020 2020 2020 2061 7373  == 0.        ass
+00029140: 6572 7420 7265 6365 6970 745b 2274 7261  ert receipt["tra
+00029150: 6e73 6163 7469 6f6e 4861 7368 225d 203d  nsactionHash"] =
+00029160: 3d20 4865 7842 7974 6573 286d 696e 6564  = HexBytes(mined
+00029170: 5f74 786e 5f68 6173 6829 0a20 2020 2020  _txn_hash).     
+00029180: 2020 2061 7373 6572 7420 6973 5f63 6865     assert is_che
+00029190: 636b 7375 6d5f 6164 6472 6573 7328 7265  cksum_address(re
+000291a0: 6365 6970 745b 2274 6f22 5d29 0a20 2020  ceipt["to"]).   
+000291b0: 2020 2020 2061 7373 6572 7420 7265 6365       assert rece
+000291c0: 6970 745b 2266 726f 6d22 5d20 6973 206e  ipt["from"] is n
+000291d0: 6f74 204e 6f6e 650a 2020 2020 2020 2020  ot None.        
+000291e0: 6173 7365 7274 2069 735f 6368 6563 6b73  assert is_checks
+000291f0: 756d 5f61 6464 7265 7373 2872 6563 6569  um_address(recei
+00029200: 7074 5b22 6672 6f6d 225d 290a 0a20 2020  pt["from"])..   
+00029210: 2020 2020 2065 6666 6563 7469 7665 5f67       effective_g
+00029220: 6173 5f70 7269 6365 203d 2072 6563 6569  as_price = recei
+00029230: 7074 5b22 6566 6665 6374 6976 6547 6173  pt["effectiveGas
+00029240: 5072 6963 6522 5d0a 2020 2020 2020 2020  Price"].        
+00029250: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
+00029260: 6528 6566 6665 6374 6976 655f 6761 735f  e(effective_gas_
+00029270: 7072 6963 652c 2069 6e74 290a 2020 2020  price, int).    
+00029280: 2020 2020 6173 7365 7274 2065 6666 6563      assert effec
+00029290: 7469 7665 5f67 6173 5f70 7269 6365 203e  tive_gas_price >
+000292a0: 2030 0a0a 2020 2020 6465 6620 7465 7374   0..    def test
+000292b0: 5f65 7468 5f67 6574 5f74 7261 6e73 6163  _eth_get_transac
+000292c0: 7469 6f6e 5f72 6563 6569 7074 5f75 6e6d  tion_receipt_unm
+000292d0: 696e 6564 280a 2020 2020 2020 2020 7365  ined(.        se
+000292e0: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+000292f0: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+00029300: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
+00029310: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
+00029320: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00029330: 2020 2074 786e 5f68 6173 6820 3d20 7733     txn_hash = w3
+00029340: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+00029350: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+00029360: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00029370: 2020 2020 2022 6672 6f6d 223a 2075 6e6c       "from": unl
+00029380: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+00029390: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+000293a0: 2020 2020 2020 2020 2022 746f 223a 2075           "to": u
+000293b0: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+000293c0: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+000293d0: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+000293e0: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+000293f0: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+00029400: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
+00029410: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
+00029420: 6550 6572 4761 7322 3a20 7733 2e74 6f5f  ePerGas": w3.to_
+00029430: 7765 6928 332c 2022 6777 6569 2229 2c0a  wei(3, "gwei"),.
+00029440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029450: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+00029460: 6572 4761 7322 3a20 7733 2e74 6f5f 7765  erGas": w3.to_we
+00029470: 6928 312c 2022 6777 6569 2229 2c0a 2020  i(1, "gwei"),.  
+00029480: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+00029490: 2020 2020 290a 2020 2020 2020 2020 7769      ).        wi
+000294a0: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+000294b0: 2854 7261 6e73 6163 7469 6f6e 4e6f 7446  (TransactionNotF
+000294c0: 6f75 6e64 293a 0a20 2020 2020 2020 2020  ound):.         
+000294d0: 2020 2077 332e 6574 682e 6765 745f 7472     w3.eth.get_tr
+000294e0: 616e 7361 6374 696f 6e5f 7265 6365 6970  ansaction_receip
+000294f0: 7428 7478 6e5f 6861 7368 290a 0a20 2020  t(txn_hash)..   
+00029500: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+00029510: 745f 7472 616e 7361 6374 696f 6e5f 7265  t_transaction_re
+00029520: 6365 6970 745f 7769 7468 5f6c 6f67 5f65  ceipt_with_log_e
+00029530: 6e74 7279 280a 2020 2020 2020 2020 7365  ntry(.        se
+00029540: 6c66 2c0a 2020 2020 2020 2020 7733 3a20  lf,.        w3: 
+00029550: 2257 6562 3322 2c0a 2020 2020 2020 2020  "Web3",.        
+00029560: 626c 6f63 6b5f 7769 7468 5f74 786e 5f77  block_with_txn_w
+00029570: 6974 685f 6c6f 673a 2042 6c6f 636b 4461  ith_log: BlockDa
+00029580: 7461 2c0a 2020 2020 2020 2020 656d 6974  ta,.        emit
+00029590: 7465 725f 636f 6e74 7261 6374 3a20 2243  ter_contract: "C
+000295a0: 6f6e 7472 6163 7422 2c0a 2020 2020 2020  ontract",.      
+000295b0: 2020 7478 6e5f 6861 7368 5f77 6974 685f    txn_hash_with_
+000295c0: 6c6f 673a 2048 6578 5374 722c 0a20 2020  log: HexStr,.   
+000295d0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+000295e0: 2020 2020 7265 6365 6970 7420 3d20 7733      receipt = w3
+000295f0: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
+00029600: 7469 6f6e 5f72 6563 6569 7074 2874 786e  tion_receipt(txn
+00029610: 5f68 6173 685f 7769 7468 5f6c 6f67 290a  _hash_with_log).
+00029620: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00029630: 735f 6469 6374 2872 6563 6569 7074 290a  s_dict(receipt).
+00029640: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00029650: 6563 6569 7074 5b22 626c 6f63 6b4e 756d  eceipt["blockNum
+00029660: 6265 7222 5d20 3d3d 2062 6c6f 636b 5f77  ber"] == block_w
+00029670: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
+00029680: 5b22 6e75 6d62 6572 225d 0a20 2020 2020  ["number"].     
+00029690: 2020 2061 7373 6572 7420 7265 6365 6970     assert receip
+000296a0: 745b 2262 6c6f 636b 4861 7368 225d 203d  t["blockHash"] =
+000296b0: 3d20 626c 6f63 6b5f 7769 7468 5f74 786e  = block_with_txn
+000296c0: 5f77 6974 685f 6c6f 675b 2268 6173 6822  _with_log["hash"
+000296d0: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+000296e0: 2072 6563 6569 7074 5b22 7472 616e 7361   receipt["transa
+000296f0: 6374 696f 6e49 6e64 6578 225d 203d 3d20  ctionIndex"] == 
+00029700: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
+00029710: 2072 6563 6569 7074 5b22 7472 616e 7361   receipt["transa
+00029720: 6374 696f 6e48 6173 6822 5d20 3d3d 2048  ctionHash"] == H
+00029730: 6578 4279 7465 7328 7478 6e5f 6861 7368  exBytes(txn_hash
+00029740: 5f77 6974 685f 6c6f 6729 0a0a 2020 2020  _with_log)..    
+00029750: 2020 2020 6173 7365 7274 206c 656e 2872      assert len(r
+00029760: 6563 6569 7074 5b22 6c6f 6773 225d 2920  eceipt["logs"]) 
+00029770: 3d3d 2031 0a20 2020 2020 2020 206c 6f67  == 1.        log
+00029780: 5f65 6e74 7279 203d 2072 6563 6569 7074  _entry = receipt
+00029790: 5b22 6c6f 6773 225d 5b30 5d0a 0a20 2020  ["logs"][0]..   
+000297a0: 2020 2020 2061 7373 6572 7420 6c6f 675f       assert log_
+000297b0: 656e 7472 795b 2262 6c6f 636b 4e75 6d62  entry["blockNumb
+000297c0: 6572 225d 203d 3d20 626c 6f63 6b5f 7769  er"] == block_wi
+000297d0: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
+000297e0: 226e 756d 6265 7222 5d0a 2020 2020 2020  "number"].      
+000297f0: 2020 6173 7365 7274 206c 6f67 5f65 6e74    assert log_ent
+00029800: 7279 5b22 626c 6f63 6b48 6173 6822 5d20  ry["blockHash"] 
+00029810: 3d3d 2062 6c6f 636b 5f77 6974 685f 7478  == block_with_tx
+00029820: 6e5f 7769 7468 5f6c 6f67 5b22 6861 7368  n_with_log["hash
+00029830: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
+00029840: 7420 6c6f 675f 656e 7472 795b 226c 6f67  t log_entry["log
+00029850: 496e 6465 7822 5d20 3d3d 2030 0a20 2020  Index"] == 0.   
+00029860: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
+00029870: 616d 655f 6164 6472 6573 7328 6c6f 675f  ame_address(log_
+00029880: 656e 7472 795b 2261 6464 7265 7373 225d  entry["address"]
+00029890: 2c20 656d 6974 7465 725f 636f 6e74 7261  , emitter_contra
+000298a0: 6374 2e61 6464 7265 7373 290a 2020 2020  ct.address).    
+000298b0: 2020 2020 6173 7365 7274 206c 6f67 5f65      assert log_e
+000298c0: 6e74 7279 5b22 7472 616e 7361 6374 696f  ntry["transactio
+000298d0: 6e49 6e64 6578 225d 203d 3d20 300a 2020  nIndex"] == 0.  
+000298e0: 2020 2020 2020 6173 7365 7274 206c 6f67        assert log
+000298f0: 5f65 6e74 7279 5b22 7472 616e 7361 6374  _entry["transact
+00029900: 696f 6e48 6173 6822 5d20 3d3d 2048 6578  ionHash"] == Hex
+00029910: 4279 7465 7328 7478 6e5f 6861 7368 5f77  Bytes(txn_hash_w
+00029920: 6974 685f 6c6f 6729 0a0a 2020 2020 6465  ith_log)..    de
+00029930: 6620 7465 7374 5f65 7468 5f77 6169 745f  f test_eth_wait_
+00029940: 666f 725f 7472 616e 7361 6374 696f 6e5f  for_transaction_
+00029950: 7265 6365 6970 745f 6d69 6e65 6428 0a20  receipt_mined(. 
+00029960: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
+00029970: 2022 5765 6233 222c 2062 6c6f 636b 5f77   "Web3", block_w
+00029980: 6974 685f 7478 6e3a 2042 6c6f 636b 4461  ith_txn: BlockDa
+00029990: 7461 2c20 6d69 6e65 645f 7478 6e5f 6861  ta, mined_txn_ha
+000299a0: 7368 3a20 4865 7853 7472 0a20 2020 2029  sh: HexStr.    )
+000299b0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+000299c0: 2020 7265 6365 6970 7420 3d20 7733 2e65    receipt = w3.e
+000299d0: 7468 2e77 6169 745f 666f 725f 7472 616e  th.wait_for_tran
+000299e0: 7361 6374 696f 6e5f 7265 6365 6970 7428  saction_receipt(
+000299f0: 6d69 6e65 645f 7478 6e5f 6861 7368 290a  mined_txn_hash).
+00029a00: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00029a10: 735f 6469 6374 2872 6563 6569 7074 290a  s_dict(receipt).
+00029a20: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00029a30: 6563 6569 7074 5b22 626c 6f63 6b4e 756d  eceipt["blockNum
+00029a40: 6265 7222 5d20 3d3d 2062 6c6f 636b 5f77  ber"] == block_w
+00029a50: 6974 685f 7478 6e5b 226e 756d 6265 7222  ith_txn["number"
+00029a60: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+00029a70: 2072 6563 6569 7074 5b22 626c 6f63 6b48   receipt["blockH
+00029a80: 6173 6822 5d20 3d3d 2062 6c6f 636b 5f77  ash"] == block_w
+00029a90: 6974 685f 7478 6e5b 2268 6173 6822 5d0a  ith_txn["hash"].
+00029aa0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00029ab0: 6563 6569 7074 5b22 7472 616e 7361 6374  eceipt["transact
+00029ac0: 696f 6e49 6e64 6578 225d 203d 3d20 300a  ionIndex"] == 0.
+00029ad0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00029ae0: 6563 6569 7074 5b22 7472 616e 7361 6374  eceipt["transact
+00029af0: 696f 6e48 6173 6822 5d20 3d3d 2048 6578  ionHash"] == Hex
+00029b00: 4279 7465 7328 6d69 6e65 645f 7478 6e5f  Bytes(mined_txn_
+00029b10: 6861 7368 290a 2020 2020 2020 2020 6173  hash).        as
+00029b20: 7365 7274 2069 735f 6368 6563 6b73 756d  sert is_checksum
+00029b30: 5f61 6464 7265 7373 2872 6563 6569 7074  _address(receipt
+00029b40: 5b22 746f 225d 290a 2020 2020 2020 2020  ["to"]).        
+00029b50: 6173 7365 7274 2072 6563 6569 7074 5b22  assert receipt["
+00029b60: 6672 6f6d 225d 2069 7320 6e6f 7420 4e6f  from"] is not No
+00029b70: 6e65 0a20 2020 2020 2020 2061 7373 6572  ne.        asser
+00029b80: 7420 6973 5f63 6865 636b 7375 6d5f 6164  t is_checksum_ad
+00029b90: 6472 6573 7328 7265 6365 6970 745b 2266  dress(receipt["f
+00029ba0: 726f 6d22 5d29 0a0a 2020 2020 2020 2020  rom"])..        
+00029bb0: 6566 6665 6374 6976 655f 6761 735f 7072  effective_gas_pr
+00029bc0: 6963 6520 3d20 7265 6365 6970 745b 2265  ice = receipt["e
+00029bd0: 6666 6563 7469 7665 4761 7350 7269 6365  ffectiveGasPrice
+00029be0: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
+00029bf0: 7420 6973 696e 7374 616e 6365 2865 6666  t isinstance(eff
+00029c00: 6563 7469 7665 5f67 6173 5f70 7269 6365  ective_gas_price
+00029c10: 2c20 696e 7429 0a20 2020 2020 2020 2061  , int).        a
+00029c20: 7373 6572 7420 6566 6665 6374 6976 655f  ssert effective_
+00029c30: 6761 735f 7072 6963 6520 3e20 300a 0a20  gas_price > 0.. 
+00029c40: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+00029c50: 7761 6974 5f66 6f72 5f74 7261 6e73 6163  wait_for_transac
+00029c60: 7469 6f6e 5f72 6563 6569 7074 5f75 6e6d  tion_receipt_unm
+00029c70: 696e 6564 280a 2020 2020 2020 2020 7365  ined(.        se
+00029c80: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+00029c90: 756e 6c6f 636b 6564 5f61 6363 6f75 6e74  unlocked_account
+00029ca0: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
+00029cb0: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
+00029cc0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00029cd0: 2020 2074 786e 5f68 6173 6820 3d20 7733     txn_hash = w3
+00029ce0: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+00029cf0: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+00029d00: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00029d10: 2020 2020 2022 6672 6f6d 223a 2075 6e6c       "from": unl
+00029d20: 6f63 6b65 645f 6163 636f 756e 745f 6475  ocked_account_du
+00029d30: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00029d40: 2020 2020 2020 2020 2022 746f 223a 2075           "to": u
+00029d50: 6e6c 6f63 6b65 645f 6163 636f 756e 745f  nlocked_account_
+00029d60: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+00029d70: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+00029d80: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+00029d90: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+00029da0: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
+00029db0: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
+00029dc0: 6550 6572 4761 7322 3a20 7733 2e74 6f5f  ePerGas": w3.to_
+00029dd0: 7765 6928 332c 2022 6777 6569 2229 2c0a  wei(3, "gwei"),.
+00029de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029df0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+00029e00: 6572 4761 7322 3a20 7733 2e74 6f5f 7765  erGas": w3.to_we
+00029e10: 6928 312c 2022 6777 6569 2229 2c0a 2020  i(1, "gwei"),.  
+00029e20: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+00029e30: 2020 2020 290a 0a20 2020 2020 2020 2074      )..        t
+00029e40: 696d 656f 7574 203d 2030 2e30 310a 2020  imeout = 0.01.  
+00029e50: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+00029e60: 742e 7261 6973 6573 2854 696d 6545 7868  t.raises(TimeExh
+00029e70: 6175 7374 6564 2920 6173 2065 7863 5f69  austed) as exc_i
+00029e80: 6e66 6f3a 0a20 2020 2020 2020 2020 2020  nfo:.           
+00029e90: 2077 332e 6574 682e 7761 6974 5f66 6f72   w3.eth.wait_for
+00029ea0: 5f74 7261 6e73 6163 7469 6f6e 5f72 6563  _transaction_rec
+00029eb0: 6569 7074 2874 786e 5f68 6173 682c 2074  eipt(txn_hash, t
+00029ec0: 696d 656f 7574 3d74 696d 656f 7574 290a  imeout=timeout).
+00029ed0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00029ee0: 285f 2069 6e20 7374 7228 6578 635f 696e  (_ in str(exc_in
+00029ef0: 666f 2920 666f 7220 5f20 696e 205b 7265  fo) for _ in [re
+00029f00: 7072 2874 786e 5f68 6173 6829 2c20 7469  pr(txn_hash), ti
+00029f10: 6d65 6f75 745d 290a 0a20 2020 2064 6566  meout])..    def
+00029f20: 2074 6573 745f 6574 685f 7761 6974 5f66   test_eth_wait_f
+00029f30: 6f72 5f74 7261 6e73 6163 7469 6f6e 5f72  or_transaction_r
+00029f40: 6563 6569 7074 5f77 6974 685f 6c6f 675f  eceipt_with_log_
+00029f50: 656e 7472 7928 0a20 2020 2020 2020 2073  entry(.        s
+00029f60: 656c 662c 0a20 2020 2020 2020 2077 333a  elf,.        w3:
+00029f70: 2022 5765 6233 222c 0a20 2020 2020 2020   "Web3",.       
+00029f80: 2062 6c6f 636b 5f77 6974 685f 7478 6e5f   block_with_txn_
+00029f90: 7769 7468 5f6c 6f67 3a20 426c 6f63 6b44  with_log: BlockD
+00029fa0: 6174 612c 0a20 2020 2020 2020 2065 6d69  ata,.        emi
+00029fb0: 7474 6572 5f63 6f6e 7472 6163 743a 2022  tter_contract: "
+00029fc0: 436f 6e74 7261 6374 222c 0a20 2020 2020  Contract",.     
+00029fd0: 2020 2074 786e 5f68 6173 685f 7769 7468     txn_hash_with
+00029fe0: 5f6c 6f67 3a20 4865 7853 7472 2c0a 2020  _log: HexStr,.  
+00029ff0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+0002a000: 2020 2020 2072 6563 6569 7074 203d 2077       receipt = w
+0002a010: 332e 6574 682e 7761 6974 5f66 6f72 5f74  3.eth.wait_for_t
+0002a020: 7261 6e73 6163 7469 6f6e 5f72 6563 6569  ransaction_recei
+0002a030: 7074 2874 786e 5f68 6173 685f 7769 7468  pt(txn_hash_with
+0002a040: 5f6c 6f67 290a 2020 2020 2020 2020 6173  _log).        as
+0002a050: 7365 7274 2069 735f 6469 6374 2872 6563  sert is_dict(rec
+0002a060: 6569 7074 290a 2020 2020 2020 2020 6173  eipt).        as
+0002a070: 7365 7274 2072 6563 6569 7074 5b22 626c  sert receipt["bl
+0002a080: 6f63 6b4e 756d 6265 7222 5d20 3d3d 2062  ockNumber"] == b
+0002a090: 6c6f 636b 5f77 6974 685f 7478 6e5f 7769  lock_with_txn_wi
+0002a0a0: 7468 5f6c 6f67 5b22 6e75 6d62 6572 225d  th_log["number"]
+0002a0b0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0002a0c0: 7265 6365 6970 745b 2262 6c6f 636b 4861  receipt["blockHa
+0002a0d0: 7368 225d 203d 3d20 626c 6f63 6b5f 7769  sh"] == block_wi
+0002a0e0: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
+0002a0f0: 2268 6173 6822 5d0a 2020 2020 2020 2020  "hash"].        
+0002a100: 6173 7365 7274 2072 6563 6569 7074 5b22  assert receipt["
+0002a110: 7472 616e 7361 6374 696f 6e49 6e64 6578  transactionIndex
+0002a120: 225d 203d 3d20 300a 2020 2020 2020 2020  "] == 0.        
+0002a130: 6173 7365 7274 2072 6563 6569 7074 5b22  assert receipt["
+0002a140: 7472 616e 7361 6374 696f 6e48 6173 6822  transactionHash"
+0002a150: 5d20 3d3d 2048 6578 4279 7465 7328 7478  ] == HexBytes(tx
+0002a160: 6e5f 6861 7368 5f77 6974 685f 6c6f 6729  n_hash_with_log)
+0002a170: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+0002a180: 206c 656e 2872 6563 6569 7074 5b22 6c6f   len(receipt["lo
+0002a190: 6773 225d 2920 3d3d 2031 0a20 2020 2020  gs"]) == 1.     
+0002a1a0: 2020 206c 6f67 5f65 6e74 7279 203d 2072     log_entry = r
+0002a1b0: 6563 6569 7074 5b22 6c6f 6773 225d 5b30  eceipt["logs"][0
+0002a1c0: 5d0a 0a20 2020 2020 2020 2061 7373 6572  ]..        asser
+0002a1d0: 7420 6c6f 675f 656e 7472 795b 2262 6c6f  t log_entry["blo
+0002a1e0: 636b 4e75 6d62 6572 225d 203d 3d20 626c  ckNumber"] == bl
+0002a1f0: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
+0002a200: 685f 6c6f 675b 226e 756d 6265 7222 5d0a  h_log["number"].
+0002a210: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+0002a220: 6f67 5f65 6e74 7279 5b22 626c 6f63 6b48  og_entry["blockH
+0002a230: 6173 6822 5d20 3d3d 2062 6c6f 636b 5f77  ash"] == block_w
+0002a240: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
+0002a250: 5b22 6861 7368 225d 0a20 2020 2020 2020  ["hash"].       
+0002a260: 2061 7373 6572 7420 6c6f 675f 656e 7472   assert log_entr
+0002a270: 795b 226c 6f67 496e 6465 7822 5d20 3d3d  y["logIndex"] ==
+0002a280: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
+0002a290: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
+0002a2a0: 7328 6c6f 675f 656e 7472 795b 2261 6464  s(log_entry["add
+0002a2b0: 7265 7373 225d 2c20 656d 6974 7465 725f  ress"], emitter_
+0002a2c0: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
+0002a2d0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0002a2e0: 206c 6f67 5f65 6e74 7279 5b22 7472 616e   log_entry["tran
+0002a2f0: 7361 6374 696f 6e49 6e64 6578 225d 203d  sactionIndex"] =
+0002a300: 3d20 300a 2020 2020 2020 2020 6173 7365  = 0.        asse
+0002a310: 7274 206c 6f67 5f65 6e74 7279 5b22 7472  rt log_entry["tr
+0002a320: 616e 7361 6374 696f 6e48 6173 6822 5d20  ansactionHash"] 
+0002a330: 3d3d 2048 6578 4279 7465 7328 7478 6e5f  == HexBytes(txn_
+0002a340: 6861 7368 5f77 6974 685f 6c6f 6729 0a0a  hash_with_log)..
+0002a350: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+0002a360: 5f67 6574 556e 636c 6542 7942 6c6f 636b  _getUncleByBlock
+0002a370: 4861 7368 416e 6449 6e64 6578 2873 656c  HashAndIndex(sel
+0002a380: 662c 2077 333a 2022 5765 6233 2229 202d  f, w3: "Web3") -
+0002a390: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0002a3a0: 2320 544f 444f 3a20 686f 7720 646f 2077  # TODO: how do w
+0002a3b0: 6520 6d61 6b65 2075 6e63 6c65 732e 2e2e  e make uncles...
+0002a3c0: 2e0a 2020 2020 2020 2020 7061 7373 0a0a  ..        pass..
+0002a3d0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+0002a3e0: 5f67 6574 556e 636c 6542 7942 6c6f 636b  _getUncleByBlock
+0002a3f0: 4e75 6d62 6572 416e 6449 6e64 6578 2873  NumberAndIndex(s
+0002a400: 656c 662c 2077 333a 2022 5765 6233 2229  elf, w3: "Web3")
+0002a410: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0002a420: 2020 2320 544f 444f 3a20 686f 7720 646f    # TODO: how do
+0002a430: 2077 6520 6d61 6b65 2075 6e63 6c65 732e   we make uncles.
+0002a440: 2e2e 2e0a 2020 2020 2020 2020 7061 7373  ....        pass
+0002a450: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+0002a460: 7468 5f6e 6577 5f66 696c 7465 7228 7365  th_new_filter(se
 0002a470: 6c66 2c20 7733 3a20 2257 6562 3322 2920  lf, w3: "Web3") 
 0002a480: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0002a490: 2023 2054 4f44 4f3a 2068 6f77 2064 6f20   # TODO: how do 
-0002a4a0: 7765 206d 616b 6520 756e 636c 6573 2e2e  we make uncles..
-0002a4b0: 2e2e 0a20 2020 2020 2020 2070 6173 730a  ...        pass.
-0002a4c0: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-0002a4d0: 685f 6e65 775f 6669 6c74 6572 2873 656c  h_new_filter(sel
-0002a4e0: 662c 2077 333a 2022 5765 6233 2229 202d  f, w3: "Web3") -
-0002a4f0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-0002a500: 6669 6c74 6572 203d 2077 332e 6574 682e  filter = w3.eth.
-0002a510: 6669 6c74 6572 287b 7d29 0a0a 2020 2020  filter({})..    
-0002a520: 2020 2020 6368 616e 6765 7320 3d20 7733      changes = w3
-0002a530: 2e65 7468 2e67 6574 5f66 696c 7465 725f  .eth.get_filter_
-0002a540: 6368 616e 6765 7328 6669 6c74 6572 2e66  changes(filter.f
-0002a550: 696c 7465 725f 6964 290a 2020 2020 2020  ilter_id).      
-0002a560: 2020 6173 7365 7274 2069 735f 6c69 7374    assert is_list
-0002a570: 5f6c 696b 6528 6368 616e 6765 7329 0a20  _like(changes). 
-0002a580: 2020 2020 2020 2061 7373 6572 7420 6e6f         assert no
-0002a590: 7420 6368 616e 6765 730a 0a20 2020 2020  t changes..     
-0002a5a0: 2020 206c 6f67 7320 3d20 7733 2e65 7468     logs = w3.eth
-0002a5b0: 2e67 6574 5f66 696c 7465 725f 6c6f 6773  .get_filter_logs
-0002a5c0: 2866 696c 7465 722e 6669 6c74 6572 5f69  (filter.filter_i
-0002a5d0: 6429 0a20 2020 2020 2020 2061 7373 6572  d).        asser
-0002a5e0: 7420 6973 5f6c 6973 745f 6c69 6b65 286c  t is_list_like(l
-0002a5f0: 6f67 7329 0a20 2020 2020 2020 2061 7373  ogs).        ass
-0002a600: 6572 7420 6e6f 7420 6c6f 6773 0a0a 2020  ert not logs..  
-0002a610: 2020 2020 2020 7265 7375 6c74 203d 2077        result = w
-0002a620: 332e 6574 682e 756e 696e 7374 616c 6c5f  3.eth.uninstall_
-0002a630: 6669 6c74 6572 2866 696c 7465 722e 6669  filter(filter.fi
-0002a640: 6c74 6572 5f69 6429 0a20 2020 2020 2020  lter_id).       
-0002a650: 2061 7373 6572 7420 7265 7375 6c74 2069   assert result i
-0002a660: 7320 5472 7565 0a0a 2020 2020 6465 6620  s True..    def 
-0002a670: 7465 7374 5f65 7468 5f6e 6577 5f62 6c6f  test_eth_new_blo
-0002a680: 636b 5f66 696c 7465 7228 7365 6c66 2c20  ck_filter(self, 
-0002a690: 7733 3a20 2257 6562 3322 2920 2d3e 204e  w3: "Web3") -> N
-0002a6a0: 6f6e 653a 0a20 2020 2020 2020 2066 696c  one:.        fil
-0002a6b0: 7465 7220 3d20 7733 2e65 7468 2e66 696c  ter = w3.eth.fil
-0002a6c0: 7465 7228 226c 6174 6573 7422 290a 2020  ter("latest").  
-0002a6d0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-0002a6e0: 7374 7269 6e67 2866 696c 7465 722e 6669  string(filter.fi
-0002a6f0: 6c74 6572 5f69 6429 0a0a 2020 2020 2020  lter_id)..      
-0002a700: 2020 6368 616e 6765 7320 3d20 7733 2e65    changes = w3.e
-0002a710: 7468 2e67 6574 5f66 696c 7465 725f 6368  th.get_filter_ch
-0002a720: 616e 6765 7328 6669 6c74 6572 2e66 696c  anges(filter.fil
-0002a730: 7465 725f 6964 290a 2020 2020 2020 2020  ter_id).        
-0002a740: 6173 7365 7274 2069 735f 6c69 7374 5f6c  assert is_list_l
-0002a750: 696b 6528 6368 616e 6765 7329 0a0a 2020  ike(changes)..  
-0002a760: 2020 2020 2020 7265 7375 6c74 203d 2077        result = w
-0002a770: 332e 6574 682e 756e 696e 7374 616c 6c5f  3.eth.uninstall_
-0002a780: 6669 6c74 6572 2866 696c 7465 722e 6669  filter(filter.fi
-0002a790: 6c74 6572 5f69 6429 0a20 2020 2020 2020  lter_id).       
-0002a7a0: 2061 7373 6572 7420 7265 7375 6c74 2069   assert result i
-0002a7b0: 7320 5472 7565 0a0a 2020 2020 6465 6620  s True..    def 
-0002a7c0: 7465 7374 5f65 7468 5f6e 6577 5f70 656e  test_eth_new_pen
-0002a7d0: 6469 6e67 5f74 7261 6e73 6163 7469 6f6e  ding_transaction
-0002a7e0: 5f66 696c 7465 7228 7365 6c66 2c20 7733  _filter(self, w3
-0002a7f0: 3a20 2257 6562 3322 2920 2d3e 204e 6f6e  : "Web3") -> Non
-0002a800: 653a 0a20 2020 2020 2020 2066 696c 7465  e:.        filte
-0002a810: 7220 3d20 7733 2e65 7468 2e66 696c 7465  r = w3.eth.filte
-0002a820: 7228 2270 656e 6469 6e67 2229 0a20 2020  r("pending").   
-0002a830: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
-0002a840: 7472 696e 6728 6669 6c74 6572 2e66 696c  tring(filter.fil
-0002a850: 7465 725f 6964 290a 0a20 2020 2020 2020  ter_id)..       
-0002a860: 2063 6861 6e67 6573 203d 2077 332e 6574   changes = w3.et
-0002a870: 682e 6765 745f 6669 6c74 6572 5f63 6861  h.get_filter_cha
-0002a880: 6e67 6573 2866 696c 7465 722e 6669 6c74  nges(filter.filt
-0002a890: 6572 5f69 6429 0a20 2020 2020 2020 2061  er_id).        a
-0002a8a0: 7373 6572 7420 6973 5f6c 6973 745f 6c69  ssert is_list_li
-0002a8b0: 6b65 2863 6861 6e67 6573 290a 2020 2020  ke(changes).    
-0002a8c0: 2020 2020 6173 7365 7274 206e 6f74 2063      assert not c
-0002a8d0: 6861 6e67 6573 0a0a 2020 2020 2020 2020  hanges..        
-0002a8e0: 7265 7375 6c74 203d 2077 332e 6574 682e  result = w3.eth.
-0002a8f0: 756e 696e 7374 616c 6c5f 6669 6c74 6572  uninstall_filter
-0002a900: 2866 696c 7465 722e 6669 6c74 6572 5f69  (filter.filter_i
-0002a910: 6429 0a20 2020 2020 2020 2061 7373 6572  d).        asser
-0002a920: 7420 7265 7375 6c74 2069 7320 5472 7565  t result is True
-0002a930: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-0002a940: 7468 5f67 6574 5f6c 6f67 735f 7769 7468  th_get_logs_with
-0002a950: 6f75 745f 6c6f 6773 280a 2020 2020 2020  out_logs(.      
-0002a960: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
-0002a970: 3322 2c20 626c 6f63 6b5f 7769 7468 5f74  3", block_with_t
-0002a980: 786e 5f77 6974 685f 6c6f 673a 2042 6c6f  xn_with_log: Blo
-0002a990: 636b 4461 7461 0a20 2020 2029 202d 3e20  ckData.    ) -> 
-0002a9a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2320  None:.        # 
-0002a9b0: 5465 7374 2077 6974 6820 626c 6f63 6b20  Test with block 
-0002a9c0: 7261 6e67 650a 0a20 2020 2020 2020 2066  range..        f
-0002a9d0: 696c 7465 725f 7061 7261 6d73 3a20 4669  ilter_params: Fi
-0002a9e0: 6c74 6572 5061 7261 6d73 203d 207b 0a20  lterParams = {. 
-0002a9f0: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-0002aa00: 426c 6f63 6b22 3a20 426c 6f63 6b4e 756d  Block": BlockNum
-0002aa10: 6265 7228 3029 2c0a 2020 2020 2020 2020  ber(0),.        
-0002aa20: 2020 2020 2274 6f42 6c6f 636b 223a 2042      "toBlock": B
-0002aa30: 6c6f 636b 4e75 6d62 6572 2862 6c6f 636b  lockNumber(block
-0002aa40: 5f77 6974 685f 7478 6e5f 7769 7468 5f6c  _with_txn_with_l
-0002aa50: 6f67 5b22 6e75 6d62 6572 225d 202d 2031  og["number"] - 1
-0002aa60: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
-0002aa70: 2020 2020 2072 6573 756c 7420 3d20 7733       result = w3
-0002aa80: 2e65 7468 2e67 6574 5f6c 6f67 7328 6669  .eth.get_logs(fi
-0002aa90: 6c74 6572 5f70 6172 616d 7329 0a20 2020  lter_params).   
-0002aaa0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-0002aab0: 7265 7375 6c74 2920 3d3d 2030 0a0a 2020  result) == 0..  
-0002aac0: 2020 2020 2020 2320 7468 6520 7261 6e67        # the rang
-0002aad0: 6520 6973 2077 726f 6e67 0a20 2020 2020  e is wrong.     
-0002aae0: 2020 2066 696c 7465 725f 7061 7261 6d73     filter_params
-0002aaf0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0002ab00: 2022 6672 6f6d 426c 6f63 6b22 3a20 626c   "fromBlock": bl
-0002ab10: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
-0002ab20: 685f 6c6f 675b 226e 756d 6265 7222 5d2c  h_log["number"],
-0002ab30: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
-0002ab40: 426c 6f63 6b22 3a20 426c 6f63 6b4e 756d  Block": BlockNum
-0002ab50: 6265 7228 626c 6f63 6b5f 7769 7468 5f74  ber(block_with_t
-0002ab60: 786e 5f77 6974 685f 6c6f 675b 226e 756d  xn_with_log["num
-0002ab70: 6265 7222 5d20 2d20 3129 2c0a 2020 2020  ber"] - 1),.    
-0002ab80: 2020 2020 7d0a 2020 2020 2020 2020 7769      }.        wi
-0002ab90: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-0002aba0: 2856 616c 7565 4572 726f 7229 3a0a 2020  (ValueError):.  
-0002abb0: 2020 2020 2020 2020 2020 7733 2e65 7468            w3.eth
-0002abc0: 2e67 6574 5f6c 6f67 7328 6669 6c74 6572  .get_logs(filter
-0002abd0: 5f70 6172 616d 7329 0a0a 2020 2020 2020  _params)..      
-0002abe0: 2020 2320 5465 7374 2077 6974 6820 6061    # Test with `a
-0002abf0: 6464 7265 7373 600a 0a20 2020 2020 2020  ddress`..       
-0002ac00: 2023 2066 696c 7465 7220 7769 7468 206f   # filter with o
-0002ac10: 7468 6572 2061 6464 7265 7373 0a20 2020  ther address.   
-0002ac20: 2020 2020 2066 696c 7465 725f 7061 7261       filter_para
-0002ac30: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-0002ac40: 2020 2022 6672 6f6d 426c 6f63 6b22 3a20     "fromBlock": 
-0002ac50: 426c 6f63 6b4e 756d 6265 7228 3029 2c0a  BlockNumber(0),.
-0002ac60: 2020 2020 2020 2020 2020 2020 2261 6464              "add
-0002ac70: 7265 7373 223a 2055 4e4b 4e4f 574e 5f41  ress": UNKNOWN_A
-0002ac80: 4444 5245 5353 2c0a 2020 2020 2020 2020  DDRESS,.        
-0002ac90: 7d0a 2020 2020 2020 2020 7265 7375 6c74  }.        result
-0002aca0: 203d 2077 332e 6574 682e 6765 745f 6c6f   = w3.eth.get_lo
-0002acb0: 6773 2866 696c 7465 725f 7061 7261 6d73  gs(filter_params
-0002acc0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-0002acd0: 206c 656e 2872 6573 756c 7429 203d 3d20   len(result) == 
-0002ace0: 300a 0a20 2020 2020 2020 2023 2054 6573  0..        # Tes
-0002acf0: 7420 7769 7468 206d 756c 7469 706c 6520  t with multiple 
-0002ad00: 6061 6464 7265 7373 600a 0a20 2020 2020  `address`..     
-0002ad10: 2020 2023 2066 696c 7465 7220 7769 7468     # filter with
-0002ad20: 206f 7468 6572 2061 6464 7265 7373 0a20   other address. 
-0002ad30: 2020 2020 2020 2066 696c 7465 725f 7061         filter_pa
-0002ad40: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-0002ad50: 2020 2020 2022 6672 6f6d 426c 6f63 6b22       "fromBlock"
-0002ad60: 3a20 426c 6f63 6b4e 756d 6265 7228 3029  : BlockNumber(0)
-0002ad70: 2c0a 2020 2020 2020 2020 2020 2020 2261  ,.            "a
-0002ad80: 6464 7265 7373 223a 205b 554e 4b4e 4f57  ddress": [UNKNOW
-0002ad90: 4e5f 4144 4452 4553 532c 2055 4e4b 4e4f  N_ADDRESS, UNKNO
-0002ada0: 574e 5f41 4444 5245 5353 5d2c 0a20 2020  WN_ADDRESS],.   
-0002adb0: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
-0002adc0: 6573 756c 7420 3d20 7733 2e65 7468 2e67  esult = w3.eth.g
-0002add0: 6574 5f6c 6f67 7328 6669 6c74 6572 5f70  et_logs(filter_p
-0002ade0: 6172 616d 7329 0a20 2020 2020 2020 2061  arams).        a
-0002adf0: 7373 6572 7420 6c65 6e28 7265 7375 6c74  ssert len(result
-0002ae00: 2920 3d3d 2030 0a0a 2020 2020 6465 6620  ) == 0..    def 
-0002ae10: 7465 7374 5f65 7468 5f67 6574 5f6c 6f67  test_eth_get_log
-0002ae20: 735f 7769 7468 5f6c 6f67 7328 0a20 2020  s_with_logs(.   
-0002ae30: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0002ae40: 2020 2077 333a 2022 5765 6233 222c 0a20     w3: "Web3",. 
-0002ae50: 2020 2020 2020 2062 6c6f 636b 5f77 6974         block_wit
-0002ae60: 685f 7478 6e5f 7769 7468 5f6c 6f67 3a20  h_txn_with_log: 
-0002ae70: 426c 6f63 6b44 6174 612c 0a20 2020 2020  BlockData,.     
-0002ae80: 2020 2065 6d69 7474 6572 5f63 6f6e 7472     emitter_contr
-0002ae90: 6163 745f 6164 6472 6573 733a 2043 6865  act_address: Che
-0002aea0: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
-0002aeb0: 2020 2020 2020 7478 6e5f 6861 7368 5f77        txn_hash_w
-0002aec0: 6974 685f 6c6f 673a 2048 6578 5374 722c  ith_log: HexStr,
-0002aed0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0002aee0: 2020 2020 2020 2020 2320 5465 7374 2077          # Test w
-0002aef0: 6974 6820 626c 6f63 6b20 7261 6e67 650a  ith block range.
-0002af00: 0a20 2020 2020 2020 2023 2074 6865 2072  .        # the r
-0002af10: 616e 6765 2069 6e63 6c75 6465 7320 7468  ange includes th
-0002af20: 6520 626c 6f63 6b20 7768 6572 6520 7468  e block where th
-0002af30: 6520 6c6f 6720 7265 7369 6465 7320 696e  e log resides in
-0002af40: 0a20 2020 2020 2020 2066 696c 7465 725f  .        filter_
-0002af50: 7061 7261 6d73 3a20 4669 6c74 6572 5061  params: FilterPa
-0002af60: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-0002af70: 2020 2020 2022 6672 6f6d 426c 6f63 6b22       "fromBlock"
-0002af80: 3a20 626c 6f63 6b5f 7769 7468 5f74 786e  : block_with_txn
-0002af90: 5f77 6974 685f 6c6f 675b 226e 756d 6265  _with_log["numbe
-0002afa0: 7222 5d2c 0a20 2020 2020 2020 2020 2020  r"],.           
-0002afb0: 2022 746f 426c 6f63 6b22 3a20 626c 6f63   "toBlock": bloc
-0002afc0: 6b5f 7769 7468 5f74 786e 5f77 6974 685f  k_with_txn_with_
-0002afd0: 6c6f 675b 226e 756d 6265 7222 5d2c 0a20  log["number"],. 
-0002afe0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-0002aff0: 2072 6573 756c 7420 3d20 7733 2e65 7468   result = w3.eth
-0002b000: 2e67 6574 5f6c 6f67 7328 6669 6c74 6572  .get_logs(filter
-0002b010: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
-0002b020: 2061 7373 6572 745f 636f 6e74 6169 6e73   assert_contains
-0002b030: 5f6c 6f67 280a 2020 2020 2020 2020 2020  _log(.          
-0002b040: 2020 7265 7375 6c74 2c20 626c 6f63 6b5f    result, block_
-0002b050: 7769 7468 5f74 786e 5f77 6974 685f 6c6f  with_txn_with_lo
-0002b060: 672c 2065 6d69 7474 6572 5f63 6f6e 7472  g, emitter_contr
-0002b070: 6163 745f 6164 6472 6573 732c 2074 786e  act_address, txn
-0002b080: 5f68 6173 685f 7769 7468 5f6c 6f67 0a20  _hash_with_log. 
-0002b090: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0002b0a0: 2020 2320 7370 6563 6966 7920 6f6e 6c79    # specify only
-0002b0b0: 2060 6672 6f6d 5f62 6c6f 636b 602e 2062   `from_block`. b
-0002b0c0: 7920 6465 6661 756c 7420 6074 6f5f 626c  y default `to_bl
-0002b0d0: 6f63 6b60 2073 686f 756c 6420 6265 2027  ock` should be '
-0002b0e0: 6c61 7465 7374 270a 2020 2020 2020 2020  latest'.        
-0002b0f0: 6669 6c74 6572 5f70 6172 616d 7320 3d20  filter_params = 
-0002b100: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
-0002b110: 726f 6d42 6c6f 636b 223a 2042 6c6f 636b  romBlock": Block
-0002b120: 4e75 6d62 6572 2830 292c 0a20 2020 2020  Number(0),.     
-0002b130: 2020 207d 0a20 2020 2020 2020 2072 6573     }.        res
-0002b140: 756c 7420 3d20 7733 2e65 7468 2e67 6574  ult = w3.eth.get
-0002b150: 5f6c 6f67 7328 6669 6c74 6572 5f70 6172  _logs(filter_par
-0002b160: 616d 7329 0a20 2020 2020 2020 2061 7373  ams).        ass
-0002b170: 6572 745f 636f 6e74 6169 6e73 5f6c 6f67  ert_contains_log
-0002b180: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
-0002b190: 7375 6c74 2c20 626c 6f63 6b5f 7769 7468  sult, block_with
-0002b1a0: 5f74 786e 5f77 6974 685f 6c6f 672c 2065  _txn_with_log, e
-0002b1b0: 6d69 7474 6572 5f63 6f6e 7472 6163 745f  mitter_contract_
-0002b1c0: 6164 6472 6573 732c 2074 786e 5f68 6173  address, txn_has
-0002b1d0: 685f 7769 7468 5f6c 6f67 0a20 2020 2020  h_with_log.     
-0002b1e0: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-0002b1f0: 5465 7374 2077 6974 6820 6061 6464 7265  Test with `addre
-0002b200: 7373 600a 0a20 2020 2020 2020 2023 2066  ss`..        # f
-0002b210: 696c 7465 7220 7769 7468 2065 6d69 7474  ilter with emitt
-0002b220: 6572 5f63 6f6e 7472 6163 742e 6164 6472  er_contract.addr
-0002b230: 6573 730a 2020 2020 2020 2020 6669 6c74  ess.        filt
-0002b240: 6572 5f70 6172 616d 7320 3d20 7b0a 2020  er_params = {.  
-0002b250: 2020 2020 2020 2020 2020 2266 726f 6d42            "fromB
-0002b260: 6c6f 636b 223a 2042 6c6f 636b 4e75 6d62  lock": BlockNumb
-0002b270: 6572 2830 292c 0a20 2020 2020 2020 2020  er(0),.         
-0002b280: 2020 2022 6164 6472 6573 7322 3a20 656d     "address": em
-0002b290: 6974 7465 725f 636f 6e74 7261 6374 5f61  itter_contract_a
-0002b2a0: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
-0002b2b0: 7d0a 0a20 2020 2064 6566 2074 6573 745f  }..    def test_
-0002b2c0: 6574 685f 6765 745f 6c6f 6773 5f77 6974  eth_get_logs_wit
-0002b2d0: 685f 6c6f 6773 5f74 6f70 6963 5f61 7267  h_logs_topic_arg
-0002b2e0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-0002b2f0: 0a20 2020 2020 2020 2077 333a 2022 5765  .        w3: "We
-0002b300: 6233 222c 0a20 2020 2020 2020 2062 6c6f  b3",.        blo
-0002b310: 636b 5f77 6974 685f 7478 6e5f 7769 7468  ck_with_txn_with
-0002b320: 5f6c 6f67 3a20 426c 6f63 6b44 6174 612c  _log: BlockData,
-0002b330: 0a20 2020 2020 2020 2065 6d69 7474 6572  .        emitter
-0002b340: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
-0002b350: 733a 2043 6865 636b 7375 6d41 6464 7265  s: ChecksumAddre
-0002b360: 7373 2c0a 2020 2020 2020 2020 7478 6e5f  ss,.        txn_
-0002b370: 6861 7368 5f77 6974 685f 6c6f 673a 2048  hash_with_log: H
-0002b380: 6578 5374 722c 0a20 2020 2029 202d 3e20  exStr,.    ) -> 
-0002b390: 4e6f 6e65 3a0a 2020 2020 2020 2020 2320  None:.        # 
-0002b3a0: 5465 7374 2077 6974 6820 4e6f 6e65 2065  Test with None e
-0002b3b0: 7665 6e74 2073 6967 0a0a 2020 2020 2020  vent sig..      
-0002b3c0: 2020 6669 6c74 6572 5f70 6172 616d 733a    filter_params:
-0002b3d0: 2046 696c 7465 7250 6172 616d 7320 3d20   FilterParams = 
-0002b3e0: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
-0002b3f0: 726f 6d42 6c6f 636b 223a 2042 6c6f 636b  romBlock": Block
-0002b400: 4e75 6d62 6572 2830 292c 0a20 2020 2020  Number(0),.     
-0002b410: 2020 2020 2020 2022 746f 7069 6373 223a         "topics":
-0002b420: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-0002b430: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-0002b440: 2020 2020 2020 2020 2048 6578 5374 7228           HexStr(
-0002b450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b460: 2020 2020 2022 3078 3030 3030 3030 3030       "0x00000000
-0002b470: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-0002b480: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-0002b490: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-0002b4a0: 3030 3030 6434 3331 220a 2020 2020 2020  0000d431".      
-0002b4b0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-0002b4c0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-0002b4d0: 2020 2020 7d0a 0a20 2020 2020 2020 2072      }..        r
-0002b4e0: 6573 756c 7420 3d20 7733 2e65 7468 2e67  esult = w3.eth.g
-0002b4f0: 6574 5f6c 6f67 7328 6669 6c74 6572 5f70  et_logs(filter_p
-0002b500: 6172 616d 7329 0a20 2020 2020 2020 2061  arams).        a
-0002b510: 7373 6572 745f 636f 6e74 6169 6e73 5f6c  ssert_contains_l
-0002b520: 6f67 280a 2020 2020 2020 2020 2020 2020  og(.            
-0002b530: 7265 7375 6c74 2c20 626c 6f63 6b5f 7769  result, block_wi
-0002b540: 7468 5f74 786e 5f77 6974 685f 6c6f 672c  th_txn_with_log,
-0002b550: 2065 6d69 7474 6572 5f63 6f6e 7472 6163   emitter_contrac
-0002b560: 745f 6164 6472 6573 732c 2074 786e 5f68  t_address, txn_h
-0002b570: 6173 685f 7769 7468 5f6c 6f67 0a20 2020  ash_with_log.   
-0002b580: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0002b590: 2320 5465 7374 2077 6974 6820 4e6f 6e65  # Test with None
-0002b5a0: 2069 6e64 6578 6564 2061 7267 0a20 2020   indexed arg.   
-0002b5b0: 2020 2020 2066 696c 7465 725f 7061 7261       filter_para
-0002b5c0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-0002b5d0: 2020 2022 6672 6f6d 426c 6f63 6b22 3a20     "fromBlock": 
-0002b5e0: 426c 6f63 6b4e 756d 6265 7228 3029 2c0a  BlockNumber(0),.
-0002b5f0: 2020 2020 2020 2020 2020 2020 2274 6f70              "top
-0002b600: 6963 7322 3a20 5b0a 2020 2020 2020 2020  ics": [.        
-0002b610: 2020 2020 2020 2020 4865 7853 7472 280a          HexStr(.
-0002b620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b630: 2020 2020 2230 7830 3537 6263 3332 3832      "0x057bc3282
-0002b640: 3666 6265 3136 3164 6131 6331 3130 6166  6fbe161da1c110af
-0002b650: 6364 6361 6537 6331 3039 6138 6236 3931  cdcae7c109a8b691
-0002b660: 3439 6637 3237 6663 3337 6136 3033 6336  49f727fc37a603c6
-0002b670: 3065 6639 3463 6122 0a20 2020 2020 2020  0ef94ca".       
-0002b680: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-0002b690: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-0002b6a0: 2c0a 2020 2020 2020 2020 2020 2020 5d2c  ,.            ],
-0002b6b0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-0002b6c0: 2020 2072 6573 756c 7420 3d20 7733 2e65     result = w3.e
-0002b6d0: 7468 2e67 6574 5f6c 6f67 7328 6669 6c74  th.get_logs(filt
-0002b6e0: 6572 5f70 6172 616d 7329 0a20 2020 2020  er_params).     
-0002b6f0: 2020 2061 7373 6572 745f 636f 6e74 6169     assert_contai
-0002b700: 6e73 5f6c 6f67 280a 2020 2020 2020 2020  ns_log(.        
-0002b710: 2020 2020 7265 7375 6c74 2c20 626c 6f63      result, bloc
-0002b720: 6b5f 7769 7468 5f74 786e 5f77 6974 685f  k_with_txn_with_
-0002b730: 6c6f 672c 2065 6d69 7474 6572 5f63 6f6e  log, emitter_con
-0002b740: 7472 6163 745f 6164 6472 6573 732c 2074  tract_address, t
-0002b750: 786e 5f68 6173 685f 7769 7468 5f6c 6f67  xn_hash_with_log
-0002b760: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0002b770: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-0002b780: 5f6c 6f67 735f 7769 7468 5f6c 6f67 735f  _logs_with_logs_
-0002b790: 6e6f 6e65 5f74 6f70 6963 5f61 7267 7328  none_topic_args(
-0002b7a0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-0002b7b0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0002b7c0: 2020 2023 2054 6573 7420 7769 7468 204e     # Test with N
-0002b7d0: 6f6e 6520 6f76 6572 666c 6f77 696e 670a  one overflowing.
-0002b7e0: 2020 2020 2020 2020 6669 6c74 6572 5f70          filter_p
-0002b7f0: 6172 616d 733a 2046 696c 7465 7250 6172  arams: FilterPar
-0002b800: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-0002b810: 2020 2020 2266 726f 6d42 6c6f 636b 223a      "fromBlock":
-0002b820: 2042 6c6f 636b 4e75 6d62 6572 2830 292c   BlockNumber(0),
-0002b830: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
-0002b840: 7069 6373 223a 205b 4e6f 6e65 2c20 4e6f  pics": [None, No
-0002b850: 6e65 2c20 4e6f 6e65 5d2c 0a20 2020 2020  ne, None],.     
-0002b860: 2020 207d 0a0a 2020 2020 2020 2020 7265     }..        re
-0002b870: 7375 6c74 203d 2077 332e 6574 682e 6765  sult = w3.eth.ge
-0002b880: 745f 6c6f 6773 2866 696c 7465 725f 7061  t_logs(filter_pa
-0002b890: 7261 6d73 290a 2020 2020 2020 2020 6173  rams).        as
-0002b8a0: 7365 7274 206c 656e 2872 6573 756c 7429  sert len(result)
-0002b8b0: 203d 3d20 300a 0a20 2020 2064 6566 2074   == 0..    def t
-0002b8c0: 6573 745f 6574 685f 6361 6c6c 5f6f 6c64  est_eth_call_old
-0002b8d0: 5f63 6f6e 7472 6163 745f 7374 6174 6528  _contract_state(
-0002b8e0: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-0002b8f0: 333a 2022 5765 6233 222c 206d 6174 685f  3: "Web3", math_
-0002b900: 636f 6e74 7261 6374 3a20 2243 6f6e 7472  contract: "Contr
-0002b910: 6163 7422 2c20 756e 6c6f 636b 6564 5f61  act", unlocked_a
-0002b920: 6363 6f75 6e74 3a20 4368 6563 6b73 756d  ccount: Checksum
-0002b930: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-0002b940: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
-0002b950: 7461 7274 5f62 6c6f 636b 203d 2077 332e  tart_block = w3.
-0002b960: 6574 682e 6765 745f 626c 6f63 6b28 226c  eth.get_block("l
-0002b970: 6174 6573 7422 290a 2020 2020 2020 2020  atest").        
-0002b980: 626c 6f63 6b5f 6e75 6d20 3d20 7374 6172  block_num = star
-0002b990: 745f 626c 6f63 6b5b 226e 756d 6265 7222  t_block["number"
-0002b9a0: 5d0a 2020 2020 2020 2020 626c 6f63 6b5f  ].        block_
-0002b9b0: 6861 7368 203d 2073 7461 7274 5f62 6c6f  hash = start_blo
-0002b9c0: 636b 5b22 6861 7368 225d 0a0a 2020 2020  ck["hash"]..    
-0002b9d0: 2020 2020 6d61 7468 5f63 6f6e 7472 6163      math_contrac
-0002b9e0: 742e 6675 6e63 7469 6f6e 732e 696e 6372  t.functions.incr
-0002b9f0: 656d 656e 7443 6f75 6e74 6572 2829 2e74  ementCounter().t
-0002ba00: 7261 6e73 6163 7428 7b22 6672 6f6d 223a  ransact({"from":
-0002ba10: 2075 6e6c 6f63 6b65 645f 6163 636f 756e   unlocked_accoun
-0002ba20: 747d 290a 0a20 2020 2020 2020 2023 2054  t})..        # T
-0002ba30: 6869 7320 6973 6e27 7420 616e 2069 6e63  his isn't an inc
-0002ba40: 7265 6469 626c 7920 636f 6e76 696e 6369  redibly convinci
-0002ba50: 6e67 2074 6573 7420 7369 6e63 6520 7765  ng test since we
-0002ba60: 2063 616e 2774 206d 696e 652c 2061 6e64   can't mine, and
-0002ba70: 0a20 2020 2020 2020 2023 2074 6865 2064  .        # the d
-0002ba80: 6566 6175 6c74 2072 6573 6f6c 7665 6420  efault resolved 
-0002ba90: 626c 6f63 6b20 6973 206c 6174 6573 742c  block is latest,
-0002baa0: 2053 6f20 6966 2062 6c6f 636b 5f69 6465   So if block_ide
-0002bab0: 6e74 6966 6965 7220 7761 7320 6967 6e6f  ntifier was igno
-0002bac0: 7265 640a 2020 2020 2020 2020 2320 7765  red.        # we
-0002bad0: 2077 6f75 6c64 2067 6574 2074 6865 2073   would get the s
-0002bae0: 616d 6520 7265 7375 6c74 2e20 466f 7220  ame result. For 
-0002baf0: 6e6f 772c 2077 6520 6d6f 7374 6c79 2064  now, we mostly d
-0002bb00: 6570 656e 6420 6f6e 2063 6f72 6520 7465  epend on core te
-0002bb10: 7374 732e 0a20 2020 2020 2020 2023 2049  sts..        # I
-0002bb20: 6465 6173 2074 6f20 696d 7072 6f76 6520  deas to improve 
-0002bb30: 7468 6973 2074 6573 743a 0a20 2020 2020  this test:.     
-0002bb40: 2020 2023 2020 2d20 456e 6162 6c65 206f     #  - Enable o
-0002bb50: 6e2d 6465 6d61 6e64 206d 696e 696e 6720  n-demand mining 
-0002bb60: 696e 206d 6f72 6520 636c 6965 6e74 730a  in more clients.
-0002bb70: 2020 2020 2020 2020 2320 202d 2049 6e63          #  - Inc
-0002bb80: 7265 6d65 6e74 2074 6865 206d 6174 6820  rement the math 
-0002bb90: 636f 6e74 7261 6374 2069 6e20 616c 6c20  contract in all 
-0002bba0: 6f66 2074 6865 2066 6978 7475 7265 732c  of the fixtures,
-0002bbb0: 2061 6e64 2063 6865 636b 2074 6865 0a20   and check the. 
-0002bbc0: 2020 2020 2020 2023 2020 2020 7661 6c75         #    valu
-0002bbd0: 6520 696e 2061 6e20 6f6c 6420 626c 6f63  e in an old bloc
-0002bbe0: 6b0a 2020 2020 2020 2020 626c 6f63 6b5f  k.        block_
-0002bbf0: 6861 7368 5f63 616c 6c5f 7265 7375 6c74  hash_call_result
-0002bc00: 203d 206d 6174 685f 636f 6e74 7261 6374   = math_contract
-0002bc10: 2e66 756e 6374 696f 6e73 2e63 6f75 6e74  .functions.count
-0002bc20: 6572 2829 2e63 616c 6c28 0a20 2020 2020  er().call(.     
-0002bc30: 2020 2020 2020 2062 6c6f 636b 5f69 6465         block_ide
-0002bc40: 6e74 6966 6965 723d 626c 6f63 6b5f 6861  ntifier=block_ha
-0002bc50: 7368 0a20 2020 2020 2020 2029 0a20 2020  sh.        ).   
-0002bc60: 2020 2020 2062 6c6f 636b 5f6e 756d 5f63       block_num_c
-0002bc70: 616c 6c5f 7265 7375 6c74 203d 206d 6174  all_result = mat
-0002bc80: 685f 636f 6e74 7261 6374 2e66 756e 6374  h_contract.funct
-0002bc90: 696f 6e73 2e63 6f75 6e74 6572 2829 2e63  ions.counter().c
-0002bca0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-0002bcb0: 2062 6c6f 636b 5f69 6465 6e74 6966 6965   block_identifie
-0002bcc0: 723d 626c 6f63 6b5f 6e75 6d0a 2020 2020  r=block_num.    
-0002bcd0: 2020 2020 290a 2020 2020 2020 2020 6c61      ).        la
-0002bce0: 7465 7374 5f63 616c 6c5f 7265 7375 6c74  test_call_result
-0002bcf0: 203d 206d 6174 685f 636f 6e74 7261 6374   = math_contract
-0002bd00: 2e66 756e 6374 696f 6e73 2e63 6f75 6e74  .functions.count
-0002bd10: 6572 2829 2e63 616c 6c28 0a20 2020 2020  er().call(.     
-0002bd20: 2020 2020 2020 2062 6c6f 636b 5f69 6465         block_ide
-0002bd30: 6e74 6966 6965 723d 226c 6174 6573 7422  ntifier="latest"
-0002bd40: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0002bd50: 2020 2064 6566 6175 6c74 5f63 616c 6c5f     default_call_
-0002bd60: 7265 7375 6c74 203d 206d 6174 685f 636f  result = math_co
-0002bd70: 6e74 7261 6374 2e66 756e 6374 696f 6e73  ntract.functions
-0002bd80: 2e63 6f75 6e74 6572 2829 2e63 616c 6c28  .counter().call(
-0002bd90: 290a 2020 2020 2020 2020 7065 6e64 696e  ).        pendin
-0002bda0: 675f 6361 6c6c 5f72 6573 756c 7420 3d20  g_call_result = 
-0002bdb0: 6d61 7468 5f63 6f6e 7472 6163 742e 6675  math_contract.fu
-0002bdc0: 6e63 7469 6f6e 732e 636f 756e 7465 7228  nctions.counter(
-0002bdd0: 292e 6361 6c6c 280a 2020 2020 2020 2020  ).call(.        
-0002bde0: 2020 2020 626c 6f63 6b5f 6964 656e 7469      block_identi
-0002bdf0: 6669 6572 3d22 7065 6e64 696e 6722 0a20  fier="pending". 
-0002be00: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0002be10: 2020 6173 7365 7274 2062 6c6f 636b 5f68    assert block_h
-0002be20: 6173 685f 6361 6c6c 5f72 6573 756c 7420  ash_call_result 
-0002be30: 3d3d 2030 0a20 2020 2020 2020 2061 7373  == 0.        ass
-0002be40: 6572 7420 626c 6f63 6b5f 6e75 6d5f 6361  ert block_num_ca
-0002be50: 6c6c 5f72 6573 756c 7420 3d3d 2030 0a20  ll_result == 0. 
-0002be60: 2020 2020 2020 2061 7373 6572 7420 6c61         assert la
-0002be70: 7465 7374 5f63 616c 6c5f 7265 7375 6c74  test_call_result
-0002be80: 203d 3d20 300a 2020 2020 2020 2020 6173   == 0.        as
-0002be90: 7365 7274 2064 6566 6175 6c74 5f63 616c  sert default_cal
-0002bea0: 6c5f 7265 7375 6c74 203d 3d20 300a 0a20  l_result == 0.. 
-0002beb0: 2020 2020 2020 2069 6620 7065 6e64 696e         if pendin
-0002bec0: 675f 6361 6c6c 5f72 6573 756c 7420 213d  g_call_result !=
-0002bed0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-0002bee0: 7261 6973 6520 4173 7365 7274 696f 6e45  raise AssertionE
-0002bef0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0002bf00: 2020 2020 2020 6622 7065 6e64 696e 6720        f"pending 
-0002bf10: 6361 6c6c 2072 6573 756c 7420 7761 7320  call result was 
-0002bf20: 7b70 656e 6469 6e67 5f63 616c 6c5f 7265  {pending_call_re
-0002bf30: 7375 6c74 7d20 696e 7374 6561 6420 6f66  sult} instead of
-0002bf40: 2031 220a 2020 2020 2020 2020 2020 2020   1".            
-0002bf50: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-0002bf60: 6574 685f 756e 696e 7374 616c 6c5f 6669  eth_uninstall_fi
-0002bf70: 6c74 6572 2873 656c 662c 2077 333a 2022  lter(self, w3: "
-0002bf80: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
-0002bf90: 2020 2020 2020 2020 6669 6c74 6572 203d          filter =
-0002bfa0: 2077 332e 6574 682e 6669 6c74 6572 287b   w3.eth.filter({
-0002bfb0: 7d29 0a20 2020 2020 2020 2061 7373 6572  }).        asser
-0002bfc0: 7420 6973 5f73 7472 696e 6728 6669 6c74  t is_string(filt
-0002bfd0: 6572 2e66 696c 7465 725f 6964 290a 0a20  er.filter_id).. 
-0002bfe0: 2020 2020 2020 2073 7563 6365 7373 203d         success =
-0002bff0: 2077 332e 6574 682e 756e 696e 7374 616c   w3.eth.uninstal
-0002c000: 6c5f 6669 6c74 6572 2866 696c 7465 722e  l_filter(filter.
-0002c010: 6669 6c74 6572 5f69 6429 0a20 2020 2020  filter_id).     
-0002c020: 2020 2061 7373 6572 7420 7375 6363 6573     assert succes
-0002c030: 7320 6973 2054 7275 650a 0a20 2020 2020  s is True..     
-0002c040: 2020 2066 6169 6c75 7265 203d 2077 332e     failure = w3.
-0002c050: 6574 682e 756e 696e 7374 616c 6c5f 6669  eth.uninstall_fi
-0002c060: 6c74 6572 2866 696c 7465 722e 6669 6c74  lter(filter.filt
-0002c070: 6572 5f69 6429 0a20 2020 2020 2020 2061  er_id).        a
-0002c080: 7373 6572 7420 6661 696c 7572 6520 6973  ssert failure is
-0002c090: 2046 616c 7365 0a0a 2020 2020 6465 6620   False..    def 
-0002c0a0: 7465 7374 5f65 7468 5f67 6574 5f72 6177  test_eth_get_raw
-0002c0b0: 5f74 7261 6e73 6163 7469 6f6e 2873 656c  _transaction(sel
-0002c0c0: 662c 2077 333a 2022 5765 6233 222c 206d  f, w3: "Web3", m
-0002c0d0: 696e 6564 5f74 786e 5f68 6173 683a 2048  ined_txn_hash: H
-0002c0e0: 6578 5374 7229 202d 3e20 4e6f 6e65 3a0a  exStr) -> None:.
-0002c0f0: 2020 2020 2020 2020 7261 775f 7472 616e          raw_tran
-0002c100: 7361 6374 696f 6e20 3d20 7733 2e65 7468  saction = w3.eth
-0002c110: 2e67 6574 5f72 6177 5f74 7261 6e73 6163  .get_raw_transac
-0002c120: 7469 6f6e 286d 696e 6564 5f74 786e 5f68  tion(mined_txn_h
-0002c130: 6173 6829 0a20 2020 2020 2020 2061 7373  ash).        ass
-0002c140: 6572 7420 6973 5f62 7974 6573 2872 6177  ert is_bytes(raw
-0002c150: 5f74 7261 6e73 6163 7469 6f6e 290a 0a20  _transaction).. 
-0002c160: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-0002c170: 6765 745f 7261 775f 7472 616e 7361 6374  get_raw_transact
-0002c180: 696f 6e5f 7261 6973 6573 5f65 7272 6f72  ion_raises_error
-0002c190: 2873 656c 662c 2077 333a 2022 5765 6233  (self, w3: "Web3
-0002c1a0: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
-0002c1b0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-0002c1c0: 7261 6973 6573 280a 2020 2020 2020 2020  raises(.        
-0002c1d0: 2020 2020 5472 616e 7361 6374 696f 6e4e      TransactionN
-0002c1e0: 6f74 466f 756e 642c 206d 6174 6368 3d66  otFound, match=f
-0002c1f0: 2254 7261 6e73 6163 7469 6f6e 2077 6974  "Transaction wit
-0002c200: 6820 6861 7368 3a20 277b 554e 4b4e 4f57  h hash: '{UNKNOW
-0002c210: 4e5f 4841 5348 7d27 220a 2020 2020 2020  N_HASH}'".      
-0002c220: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-0002c230: 2077 332e 6574 682e 6765 745f 7261 775f   w3.eth.get_raw_
-0002c240: 7472 616e 7361 6374 696f 6e28 554e 4b4e  transaction(UNKN
-0002c250: 4f57 4e5f 4841 5348 290a 0a20 2020 2064  OWN_HASH)..    d
-0002c260: 6566 2074 6573 745f 6574 685f 6765 745f  ef test_eth_get_
-0002c270: 7261 775f 7472 616e 7361 6374 696f 6e5f  raw_transaction_
-0002c280: 6279 5f62 6c6f 636b 280a 2020 2020 2020  by_block(.      
-0002c290: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0002c2a0: 7733 3a20 2257 6562 3322 2c0a 2020 2020  w3: "Web3",.    
-0002c2b0: 2020 2020 756e 6c6f 636b 6564 5f61 6363      unlocked_acc
-0002c2c0: 6f75 6e74 5f64 7561 6c5f 7479 7065 3a20  ount_dual_type: 
-0002c2d0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-0002c2e0: 0a20 2020 2020 2020 2062 6c6f 636b 5f77  .        block_w
-0002c2f0: 6974 685f 7478 6e3a 2042 6c6f 636b 4461  ith_txn: BlockDa
-0002c300: 7461 2c0a 2020 2020 2920 2d3e 204e 6f6e  ta,.    ) -> Non
-0002c310: 653a 0a20 2020 2020 2020 2023 2065 7468  e:.        # eth
-0002c320: 5f67 6574 5261 7754 7261 6e73 6163 7469  _getRawTransacti
-0002c330: 6f6e 4279 426c 6f63 6b4e 756d 6265 7241  onByBlockNumberA
-0002c340: 6e64 496e 6465 783a 2062 6c6f 636b 2069  ndIndex: block i
-0002c350: 6465 6e74 6966 6965 720a 2020 2020 2020  dentifier.      
-0002c360: 2020 2320 7365 6e64 2061 2074 786e 2074    # send a txn t
-0002c370: 6f20 6d61 6b65 2073 7572 6520 7065 6e64  o make sure pend
-0002c380: 696e 6720 626c 6f63 6b20 6861 7320 6174  ing block has at
-0002c390: 206c 6561 7374 206f 6e65 2074 786e 0a20   least one txn. 
-0002c3a0: 2020 2020 2020 2077 332e 6574 682e 7365         w3.eth.se
-0002c3b0: 6e64 5f74 7261 6e73 6163 7469 6f6e 280a  nd_transaction(.
-0002c3c0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-0002c3d0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0002c3e0: 726f 6d22 3a20 756e 6c6f 636b 6564 5f61  rom": unlocked_a
-0002c3f0: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-0002c400: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002c410: 2020 2274 6f22 3a20 756e 6c6f 636b 6564    "to": unlocked
-0002c420: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
-0002c430: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-0002c440: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
-0002c450: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
-0002c460: 207d 0a20 2020 2020 2020 2029 0a20 2020   }.        ).   
-0002c470: 2020 2020 206c 6173 745f 7065 6e64 696e       last_pendin
-0002c480: 675f 7478 6e5f 696e 6465 7820 3d20 6c65  g_txn_index = le
-0002c490: 6e28 7733 2e65 7468 2e67 6574 5f62 6c6f  n(w3.eth.get_blo
-0002c4a0: 636b 2822 7065 6e64 696e 6722 295b 2274  ck("pending")["t
-0002c4b0: 7261 6e73 6163 7469 6f6e 7322 5d29 202d  ransactions"]) -
-0002c4c0: 2031 0a20 2020 2020 2020 2072 6177 5f74   1.        raw_t
-0002c4d0: 7261 6e73 6163 7469 6f6e 203d 2077 332e  ransaction = w3.
-0002c4e0: 6574 682e 6765 745f 7261 775f 7472 616e  eth.get_raw_tran
-0002c4f0: 7361 6374 696f 6e5f 6279 5f62 6c6f 636b  saction_by_block
-0002c500: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
-0002c510: 656e 6469 6e67 222c 206c 6173 745f 7065  ending", last_pe
-0002c520: 6e64 696e 675f 7478 6e5f 696e 6465 780a  nding_txn_index.
-0002c530: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002c540: 2020 6173 7365 7274 2069 735f 6279 7465    assert is_byte
-0002c550: 7328 7261 775f 7472 616e 7361 6374 696f  s(raw_transactio
-0002c560: 6e29 0a0a 2020 2020 2020 2020 2320 6574  n)..        # et
-0002c570: 685f 6765 7452 6177 5472 616e 7361 6374  h_getRawTransact
-0002c580: 696f 6e42 7942 6c6f 636b 4e75 6d62 6572  ionByBlockNumber
-0002c590: 416e 6449 6e64 6578 3a20 626c 6f63 6b20  AndIndex: block 
-0002c5a0: 6e75 6d62 6572 0a20 2020 2020 2020 2062  number.        b
-0002c5b0: 6c6f 636b 5f77 6974 685f 7478 6e5f 6e75  lock_with_txn_nu
-0002c5c0: 6d62 6572 203d 2062 6c6f 636b 5f77 6974  mber = block_wit
-0002c5d0: 685f 7478 6e5b 226e 756d 6265 7222 5d0a  h_txn["number"].
-0002c5e0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-0002c5f0: 735f 696e 7465 6765 7228 626c 6f63 6b5f  s_integer(block_
-0002c600: 7769 7468 5f74 786e 5f6e 756d 6265 7229  with_txn_number)
-0002c610: 0a20 2020 2020 2020 2072 6177 5f74 7261  .        raw_tra
-0002c620: 6e73 6163 7469 6f6e 203d 2077 332e 6574  nsaction = w3.et
-0002c630: 682e 6765 745f 7261 775f 7472 616e 7361  h.get_raw_transa
-0002c640: 6374 696f 6e5f 6279 5f62 6c6f 636b 2862  ction_by_block(b
-0002c650: 6c6f 636b 5f77 6974 685f 7478 6e5f 6e75  lock_with_txn_nu
-0002c660: 6d62 6572 2c20 3029 0a20 2020 2020 2020  mber, 0).       
-0002c670: 2061 7373 6572 7420 6973 5f62 7974 6573   assert is_bytes
-0002c680: 2872 6177 5f74 7261 6e73 6163 7469 6f6e  (raw_transaction
-0002c690: 290a 0a20 2020 2020 2020 2023 2065 7468  )..        # eth
-0002c6a0: 5f67 6574 5261 7754 7261 6e73 6163 7469  _getRawTransacti
-0002c6b0: 6f6e 4279 426c 6f63 6b48 6173 6841 6e64  onByBlockHashAnd
-0002c6c0: 496e 6465 783a 2062 6c6f 636b 2068 6173  Index: block has
-0002c6d0: 680a 2020 2020 2020 2020 626c 6f63 6b5f  h.        block_
-0002c6e0: 7769 7468 5f74 786e 5f68 6173 6820 3d20  with_txn_hash = 
-0002c6f0: 626c 6f63 6b5f 7769 7468 5f74 786e 5b22  block_with_txn["
-0002c700: 6861 7368 225d 0a20 2020 2020 2020 2061  hash"].        a
-0002c710: 7373 6572 7420 6973 5f62 7974 6573 2862  ssert is_bytes(b
-0002c720: 6c6f 636b 5f77 6974 685f 7478 6e5f 6861  lock_with_txn_ha
-0002c730: 7368 290a 2020 2020 2020 2020 7261 775f  sh).        raw_
-0002c740: 7472 616e 7361 6374 696f 6e20 3d20 7733  transaction = w3
-0002c750: 2e65 7468 2e67 6574 5f72 6177 5f74 7261  .eth.get_raw_tra
-0002c760: 6e73 6163 7469 6f6e 5f62 795f 626c 6f63  nsaction_by_bloc
-0002c770: 6b28 626c 6f63 6b5f 7769 7468 5f74 786e  k(block_with_txn
-0002c780: 5f68 6173 682c 2030 290a 2020 2020 2020  _hash, 0).      
-0002c790: 2020 6173 7365 7274 2069 735f 6279 7465    assert is_byte
-0002c7a0: 7328 7261 775f 7472 616e 7361 6374 696f  s(raw_transactio
-0002c7b0: 6e29 0a0a 2020 2020 4070 7974 6573 742e  n)..    @pytest.
-0002c7c0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-0002c7d0: 2822 756e 6b6e 6f77 6e5f 626c 6f63 6b5f  ("unknown_block_
-0002c7e0: 6e75 6d5f 6f72 5f68 6173 6822 2c20 2831  num_or_hash", (1
-0002c7f0: 3233 3435 3637 3839 3939 3939 2c20 554e  234567899999, UN
-0002c800: 4b4e 4f57 4e5f 4841 5348 2929 0a20 2020  KNOWN_HASH)).   
-0002c810: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
-0002c820: 745f 7261 775f 7472 616e 7361 6374 696f  t_raw_transactio
-0002c830: 6e5f 6279 5f62 6c6f 636b 5f72 6169 7365  n_by_block_raise
-0002c840: 735f 6572 726f 7228 0a20 2020 2020 2020  s_error(.       
-0002c850: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
-0002c860: 222c 2075 6e6b 6e6f 776e 5f62 6c6f 636b  ", unknown_block
-0002c870: 5f6e 756d 5f6f 725f 6861 7368 3a20 556e  _num_or_hash: Un
-0002c880: 696f 6e5b 696e 742c 2048 6578 4279 7465  ion[int, HexByte
-0002c890: 735d 0a20 2020 2029 202d 3e20 4e6f 6e65  s].    ) -> None
-0002c8a0: 3a0a 2020 2020 2020 2020 7769 7468 2070  :.        with p
-0002c8b0: 7974 6573 742e 7261 6973 6573 280a 2020  ytest.raises(.  
-0002c8c0: 2020 2020 2020 2020 2020 5472 616e 7361            Transa
-0002c8d0: 6374 696f 6e4e 6f74 466f 756e 642c 0a20  ctionNotFound,. 
-0002c8e0: 2020 2020 2020 2020 2020 206d 6174 6368             match
-0002c8f0: 3d28 0a20 2020 2020 2020 2020 2020 2020  =(.             
-0002c900: 2020 2066 2254 7261 6e73 6163 7469 6f6e     f"Transaction
-0002c910: 2069 6e64 6578 3a20 3020 6f6e 2062 6c6f   index: 0 on blo
-0002c920: 636b 2069 643a 2022 0a20 2020 2020 2020  ck id: ".       
-0002c930: 2020 2020 2020 2020 2066 227b 746f 5f68           f"{to_h
-0002c940: 6578 5f69 665f 696e 7465 6765 7228 756e  ex_if_integer(un
-0002c950: 6b6e 6f77 6e5f 626c 6f63 6b5f 6e75 6d5f  known_block_num_
-0002c960: 6f72 5f68 6173 6829 2172 7d20 6e6f 7420  or_hash)!r} not 
-0002c970: 666f 756e 642e 220a 2020 2020 2020 2020  found.".        
-0002c980: 2020 2020 292c 0a20 2020 2020 2020 2029      ),.        )
-0002c990: 3a0a 2020 2020 2020 2020 2020 2020 7733  :.            w3
-0002c9a0: 2e65 7468 2e67 6574 5f72 6177 5f74 7261  .eth.get_raw_tra
-0002c9b0: 6e73 6163 7469 6f6e 5f62 795f 626c 6f63  nsaction_by_bloc
-0002c9c0: 6b28 756e 6b6e 6f77 6e5f 626c 6f63 6b5f  k(unknown_block_
-0002c9d0: 6e75 6d5f 6f72 5f68 6173 682c 2030 290a  num_or_hash, 0).
-0002c9e0: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-0002c9f0: 685f 6765 745f 7261 775f 7472 616e 7361  h_get_raw_transa
-0002ca00: 6374 696f 6e5f 6279 5f62 6c6f 636b 5f72  ction_by_block_r
-0002ca10: 6169 7365 735f 6572 726f 725f 626c 6f63  aises_error_bloc
-0002ca20: 6b5f 6964 656e 7469 6669 6572 280a 2020  k_identifier(.  
-0002ca30: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
-0002ca40: 2257 6562 3322 0a20 2020 2029 202d 3e20  "Web3".    ) -> 
-0002ca50: 4e6f 6e65 3a0a 2020 2020 2020 2020 756e  None:.        un
-0002ca60: 6b6e 6f77 6e5f 6964 656e 7469 6669 6572  known_identifier
-0002ca70: 203d 2022 756e 6b6e 6f77 6e22 0a20 2020   = "unknown".   
-0002ca80: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-0002ca90: 2e72 6169 7365 7328 0a20 2020 2020 2020  .raises(.       
-0002caa0: 2020 2020 2056 616c 7565 4572 726f 722c       ValueError,
-0002cab0: 0a20 2020 2020 2020 2020 2020 206d 6174  .            mat
-0002cac0: 6368 3d28 0a20 2020 2020 2020 2020 2020  ch=(.           
-0002cad0: 2020 2020 2022 5661 6c75 6520 6469 6420       "Value did 
-0002cae0: 6e6f 7420 6d61 7463 6820 616e 7920 6f66  not match any of
-0002caf0: 2074 6865 2072 6563 6f67 6e69 7a65 6420   the recognized 
-0002cb00: 626c 6f63 6b20 6964 656e 7469 6669 6572  block identifier
-0002cb10: 733a 2022 0a20 2020 2020 2020 2020 2020  s: ".           
-0002cb20: 2020 2020 2066 227b 756e 6b6e 6f77 6e5f       f"{unknown_
-0002cb30: 6964 656e 7469 6669 6572 7d22 0a20 2020  identifier}".   
-0002cb40: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-0002cb50: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-0002cb60: 2020 2077 332e 6574 682e 6765 745f 7261     w3.eth.get_ra
-0002cb70: 775f 7472 616e 7361 6374 696f 6e5f 6279  w_transaction_by
-0002cb80: 5f62 6c6f 636b 2875 6e6b 6e6f 776e 5f69  _block(unknown_i
-0002cb90: 6465 6e74 6966 6965 722c 2030 2920 2023  dentifier, 0)  #
-0002cba0: 2074 7970 653a 2069 676e 6f72 650a 0a20   type: ignore.. 
-0002cbb0: 2020 2064 6566 2074 6573 745f 6465 6661     def test_defa
-0002cbc0: 756c 745f 6163 636f 756e 7428 0a20 2020  ult_account(.   
-0002cbd0: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
-0002cbe0: 5765 6233 222c 2075 6e6c 6f63 6b65 645f  Web3", unlocked_
-0002cbf0: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
-0002cc00: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
-0002cc10: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
-0002cc20: 3a0a 2020 2020 2020 2020 2320 6368 6563  :.        # chec
-0002cc30: 6b20 6465 6661 756c 7473 2074 6f20 656d  k defaults to em
-0002cc40: 7074 790a 2020 2020 2020 2020 6465 6661  pty.        defa
-0002cc50: 756c 745f 6163 636f 756e 7420 3d20 7733  ult_account = w3
-0002cc60: 2e65 7468 2e64 6566 6175 6c74 5f61 6363  .eth.default_acc
-0002cc70: 6f75 6e74 0a20 2020 2020 2020 2061 7373  ount.        ass
-0002cc80: 6572 7420 6465 6661 756c 745f 6163 636f  ert default_acco
-0002cc90: 756e 7420 6973 2065 6d70 7479 0a0a 2020  unt is empty..  
-0002cca0: 2020 2020 2020 2320 6368 6563 6b20 7365        # check se
-0002ccb0: 7474 6572 0a20 2020 2020 2020 2077 332e  tter.        w3.
-0002ccc0: 6574 682e 6465 6661 756c 745f 6163 636f  eth.default_acco
-0002ccd0: 756e 7420 3d20 756e 6c6f 636b 6564 5f61  unt = unlocked_a
-0002cce0: 6363 6f75 6e74 5f64 7561 6c5f 7479 7065  ccount_dual_type
-0002ccf0: 0a20 2020 2020 2020 2064 6566 6175 6c74  .        default
-0002cd00: 5f61 6363 6f75 6e74 203d 2077 332e 6574  _account = w3.et
-0002cd10: 682e 6465 6661 756c 745f 6163 636f 756e  h.default_accoun
-0002cd20: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
-0002cd30: 2064 6566 6175 6c74 5f61 6363 6f75 6e74   default_account
-0002cd40: 203d 3d20 756e 6c6f 636b 6564 5f61 6363   == unlocked_acc
-0002cd50: 6f75 6e74 5f64 7561 6c5f 7479 7065 0a0a  ount_dual_type..
-0002cd60: 2020 2020 2020 2020 2320 7265 7365 7420          # reset 
-0002cd70: 746f 2064 6566 6175 6c74 0a20 2020 2020  to default.     
-0002cd80: 2020 2077 332e 6574 682e 6465 6661 756c     w3.eth.defaul
-0002cd90: 745f 6163 636f 756e 7420 3d20 656d 7074  t_account = empt
-0002cda0: 790a 0a20 2020 2064 6566 2074 6573 745f  y..    def test_
-0002cdb0: 6465 6661 756c 745f 626c 6f63 6b28 0a20  default_block(. 
-0002cdc0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0002cdd0: 2020 2020 2077 333a 2022 5765 6233 222c       w3: "Web3",
-0002cde0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0002cdf0: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
-0002ce00: 6465 6661 756c 7473 2074 6f20 276c 6174  defaults to 'lat
-0002ce10: 6573 7427 0a20 2020 2020 2020 2064 6566  est'.        def
-0002ce20: 6175 6c74 5f62 6c6f 636b 203d 2077 332e  ault_block = w3.
-0002ce30: 6574 682e 6465 6661 756c 745f 626c 6f63  eth.default_bloc
-0002ce40: 6b0a 2020 2020 2020 2020 6173 7365 7274  k.        assert
-0002ce50: 2064 6566 6175 6c74 5f62 6c6f 636b 203d   default_block =
-0002ce60: 3d20 226c 6174 6573 7422 0a0a 2020 2020  = "latest"..    
-0002ce70: 2020 2020 2320 6368 6563 6b20 7365 7474      # check sett
-0002ce80: 6572 0a20 2020 2020 2020 2077 332e 6574  er.        w3.et
-0002ce90: 682e 6465 6661 756c 745f 626c 6f63 6b20  h.default_block 
-0002cea0: 3d20 426c 6f63 6b4e 756d 6265 7228 3132  = BlockNumber(12
-0002ceb0: 3334 3529 0a20 2020 2020 2020 2064 6566  345).        def
-0002cec0: 6175 6c74 5f62 6c6f 636b 203d 2077 332e  ault_block = w3.
-0002ced0: 6574 682e 6465 6661 756c 745f 626c 6f63  eth.default_bloc
-0002cee0: 6b0a 2020 2020 2020 2020 6173 7365 7274  k.        assert
-0002cef0: 2064 6566 6175 6c74 5f62 6c6f 636b 203d   default_block =
-0002cf00: 3d20 426c 6f63 6b4e 756d 6265 7228 3132  = BlockNumber(12
-0002cf10: 3334 3529 0a0a 2020 2020 2020 2020 2320  345)..        # 
-0002cf20: 7265 7365 7420 746f 2064 6566 6175 6c74  reset to default
-0002cf30: 0a20 2020 2020 2020 2077 332e 6574 682e  .        w3.eth.
-0002cf40: 6465 6661 756c 745f 626c 6f63 6b20 3d20  default_block = 
-0002cf50: 226c 6174 6573 7422 0a                   "latest".
+0002a490: 2066 696c 7465 7220 3d20 7733 2e65 7468   filter = w3.eth
+0002a4a0: 2e66 696c 7465 7228 7b7d 290a 0a20 2020  .filter({})..   
+0002a4b0: 2020 2020 2063 6861 6e67 6573 203d 2077       changes = w
+0002a4c0: 332e 6574 682e 6765 745f 6669 6c74 6572  3.eth.get_filter
+0002a4d0: 5f63 6861 6e67 6573 2866 696c 7465 722e  _changes(filter.
+0002a4e0: 6669 6c74 6572 5f69 6429 0a20 2020 2020  filter_id).     
+0002a4f0: 2020 2061 7373 6572 7420 6973 5f6c 6973     assert is_lis
+0002a500: 745f 6c69 6b65 2863 6861 6e67 6573 290a  t_like(changes).
+0002a510: 2020 2020 2020 2020 6173 7365 7274 206e          assert n
+0002a520: 6f74 2063 6861 6e67 6573 0a0a 2020 2020  ot changes..    
+0002a530: 2020 2020 6c6f 6773 203d 2077 332e 6574      logs = w3.et
+0002a540: 682e 6765 745f 6669 6c74 6572 5f6c 6f67  h.get_filter_log
+0002a550: 7328 6669 6c74 6572 2e66 696c 7465 725f  s(filter.filter_
+0002a560: 6964 290a 2020 2020 2020 2020 6173 7365  id).        asse
+0002a570: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
+0002a580: 6c6f 6773 290a 2020 2020 2020 2020 6173  logs).        as
+0002a590: 7365 7274 206e 6f74 206c 6f67 730a 0a20  sert not logs.. 
+0002a5a0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0002a5b0: 7733 2e65 7468 2e75 6e69 6e73 7461 6c6c  w3.eth.uninstall
+0002a5c0: 5f66 696c 7465 7228 6669 6c74 6572 2e66  _filter(filter.f
+0002a5d0: 696c 7465 725f 6964 290a 2020 2020 2020  ilter_id).      
+0002a5e0: 2020 6173 7365 7274 2072 6573 756c 7420    assert result 
+0002a5f0: 6973 2054 7275 650a 0a20 2020 2064 6566  is True..    def
+0002a600: 2074 6573 745f 6574 685f 6e65 775f 626c   test_eth_new_bl
+0002a610: 6f63 6b5f 6669 6c74 6572 2873 656c 662c  ock_filter(self,
+0002a620: 2077 333a 2022 5765 6233 2229 202d 3e20   w3: "Web3") -> 
+0002a630: 4e6f 6e65 3a0a 2020 2020 2020 2020 6669  None:.        fi
+0002a640: 6c74 6572 203d 2077 332e 6574 682e 6669  lter = w3.eth.fi
+0002a650: 6c74 6572 2822 6c61 7465 7374 2229 0a20  lter("latest"). 
+0002a660: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+0002a670: 5f73 7472 696e 6728 6669 6c74 6572 2e66  _string(filter.f
+0002a680: 696c 7465 725f 6964 290a 0a20 2020 2020  ilter_id)..     
+0002a690: 2020 2063 6861 6e67 6573 203d 2077 332e     changes = w3.
+0002a6a0: 6574 682e 6765 745f 6669 6c74 6572 5f63  eth.get_filter_c
+0002a6b0: 6861 6e67 6573 2866 696c 7465 722e 6669  hanges(filter.fi
+0002a6c0: 6c74 6572 5f69 6429 0a20 2020 2020 2020  lter_id).       
+0002a6d0: 2061 7373 6572 7420 6973 5f6c 6973 745f   assert is_list_
+0002a6e0: 6c69 6b65 2863 6861 6e67 6573 290a 0a20  like(changes).. 
+0002a6f0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0002a700: 7733 2e65 7468 2e75 6e69 6e73 7461 6c6c  w3.eth.uninstall
+0002a710: 5f66 696c 7465 7228 6669 6c74 6572 2e66  _filter(filter.f
+0002a720: 696c 7465 725f 6964 290a 2020 2020 2020  ilter_id).      
+0002a730: 2020 6173 7365 7274 2072 6573 756c 7420    assert result 
+0002a740: 6973 2054 7275 650a 0a20 2020 2064 6566  is True..    def
+0002a750: 2074 6573 745f 6574 685f 6e65 775f 7065   test_eth_new_pe
+0002a760: 6e64 696e 675f 7472 616e 7361 6374 696f  nding_transactio
+0002a770: 6e5f 6669 6c74 6572 2873 656c 662c 2077  n_filter(self, w
+0002a780: 333a 2022 5765 6233 2229 202d 3e20 4e6f  3: "Web3") -> No
+0002a790: 6e65 3a0a 2020 2020 2020 2020 6669 6c74  ne:.        filt
+0002a7a0: 6572 203d 2077 332e 6574 682e 6669 6c74  er = w3.eth.filt
+0002a7b0: 6572 2822 7065 6e64 696e 6722 290a 2020  er("pending").  
+0002a7c0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+0002a7d0: 7374 7269 6e67 2866 696c 7465 722e 6669  string(filter.fi
+0002a7e0: 6c74 6572 5f69 6429 0a0a 2020 2020 2020  lter_id)..      
+0002a7f0: 2020 6368 616e 6765 7320 3d20 7733 2e65    changes = w3.e
+0002a800: 7468 2e67 6574 5f66 696c 7465 725f 6368  th.get_filter_ch
+0002a810: 616e 6765 7328 6669 6c74 6572 2e66 696c  anges(filter.fil
+0002a820: 7465 725f 6964 290a 2020 2020 2020 2020  ter_id).        
+0002a830: 6173 7365 7274 2069 735f 6c69 7374 5f6c  assert is_list_l
+0002a840: 696b 6528 6368 616e 6765 7329 0a20 2020  ike(changes).   
+0002a850: 2020 2020 2061 7373 6572 7420 6e6f 7420       assert not 
+0002a860: 6368 616e 6765 730a 0a20 2020 2020 2020  changes..       
+0002a870: 2072 6573 756c 7420 3d20 7733 2e65 7468   result = w3.eth
+0002a880: 2e75 6e69 6e73 7461 6c6c 5f66 696c 7465  .uninstall_filte
+0002a890: 7228 6669 6c74 6572 2e66 696c 7465 725f  r(filter.filter_
+0002a8a0: 6964 290a 2020 2020 2020 2020 6173 7365  id).        asse
+0002a8b0: 7274 2072 6573 756c 7420 6973 2054 7275  rt result is Tru
+0002a8c0: 650a 0a20 2020 2064 6566 2074 6573 745f  e..    def test_
+0002a8d0: 6574 685f 6765 745f 6c6f 6773 5f77 6974  eth_get_logs_wit
+0002a8e0: 686f 7574 5f6c 6f67 7328 0a20 2020 2020  hout_logs(.     
+0002a8f0: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
+0002a900: 6233 222c 2062 6c6f 636b 5f77 6974 685f  b3", block_with_
+0002a910: 7478 6e5f 7769 7468 5f6c 6f67 3a20 426c  txn_with_log: Bl
+0002a920: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+0002a930: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
+0002a940: 2054 6573 7420 7769 7468 2062 6c6f 636b   Test with block
+0002a950: 2072 616e 6765 0a0a 2020 2020 2020 2020   range..        
+0002a960: 6669 6c74 6572 5f70 6172 616d 733a 2046  filter_params: F
+0002a970: 696c 7465 7250 6172 616d 7320 3d20 7b0a  ilterParams = {.
+0002a980: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+0002a990: 6d42 6c6f 636b 223a 2042 6c6f 636b 4e75  mBlock": BlockNu
+0002a9a0: 6d62 6572 2830 292c 0a20 2020 2020 2020  mber(0),.       
+0002a9b0: 2020 2020 2022 746f 426c 6f63 6b22 3a20       "toBlock": 
+0002a9c0: 426c 6f63 6b4e 756d 6265 7228 626c 6f63  BlockNumber(bloc
+0002a9d0: 6b5f 7769 7468 5f74 786e 5f77 6974 685f  k_with_txn_with_
+0002a9e0: 6c6f 675b 226e 756d 6265 7222 5d20 2d20  log["number"] - 
+0002a9f0: 3129 2c0a 2020 2020 2020 2020 7d0a 2020  1),.        }.  
+0002aa00: 2020 2020 2020 7265 7375 6c74 203d 2077        result = w
+0002aa10: 332e 6574 682e 6765 745f 6c6f 6773 2866  3.eth.get_logs(f
+0002aa20: 696c 7465 725f 7061 7261 6d73 290a 2020  ilter_params).  
+0002aa30: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+0002aa40: 2872 6573 756c 7429 203d 3d20 300a 0a20  (result) == 0.. 
+0002aa50: 2020 2020 2020 2023 2074 6865 2072 616e         # the ran
+0002aa60: 6765 2069 7320 7772 6f6e 670a 2020 2020  ge is wrong.    
+0002aa70: 2020 2020 6669 6c74 6572 5f70 6172 616d      filter_param
+0002aa80: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+0002aa90: 2020 2266 726f 6d42 6c6f 636b 223a 2062    "fromBlock": b
+0002aaa0: 6c6f 636b 5f77 6974 685f 7478 6e5f 7769  lock_with_txn_wi
+0002aab0: 7468 5f6c 6f67 5b22 6e75 6d62 6572 225d  th_log["number"]
+0002aac0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+0002aad0: 6f42 6c6f 636b 223a 2042 6c6f 636b 4e75  oBlock": BlockNu
+0002aae0: 6d62 6572 2862 6c6f 636b 5f77 6974 685f  mber(block_with_
+0002aaf0: 7478 6e5f 7769 7468 5f6c 6f67 5b22 6e75  txn_with_log["nu
+0002ab00: 6d62 6572 225d 202d 2031 292c 0a20 2020  mber"] - 1),.   
+0002ab10: 2020 2020 207d 0a20 2020 2020 2020 2077       }.        w
+0002ab20: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+0002ab30: 7328 5661 6c75 6545 7272 6f72 293a 0a20  s(ValueError):. 
+0002ab40: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
+0002ab50: 682e 6765 745f 6c6f 6773 2866 696c 7465  h.get_logs(filte
+0002ab60: 725f 7061 7261 6d73 290a 0a20 2020 2020  r_params)..     
+0002ab70: 2020 2023 2054 6573 7420 7769 7468 2060     # Test with `
+0002ab80: 6164 6472 6573 7360 0a0a 2020 2020 2020  address`..      
+0002ab90: 2020 2320 6669 6c74 6572 2077 6974 6820    # filter with 
+0002aba0: 6f74 6865 7220 6164 6472 6573 730a 2020  other address.  
+0002abb0: 2020 2020 2020 6669 6c74 6572 5f70 6172        filter_par
+0002abc0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+0002abd0: 2020 2020 2266 726f 6d42 6c6f 636b 223a      "fromBlock":
+0002abe0: 2042 6c6f 636b 4e75 6d62 6572 2830 292c   BlockNumber(0),
+0002abf0: 0a20 2020 2020 2020 2020 2020 2022 6164  .            "ad
+0002ac00: 6472 6573 7322 3a20 554e 4b4e 4f57 4e5f  dress": UNKNOWN_
+0002ac10: 4144 4452 4553 532c 0a20 2020 2020 2020  ADDRESS,.       
+0002ac20: 207d 0a20 2020 2020 2020 2072 6573 756c   }.        resul
+0002ac30: 7420 3d20 7733 2e65 7468 2e67 6574 5f6c  t = w3.eth.get_l
+0002ac40: 6f67 7328 6669 6c74 6572 5f70 6172 616d  ogs(filter_param
+0002ac50: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
+0002ac60: 7420 6c65 6e28 7265 7375 6c74 2920 3d3d  t len(result) ==
+0002ac70: 2030 0a0a 2020 2020 2020 2020 2320 5465   0..        # Te
+0002ac80: 7374 2077 6974 6820 6d75 6c74 6970 6c65  st with multiple
+0002ac90: 2060 6164 6472 6573 7360 0a0a 2020 2020   `address`..    
+0002aca0: 2020 2020 2320 6669 6c74 6572 2077 6974      # filter wit
+0002acb0: 6820 6f74 6865 7220 6164 6472 6573 730a  h other address.
+0002acc0: 2020 2020 2020 2020 6669 6c74 6572 5f70          filter_p
+0002acd0: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+0002ace0: 2020 2020 2020 2266 726f 6d42 6c6f 636b        "fromBlock
+0002acf0: 223a 2042 6c6f 636b 4e75 6d62 6572 2830  ": BlockNumber(0
+0002ad00: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+0002ad10: 6164 6472 6573 7322 3a20 5b55 4e4b 4e4f  address": [UNKNO
+0002ad20: 574e 5f41 4444 5245 5353 2c20 554e 4b4e  WN_ADDRESS, UNKN
+0002ad30: 4f57 4e5f 4144 4452 4553 535d 2c0a 2020  OWN_ADDRESS],.  
+0002ad40: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+0002ad50: 7265 7375 6c74 203d 2077 332e 6574 682e  result = w3.eth.
+0002ad60: 6765 745f 6c6f 6773 2866 696c 7465 725f  get_logs(filter_
+0002ad70: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+0002ad80: 6173 7365 7274 206c 656e 2872 6573 756c  assert len(resul
+0002ad90: 7429 203d 3d20 300a 0a20 2020 2064 6566  t) == 0..    def
+0002ada0: 2074 6573 745f 6574 685f 6765 745f 6c6f   test_eth_get_lo
+0002adb0: 6773 5f77 6974 685f 6c6f 6773 280a 2020  gs_with_logs(.  
+0002adc0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0002add0: 2020 2020 7733 3a20 2257 6562 3322 2c0a      w3: "Web3",.
+0002ade0: 2020 2020 2020 2020 626c 6f63 6b5f 7769          block_wi
+0002adf0: 7468 5f74 786e 5f77 6974 685f 6c6f 673a  th_txn_with_log:
+0002ae00: 2042 6c6f 636b 4461 7461 2c0a 2020 2020   BlockData,.    
+0002ae10: 2020 2020 656d 6974 7465 725f 636f 6e74      emitter_cont
+0002ae20: 7261 6374 5f61 6464 7265 7373 3a20 4368  ract_address: Ch
+0002ae30: 6563 6b73 756d 4164 6472 6573 732c 0a20  ecksumAddress,. 
+0002ae40: 2020 2020 2020 2074 786e 5f68 6173 685f         txn_hash_
+0002ae50: 7769 7468 5f6c 6f67 3a20 4865 7853 7472  with_log: HexStr
+0002ae60: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+0002ae70: 0a20 2020 2020 2020 2023 2054 6573 7420  .        # Test 
+0002ae80: 7769 7468 2062 6c6f 636b 2072 616e 6765  with block range
+0002ae90: 0a0a 2020 2020 2020 2020 2320 7468 6520  ..        # the 
+0002aea0: 7261 6e67 6520 696e 636c 7564 6573 2074  range includes t
+0002aeb0: 6865 2062 6c6f 636b 2077 6865 7265 2074  he block where t
+0002aec0: 6865 206c 6f67 2072 6573 6964 6573 2069  he log resides i
+0002aed0: 6e0a 2020 2020 2020 2020 6669 6c74 6572  n.        filter
+0002aee0: 5f70 6172 616d 733a 2046 696c 7465 7250  _params: FilterP
+0002aef0: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+0002af00: 2020 2020 2020 2266 726f 6d42 6c6f 636b        "fromBlock
+0002af10: 223a 2062 6c6f 636b 5f77 6974 685f 7478  ": block_with_tx
+0002af20: 6e5f 7769 7468 5f6c 6f67 5b22 6e75 6d62  n_with_log["numb
+0002af30: 6572 225d 2c0a 2020 2020 2020 2020 2020  er"],.          
+0002af40: 2020 2274 6f42 6c6f 636b 223a 2062 6c6f    "toBlock": blo
+0002af50: 636b 5f77 6974 685f 7478 6e5f 7769 7468  ck_with_txn_with
+0002af60: 5f6c 6f67 5b22 6e75 6d62 6572 225d 2c0a  _log["number"],.
+0002af70: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+0002af80: 2020 7265 7375 6c74 203d 2077 332e 6574    result = w3.et
+0002af90: 682e 6765 745f 6c6f 6773 2866 696c 7465  h.get_logs(filte
+0002afa0: 725f 7061 7261 6d73 290a 2020 2020 2020  r_params).      
+0002afb0: 2020 6173 7365 7274 5f63 6f6e 7461 696e    assert_contain
+0002afc0: 735f 6c6f 6728 0a20 2020 2020 2020 2020  s_log(.         
+0002afd0: 2020 2072 6573 756c 742c 2062 6c6f 636b     result, block
+0002afe0: 5f77 6974 685f 7478 6e5f 7769 7468 5f6c  _with_txn_with_l
+0002aff0: 6f67 2c20 656d 6974 7465 725f 636f 6e74  og, emitter_cont
+0002b000: 7261 6374 5f61 6464 7265 7373 2c20 7478  ract_address, tx
+0002b010: 6e5f 6861 7368 5f77 6974 685f 6c6f 670a  n_hash_with_log.
+0002b020: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0002b030: 2020 2023 2073 7065 6369 6679 206f 6e6c     # specify onl
+0002b040: 7920 6066 726f 6d5f 626c 6f63 6b60 2e20  y `from_block`. 
+0002b050: 6279 2064 6566 6175 6c74 2060 746f 5f62  by default `to_b
+0002b060: 6c6f 636b 6020 7368 6f75 6c64 2062 6520  lock` should be 
+0002b070: 276c 6174 6573 7427 0a20 2020 2020 2020  'latest'.       
+0002b080: 2066 696c 7465 725f 7061 7261 6d73 203d   filter_params =
+0002b090: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+0002b0a0: 6672 6f6d 426c 6f63 6b22 3a20 426c 6f63  fromBlock": Bloc
+0002b0b0: 6b4e 756d 6265 7228 3029 2c0a 2020 2020  kNumber(0),.    
+0002b0c0: 2020 2020 7d0a 2020 2020 2020 2020 7265      }.        re
+0002b0d0: 7375 6c74 203d 2077 332e 6574 682e 6765  sult = w3.eth.ge
+0002b0e0: 745f 6c6f 6773 2866 696c 7465 725f 7061  t_logs(filter_pa
+0002b0f0: 7261 6d73 290a 2020 2020 2020 2020 6173  rams).        as
+0002b100: 7365 7274 5f63 6f6e 7461 696e 735f 6c6f  sert_contains_lo
+0002b110: 6728 0a20 2020 2020 2020 2020 2020 2072  g(.            r
+0002b120: 6573 756c 742c 2062 6c6f 636b 5f77 6974  esult, block_wit
+0002b130: 685f 7478 6e5f 7769 7468 5f6c 6f67 2c20  h_txn_with_log, 
+0002b140: 656d 6974 7465 725f 636f 6e74 7261 6374  emitter_contract
+0002b150: 5f61 6464 7265 7373 2c20 7478 6e5f 6861  _address, txn_ha
+0002b160: 7368 5f77 6974 685f 6c6f 670a 2020 2020  sh_with_log.    
+0002b170: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
+0002b180: 2054 6573 7420 7769 7468 2060 6164 6472   Test with `addr
+0002b190: 6573 7360 0a0a 2020 2020 2020 2020 2320  ess`..        # 
+0002b1a0: 6669 6c74 6572 2077 6974 6820 656d 6974  filter with emit
+0002b1b0: 7465 725f 636f 6e74 7261 6374 2e61 6464  ter_contract.add
+0002b1c0: 7265 7373 0a20 2020 2020 2020 2066 696c  ress.        fil
+0002b1d0: 7465 725f 7061 7261 6d73 203d 207b 0a20  ter_params = {. 
+0002b1e0: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+0002b1f0: 426c 6f63 6b22 3a20 426c 6f63 6b4e 756d  Block": BlockNum
+0002b200: 6265 7228 3029 2c0a 2020 2020 2020 2020  ber(0),.        
+0002b210: 2020 2020 2261 6464 7265 7373 223a 2065      "address": e
+0002b220: 6d69 7474 6572 5f63 6f6e 7472 6163 745f  mitter_contract_
+0002b230: 6164 6472 6573 732c 0a20 2020 2020 2020  address,.       
+0002b240: 207d 0a0a 2020 2020 6465 6620 7465 7374   }..    def test
+0002b250: 5f65 7468 5f67 6574 5f6c 6f67 735f 7769  _eth_get_logs_wi
+0002b260: 7468 5f6c 6f67 735f 746f 7069 635f 6172  th_logs_topic_ar
+0002b270: 6773 280a 2020 2020 2020 2020 7365 6c66  gs(.        self
+0002b280: 2c0a 2020 2020 2020 2020 7733 3a20 2257  ,.        w3: "W
+0002b290: 6562 3322 2c0a 2020 2020 2020 2020 626c  eb3",.        bl
+0002b2a0: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
+0002b2b0: 685f 6c6f 673a 2042 6c6f 636b 4461 7461  h_log: BlockData
+0002b2c0: 2c0a 2020 2020 2020 2020 656d 6974 7465  ,.        emitte
+0002b2d0: 725f 636f 6e74 7261 6374 5f61 6464 7265  r_contract_addre
+0002b2e0: 7373 3a20 4368 6563 6b73 756d 4164 6472  ss: ChecksumAddr
+0002b2f0: 6573 732c 0a20 2020 2020 2020 2074 786e  ess,.        txn
+0002b300: 5f68 6173 685f 7769 7468 5f6c 6f67 3a20  _hash_with_log: 
+0002b310: 4865 7853 7472 2c0a 2020 2020 2920 2d3e  HexStr,.    ) ->
+0002b320: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
+0002b330: 2054 6573 7420 7769 7468 204e 6f6e 6520   Test with None 
+0002b340: 6576 656e 7420 7369 670a 0a20 2020 2020  event sig..     
+0002b350: 2020 2066 696c 7465 725f 7061 7261 6d73     filter_params
+0002b360: 3a20 4669 6c74 6572 5061 7261 6d73 203d  : FilterParams =
+0002b370: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+0002b380: 6672 6f6d 426c 6f63 6b22 3a20 426c 6f63  fromBlock": Bloc
+0002b390: 6b4e 756d 6265 7228 3029 2c0a 2020 2020  kNumber(0),.    
+0002b3a0: 2020 2020 2020 2020 2274 6f70 6963 7322          "topics"
+0002b3b0: 3a20 5b0a 2020 2020 2020 2020 2020 2020  : [.            
+0002b3c0: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
+0002b3d0: 2020 2020 2020 2020 2020 4865 7853 7472            HexStr
+0002b3e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002b3f0: 2020 2020 2020 2230 7830 3030 3030 3030        "0x0000000
+0002b400: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+0002b410: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+0002b420: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+0002b430: 3030 3030 3064 3433 3122 0a20 2020 2020  00000d431".     
+0002b440: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+0002b450: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
+0002b460: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
+0002b470: 7265 7375 6c74 203d 2077 332e 6574 682e  result = w3.eth.
+0002b480: 6765 745f 6c6f 6773 2866 696c 7465 725f  get_logs(filter_
+0002b490: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+0002b4a0: 6173 7365 7274 5f63 6f6e 7461 696e 735f  assert_contains_
+0002b4b0: 6c6f 6728 0a20 2020 2020 2020 2020 2020  log(.           
+0002b4c0: 2072 6573 756c 742c 2062 6c6f 636b 5f77   result, block_w
+0002b4d0: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
+0002b4e0: 2c20 656d 6974 7465 725f 636f 6e74 7261  , emitter_contra
+0002b4f0: 6374 5f61 6464 7265 7373 2c20 7478 6e5f  ct_address, txn_
+0002b500: 6861 7368 5f77 6974 685f 6c6f 670a 2020  hash_with_log.  
+0002b510: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0002b520: 2023 2054 6573 7420 7769 7468 204e 6f6e   # Test with Non
+0002b530: 6520 696e 6465 7865 6420 6172 670a 2020  e indexed arg.  
+0002b540: 2020 2020 2020 6669 6c74 6572 5f70 6172        filter_par
+0002b550: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+0002b560: 2020 2020 2266 726f 6d42 6c6f 636b 223a      "fromBlock":
+0002b570: 2042 6c6f 636b 4e75 6d62 6572 2830 292c   BlockNumber(0),
+0002b580: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
+0002b590: 7069 6373 223a 205b 0a20 2020 2020 2020  pics": [.       
+0002b5a0: 2020 2020 2020 2020 2048 6578 5374 7228           HexStr(
+0002b5b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b5c0: 2020 2020 2022 3078 3035 3762 6333 3238       "0x057bc328
+0002b5d0: 3236 6662 6531 3631 6461 3163 3131 3061  26fbe161da1c110a
+0002b5e0: 6663 6463 6165 3763 3130 3961 3862 3639  fcdcae7c109a8b69
+0002b5f0: 3134 3966 3732 3766 6333 3761 3630 3363  149f727fc37a603c
+0002b600: 3630 6566 3934 6361 220a 2020 2020 2020  60ef94ca".      
+0002b610: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+0002b620: 2020 2020 2020 2020 2020 2020 204e 6f6e               Non
+0002b630: 652c 0a20 2020 2020 2020 2020 2020 205d  e,.            ]
+0002b640: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+0002b650: 2020 2020 7265 7375 6c74 203d 2077 332e      result = w3.
+0002b660: 6574 682e 6765 745f 6c6f 6773 2866 696c  eth.get_logs(fil
+0002b670: 7465 725f 7061 7261 6d73 290a 2020 2020  ter_params).    
+0002b680: 2020 2020 6173 7365 7274 5f63 6f6e 7461      assert_conta
+0002b690: 696e 735f 6c6f 6728 0a20 2020 2020 2020  ins_log(.       
+0002b6a0: 2020 2020 2072 6573 756c 742c 2062 6c6f       result, blo
+0002b6b0: 636b 5f77 6974 685f 7478 6e5f 7769 7468  ck_with_txn_with
+0002b6c0: 5f6c 6f67 2c20 656d 6974 7465 725f 636f  _log, emitter_co
+0002b6d0: 6e74 7261 6374 5f61 6464 7265 7373 2c20  ntract_address, 
+0002b6e0: 7478 6e5f 6861 7368 5f77 6974 685f 6c6f  txn_hash_with_lo
+0002b6f0: 670a 2020 2020 2020 2020 290a 0a20 2020  g.        )..   
+0002b700: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+0002b710: 745f 6c6f 6773 5f77 6974 685f 6c6f 6773  t_logs_with_logs
+0002b720: 5f6e 6f6e 655f 746f 7069 635f 6172 6773  _none_topic_args
+0002b730: 2873 656c 662c 2077 333a 2022 5765 6233  (self, w3: "Web3
+0002b740: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
+0002b750: 2020 2020 2320 5465 7374 2077 6974 6820      # Test with 
+0002b760: 4e6f 6e65 206f 7665 7266 6c6f 7769 6e67  None overflowing
+0002b770: 0a20 2020 2020 2020 2066 696c 7465 725f  .        filter_
+0002b780: 7061 7261 6d73 3a20 4669 6c74 6572 5061  params: FilterPa
+0002b790: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+0002b7a0: 2020 2020 2022 6672 6f6d 426c 6f63 6b22       "fromBlock"
+0002b7b0: 3a20 426c 6f63 6b4e 756d 6265 7228 3029  : BlockNumber(0)
+0002b7c0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+0002b7d0: 6f70 6963 7322 3a20 5b4e 6f6e 652c 204e  opics": [None, N
+0002b7e0: 6f6e 652c 204e 6f6e 655d 2c0a 2020 2020  one, None],.    
+0002b7f0: 2020 2020 7d0a 0a20 2020 2020 2020 2072      }..        r
+0002b800: 6573 756c 7420 3d20 7733 2e65 7468 2e67  esult = w3.eth.g
+0002b810: 6574 5f6c 6f67 7328 6669 6c74 6572 5f70  et_logs(filter_p
+0002b820: 6172 616d 7329 0a20 2020 2020 2020 2061  arams).        a
+0002b830: 7373 6572 7420 6c65 6e28 7265 7375 6c74  ssert len(result
+0002b840: 2920 3d3d 2030 0a0a 2020 2020 6465 6620  ) == 0..    def 
+0002b850: 7465 7374 5f65 7468 5f63 616c 6c5f 6f6c  test_eth_call_ol
+0002b860: 645f 636f 6e74 7261 6374 5f73 7461 7465  d_contract_state
+0002b870: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+0002b880: 7733 3a20 2257 6562 3322 2c20 6d61 7468  w3: "Web3", math
+0002b890: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
+0002b8a0: 7261 6374 222c 2075 6e6c 6f63 6b65 645f  ract", unlocked_
+0002b8b0: 6163 636f 756e 743a 2043 6865 636b 7375  account: Checksu
+0002b8c0: 6d41 6464 7265 7373 0a20 2020 2029 202d  mAddress.    ) -
+0002b8d0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0002b8e0: 7374 6172 745f 626c 6f63 6b20 3d20 7733  start_block = w3
+0002b8f0: 2e65 7468 2e67 6574 5f62 6c6f 636b 2822  .eth.get_block("
+0002b900: 6c61 7465 7374 2229 0a20 2020 2020 2020  latest").       
+0002b910: 2062 6c6f 636b 5f6e 756d 203d 2073 7461   block_num = sta
+0002b920: 7274 5f62 6c6f 636b 5b22 6e75 6d62 6572  rt_block["number
+0002b930: 225d 0a20 2020 2020 2020 2062 6c6f 636b  "].        block
+0002b940: 5f68 6173 6820 3d20 7374 6172 745f 626c  _hash = start_bl
+0002b950: 6f63 6b5b 2268 6173 6822 5d0a 0a20 2020  ock["hash"]..   
+0002b960: 2020 2020 206d 6174 685f 636f 6e74 7261       math_contra
+0002b970: 6374 2e66 756e 6374 696f 6e73 2e69 6e63  ct.functions.inc
+0002b980: 7265 6d65 6e74 436f 756e 7465 7228 292e  rementCounter().
+0002b990: 7472 616e 7361 6374 287b 2266 726f 6d22  transact({"from"
+0002b9a0: 3a20 756e 6c6f 636b 6564 5f61 6363 6f75  : unlocked_accou
+0002b9b0: 6e74 7d29 0a0a 2020 2020 2020 2020 2320  nt})..        # 
+0002b9c0: 5468 6973 2069 736e 2774 2061 6e20 696e  This isn't an in
+0002b9d0: 6372 6564 6962 6c79 2063 6f6e 7669 6e63  credibly convinc
+0002b9e0: 696e 6720 7465 7374 2073 696e 6365 2077  ing test since w
+0002b9f0: 6520 6361 6e27 7420 6d69 6e65 2c20 616e  e can't mine, an
+0002ba00: 640a 2020 2020 2020 2020 2320 7468 6520  d.        # the 
+0002ba10: 6465 6661 756c 7420 7265 736f 6c76 6564  default resolved
+0002ba20: 2062 6c6f 636b 2069 7320 6c61 7465 7374   block is latest
+0002ba30: 2c20 536f 2069 6620 626c 6f63 6b5f 6964  , So if block_id
+0002ba40: 656e 7469 6669 6572 2077 6173 2069 676e  entifier was ign
+0002ba50: 6f72 6564 0a20 2020 2020 2020 2023 2077  ored.        # w
+0002ba60: 6520 776f 756c 6420 6765 7420 7468 6520  e would get the 
+0002ba70: 7361 6d65 2072 6573 756c 742e 2046 6f72  same result. For
+0002ba80: 206e 6f77 2c20 7765 206d 6f73 746c 7920   now, we mostly 
+0002ba90: 6465 7065 6e64 206f 6e20 636f 7265 2074  depend on core t
+0002baa0: 6573 7473 2e0a 2020 2020 2020 2020 2320  ests..        # 
+0002bab0: 4964 6561 7320 746f 2069 6d70 726f 7665  Ideas to improve
+0002bac0: 2074 6869 7320 7465 7374 3a0a 2020 2020   this test:.    
+0002bad0: 2020 2020 2320 202d 2045 6e61 626c 6520      #  - Enable 
+0002bae0: 6f6e 2d64 656d 616e 6420 6d69 6e69 6e67  on-demand mining
+0002baf0: 2069 6e20 6d6f 7265 2063 6c69 656e 7473   in more clients
+0002bb00: 0a20 2020 2020 2020 2023 2020 2d20 496e  .        #  - In
+0002bb10: 6372 656d 656e 7420 7468 6520 6d61 7468  crement the math
+0002bb20: 2063 6f6e 7472 6163 7420 696e 2061 6c6c   contract in all
+0002bb30: 206f 6620 7468 6520 6669 7874 7572 6573   of the fixtures
+0002bb40: 2c20 616e 6420 6368 6563 6b20 7468 650a  , and check the.
+0002bb50: 2020 2020 2020 2020 2320 2020 2076 616c          #    val
+0002bb60: 7565 2069 6e20 616e 206f 6c64 2062 6c6f  ue in an old blo
+0002bb70: 636b 0a20 2020 2020 2020 2062 6c6f 636b  ck.        block
+0002bb80: 5f68 6173 685f 6361 6c6c 5f72 6573 756c  _hash_call_resul
+0002bb90: 7420 3d20 6d61 7468 5f63 6f6e 7472 6163  t = math_contrac
+0002bba0: 742e 6675 6e63 7469 6f6e 732e 636f 756e  t.functions.coun
+0002bbb0: 7465 7228 292e 6361 6c6c 280a 2020 2020  ter().call(.    
+0002bbc0: 2020 2020 2020 2020 626c 6f63 6b5f 6964          block_id
+0002bbd0: 656e 7469 6669 6572 3d62 6c6f 636b 5f68  entifier=block_h
+0002bbe0: 6173 680a 2020 2020 2020 2020 290a 2020  ash.        ).  
+0002bbf0: 2020 2020 2020 626c 6f63 6b5f 6e75 6d5f        block_num_
+0002bc00: 6361 6c6c 5f72 6573 756c 7420 3d20 6d61  call_result = ma
+0002bc10: 7468 5f63 6f6e 7472 6163 742e 6675 6e63  th_contract.func
+0002bc20: 7469 6f6e 732e 636f 756e 7465 7228 292e  tions.counter().
+0002bc30: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+0002bc40: 2020 626c 6f63 6b5f 6964 656e 7469 6669    block_identifi
+0002bc50: 6572 3d62 6c6f 636b 5f6e 756d 0a20 2020  er=block_num.   
+0002bc60: 2020 2020 2029 0a20 2020 2020 2020 206c       ).        l
+0002bc70: 6174 6573 745f 6361 6c6c 5f72 6573 756c  atest_call_resul
+0002bc80: 7420 3d20 6d61 7468 5f63 6f6e 7472 6163  t = math_contrac
+0002bc90: 742e 6675 6e63 7469 6f6e 732e 636f 756e  t.functions.coun
+0002bca0: 7465 7228 292e 6361 6c6c 280a 2020 2020  ter().call(.    
+0002bcb0: 2020 2020 2020 2020 626c 6f63 6b5f 6964          block_id
+0002bcc0: 656e 7469 6669 6572 3d22 6c61 7465 7374  entifier="latest
+0002bcd0: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
+0002bce0: 2020 2020 6465 6661 756c 745f 6361 6c6c      default_call
+0002bcf0: 5f72 6573 756c 7420 3d20 6d61 7468 5f63  _result = math_c
+0002bd00: 6f6e 7472 6163 742e 6675 6e63 7469 6f6e  ontract.function
+0002bd10: 732e 636f 756e 7465 7228 292e 6361 6c6c  s.counter().call
+0002bd20: 2829 0a20 2020 2020 2020 2070 656e 6469  ().        pendi
+0002bd30: 6e67 5f63 616c 6c5f 7265 7375 6c74 203d  ng_call_result =
+0002bd40: 206d 6174 685f 636f 6e74 7261 6374 2e66   math_contract.f
+0002bd50: 756e 6374 696f 6e73 2e63 6f75 6e74 6572  unctions.counter
+0002bd60: 2829 2e63 616c 6c28 0a20 2020 2020 2020  ().call(.       
+0002bd70: 2020 2020 2062 6c6f 636b 5f69 6465 6e74       block_ident
+0002bd80: 6966 6965 723d 2270 656e 6469 6e67 220a  ifier="pending".
+0002bd90: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0002bda0: 2020 2061 7373 6572 7420 626c 6f63 6b5f     assert block_
+0002bdb0: 6861 7368 5f63 616c 6c5f 7265 7375 6c74  hash_call_result
+0002bdc0: 203d 3d20 300a 2020 2020 2020 2020 6173   == 0.        as
+0002bdd0: 7365 7274 2062 6c6f 636b 5f6e 756d 5f63  sert block_num_c
+0002bde0: 616c 6c5f 7265 7375 6c74 203d 3d20 300a  all_result == 0.
+0002bdf0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+0002be00: 6174 6573 745f 6361 6c6c 5f72 6573 756c  atest_call_resul
+0002be10: 7420 3d3d 2030 0a20 2020 2020 2020 2061  t == 0.        a
+0002be20: 7373 6572 7420 6465 6661 756c 745f 6361  ssert default_ca
+0002be30: 6c6c 5f72 6573 756c 7420 3d3d 2030 0a0a  ll_result == 0..
+0002be40: 2020 2020 2020 2020 6966 2070 656e 6469          if pendi
+0002be50: 6e67 5f63 616c 6c5f 7265 7375 6c74 2021  ng_call_result !
+0002be60: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+0002be70: 2072 6169 7365 2041 7373 6572 7469 6f6e   raise Assertion
+0002be80: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0002be90: 2020 2020 2020 2066 2270 656e 6469 6e67         f"pending
+0002bea0: 2063 616c 6c20 7265 7375 6c74 2077 6173   call result was
+0002beb0: 207b 7065 6e64 696e 675f 6361 6c6c 5f72   {pending_call_r
+0002bec0: 6573 756c 747d 2069 6e73 7465 6164 206f  esult} instead o
+0002bed0: 6620 3122 0a20 2020 2020 2020 2020 2020  f 1".           
+0002bee0: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
+0002bef0: 5f65 7468 5f75 6e69 6e73 7461 6c6c 5f66  _eth_uninstall_f
+0002bf00: 696c 7465 7228 7365 6c66 2c20 7733 3a20  ilter(self, w3: 
+0002bf10: 2257 6562 3322 2920 2d3e 204e 6f6e 653a  "Web3") -> None:
+0002bf20: 0a20 2020 2020 2020 2066 696c 7465 7220  .        filter 
+0002bf30: 3d20 7733 2e65 7468 2e66 696c 7465 7228  = w3.eth.filter(
+0002bf40: 7b7d 290a 2020 2020 2020 2020 6173 7365  {}).        asse
+0002bf50: 7274 2069 735f 7374 7269 6e67 2866 696c  rt is_string(fil
+0002bf60: 7465 722e 6669 6c74 6572 5f69 6429 0a0a  ter.filter_id)..
+0002bf70: 2020 2020 2020 2020 7375 6363 6573 7320          success 
+0002bf80: 3d20 7733 2e65 7468 2e75 6e69 6e73 7461  = w3.eth.uninsta
+0002bf90: 6c6c 5f66 696c 7465 7228 6669 6c74 6572  ll_filter(filter
+0002bfa0: 2e66 696c 7465 725f 6964 290a 2020 2020  .filter_id).    
+0002bfb0: 2020 2020 6173 7365 7274 2073 7563 6365      assert succe
+0002bfc0: 7373 2069 7320 5472 7565 0a0a 2020 2020  ss is True..    
+0002bfd0: 2020 2020 6661 696c 7572 6520 3d20 7733      failure = w3
+0002bfe0: 2e65 7468 2e75 6e69 6e73 7461 6c6c 5f66  .eth.uninstall_f
+0002bff0: 696c 7465 7228 6669 6c74 6572 2e66 696c  ilter(filter.fil
+0002c000: 7465 725f 6964 290a 2020 2020 2020 2020  ter_id).        
+0002c010: 6173 7365 7274 2066 6169 6c75 7265 2069  assert failure i
+0002c020: 7320 4661 6c73 650a 0a20 2020 2064 6566  s False..    def
+0002c030: 2074 6573 745f 6574 685f 6765 745f 7261   test_eth_get_ra
+0002c040: 775f 7472 616e 7361 6374 696f 6e28 7365  w_transaction(se
+0002c050: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+0002c060: 6d69 6e65 645f 7478 6e5f 6861 7368 3a20  mined_txn_hash: 
+0002c070: 4865 7853 7472 2920 2d3e 204e 6f6e 653a  HexStr) -> None:
+0002c080: 0a20 2020 2020 2020 2072 6177 5f74 7261  .        raw_tra
+0002c090: 6e73 6163 7469 6f6e 203d 2077 332e 6574  nsaction = w3.et
+0002c0a0: 682e 6765 745f 7261 775f 7472 616e 7361  h.get_raw_transa
+0002c0b0: 6374 696f 6e28 6d69 6e65 645f 7478 6e5f  ction(mined_txn_
+0002c0c0: 6861 7368 290a 2020 2020 2020 2020 6173  hash).        as
+0002c0d0: 7365 7274 2069 735f 6279 7465 7328 7261  sert is_bytes(ra
+0002c0e0: 775f 7472 616e 7361 6374 696f 6e29 0a0a  w_transaction)..
+0002c0f0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+0002c100: 5f67 6574 5f72 6177 5f74 7261 6e73 6163  _get_raw_transac
+0002c110: 7469 6f6e 5f72 6169 7365 735f 6572 726f  tion_raises_erro
+0002c120: 7228 7365 6c66 2c20 7733 3a20 2257 6562  r(self, w3: "Web
+0002c130: 3322 2920 2d3e 204e 6f6e 653a 0a20 2020  3") -> None:.   
+0002c140: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+0002c150: 2e72 6169 7365 7328 0a20 2020 2020 2020  .raises(.       
+0002c160: 2020 2020 2054 7261 6e73 6163 7469 6f6e       Transaction
+0002c170: 4e6f 7446 6f75 6e64 2c20 6d61 7463 683d  NotFound, match=
+0002c180: 6622 5472 616e 7361 6374 696f 6e20 7769  f"Transaction wi
+0002c190: 7468 2068 6173 683a 2027 7b55 4e4b 4e4f  th hash: '{UNKNO
+0002c1a0: 574e 5f48 4153 487d 2722 0a20 2020 2020  WN_HASH}'".     
+0002c1b0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+0002c1c0: 2020 7733 2e65 7468 2e67 6574 5f72 6177    w3.eth.get_raw
+0002c1d0: 5f74 7261 6e73 6163 7469 6f6e 2855 4e4b  _transaction(UNK
+0002c1e0: 4e4f 574e 5f48 4153 4829 0a0a 2020 2020  NOWN_HASH)..    
+0002c1f0: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
+0002c200: 5f72 6177 5f74 7261 6e73 6163 7469 6f6e  _raw_transaction
+0002c210: 5f62 795f 626c 6f63 6b28 0a20 2020 2020  _by_block(.     
+0002c220: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0002c230: 2077 333a 2022 5765 6233 222c 0a20 2020   w3: "Web3",.   
+0002c240: 2020 2020 2075 6e6c 6f63 6b65 645f 6163       unlocked_ac
+0002c250: 636f 756e 745f 6475 616c 5f74 7970 653a  count_dual_type:
+0002c260: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+0002c270: 2c0a 2020 2020 2020 2020 626c 6f63 6b5f  ,.        block_
+0002c280: 7769 7468 5f74 786e 3a20 426c 6f63 6b44  with_txn: BlockD
+0002c290: 6174 612c 0a20 2020 2029 202d 3e20 4e6f  ata,.    ) -> No
+0002c2a0: 6e65 3a0a 2020 2020 2020 2020 2320 6574  ne:.        # et
+0002c2b0: 685f 6765 7452 6177 5472 616e 7361 6374  h_getRawTransact
+0002c2c0: 696f 6e42 7942 6c6f 636b 4e75 6d62 6572  ionByBlockNumber
+0002c2d0: 416e 6449 6e64 6578 3a20 626c 6f63 6b20  AndIndex: block 
+0002c2e0: 6964 656e 7469 6669 6572 0a20 2020 2020  identifier.     
+0002c2f0: 2020 2023 2073 656e 6420 6120 7478 6e20     # send a txn 
+0002c300: 746f 206d 616b 6520 7375 7265 2070 656e  to make sure pen
+0002c310: 6469 6e67 2062 6c6f 636b 2068 6173 2061  ding block has a
+0002c320: 7420 6c65 6173 7420 6f6e 6520 7478 6e0a  t least one txn.
+0002c330: 2020 2020 2020 2020 7733 2e65 7468 2e73          w3.eth.s
+0002c340: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
+0002c350: 0a20 2020 2020 2020 2020 2020 207b 0a20  .            {. 
+0002c360: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002c370: 6672 6f6d 223a 2075 6e6c 6f63 6b65 645f  from": unlocked_
+0002c380: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+0002c390: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0002c3a0: 2020 2022 746f 223a 2075 6e6c 6f63 6b65     "to": unlocke
+0002c3b0: 645f 6163 636f 756e 745f 6475 616c 5f74  d_account_dual_t
+0002c3c0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+0002c3d0: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+0002c3e0: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+0002c3f0: 2020 7d0a 2020 2020 2020 2020 290a 2020    }.        ).  
+0002c400: 2020 2020 2020 6c61 7374 5f70 656e 6469        last_pendi
+0002c410: 6e67 5f74 786e 5f69 6e64 6578 203d 206c  ng_txn_index = l
+0002c420: 656e 2877 332e 6574 682e 6765 745f 626c  en(w3.eth.get_bl
+0002c430: 6f63 6b28 2270 656e 6469 6e67 2229 5b22  ock("pending")["
+0002c440: 7472 616e 7361 6374 696f 6e73 225d 2920  transactions"]) 
+0002c450: 2d20 310a 2020 2020 2020 2020 7261 775f  - 1.        raw_
+0002c460: 7472 616e 7361 6374 696f 6e20 3d20 7733  transaction = w3
+0002c470: 2e65 7468 2e67 6574 5f72 6177 5f74 7261  .eth.get_raw_tra
+0002c480: 6e73 6163 7469 6f6e 5f62 795f 626c 6f63  nsaction_by_bloc
+0002c490: 6b28 0a20 2020 2020 2020 2020 2020 2022  k(.            "
+0002c4a0: 7065 6e64 696e 6722 2c20 6c61 7374 5f70  pending", last_p
+0002c4b0: 656e 6469 6e67 5f74 786e 5f69 6e64 6578  ending_txn_index
+0002c4c0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0002c4d0: 2020 2061 7373 6572 7420 6973 5f62 7974     assert is_byt
+0002c4e0: 6573 2872 6177 5f74 7261 6e73 6163 7469  es(raw_transacti
+0002c4f0: 6f6e 290a 0a20 2020 2020 2020 2023 2065  on)..        # e
+0002c500: 7468 5f67 6574 5261 7754 7261 6e73 6163  th_getRawTransac
+0002c510: 7469 6f6e 4279 426c 6f63 6b4e 756d 6265  tionByBlockNumbe
+0002c520: 7241 6e64 496e 6465 783a 2062 6c6f 636b  rAndIndex: block
+0002c530: 206e 756d 6265 720a 2020 2020 2020 2020   number.        
+0002c540: 626c 6f63 6b5f 7769 7468 5f74 786e 5f6e  block_with_txn_n
+0002c550: 756d 6265 7220 3d20 626c 6f63 6b5f 7769  umber = block_wi
+0002c560: 7468 5f74 786e 5b22 6e75 6d62 6572 225d  th_txn["number"]
+0002c570: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0002c580: 6973 5f69 6e74 6567 6572 2862 6c6f 636b  is_integer(block
+0002c590: 5f77 6974 685f 7478 6e5f 6e75 6d62 6572  _with_txn_number
+0002c5a0: 290a 2020 2020 2020 2020 7261 775f 7472  ).        raw_tr
+0002c5b0: 616e 7361 6374 696f 6e20 3d20 7733 2e65  ansaction = w3.e
+0002c5c0: 7468 2e67 6574 5f72 6177 5f74 7261 6e73  th.get_raw_trans
+0002c5d0: 6163 7469 6f6e 5f62 795f 626c 6f63 6b28  action_by_block(
+0002c5e0: 626c 6f63 6b5f 7769 7468 5f74 786e 5f6e  block_with_txn_n
+0002c5f0: 756d 6265 722c 2030 290a 2020 2020 2020  umber, 0).      
+0002c600: 2020 6173 7365 7274 2069 735f 6279 7465    assert is_byte
+0002c610: 7328 7261 775f 7472 616e 7361 6374 696f  s(raw_transactio
+0002c620: 6e29 0a0a 2020 2020 2020 2020 2320 6574  n)..        # et
+0002c630: 685f 6765 7452 6177 5472 616e 7361 6374  h_getRawTransact
+0002c640: 696f 6e42 7942 6c6f 636b 4861 7368 416e  ionByBlockHashAn
+0002c650: 6449 6e64 6578 3a20 626c 6f63 6b20 6861  dIndex: block ha
+0002c660: 7368 0a20 2020 2020 2020 2062 6c6f 636b  sh.        block
+0002c670: 5f77 6974 685f 7478 6e5f 6861 7368 203d  _with_txn_hash =
+0002c680: 2062 6c6f 636b 5f77 6974 685f 7478 6e5b   block_with_txn[
+0002c690: 2268 6173 6822 5d0a 2020 2020 2020 2020  "hash"].        
+0002c6a0: 6173 7365 7274 2069 735f 6279 7465 7328  assert is_bytes(
+0002c6b0: 626c 6f63 6b5f 7769 7468 5f74 786e 5f68  block_with_txn_h
+0002c6c0: 6173 6829 0a20 2020 2020 2020 2072 6177  ash).        raw
+0002c6d0: 5f74 7261 6e73 6163 7469 6f6e 203d 2077  _transaction = w
+0002c6e0: 332e 6574 682e 6765 745f 7261 775f 7472  3.eth.get_raw_tr
+0002c6f0: 616e 7361 6374 696f 6e5f 6279 5f62 6c6f  ansaction_by_blo
+0002c700: 636b 2862 6c6f 636b 5f77 6974 685f 7478  ck(block_with_tx
+0002c710: 6e5f 6861 7368 2c20 3029 0a20 2020 2020  n_hash, 0).     
+0002c720: 2020 2061 7373 6572 7420 6973 5f62 7974     assert is_byt
+0002c730: 6573 2872 6177 5f74 7261 6e73 6163 7469  es(raw_transacti
+0002c740: 6f6e 290a 0a20 2020 2040 7079 7465 7374  on)..    @pytest
+0002c750: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
+0002c760: 6528 2275 6e6b 6e6f 776e 5f62 6c6f 636b  e("unknown_block
+0002c770: 5f6e 756d 5f6f 725f 6861 7368 222c 2028  _num_or_hash", (
+0002c780: 3132 3334 3536 3738 3939 3939 392c 2055  1234567899999, U
+0002c790: 4e4b 4e4f 574e 5f48 4153 4829 290a 2020  NKNOWN_HASH)).  
+0002c7a0: 2020 6465 6620 7465 7374 5f65 7468 5f67    def test_eth_g
+0002c7b0: 6574 5f72 6177 5f74 7261 6e73 6163 7469  et_raw_transacti
+0002c7c0: 6f6e 5f62 795f 626c 6f63 6b5f 7261 6973  on_by_block_rais
+0002c7d0: 6573 5f65 7272 6f72 280a 2020 2020 2020  es_error(.      
+0002c7e0: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+0002c7f0: 3322 2c20 756e 6b6e 6f77 6e5f 626c 6f63  3", unknown_bloc
+0002c800: 6b5f 6e75 6d5f 6f72 5f68 6173 683a 2055  k_num_or_hash: U
+0002c810: 6e69 6f6e 5b69 6e74 2c20 4865 7842 7974  nion[int, HexByt
+0002c820: 6573 5d0a 2020 2020 2920 2d3e 204e 6f6e  es].    ) -> Non
+0002c830: 653a 0a20 2020 2020 2020 2077 6974 6820  e:.        with 
+0002c840: 7079 7465 7374 2e72 6169 7365 7328 0a20  pytest.raises(. 
+0002c850: 2020 2020 2020 2020 2020 2054 7261 6e73             Trans
+0002c860: 6163 7469 6f6e 4e6f 7446 6f75 6e64 2c0a  actionNotFound,.
+0002c870: 2020 2020 2020 2020 2020 2020 6d61 7463              matc
+0002c880: 683d 280a 2020 2020 2020 2020 2020 2020  h=(.            
+0002c890: 2020 2020 6622 5472 616e 7361 6374 696f      f"Transactio
+0002c8a0: 6e20 696e 6465 783a 2030 206f 6e20 626c  n index: 0 on bl
+0002c8b0: 6f63 6b20 6964 3a20 220a 2020 2020 2020  ock id: ".      
+0002c8c0: 2020 2020 2020 2020 2020 6622 7b74 6f5f            f"{to_
+0002c8d0: 6865 785f 6966 5f69 6e74 6567 6572 2875  hex_if_integer(u
+0002c8e0: 6e6b 6e6f 776e 5f62 6c6f 636b 5f6e 756d  nknown_block_num
+0002c8f0: 5f6f 725f 6861 7368 2921 727d 206e 6f74  _or_hash)!r} not
+0002c900: 2066 6f75 6e64 2e22 0a20 2020 2020 2020   found.".       
+0002c910: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+0002c920: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
+0002c930: 332e 6574 682e 6765 745f 7261 775f 7472  3.eth.get_raw_tr
+0002c940: 616e 7361 6374 696f 6e5f 6279 5f62 6c6f  ansaction_by_blo
+0002c950: 636b 2875 6e6b 6e6f 776e 5f62 6c6f 636b  ck(unknown_block
+0002c960: 5f6e 756d 5f6f 725f 6861 7368 2c20 3029  _num_or_hash, 0)
+0002c970: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+0002c980: 7468 5f67 6574 5f72 6177 5f74 7261 6e73  th_get_raw_trans
+0002c990: 6163 7469 6f6e 5f62 795f 626c 6f63 6b5f  action_by_block_
+0002c9a0: 7261 6973 6573 5f65 7272 6f72 5f62 6c6f  raises_error_blo
+0002c9b0: 636b 5f69 6465 6e74 6966 6965 7228 0a20  ck_identifier(. 
+0002c9c0: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
+0002c9d0: 2022 5765 6233 220a 2020 2020 2920 2d3e   "Web3".    ) ->
+0002c9e0: 204e 6f6e 653a 0a20 2020 2020 2020 2075   None:.        u
+0002c9f0: 6e6b 6e6f 776e 5f69 6465 6e74 6966 6965  nknown_identifie
+0002ca00: 7220 3d20 2275 6e6b 6e6f 776e 220a 2020  r = "unknown".  
+0002ca10: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+0002ca20: 742e 7261 6973 6573 280a 2020 2020 2020  t.raises(.      
+0002ca30: 2020 2020 2020 5661 6c75 6545 7272 6f72        ValueError
+0002ca40: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
+0002ca50: 7463 683d 280a 2020 2020 2020 2020 2020  tch=(.          
+0002ca60: 2020 2020 2020 2256 616c 7565 2064 6964        "Value did
+0002ca70: 206e 6f74 206d 6174 6368 2061 6e79 206f   not match any o
+0002ca80: 6620 7468 6520 7265 636f 676e 697a 6564  f the recognized
+0002ca90: 2062 6c6f 636b 2069 6465 6e74 6966 6965   block identifie
+0002caa0: 7273 3a20 220a 2020 2020 2020 2020 2020  rs: ".          
+0002cab0: 2020 2020 2020 6622 7b75 6e6b 6e6f 776e        f"{unknown
+0002cac0: 5f69 6465 6e74 6966 6965 727d 220a 2020  _identifier}".  
+0002cad0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+0002cae0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+0002caf0: 2020 2020 7733 2e65 7468 2e67 6574 5f72      w3.eth.get_r
+0002cb00: 6177 5f74 7261 6e73 6163 7469 6f6e 5f62  aw_transaction_b
+0002cb10: 795f 626c 6f63 6b28 756e 6b6e 6f77 6e5f  y_block(unknown_
+0002cb20: 6964 656e 7469 6669 6572 2c20 3029 0a0a  identifier, 0)..
+0002cb30: 2020 2020 6465 6620 7465 7374 5f64 6566      def test_def
+0002cb40: 6175 6c74 5f61 6363 6f75 6e74 280a 2020  ault_account(.  
+0002cb50: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+0002cb60: 2257 6562 3322 2c20 756e 6c6f 636b 6564  "Web3", unlocked
+0002cb70: 5f61 6363 6f75 6e74 5f64 7561 6c5f 7479  _account_dual_ty
+0002cb80: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
+0002cb90: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
+0002cba0: 653a 0a20 2020 2020 2020 2023 2063 6865  e:.        # che
+0002cbb0: 636b 2064 6566 6175 6c74 7320 746f 2065  ck defaults to e
+0002cbc0: 6d70 7479 0a20 2020 2020 2020 2064 6566  mpty.        def
+0002cbd0: 6175 6c74 5f61 6363 6f75 6e74 203d 2077  ault_account = w
+0002cbe0: 332e 6574 682e 6465 6661 756c 745f 6163  3.eth.default_ac
+0002cbf0: 636f 756e 740a 2020 2020 2020 2020 6173  count.        as
+0002cc00: 7365 7274 2064 6566 6175 6c74 5f61 6363  sert default_acc
+0002cc10: 6f75 6e74 2069 7320 656d 7074 790a 0a20  ount is empty.. 
+0002cc20: 2020 2020 2020 2023 2063 6865 636b 2073         # check s
+0002cc30: 6574 7465 720a 2020 2020 2020 2020 7733  etter.        w3
+0002cc40: 2e65 7468 2e64 6566 6175 6c74 5f61 6363  .eth.default_acc
+0002cc50: 6f75 6e74 203d 2075 6e6c 6f63 6b65 645f  ount = unlocked_
+0002cc60: 6163 636f 756e 745f 6475 616c 5f74 7970  account_dual_typ
+0002cc70: 650a 2020 2020 2020 2020 6465 6661 756c  e.        defaul
+0002cc80: 745f 6163 636f 756e 7420 3d20 7733 2e65  t_account = w3.e
+0002cc90: 7468 2e64 6566 6175 6c74 5f61 6363 6f75  th.default_accou
+0002cca0: 6e74 0a20 2020 2020 2020 2061 7373 6572  nt.        asser
+0002ccb0: 7420 6465 6661 756c 745f 6163 636f 756e  t default_accoun
+0002ccc0: 7420 3d3d 2075 6e6c 6f63 6b65 645f 6163  t == unlocked_ac
+0002ccd0: 636f 756e 745f 6475 616c 5f74 7970 650a  count_dual_type.
+0002cce0: 0a20 2020 2020 2020 2023 2072 6573 6574  .        # reset
+0002ccf0: 2074 6f20 6465 6661 756c 740a 2020 2020   to default.    
+0002cd00: 2020 2020 7733 2e65 7468 2e64 6566 6175      w3.eth.defau
+0002cd10: 6c74 5f61 6363 6f75 6e74 203d 2065 6d70  lt_account = emp
+0002cd20: 7479 0a0a 2020 2020 6465 6620 7465 7374  ty..    def test
+0002cd30: 5f64 6566 6175 6c74 5f62 6c6f 636b 280a  _default_block(.
+0002cd40: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0002cd50: 2020 2020 2020 7733 3a20 2257 6562 3322        w3: "Web3"
+0002cd60: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+0002cd70: 0a20 2020 2020 2020 2023 2063 6865 636b  .        # check
+0002cd80: 2064 6566 6175 6c74 7320 746f 2027 6c61   defaults to 'la
+0002cd90: 7465 7374 270a 2020 2020 2020 2020 6465  test'.        de
+0002cda0: 6661 756c 745f 626c 6f63 6b20 3d20 7733  fault_block = w3
+0002cdb0: 2e65 7468 2e64 6566 6175 6c74 5f62 6c6f  .eth.default_blo
+0002cdc0: 636b 0a20 2020 2020 2020 2061 7373 6572  ck.        asser
+0002cdd0: 7420 6465 6661 756c 745f 626c 6f63 6b20  t default_block 
+0002cde0: 3d3d 2022 6c61 7465 7374 220a 0a20 2020  == "latest"..   
+0002cdf0: 2020 2020 2023 2063 6865 636b 2073 6574       # check set
+0002ce00: 7465 720a 2020 2020 2020 2020 7733 2e65  ter.        w3.e
+0002ce10: 7468 2e64 6566 6175 6c74 5f62 6c6f 636b  th.default_block
+0002ce20: 203d 2042 6c6f 636b 4e75 6d62 6572 2831   = BlockNumber(1
+0002ce30: 3233 3435 290a 2020 2020 2020 2020 6465  2345).        de
+0002ce40: 6661 756c 745f 626c 6f63 6b20 3d20 7733  fault_block = w3
+0002ce50: 2e65 7468 2e64 6566 6175 6c74 5f62 6c6f  .eth.default_blo
+0002ce60: 636b 0a20 2020 2020 2020 2061 7373 6572  ck.        asser
+0002ce70: 7420 6465 6661 756c 745f 626c 6f63 6b20  t default_block 
+0002ce80: 3d3d 2042 6c6f 636b 4e75 6d62 6572 2831  == BlockNumber(1
+0002ce90: 3233 3435 290a 0a20 2020 2020 2020 2023  2345)..        #
+0002cea0: 2072 6573 6574 2074 6f20 6465 6661 756c   reset to defaul
+0002ceb0: 740a 2020 2020 2020 2020 7733 2e65 7468  t.        w3.eth
+0002cec0: 2e64 6566 6175 6c74 5f62 6c6f 636b 203d  .default_block =
+0002ced0: 2022 6c61 7465 7374 220a                  "latest".
```

### Comparing `web3-7.0.0b3/web3/_utils/module_testing/go_ethereum_admin_module.py` & `web3-7.0.0b4/web3/_utils/module_testing/go_ethereum_admin_module.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/module_testing/go_ethereum_personal_module.py` & `web3-7.0.0b4/web3/_utils/module_testing/go_ethereum_personal_module.py`

 * *Files 0% similar despite different names*

```diff
@@ -58,15 +58,15 @@
         actual = w3.geth.personal.import_raw_key(PRIVATE_KEY_HEX, PASSWORD)
         assert actual == ADDRESS
 
     def test_personal_list_accounts(self, w3: "Web3") -> None:
         accounts = w3.geth.personal.list_accounts()
         assert is_list_like(accounts)
         assert len(accounts) > 0
-        assert all((is_checksum_address(item) for item in accounts))
+        assert all(is_checksum_address(item) for item in accounts)
 
     def test_personal_list_wallets(self, w3: "Web3") -> None:
         wallets = w3.geth.personal.list_wallets()
         assert is_list_like(wallets)
         assert len(wallets) > 0
         assert is_checksum_address(wallets[0]["accounts"][0]["address"])
         assert is_string(wallets[0]["accounts"][0]["url"])
```

### Comparing `web3-7.0.0b3/web3/_utils/module_testing/go_ethereum_txpool_module.py` & `web3-7.0.0b4/web3/_utils/module_testing/go_ethereum_txpool_module.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/module_testing/module_testing_utils.py` & `web3-7.0.0b4/web3/_utils/module_testing/module_testing_utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -3,14 +3,15 @@
 )
 from typing import (
     TYPE_CHECKING,
     Any,
     Collection,
     Dict,
     Generator,
+    Literal,
     Sequence,
     Union,
 )
 
 from aiohttp import (
     ClientTimeout,
 )
@@ -24,17 +25,14 @@
 from flaky import (
     flaky,
 )
 from hexbytes import (
     HexBytes,
 )
 
-from web3._utils.compat import (
-    Literal,
-)
 from web3._utils.request import (
     async_cache_and_return_session,
     cache_and_return_session,
 )
 from web3.types import (
     BlockData,
     LogReceipt,
```

### Comparing `web3-7.0.0b3/web3/_utils/module_testing/net_module.py` & `web3-7.0.0b4/web3/_utils/module_testing/net_module.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/module_testing/persistent_connection_provider.py` & `web3-7.0.0b4/web3/_utils/module_testing/persistent_connection_provider.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/module_testing/utils.py` & `web3-7.0.0b4/web3/_utils/module_testing/utils.py`

 * *Files 8% similar despite different names*

```diff
@@ -32,24 +32,26 @@
 
 class RequestMocker:
     """
     Context manager to mock requests made by a web3 instance. This is meant to be used
     via a ``request_mocker`` fixture defined within the appropriate context.
 
     Example:
+    -------
 
         def test_my_w3(w3, request_mocker):
             assert w3.eth.block_number == 0
 
             with request_mocker(w3, mock_results={"eth_blockNumber": "0x1"}):
                 assert w3.eth.block_number == 1
 
             assert w3.eth.block_number == 0
 
     Example with async and a mocked response object:
+    -----------------------------------------------
 
         async def test_my_w3(async_w3, request_mocker):
             def _iter_responses():
                     while True:
                         yield {"error": {"message": "transaction indexing in progress"}}
                         yield {"error": {"message": "transaction indexing in progress"}}
                         yield {"result": {"status": "0x1"}}
@@ -73,41 +75,44 @@
         "error" object of the RPC response.
     -``mock_responses`` is a dict mapping method names to the entire RPC response
         object. This can be useful if you wish to return an iterator which returns
         different responses on each call to the method.
 
     If a method name is not present in any of the dicts above, the request is made as
     usual.
+
     """
 
     def __init__(
         self,
         w3: Union["AsyncWeb3", "Web3"],
         mock_results: Dict[Union["RPCEndpoint", str], Any] = None,
         mock_errors: Dict[Union["RPCEndpoint", str], Any] = None,
         mock_responses: Dict[Union["RPCEndpoint", str], Any] = None,
     ):
         self.w3 = w3
         self.mock_results = mock_results or {}
         self.mock_errors = mock_errors or {}
         self.mock_responses = mock_responses or {}
-        self._make_request: Union["AsyncMakeRequestFn", "MakeRequestFn"] = (
-            w3.provider.make_request
-        )
+        self._make_request: Union[
+            "AsyncMakeRequestFn", "MakeRequestFn"
+        ] = w3.provider.make_request
 
     def __enter__(self) -> "Self":
-        setattr(self.w3.provider, "make_request", self._mock_request_handler)
+        # mypy error: Cannot assign to a method
+        self.w3.provider.make_request = self._mock_request_handler  # type: ignore[method-assign]  # noqa: E501
         # reset request func cache to re-build request_func with mocked make_request
         self.w3.provider._request_func_cache = (None, None)
 
         return self
 
     # define __exit__ with typing information
     def __exit__(self, exc_type: Any, exc_value: Any, traceback: Any) -> None:
-        setattr(self.w3.provider, "make_request", self._make_request)
+        # mypy error: Cannot assign to a method
+        self.w3.provider.make_request = self._make_request  # type: ignore[method-assign]  # noqa: E501
         # reset request func cache to re-build request_func with original make_request
         self.w3.provider._request_func_cache = (None, None)
 
     def _mock_request_handler(
         self, method: "RPCEndpoint", params: Any
     ) -> "RPCResponse":
         self.w3 = cast("Web3", self.w3)
@@ -159,21 +164,23 @@
                 self.w3.provider, method, params
             )
         else:
             return mocked_response
 
     # -- async -- #
     async def __aenter__(self) -> "Self":
-        setattr(self.w3.provider, "make_request", self._async_mock_request_handler)
+        # mypy error: Cannot assign to a method
+        self.w3.provider.make_request = self._async_mock_request_handler  # type: ignore[method-assign]  # noqa: E501
         # reset request func cache to re-build request_func with mocked make_request
         self.w3.provider._request_func_cache = (None, None)
         return self
 
     async def __aexit__(self, exc_type: Any, exc_value: Any, traceback: Any) -> None:
-        setattr(self.w3.provider, "make_request", self._make_request)
+        # mypy error: Cannot assign to a method
+        self.w3.provider.make_request = self._make_request  # type: ignore[method-assign]  # noqa: E501
         # reset request func cache to re-build request_func with original make_request
         self.w3.provider._request_func_cache = (None, None)
 
     async def _async_mock_request_handler(
         self, method: "RPCEndpoint", params: Any
     ) -> "RPCResponse":
         self.w3 = cast("AsyncWeb3", self.w3)
```

### Comparing `web3-7.0.0b3/web3/_utils/module_testing/web3_module.py` & `web3-7.0.0b4/web3/_utils/module_testing/web3_module.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/normalizers.py` & `web3-7.0.0b4/web3/_utils/normalizers.py`

 * *Files 2% similar despite different names*

```diff
@@ -56,14 +56,15 @@
 from web3._utils.validation import (
     validate_abi,
     validate_address,
 )
 from web3.exceptions import (
     InvalidAddress,
     NameNotFound,
+    Web3ValueError,
 )
 from web3.types import (
     ABI,
 )
 
 if TYPE_CHECKING:
     from web3 import (  # noqa: F401
@@ -147,15 +148,15 @@
 
     bytes_data = hexstr_if_str(to_bytes, data)
     if abi_type.sub is None:
         return type_str, to_hex(bytes_data)
 
     num_bytes = abi_type.sub
     if len(bytes_data) > num_bytes:
-        raise ValueError(
+        raise Web3ValueError(
             f"This value was expected to be at most {num_bytes} bytes, "
             f"but instead was {len(bytes_data)}: {data!r}"
         )
 
     padded = bytes_data.ljust(num_bytes, b"\0")
     return type_str, to_hex(padded)
 
@@ -269,16 +270,15 @@
         validate_address(address)
     return address
 
 
 def normalize_bytecode(bytecode: bytes) -> HexBytes:
     if bytecode:
         bytecode = HexBytes(bytecode)
-    # type ignored b/c bytecode is converted to HexBytes above
-    return bytecode  # type: ignore
+    return bytecode
 
 
 # --- async -- #
 
 
 async def async_abi_ens_resolver(
     async_w3: "AsyncWeb3",
```

### Comparing `web3-7.0.0b3/web3/_utils/request.py` & `web3-7.0.0b4/web3/_utils/request.py`

 * *Files 1% similar despite different names*

```diff
@@ -105,17 +105,17 @@
     kwargs.setdefault("timeout", DEFAULT_TIMEOUT)
     session = cache_and_return_session(endpoint_uri)
     response = session.post(endpoint_uri, *args, **kwargs)
     return response
 
 
 def make_post_request(
-    endpoint_uri: URI, data: Union[bytes, Dict[str, Any]], *args: Any, **kwargs: Any
+    endpoint_uri: URI, data: Union[bytes, Dict[str, Any]], **kwargs: Any
 ) -> bytes:
-    response = get_response_from_post_request(endpoint_uri, data=data, *args, **kwargs)
+    response = get_response_from_post_request(endpoint_uri, data=data, **kwargs)
     response.raise_for_status()
     return response.content
 
 
 def _close_evicted_sessions(evicted_sessions: List[requests.Session]) -> None:
     for evicted_session in evicted_sessions:
         evicted_session.close()
@@ -232,18 +232,18 @@
     kwargs.setdefault("timeout", ClientTimeout(DEFAULT_TIMEOUT))
     session = await async_cache_and_return_session(endpoint_uri)
     response = await session.post(endpoint_uri, *args, **kwargs)
     return response
 
 
 async def async_make_post_request(
-    endpoint_uri: URI, data: Union[bytes, Dict[str, Any]], *args: Any, **kwargs: Any
+    endpoint_uri: URI, data: Union[bytes, Dict[str, Any]], **kwargs: Any
 ) -> bytes:
     response = await async_get_response_from_post_request(
-        endpoint_uri, data=data, *args, **kwargs
+        endpoint_uri, data=data, **kwargs
     )
     response.raise_for_status()
     return await response.read()
 
 
 async def async_get_json_from_client_response(
     response: ClientResponse,
```

### Comparing `web3-7.0.0b3/web3/_utils/rpc_abi.py` & `web3-7.0.0b4/web3/_utils/rpc_abi.py`

 * *Files 1% similar despite different names*

```diff
@@ -20,14 +20,17 @@
 from eth_utils.toolz import (
     curry,
 )
 
 from web3._utils.abi import (
     map_abi_data,
 )
+from web3.exceptions import (
+    Web3TypeError,
+)
 from web3.types import (
     RPCEndpoint,
 )
 
 
 class RPC:
     # admin
@@ -154,14 +157,15 @@
 
 
 TRANSACTION_PARAMS_ABIS = {
     "data": "bytes",
     "from": "address",
     "gas": "uint",
     "gasPrice": "uint",
+    "maxFeePerBlobGas": "uint",
     "maxFeePerGas": "uint",
     "maxPriorityFeePerGas": "uint",
     "nonce": "uint",
     "to": "address",
     "value": "uint",
     "chainId": "uint",
 }
@@ -242,10 +246,10 @@
     for method, abi_types in abis.items():
         if isinstance(abi_types, list):
             yield method, map_abi_data(normalizers, abi_types)
         elif isinstance(abi_types, dict):
             single_dict_formatter = apply_abi_formatters_to_dict(normalizers, abi_types)
             yield method, apply_formatter_at_index(single_dict_formatter, 0)
         else:
-            raise TypeError(
+            raise Web3TypeError(
                 f"ABI definitions must be a list or dictionary, got {abi_types!r}"
             )
```

### Comparing `web3-7.0.0b3/web3/_utils/threads.py` & `web3-7.0.0b4/web3/_utils/threads.py`

 * *Files 4% similar despite different names*

```diff
@@ -8,19 +8,20 @@
 from types import (
     TracebackType,
 )
 from typing import (
     Any,
     Callable,
     Generic,
+    Literal,
     Type,
 )
 
-from web3._utils.compat import (
-    Literal,
+from web3.exceptions import (
+    Web3ValueError,
 )
 from web3.types import (
     TReturn,
 )
 
 
 class Timeout(Exception):
@@ -59,32 +60,32 @@
         if self.seconds is None:
             return ""
         return f"{self.seconds} seconds"
 
     @property
     def expire_at(self) -> int:
         if self.seconds is None:
-            raise ValueError(
+            raise Web3ValueError(
                 "Timeouts with `seconds == None` do not have an expiration time"
             )
         elif self.begun_at is None:
-            raise ValueError("Timeout has not been started")
+            raise Web3ValueError("Timeout has not been started")
         return self.begun_at + self.seconds
 
     def start(self) -> None:
         if self.is_running is not None:
-            raise ValueError("Timeout has already been started")
+            raise Web3ValueError("Timeout has already been started")
         self.begun_at = time.time()
         self.is_running = True
 
     def check(self) -> None:
         if self.is_running is None:
-            raise ValueError("Timeout has not been started")
+            raise Web3ValueError("Timeout has not been started")
         elif self.is_running is False:
-            raise ValueError("Timeout has already been cancelled")
+            raise Web3ValueError("Timeout has already been cancelled")
         elif self.seconds is None:
             return
         elif time.time() > self.expire_at:
             self.is_running = False
             if isinstance(self.exception, type):
                 raise self.exception(str(self))
             elif isinstance(self.exception, Exception):
```

### Comparing `web3-7.0.0b3/web3/_utils/transactions.py` & `web3-7.0.0b4/web3/_utils/transactions.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,11 +1,12 @@
 import math
 from typing import (
     TYPE_CHECKING,
     List,
+    Literal,
     Optional,
     Union,
     cast,
 )
 
 from eth_typing import (
     ChecksumAddress,
@@ -15,24 +16,25 @@
     curry,
     merge,
 )
 from hexbytes import (
     HexBytes,
 )
 
-from web3._utils.compat import (
-    Literal,
-)
 from web3._utils.utility_methods import (
     all_in_dict,
     any_in_dict,
 )
 from web3.constants import (
     DYNAMIC_FEE_TXN_PARAMS,
 )
+from web3.exceptions import (
+    Web3AttributeError,
+    Web3ValueError,
+)
 from web3.types import (
     BlockIdentifier,
     TxData,
     TxParams,
     _Hash32,
 )
 
@@ -103,15 +105,15 @@
     else:
         return transaction
 
 
 @curry
 def fill_transaction_defaults(w3: "Web3", transaction: TxParams) -> TxParams:
     """
-    if w3 is None, fill as much as possible while offline
+    If w3 is None, fill as much as possible while offline
     """
     strategy_based_gas_price = w3.eth.generate_gas_price(transaction)
     is_dynamic_fee_transaction = strategy_based_gas_price is None and (
         "gasPrice" not in transaction  # default to dynamic fee transaction
         or any_in_dict(DYNAMIC_FEE_TXN_PARAMS, transaction)
     )
 
@@ -126,15 +128,15 @@
             ):
                 # do not set default max fees if legacy txn or
                 # gas price if dynamic fee txn
                 continue
 
             if callable(default_getter):
                 if w3 is None:
-                    raise ValueError(
+                    raise Web3ValueError(
                         f"You must specify a '{key}' value in the transaction"
                     )
                 default_val = default_getter(w3, transaction)
             else:
                 default_val = default_getter
 
             defaults[key] = default_val
@@ -156,27 +158,27 @@
     gas_estimate_transaction = cast(TxParams, dict(**transaction))
 
     gas_estimate = w3.eth.estimate_gas(gas_estimate_transaction)
 
     gas_limit = get_block_gas_limit(w3)
 
     if gas_estimate > gas_limit:
-        raise ValueError(
+        raise Web3ValueError(
             "Contract does not appear to be deployable within the "
             f"current network gas limits.  Estimated: {gas_estimate}. "
             f"Current gas limit: {gas_limit}"
         )
 
     return min(gas_limit, gas_estimate + gas_buffer)
 
 
 def get_required_transaction(w3: "Web3", transaction_hash: _Hash32) -> TxData:
     current_transaction = w3.eth.get_transaction(transaction_hash)
     if not current_transaction:
-        raise ValueError(
+        raise Web3ValueError(
             f"Supplied transaction with hash {transaction_hash!r} does not exist"
         )
     return current_transaction
 
 
 def extract_valid_transaction_params(transaction_params: TxData) -> TxParams:
     extracted_params = cast(
@@ -200,15 +202,15 @@
 
     if extracted_params.get("data") is not None:
         if transaction_params.get("input") is not None:
             if extracted_params["data"] != transaction_params["input"]:
                 msg = 'failure to handle this transaction due to both "input: {}" and'
                 msg += ' "data: {}" are populated. You need to resolve this conflict.'
                 err_vals = (transaction_params["input"], extracted_params["data"])
-                raise AttributeError(msg.format(*err_vals))
+                raise Web3AttributeError(msg.format(*err_vals))
             else:
                 return extracted_params
         else:
             return extracted_params
     elif extracted_params.get("data") is None:
         if transaction_params.get("input") is not None:
             return assoc(extracted_params, "data", transaction_params["input"])
@@ -219,32 +221,32 @@
             "Unreachable path: transaction's 'data' is either set or not set"
         )
 
 
 def assert_valid_transaction_params(transaction_params: TxParams) -> None:
     for param in transaction_params:
         if param not in VALID_TRANSACTION_PARAMS:
-            raise ValueError(f"{param} is not a valid transaction parameter")
+            raise Web3ValueError(f"{param} is not a valid transaction parameter")
 
 
 def prepare_replacement_transaction(
     w3: Union["Web3", "AsyncWeb3"],
     original_transaction: TxData,
     replacement_transaction: TxParams,
     gas_multiplier: float = 1.125,
 ) -> TxParams:
     if original_transaction["blockHash"] is not None:
-        raise ValueError(
+        raise Web3ValueError(
             f'Supplied transaction with hash {original_transaction["hash"]!r} '
             "has already been mined"
         )
     if "nonce" in replacement_transaction and (
         replacement_transaction["nonce"] != original_transaction["nonce"]
     ):
-        raise ValueError(
+        raise Web3ValueError(
             "Supplied nonce in new_transaction must match the pending transaction"
         )
 
     if "nonce" not in replacement_transaction:
         replacement_transaction = assoc(
             replacement_transaction, "nonce", original_transaction["nonce"]
         )
@@ -255,15 +257,15 @@
         pass
 
     elif (
         "gasPrice" in replacement_transaction
         and original_transaction["gasPrice"] is not None
     ):
         if replacement_transaction["gasPrice"] <= original_transaction["gasPrice"]:
-            raise ValueError(
+            raise Web3ValueError(
                 "Supplied gas price must exceed existing transaction gas price"
             )
 
     else:
         generated_gas_price = w3.eth.generate_gas_price(replacement_transaction)
         minimum_gas_price = int(
             math.ceil(original_transaction["gasPrice"] * gas_multiplier)
```

### Comparing `web3-7.0.0b3/web3/_utils/type_conversion.py` & `web3-7.0.0b4/web3/_utils/type_conversion.py`

 * *Files 18% similar despite different names*

```diff
@@ -6,22 +6,26 @@
     HexStr,
 )
 from eth_utils import (
     to_bytes,
     to_hex,
 )
 
+from web3.exceptions import (
+    Web3ValueError,
+)
+
 
 def to_hex_if_bytes(val: Union[HexStr, str, bytes, bytearray]) -> HexStr:
     """
     Note: This method does not validate against all cases and is only
     meant to work with bytes and hex strings.
     """
     if isinstance(val, str) and not val.startswith("0x"):
-        raise ValueError(f"Expected a hex string. Got: {val!r}")
+        raise Web3ValueError(f"Expected a hex string. Got: {val!r}")
 
     return to_hex(val) if isinstance(val, (bytes, bytearray)) else to_hex(hexstr=val)
 
 
 def to_bytes_if_hex(val: Union[HexStr, str, bytes, bytearray]) -> bytes:
     """
     Note: This method does not validate against all cases and is only
```

### Comparing `web3-7.0.0b3/web3/_utils/utility_methods.py` & `web3-7.0.0b4/web3/_utils/utility_methods.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/_utils/validation.py` & `web3-7.0.0b4/web3/_utils/validation.py`

 * *Files 10% similar despite different names*

```diff
@@ -49,14 +49,16 @@
     is_string_type,
     is_uint_type,
     length_of_array_type,
     sub_type_of_array_type,
 )
 from web3.exceptions import (
     InvalidAddress,
+    Web3TypeError,
+    Web3ValueError,
 )
 from web3.types import (
     ABI,
     ABIFunction,
 )
 
 
@@ -70,53 +72,53 @@
 
 
 def validate_abi(abi: ABI) -> None:
     """
     Helper function for validating an ABI
     """
     if not is_list_like(abi):
-        raise ValueError("'abi' is not a list")
+        raise Web3ValueError("'abi' is not a list")
 
     if not all(is_dict(e) for e in abi):
-        raise ValueError("'abi' is not a list of dictionaries")
+        raise Web3ValueError("'abi' is not a list of dictionaries")
 
     functions = filter_by_type("function", abi)
     selectors = groupby(compose(encode_hex, function_abi_to_4byte_selector), functions)
     duplicates = valfilter(lambda funcs: len(funcs) > 1, selectors)
     if duplicates:
-        raise ValueError(
+        raise Web3ValueError(
             "Abi contains functions with colliding selectors. "
             f"Functions {_prepare_selector_collision_msg(duplicates)}"
         )
 
 
 def validate_abi_type(abi_type: TypeStr) -> None:
     """
     Helper function for validating an abi_type
     """
     if not is_recognized_type(abi_type):
-        raise ValueError(f"Unrecognized abi_type: {abi_type}")
+        raise Web3ValueError(f"Unrecognized abi_type: {abi_type}")
 
 
 def validate_abi_value(abi_type: TypeStr, value: Any) -> None:
     """
     Helper function for validating a value against the expected abi_type
     Note: abi_type 'bytes' must either be python3 'bytes' object or ''
     """
     if is_array_type(abi_type) and is_list_like(value):
         # validate length
         specified_length = length_of_array_type(abi_type)
         if specified_length is not None:
             if specified_length < 1:
-                raise TypeError(
+                raise Web3TypeError(
                     f"Invalid abi-type: {abi_type}. Length of fixed sized "
                     "arrays must be greater than 0."
                 )
             if specified_length != len(value):
-                raise TypeError(
+                raise Web3TypeError(
                     "The following array length does not the length specified"
                     f"by the abi-type, {abi_type}: {value}"
                 )
 
         # validate sub_types
         sub_type = sub_type_of_array_type(abi_type)
         for v in value:
@@ -134,22 +136,22 @@
     elif is_bytes_type(abi_type):
         if is_bytes(value):
             return
         elif is_string(value):
             if is_0x_prefixed(value):
                 return
             else:
-                raise TypeError(
+                raise Web3TypeError(
                     "ABI values of abi-type 'bytes' must be either"
                     "a python3 'bytes' object or an '0x' prefixed string."
                 )
     elif is_string_type(abi_type) and is_string(value):
         return
 
-    raise TypeError(f"The following abi value is not a '{abi_type}': {value}")
+    raise Web3TypeError(f"The following abi value is not a '{abi_type}': {value}")
 
 
 def is_not_address_string(value: Any) -> bool:
     return (
         is_string(value)
         and not is_bytes(value)
         and not is_checksum_address(value)
@@ -169,15 +171,15 @@
         if not is_binary_address(value):
             raise InvalidAddress(
                 "Address must be 20 bytes when input type is bytes", value
             )
         return
 
     if not isinstance(value, str):
-        raise TypeError(f"Address {value} must be provided as a string")
+        raise Web3TypeError(f"Address {value} must be provided as a string")
     if not is_hex_address(value):
         raise InvalidAddress(
             "Address must be 20 bytes, as a hex string with a 0x prefix", value
         )
     if not is_checksum_address(value):
         if value == value.lower():
             raise InvalidAddress(
@@ -200,11 +202,11 @@
     vals = itertools.chain(args, kwargs.values())
     not_nones = list(filter(lambda val: val is not None, vals))
     return len(not_nones) == 1
 
 
 def assert_one_val(*args: Any, **kwargs: Any) -> None:
     if not has_one_val(*args, **kwargs):
-        raise TypeError(
+        raise Web3TypeError(
             "Exactly one of the passed values can be specified. "
             f"Instead, values were: {args!r}, {kwargs!r}"
         )
```

### Comparing `web3-7.0.0b3/web3/_utils/windows.py` & `web3-7.0.0b4/web3/_utils/windows.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/beacon/api_endpoints.py` & `web3-7.0.0b4/web3/beacon/api_endpoints.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/beacon/async_beacon.py` & `web3-7.0.0b4/web3/beacon/async_beacon.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/beacon/beacon.py` & `web3-7.0.0b4/web3/beacon/beacon.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/constants.py` & `web3-7.0.0b4/web3/constants.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/contract/async_contract.py` & `web3-7.0.0b4/web3/contract/async_contract.py`

 * *Files 2% similar despite different names*

```diff
@@ -78,15 +78,18 @@
     find_functions_by_identifier,
     get_function_by_identifier,
 )
 from web3.exceptions import (
     ABIFunctionNotFound,
     NoABIFound,
     NoABIFunctionsFound,
+    Web3AttributeError,
+    Web3TypeError,
     Web3ValidationError,
+    Web3ValueError,
 )
 from web3.types import (
     ABI,
     BlockIdentifier,
     EventData,
     StateOverride,
     TxParams,
@@ -108,15 +111,16 @@
     async def get_logs(
         self,
         argument_filters: Optional[Dict[str, Any]] = None,
         fromBlock: Optional[BlockIdentifier] = None,
         toBlock: Optional[BlockIdentifier] = None,
         block_hash: Optional[HexBytes] = None,
     ) -> Awaitable[Iterable[EventData]]:
-        """Get events for this contract instance using eth_getLogs API.
+        """
+        Get events for this contract instance using eth_getLogs API.
 
         This is a stateless method, as opposed to createFilter.
         It can be safely called against nodes which do not provide
         eth_newFilter API, like Infura nodes.
 
         If there are many events,
         like ``Transfer`` events for a popular token,
@@ -436,29 +440,30 @@
     # mypy types
     w3: "AsyncWeb3"
 
     #: Instance of :class:`ContractEvents` presenting available Event ABIs
     events: AsyncContractEvents = None
 
     def __init__(self, address: Optional[ChecksumAddress] = None) -> None:
-        """Create a new smart contract proxy object.
-
-        :param address: Contract address as 0x hex string"""
+        """
+        Create a new smart contract proxy object.
 
+        :param address: Contract address as 0x hex string
+        """
         if self.w3 is None:
-            raise AttributeError(
+            raise Web3AttributeError(
                 "The `Contract` class has not been initialized.  Please use the "
                 "`web3.contract` interface to create your contract class."
             )
 
         if address:
             self.address = normalize_address_no_ens(address)
 
         if not self.address:
-            raise TypeError(
+            raise Web3TypeError(
                 "The address argument is required to instantiate a contract."
             )
         self.functions = AsyncContractFunctions(
             self.abi, self.w3, self.address, decode_tuples=self.decode_tuples
         )
         self.caller = AsyncContractCaller(
             self.abi, self.w3, self.address, decode_tuples=self.decode_tuples
@@ -519,15 +524,15 @@
     def constructor(cls, *args: Any, **kwargs: Any) -> "AsyncContractConstructor":
         """
         :param args: The contract constructor arguments as positional arguments
         :param kwargs: The contract constructor arguments as keyword arguments
         :return: a contract constructor object
         """
         if cls.bytecode is None:
-            raise ValueError(
+            raise Web3ValueError(
                 "Cannot call constructor on a contract that does not have "
                 "'bytecode' associated with it"
             )
 
         return AsyncContractConstructor(cls.w3, cls.abi, cls.bytecode, *args, **kwargs)
 
     @combomethod
```

### Comparing `web3-7.0.0b3/web3/contract/base_contract.py` & `web3-7.0.0b4/web3/contract/base_contract.py`

 * *Files 4% similar despite different names*

```diff
@@ -88,15 +88,18 @@
     FallbackNotFound,
     InvalidEventABI,
     LogTopicError,
     MismatchedABI,
     NoABIEventsFound,
     NoABIFound,
     NoABIFunctionsFound,
+    Web3AttributeError,
+    Web3TypeError,
     Web3ValidationError,
+    Web3ValueError,
 )
 from web3.logs import (
     DISCARD,
     IGNORE,
     STRICT,
     WARN,
     EventLogErrorFlags,
@@ -121,15 +124,16 @@
     )
 
     from .async_contract import AsyncContractFunction  # noqa: F401
     from .contract import ContractFunction  # noqa: F401
 
 
 class BaseContractEvent:
-    """Base class for contract events
+    """
+    Base class for contract events
 
     An event accessed via the api `contract.events.myEvents(*args, **kwargs)`
     is a subclass of this class.
     """
 
     address: ChecksumAddress = None
     event_name: str = None
@@ -159,15 +163,15 @@
     @to_tuple
     def _parse_logs(
         self, txn_receipt: TxReceipt, errors: EventLogErrorFlags
     ) -> Iterable[EventData]:
         try:
             errors.name
         except AttributeError:
-            raise AttributeError(
+            raise Web3AttributeError(
                 f"Error flag must be one of: {EventLogErrorFlags.flag_options()}"
             )
 
         for log in txn_receipt["logs"]:
             try:
                 rich_log = get_event_data(self.w3.codec, self.abi, log)
             except (MismatchedABI, LogTopicError, InvalidEventABI, TypeError) as e:
@@ -181,15 +185,16 @@
                 elif errors == STRICT:
                     raise e
                 else:
                     warnings.warn(
                         f"The log with transaction hash: {log['transactionHash']!r} "
                         f"and logIndex: {log['logIndex']} encountered the following "
                         f"error during processing: {type(e).__name__}({e}). It has "
-                        "been discarded."
+                        "been discarded.",
+                        stacklevel=2,
                     )
                     continue
             yield rich_log
 
     @combomethod
     def process_log(self, log: HexStr) -> EventData:
         return get_event_data(self.w3.codec, self.abi, log)
@@ -200,15 +205,15 @@
         abi: ABIEvent,
         argument_filters: Optional[Dict[str, Any]] = None,
         fromBlock: Optional[BlockIdentifier] = None,
         toBlock: Optional[BlockIdentifier] = None,
         blockHash: Optional[HexBytes] = None,
     ) -> FilterParams:
         if not self.address:
-            raise TypeError(
+            raise Web3TypeError(
                 "This method can be only called on "
                 "an instated contract with an address"
             )
 
         if argument_filters is None:
             argument_filters = dict()
 
@@ -247,20 +252,20 @@
         event_abi: ABIEvent, _filters: Dict[str, Any]
     ) -> None:
         name_indexed_inputs = {_input["name"]: _input for _input in event_abi["inputs"]}
 
         for filter_name, filter_value in _filters.items():
             _input = name_indexed_inputs[filter_name]
             if is_array_type(_input["type"]):
-                raise TypeError(
+                raise Web3TypeError(
                     "createFilter no longer supports array type filter arguments. "
                     "see the build_filter method for filtering array type filters."
                 )
             if is_list_like(filter_value) and is_dynamic_sized_type(_input["type"]):
-                raise TypeError(
+                raise Web3TypeError(
                     "createFilter no longer supports setting filter argument options "
                     "for dynamic sized types. See the build_filter method for setting "
                     "filters with the match_any method."
                 )
 
     @staticmethod
     def _process_get_logs_argument_filters(
@@ -317,15 +322,15 @@
         fromBlock: Optional[BlockIdentifier] = None,
         toBlock: BlockIdentifier = "latest",
         address: Optional[ChecksumAddress] = None,
         topics: Optional[Sequence[Any]] = None,
         filter_builder: Union[EventFilterBuilder, AsyncEventFilterBuilder] = None,
     ) -> None:
         if fromBlock is None:
-            raise TypeError(
+            raise Web3TypeError(
                 "Missing mandatory keyword argument to create_filter: fromBlock"
             )
 
         if argument_filters is None:
             argument_filters = dict()
 
         _filters = dict(**argument_filters)
@@ -366,15 +371,16 @@
             and not is_list_like(value)
         }
         for arg, value in match_single_vals.items():
             filter_builder.args[arg].match_single(value)
 
 
 class BaseContractEvents:
-    """Class containing contract event objects
+    """
+    Class containing contract event objects
 
     This is available via:
 
     .. code-block:: python
 
         >>> mycontract.events
         <web3.contract.ContractEvents object at 0x108afde10>
@@ -427,30 +433,32 @@
         else:
             return super().__getattribute__(event_name)
 
     def __getitem__(self, event_name: str) -> Type["BaseContractEvent"]:
         return getattr(self, event_name)
 
     def __iter__(self) -> Iterable[Type["BaseContractEvent"]]:
-        """Iterate over supported
+        """
+        Iterate over supported
 
         :return: Iterable of :class:`ContractEvent`
         """
         for event in self._events:
             yield self[event["name"]]
 
     def __hasattr__(self, event_name: str) -> bool:
         try:
             return event_name in self.__dict__["_events"]
         except ABIEventFunctionNotFound:
             return False
 
 
 class BaseContractFunction:
-    """Base class for contract functions
+    """
+    Base class for contract functions
 
     A function accessed via the api `contract.functions.myMethod(*args, **kwargs)`
     is a subclass of this class.
     """
 
     address: ChecksumAddress = None
     function_identifier: FunctionIdentifier = None
@@ -475,137 +483,129 @@
                 self.function_identifier,
                 self.args,
                 self.kwargs,
             )
         if self.function_identifier in [FallbackFn, ReceiveFn]:
             self.selector = encode_hex(b"")
         elif is_text(self.function_identifier):
-            # https://github.com/python/mypy/issues/4976
-            self.selector = encode_hex(
-                function_abi_to_4byte_selector(self.abi)  # type: ignore
-            )
+            self.selector = encode_hex(function_abi_to_4byte_selector(self.abi))
         else:
-            raise TypeError("Unsupported function identifier")
+            raise Web3TypeError("Unsupported function identifier")
 
         self.arguments = merge_args_and_kwargs(self.abi, self.args, self.kwargs)
 
     def _get_call_txparams(self, transaction: Optional[TxParams] = None) -> TxParams:
         if transaction is None:
             call_transaction: TxParams = {}
         else:
             call_transaction = cast(TxParams, dict(**transaction))
 
         if "data" in call_transaction:
-            raise ValueError("Cannot set 'data' field in call transaction")
+            raise Web3ValueError("Cannot set 'data' field in call transaction")
 
         if self.address:
             call_transaction.setdefault("to", self.address)
         if self.w3.eth.default_account is not empty:
-            # type ignored b/c check prevents an empty default_account
             call_transaction.setdefault(
                 "from",
-                self.w3.eth.default_account,  # type: ignore
+                self.w3.eth.default_account,
             )
 
         if "to" not in call_transaction:
             if isinstance(self, type):
-                raise ValueError(
+                raise Web3ValueError(
                     "When using `Contract.[methodtype].[method].call()` from"
                     " a contract factory you "
                     "must provide a `to` address with the transaction"
                 )
             else:
-                raise ValueError(
+                raise Web3ValueError(
                     "Please ensure that this contract instance has an address."
                 )
 
         return call_transaction
 
     def _transact(self, transaction: Optional[TxParams] = None) -> TxParams:
         if transaction is None:
             transact_transaction: TxParams = {}
         else:
             transact_transaction = cast(TxParams, dict(**transaction))
 
         if "data" in transact_transaction:
-            raise ValueError("Cannot set 'data' field in transact transaction")
+            raise Web3ValueError("Cannot set 'data' field in transact transaction")
 
         if self.address is not None:
             transact_transaction.setdefault("to", self.address)
         if self.w3.eth.default_account is not empty:
-            # type ignored b/c check prevents an empty default_account
-            transact_transaction.setdefault(
-                "from", self.w3.eth.default_account  # type: ignore
-            )
+            transact_transaction.setdefault("from", self.w3.eth.default_account)
 
         if "to" not in transact_transaction:
             if isinstance(self, type):
-                raise ValueError(
+                raise Web3ValueError(
                     "When using `Contract.transact` from a contract factory you "
                     "must provide a `to` address with the transaction"
                 )
             else:
-                raise ValueError(
+                raise Web3ValueError(
                     "Please ensure that this contract instance has an address."
                 )
         return transact_transaction
 
     def _estimate_gas(self, transaction: Optional[TxParams] = None) -> TxParams:
         if transaction is None:
             estimate_gas_transaction: TxParams = {}
         else:
             estimate_gas_transaction = cast(TxParams, dict(**transaction))
 
         if "data" in estimate_gas_transaction:
-            raise ValueError("Cannot set 'data' field in estimate_gas transaction")
+            raise Web3ValueError("Cannot set 'data' field in estimate_gas transaction")
         if "to" in estimate_gas_transaction:
-            raise ValueError("Cannot set to in estimate_gas transaction")
+            raise Web3ValueError("Cannot set to in estimate_gas transaction")
 
         if self.address:
             estimate_gas_transaction.setdefault("to", self.address)
         if self.w3.eth.default_account is not empty:
-            # type ignored b/c check prevents an empty default_account
-            estimate_gas_transaction.setdefault(
-                "from", self.w3.eth.default_account  # type: ignore
-            )
+            estimate_gas_transaction.setdefault("from", self.w3.eth.default_account)
 
         if "to" not in estimate_gas_transaction:
             if isinstance(self, type):
-                raise ValueError(
+                raise Web3ValueError(
                     "When using `Contract.estimate_gas` from a contract factory "
                     "you must provide a `to` address with the transaction"
                 )
             else:
-                raise ValueError(
+                raise Web3ValueError(
                     "Please ensure that this contract instance has an address."
                 )
         return estimate_gas_transaction
 
     def _build_transaction(self, transaction: Optional[TxParams] = None) -> TxParams:
         if transaction is None:
             built_transaction: TxParams = {}
         else:
             built_transaction = cast(TxParams, dict(**transaction))
 
         if "data" in built_transaction:
-            raise ValueError("Cannot set 'data' field in build transaction")
+            raise Web3ValueError("Cannot set 'data' field in build transaction")
 
         if not self.address and "to" not in built_transaction:
-            raise ValueError(
+            raise Web3ValueError(
                 "When using `ContractFunction.build_transaction` from a contract "
                 "factory you must provide a `to` address with the transaction"
             )
         if self.address and "to" in built_transaction:
-            raise ValueError("Cannot set 'to' field in contract call build transaction")
+            raise Web3ValueError(
+                "Cannot set 'to' field in contract call build transaction"
+            )
 
         if self.address:
             built_transaction.setdefault("to", self.address)
 
         if "to" not in built_transaction:
-            raise ValueError(
+            raise Web3ValueError(
                 "Please ensure that this contract instance has an address."
             )
 
         return built_transaction
 
     @combomethod
     def _encode_transaction_data(cls) -> HexStr:
@@ -675,15 +675,16 @@
         try:
             return function_name in self.__dict__["_functions"]
         except ABIFunctionNotFound:
             return False
 
 
 class BaseContract:
-    """Base class for Contract proxy classes.
+    """
+    Base class for Contract proxy classes.
 
     First you need to create your Contract classes using
     :meth:`web3.eth.Eth.contract` that takes compiled Solidity contract
     ABI definitions as input.  The created class object will be a subclass of
     this base class.
 
     After you have your Contract proxy class created you can interact with
@@ -756,15 +757,15 @@
         return self.find_functions_by_identifier(
             self.abi, self.w3, self.address, lambda _: True
         )
 
     @combomethod
     def get_function_by_signature(self, signature: str) -> "BaseContractFunction":
         if " " in signature:
-            raise ValueError(
+            raise Web3ValueError(
                 "Function signature should not contain any spaces. "
                 f"Found spaces in input: {signature}"
             )
 
         def callable_check(fn_abi: ABIFunction) -> bool:
             return abi_to_signature(fn_abi) == signature
 
@@ -788,29 +789,28 @@
         return self.get_function_by_identifier(fns, "name")
 
     @combomethod
     def get_function_by_selector(
         self, selector: Union[bytes, int, HexStr]
     ) -> "BaseContractFunction":
         def callable_check(fn_abi: ABIFunction) -> bool:
-            # typed dict cannot be used w/ a normal Dict
-            # https://github.com/python/mypy/issues/4976
-            return encode_hex(function_abi_to_4byte_selector(fn_abi)) == to_4byte_hex(selector)  # type: ignore # noqa: E501
+            return encode_hex(function_abi_to_4byte_selector(fn_abi)) == to_4byte_hex(
+                selector
+            )
 
         fns = self.find_functions_by_identifier(
             self.abi, self.w3, self.address, callable_check
         )
         return self.get_function_by_identifier(fns, "selector")
 
     @combomethod
     def decode_function_input(
         self, data: HexStr
     ) -> Tuple["BaseContractFunction", Dict[str, Any]]:
-        # type ignored b/c expects data arg to be HexBytes
-        data = HexBytes(data)  # type: ignore
+        data = HexBytes(data)
         func = self.get_function_by_selector(data[:4])
         arguments = decode_transaction_data(
             func.abi, data, normalizers=BASE_RETURN_NORMALIZERS
         )
         return func, arguments
 
     @combomethod
@@ -889,15 +889,15 @@
 
             deploy_data = add_0x_prefix(
                 encode_abi(cls.w3, constructor_abi, arguments, data=cls.bytecode)
             )
         else:
             if args is not None or kwargs is not None:
                 msg = "Constructor args were provided, but no constructor function was provided."  # noqa: E501
-                raise TypeError(msg)
+                raise Web3TypeError(msg)
 
             deploy_data = to_hex(cls.bytecode)
 
         return deploy_data
 
     @combomethod
     def find_functions_by_identifier(
@@ -1084,18 +1084,15 @@
         else:
             estimate_gas_transaction = cast(TxParams, dict(**transaction))
             self.check_forbidden_keys_in_transaction(
                 estimate_gas_transaction, ["data", "to"]
             )
 
         if self.w3.eth.default_account is not empty:
-            # type ignored b/c check prevents an empty default_account
-            estimate_gas_transaction.setdefault(
-                "from", self.w3.eth.default_account  # type: ignore
-            )
+            estimate_gas_transaction.setdefault("from", self.w3.eth.default_account)
 
         estimate_gas_transaction["data"] = self.data_in_transaction
 
         return estimate_gas_transaction
 
     def _get_transaction(self, transaction: Optional[TxParams] = None) -> TxParams:
         if transaction is None:
@@ -1103,18 +1100,15 @@
         else:
             transact_transaction = cast(TxParams, dict(**transaction))
             self.check_forbidden_keys_in_transaction(
                 transact_transaction, ["data", "to"]
             )
 
         if self.w3.eth.default_account is not empty:
-            # type ignored b/c check prevents an empty default_account
-            transact_transaction.setdefault(
-                "from", self.w3.eth.default_account  # type: ignore
-            )
+            transact_transaction.setdefault("from", self.w3.eth.default_account)
 
         transact_transaction["data"] = self.data_in_transaction
 
         return transact_transaction
 
     @combomethod
     def _build_transaction(self, transaction: Optional[TxParams] = None) -> TxParams:
@@ -1124,15 +1118,15 @@
 
     @staticmethod
     def check_forbidden_keys_in_transaction(
         transaction: TxParams, forbidden_keys: Optional[Collection[str]] = None
     ) -> None:
         keys_found = transaction.keys() & forbidden_keys
         if keys_found:
-            raise ValueError(
+            raise Web3ValueError(
                 f"Cannot set '{', '.join(keys_found)}' field(s) in transaction"
             )
 
 
 class NonExistentFallbackFunction:
     @staticmethod
     def _raise_exception() -> NoReturn:
```

### Comparing `web3-7.0.0b3/web3/contract/contract.py` & `web3-7.0.0b4/web3/contract/contract.py`

 * *Files 0% similar despite different names*

```diff
@@ -77,15 +77,18 @@
     get_function_by_identifier,
     transact_with_contract_function,
 )
 from web3.exceptions import (
     ABIFunctionNotFound,
     NoABIFound,
     NoABIFunctionsFound,
+    Web3AttributeError,
+    Web3TypeError,
     Web3ValidationError,
+    Web3ValueError,
 )
 from web3.types import (
     ABI,
     BlockIdentifier,
     EventData,
     StateOverride,
     TxParams,
@@ -107,15 +110,16 @@
     def get_logs(
         self,
         argument_filters: Optional[Dict[str, Any]] = None,
         fromBlock: Optional[BlockIdentifier] = None,
         toBlock: Optional[BlockIdentifier] = None,
         block_hash: Optional[HexBytes] = None,
     ) -> Iterable[EventData]:
-        """Get events for this contract instance using eth_getLogs API.
+        """
+        Get events for this contract instance using eth_getLogs API.
 
         This is a stateless method, as opposed to create_filter.
         It can be safely called against nodes which do not provide
         eth_newFilter API, like Infura nodes.
 
         If there are many events,
         like ``Transfer`` events for a popular token,
@@ -434,28 +438,30 @@
     functions: ContractFunctions = None
     caller: "ContractCaller" = None
 
     # Instance of :class:`ContractEvents` presenting available Event ABIs
     events: ContractEvents = None
 
     def __init__(self, address: Optional[ChecksumAddress] = None) -> None:
-        """Create a new smart contract proxy object.
-        :param address: Contract address as 0x hex string"""
+        """
+        Create a new smart contract proxy object.
+        :param address: Contract address as 0x hex string
+        """
         _w3 = self.w3
         if _w3 is None:
-            raise AttributeError(
+            raise Web3AttributeError(
                 "The `Contract` class has not been initialized.  Please use the "
                 "`web3.contract` interface to create your contract class."
             )
 
         if address:
             self.address = normalize_address(cast("ENS", _w3.ens), address)
 
         if not self.address:
-            raise TypeError(
+            raise Web3TypeError(
                 "The address argument is required to instantiate a contract."
             )
 
         self.functions = ContractFunctions(
             self.abi, _w3, self.address, decode_tuples=self.decode_tuples
         )
         self.caller = ContractCaller(
@@ -524,15 +530,15 @@
     def constructor(cls, *args: Any, **kwargs: Any) -> "ContractConstructor":
         """
         :param args: The contract constructor arguments as positional arguments
         :param kwargs: The contract constructor arguments as keyword arguments
         :return: a contract constructor object
         """
         if cls.bytecode is None:
-            raise ValueError(
+            raise Web3ValueError(
                 "Cannot call constructor on a contract that does not have "
                 "'bytecode' associated with it"
             )
 
         return ContractConstructor(cls.w3, cls.abi, cls.bytecode, *args, **kwargs)
 
     @combomethod
```

### Comparing `web3-7.0.0b3/web3/contract/utils.py` & `web3-7.0.0b4/web3/contract/utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -39,14 +39,15 @@
     BASE_RETURN_NORMALIZERS,
 )
 from web3._utils.transactions import (
     fill_transaction_defaults,
 )
 from web3.exceptions import (
     BadFunctionCallOutput,
+    Web3ValueError,
 )
 from web3.types import (
     ABI,
     ABIFunction,
     BlockIdentifier,
     FunctionIdentifier,
     StateOverride,
@@ -181,15 +182,16 @@
     contract_abi: Optional[ABI] = None,
     fn_abi: Optional[ABIFunction] = None,
     block_identifier: Optional[BlockIdentifier] = None,
     state_override: Optional[StateOverride] = None,
     *args: Any,
     **kwargs: Any,
 ) -> int:
-    """Estimates gas cost a function call would take.
+    """
+    Estimates gas cost a function call would take.
 
     Don't call this directly, instead use :meth:`Contract.estimate_gas`
     on your contract instance.
     """
     estimate_transaction = prepare_transaction(
         address,
         w3,
@@ -210,15 +212,16 @@
     function_name: Optional[FunctionIdentifier] = None,
     transaction: Optional[TxParams] = None,
     contract_abi: Optional[ABI] = None,
     fn_abi: Optional[ABIFunction] = None,
     *args: Any,
     **kwargs: Any,
 ) -> TxParams:
-    """Builds a dictionary with the fields required to make the given transaction
+    """
+    Builds a dictionary with the fields required to make the given transaction
 
     Don't call this directly, instead use :meth:`Contract.build_transaction`
     on your contract instance.
     """
     prepared_transaction = prepare_transaction(
         address,
         w3,
@@ -257,19 +260,19 @@
     ]
 
 
 def get_function_by_identifier(
     fns: Sequence[TContractFn], identifier: str
 ) -> TContractFn:
     if len(fns) > 1:
-        raise ValueError(
+        raise Web3ValueError(
             f"Found multiple functions with matching {identifier}. " f"Found: {fns!r}"
         )
     elif len(fns) == 0:
-        raise ValueError(f"Could not find any function with matching {identifier}")
+        raise Web3ValueError(f"Could not find any function with matching {identifier}")
     return fns[0]
 
 
 # --- async --- #
 
 
 async def async_call_contract_function(
@@ -390,15 +393,16 @@
     contract_abi: Optional[ABI] = None,
     fn_abi: Optional[ABIFunction] = None,
     block_identifier: Optional[BlockIdentifier] = None,
     state_override: Optional[StateOverride] = None,
     *args: Any,
     **kwargs: Any,
 ) -> int:
-    """Estimates gas cost a function call would take.
+    """
+    Estimates gas cost a function call would take.
 
     Don't call this directly, instead use :meth:`Contract.estimate_gas`
     on your contract instance.
     """
     estimate_transaction = prepare_transaction(
         address,
         async_w3,
@@ -421,15 +425,16 @@
     function_name: Optional[FunctionIdentifier] = None,
     transaction: Optional[TxParams] = None,
     contract_abi: Optional[ABI] = None,
     fn_abi: Optional[ABIFunction] = None,
     *args: Any,
     **kwargs: Any,
 ) -> TxParams:
-    """Builds a dictionary with the fields required to make the given transaction
+    """
+    Builds a dictionary with the fields required to make the given transaction
 
     Don't call this directly, instead use :meth:`Contract.build_transaction`
     on your contract instance.
     """
     prepared_transaction = prepare_transaction(
         address,
         async_w3,
```

### Comparing `web3-7.0.0b3/web3/datastructures.py` & `web3-7.0.0b4/web3/datastructures.py`

 * *Files 3% similar despite different names*

```diff
@@ -24,14 +24,19 @@
 from eth_utils import (
     is_integer,
 )
 
 from web3._utils.formatters import (
     recursive_map,
 )
+from web3.exceptions import (
+    Web3AssertionError,
+    Web3TypeError,
+    Web3ValueError,
+)
 
 # Hashable must be immutable:
 # "the implementation of hashable collections requires that a
 # key's hash value is immutable"
 # https://docs.python.org/3/reference/datamodel.html#object.__hash__
 
 T = TypeVar("T")
@@ -81,42 +86,47 @@
             # error: Too many arguments for "object"
             return cls(value)  # type: ignore
         else:
             return value
 
     @classmethod
     def recursive(cls, value: TValue) -> "ReadableAttributeDict[TKey, TValue]":
-        return recursive_map(cls._apply_if_mapping, value)
+        return cast(
+            "ReadableAttributeDict[TKey, TValue]",
+            recursive_map(cls._apply_if_mapping, value),
+        )
 
 
 class MutableAttributeDict(
     MutableMapping[TKey, TValue], ReadableAttributeDict[TKey, TValue]
 ):
     def __setitem__(self, key: Any, val: Any) -> None:
         self.__dict__[key] = val
 
     def __delitem__(self, key: Any) -> None:
         del self.__dict__[key]
 
 
 class AttributeDict(ReadableAttributeDict[TKey, TValue], Hashable):
     """
-    This provides superficial immutability, someone could hack around it
+    Provides superficial immutability, someone could hack around it
     """
 
     def __setattr__(self, attr: str, val: TValue) -> None:
         if attr == "__dict__":
             super().__setattr__(attr, val)
         else:
-            raise TypeError(
+            raise Web3TypeError(
                 "This data is immutable -- create a copy instead of modifying"
             )
 
     def __delattr__(self, key: str) -> None:
-        raise TypeError("This data is immutable -- create a copy instead of modifying")
+        raise Web3TypeError(
+            "This data is immutable -- create a copy instead of modifying"
+        )
 
     def __hash__(self) -> int:
         return hash(tuple(sorted(tupleize_lists_nested(self).items())))
 
     def __eq__(self, other: Any) -> bool:
         if isinstance(other, AttributeDict):
             return hash(self) == hash(other)
@@ -139,15 +149,15 @@
     ret = dict()
     for k, v in d.items():
         if isinstance(v, (list, tuple)):
             ret[k] = _to_tuple(v)
         elif isinstance(v, Mapping):
             ret[k] = tupleize_lists_nested(v)
         elif not isinstance(v, Hashable):
-            raise TypeError(f"Found unhashable type '{type(v).__name__}': {v}")
+            raise Web3TypeError(f"Found unhashable type '{type(v).__name__}': {v}")
         else:
             ret[k] = v
     return AttributeDict(ret)
 
 
 class NamedElementOnion(Mapping[TKey, TValue]):
     """
@@ -172,17 +182,17 @@
         if name is None:
             name = cast(TKey, element)
 
         name = self._repr_if_not_hashable(name)
 
         if name in self._queue:
             if name is element:
-                raise ValueError("You can't add the same un-named instance twice")
+                raise Web3ValueError("You can't add the same un-named instance twice")
             else:
-                raise ValueError(
+                raise Web3ValueError(
                     "You can't add the same name again, use replace instead"
                 )
 
         self._queue[name] = element
 
     def inject(
         self, element: TValue, name: Optional[TKey] = None, layer: Optional[int] = None
@@ -191,15 +201,15 @@
         Inject a named element to an arbitrary layer in the onion.
 
         The current implementation only supports insertion at the innermost layer,
         or at the outermost layer. Note that inserting to the outermost is equivalent
         to calling :meth:`add` .
         """
         if not is_integer(layer):
-            raise TypeError("The layer for insertion must be an int.")
+            raise Web3TypeError("The layer for insertion must be an int.")
         elif layer != 0 and layer != len(self._queue):
             raise NotImplementedError(
                 f"You can only insert to the beginning or end of a {type(self)}, "
                 f"currently. You tried to insert to {layer}, but only 0 and "
                 f"{len(self._queue)} are permitted. "
             )
 
@@ -211,26 +221,26 @@
 
             name = self._repr_if_not_hashable(name)
 
             self._queue.move_to_end(name, last=False)
         elif layer == len(self._queue):
             return
         else:
-            raise AssertionError(
+            raise Web3AssertionError(
                 "Impossible to reach: earlier validation raises an error"
             )
 
     def clear(self) -> None:
         self._queue.clear()
 
     def replace(self, old: TKey, new: TKey) -> TValue:
         old_name = self._repr_if_not_hashable(old)
 
         if old_name not in self._queue:
-            raise ValueError(
+            raise Web3ValueError(
                 "You can't replace unless one already exists, use add instead"
             )
 
         to_be_replaced = self._queue[old_name]
         if to_be_replaced is old:
             # re-insert with new name in old slot
             self._replace_with_new_name(old, new)
@@ -244,15 +254,15 @@
         except TypeError:
             value = cast(TKey, repr(value))
         return value
 
     def remove(self, old: TKey) -> None:
         old_name = self._repr_if_not_hashable(old)
         if old_name not in self._queue:
-            raise ValueError("You can only remove something that has been added")
+            raise Web3ValueError("You can only remove something that has been added")
         del self._queue[old_name]
 
     @property
     def middleware(self) -> Sequence[Any]:
         """
         Returns middleware in the appropriate order to be imported into a new Web3
         instance (reversed _queue order) as a list of (middleware, name) tuples.
@@ -306,15 +316,15 @@
         if not isinstance(elements, Sequence):
             # type ignored b/c elements is set as _OrderedDictValuesView[Any] on 210
             elements = list(elements)  # type: ignore
         return reversed(elements)
 
     def as_tuple_of_middleware(self) -> Tuple[TValue, ...]:
         """
-        This helps with type hinting since we return `Iterator[TKey]` type, though it's
+        Helps with type hinting since we return `Iterator[TKey]` type, though it's
         actually a `Iterator[TValue]` type, for the `__iter__()` method. This is in
         order to satisfy the `Mapping` interface.
         """
         return tuple(self._reversed_middleware())
 
     def __iter__(self) -> Iterator[TKey]:
         # ``__iter__()`` for a ``Mapping``  returns ``Iterator[TKey]`` but this
```

### Comparing `web3-7.0.0b3/web3/eth/async_eth.py` & `web3-7.0.0b4/web3/eth/async_eth.py`

 * *Files 1% similar despite different names*

```diff
@@ -59,14 +59,15 @@
 from web3.exceptions import (
     MethodUnavailable,
     OffchainLookup,
     TimeExhausted,
     TooManyRequests,
     TransactionIndexingInProgress,
     TransactionNotFound,
+    Web3ValueError,
 )
 from web3.method import (
     Method,
     default_root_munger,
 )
 from web3.providers import (
     PersistentConnectionProvider,
@@ -103,17 +104,17 @@
 
 class AsyncEth(BaseEth):
     # mypy types
     w3: "AsyncWeb3"
 
     is_async = True
 
-    _default_contract_factory: Type[Union[AsyncContract, AsyncContractCaller]] = (
-        AsyncContract
-    )
+    _default_contract_factory: Type[
+        Union[AsyncContract, AsyncContractCaller]
+    ] = AsyncContract
 
     # eth_accounts
 
     _accounts: Method[Callable[[], Awaitable[Tuple[ChecksumAddress]]]] = Method(
         RPC.eth_accounts,
         is_property=True,
     )
@@ -192,15 +193,16 @@
         an eth_feeHistory calculation with min and max caps.
         """
         try:
             return await self._max_priority_fee()
         except (ValueError, MethodUnavailable):
             warnings.warn(
                 "There was an issue with the method eth_maxPriorityFeePerGas. "
-                "Calculating using eth_feeHistory."
+                "Calculating using eth_feeHistory.",
+                stacklevel=2,
             )
             return await async_fee_history_priority_fee(self)
 
     # eth_mining
 
     _mining: Method[Callable[[], Awaitable[bool]]] = Method(
         RPC.eth_mining,
@@ -279,15 +281,15 @@
         transaction: TxParams,
         block_identifier: Optional[BlockIdentifier] = None,
         state_override: Optional[StateOverride] = None,
     ) -> HexBytes:
         max_redirects = self.w3.provider.ccip_read_max_redirects
 
         if not max_redirects or max_redirects < 4:
-            raise ValueError(
+            raise Web3ValueError(
                 "ccip_read_max_redirects property on provider must be at least 4."
             )
 
         for _ in range(max_redirects):
             try:
                 return await self._call(transaction, block_identifier, state_override)
             except OffchainLookup as offchain_lookup:
@@ -387,23 +389,23 @@
         self, block_identifier: BlockIdentifier, index: int
     ) -> HexBytes:
         return await self._get_raw_transaction_by_block(block_identifier, index)
 
     # eth_getBlockTransactionCountByHash
     # eth_getBlockTransactionCountByNumber
 
-    get_block_transaction_count: Method[Callable[[BlockIdentifier], Awaitable[int]]] = (
-        Method(
-            method_choice_depends_on_args=select_method_for_block_identifier(
-                if_predefined=RPC.eth_getBlockTransactionCountByNumber,
-                if_hash=RPC.eth_getBlockTransactionCountByHash,
-                if_number=RPC.eth_getBlockTransactionCountByNumber,
-            ),
-            mungers=[default_root_munger],
-        )
+    get_block_transaction_count: Method[
+        Callable[[BlockIdentifier], Awaitable[int]]
+    ] = Method(
+        method_choice_depends_on_args=select_method_for_block_identifier(
+            if_predefined=RPC.eth_getBlockTransactionCountByNumber,
+            if_hash=RPC.eth_getBlockTransactionCountByHash,
+            if_number=RPC.eth_getBlockTransactionCountByNumber,
+        ),
+        mungers=[default_root_munger],
     )
 
     # eth_sendTransaction
 
     _send_transaction: Method[Callable[[TxParams], Awaitable[HexBytes]]] = Method(
         RPC.eth_sendTransaction, mungers=[BaseEth.send_transaction_munger]
     )
@@ -422,23 +424,23 @@
 
     async def send_raw_transaction(self, transaction: Union[HexStr, bytes]) -> HexBytes:
         return await self._send_raw_transaction(transaction)
 
     # eth_getBlockByHash
     # eth_getBlockByNumber
 
-    _get_block: Method[Callable[[BlockIdentifier, bool], Awaitable[BlockData]]] = (
-        Method(
-            method_choice_depends_on_args=select_method_for_block_identifier(
-                if_predefined=RPC.eth_getBlockByNumber,
-                if_hash=RPC.eth_getBlockByHash,
-                if_number=RPC.eth_getBlockByNumber,
-            ),
-            mungers=[BaseEth.get_block_munger],
-        )
+    _get_block: Method[
+        Callable[[BlockIdentifier, bool], Awaitable[BlockData]]
+    ] = Method(
+        method_choice_depends_on_args=select_method_for_block_identifier(
+            if_predefined=RPC.eth_getBlockByNumber,
+            if_hash=RPC.eth_getBlockByHash,
+            if_number=RPC.eth_getBlockByNumber,
+        ),
+        mungers=[BaseEth.get_block_munger],
     )
 
     async def get_block(
         self, block_identifier: BlockIdentifier, full_transactions: bool = False
     ) -> BlockData:
         return await self._get_block(block_identifier, full_transactions)
 
@@ -677,17 +679,17 @@
             if_new_filter=RPC.eth_newFilter,
         ),
         mungers=[BaseEth.filter_munger],
     )
 
     # eth_getFilterChanges, eth_getFilterLogs, eth_uninstallFilter
 
-    _get_filter_changes: Method[Callable[[HexStr], Awaitable[List[LogReceipt]]]] = (
-        Method(RPC.eth_getFilterChanges, mungers=[default_root_munger])
-    )
+    _get_filter_changes: Method[
+        Callable[[HexStr], Awaitable[List[LogReceipt]]]
+    ] = Method(RPC.eth_getFilterChanges, mungers=[default_root_munger])
 
     async def get_filter_changes(self, filter_id: HexStr) -> List[LogReceipt]:
         return await self._get_filter_changes(filter_id)
 
     _get_filter_logs: Method[Callable[[HexStr], Awaitable[List[LogReceipt]]]] = Method(
         RPC.eth_getFilterLogs, mungers=[default_root_munger]
     )
@@ -757,20 +759,23 @@
             )
 
         return await self._unsubscribe(subscription_id)
 
     # -- contract methods -- #
 
     @overload
-    def contract(self, address: None = None, **kwargs: Any) -> Type[AsyncContract]: ...
+    # mypy error: Overloaded function signatures 1 and 2 overlap with incompatible return types  # noqa: E501
+    def contract(self, address: None = None, **kwargs: Any) -> Type[AsyncContract]:  # type: ignore[misc]  # noqa: E501
+        ...
 
     @overload
     def contract(
         self, address: Union[Address, ChecksumAddress, ENS], **kwargs: Any
-    ) -> AsyncContract: ...
+    ) -> AsyncContract:
+        ...
 
     def contract(
         self,
         address: Optional[Union[Address, ChecksumAddress, ENS]] = None,
         **kwargs: Any,
     ) -> Union[Type[AsyncContract], AsyncContract]:
         ContractFactoryClass = kwargs.pop(
```

### Comparing `web3-7.0.0b3/web3/eth/base_eth.py` & `web3-7.0.0b4/web3/eth/base_eth.py`

 * *Files 2% similar despite different names*

```diff
@@ -26,14 +26,18 @@
 from web3._utils.empty import (
     Empty,
     empty,
 )
 from web3._utils.encoding import (
     to_hex,
 )
+from web3.exceptions import (
+    Web3TypeError,
+    Web3ValueError,
+)
 from web3.module import (
     Module,
 )
 from web3.types import (
     ENS,
     BlockIdentifier,
     FilterParams,
@@ -190,29 +194,29 @@
 
     def filter_munger(
         self,
         filter_params: Optional[Union[str, FilterParams]] = None,
         filter_id: Optional[HexStr] = None,
     ) -> Union[List[FilterParams], List[HexStr], List[str]]:
         if filter_id and filter_params:
-            raise TypeError(
+            raise Web3TypeError(
                 "Ambiguous invocation: provide either a `filter_params` or a "
                 "`filter_id` argument. Both were supplied."
             )
         if isinstance(filter_params, dict):
             return [filter_params]
         elif is_string(filter_params):
             if filter_params in {"latest", "pending"}:
                 return [filter_params]
             else:
-                raise ValueError(
+                raise Web3ValueError(
                     "The filter API only accepts the values of `pending` or "
                     "`latest` for string based filters"
                 )
         elif filter_id and not filter_params:
             return [filter_id]
         else:
-            raise TypeError(
+            raise Web3TypeError(
                 "Must provide either filter_params as a string or "
                 "a valid filter object, or a filter_id as a string "
                 "or hex."
             )
```

### Comparing `web3-7.0.0b3/web3/eth/eth.py` & `web3-7.0.0b4/web3/eth/eth.py`

 * *Files 1% similar despite different names*

```diff
@@ -59,14 +59,15 @@
 from web3.exceptions import (
     MethodUnavailable,
     OffchainLookup,
     TimeExhausted,
     TooManyRequests,
     TransactionIndexingInProgress,
     TransactionNotFound,
+    Web3ValueError,
 )
 from web3.method import (
     Method,
     default_root_munger,
 )
 from web3.types import (
     ENS,
@@ -185,15 +186,16 @@
         an eth_feeHistory calculation with min and max caps.
         """
         try:
             return self._max_priority_fee()
         except (ValueError, MethodUnavailable):
             warnings.warn(
                 "There was an issue with the method eth_maxPriorityFeePerGas. "
-                "Calculating using eth_feeHistory."
+                "Calculating using eth_feeHistory.",
+                stacklevel=2,
             )
             return fee_history_priority_fee(self)
 
     # eth_mining
 
     _mining: Method[Callable[[], bool]] = Method(
         RPC.eth_mining,
@@ -267,15 +269,15 @@
         transaction: TxParams,
         block_identifier: Optional[BlockIdentifier] = None,
         state_override: Optional[StateOverride] = None,
     ) -> HexBytes:
         max_redirects = self.w3.provider.ccip_read_max_redirects
 
         if not max_redirects or max_redirects < 4:
-            raise ValueError(
+            raise Web3ValueError(
                 "ccip_read_max_redirects property on provider must be at least 4."
             )
 
         for _ in range(max_redirects):
             try:
                 return self._call(transaction, block_identifier, state_override)
             except OffchainLookup as offchain_lookup:
@@ -627,23 +629,23 @@
     ] = Method(
         RPC.eth_signTypedData,
         mungers=[default_root_munger],
     )
 
     # eth_newFilter, eth_newBlockFilter, eth_newPendingTransactionFilter
 
-    filter: Method[Callable[[Optional[Union[str, FilterParams, HexStr]]], Filter]] = (
-        Method(
-            method_choice_depends_on_args=select_filter_method(
-                if_new_block_filter=RPC.eth_newBlockFilter,
-                if_new_pending_transaction_filter=RPC.eth_newPendingTransactionFilter,
-                if_new_filter=RPC.eth_newFilter,
-            ),
-            mungers=[BaseEth.filter_munger],
-        )
+    filter: Method[
+        Callable[[Optional[Union[str, FilterParams, HexStr]]], Filter]
+    ] = Method(
+        method_choice_depends_on_args=select_filter_method(
+            if_new_block_filter=RPC.eth_newBlockFilter,
+            if_new_pending_transaction_filter=RPC.eth_newPendingTransactionFilter,
+            if_new_filter=RPC.eth_newFilter,
+        ),
+        mungers=[BaseEth.filter_munger],
     )
 
     # eth_getFilterChanges, eth_getFilterLogs, eth_uninstallFilter
 
     get_filter_changes: Method[Callable[[HexStr], List[LogReceipt]]] = Method(
         RPC.eth_getFilterChanges, mungers=[default_root_munger]
     )
@@ -673,20 +675,23 @@
 
     submit_work: Method[Callable[[int, _Hash32, _Hash32], bool]] = Method(
         RPC.eth_submitWork,
         mungers=[default_root_munger],
     )
 
     @overload
-    def contract(self, address: None = None, **kwargs: Any) -> Type[Contract]: ...
+    # type error: Overloaded function signatures 1 and 2 overlap with incompatible return types  # noqa: E501
+    def contract(self, address: None = None, **kwargs: Any) -> Type[Contract]:  # type: ignore[misc]  # noqa: E501
+        ...
 
     @overload
     def contract(
         self, address: Union[Address, ChecksumAddress, ENS], **kwargs: Any
-    ) -> Contract: ...
+    ) -> Contract:
+        ...
 
     def contract(
         self,
         address: Optional[Union[Address, ChecksumAddress, ENS]] = None,
         **kwargs: Any,
     ) -> Union[Type[Contract], Contract]:
         ContractFactoryClass = kwargs.pop(
```

### Comparing `web3-7.0.0b3/web3/exceptions.py` & `web3-7.0.0b4/web3/exceptions.py`

 * *Files 9% similar despite different names*

```diff
@@ -37,82 +37,94 @@
     ):
         super().__init__(*args)
 
         # Assign properties of Web3Exception
         self.user_message = user_message
 
 
+class Web3AssertionError(Web3Exception, AssertionError):
+    """
+    A web3.py exception wrapper for `AssertionError`, for better control over
+    exception handling.
+    """
+
+
+class Web3ValueError(Web3Exception, ValueError):
+    """
+    A web3.py exception wrapper for `ValueError`, for better control over
+    exception handling.
+    """
+
+
+class Web3AttributeError(Web3Exception, AttributeError):
+    """
+    A web3.py exception wrapper for `AttributeError`, for better control over
+    exception handling.
+    """
+
+
+class Web3TypeError(Web3Exception, TypeError):
+    """
+    A web3.py exception wrapper for `TypeError`, for better control over
+    exception handling.
+    """
+
+
 class BadFunctionCallOutput(Web3Exception):
     """
     We failed to decode ABI output.
 
     Most likely ABI mismatch.
     """
 
-    pass
-
 
 class BlockNumberOutofRange(Web3Exception):
     """
     block_identifier passed does not match known block.
     """
 
-    pass
-
 
 class ProviderConnectionError(Web3Exception):
     """
     Raised when unable to connect to a provider
     """
 
-    pass
-
 
 class CannotHandleRequest(Web3Exception):
     """
     Raised by a provider to signal that it cannot handle an RPC request and
     that the manager should proceed to the next provider.
     """
 
-    pass
-
 
 class TooManyRequests(Web3Exception):
     """
     Raised by a provider to signal that too many requests have been made consecutively.
     """
 
-    pass
-
 
 class MultipleFailedRequests(Web3Exception):
     """
     Raised by a provider to signal that multiple requests to retrieve the same
     (or similar) data have failed.
     """
 
-    pass
-
 
 class InvalidAddress(Web3Exception):
     """
     The supplied address does not have a valid checksum, as defined in EIP-55
     """
 
-    pass
-
 
 class NameNotFound(Web3Exception):
     """
     Raised when a caller provides an Ethereum Name Service name that
     does not resolve to an address.
     """
 
-    pass
-
 
 class StaleBlockchain(Web3Exception):
     """
     Raised by the stalecheck_middleware when the latest block is too old.
     """
 
     def __init__(self, block: BlockData, allowable_delay: int) -> None:
@@ -134,149 +146,116 @@
 
 class MismatchedABI(Web3Exception):
     """
     Raised when an ABI does not match with supplied parameters, or when an
     attempt is made to access a function/event that does not exist in the ABI.
     """
 
-    pass
-
 
 class ABIEventFunctionNotFound(AttributeError, MismatchedABI):
     """
     Raised when an attempt is made to access an event
     that does not exist in the ABI.
     """
 
-    pass
-
 
 class ABIFunctionNotFound(AttributeError, MismatchedABI):
     """
     Raised when an attempt is made to access a function
     that does not exist in the ABI.
     """
 
-    pass
-
 
 class FallbackNotFound(Web3Exception):
     """
     Raised when fallback function doesn't exist in contract.
     """
 
-    pass
-
 
-class Web3ValidationError(Web3Exception, ValidationError):
+# type ignored because subclassing ValidationError which has type Any
+class Web3ValidationError(Web3Exception, ValidationError):  # type: ignore[misc]
     """
     Raised when a supplied value is invalid.
     """
 
-    pass
-
 
 class ExtraDataLengthError(Web3ValidationError):
     """
     Raised when an RPC call returns >32 bytes of extraData.
     """
 
-    pass
-
 
 class NoABIFunctionsFound(Web3Exception):
     """
     Raised when an ABI is present, but doesn't contain any functions.
     """
 
-    pass
-
 
 class NoABIFound(Web3Exception):
     """
     Raised when no ABI is present.
     """
 
-    pass
-
 
 class NoABIEventsFound(Web3Exception):
     """
     Raised when an ABI doesn't contain any events.
     """
 
-    pass
-
 
 class InsufficientData(Web3Exception):
     """
     Raised when there are insufficient data points to
     complete a calculation
     """
 
-    pass
-
 
 class TimeExhausted(Web3Exception):
     """
     Raised when a method has not retrieved the desired
     result within a specified timeout.
     """
 
-    pass
-
 
 class TransactionNotFound(Web3Exception):
     """
     Raised when a tx hash used to lookup a tx in a jsonrpc call cannot be found.
     """
 
-    pass
-
 
 class TransactionIndexingInProgress(Web3Exception):
     """
     Raised when a transaction receipt is not yet available due to transaction indexing
     still being in progress.
     """
 
-    pass
-
 
 class BlockNotFound(Web3Exception):
     """
     Raised when the block id used to lookup a block in a jsonrpc call cannot be found.
     """
 
-    pass
-
 
 class InfuraProjectIdNotFound(Web3Exception):
     """
     Raised when there is no Infura Project Id set.
     """
 
-    pass
-
 
 class LogTopicError(Web3Exception):
     """
     Raised when the number of log topics is mismatched.
     """
 
-    pass
-
 
 class InvalidEventABI(Web3Exception):
     """
     Raised when the event ABI is invalid.
     """
 
-    pass
-
 
 class ContractLogicError(Web3Exception):
     """
     Raised on a contract revert error
     """
 
     def __init__(
@@ -290,24 +269,20 @@
 
 
 class ContractCustomError(ContractLogicError):
     """
     Raised on a contract revert custom error
     """
 
-    pass
-
 
 class ContractPanicError(ContractLogicError):
     """
     Raised when a contract reverts with Panic, as of Solidity 0.8.0
     """
 
-    pass
-
 
 class OffchainLookup(ContractLogicError):
     """
     Raised when a contract reverts with OffchainLookup as described in EIP-3668
     """
 
     def __init__(self, payload: Dict[str, Any], data: Optional[str] = None) -> None:
@@ -337,16 +312,12 @@
 
 
 class BadResponseFormat(Web3Exception):
     """
     Raised when a JSON-RPC response comes back in an unexpected format
     """
 
-    pass
-
 
 class MethodUnavailable(Web3Exception):
     """
     Raised when the method is not available on the node
     """
-
-    pass
```

### Comparing `web3-7.0.0b3/web3/gas_strategies/time_based.py` & `web3-7.0.0b4/web3/gas_strategies/time_based.py`

 * *Files 1% similar despite different names*

```diff
@@ -80,29 +80,27 @@
 
 def _get_raw_miner_data(
     w3: Web3, sample_size: int
 ) -> Iterable[Tuple[ChecksumAddress, HexBytes, Wei]]:
     latest = w3.eth.get_block("latest", full_transactions=True)
 
     for transaction in latest["transactions"]:
-        # type ignored b/c actual transaction is TxData not HexBytes
-        yield (latest["miner"], latest["hash"], transaction["gasPrice"])  # type: ignore
+        yield (latest["miner"], latest["hash"], transaction["gasPrice"])
 
     block = latest
 
     for _ in range(sample_size - 1):
         if block["number"] == 0:
             break
 
         # we intentionally trace backwards using parent hashes rather than
         # block numbers to make caching the data easier to implement.
         block = w3.eth.get_block(block["parentHash"], full_transactions=True)
         for transaction in block["transactions"]:
-            # type ignored b/c actual transaction is TxData not HexBytes
-            yield (block["miner"], block["hash"], transaction["gasPrice"])  # type: ignore  # noqa: E501
+            yield (block["miner"], block["hash"], transaction["gasPrice"])
 
 
 def _aggregate_miner_data(
     raw_data: Iterable[Tuple[ChecksumAddress, HexBytes, Wei]]
 ) -> Iterable[MinerData]:
     data_by_miner = groupby(0, raw_data)
```

### Comparing `web3-7.0.0b3/web3/geth.py` & `web3-7.0.0b4/web3/geth.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,30 +1,28 @@
 from typing import (
     Any,
     Awaitable,
     Callable,
     Dict,
     List,
     Optional,
+    Protocol,
     Tuple,
 )
 
 from eth_typing.encoding import (
     HexStr,
 )
 from eth_typing.evm import (
     ChecksumAddress,
 )
 from hexbytes.main import (
     HexBytes,
 )
 
-from web3._utils.compat import (
-    Protocol,
-)
 from web3._utils.rpc_abi import (
     RPC,
 )
 from web3.method import (
     Method,
     default_root_munger,
 )
```

### Comparing `web3-7.0.0b3/web3/main.py` & `web3-7.0.0b4/web3/main.py`

 * *Files 1% similar despite different names*

```diff
@@ -80,14 +80,18 @@
 from web3._utils.normalizers import (
     abi_ens_resolver,
 )
 from web3.eth import (
     AsyncEth,
     Eth,
 )
+from web3.exceptions import (
+    Web3TypeError,
+    Web3ValueError,
+)
 from web3.geth import (
     AsyncGeth,
     AsyncGethAdmin,
     AsyncGethPersonal,
     AsyncGethTxPool,
     Geth,
     GethAdmin,
@@ -279,15 +283,15 @@
         text: Optional[str] = None,
         hexstr: Optional[HexStr] = None,
     ) -> bytes:
         if isinstance(primitive, (bytes, int, type(None))):
             input_bytes = to_bytes(primitive, hexstr=hexstr, text=text)
             return eth_utils_keccak(input_bytes)
 
-        raise TypeError(
+        raise Web3TypeError(
             f"You called keccak with first arg {primitive!r} and keywords "
             f"{{'text': {text!r}, 'hexstr': {hexstr!r}}}. You must call it with "
             "one of these approaches: keccak(text='txt'), keccak(hexstr='0x747874'), "
             "keccak(b'\\x74\\x78\\x74'), or keccak(0x747874)."
         )
 
     @classmethod
@@ -300,15 +304,15 @@
     def solidity_keccak(cls, abi_types: List[TypeStr], values: List[Any]) -> bytes:
         """
         Executes keccak256 exactly as Solidity does.
         Takes list of abi_types as inputs -- `[uint24, int8[], bool]`
         and list of corresponding values  -- `[20, [-1, 5, 0], True]`
         """
         if len(abi_types) != len(values):
-            raise ValueError(
+            raise Web3ValueError(
                 "Length mismatch between provided abi types and values.  Got "
                 f"{len(abi_types)} types and {len(values)} values."
             )
 
         if isinstance(cls, type):
             w3 = None
         else:
```

### Comparing `web3-7.0.0b3/web3/manager.py` & `web3-7.0.0b4/web3/manager.py`

 * *Files 4% similar despite different names*

```diff
@@ -31,14 +31,16 @@
 from web3.datastructures import (
     NamedElementOnion,
 )
 from web3.exceptions import (
     BadResponseFormat,
     MethodUnavailable,
     ProviderConnectionError,
+    Web3TypeError,
+    Web3ValueError,
 )
 from web3.middleware import (
     AttributeDictMiddleware,
     BufferedGasEstimateMiddleware,
     ENSNameToAddressMiddleware,
     GasPriceStrategyMiddleware,
     ValidationMiddleware,
@@ -234,15 +236,15 @@
             )
 
         # Format and validate errors
         elif "error" in response:
             error = response.get("error")
             # Raise the error when the value is a string
             if error is None or isinstance(error, str):
-                raise ValueError(error)
+                raise Web3ValueError(error)
 
             # Errors must include an integer code
             code = error.get("code")
             if not isinstance(code, int):
                 _raise_bad_response_format(response, "error['code'] must be an integer")
             elif code == METHOD_NOT_FOUND:
                 raise MethodUnavailable(
@@ -255,15 +257,15 @@
             if not isinstance(error.get("message"), str):
                 _raise_bad_response_format(
                     response, "error['message'] must be a string"
                 )
 
             apply_error_formatters(error_formatters, response)
 
-            raise ValueError(error)
+            raise Web3ValueError(error)
 
         # Format and validate results
         elif "result" in response:
             # Null values for result should apply null_result_formatters
             # Skip when result not present in the response (fallback to False)
             if response.get("result", False) in NULL_RESPONSES:
                 apply_null_result_formatters(null_result_formatters, response, params)
@@ -319,29 +321,29 @@
 
     async def send(self, method: RPCEndpoint, params: Any) -> RPCResponse:
         provider = cast(PersistentConnectionProvider, self._provider)
         request_func = await provider.request_func(
             cast("AsyncWeb3", self.w3), cast("MiddlewareOnion", self.middleware_onion)
         )
         self.logger.debug(
-            "Making request to open socket connection - "
-            f"uri: {provider.endpoint_uri}, method: {method}"
+            "Making request to open socket connection: "
+            f"{provider.get_endpoint_uri_or_ipc_path()}, method: {method}"
         )
         response = await request_func(method, params)
         return await self._process_response(response)
 
     def _persistent_message_stream(self) -> "_AsyncPersistentMessageStream":
         return _AsyncPersistentMessageStream(self)
 
     async def _get_next_message(self) -> Any:
         return await self._message_stream().__anext__()
 
     async def _message_stream(self) -> AsyncGenerator[RPCResponse, None]:
         if not isinstance(self._provider, PersistentConnectionProvider):
-            raise TypeError(
+            raise Web3TypeError(
                 "Only providers that maintain an open, persistent connection "
                 "can listen to streams."
             )
 
         if self._provider._message_listener_task is None:
             raise ProviderConnectionError(
                 "No listener found for persistent connection."
```

### Comparing `web3-7.0.0b3/web3/method.py` & `web3-7.0.0b4/web3/method.py`

 * *Files 2% similar despite different names*

```diff
@@ -28,15 +28,17 @@
     get_request_formatters,
     get_result_formatters,
 )
 from web3._utils.rpc_abi import (
     RPC,
 )
 from web3.exceptions import (
+    Web3TypeError,
     Web3ValidationError,
+    Web3ValueError,
 )
 from web3.types import (
     RPCEndpoint,
     TReturn,
 )
 
 if TYPE_CHECKING:
@@ -62,15 +64,17 @@
 ) -> Sequence[Any]:
     if is_property and mungers:
         raise Web3ValidationError("Mungers cannot be used with a property.")
 
     return (
         mungers
         if mungers
-        else [default_munger] if is_property else [default_root_munger]
+        else [default_munger]
+        if is_property
+        else [default_root_munger]
     )
 
 
 def default_munger(_module: "Module", *args: Any, **kwargs: Any) -> Tuple[()]:
     if args or kwargs:
         raise Web3ValidationError("Parameters cannot be passed to a property.")
     return ()
@@ -80,15 +84,16 @@
     return [*args]
 
 
 TFunc = TypeVar("TFunc", bound=Callable[..., Any])
 
 
 class Method(Generic[TFunc]):
-    """Method object for web3 module methods
+    """
+    Method object for web3 module methods
 
     Calls to the Method go through these steps:
 
     1. input munging - includes normalization, parameter checking, early parameter
     formatting. Any processing on the input parameters that need to happen before
     json_rpc method string selection occurs.
 
@@ -143,15 +148,15 @@
         self.method_choice_depends_on_args = method_choice_depends_on_args
         self.is_property = is_property
 
     def __get__(
         self, obj: Optional["Module"] = None, obj_type: Optional[Type["Module"]] = None
     ) -> TFunc:
         if obj is None:
-            raise TypeError(
+            raise Web3TypeError(
                 "Direct calls to methods are not supported. "
                 "Methods must be called from an module instance, "
                 "usually attached to a web3 instance."
             )
         return obj.retrieve_caller_fn(self)
 
     @property
@@ -159,27 +164,29 @@
         self,
     ) -> Callable[..., Union[RPCEndpoint, Callable[..., RPCEndpoint]]]:
         """Gets the method selector from the config."""
         if callable(self.json_rpc_method):
             return self.json_rpc_method
         elif isinstance(self.json_rpc_method, (str,)):
             return lambda *_: self.json_rpc_method
-        raise ValueError(
+        raise Web3ValueError(
             "``json_rpc_method`` config invalid.  May be a string or function"
         )
 
     def input_munger(self, module: "Module", args: Any, kwargs: Any) -> List[Any]:
         # This function takes the input parameters and munges them.
         # See the test_process_params test in ``tests/core/method-class/test_method.py``
         # for an example with multiple mungers.
         return functools.reduce(
             lambda args, munger: munger(module, *args, **kwargs), self.mungers, args
         )
 
-    def process_params(self, module: "Module", *args: Any, **kwargs: Any) -> Tuple[
+    def process_params(
+        self, module: "Module", *args: Any, **kwargs: Any
+    ) -> Tuple[
         Tuple[Union[RPCEndpoint, Callable[..., RPCEndpoint]], Tuple[Any, ...]],
         Tuple[
             Union[TReturn, Dict[str, Callable[..., Any]]],
             Callable[..., Any],
             Union[TReturn, Callable[..., Any]],
         ],
     ]:
@@ -222,9 +229,10 @@
 
     def __get__(
         self, obj: Optional["Module"] = None, obj_type: Optional[Type["Module"]] = None
     ) -> Any:
         warnings.warn(
             f"{self.old_name} is deprecated in favor of {self.new_name}",
             category=DeprecationWarning,
+            stacklevel=2,
         )
         return self.method.__get__(obj, obj_type)
```

### Comparing `web3-7.0.0b3/web3/middleware/__init__.py` & `web3-7.0.0b4/web3/middleware/__init__.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/middleware/attrdict.py` & `web3-7.0.0b4/web3/middleware/attrdict.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/middleware/base.py` & `web3-7.0.0b4/web3/middleware/base.py`

 * *Files 3% similar despite different names*

```diff
@@ -44,15 +44,17 @@
             return self.response_processor(method, make_request(method, params))
 
         return middleware
 
     def request_processor(self, method: "RPCEndpoint", params: Any) -> Any:
         return method, params
 
-    def response_processor(self, method: "RPCEndpoint", response: "RPCResponse") -> Any:
+    def response_processor(
+        self, method: "RPCEndpoint", response: "RPCResponse"
+    ) -> "RPCResponse":
         return response
 
     # -- async -- #
 
     async def async_wrap_make_request(
         self, make_request: "AsyncMakeRequestFn"
     ) -> "AsyncMakeRequestFn":
@@ -72,15 +74,15 @@
     ) -> Any:
         return method, params
 
     async def async_response_processor(
         self,
         method: "RPCEndpoint",
         response: "RPCResponse",
-    ) -> Any:
+    ) -> "RPCResponse":
         return response
 
 
 class Web3MiddlewareBuilder(Web3Middleware):
     @staticmethod
     @abstractmethod
     def build(
```

### Comparing `web3-7.0.0b3/web3/middleware/buffered_gas_estimate.py` & `web3-7.0.0b4/web3/middleware/buffered_gas_estimate.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/middleware/filter.py` & `web3-7.0.0b4/web3/middleware/filter.py`

 * *Files 1% similar despite different names*

```diff
@@ -38,14 +38,17 @@
 
 from web3._utils.formatters import (
     hex_to_integer,
 )
 from web3._utils.rpc_abi import (
     RPC,
 )
+from web3.exceptions import (
+    Web3TypeError,
+)
 from web3.middleware.base import (
     Web3Middleware,
 )
 from web3.types import (
     AsyncMakeRequestFn,
     FilterParams,
     LatestBlockParam,
@@ -67,82 +70,86 @@
 if "WEB3_MAX_BLOCK_REQUEST" in os.environ:
     MAX_BLOCK_REQUEST = to_int(text=os.environ["WEB3_MAX_BLOCK_REQUEST"])
 else:
     MAX_BLOCK_REQUEST = 50
 
 
 def segment_count(start: int, stop: int, step: int = 5) -> Iterable[Tuple[int, int]]:
-    """Creates a segment counting generator
+    """
+    Creates a segment counting generator
 
     The generator returns tuple pairs of integers
     that correspond to segments in the provided range.
 
     :param start: The initial value of the counting range
     :param stop: The last value in the
     counting range
     :param step: Optional, the segment length. Default is 5.
     :return: returns a generator object
 
 
     Example:
+    -------
 
     >>> segment_counter = segment_count(start=0, stop=10, step=3)
     >>> next(segment_counter)
     (0, 3)
     >>> next(segment_counter)
     (3, 6)
     >>> next(segment_counter)
     (6, 9)
     >>> next(segment_counter) #  Remainder is also returned
     (9, 10)
+
     """
     return gen_bounded_segments(start, stop, step)
 
 
 def gen_bounded_segments(start: int, stop: int, step: int) -> Iterable[Tuple[int, int]]:
     #  If the initial range is less than the step
     #  just return (start, stop)
     if start + step >= stop:
         yield (start, stop)
         return
-    for segment in zip(
+    yield from zip(
         range(start, stop - step + 1, step), range(start + step, stop + 1, step)
-    ):
-        yield segment
+    )
 
     remainder = (stop - start) % step
     #  Handle the remainder
     if remainder:
         yield (stop - remainder, stop)
 
 
 def block_ranges(
     start_block: BlockNumber, last_block: Optional[BlockNumber], step: int = 5
 ) -> Iterable[Tuple[BlockNumber, BlockNumber]]:
-    """Returns 2-tuple ranges describing ranges of block from start_block to last_block
+    """
+    Returns 2-tuple ranges describing ranges of block from start_block to last_block
 
     Ranges do not overlap to facilitate use as ``toBlock``, ``fromBlock``
     json-rpc arguments, which are both inclusive.
     """
     if last_block is not None and start_block > last_block:
-        raise TypeError(
+        raise Web3TypeError(
             "Incompatible start and stop arguments.",
             "Start must be less than or equal to stop.",
         )
 
     return (
         (BlockNumber(from_block), BlockNumber(to_block - 1))
         for from_block, to_block in segment_count(start_block, last_block + 1, step)
     )
 
 
 def iter_latest_block(
     w3: "Web3", to_block: Optional[Union[BlockNumber, LatestBlockParam]] = None
 ) -> Iterable[BlockNumber]:
-    """Returns a generator that dispenses the latest block, if
+    """
+    Returns a generator that dispenses the latest block, if
     any new blocks have been mined since last iteration.
 
     If there are no new blocks or the latest block is greater than
     the ``to_block`` None is returned.
 
     >>> new_blocks = iter_latest_block(w3, 0, 10)
     >>> next(new_blocks)  # Latest block = 0
@@ -156,31 +163,31 @@
     """
     _last = None
 
     is_bounded_range = to_block is not None and to_block != "latest"
 
     while True:
         latest_block = w3.eth.block_number
-        # type ignored b/c is_bounded_range prevents unsupported comparison
-        if is_bounded_range and latest_block > to_block:  # type: ignore
+        if is_bounded_range and latest_block > to_block:
             yield None
         #  No new blocks since last iteration.
         if _last is not None and _last == latest_block:
             yield None
         else:
             yield latest_block
         _last = latest_block
 
 
 def iter_latest_block_ranges(
     w3: "Web3",
     from_block: BlockNumber,
     to_block: Optional[Union[BlockNumber, LatestBlockParam]] = None,
 ) -> Iterable[Tuple[Optional[BlockNumber], Optional[BlockNumber]]]:
-    """Returns an iterator unloading ranges of available blocks
+    """
+    Returns an iterator unloading ranges of available blocks
 
     starting from `fromBlock` to the latest mined block,
     until reaching toBlock. e.g.:
 
 
     >>> blocks_to_filter = iter_latest_block_ranges(w3, 0, 50)
     >>> next(blocks_to_filter)  # latest block number = 11
@@ -208,15 +215,16 @@
     w3: "Web3",
     start_block: BlockNumber,
     stop_block: BlockNumber,
     address: Union[Address, ChecksumAddress, List[Union[Address, ChecksumAddress]]],
     topics: List[Optional[Union[_Hash32, List[_Hash32]]]],
     max_blocks: int,
 ) -> Iterable[List[LogReceipt]]:
-    """Used to break up requests to ``eth_getLogs``
+    """
+    Used to break up requests to ``eth_getLogs``
 
     The getLog request is partitioned into multiple calls of the max number of blocks
     ``max_blocks``.
     """
     _block_ranges = block_ranges(start_block, stop_block, max_blocks)
     for from_block, to_block in _block_ranges:
         params = {
@@ -243,17 +251,16 @@
     ) -> None:
         self.address = address
         self.topics = topics
         self.w3 = w3
         if from_block is None or from_block == "latest":
             self._from_block = BlockNumber(w3.eth.block_number + 1)
         elif is_string(from_block) and is_hex(from_block):
-            self._from_block = BlockNumber(hex_to_integer(from_block))  # type: ignore
+            self._from_block = BlockNumber(hex_to_integer(from_block))
         else:
-            # cast b/c LatestBlockParam is handled above
             self._from_block = from_block
         self._to_block = to_block
         self.filter_changes = self._get_filter_changes()
 
     @property
     def from_block(self) -> BlockNumber:
         return self._from_block
@@ -261,15 +268,15 @@
     @property
     def to_block(self) -> BlockNumber:
         if self._to_block is None:
             to_block = self.w3.eth.block_number
         elif self._to_block == "latest":
             to_block = self.w3.eth.block_number
         elif is_string(self._to_block) and is_hex(self._to_block):
-            to_block = BlockNumber(hex_to_integer(self._to_block))  # type: ignore
+            to_block = BlockNumber(hex_to_integer(self._to_block))
         else:
             to_block = self._to_block
 
         return to_block
 
     def _get_filter_changes(self) -> Iterator[List[LogReceipt]]:
         for start, stop in iter_latest_block_ranges(
@@ -348,15 +355,16 @@
 
 # --- async --- #
 
 
 async def async_iter_latest_block(
     w3: "AsyncWeb3", to_block: Optional[Union[BlockNumber, LatestBlockParam]] = None
 ) -> AsyncIterable[BlockNumber]:
-    """Returns a generator that dispenses the latest block, if
+    """
+    Returns a generator that dispenses the latest block, if
     any new blocks have been mined since last iteration.
 
     If there are no new blocks or the latest block is greater than
     the ``to_block`` None is returned.
 
     >>> new_blocks = iter_latest_block(w3, 0, 10)
     >>> next(new_blocks)  # Latest block = 0
@@ -386,15 +394,16 @@
 
 
 async def async_iter_latest_block_ranges(
     w3: "AsyncWeb3",
     from_block: BlockNumber,
     to_block: Optional[Union[BlockNumber, LatestBlockParam]] = None,
 ) -> AsyncIterable[Tuple[Optional[BlockNumber], Optional[BlockNumber]]]:
-    """Returns an iterator unloading ranges of available blocks
+    """
+    Returns an iterator unloading ranges of available blocks
 
     starting from `from_block` to the latest mined block,
     until reaching to_block. e.g.:
 
 
     >>> blocks_to_filter = iter_latest_block_ranges(w3, 0, 50)
     >>> next(blocks_to_filter)  # latest block number = 11
@@ -419,15 +428,16 @@
     w3: "AsyncWeb3",
     start_block: BlockNumber,
     stop_block: BlockNumber,
     address: Union[Address, ChecksumAddress, List[Union[Address, ChecksumAddress]]],
     topics: List[Optional[Union[_Hash32, List[_Hash32]]]],
     max_blocks: int,
 ) -> AsyncIterable[List[LogReceipt]]:
-    """Used to break up requests to ``eth_getLogs``
+    """
+    Used to break up requests to ``eth_getLogs``
 
     The getLog request is partitioned into multiple calls of the max number of blocks
     ``max_blocks``.
     """
     _block_ranges = block_ranges(start_block, stop_block, max_blocks)
     for from_block, to_block in _block_ranges:
         params = {
```

### Comparing `web3-7.0.0b3/web3/middleware/formatting.py` & `web3-7.0.0b4/web3/middleware/formatting.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,31 +1,34 @@
 from typing import (
     TYPE_CHECKING,
     Any,
     Callable,
     Coroutine,
+    Literal,
     Optional,
     Union,
     cast,
 )
 
 from eth_utils.toolz import (
     assoc,
     curry,
     merge,
 )
 
+from web3.exceptions import (
+    Web3ValueError,
+)
 from web3.middleware.base import (
     Web3MiddlewareBuilder,
 )
 from web3.types import (
     EthSubscriptionParams,
     Formatters,
     FormattersDict,
-    Literal,
     RPCEndpoint,
     RPCResponse,
 )
 
 if TYPE_CHECKING:
     from web3 import (  # noqa: F401
         AsyncWeb3,
@@ -114,25 +117,25 @@
         sync_formatters_builder: Optional[SYNC_FORMATTERS_BUILDER] = None,
         async_formatters_builder: Optional[ASYNC_FORMATTERS_BUILDER] = None,
     ) -> "FormattingMiddlewareBuilder":
         # if not both sync and async formatters are specified, raise error
         if (
             sync_formatters_builder is None and async_formatters_builder is not None
         ) or (sync_formatters_builder is not None and async_formatters_builder is None):
-            raise ValueError(
+            raise Web3ValueError(
                 "Must specify both sync_formatters_builder and async_formatters_builder"
             )
 
         if sync_formatters_builder is not None and async_formatters_builder is not None:
             if (
                 request_formatters is not None
                 or result_formatters is not None
                 or error_formatters is not None
             ):
-                raise ValueError(
+                raise Web3ValueError(
                     "Cannot specify formatters_builder and formatters at the same time"
                 )
 
         middleware = FormattingMiddlewareBuilder(w3)
         middleware.request_formatters = request_formatters or {}
         middleware.result_formatters = result_formatters or {}
         middleware.error_formatters = error_formatters or {}
```

### Comparing `web3-7.0.0b3/web3/middleware/gas_price_strategy.py` & `web3-7.0.0b4/web3/middleware/gas_price_strategy.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/middleware/names.py` & `web3-7.0.0b4/web3/middleware/names.py`

 * *Files 4% similar despite different names*

```diff
@@ -27,14 +27,17 @@
     abi_data_tree,
     async_data_tree_map,
     strip_abi_type,
 )
 from .._utils.formatters import (
     recursive_map,
 )
+from ..exceptions import (
+    Web3TypeError,
+)
 from .base import (
     Web3Middleware,
 )
 from .formatting import (
     FormattingMiddlewareBuilder,
 )
 
@@ -88,15 +91,15 @@
             [param_dict[field] for field in fields],
         )
         formatted_dict = dict(zip(fields, formatted_params))
         formatted_params_dict = merge(param_dict, formatted_dict)
         return (formatted_params_dict, *params[1:])
 
     else:
-        raise TypeError(
+        raise Web3TypeError(
             f"ABI definitions must be a list or dictionary, "
             f"got {abi_types_for_method!r}"
         )
 
 
 class ENSNameToAddressMiddleware(Web3Middleware):
     _formatting_middleware = None
```

### Comparing `web3-7.0.0b3/web3/middleware/proof_of_authority.py` & `web3-7.0.0b4/web3/middleware/proof_of_authority.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/middleware/signing.py` & `web3-7.0.0b4/web3/middleware/signing.py`

 * *Files 5% similar despite different names*

```diff
@@ -51,14 +51,17 @@
     TRANSACTION_PARAMS_ABIS,
     apply_abi_formatters_to_dict,
 )
 from web3._utils.transactions import (
     fill_nonce,
     fill_transaction_defaults,
 )
+from web3.exceptions import (
+    Web3TypeError,
+)
 from web3.middleware.base import (
     Web3MiddlewareBuilder,
 )
 from web3.types import (
     RPCEndpoint,
     TxParams,
 )
@@ -104,15 +107,15 @@
         account = to_account(val)
         yield account.address, account
         return
 
 
 @singledispatch
 def to_account(val: Any) -> LocalAccount:
-    raise TypeError(
+    raise Web3TypeError(
         "key must be one of the types: "
         "eth_keys.datatype.PrivateKey, eth_account.signers.local.LocalAccount, "
         "or raw private key as a hex string or byte string. "
         f"Was of type {type(val)}"
     )
 
 
@@ -128,15 +131,16 @@
 
 to_account.register(PrivateKey, private_key_to_account)
 to_account.register(str, private_key_to_account)
 to_account.register(bytes, private_key_to_account)
 
 
 def format_transaction(transaction: TxParams) -> TxParams:
-    """Format transaction so that it can be used correctly in the signing middleware.
+    """
+    Format transaction so that it can be used correctly in the signing middleware.
 
     Converts bytes to hex strings and other types that can be passed to
     the underlying layers. Also has the effect of normalizing 'from' for
     easier comparisons.
     """
     return apply_abi_formatters_to_dict(
         STANDARD_NORMALIZERS, TRANSACTION_PARAMS_ABIS, transaction
```

### Comparing `web3-7.0.0b3/web3/middleware/stalecheck.py` & `web3-7.0.0b4/web3/middleware/stalecheck.py`

 * *Files 5% similar despite different names*

```diff
@@ -12,14 +12,15 @@
 
 from toolz import (
     curry,
 )
 
 from web3.exceptions import (
     StaleBlockchain,
+    Web3ValueError,
 )
 from web3.middleware.base import (
     Web3Middleware,
     Web3MiddlewareBuilder,
 )
 from web3.types import (
     BlockData,
@@ -50,15 +51,15 @@
     @curry
     def build(
         allowable_delay: int,
         w3: Union["Web3", "AsyncWeb3"],
         skip_stalecheck_for_methods: Collection[str] = SKIP_STALECHECK_FOR_METHODS,
     ) -> Web3Middleware:
         if allowable_delay <= 0:
-            raise ValueError(
+            raise Web3ValueError(
                 "You must set a positive allowable_delay in seconds for this middleware"
             )
         middleware = StalecheckMiddlewareBuilder(w3)
         middleware.allowable_delay = allowable_delay
         middleware.skip_stalecheck_for_methods = skip_stalecheck_for_methods
         middleware.cache = {"latest": None}
         return middleware
```

### Comparing `web3-7.0.0b3/web3/middleware/validation.py` & `web3-7.0.0b4/web3/middleware/validation.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/module.py` & `web3-7.0.0b4/web3/module.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/net.py` & `web3-7.0.0b4/web3/net.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/providers/async_base.py` & `web3-7.0.0b4/web3/providers/async_base.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/providers/auto.py` & `web3-7.0.0b4/web3/providers/auto.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/providers/base.py` & `web3-7.0.0b4/web3/providers/base.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/providers/eth_tester/defaults.py` & `web3-7.0.0b4/web3/providers/eth_tester/defaults.py`

 * *Files 0% similar despite different names*

```diff
@@ -214,15 +214,15 @@
 
 
 def _generate_random_private_key() -> HexStr:
     """
     WARNING: This is not a secure way to generate private keys and should only
     be used for testing purposes.
     """
-    return encode_hex(bytes(bytearray((random.randint(0, 255) for _ in range(32)))))
+    return encode_hex(bytes(bytearray(random.randint(0, 255) for _ in range(32))))
 
 
 @without_params
 def create_new_account(eth_tester: "EthereumTester") -> HexAddress:
     return eth_tester.add_account(_generate_random_private_key())
```

### Comparing `web3-7.0.0b3/web3/providers/eth_tester/main.py` & `web3-7.0.0b4/web3/providers/eth_tester/main.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,42 +1,43 @@
 from typing import (
     TYPE_CHECKING,
     Any,
     Callable,
     Coroutine,
     Dict,
+    Literal,
     Optional,
     Union,
 )
 
 from eth_abi import (
     abi,
 )
 from eth_abi.exceptions import (
     DecodingError,
 )
 from eth_utils import (
     is_bytes,
 )
 
-from web3._utils.compat import (
-    Literal,
-)
 from web3.providers import (
     BaseProvider,
 )
 from web3.providers.async_base import (
     AsyncBaseProvider,
 )
 from web3.types import (
     RPCEndpoint,
     RPCError,
     RPCResponse,
 )
 
+from ...exceptions import (
+    Web3TypeError,
+)
 from ...middleware import (
     async_combine_middleware,
     combine_middleware,
 )
 from .middleware import (
     default_transaction_fields_middleware,
     ethereum_tester_middleware,
@@ -129,15 +130,15 @@
         if ethereum_tester is None:
             self.ethereum_tester = EthereumTester()
         elif isinstance(ethereum_tester, EthereumTester):
             self.ethereum_tester = ethereum_tester
         elif isinstance(ethereum_tester, BaseChainBackend):
             self.ethereum_tester = EthereumTester(ethereum_tester)
         else:
-            raise TypeError(
+            raise Web3TypeError(
                 "Expected ethereum_tester to be of type `eth_tester.EthereumTester` or "
                 "a subclass of `eth_tester.backends.base.BaseChainBackend`, "
                 f"instead received {type(ethereum_tester)}. "
                 "If you would like a custom eth-tester instance to test with, see the "
                 "eth-tester documentation. https://github.com/ethereum/eth-tester."
             )
```

### Comparing `web3-7.0.0b3/web3/providers/eth_tester/middleware.py` & `web3-7.0.0b4/web3/providers/eth_tester/middleware.py`

 * *Files 2% similar despite different names*

```diff
@@ -68,15 +68,17 @@
 
 to_integer_if_hex = apply_formatter_if(is_hexstr, hex_to_integer)
 is_not_named_block = complement(is_named_block)
 
 # --- Request Mapping --- #
 
 TRANSACTION_REQUEST_KEY_MAPPING = {
+    "blobVersionedHashes": "blob_versioned_hashes",
     "gasPrice": "gas_price",
+    "maxFeePerBlobGas": "max_fee_per_blob_gas",
     "maxFeePerGas": "max_fee_per_gas",
     "maxPriorityFeePerGas": "max_priority_fee_per_gas",
     "accessList": "access_list",
     "chainId": "chain_id",
 }
 transaction_request_remapper = apply_key_map(TRANSACTION_REQUEST_KEY_MAPPING)
 
@@ -86,15 +88,15 @@
     "gas": to_integer_if_hex,
     "gasPrice": to_integer_if_hex,
     "value": to_integer_if_hex,
     "nonce": to_integer_if_hex,
     "maxFeePerGas": to_integer_if_hex,
     "maxPriorityFeePerGas": to_integer_if_hex,
     "accessList": apply_list_to_array_formatter(
-        (apply_key_map({"storageKeys": "storage_keys"}))
+        apply_key_map({"storageKeys": "storage_keys"})
     ),
 }
 transaction_request_formatter = apply_formatters_to_dict(TRANSACTION_REQUEST_FORMATTERS)
 
 transaction_request_transformer = compose(
     transaction_request_remapper,
     transaction_request_formatter,
@@ -119,18 +121,20 @@
 )
 
 
 # --- Result Mapping --- #
 
 TRANSACTION_RESULT_KEY_MAPPING = {
     "access_list": "accessList",
+    "blob_versioned_hashes": "blobVersionedHashes",
     "block_hash": "blockHash",
     "block_number": "blockNumber",
     "chain_id": "chainId",
     "gas_price": "gasPrice",
+    "max_fee_per_blob_gas": "maxFeePerBlobGas",
     "max_fee_per_gas": "maxFeePerGas",
     "max_priority_fee_per_gas": "maxPriorityFeePerGas",
     "transaction_hash": "transactionHash",
     "transaction_index": "transactionIndex",
     "data": "input",
 }
 transaction_result_remapper = apply_key_map(TRANSACTION_RESULT_KEY_MAPPING)
@@ -160,14 +164,16 @@
     "block_number": "blockNumber",
     "contract_address": "contractAddress",
     "gas_used": "gasUsed",
     "cumulative_gas_used": "cumulativeGasUsed",
     "effective_gas_price": "effectiveGasPrice",
     "transaction_hash": "transactionHash",
     "transaction_index": "transactionIndex",
+    "blob_gas_used": "blobGasUsed",
+    "blob_gas_price": "blobGasPrice",
 }
 receipt_result_remapper = apply_key_map(RECEIPT_RESULT_KEY_MAPPING)
 
 
 BLOCK_RESULT_KEY_MAPPING = {
     "gas_limit": "gasLimit",
     "sha3_uncles": "sha3Uncles",
@@ -182,14 +188,17 @@
     "base_fee_per_gas": "baseFeePerGas",
     "mix_hash": "mixHash",
     # eth-tester changed the miner key to coinbase since
     # there is no longer any mining happening, but the current
     # JSON-RPC spec still says miner
     "coinbase": "miner",
     "withdrawals_root": "withdrawalsRoot",
+    "parent_beacon_block_root": "parentBeaconBlockRoot",
+    "blob_gas_used": "blobGasUsed",
+    "excess_blob_gas": "excessBlobGas",
 }
 block_result_remapper = apply_key_map(BLOCK_RESULT_KEY_MAPPING)
 
 BLOCK_RESULT_FORMATTERS = {
     "withdrawals": apply_list_to_array_formatter(
         apply_key_map({"validator_index": "validatorIndex"}),
     ),
```

### Comparing `web3-7.0.0b3/web3/providers/ipc.py` & `web3-7.0.0b4/web3/providers/ipc.py`

 * *Files 1% similar despite different names*

```diff
@@ -22,14 +22,18 @@
     Timeout,
 )
 from web3.types import (
     RPCEndpoint,
     RPCResponse,
 )
 
+from ..exceptions import (
+    Web3TypeError,
+    Web3ValueError,
+)
 from .base import (
     JSONBaseProvider,
 )
 
 
 def get_ipc_socket(ipc_path: str, timeout: float = 2.0) -> socket.socket:
     if sys.platform == "win32":
@@ -92,15 +96,15 @@
     elif sys.platform.startswith("linux") or sys.platform.startswith("freebsd"):
         return os.path.expanduser(os.path.join("~", ".ethereum", "geth.ipc"))
 
     elif sys.platform == "win32":
         return r"\\.\pipe\geth.ipc"
 
     else:
-        raise ValueError(
+        raise Web3ValueError(
             f"Unsupported platform '{sys.platform}'. Only darwin/linux/win32/"
             "freebsd are supported.  You must specify the ipc_path"
         )
 
 
 def get_dev_ipc_path() -> str:
     if os.environ.get("WEB3_PROVIDER_URI", ""):
@@ -113,15 +117,15 @@
     elif sys.platform.startswith("linux") or sys.platform.startswith("freebsd"):
         return os.path.expanduser(os.path.join("/tmp", "geth.ipc"))
 
     elif sys.platform == "win32":
         return r"\\.\pipe\geth.ipc"
 
     else:
-        raise ValueError(
+        raise Web3ValueError(
             f"Unsupported platform '{sys.platform}'. Only darwin/linux/win32/"
             "freebsd are supported.  You must specify the ipc_path"
         )
 
 
 class IPCProvider(JSONBaseProvider):
     logger = logging.getLogger("web3.providers.IPCProvider")
@@ -135,15 +139,15 @@
         **kwargs: Any,
     ) -> None:
         if ipc_path is None:
             self.ipc_path = get_default_ipc_path()
         elif isinstance(ipc_path, str) or isinstance(ipc_path, Path):
             self.ipc_path = str(Path(ipc_path).expanduser().resolve())
         else:
-            raise TypeError("ipc_path must be of type string or pathlib.Path")
+            raise Web3TypeError("ipc_path must be of type string or pathlib.Path")
 
         self.timeout = timeout
         self._lock = threading.Lock()
         self._socket = PersistantSocket(self.ipc_path)
         super().__init__()
 
     def __str__(self) -> str:
```

### Comparing `web3-7.0.0b3/web3/providers/legacy_websocket.py` & `web3-7.0.0b4/web3/providers/legacy_websocket.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/providers/persistent/async_ipc.py` & `web3-7.0.0b4/web3/providers/persistent/async_ipc.py`

 * *Files 7% similar despite different names*

```diff
@@ -29,14 +29,15 @@
     PersistentConnectionProvider,
 )
 from ..._utils.caching import (
     async_handle_request_caching,
 )
 from ...exceptions import (
     ProviderConnectionError,
+    Web3TypeError,
 )
 from ..ipc import (
     get_default_ipc_path,
 )
 
 
 async def async_get_ipc_socket(
@@ -67,15 +68,15 @@
         **kwargs: Any,
     ) -> None:
         if ipc_path is None:
             self.ipc_path = get_default_ipc_path()
         elif isinstance(ipc_path, str) or isinstance(ipc_path, Path):
             self.ipc_path = str(Path(ipc_path).expanduser().resolve())
         else:
-            raise TypeError("ipc_path must be of type string or pathlib.Path")
+            raise Web3TypeError("ipc_path must be of type string or pathlib.Path")
 
         self._max_connection_retries = max_connection_retries
         super().__init__(**kwargs)
 
     def __str__(self) -> str:
         return f"<{self.__class__.__name__} {self.ipc_path}>"
 
@@ -87,15 +88,15 @@
             request_data = self.encode_rpc_request(
                 RPCEndpoint("web3_clientVersions"), []
             )
             self._writer.write(request_data)
             current_request_id = json.loads(request_data)["id"]
             await self._get_response_for_request_id(current_request_id, timeout=2)
             return True
-        except (OSError, BrokenPipeError, ProviderConnectionError) as e:
+        except (OSError, ProviderConnectionError) as e:
             if show_traceback:
                 raise ProviderConnectionError(
                     f"Problem connecting to provider with error: {type(e)}: {e}"
                 )
             return False
 
     async def connect(self) -> None:
@@ -110,33 +111,31 @@
                 self._message_listener_task = asyncio.create_task(
                     self._message_listener()
                 )
                 break
             except OSError as e:
                 if _connection_attempts == self._max_connection_retries:
                     raise ProviderConnectionError(
-                        f"Could not connect to endpoint: {self.endpoint_uri}. "
+                        f"Could not connect to: {self.ipc_path}. "
                         f"Retries exceeded max of {self._max_connection_retries}."
                     ) from e
                 self.logger.info(
-                    f"Could not connect to endpoint: {self.endpoint_uri}. Retrying in "
+                    f"Could not connect to: {self.ipc_path}. Retrying in "
                     f"{round(_backoff_time, 1)} seconds.",
                     exc_info=True,
                 )
                 await asyncio.sleep(_backoff_time)
                 _backoff_time *= _backoff_rate_change
 
     async def disconnect(self) -> None:
         if self._writer and not self._writer.is_closing():
             self._writer.close()
             await self._writer.wait_closed()
             self._writer = None
-            self.logger.debug(
-                f'Successfully disconnected from endpoint: "{self.endpoint_uri}'
-            )
+            self.logger.debug(f'Successfully disconnected from : "{self.ipc_path}')
 
         try:
             self._message_listener_task.cancel()
             await self._message_listener_task
             self._reader = None
         except (asyncio.CancelledError, StopAsyncIteration):
             pass
```

### Comparing `web3-7.0.0b3/web3/providers/persistent/persistent.py` & `web3-7.0.0b4/web3/providers/persistent/persistent.py`

 * *Files 13% similar despite different names*

```diff
@@ -26,15 +26,14 @@
 
 DEFAULT_PERSISTENT_CONNECTION_TIMEOUT = 30.0
 
 
 class PersistentConnectionProvider(AsyncJSONBaseProvider, ABC):
     logger = logging.getLogger("web3.providers.PersistentConnectionProvider")
     has_persistent_connection = True
-    endpoint_uri: Optional[str] = None
 
     _request_processor: RequestProcessor
     _message_listener_task: Optional["asyncio.Task[None]"] = None
     _listen_event: asyncio.Event = asyncio.Event()
 
     def __init__(
         self,
@@ -46,14 +45,25 @@
         self._request_processor = RequestProcessor(
             self,
             subscription_response_queue_size=subscription_response_queue_size,
         )
         self.request_timeout = request_timeout
         self.silence_listener_task_exceptions = silence_listener_task_exceptions
 
+    def get_endpoint_uri_or_ipc_path(self) -> str:
+        if hasattr(self, "endpoint_uri"):
+            return str(self.endpoint_uri)
+        elif hasattr(self, "ipc_path"):
+            return str(self.ipc_path)
+        else:
+            raise AttributeError(
+                "`PersistentConnectionProvider` must have either `endpoint_uri` or "
+                "`ipc_path` attribute."
+            )
+
     async def connect(self) -> None:
         raise NotImplementedError("Must be implemented by subclasses")
 
     async def disconnect(self) -> None:
         raise NotImplementedError("Must be implemented by subclasses")
 
     async def _message_listener(self) -> None:
```

### Comparing `web3-7.0.0b3/web3/providers/persistent/persistent_connection.py` & `web3-7.0.0b4/web3/providers/persistent/persistent_connection.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/providers/persistent/request_processor.py` & `web3-7.0.0b4/web3/providers/persistent/request_processor.py`

 * *Files 2% similar despite different names*

```diff
@@ -11,14 +11,17 @@
     Tuple,
 )
 
 from web3._utils.caching import (
     RequestInformation,
     generate_cache_key,
 )
+from web3.exceptions import (
+    Web3ValueError,
+)
 from web3.types import (
     RPCEndpoint,
     RPCResponse,
 )
 from web3.utils import (
     SimpleCache,
 )
@@ -132,17 +135,17 @@
 
     def get_request_information_for_response(
         self,
         response: RPCResponse,
     ) -> RequestInformation:
         if "method" in response and response["method"] == "eth_subscription":
             if "params" not in response:
-                raise ValueError("Subscription response must have params field")
+                raise Web3ValueError("Subscription response must have params field")
             if "subscription" not in response["params"]:
-                raise ValueError(
+                raise Web3ValueError(
                     "Subscription response params must have subscription field"
                 )
 
             # retrieve the request info from the cache using the subscription id
             cache_key = generate_cache_key(response["params"]["subscription"])
             request_info = (
                 # don't pop the request info from the cache, since we need to keep it
@@ -262,15 +265,15 @@
 
             self._provider.logger.debug(
                 "Subscription response popped from queue to be processed:\n"
                 f"    raw_response={raw_response}"
             )
         else:
             if not cache_key:
-                raise ValueError(
+                raise Web3ValueError(
                     "Must provide cache key when popping a non-subscription response."
                 )
 
             raw_response = self._request_response_cache.pop(cache_key)
             if raw_response is not None:
                 self._provider.logger.debug(
                     "Cached response popped from cache to be processed:\n"
@@ -279,16 +282,13 @@
                 )
 
         return raw_response
 
     # request processor class methods
 
     def clear_caches(self) -> None:
-        """
-        Clear the request processor caches.
-        """
-
+        """Clear the request processor caches."""
         self._request_information_cache.clear()
         self._request_response_cache.clear()
         self._subscription_response_queue = asyncio.Queue(
             maxsize=self._subscription_response_queue.maxsize
         )
```

### Comparing `web3-7.0.0b3/web3/providers/persistent/utils.py` & `web3-7.0.0b4/web3/providers/persistent/utils.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/providers/persistent/websocket.py` & `web3-7.0.0b4/web3/providers/persistent/websocket.py`

 * *Files 2% similar despite different names*

```diff
@@ -67,17 +67,17 @@
     def __init__(
         self,
         endpoint_uri: Optional[Union[URI, str]] = None,
         websocket_kwargs: Optional[Dict[str, Any]] = None,
         # `PersistentConnectionProvider` kwargs can be passed through
         **kwargs: Any,
     ) -> None:
-        self.endpoint_uri = URI(endpoint_uri)
-        if self.endpoint_uri is None:
-            self.endpoint_uri = get_default_endpoint()
+        self.endpoint_uri = (
+            URI(endpoint_uri) if endpoint_uri is not None else get_default_endpoint()
+        )
 
         if not any(
             self.endpoint_uri.startswith(prefix)
             for prefix in VALID_WEBSOCKET_URI_PREFIXES
         ):
             raise Web3ValidationError(
                 "WebSocket endpoint uri must begin with 'ws://' or 'wss://': "
```

### Comparing `web3-7.0.0b3/web3/providers/rpc/async_rpc.py` & `web3-7.0.0b4/web3/providers/rpc/async_rpc.py`

 * *Files 26% similar despite different names*

```diff
@@ -16,14 +16,18 @@
 from eth_typing import (
     URI,
 )
 from eth_utils import (
     to_dict,
 )
 
+from web3._utils.empty import (
+    Empty,
+    empty,
+)
 from web3._utils.http import (
     construct_user_agent,
 )
 from web3._utils.request import (
     async_cache_and_return_session as _async_cache_and_return_session,
     async_make_post_request,
     get_default_http_endpoint,
@@ -50,40 +54,53 @@
     endpoint_uri = None
     _request_kwargs = None
 
     def __init__(
         self,
         endpoint_uri: Optional[Union[URI, str]] = None,
         request_kwargs: Optional[Any] = None,
-        exception_retry_configuration: Optional[
-            ExceptionRetryConfiguration
-        ] = ExceptionRetryConfiguration(errors=(ClientError, TimeoutError)),
+        exception_retry_configuration: Union[
+            ExceptionRetryConfiguration, Empty
+        ] = empty,
     ) -> None:
         if endpoint_uri is None:
             self.endpoint_uri = get_default_http_endpoint()
         else:
             self.endpoint_uri = URI(endpoint_uri)
 
         self._request_kwargs = request_kwargs or {}
-        self.exception_retry_configuration = exception_retry_configuration
+        self._exception_retry_configuration = exception_retry_configuration
 
         super().__init__()
 
     async def cache_async_session(self, session: ClientSession) -> ClientSession:
         return await _async_cache_and_return_session(self.endpoint_uri, session)
 
     def __str__(self) -> str:
         return f"RPC connection {self.endpoint_uri}"
 
+    @property
+    def exception_retry_configuration(self) -> ExceptionRetryConfiguration:
+        if isinstance(self._exception_retry_configuration, Empty):
+            self._exception_retry_configuration = ExceptionRetryConfiguration(
+                errors=(ClientError, TimeoutError)
+            )
+        return self._exception_retry_configuration
+
+    @exception_retry_configuration.setter
+    def exception_retry_configuration(
+        self, value: Union[ExceptionRetryConfiguration, Empty]
+    ) -> None:
+        self._exception_retry_configuration = value
+
     @to_dict
     def get_request_kwargs(self) -> Iterable[Tuple[str, Any]]:
         if "headers" not in self._request_kwargs:
             yield "headers", self.get_request_headers()
-        for key, value in self._request_kwargs.items():
-            yield key, value
+        yield from self._request_kwargs.items()
 
     def get_request_headers(self) -> Dict[str, str]:
         return {
             "Content-Type": "application/json",
             "User-Agent": construct_user_agent(type(self)),
         }
```

### Comparing `web3-7.0.0b3/web3/providers/rpc/rpc.py` & `web3-7.0.0b4/web3/providers/rpc/rpc.py`

 * *Files 7% similar despite different names*

```diff
@@ -14,14 +14,18 @@
     URI,
 )
 from eth_utils import (
     to_dict,
 )
 import requests
 
+from web3._utils.empty import (
+    Empty,
+    empty,
+)
 from web3._utils.http import (
     construct_user_agent,
 )
 from web3._utils.request import (
     cache_and_return_session,
     get_default_http_endpoint,
     make_post_request,
@@ -47,57 +51,64 @@
         Middleware,
     )
 
 
 class HTTPProvider(JSONBaseProvider):
     logger = logging.getLogger("web3.providers.HTTPProvider")
     endpoint_uri = None
-
-    _request_args = None
     _request_kwargs = None
 
-    exception_retry_configuration: Optional[ExceptionRetryConfiguration] = None
-
     def __init__(
         self,
         endpoint_uri: Optional[Union[URI, str]] = None,
         request_kwargs: Optional[Any] = None,
         session: Optional[Any] = None,
-        exception_retry_configuration: Optional[ExceptionRetryConfiguration] = (
-            ExceptionRetryConfiguration(
-                errors=(
-                    ConnectionError,
-                    requests.HTTPError,
-                    requests.Timeout,
-                )
-            )
-        ),
+        exception_retry_configuration: Union[
+            ExceptionRetryConfiguration, Empty
+        ] = empty,
     ) -> None:
         if endpoint_uri is None:
             self.endpoint_uri = get_default_http_endpoint()
         else:
             self.endpoint_uri = URI(endpoint_uri)
 
         self._request_kwargs = request_kwargs or {}
-        self.exception_retry_configuration = exception_retry_configuration
+        self._exception_retry_configuration = exception_retry_configuration
 
         if session:
             cache_and_return_session(self.endpoint_uri, session)
 
         super().__init__()
 
     def __str__(self) -> str:
         return f"RPC connection {self.endpoint_uri}"
 
+    @property
+    def exception_retry_configuration(self) -> ExceptionRetryConfiguration:
+        if isinstance(self._exception_retry_configuration, Empty):
+            self._exception_retry_configuration = ExceptionRetryConfiguration(
+                errors=(
+                    ConnectionError,
+                    requests.HTTPError,
+                    requests.Timeout,
+                )
+            )
+        return self._exception_retry_configuration
+
+    @exception_retry_configuration.setter
+    def exception_retry_configuration(
+        self, value: Union[ExceptionRetryConfiguration, Empty]
+    ) -> None:
+        self._exception_retry_configuration = value
+
     @to_dict
     def get_request_kwargs(self) -> Iterable[Tuple[str, Any]]:
         if "headers" not in self._request_kwargs:
             yield "headers", self.get_request_headers()
-        for key, value in self._request_kwargs.items():
-            yield key, value
+        yield from self._request_kwargs.items()
 
     def get_request_headers(self) -> Dict[str, str]:
         return {
             "Content-Type": "application/json",
             "User-Agent": construct_user_agent(type(self)),
         }
```

### Comparing `web3-7.0.0b3/web3/providers/rpc/utils.py` & `web3-7.0.0b4/web3/providers/rpc/utils.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/scripts/release/test_package.py` & `web3-7.0.0b4/web3/scripts/release/test_package.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/testing.py` & `web3-7.0.0b4/web3/testing.py`

 * *Files 12% similar despite different names*

```diff
@@ -8,25 +8,25 @@
 from web3.module import (
     Module,
 )
 
 
 class Testing(Module):
     def timeTravel(self, timestamp: int) -> None:
-        return self.w3.manager.request_blocking(RPC.testing_timeTravel, [timestamp])
+        self.w3.manager.request_blocking(RPC.testing_timeTravel, [timestamp])
 
     def mine(self, num_blocks: int = 1) -> None:
-        return self.w3.manager.request_blocking(RPC.evm_mine, [num_blocks])
+        self.w3.manager.request_blocking(RPC.evm_mine, [num_blocks])
 
     def snapshot(self) -> int:
         self.last_snapshot_idx = self.w3.manager.request_blocking(RPC.evm_snapshot, [])
         return self.last_snapshot_idx
 
     def reset(self) -> None:
-        return self.w3.manager.request_blocking(RPC.evm_reset, [])
+        self.w3.manager.request_blocking(RPC.evm_reset, [])
 
     def revert(self, snapshot_idx: Optional[int] = None) -> None:
         if snapshot_idx is None:
             revert_target = self.last_snapshot_idx
         else:
             revert_target = snapshot_idx
-        return self.w3.manager.request_blocking(RPC.evm_revert, [revert_target])
+        self.w3.manager.request_blocking(RPC.evm_revert, [revert_target])
```

### Comparing `web3-7.0.0b3/web3/tools/benchmark/main.py` & `web3-7.0.0b4/web3/tools/benchmark/main.py`

 * *Files 18% similar despite different names*

```diff
@@ -116,50 +116,54 @@
             )
             async_coinbase = loop.run_until_complete(async_w3_http.eth.coinbase)
 
             methods = [
                 {
                     "name": "eth_gasPrice",
                     "params": {},
-                    "exec": lambda: w3_http.eth.gas_price,
-                    "async_exec": lambda: async_w3_http.eth.gas_price,
+                    "exec": lambda w3_http=w3_http: w3_http.eth.gas_price,
+                    "async_exec": lambda async_w3_http=async_w3_http: async_w3_http.eth.gas_price,  # noqa: E501
                 },
                 {
                     "name": "eth_sendTransaction",
                     "params": {},
-                    "exec": lambda: w3_http.eth.send_transaction(
+                    "exec": lambda w3_http=w3_http, coinbase=coinbase: w3_http.eth.send_transaction(  # noqa: E501
                         {
                             "to": "0xd3CdA913deB6f67967B99D67aCDFa1712C293601",
                             "from": coinbase,
                             "value": Wei(1),
                         }
                     ),
-                    "async_exec": lambda: async_w3_http.eth.send_transaction(
+                    "async_exec": lambda async_w3_http=async_w3_http, async_coinbase=async_coinbase: async_w3_http.eth.send_transaction(  # noqa: E501
                         {
                             "to": "0xd3CdA913deB6f67967B99D67aCDFa1712C293601",
                             "from": async_coinbase,
                             "value": Wei(1),
                         }
                     ),
                 },
                 {
                     "name": "eth_blockNumber",
                     "params": {},
-                    "exec": lambda: w3_http.eth.block_number,
-                    "async_exec": lambda: async_w3_http.eth.block_number,
+                    "exec": lambda w3_http=w3_http: w3_http.eth.block_number,
+                    "async_exec": lambda async_w3_http=async_w3_http: async_w3_http.eth.block_number,  # noqa: E501
                 },
                 {
                     "name": "eth_getBlock",
                     "params": {},
-                    "exec": lambda: w3_http.eth.get_block(1),
-                    "async_exec": lambda: async_w3_http.eth.get_block(1),
+                    "exec": lambda w3_http=w3_http: w3_http.eth.get_block(1),
+                    "async_exec": lambda async_w3_http=async_w3_http: async_w3_http.eth.get_block(  # noqa: E501
+                        1
+                    ),
                 },
             ]
 
-            def benchmark(method: Dict[str, Any]) -> None:
+            def benchmark(
+                method: Dict[str, Any], loop: asyncio.AbstractEventLoop = loop
+            ) -> None:
                 outcomes: Dict[str, Union[str, float]] = defaultdict(lambda: "N/A")
                 outcomes["name"] = method["name"]
                 outcomes["HTTPProvider"] = sync_benchmark(
                     method["exec"],
                     num_calls,
                 )
                 outcomes["AsyncHTTPProvider"] = loop.run_until_complete(
```

### Comparing `web3-7.0.0b3/web3/tools/benchmark/node.py` & `web3-7.0.0b4/web3/tools/benchmark/node.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/tools/benchmark/reporting.py` & `web3-7.0.0b4/web3/tools/benchmark/reporting.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/tools/benchmark/utils.py` & `web3-7.0.0b4/web3/tools/benchmark/utils.py`

 * *Files 6% similar despite different names*

```diff
@@ -13,15 +13,15 @@
 def wait_for_socket(ipc_path: str, timeout: int = 30) -> None:
     start = time.time()
     while time.time() < start + timeout:
         try:
             sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
             sock.connect(ipc_path)
             sock.settimeout(timeout)
-        except (FileNotFoundError, socket.error):
+        except OSError:
             time.sleep(0.01)
         else:
             break
 
 
 def wait_for_http(endpoint_uri: str, timeout: int = 60) -> None:
     start = time.time()
```

### Comparing `web3-7.0.0b3/web3/tracing.py` & `web3-7.0.0b4/web3/tracing.py`

 * *Files 18% similar despite different names*

```diff
@@ -49,18 +49,18 @@
         return self._default_block
 
     @default_block.setter
     def default_block(self, value: BlockIdentifier) -> None:
         self._default_block = value
 
     def trace_replay_transaction_munger(
-        self,
-        block_identifier: Union[_Hash32, BlockIdentifier],
-        mode: TraceMode = ["trace"],
+        self, block_identifier: Union[_Hash32, BlockIdentifier], mode: TraceMode = None
     ) -> Tuple[Union[BlockIdentifier, _Hash32], TraceMode]:
+        if mode is None:
+            mode = ["trace"]
         return (block_identifier, mode)
 
     trace_replay_transaction: Method[Callable[..., BlockTrace]] = Method(
         RPC.trace_replayTransaction,
         mungers=[trace_replay_transaction_munger],
     )
 
@@ -82,17 +82,19 @@
         RPC.trace_transaction,
         mungers=[default_root_munger],
     )
 
     def trace_call_munger(
         self,
         transaction: TxParams,
-        mode: TraceMode = ["trace"],
+        mode: TraceMode = None,
         block_identifier: Optional[BlockIdentifier] = None,
     ) -> Tuple[TxParams, TraceMode, BlockIdentifier]:
+        if mode is None:
+            mode = ["trace"]
         if "from" not in transaction and is_checksum_address(
             self.w3.eth.default_account
         ):
             transaction = assoc(transaction, "from", self.w3.eth.default_account)
 
         if block_identifier is None:
             block_identifier = self.default_block
@@ -101,15 +103,17 @@
 
     trace_call: Method[Callable[..., BlockTrace]] = Method(
         RPC.trace_call,
         mungers=[trace_call_munger],
     )
 
     def trace_transactions_munger(
-        self, raw_transaction: HexStr, mode: TraceMode = ["trace"]
+        self, raw_transaction: HexStr, mode: TraceMode = None
     ) -> Tuple[HexStr, TraceMode]:
+        if mode is None:
+            mode = ["trace"]
         return raw_transaction, mode
 
     trace_raw_transaction: Method[Callable[..., BlockTrace]] = Method(
         RPC.trace_rawTransaction,
         mungers=[trace_transactions_munger],
     )
```

### Comparing `web3-7.0.0b3/web3/types.py` & `web3-7.0.0b4/web3/types.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,18 +1,20 @@
 from typing import (
     TYPE_CHECKING,
     Any,
     Callable,
     Coroutine,
     Dict,
     List,
+    Literal,
     NewType,
     Optional,
     Sequence,
     Type,
+    TypedDict,
     TypeVar,
     Union,
 )
 
 from eth_typing import (
     Address,
     BlockNumber,
@@ -21,17 +23,15 @@
     HexStr,
 )
 from hexbytes import (
     HexBytes,
 )
 
 from web3._utils.compat import (
-    Literal,
     NotRequired,
-    TypedDict,
 )
 from web3._utils.function_identifiers import (
     FallbackFn,
     ReceiveFn,
 )
 
 if TYPE_CHECKING:
@@ -161,43 +161,42 @@
     total=False,
 )
 
 # syntax b/c "from" keyword not allowed w/ class construction
 TxParams = TypedDict(
     "TxParams",
     {
+        "accessList": AccessList,
+        "blobVersionedHashes": Sequence[Union[str, HexStr, bytes, HexBytes]],
         "chainId": int,
         "data": Union[bytes, HexStr],
         # addr or ens
         "from": Union[Address, ChecksumAddress, str],
         "gas": int,
         # legacy pricing
         "gasPrice": Wei,
+        "maxFeePerBlobGas": Union[str, Wei],
         # dynamic fee pricing
         "maxFeePerGas": Union[str, Wei],
         "maxPriorityFeePerGas": Union[str, Wei],
         "nonce": Nonce,
         # addr or ens
         "to": Union[Address, ChecksumAddress, str],
         "type": Union[int, HexStr],
         "value": Wei,
     },
     total=False,
 )
 
 
-WithdrawalData = TypedDict(
-    "WithdrawalData",
-    {
-        "index": int,
-        "validator_index": int,
-        "address": ChecksumAddress,
-        "amount": Gwei,
-    },
-)
+class WithdrawalData(TypedDict):
+    index: int
+    validator_index: int
+    address: ChecksumAddress
+    amount: Gwei
 
 
 class BlockData(TypedDict, total=False):
     baseFeePerGas: Wei
     difficulty: int
     extraData: HexBytes
     gasLimit: int
@@ -216,14 +215,17 @@
     timestamp: Timestamp
     totalDifficulty: int
     transactions: Union[Sequence[HexBytes], Sequence[TxData]]
     transactionsRoot: HexBytes
     uncles: Sequence[HexBytes]
     withdrawals: Sequence[WithdrawalData]
     withdrawalsRoot: HexBytes
+    parentBeaconBlockRoot: HexBytes
+    blobGasUsed: int
+    excessBlobGas: int
 
     # ExtraDataToPOAMiddleware replaces extraData w/ proofOfAuthorityData
     proofOfAuthorityData: HexBytes
 
 
 class LogReceipt(TypedDict):
     address: ChecksumAddress
@@ -336,25 +338,20 @@
 class FeeHistory(TypedDict):
     baseFeePerGas: List[Wei]
     gasUsedRatio: List[float]
     oldestBlock: BlockNumber
     reward: List[List[Wei]]
 
 
-StateOverrideParams = TypedDict(
-    "StateOverrideParams",
-    {
-        "balance": Optional[Wei],
-        "nonce": Optional[int],
-        "code": Optional[Union[bytes, HexStr]],
-        "state": Optional[Dict[HexStr, HexStr]],
-        "stateDiff": Optional[Dict[HexStr, HexStr]],
-    },
-    total=False,
-)
+class StateOverrideParams(TypedDict, total=False):
+    balance: Optional[Wei]
+    nonce: Optional[int]
+    code: Optional[Union[bytes, HexStr]]
+    state: Optional[Dict[HexStr, HexStr]]
+    stateDiff: Optional[Dict[HexStr, HexStr]]
 
 
 StateOverride = Dict[ChecksumAddress, StateOverrideParams]
 
 
 GasPriceStrategy = Union[
     Callable[["Web3", TxParams], Wei], Callable[["AsyncWeb3", TxParams], Wei]
```

### Comparing `web3-7.0.0b3/web3/utils/address.py` & `web3-7.0.0b4/web3/utils/address.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/utils/async_exception_handling.py` & `web3-7.0.0b4/web3/utils/async_exception_handling.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/utils/caching.py` & `web3-7.0.0b4/web3/utils/caching.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3/utils/exception_handling.py` & `web3-7.0.0b4/web3/utils/exception_handling.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3.egg-info/PKG-INFO` & `web3-7.0.0b4/web3.egg-info/PKG-INFO`

 * *Files 18% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: web3
-Version: 7.0.0b3
+Version: 7.0.0b4
 Summary: web3.py
 Home-page: https://github.com/ethereum/web3.py
 Author: The Ethereum Foundation
 Author-email: snakecharmers@ethereum.org
 License: MIT
 Keywords: ethereum
 Classifier: Development Status :: 5 - Production/Stable
@@ -16,80 +16,65 @@
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Requires-Python: >=3.8
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: aiohttp>=3.7.4.post0
-Requires-Dist: eth-abi>=4.0.0
-Requires-Dist: eth-account>=0.8.0
+Requires-Dist: eth-abi>=5.0.1
+Requires-Dist: eth-account>=0.12.0
 Requires-Dist: eth-hash[pycryptodome]>=0.5.1
-Requires-Dist: eth-typing>=3.0.0
+Requires-Dist: eth-typing>=4.0.0
 Requires-Dist: eth-utils>=4.0.0
-Requires-Dist: hexbytes<0.4.0,>=0.1.0
+Requires-Dist: hexbytes>=1.2.0
 Requires-Dist: pydantic>=2.4.0
 Requires-Dist: pywin32>=223; platform_system == "Windows"
 Requires-Dist: requests>=2.16.0
 Requires-Dist: typing-extensions>=4.0.1
 Requires-Dist: websockets>=10.0.0
 Requires-Dist: pyunormalize>=15.0.0
 Provides-Extra: tester
-Requires-Dist: eth-tester[py-evm]==v0.10.0-b.3; extra == "tester"
+Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "tester"
 Requires-Dist: py-geth>=4.1.0; extra == "tester"
-Provides-Extra: linter
-Requires-Dist: black>=22.1.0; extra == "linter"
-Requires-Dist: blocklint>=0.2.4; extra == "linter"
-Requires-Dist: flake8==3.8.3; extra == "linter"
-Requires-Dist: isort>=5.11.0; extra == "linter"
-Requires-Dist: mypy==1.4.1; extra == "linter"
-Requires-Dist: types-setuptools>=57.4.4; extra == "linter"
-Requires-Dist: types-requests>=2.26.1; extra == "linter"
 Provides-Extra: docs
 Requires-Dist: sphinx>=5.3.0; extra == "docs"
 Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "docs"
 Requires-Dist: towncrier<22,>=21; extra == "docs"
 Provides-Extra: dev
-Requires-Dist: eth-tester[py-evm]==v0.10.0-b.3; extra == "dev"
+Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "dev"
 Requires-Dist: py-geth>=4.1.0; extra == "dev"
-Requires-Dist: black>=22.1.0; extra == "dev"
-Requires-Dist: blocklint>=0.2.4; extra == "dev"
-Requires-Dist: flake8==3.8.3; extra == "dev"
-Requires-Dist: isort>=5.11.0; extra == "dev"
-Requires-Dist: mypy==1.4.1; extra == "dev"
-Requires-Dist: types-setuptools>=57.4.4; extra == "dev"
-Requires-Dist: types-requests>=2.26.1; extra == "dev"
 Requires-Dist: sphinx>=5.3.0; extra == "dev"
 Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "dev"
 Requires-Dist: towncrier<22,>=21; extra == "dev"
+Requires-Dist: build>=0.9.0; extra == "dev"
 Requires-Dist: bumpversion; extra == "dev"
 Requires-Dist: flaky>=3.7.0; extra == "dev"
 Requires-Dist: hypothesis>=3.31.2; extra == "dev"
-Requires-Dist: importlib-metadata<5.0; python_version < "3.8" and extra == "dev"
-Requires-Dist: pytest>=7.0.0; extra == "dev"
+Requires-Dist: pre-commit>=3.4.0; extra == "dev"
 Requires-Dist: pytest-asyncio<0.23,>=0.18.1; extra == "dev"
 Requires-Dist: pytest-mock>=1.10; extra == "dev"
 Requires-Dist: pytest-watch>=4.2; extra == "dev"
 Requires-Dist: pytest-xdist>=1.29; extra == "dev"
+Requires-Dist: pytest>=7.0.0; extra == "dev"
 Requires-Dist: setuptools>=38.6.0; extra == "dev"
 Requires-Dist: tox>=3.18.0; extra == "dev"
 Requires-Dist: tqdm>4.32; extra == "dev"
 Requires-Dist: twine>=1.13; extra == "dev"
-Requires-Dist: build>=0.9.0; extra == "dev"
 
 # web3.py
 
 [![Documentation Status](https://readthedocs.org/projects/web3py/badge/?version=latest)](https://web3py.readthedocs.io/en/latest/?badge=latest)
 [![Discord](https://img.shields.io/discord/809793915578089484?color=blue&label=chat&logo=discord&logoColor=white)](https://discord.gg/GHryRvPB84)
 [![Build Status](https://circleci.com/gh/ethereum/web3.py.svg?style=shield)](https://circleci.com/gh/ethereum/web3.py)
 
 A Python library for interacting with Ethereum.
 
--   Python 3.8+ support
+- Python 3.8+ support
 
----
+______________________________________________________________________
 
 ## Quickstart
 
 [Get started in 5 minutes](https://web3py.readthedocs.io/en/latest/quickstart.html) or
 [take a tour](https://web3py.readthedocs.io/en/latest/overview.html) of the library.
 
 ## Documentation
@@ -99,10 +84,10 @@
 ## Want to help?
 
 Want to file a bug, contribute some code, or improve documentation? Excellent! Read up on our
 guidelines for [contributing](https://web3py.readthedocs.io/en/latest/contributing.html),
 then check out issues that are labeled
 [Good First Issue](https://github.com/ethereum/web3.py/issues?q=is%3Aissue+is%3Aopen+label%3A%22Good+First+Issue%22).
 
----
+______________________________________________________________________
 
 #### Questions on implementation or usage? Join the conversation on [discord](https://discord.gg/GHryRvPB84).
```

### Comparing `web3-7.0.0b3/web3.egg-info/SOURCES.txt` & `web3-7.0.0b4/web3.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b3/web3.egg-info/requires.txt` & `web3-7.0.0b4/web3.egg-info/requires.txt`

 * *Files 24% similar despite different names*

```diff
@@ -1,63 +1,45 @@
 aiohttp>=3.7.4.post0
-eth-abi>=4.0.0
-eth-account>=0.8.0
+eth-abi>=5.0.1
+eth-account>=0.12.0
 eth-hash[pycryptodome]>=0.5.1
-eth-typing>=3.0.0
+eth-typing>=4.0.0
 eth-utils>=4.0.0
-hexbytes<0.4.0,>=0.1.0
+hexbytes>=1.2.0
 pydantic>=2.4.0
 requests>=2.16.0
 typing-extensions>=4.0.1
 websockets>=10.0.0
 pyunormalize>=15.0.0
 
 [:platform_system == "Windows"]
 pywin32>=223
 
 [dev]
-eth-tester[py-evm]==v0.10.0-b.3
+eth-tester[py-evm]<0.12.0b1,>=0.11.0b1
 py-geth>=4.1.0
-black>=22.1.0
-blocklint>=0.2.4
-flake8==3.8.3
-isort>=5.11.0
-mypy==1.4.1
-types-setuptools>=57.4.4
-types-requests>=2.26.1
 sphinx>=5.3.0
 sphinx_rtd_theme>=1.0.0
 towncrier<22,>=21
+build>=0.9.0
 bumpversion
 flaky>=3.7.0
 hypothesis>=3.31.2
-pytest>=7.0.0
+pre-commit>=3.4.0
 pytest-asyncio<0.23,>=0.18.1
 pytest-mock>=1.10
 pytest-watch>=4.2
 pytest-xdist>=1.29
+pytest>=7.0.0
 setuptools>=38.6.0
 tox>=3.18.0
 tqdm>4.32
 twine>=1.13
-build>=0.9.0
-
-[dev:python_version < "3.8"]
-importlib-metadata<5.0
 
 [docs]
 sphinx>=5.3.0
 sphinx_rtd_theme>=1.0.0
 towncrier<22,>=21
 
-[linter]
-black>=22.1.0
-blocklint>=0.2.4
-flake8==3.8.3
-isort>=5.11.0
-mypy==1.4.1
-types-setuptools>=57.4.4
-types-requests>=2.26.1
-
 [tester]
-eth-tester[py-evm]==v0.10.0-b.3
+eth-tester[py-evm]<0.12.0b1,>=0.11.0b1
 py-geth>=4.1.0
```

