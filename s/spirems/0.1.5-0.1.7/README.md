# Comparing `tmp/spirems-0.1.5-py3-none-any.whl.zip` & `tmp/spirems-0.1.7-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,22 +1,22 @@
-Zip file size: 562698 bytes, number of entries: 44
--rw-rw-rw-  2.0 fat      546 b- defN 24-Apr-08 06:18 spirems/__init__.py
+Zip file size: 657645 bytes, number of entries: 47
+-rw-rw-rw-  2.0 fat      546 b- defN 24-Apr-16 14:45 spirems/__init__.py
 -rw-rw-rw-  2.0 fat      878 b- defN 24-Mar-31 06:11 spirems/error_code.py
 -rw-rw-rw-  2.0 fat     1009 b- defN 24-Apr-04 14:11 spirems/log.py
 -rw-rw-rw-  2.0 fat     4807 b- defN 24-Mar-31 09:46 spirems/msg_helper.py
--rw-rw-rw-  2.0 fat     8866 b- defN 24-Apr-08 05:55 spirems/publisher.py
+-rw-rw-rw-  2.0 fat     8866 b- defN 24-Apr-09 11:43 spirems/publisher.py
 -rw-rw-rw-  2.0 fat    16403 b- defN 24-Apr-08 05:56 spirems/server.py
 -rw-rw-rw-  2.0 fat     5255 b- defN 24-Mar-31 18:32 spirems/sms.py
 -rw-rw-rw-  2.0 fat     6924 b- defN 24-Apr-08 05:56 spirems/subscriber.py
 -rw-rw-rw-  2.0 fat       48 b- defN 24-Apr-04 14:27 spirems/image_io/__init__.py
--rw-rw-rw-  2.0 fat     7252 b- defN 24-Apr-06 11:36 spirems/image_io/a2rl_gs.py
--rw-rw-rw-  2.0 fat     3851 b- defN 24-Apr-07 09:34 spirems/image_io/a2rl_live.py
+-rw-rw-rw-  2.0 fat     7295 b- defN 24-Apr-08 08:03 spirems/image_io/a2rl_gs.py
+-rw-rw-rw-  2.0 fat     5576 b- defN 24-Apr-16 11:04 spirems/image_io/a2rl_live.py
 -rw-rw-rw-  2.0 fat     1440 b- defN 24-Apr-06 11:25 spirems/image_io/adaptor.py
 -rw-rw-rw-  2.0 fat      551 b- defN 24-Apr-04 14:49 spirems/image_io/recv_testcase.py
--rw-rw-rw-  2.0 fat     2257 b- defN 24-Apr-07 07:17 spirems/image_io/visual_helper.py
+-rw-rw-rw-  2.0 fat    11309 b- defN 24-Apr-11 11:22 spirems/image_io/visual_helper.py
 -rw-rw-rw-  2.0 fat       17 b- defN 24-Mar-31 07:05 spirems/logs/README.md
 -rw-rw-rw-  2.0 fat       54 b- defN 24-Mar-25 14:45 spirems/msgs/_sys_msgs/HeartBeat.json
 -rw-rw-rw-  2.0 fat       99 b- defN 24-Mar-25 17:12 spirems/msgs/_sys_msgs/Publisher.json
 -rw-rw-rw-  2.0 fat       92 b- defN 24-Apr-05 16:23 spirems/msgs/_sys_msgs/Result.json
 -rw-rw-rw-  2.0 fat       57 b- defN 24-Mar-27 09:42 spirems/msgs/_sys_msgs/SmsTopicList.json
 -rw-rw-rw-  2.0 fat      100 b- defN 24-Mar-25 17:13 spirems/msgs/_sys_msgs/Subscriber.json
 -rw-rw-rw-  2.0 fat       52 b- defN 24-Mar-27 15:25 spirems/msgs/_sys_msgs/Suspend.json
@@ -29,18 +29,21 @@
 -rw-rw-rw-  2.0 fat       48 b- defN 24-Mar-24 10:35 spirems/msgs/std_msgs/Null.json
 -rw-rw-rw-  2.0 fat       64 b- defN 24-Mar-26 11:39 spirems/msgs/std_msgs/Number.json
 -rw-rw-rw-  2.0 fat       76 b- defN 24-Mar-24 10:30 spirems/msgs/std_msgs/NumberMultiArray.json
 -rw-rw-rw-  2.0 fat       63 b- defN 24-Mar-24 10:30 spirems/msgs/std_msgs/String.json
 -rw-rw-rw-  2.0 fat       75 b- defN 24-Mar-24 10:30 spirems/msgs/std_msgs/StringMultiArray.json
 -rw-rw-rw-  2.0 fat   116940 b- defN 24-Mar-12 14:41 spirems/res/fradmcn.ttf
 -rw-rw-rw-  2.0 fat   175292 b- defN 22-May-07 05:20 spirems/res/msyh_boot.ttf
+-rw-rw-rw-  2.0 fat   394336 b- defN 24-Apr-09 11:22 spirems/res/optm_path.json
 -rw-rw-rw-  2.0 fat   353153 b- defN 24-Apr-06 11:11 spirems/res/racecar.jpg
+-rw-rw-rw-  2.0 fat     5539 b- defN 24-Apr-09 11:12 spirems/res/yas_full_left.csv
+-rw-rw-rw-  2.0 fat     5252 b- defN 24-Apr-09 11:12 spirems/res/yas_full_right.csv
 -rw-rw-rw-  2.0 fat       48 b- defN 24-Apr-04 14:27 spirems/sys_monit/__init__.py
 -rw-rw-rw-  2.0 fat     2271 b- defN 24-Apr-05 09:09 spirems/sys_monit/a2rl_sys_monit.py
 -rw-rw-rw-  2.0 fat     3487 b- defN 24-Apr-03 02:38 spirems/sys_monit/psutil_pub.py
--rw-rw-rw-  2.0 fat     5241 b- defN 24-Apr-08 06:23 spirems-0.1.5.data/scripts/sms.py
--rw-rw-rw-  2.0 fat    11558 b- defN 24-Apr-08 06:23 spirems-0.1.5.dist-info/LICENSE
--rw-rw-rw-  2.0 fat     1248 b- defN 24-Apr-08 06:23 spirems-0.1.5.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 24-Apr-08 06:23 spirems-0.1.5.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        8 b- defN 24-Apr-08 06:23 spirems-0.1.5.dist-info/top_level.txt
--rw-rw-r--  2.0 fat     3750 b- defN 24-Apr-08 06:23 spirems-0.1.5.dist-info/RECORD
-44 files, 734439 bytes uncompressed, 556664 bytes compressed:  24.2%
+-rw-rw-rw-  2.0 fat     5241 b- defN 24-Apr-16 14:47 spirems-0.1.7.data/scripts/sms.py
+-rw-rw-rw-  2.0 fat    11558 b- defN 24-Apr-16 14:47 spirems-0.1.7.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat     1248 b- defN 24-Apr-16 14:47 spirems-0.1.7.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 24-Apr-16 14:47 spirems-0.1.7.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        8 b- defN 24-Apr-16 14:47 spirems-0.1.7.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     4009 b- defN 24-Apr-16 14:47 spirems-0.1.7.dist-info/RECORD
+47 files, 1150645 bytes uncompressed, 651213 bytes compressed:  43.4%
```

## zipnote {}

```diff
@@ -96,38 +96,47 @@
 
 Filename: spirems/res/fradmcn.ttf
 Comment: 
 
 Filename: spirems/res/msyh_boot.ttf
 Comment: 
 
+Filename: spirems/res/optm_path.json
+Comment: 
+
 Filename: spirems/res/racecar.jpg
 Comment: 
 
+Filename: spirems/res/yas_full_left.csv
+Comment: 
+
+Filename: spirems/res/yas_full_right.csv
+Comment: 
+
 Filename: spirems/sys_monit/__init__.py
 Comment: 
 
 Filename: spirems/sys_monit/a2rl_sys_monit.py
 Comment: 
 
 Filename: spirems/sys_monit/psutil_pub.py
 Comment: 
 
-Filename: spirems-0.1.5.data/scripts/sms.py
+Filename: spirems-0.1.7.data/scripts/sms.py
 Comment: 
 
-Filename: spirems-0.1.5.dist-info/LICENSE
+Filename: spirems-0.1.7.dist-info/LICENSE
 Comment: 
 
-Filename: spirems-0.1.5.dist-info/METADATA
+Filename: spirems-0.1.7.dist-info/METADATA
 Comment: 
 
-Filename: spirems-0.1.5.dist-info/WHEEL
+Filename: spirems-0.1.7.dist-info/WHEEL
 Comment: 
 
-Filename: spirems-0.1.5.dist-info/top_level.txt
+Filename: spirems-0.1.7.dist-info/top_level.txt
 Comment: 
 
-Filename: spirems-0.1.5.dist-info/RECORD
+Filename: spirems-0.1.7.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## spirems/__init__.py

```diff
@@ -6,13 +6,13 @@
 from spirems.subscriber import Subscriber
 from spirems.publisher import Publisher
 from spirems.server import Server
 from spirems.image_io.adaptor import cvimg2sms, sms2cvimg
 from spirems.msg_helper import get_all_msg_types
 
 
-__version__ = "0.1.5"
+__version__ = "0.1.7"
 
 __all__ = [
     'a2rl_pub', 'a2rl_sub', 'cvimg2sms', 'cvimg2sms', 'get_all_msg_types',
     'Subscriber', 'Publisher', 'Server'
 ]
```

## spirems/image_io/a2rl_gs.py

```diff
@@ -1,14 +1,15 @@
 #!/usr/bin/env python3
 # -*- coding:utf-8 -*-
 import numpy as np
 
 from spirems.subscriber import Subscriber
 from spirems.publisher import Publisher
 from spirems.image_io.adaptor import sms2cvimg
+from spirems.image_io.visual_helper import load_a2rl_logo
 from spirems import get_all_msg_types
 import time
 import cv2
 from PIL import ImageFont, ImageDraw, Image
 
 
 img2 = np.ones((720, 1280, 3), dtype=np.uint8) * 200
@@ -125,15 +126,15 @@
                      ip='47.91.115.171')  # 47.91.115.171
     sub2 = Subscriber('/a2rl/monit', 'std_msgs::NumberMultiArray', callback_monit,
                       ip='47.91.115.171')  # 47.91.115.171
     pub = Publisher('/signal/live_switch', 'std_msgs::Number',
                     ip='47.91.115.171')
     num_tpc = get_all_msg_types()['std_msgs::Number'].copy()
     running = True
-    default_img = cv2.imread('../res/racecar.jpg')
+    default_img = load_a2rl_logo()
     default_img = cv2.resize(default_img, (1280, 720))
     img = default_img
     while running:
         if img2_on and img2_ready and img2 is not None:
             img = img2.copy()
             img = cv2.resize(img, (1280, 720))
         img_show = load_menu(img)
```

## spirems/image_io/a2rl_live.py

```diff
@@ -1,14 +1,14 @@
 #!/usr/bin/env python3
 # -*- coding:utf-8 -*-
 from spirems.subscriber import Subscriber
 from spirems.publisher import Publisher
 from spirems.image_io.adaptor import sms2cvimg
 from spirems import get_all_msg_types
-from spirems.image_io.visual_helper import draw_charts
+from spirems.image_io.visual_helper import draw_charts, load_a2rl_logo, track_boundary_parse, draw_track_map
 import cv2
 import numpy as np
 
 
 img2 = np.ones((720, 1280, 3), dtype=np.uint8) * 200
 img2_on = False
 img2_ready = False
@@ -32,31 +32,72 @@
     cpu_temp = float(msg['data'][7])
     a2rl_visual["bar_chart_items"][0]['val'] = cpu_usage
     a2rl_visual["bar_chart_items"][1]['val'] = mem_left
     a2rl_visual["bar_chart_items"][2]['val'] = disk_left
     a2rl_visual["bar_chart_items"][3]['val'] = cpu_temp
 
 
+position_x = -122.2
+position_y = -627.5
+position_z = 0
+orientation_z = 0
+velocity = 0
+acceleration = 0
+
+
+def callback_ego_loc(msg):
+    global position_x, position_y, position_z, orientation_z, velocity, acceleration
+    position_x = msg['data'][0]
+    # print(position_x)
+    position_y = msg['data'][1]
+    # print(position_y)
+    # position_z = msg['data'][2]
+    orientation_z = msg['data'][2]
+    velocity_x = msg['data'][3]
+    # print(velocity_x)
+    velocity_y = msg['data'][4]
+    velocity = np.sqrt(velocity_x ** 2 + velocity_y ** 2)
+    acceleration_x = msg['data'][5]
+    acceleration_y = msg['data'][6]
+    acceleration = np.sqrt(acceleration_x ** 2 + acceleration_y ** 2)
+    ice_water_temp = msg['data'][7]
+    ice_oil_temp = msg['data'][8]
+    ice_engine_speed = msg['data'][9]
+    a2rl_visual["bar_chart_items"][4]['val'] = ice_water_temp
+    print(msg['data'])
+    a2rl_visual["bar_chart_items"][5]['val'] = ice_oil_temp
+    a2rl_visual["bar_chart_items"][6]['val'] = ice_engine_speed
+
+
 if __name__ == '__main__':
     sub = Subscriber('/sensors/camera/image_raw', 'sensor_msgs::Image', callback_f,
                      ip='47.91.115.171')  # 47.91.115.171
     pub = Publisher('/signal/live_switch', 'std_msgs::Number',
                     ip='47.91.115.171')
     sub2 = Subscriber('/a2rl/monit', 'std_msgs::NumberMultiArray', callback_monit,
                       ip='47.91.115.171')  # 47.91.115.171
+    sub3 = Subscriber('/a2rl/ego_loc', 'std_msgs::NumberMultiArray', callback_ego_loc,
+                      ip='47.91.115.171')  # 47.91.115.171
     num_tpc = get_all_msg_types()['std_msgs::Number'].copy()
+    left_line, right_line, (map_w, map_h) = track_boundary_parse()
     running = True
-    default_img = cv2.imread('../res/racecar.jpg')
+    default_img = load_a2rl_logo()
     default_img = cv2.resize(default_img, (1280, 720))
     img = default_img
+    use_local = False
+    cv2.namedWindow('img', cv2.WINDOW_NORMAL)
+    cv2.setWindowProperty('img', cv2.WND_PROP_FULLSCREEN, cv2.WINDOW_FULLSCREEN)
     while running:
         if img2_on and img2_ready and img2 is not None:
             img = img2.copy()
             img = cv2.resize(img, (1280, 720))
         img_show = draw_charts(img, a2rl_visual)
+        img_show = draw_track_map(img_show, left_line, right_line, (map_w, map_h),
+                                  (position_x, position_y), orientation_z, velocity, acceleration, use_local)
+
         cv2.imshow('img', img_show)
         c = cv2.waitKey(5)
         if c > 0:
             if c == 48:    # 0
                 print('press key: {}'.format(0))
                 img2_on = False
                 img = default_img
@@ -94,14 +135,17 @@
             elif c == 54:  # 6
                 print('press key: {}'.format(6))
                 num_tpc['data'] = 6
                 pub.publish(num_tpc)
                 sub.unsuspend()
                 img2_on = True
             elif c == 55:  # 7
+                """
                 print('press key: {}'.format(7))
                 num_tpc['data'] = 7
                 pub.publish(num_tpc)
                 sub.unsuspend()
                 img2_on = True
+                """
+                use_local = not use_local
             else:
                 print(c)
```

## spirems/image_io/visual_helper.py

```diff
@@ -1,24 +1,33 @@
 #!/usr/bin/env python3
 # -*- coding:utf-8 -*-
 import numpy as np
 import cv2
+import os
 from PIL import ImageFont, ImageDraw, Image
+import csv
 
 
-font_path = '../res/fradmcn.ttf'
+font_path = os.path.join(os.path.dirname(os.path.abspath(__file__)), '../res/fradmcn.ttf')
 font_size = 17
 font_color = (255, 255, 255)
 font = ImageFont.truetype(font_path, font_size)
 
 
+def load_a2rl_logo() -> np.ndarray:
+    img_path = os.path.join(os.path.dirname(os.path.abspath(__file__)), '../res/racecar.jpg')
+    default_img = cv2.imread(img_path)
+    return default_img
+
+
 def draw_charts(img: np.ndarray, visual_msg: dict) -> np.ndarray:
     if len(img.shape) == 3 and img.shape[0] == 720 and img.shape[1] == 1280:
         img_show_ = img.copy()
-        menu_img = img_show_[600:, :]
+        show_h, show_w = 120, 899
+        menu_img = img_show_[-show_h:, :show_w]
         menu_mask = np.zeros_like(menu_img, dtype=np.uint8)
         menu_img = cv2.addWeighted(menu_img, 0.5, menu_mask, 0.5, 0)
         if 'bar_chart_items' in visual_msg:
             for item in visual_msg['bar_chart_items']:  # chart
                 posx = item['posx']
                 val = item['val']
                 val_min = item['val_min']
@@ -44,10 +53,202 @@
                 if val < val_min:
                     val = val_min
                 if val > val_max:
                     val = val_max
                 draw.text((20 + posx, 8), text.format(val), font=font, fill=font_color)
                 draw.text((20 + posx, 94), name, font=font, fill=font_color)
             menu_img = cv2.cvtColor(np.array(pil_image), cv2.COLOR_RGB2BGR)
-        img_show_[600:, :] = menu_img
+        img_show_[-show_h:, :show_w] = menu_img
         img = img_show_
     return img
+
+
+g_track_left = None
+g_track_bottom = None
+g_track_height = None
+
+
+def track_coordinate_convert(pts, left=None, bottom=None, height=None, margin_=100) -> np.ndarray:
+    global g_track_left, g_track_bottom, g_track_height
+    assert g_track_left is not None or left is not None
+    assert g_track_bottom is not None or bottom is not None
+    assert g_track_height is not None or height is not None
+    if g_track_left is None:
+        g_track_left = left
+    if g_track_bottom is None:
+        g_track_bottom = bottom
+    if g_track_height is None:
+        g_track_height = height
+    pts[:, 0] += (0 - g_track_left) + margin_
+    pts[:, 1] += (0 - g_track_bottom) + margin_
+    pts[:, 1] = g_track_height - pts[:, 1]
+    return pts
+
+
+def track_boundary_parse():
+    # traj_path = os.path.join(os.path.dirname(os.path.abspath(__file__)), '../res/trajectories.csv')
+    traj_right_path = os.path.join(os.path.dirname(os.path.abspath(__file__)), '../res/yas_full_right.csv')
+    traj_left_path = os.path.join(os.path.dirname(os.path.abspath(__file__)), '../res/yas_full_left.csv')
+    left_line = []
+    right_line = []
+    mid_line = []
+    f_right = open(traj_right_path, 'r')
+    f_left = open(traj_left_path, 'r')
+    csv_list = csv.reader(f_right)
+    for i, csv_row in enumerate(csv_list):
+        if i > 0:
+            right_line.append([csv_row[0], csv_row[1]])
+    f_right.close()
+    csv_list = csv.reader(f_left)
+    for i, csv_row in enumerate(csv_list):
+        if i > 0:
+            left_line.append([csv_row[0], csv_row[1]])
+    f_left.close()
+    """
+    with open(traj_path, 'r') as f:
+        csv_list = csv.reader(f)
+        for i, csv_row in enumerate(csv_list):
+            if i > 0:
+                # left_line.append([csv_row[0], csv_row[1]])  # x, y
+                # right_line.append([csv_row[2], csv_row[3]])
+                mid_line.append([csv_row[4], csv_row[5]])
+    """
+    left_line = np.array(left_line, dtype=np.float32)
+    right_line = np.array(right_line, dtype=np.float32)
+    # mid_line = np.array(mid_line, dtype=np.float32)
+    line_left = left_line[:, 0].min()
+    line_bottom = left_line[:, 1].min()
+    line_right = left_line[:, 0].max()
+    line_top = left_line[:, 1].max()
+    margin = 100
+    w, h = (line_right - line_left) + 2 * margin, (line_top - line_bottom) + 2 * margin
+
+    # pts = track_coordinate_convert(mid_line, line_left, line_bottom, h, margin).astype(np.int32)
+    left_line = track_coordinate_convert(left_line, line_left, line_bottom, h, margin).astype(np.int32)
+    right_line = track_coordinate_convert(right_line).astype(np.int32)
+
+    img = np.zeros((int(h), int(w), 3), np.uint8)
+    # img_sml = np.zeros((int(h / 2), int(w / 2), 3), np.uint8)
+    # img_big = np.zeros((int(h) * 2, int(w) * 2, 3), np.uint8)
+    """
+    for pt in pts:
+        img = cv2.circle(img, pt, 4, (255, 255, 255), -1)
+    for pt in left_line:
+        img = cv2.circle(img, pt, 4, (255, 0, 0), -1)
+    """
+    # img = cv2.polylines(img, [pts], True, (255, 255, 255), 1)
+    """
+    left_line_big = np.array([[pt[0] * 2, pt[1] * 2] for pt in left_line], dtype=np.int32)
+    right_line_big = np.array([[pt[0] * 2, pt[1] * 2] for pt in right_line], dtype=np.int32)
+    mg_big = cv2.polylines(img_big, [left_line_big], True, (255, 255, 255), 1, cv2.LINE_AA)
+    img_big = cv2.polylines(img_big, [right_line_big], True, (255, 255, 255), 1, cv2.LINE_AA)
+
+    left_line_sml = np.array([[pt[0] / 2, pt[1] / 2] for pt in left_line], dtype=np.int32)
+    right_line_sml = np.array([[pt[0] / 2, pt[1] / 2] for pt in right_line], dtype=np.int32)
+    img_sml = cv2.polylines(img_sml, [left_line_sml], True, (255, 255, 255), 1, cv2.LINE_AA)
+    img_sml = cv2.polylines(img_sml, [right_line_sml], True, (255, 255, 255), 1, cv2.LINE_AA)
+    """
+    img = cv2.polylines(img, [left_line], True, (255, 255, 255), 1, cv2.LINE_AA)
+    img = cv2.polylines(img, [right_line], True, (255, 255, 255), 1, cv2.LINE_AA)
+
+    # img = cv2.resize(img, (int(img.shape[1] / 3), int(img.shape[0] / 3)))
+    # cv2.imwrite('C:/deep/track.png', img)
+    # cv2.imshow("img", img)
+    return left_line, right_line, (int(w), int(h))
+
+
+def draw_track_map(
+    img: np.ndarray,
+    left_line: np.ndarray,
+    right_line: np.ndarray,
+    map_size: tuple,
+    localization: tuple,
+    orientation_z: float,
+    velocity: float,
+    acceleration: float,
+    local: bool = False
+):
+    if len(img.shape) == 3 and img.shape[0] == 720 and img.shape[1] == 1280:
+        img_show_ = img.copy()
+        # 316, 600
+        draw_map_h = 720
+        draw_map_w = 380
+        if local:
+            full_map_h = draw_map_h * 8
+            full_map_w = draw_map_w * 8
+            scale_x = full_map_w / map_size[0]
+            scale_y = full_map_h / map_size[1]
+            map_mask = np.zeros((full_map_h, full_map_w, 3), dtype=np.uint8)
+
+            left_line_sml = np.array([[pt[0] * scale_x, pt[1] * scale_y] for pt in left_line], dtype=np.int32)
+            right_line_sml = np.array([[pt[0] * scale_x, pt[1] * scale_y] for pt in right_line], dtype=np.int32)
+            map_mask = cv2.polylines(map_mask, [left_line_sml], True, (255, 255, 255), 1, cv2.LINE_AA)
+            map_mask = cv2.polylines(map_mask, [right_line_sml], True, (255, 255, 255), 1, cv2.LINE_AA)
+            loc = np.array([localization]).astype(np.float64)
+            loc = track_coordinate_convert(loc)
+            loc = np.array([[pt[0] * scale_x, pt[1] * scale_y] for pt in loc], dtype=np.int32)
+            pt = loc[0]
+            map_mask = cv2.circle(map_mask, pt, 4, (0, 0, 255), -1)
+
+            pil_image = Image.fromarray(cv2.cvtColor(map_mask, cv2.COLOR_BGR2RGB))
+            draw = ImageDraw.Draw(pil_image)
+            draw.text((pt[0], pt[1] - 30), "{:.2f} m/s".format(velocity), font=font, fill=font_color)
+            draw.text((pt[0], pt[1] - 50), "{:.2f} m/s^2".format(acceleration), font=font, fill=font_color)
+            map_mask = cv2.cvtColor(np.array(pil_image), cv2.COLOR_RGB2BGR)
+
+            # [10, 0]
+            r = 20
+            arrow_x = int(np.cos(orientation_z) * r)
+            arrow_y = int(np.sin(-orientation_z) * r)
+            map_mask = cv2.line(map_mask, pt, (pt[0] + arrow_x, pt[1] + arrow_y), (0, 255, 255), 1, cv2.LINE_AA)
+            x1 = pt[0] - draw_map_w / 2
+            x2 = pt[0] + draw_map_w / 2
+            y1 = pt[1] - draw_map_h / 2
+            y2 = pt[1] + draw_map_h / 2
+            if x1 < 0:
+                x1 = 0
+                x2 = draw_map_w
+            if y1 < 0:
+                y1 = 0
+                y2 = draw_map_h
+            if x2 > full_map_w:
+                x2 = full_map_w
+                x1 = full_map_w - draw_map_w
+            if y2 > full_map_h:
+                y2 = full_map_h
+                y1 = full_map_h - draw_map_h
+            map_mask = map_mask[int(y1): int(y2), int(x1): int(x2)]
+            img_map = img_show_[:draw_map_h, -draw_map_w:]
+            # print(map_mask.shape)
+            # print(img_map.shape)
+            img_map = cv2.addWeighted(img_map, 0.5, map_mask, 0.5, 0)
+            img_show_[:draw_map_h, -draw_map_w:] = img_map
+            img = img_show_
+        else:
+            scale_x = draw_map_w / map_size[0]
+            scale_y = draw_map_h / map_size[1]
+
+            img_map = img_show_[:draw_map_h, -draw_map_w:]
+            map_mask = np.zeros_like(img_map, dtype=np.uint8)
+            img_map = cv2.addWeighted(img_map, 0.5, map_mask, 0.5, 0)
+
+            left_line_sml = np.array([[pt[0] * scale_x, pt[1] * scale_y] for pt in left_line], dtype=np.int32)
+            right_line_sml = np.array([[pt[0] * scale_x, pt[1] * scale_y] for pt in right_line], dtype=np.int32)
+            img_map = cv2.polylines(img_map, [left_line_sml], True, (255, 255, 255), 1, cv2.LINE_AA)
+            img_map = cv2.polylines(img_map, [right_line_sml], True, (255, 255, 255), 1, cv2.LINE_AA)
+
+            loc = np.array([localization]).astype(np.float64)
+            loc = track_coordinate_convert(loc)
+            loc = np.array([[pt[0] * scale_x, pt[1] * scale_y] for pt in loc], dtype=np.int32)
+            for pt in loc:
+                img_map = cv2.circle(img_map, pt, 4, (0, 0, 255), -1)
+            img_show_[:draw_map_h, -draw_map_w:] = img_map
+            img = img_show_
+    return img
+
+
+if __name__ == '__main__':
+    _left_line, _right_line, (_w, _h) = track_boundary_parse()
+    print(_left_line.shape)
+    print(_right_line.shape)
+    print(_w, _h)
+    draw_track_map(np.zeros((720, 1280, 3), dtype=np.uint8), _left_line, _right_line, (_w, _h), (0, 0))
```

## Comparing `spirems-0.1.5.data/scripts/sms.py` & `spirems-0.1.7.data/scripts/sms.py`

 * *Files identical despite different names*

## Comparing `spirems-0.1.5.dist-info/LICENSE` & `spirems-0.1.7.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `spirems-0.1.5.dist-info/METADATA` & `spirems-0.1.7.dist-info/METADATA`

 * *Files 7% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: spirems
-Version: 0.1.5
+Version: 0.1.7
 Author: jin&team
 Author-email: renjin@bit.edu.cn
 Classifier: Programming Language :: Python :: 3
 Classifier: Operating System :: OS Independent
 Requires-Python: >=3.8
 Description-Content-Type: text/markdown
 License-File: LICENSE
```

## Comparing `spirems-0.1.5.dist-info/RECORD` & `spirems-0.1.7.dist-info/RECORD`

 * *Files 5% similar despite different names*

```diff
@@ -1,21 +1,21 @@
-spirems/__init__.py,sha256=8U0um0piR_BJYzE6vcLfO-bjRch_QOWNloNd6_LLacc,546
+spirems/__init__.py,sha256=22QmHDB7WVSeml9cxgL9gRUOmtCgyrCGkcC3xLFf_mQ,546
 spirems/error_code.py,sha256=CrFS5cLLLrLKRxGoTGoMeW4w9f8TjmVYZ-7FdHmZdp0,878
 spirems/log.py,sha256=JujtjV1_AQWNdkEmnooBG8zCzXwl6ykl4J5H_BkAtQ8,1009
 spirems/msg_helper.py,sha256=e6rNT3mjiQy_7VH6oSj6M2PQokPuNujiWBvN0MADiBI,4807
 spirems/publisher.py,sha256=UyTv13f7G8vFgG4HFvroJSNoYqa03B1N7bC2eEBtaho,8866
 spirems/server.py,sha256=Mca5Is54ROrqFSi4_UiL5sNMWtP9E0whld7cPgvN5Q4,16403
 spirems/sms.py,sha256=4uAFAU8W-wDOTVs6UitoQfzUWkmJeU55mIcEgrUqAGs,5255
 spirems/subscriber.py,sha256=0xO7XD-ssXuxotgdDE-PVHfEdeJVLI8fVGRTP69HzR8,6924
 spirems/image_io/__init__.py,sha256=M11gWrr6dDI3LEeCVFCvvONgzfKA8qxwPtMNbnbW1AA,48
-spirems/image_io/a2rl_gs.py,sha256=MqpoKkdkVsDNdS0anxHyXdw6Xyw_yKtLroMnp8gh-gM,7252
-spirems/image_io/a2rl_live.py,sha256=Ic4iWnY5zu_GhAEqBGeYWk2EuqHZD2XIPHNZZ8peORM,3851
+spirems/image_io/a2rl_gs.py,sha256=XXeXNtURfWEBvLB4F_S5tj5P0xNOgDkEUK9eXfXPuGc,7295
+spirems/image_io/a2rl_live.py,sha256=0QrWoCsMcuu0ba_d6Ir7rjXICbFprwMnRVhO_V0wOrk,5576
 spirems/image_io/adaptor.py,sha256=_SxU_0-tBj3SQhJikDsOrGrVEr1-6B_RWGWRF3Bxr_8,1440
 spirems/image_io/recv_testcase.py,sha256=Dfw9uYKAWDpHKAXOSDHnsp9YiWUwHJ1T4yHvju4vZsI,551
-spirems/image_io/visual_helper.py,sha256=3-1N_LMRlyChkmWKeF33634ejCzGxTsB-aHBxb7IhHQ,2257
+spirems/image_io/visual_helper.py,sha256=HbiTbLYBqJeQBwUOMEZnt8RZJI6cGcvOSsFt7wJedN0,11309
 spirems/logs/README.md,sha256=-A-iurCwjSy1aV-LUkB1QZa3ORQifwKkclC3yMh2N9U,17
 spirems/msgs/_sys_msgs/HeartBeat.json,sha256=36MqpL_AjS3SDBzbCXGZf0vlGmqfqMnQWHnmjJLrKKs,54
 spirems/msgs/_sys_msgs/Publisher.json,sha256=6XQMxBGWvsey7j59eY7BEPHgtEsFA3LffQ57F4Z_gJw,99
 spirems/msgs/_sys_msgs/Result.json,sha256=JTP2tNy4NViIuG4R9db_fmYrTgxC3JK6CQtPUdn82Cs,92
 spirems/msgs/_sys_msgs/SmsTopicList.json,sha256=AKBGrqD5rnAaFKzA6zy9cW0V_JpQl8Q7oY4j_UBtX7E,57
 spirems/msgs/_sys_msgs/Subscriber.json,sha256=zzxyDaNmGnAbSwAvmEPHOkIB2mjy82OfhVQN8vaa-NA,100
 spirems/msgs/_sys_msgs/Suspend.json,sha256=OB-vSPGCh4zFZlUjco6RYX-G3fszRV-M231QdTxEfoM,52
@@ -28,17 +28,20 @@
 spirems/msgs/std_msgs/Null.json,sha256=MGBvN6uIpgEpaYZQhgUfFRHXBpx7FsvngISqBvBciHI,48
 spirems/msgs/std_msgs/Number.json,sha256=cZ8O3NrZ8pFE3cnEnGhe8jbye5j6HHSoQiV_s9xw4_Q,64
 spirems/msgs/std_msgs/NumberMultiArray.json,sha256=doBT3ukrotfw0UpcFqWPDFkLsxctpOKDtX8HkbZ6aNA,76
 spirems/msgs/std_msgs/String.json,sha256=jcBACqMkZOe3wW59EupJkB7ZzJ7hXhZ_10NHHRUccwQ,63
 spirems/msgs/std_msgs/StringMultiArray.json,sha256=PN8fg_P5Zqa7BjBaptMQyoR_IuOppAetGOsg-Nvbpuk,75
 spirems/res/fradmcn.ttf,sha256=SrD02HmRy9qRpiU2nigExPuIlpzbHkvYO2vzfQfPnP0,116940
 spirems/res/msyh_boot.ttf,sha256=MlzgvMtO_ghMf56FP1XPkP_TMw7YOsLVRftCyGXWOYg,175292
+spirems/res/optm_path.json,sha256=9-oz4kCEsG4kSHOtI1ZDb1W1xdiab1b0jfKl91SCzd8,394336
 spirems/res/racecar.jpg,sha256=oUm4lHuO3iDcs5VgFIPXGn8AODd6tMEAoR5vg6HXUSo,353153
+spirems/res/yas_full_left.csv,sha256=QuFy0cxqwJX0SbftOuCvphxzKpC3CORSQO6OdMBsxYc,5539
+spirems/res/yas_full_right.csv,sha256=dwZD6BidZsjUTITB9fwFzkXvdDyT1EsMynGNA8KSxd4,5252
 spirems/sys_monit/__init__.py,sha256=M11gWrr6dDI3LEeCVFCvvONgzfKA8qxwPtMNbnbW1AA,48
 spirems/sys_monit/a2rl_sys_monit.py,sha256=KfP0Vd_D3oFX-ZACm6OmuWRI6tVl0vR-FisMW28A1BI,2271
 spirems/sys_monit/psutil_pub.py,sha256=PQWs5vAq916xPNyGIPtWDJ1MJZLzkFLqgsDHJ5pJKH4,3487
-spirems-0.1.5.data/scripts/sms.py,sha256=eaqngSfCzgPtkBXjw0nZ82o17pLHW2ZPDxXku6xkR94,5241
-spirems-0.1.5.dist-info/LICENSE,sha256=HrhfyXIkWY2tGFK11kg7vPCqhgh5DcxleloqdhrpyMY,11558
-spirems-0.1.5.dist-info/METADATA,sha256=M-_sgYWMS7nuJy1esD3jV968xfZ5rElEQq3Nx3pH4xE,1248
-spirems-0.1.5.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-spirems-0.1.5.dist-info/top_level.txt,sha256=ra9zu_vB-BRVXDwvqhouFCHIwnalKkMGq3JmTZijtmE,8
-spirems-0.1.5.dist-info/RECORD,,
+spirems-0.1.7.data/scripts/sms.py,sha256=eaqngSfCzgPtkBXjw0nZ82o17pLHW2ZPDxXku6xkR94,5241
+spirems-0.1.7.dist-info/LICENSE,sha256=HrhfyXIkWY2tGFK11kg7vPCqhgh5DcxleloqdhrpyMY,11558
+spirems-0.1.7.dist-info/METADATA,sha256=rqcmybgOIOftmbWzCs2pr1CSBpZmQXuWtXOVCvk2xcY,1248
+spirems-0.1.7.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+spirems-0.1.7.dist-info/top_level.txt,sha256=ra9zu_vB-BRVXDwvqhouFCHIwnalKkMGq3JmTZijtmE,8
+spirems-0.1.7.dist-info/RECORD,,
```

