# Comparing `tmp/karray-2024.3.6.tar.gz` & `tmp/karray-2024.3.7.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "karray-2024.3.6.tar", last modified: Mon Apr 15 18:44:19 2024, max compression
+gzip compressed data, was "karray-2024.3.7.tar", last modified: Wed Apr 17 21:28:36 2024, max compression
```

## Comparing `karray-2024.3.6.tar` & `karray-2024.3.7.tar`

### file list

```diff
@@ -1,21 +1,21 @@
-drwxr-xr-x   0 cgaete    (1000) cgaete    (1000)        0 2024-04-15 18:44:19.655669 karray-2024.3.6/
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)     1069 2024-04-14 17:13:13.000000 karray-2024.3.6/LICENSE
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)    22160 2024-04-15 18:44:19.655669 karray-2024.3.6/PKG-INFO
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)    20458 2024-04-15 18:36:01.000000 karray-2024.3.6/README.md
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)     1620 2024-04-15 18:36:42.000000 karray-2024.3.6/pyproject.toml
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)       38 2024-04-15 18:44:19.655669 karray-2024.3.6/setup.cfg
-drwxr-xr-x   0 cgaete    (1000) cgaete    (1000)        0 2024-04-15 18:44:19.651669 karray-2024.3.6/src/
-drwxr-xr-x   0 cgaete    (1000) cgaete    (1000)        0 2024-04-15 18:44:19.651669 karray-2024.3.6/src/karray/
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)      603 2024-04-15 16:58:54.000000 karray-2024.3.6/src/karray/__init__.py
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)     1155 2024-04-14 17:13:13.000000 karray-2024.3.6/src/karray/constants.py
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)        0 2024-04-15 10:41:37.000000 karray-2024.3.6/src/karray/py.typed
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)   191359 2024-04-14 21:38:52.000000 karray-2024.3.6/src/karray/source_code.py
-drwxr-xr-x   0 cgaete    (1000) cgaete    (1000)        0 2024-04-15 18:44:19.655669 karray-2024.3.6/src/karray.egg-info/
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)    22160 2024-04-15 18:44:19.000000 karray-2024.3.6/src/karray.egg-info/PKG-INFO
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)      335 2024-04-15 18:44:19.000000 karray-2024.3.6/src/karray.egg-info/SOURCES.txt
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)        1 2024-04-15 18:44:19.000000 karray-2024.3.6/src/karray.egg-info/dependency_links.txt
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)      134 2024-04-15 18:44:19.000000 karray-2024.3.6/src/karray.egg-info/requires.txt
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)        7 2024-04-15 18:44:19.000000 karray-2024.3.6/src/karray.egg-info/top_level.txt
-drwxr-xr-x   0 cgaete    (1000) cgaete    (1000)        0 2024-04-15 18:44:19.655669 karray-2024.3.6/tests/
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)     1050 2024-04-15 17:07:22.000000 karray-2024.3.6/tests/test_dense.py
--rw-r--r--   0 cgaete    (1000) cgaete    (1000)     1051 2024-04-15 17:07:43.000000 karray-2024.3.6/tests/test_sparse.py
+drwxr-xr-x   0 cgaete    (1000) cgaete    (1000)        0 2024-04-17 21:28:36.195257 karray-2024.3.7/
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)     1069 2024-04-16 10:53:17.000000 karray-2024.3.7/LICENSE
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)    22160 2024-04-17 21:28:36.195257 karray-2024.3.7/PKG-INFO
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)    20458 2024-04-16 10:53:17.000000 karray-2024.3.7/README.md
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)     1620 2024-04-16 10:53:17.000000 karray-2024.3.7/pyproject.toml
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)       38 2024-04-17 21:28:36.195257 karray-2024.3.7/setup.cfg
+drwxr-xr-x   0 cgaete    (1000) cgaete    (1000)        0 2024-04-17 21:28:36.191257 karray-2024.3.7/src/
+drwxr-xr-x   0 cgaete    (1000) cgaete    (1000)        0 2024-04-17 21:28:36.191257 karray-2024.3.7/src/karray/
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)      603 2024-04-17 21:26:52.000000 karray-2024.3.7/src/karray/__init__.py
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)     1155 2024-04-16 10:53:17.000000 karray-2024.3.7/src/karray/constants.py
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)        0 2024-04-16 10:53:17.000000 karray-2024.3.7/src/karray/py.typed
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)   191424 2024-04-17 20:19:56.000000 karray-2024.3.7/src/karray/source_code.py
+drwxr-xr-x   0 cgaete    (1000) cgaete    (1000)        0 2024-04-17 21:28:36.195257 karray-2024.3.7/src/karray.egg-info/
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)    22160 2024-04-17 21:28:36.000000 karray-2024.3.7/src/karray.egg-info/PKG-INFO
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)      335 2024-04-17 21:28:36.000000 karray-2024.3.7/src/karray.egg-info/SOURCES.txt
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)        1 2024-04-17 21:28:36.000000 karray-2024.3.7/src/karray.egg-info/dependency_links.txt
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)      134 2024-04-17 21:28:36.000000 karray-2024.3.7/src/karray.egg-info/requires.txt
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)        7 2024-04-17 21:28:36.000000 karray-2024.3.7/src/karray.egg-info/top_level.txt
+drwxr-xr-x   0 cgaete    (1000) cgaete    (1000)        0 2024-04-17 21:28:36.191257 karray-2024.3.7/tests/
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)     1050 2024-04-16 10:53:17.000000 karray-2024.3.7/tests/test_dense.py
+-rw-r--r--   0 cgaete    (1000) cgaete    (1000)     1051 2024-04-16 10:53:17.000000 karray-2024.3.7/tests/test_sparse.py
```

### Comparing `karray-2024.3.6/LICENSE` & `karray-2024.3.7/LICENSE`

 * *Files identical despite different names*

### Comparing `karray-2024.3.6/PKG-INFO` & `karray-2024.3.7/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: karray
-Version: 2024.3.6
+Version: 2024.3.7
 Summary: Lightweight labelled multidimensional arrays with NumPy arrays under the hood.
 Author-email: Carlos Gaete-Morales <cdgaete@gmail.com>
 License: MIT License
 Project-URL: Documentation, https://diw-evu.gitlab.io/karray
 Project-URL: Source-code, https://gitlab.com/diw-evu/karray
 Project-URL: Issue-tracker, https://gitlab.com/diw-evu/karray/issues
 Keywords: ndarray,labeled,multidimensional,element-wise,dense,sparse,arrays
```

### Comparing `karray-2024.3.6/README.md` & `karray-2024.3.7/README.md`

 * *Files identical despite different names*

### Comparing `karray-2024.3.6/pyproject.toml` & `karray-2024.3.7/pyproject.toml`

 * *Files identical despite different names*

### Comparing `karray-2024.3.6/src/karray/__init__.py` & `karray-2024.3.7/src/karray/__init__.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 
-__version__ = "2024.3.6"
+__version__ = "2024.3.7"
 __author__ = 'Carlos Gaete-Morales'
 
 __all__ = [
     'Array',
     'Long',
     'concat',
     'numpy_to_long',
```

### Comparing `karray-2024.3.6/src/karray/constants.py` & `karray-2024.3.7/src/karray/constants.py`

 * *Files identical despite different names*

### Comparing `karray-2024.3.6/src/karray/source_code.py` & `karray-2024.3.7/src/karray/source_code.py`

 * *Files 0% similar despite different names*

```diff
@@ -5570,6391 +5570,6395 @@
 00015c10: 6179 2864 6174 613d 7265 7375 6c74 696e  ay(data=resultin
 00015c20: 675f 6172 7261 792c 2063 6f6f 7264 733d  g_array, coords=
 00015c30: 636f 6f72 6473 290a 0a20 2020 2064 6566  coords)..    def
 00015c40: 205f 6f70 6572 6174 696f 6e28 7365 6c66   _operation(self
 00015c50: 2c20 7365 6c66 5f61 7272 6179 3a20 556e  , self_array: Un
 00015c60: 696f 6e5b 6e70 2e6e 6461 7272 6179 2c20  ion[np.ndarray, 
 00015c70: 2773 702e 434f 4f27 2c20 2763 702e 6e64  'sp.COO', 'cp.nd
-00015c80: 6172 7261 7927 5d2c 206f 7468 6572 5f61  array'], other_a
-00015c90: 7272 6179 3a20 556e 696f 6e5b 6e70 2e6e  rray: Union[np.n
-00015ca0: 6461 7272 6179 2c20 2773 702e 434f 4f27  darray, 'sp.COO'
-00015cb0: 2c20 2763 702e 6e64 6172 7261 7927 5d2c  , 'cp.ndarray'],
-00015cc0: 206f 7065 7261 7469 6f6e 3a20 7374 7229   operation: str)
-00015cd0: 202d 3e20 556e 696f 6e5b 6e70 2e6e 6461   -> Union[np.nda
-00015ce0: 7272 6179 2c20 2773 702e 434f 4f27 2c20  rray, 'sp.COO', 
-00015cf0: 2763 702e 6e64 6172 7261 7927 5d3a 0a20  'cp.ndarray']:. 
-00015d00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00015d10: 2020 2050 6572 666f 726d 2061 206d 6174     Perform a mat
-00015d20: 6820 6f70 6572 6174 696f 6e20 6f6e 2074  h operation on t
-00015d30: 776f 2061 7272 6179 732e 0a0a 2020 2020  wo arrays...    
-00015d40: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00015d50: 2020 2020 2020 7365 6c66 5f61 7272 6179        self_array
-00015d60: 3a20 5468 6520 6669 7273 7420 6172 7261  : The first arra
-00015d70: 792e 0a20 2020 2020 2020 2020 2020 206f  y..            o
-00015d80: 7468 6572 5f61 7272 6179 3a20 5468 6520  ther_array: The 
-00015d90: 7365 636f 6e64 2061 7272 6179 2e0a 2020  second array..  
-00015da0: 2020 2020 2020 2020 2020 6f70 6572 6174            operat
-00015db0: 696f 6e3a 2054 6865 206f 7065 7261 7469  ion: The operati
-00015dc0: 6f6e 2074 6f20 7065 7266 6f72 6d2e 0a0a  on to perform...
-00015dd0: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
-00015de0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00015df0: 2072 6573 756c 7420 6f66 2074 6865 206f   result of the o
-00015e00: 7065 7261 7469 6f6e 2e0a 2020 2020 2020  peration..      
-00015e10: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00015e20: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-00015e30: 5f61 7272 6179 2c20 6e70 2e6e 6461 7272  _array, np.ndarr
-00015e40: 6179 2920 616e 6420 6973 696e 7374 616e  ay) and isinstan
-00015e50: 6365 286f 7468 6572 5f61 7272 6179 2c20  ce(other_array, 
-00015e60: 6e70 2e6e 6461 7272 6179 293a 0a20 2020  np.ndarray):.   
-00015e70: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00015e80: 2e67 7075 5f62 6163 6b65 6e64 2069 7320  .gpu_backend is 
-00015e90: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00015ea0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00015eb0: 662e 6770 755f 6261 636b 656e 6420 3d3d  f.gpu_backend ==
-00015ec0: 2027 6375 7079 273a 0a20 2020 2020 2020   'cupy':.       
-00015ed0: 2020 2020 2020 2020 2020 2020 206d 656d               mem
-00015ee0: 706f 6f6c 203d 2063 702e 6765 745f 6465  pool = cp.get_de
-00015ef0: 6661 756c 745f 6d65 6d6f 7279 5f70 6f6f  fault_memory_poo
-00015f00: 6c28 290a 2020 2020 2020 2020 2020 2020  l().            
-00015f10: 2020 2020 2020 2020 7769 7468 2063 702e          with cp.
-00015f20: 6375 6461 2e44 6576 6963 6528 7365 6c66  cuda.Device(self
-00015f30: 2e67 7075 5f62 6163 6b65 6e64 5f64 6576  .gpu_backend_dev
-00015f40: 6963 6529 3a0a 2020 2020 2020 2020 2020  ice):.          
-00015f50: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00015f60: 6c66 5f61 7272 6179 203d 2063 702e 6172  lf_array = cp.ar
-00015f70: 7261 7928 7365 6c66 5f61 7272 6179 290a  ray(self_array).
-00015f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f90: 2020 2020 2020 2020 6f74 6865 725f 6172          other_ar
-00015fa0: 7261 7920 3d20 6370 2e61 7272 6179 286f  ray = cp.array(o
-00015fb0: 7468 6572 5f61 7272 6179 290a 2020 2020  ther_array).    
-00015fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015fd0: 2020 2020 7265 7375 6c74 203d 2067 6574      result = get
-00015fe0: 6174 7472 2863 702c 206f 7065 7261 7469  attr(cp, operati
-00015ff0: 6f6e 2928 7365 6c66 5f61 7272 6179 2c20  on)(self_array, 
-00016000: 6f74 6865 725f 6172 7261 7929 0a20 2020  other_array).   
-00016010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016020: 2020 2020 206e 705f 6172 7261 7920 3d20       np_array = 
-00016030: 7265 7375 6c74 2e67 6574 2829 0a20 2020  result.get().   
-00016040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016050: 2064 656c 2072 6573 756c 742c 2073 656c   del result, sel
-00016060: 665f 6172 7261 792c 206f 7468 6572 5f61  f_array, other_a
-00016070: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-00016080: 2020 2020 2020 2020 206d 656d 706f 6f6c           mempool
-00016090: 2e66 7265 655f 616c 6c5f 626c 6f63 6b73  .free_all_blocks
-000160a0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-000160b0: 2020 2020 2020 2072 6574 7572 6e20 6e70         return np
-000160c0: 5f61 7272 6179 0a20 2020 2020 2020 2020  _array.         
-000160d0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-000160e0: 2e67 7075 5f62 6163 6b65 6e64 203d 3d20  .gpu_backend == 
-000160f0: 2770 7974 6f72 6368 273a 0a20 2020 2020  'pytorch':.     
-00016100: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-00016110: 6974 6820 746f 7263 682e 6375 6461 2e64  ith torch.cuda.d
-00016120: 6576 6963 6528 7365 6c66 2e67 7075 5f62  evice(self.gpu_b
-00016130: 6163 6b65 6e64 5f64 6576 6963 6529 3a0a  ackend_device):.
-00016140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016150: 2020 2020 2020 2020 7365 6c66 5f61 7272          self_arr
-00016160: 6179 203d 2074 6f72 6368 2e74 656e 736f  ay = torch.tenso
-00016170: 7228 7365 6c66 5f61 7272 6179 290a 2020  r(self_array).  
-00016180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016190: 2020 2020 2020 6f74 6865 725f 6172 7261        other_arra
-000161a0: 7920 3d20 746f 7263 682e 7465 6e73 6f72  y = torch.tensor
-000161b0: 286f 7468 6572 5f61 7272 6179 290a 2020  (other_array).  
-000161c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000161d0: 2020 2020 2020 7265 7375 6c74 203d 2067        result = g
-000161e0: 6574 6174 7472 2874 6f72 6368 2c20 6f70  etattr(torch, op
-000161f0: 6572 6174 696f 6e29 2873 656c 665f 6172  eration)(self_ar
-00016200: 7261 792c 206f 7468 6572 5f61 7272 6179  ray, other_array
-00016210: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00016220: 2020 2020 2020 2020 2020 6e70 5f61 7272            np_arr
-00016230: 6179 203d 2072 6573 756c 742e 6370 7528  ay = result.cpu(
-00016240: 292e 6e75 6d70 7928 290a 2020 2020 2020  ).numpy().      
-00016250: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00016260: 7475 726e 206e 705f 6172 7261 790a 2020  turn np_array.  
-00016270: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00016280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016290: 7265 7475 726e 2067 6574 6174 7472 286e  return getattr(n
-000162a0: 702c 206f 7065 7261 7469 6f6e 2928 7365  p, operation)(se
-000162b0: 6c66 5f61 7272 6179 2c20 6f74 6865 725f  lf_array, other_
-000162c0: 6172 7261 7929 0a20 2020 2020 2020 2065  array).        e
-000162d0: 6c69 6620 6973 696e 7374 616e 6365 2873  lif isinstance(s
-000162e0: 656c 665f 6172 7261 792c 2073 702e 434f  elf_array, sp.CO
-000162f0: 4f29 2061 6e64 2069 7369 6e73 7461 6e63  O) and isinstanc
-00016300: 6528 6f74 6865 725f 6172 7261 792c 2073  e(other_array, s
-00016310: 702e 434f 4f29 3a0a 2020 2020 2020 2020  p.COO):.        
-00016320: 2020 2020 7265 7475 726e 2067 6574 6174      return getat
-00016330: 7472 2873 656c 665f 6172 7261 792c 206f  tr(self_array, o
-00016340: 7065 7261 7469 6f6e 2928 6f74 6865 725f  peration)(other_
-00016350: 6172 7261 7929 0a20 2020 2020 2020 2065  array).        e
-00016360: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00016370: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
-00016380: 2822 496e 7661 6c69 6420 6461 7461 2074  ("Invalid data t
-00016390: 7970 6520 666f 7220 2764 6174 6127 2070  ype for 'data' p
-000163a0: 726f 7065 7274 7922 290a 0a20 2020 2064  roperty")..    d
-000163b0: 6566 205f 5f61 6464 5f5f 2873 656c 662c  ef __add__(self,
-000163c0: 206f 7468 6572 3a20 556e 696f 6e5b 696e   other: Union[in
-000163d0: 742c 2066 6c6f 6174 2c20 2741 7272 6179  t, float, 'Array
-000163e0: 275d 2920 2d3e 2027 4172 7261 7927 3a0a  ']) -> 'Array':.
-000163f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00016400: 2020 2020 4164 6420 7468 6520 4172 7261      Add the Arra
-00016410: 7920 7769 7468 2061 6e6f 7468 6572 2041  y with another A
-00016420: 7272 6179 206f 7220 6120 6e75 6d62 6572  rray or a number
-00016430: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-00016440: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
-00016450: 6572 3a20 5468 6520 6f74 6865 7220 4172  er: The other Ar
-00016460: 7261 7920 6f72 206e 756d 6265 7220 746f  ray or number to
-00016470: 2061 6464 2e0a 0a20 2020 2020 2020 2052   add...        R
-00016480: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-00016490: 2020 2020 4120 6e65 7720 4172 7261 7920      A new Array 
-000164a0: 6f62 6a65 6374 2077 6974 6820 7468 6520  object with the 
-000164b0: 7265 7375 6c74 206f 6620 7468 6520 6164  result of the ad
-000164c0: 6469 7469 6f6e 2e0a 0a20 2020 2020 2020  dition...       
-000164d0: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
-000164e0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
-000164f0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00016500: 636f 6f72 6473 3120 3d20 7b27 6469 6d31  coords1 = {'dim1
-00016510: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
-00016520: 6469 6d32 273a 205b 312c 2032 5d7d 0a20  dim2': [1, 2]}. 
-00016530: 2020 2020 2020 2020 2020 203e 3e3e 206c             >>> l
-00016540: 6f6e 6731 203d 204c 6f6e 6728 696e 6465  ong1 = Long(inde
-00016550: 783d 7b27 6469 6d31 273a 205b 2761 272c  x={'dim1': ['a',
-00016560: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-00016570: 312c 2032 5d7d 2c20 7661 6c75 653d 5b31  1, 2]}, value=[1
-00016580: 302c 2032 305d 290a 2020 2020 2020 2020  0, 20]).        
-00016590: 2020 2020 3e3e 3e20 6172 7231 203d 2041      >>> arr1 = A
-000165a0: 7272 6179 2864 6174 613d 6c6f 6e67 312c  rray(data=long1,
-000165b0: 2063 6f6f 7264 733d 636f 6f72 6473 3129   coords=coords1)
-000165c0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-000165d0: 2063 6f6f 7264 7332 203d 207b 2764 696d   coords2 = {'dim
-000165e0: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-000165f0: 2764 696d 3227 3a20 5b31 2c20 325d 7d0a  'dim2': [1, 2]}.
+00015c80: 6172 7261 7927 2c20 2774 6f72 6368 2e54  array', 'torch.T
+00015c90: 656e 736f 7227 5d2c 206f 7468 6572 5f61  ensor'], other_a
+00015ca0: 7272 6179 3a20 556e 696f 6e5b 6e70 2e6e  rray: Union[np.n
+00015cb0: 6461 7272 6179 2c20 2773 702e 434f 4f27  darray, 'sp.COO'
+00015cc0: 2c20 2763 702e 6e64 6172 7261 7927 2c20  , 'cp.ndarray', 
+00015cd0: 2774 6f72 6368 2e54 656e 736f 7227 5d2c  'torch.Tensor'],
+00015ce0: 206f 7065 7261 7469 6f6e 3a20 7374 7229   operation: str)
+00015cf0: 202d 3e20 556e 696f 6e5b 6e70 2e6e 6461   -> Union[np.nda
+00015d00: 7272 6179 2c20 2773 702e 434f 4f27 5d3a  rray, 'sp.COO']:
+00015d10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00015d20: 2020 2020 2050 6572 666f 726d 2061 206d       Perform a m
+00015d30: 6174 6820 6f70 6572 6174 696f 6e20 6f6e  ath operation on
+00015d40: 2074 776f 2061 7272 6179 732e 0a0a 2020   two arrays...  
+00015d50: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+00015d60: 2020 2020 2020 2020 7365 6c66 5f61 7272          self_arr
+00015d70: 6179 3a20 5468 6520 6669 7273 7420 6172  ay: The first ar
+00015d80: 7261 792e 0a20 2020 2020 2020 2020 2020  ray..           
+00015d90: 206f 7468 6572 5f61 7272 6179 3a20 5468   other_array: Th
+00015da0: 6520 7365 636f 6e64 2061 7272 6179 2e0a  e second array..
+00015db0: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
+00015dc0: 6174 696f 6e3a 2054 6865 206f 7065 7261  ation: The opera
+00015dd0: 7469 6f6e 2074 6f20 7065 7266 6f72 6d2e  tion to perform.
+00015de0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00015df0: 733a 0a20 2020 2020 2020 2020 2020 2054  s:.            T
+00015e00: 6865 2072 6573 756c 7420 6f66 2074 6865  he result of the
+00015e10: 206f 7065 7261 7469 6f6e 2e0a 2020 2020   operation..    
+00015e20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00015e30: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
+00015e40: 6c66 5f61 7272 6179 2c20 6e70 2e6e 6461  lf_array, np.nda
+00015e50: 7272 6179 2920 616e 6420 6973 696e 7374  rray) and isinst
+00015e60: 616e 6365 286f 7468 6572 5f61 7272 6179  ance(other_array
+00015e70: 2c20 6e70 2e6e 6461 7272 6179 293a 0a20  , np.ndarray):. 
+00015e80: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00015e90: 6c66 2e67 7075 5f62 6163 6b65 6e64 2069  lf.gpu_backend i
+00015ea0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00015eb0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00015ec0: 656c 662e 6770 755f 6261 636b 656e 6420  elf.gpu_backend 
+00015ed0: 3d3d 2027 6375 7079 273a 0a20 2020 2020  == 'cupy':.     
+00015ee0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00015ef0: 656d 706f 6f6c 203d 2063 702e 6765 745f  empool = cp.get_
+00015f00: 6465 6661 756c 745f 6d65 6d6f 7279 5f70  default_memory_p
+00015f10: 6f6f 6c28 290a 2020 2020 2020 2020 2020  ool().          
+00015f20: 2020 2020 2020 2020 2020 7769 7468 2063            with c
+00015f30: 702e 6375 6461 2e44 6576 6963 6528 7365  p.cuda.Device(se
+00015f40: 6c66 2e67 7075 5f62 6163 6b65 6e64 5f64  lf.gpu_backend_d
+00015f50: 6576 6963 6529 3a0a 2020 2020 2020 2020  evice):.        
+00015f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f70: 7365 6c66 5f61 7272 6179 203d 2063 702e  self_array = cp.
+00015f80: 6172 7261 7928 7365 6c66 5f61 7272 6179  array(self_array
+00015f90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00015fa0: 2020 2020 2020 2020 2020 6f74 6865 725f            other_
+00015fb0: 6172 7261 7920 3d20 6370 2e61 7272 6179  array = cp.array
+00015fc0: 286f 7468 6572 5f61 7272 6179 290a 2020  (other_array).  
+00015fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015fe0: 2020 2020 2020 7265 7375 6c74 203d 2067        result = g
+00015ff0: 6574 6174 7472 2873 656c 665f 6172 7261  etattr(self_arra
+00016000: 792c 206f 7065 7261 7469 6f6e 2928 6f74  y, operation)(ot
+00016010: 6865 725f 6172 7261 7929 0a20 2020 2020  her_array).     
+00016020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016030: 2020 206e 705f 6172 7261 7920 3d20 7265     np_array = re
+00016040: 7375 6c74 2e67 6574 2829 0a20 2020 2020  sult.get().     
+00016050: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00016060: 656c 2072 6573 756c 742c 2073 656c 665f  el result, self_
+00016070: 6172 7261 792c 206f 7468 6572 5f61 7272  array, other_arr
+00016080: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
+00016090: 2020 2020 2020 206d 656d 706f 6f6c 2e66         mempool.f
+000160a0: 7265 655f 616c 6c5f 626c 6f63 6b73 2829  ree_all_blocks()
+000160b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000160c0: 2020 2020 2072 6574 7572 6e20 6e70 5f61       return np_a
+000160d0: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+000160e0: 2020 2020 2065 6c69 6620 7365 6c66 2e67       elif self.g
+000160f0: 7075 5f62 6163 6b65 6e64 203d 3d20 2770  pu_backend == 'p
+00016100: 7974 6f72 6368 273a 0a20 2020 2020 2020  ytorch':.       
+00016110: 2020 2020 2020 2020 2020 2020 2077 6974               wit
+00016120: 6820 746f 7263 682e 6375 6461 2e64 6576  h torch.cuda.dev
+00016130: 6963 6528 7365 6c66 2e67 7075 5f62 6163  ice(self.gpu_bac
+00016140: 6b65 6e64 5f64 6576 6963 6529 3a0a 2020  kend_device):.  
+00016150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016160: 2020 2020 2020 7365 6c66 5f61 7272 6179        self_array
+00016170: 203d 2074 6f72 6368 2e74 656e 736f 7228   = torch.tensor(
+00016180: 7365 6c66 5f61 7272 6179 290a 2020 2020  self_array).    
+00016190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000161a0: 2020 2020 6f74 6865 725f 6172 7261 7920      other_array 
+000161b0: 3d20 746f 7263 682e 7465 6e73 6f72 286f  = torch.tensor(o
+000161c0: 7468 6572 5f61 7272 6179 290a 2020 2020  ther_array).    
+000161d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000161e0: 2020 2020 7265 7375 6c74 203d 2067 6574      result = get
+000161f0: 6174 7472 2873 656c 665f 6172 7261 792c  attr(self_array,
+00016200: 206f 7065 7261 7469 6f6e 2928 6f74 6865   operation)(othe
+00016210: 725f 6172 7261 7929 0a20 2020 2020 2020  r_array).       
+00016220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016230: 206e 705f 6172 7261 7920 3d20 7265 7375   np_array = resu
+00016240: 6c74 2e63 7075 2829 2e6e 756d 7079 2829  lt.cpu().numpy()
+00016250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016260: 2020 2020 2020 2020 2064 656c 2072 6573           del res
+00016270: 756c 742c 2073 656c 665f 6172 7261 792c  ult, self_array,
+00016280: 206f 7468 6572 5f61 7272 6179 0a20 2020   other_array.   
+00016290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000162a0: 2072 6574 7572 6e20 6e70 5f61 7272 6179   return np_array
+000162b0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+000162c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000162d0: 2020 2072 6574 7572 6e20 6765 7461 7474     return getatt
+000162e0: 7228 7365 6c66 5f61 7272 6179 2c20 6f70  r(self_array, op
+000162f0: 6572 6174 696f 6e29 286f 7468 6572 5f61  eration)(other_a
+00016300: 7272 6179 290a 2020 2020 2020 2020 656c  rray).        el
+00016310: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
+00016320: 6c66 5f61 7272 6179 2c20 7370 2e43 4f4f  lf_array, sp.COO
+00016330: 2920 616e 6420 6973 696e 7374 616e 6365  ) and isinstance
+00016340: 286f 7468 6572 5f61 7272 6179 2c20 7370  (other_array, sp
+00016350: 2e43 4f4f 293a 0a20 2020 2020 2020 2020  .COO):.         
+00016360: 2020 2072 6574 7572 6e20 6765 7461 7474     return getatt
+00016370: 7228 7365 6c66 5f61 7272 6179 2c20 6f70  r(self_array, op
+00016380: 6572 6174 696f 6e29 286f 7468 6572 5f61  eration)(other_a
+00016390: 7272 6179 290a 2020 2020 2020 2020 656c  rray).        el
+000163a0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000163b0: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
+000163c0: 2249 6e76 616c 6964 2064 6174 6120 7479  "Invalid data ty
+000163d0: 7065 2066 6f72 2027 6461 7461 2720 7072  pe for 'data' pr
+000163e0: 6f70 6572 7479 2229 0a0a 2020 2020 6465  operty")..    de
+000163f0: 6620 5f5f 6164 645f 5f28 7365 6c66 2c20  f __add__(self, 
+00016400: 6f74 6865 723a 2055 6e69 6f6e 5b69 6e74  other: Union[int
+00016410: 2c20 666c 6f61 742c 2027 4172 7261 7927  , float, 'Array'
+00016420: 5d29 202d 3e20 2741 7272 6179 273a 0a20  ]) -> 'Array':. 
+00016430: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00016440: 2020 2041 6464 2074 6865 2041 7272 6179     Add the Array
+00016450: 2077 6974 6820 616e 6f74 6865 7220 4172   with another Ar
+00016460: 7261 7920 6f72 2061 206e 756d 6265 722e  ray or a number.
+00016470: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
+00016480: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
+00016490: 723a 2054 6865 206f 7468 6572 2041 7272  r: The other Arr
+000164a0: 6179 206f 7220 6e75 6d62 6572 2074 6f20  ay or number to 
+000164b0: 6164 642e 0a0a 2020 2020 2020 2020 5265  add...        Re
+000164c0: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
+000164d0: 2020 2041 206e 6577 2041 7272 6179 206f     A new Array o
+000164e0: 626a 6563 7420 7769 7468 2074 6865 2072  bject with the r
+000164f0: 6573 756c 7420 6f66 2074 6865 2061 6464  esult of the add
+00016500: 6974 696f 6e2e 0a0a 2020 2020 2020 2020  ition...        
+00016510: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+00016520: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
+00016530: 2020 2020 2020 2020 2020 203e 3e3e 2063             >>> c
+00016540: 6f6f 7264 7331 203d 207b 2764 696d 3127  oords1 = {'dim1'
+00016550: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+00016560: 696d 3227 3a20 5b31 2c20 325d 7d0a 2020  im2': [1, 2]}.  
+00016570: 2020 2020 2020 2020 2020 3e3e 3e20 6c6f            >>> lo
+00016580: 6e67 3120 3d20 4c6f 6e67 2869 6e64 6578  ng1 = Long(index
+00016590: 3d7b 2764 696d 3127 3a20 5b27 6127 2c20  ={'dim1': ['a', 
+000165a0: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
+000165b0: 2c20 325d 7d2c 2076 616c 7565 3d5b 3130  , 2]}, value=[10
+000165c0: 2c20 3230 5d29 0a20 2020 2020 2020 2020  , 20]).         
+000165d0: 2020 203e 3e3e 2061 7272 3120 3d20 4172     >>> arr1 = Ar
+000165e0: 7261 7928 6461 7461 3d6c 6f6e 6731 2c20  ray(data=long1, 
+000165f0: 636f 6f72 6473 3d63 6f6f 7264 7331 290a  coords=coords1).
 00016600: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00016610: 6c6f 6e67 3220 3d20 4c6f 6e67 2869 6e64  long2 = Long(ind
-00016620: 6578 3d7b 2764 696d 3127 3a20 5b27 6127  ex={'dim1': ['a'
-00016630: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
-00016640: 5b31 2c20 325d 7d2c 2076 616c 7565 3d5b  [1, 2]}, value=[
-00016650: 3330 2c20 3430 5d29 0a20 2020 2020 2020  30, 40]).       
-00016660: 2020 2020 203e 3e3e 2061 7272 3220 3d20       >>> arr2 = 
-00016670: 4172 7261 7928 6461 7461 3d6c 6f6e 6732  Array(data=long2
-00016680: 2c20 636f 6f72 6473 3d63 6f6f 7264 7332  , coords=coords2
-00016690: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-000166a0: 3e20 6172 7231 202b 2061 7272 320a 2020  > arr1 + arr2.  
-000166b0: 2020 2020 2020 2020 2020 4172 7261 7928            Array(
-000166c0: 6461 7461 3d61 7272 6179 285b 5b34 302e  data=array([[40.
-000166d0: 2c20 2030 2e5d 2c0a 2020 2020 2020 2020  ,  0.],.        
-000166e0: 2020 2020 2020 2020 2020 205b 2030 2e2c             [ 0.,
-000166f0: 2036 302e 5d5d 292c 2063 6f6f 7264 733d   60.]]), coords=
-00016700: 7b27 6469 6d31 273a 2061 7272 6179 285b  {'dim1': array([
-00016710: 2761 272c 2027 6227 5d2c 2064 7479 7065  'a', 'b'], dtype
-00016720: 3d6f 626a 6563 7429 2c20 2764 696d 3227  =object), 'dim2'
-00016730: 3a20 6172 7261 7928 5b31 2c20 325d 297d  : array([1, 2])}
-00016740: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-00016750: 3e20 6172 7231 202b 2035 0a20 2020 2020  > arr1 + 5.     
-00016760: 2020 2020 2020 2041 7272 6179 2864 6174         Array(dat
-00016770: 613d 6172 7261 7928 5b5b 3135 2e2c 2020  a=array([[15.,  
-00016780: 352e 5d2c 0a20 2020 2020 2020 2020 2020  5.],.           
-00016790: 2020 2020 2020 2020 5b20 352e 2c20 3235          [ 5., 25
-000167a0: 2e5d 5d29 2c20 636f 6f72 6473 3d7b 2764  .]]), coords={'d
-000167b0: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
-000167c0: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
-000167d0: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
-000167e0: 7272 6179 285b 312c 2032 5d29 7d29 0a0a  rray([1, 2])})..
-000167f0: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-00016800: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00016810: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00016820: 6528 6f74 6865 722c 2028 696e 742c 2066  e(other, (int, f
-00016830: 6c6f 6174 2929 3a0a 2020 2020 2020 2020  loat)):.        
-00016840: 2020 2020 6172 7220 3d20 7365 6c66 2e64      arr = self.d
-00016850: 6174 6120 2b20 6f74 6865 720a 2020 2020  ata + other.    
-00016860: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00016870: 656c 662e 5f70 6f73 745f 6f70 6572 6174  elf._post_operat
-00016880: 696f 6e28 6172 722c 2073 656c 662e 636f  ion(arr, self.co
-00016890: 6f72 6473 290a 2020 2020 2020 2020 656c  ords).        el
-000168a0: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
-000168b0: 6865 722c 2041 7272 6179 293a 0a20 2020  her, Array):.   
-000168c0: 2020 2020 2020 2020 2073 656c 665f 6172           self_ar
-000168d0: 722c 206f 7468 6572 5f61 7272 2c20 636f  r, other_arr, co
-000168e0: 6f72 6473 203d 2073 656c 662e 5f70 7265  ords = self._pre
-000168f0: 5f6f 7065 7261 7469 6f6e 5f77 6974 685f  _operation_with_
-00016900: 6172 7261 7928 6f74 6865 7229 0a20 2020  array(other).   
-00016910: 2020 2020 2020 2020 2061 7272 203d 2073           arr = s
-00016920: 656c 662e 5f6f 7065 7261 7469 6f6e 2873  elf._operation(s
-00016930: 656c 665f 6172 722c 206f 7468 6572 5f61  elf_arr, other_a
-00016940: 7272 2c20 2761 6464 2729 0a20 2020 2020  rr, 'add').     
-00016950: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00016960: 6c66 2e5f 706f 7374 5f6f 7065 7261 7469  lf._post_operati
-00016970: 6f6e 2861 7272 2e54 2c20 636f 6f72 6473  on(arr.T, coords
-00016980: 290a 0a20 2020 2064 6566 205f 5f6d 756c  )..    def __mul
-00016990: 5f5f 2873 656c 662c 206f 7468 6572 3a20  __(self, other: 
-000169a0: 556e 696f 6e5b 696e 742c 2066 6c6f 6174  Union[int, float
-000169b0: 2c20 2741 7272 6179 275d 2920 2d3e 2027  , 'Array']) -> '
-000169c0: 4172 7261 7927 3a0a 2020 2020 2020 2020  Array':.        
-000169d0: 2222 220a 2020 2020 2020 2020 4d75 6c74  """.        Mult
-000169e0: 6970 6c79 2074 6865 2041 7272 6179 2077  iply the Array w
-000169f0: 6974 6820 616e 6f74 6865 7220 4172 7261  ith another Arra
-00016a00: 7920 6f72 2061 206e 756d 6265 722e 0a0a  y or a number...
-00016a10: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00016a20: 2020 2020 2020 2020 2020 6f74 6865 723a            other:
-00016a30: 2054 6865 206f 7468 6572 2041 7272 6179   The other Array
-00016a40: 206f 7220 6e75 6d62 6572 2074 6f20 6d75   or number to mu
-00016a50: 6c74 6970 6c79 2e0a 0a20 2020 2020 2020  ltiply...       
-00016a60: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-00016a70: 2020 2020 2020 4120 6e65 7720 4172 7261        A new Arra
-00016a80: 7920 6f62 6a65 6374 2077 6974 6820 7468  y object with th
-00016a90: 6520 7265 7375 6c74 206f 6620 7468 6520  e result of the 
-00016aa0: 6d75 6c74 6970 6c69 6361 7469 6f6e 2e0a  multiplication..
-00016ab0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-00016ac0: 3a0a 2020 2020 2020 2020 2020 2020 6060  :.            ``
-00016ad0: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
-00016ae0: 2020 2020 3e3e 3e20 636f 6f72 6473 3120      >>> coords1 
-00016af0: 3d20 7b27 6469 6d31 273a 205b 2761 272c  = {'dim1': ['a',
-00016b00: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-00016b10: 312c 2032 5d7d 0a20 2020 2020 2020 2020  1, 2]}.         
-00016b20: 2020 203e 3e3e 206c 6f6e 6731 203d 204c     >>> long1 = L
-00016b30: 6f6e 6728 696e 6465 783d 7b27 6469 6d31  ong(index={'dim1
-00016b40: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
-00016b50: 6469 6d32 273a 205b 312c 2032 5d7d 2c20  dim2': [1, 2]}, 
-00016b60: 7661 6c75 653d 5b31 302c 2032 305d 290a  value=[10, 20]).
-00016b70: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00016b80: 6172 7231 203d 2041 7272 6179 2864 6174  arr1 = Array(dat
-00016b90: 613d 6c6f 6e67 312c 2063 6f6f 7264 733d  a=long1, coords=
-00016ba0: 636f 6f72 6473 3129 0a20 2020 2020 2020  coords1).       
-00016bb0: 2020 2020 203e 3e3e 2063 6f6f 7264 7332       >>> coords2
-00016bc0: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
-00016bd0: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
-00016be0: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
-00016bf0: 2020 2020 3e3e 3e20 6c6f 6e67 3220 3d20      >>> long2 = 
-00016c00: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
-00016c10: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-00016c20: 2764 696d 3227 3a20 5b31 2c20 325d 7d2c  'dim2': [1, 2]},
-00016c30: 2076 616c 7565 3d5b 3330 2c20 3430 5d29   value=[30, 40])
-00016c40: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00016c50: 2061 7272 3220 3d20 4172 7261 7928 6461   arr2 = Array(da
-00016c60: 7461 3d6c 6f6e 6732 2c20 636f 6f72 6473  ta=long2, coords
-00016c70: 3d63 6f6f 7264 7332 290a 2020 2020 2020  =coords2).      
-00016c80: 2020 2020 2020 3e3e 3e20 6172 7231 202a        >>> arr1 *
-00016c90: 2061 7272 320a 2020 2020 2020 2020 2020   arr2.          
-00016ca0: 2020 4172 7261 7928 6461 7461 3d61 7272    Array(data=arr
-00016cb0: 6179 285b 5b33 3030 2e2c 2020 2030 2e5d  ay([[300.,   0.]
-00016cc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00016cd0: 2020 2020 205b 2020 302e 2c20 3830 302e       [  0., 800.
-00016ce0: 5d5d 292c 2063 6f6f 7264 733d 7b27 6469  ]]), coords={'di
-00016cf0: 6d31 273a 2061 7272 6179 285b 2761 272c  m1': array(['a',
-00016d00: 2027 6227 5d2c 2064 7479 7065 3d6f 626a   'b'], dtype=obj
-00016d10: 6563 7429 2c20 2764 696d 3227 3a20 6172  ect), 'dim2': ar
-00016d20: 7261 7928 5b31 2c20 325d 297d 290a 2020  ray([1, 2])}).  
-00016d30: 2020 2020 2020 2020 2020 3e3e 3e20 6172            >>> ar
-00016d40: 7231 202a 2035 0a20 2020 2020 2020 2020  r1 * 5.         
-00016d50: 2020 2041 7272 6179 2864 6174 613d 6172     Array(data=ar
-00016d60: 7261 7928 5b5b 2035 302e 2c20 2020 302e  ray([[ 50.,   0.
-00016d70: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00016d80: 2020 2020 2020 5b20 2030 2e2c 2031 3030        [  0., 100
-00016d90: 2e5d 5d29 2c20 636f 6f72 6473 3d7b 2764  .]]), coords={'d
-00016da0: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
-00016db0: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
-00016dc0: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
-00016dd0: 7272 6179 285b 312c 2032 5d29 7d29 0a0a  rray([1, 2])})..
-00016de0: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-00016df0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00016e00: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00016e10: 6528 6f74 6865 722c 2028 696e 742c 2066  e(other, (int, f
-00016e20: 6c6f 6174 2929 3a0a 2020 2020 2020 2020  loat)):.        
-00016e30: 2020 2020 6172 7220 3d20 7365 6c66 2e64      arr = self.d
-00016e40: 6174 6120 2a20 6f74 6865 720a 2020 2020  ata * other.    
-00016e50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00016e60: 656c 662e 5f70 6f73 745f 6f70 6572 6174  elf._post_operat
-00016e70: 696f 6e28 6172 722c 2073 656c 662e 636f  ion(arr, self.co
-00016e80: 6f72 6473 290a 2020 2020 2020 2020 656c  ords).        el
-00016e90: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
-00016ea0: 6865 722c 2041 7272 6179 293a 0a20 2020  her, Array):.   
-00016eb0: 2020 2020 2020 2020 2073 656c 665f 6172           self_ar
-00016ec0: 722c 206f 7468 6572 5f61 7272 2c20 636f  r, other_arr, co
-00016ed0: 6f72 6473 203d 2073 656c 662e 5f70 7265  ords = self._pre
-00016ee0: 5f6f 7065 7261 7469 6f6e 5f77 6974 685f  _operation_with_
-00016ef0: 6172 7261 7928 6f74 6865 7229 0a20 2020  array(other).   
-00016f00: 2020 2020 2020 2020 2061 7272 203d 2073           arr = s
-00016f10: 656c 662e 5f6f 7065 7261 7469 6f6e 2873  elf._operation(s
-00016f20: 656c 665f 6172 722c 206f 7468 6572 5f61  elf_arr, other_a
-00016f30: 7272 2c20 276d 756c 7469 706c 7927 290a  rr, 'multiply').
-00016f40: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00016f50: 726e 2073 656c 662e 5f70 6f73 745f 6f70  rn self._post_op
-00016f60: 6572 6174 696f 6e28 6172 722e 542c 2063  eration(arr.T, c
-00016f70: 6f6f 7264 7329 0a0a 2020 2020 6465 6620  oords)..    def 
-00016f80: 5f5f 7375 625f 5f28 7365 6c66 2c20 6f74  __sub__(self, ot
-00016f90: 6865 723a 2055 6e69 6f6e 5b69 6e74 2c20  her: Union[int, 
-00016fa0: 666c 6f61 742c 2027 4172 7261 7927 5d29  float, 'Array'])
-00016fb0: 202d 3e20 2741 7272 6179 273a 0a20 2020   -> 'Array':.   
-00016fc0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00016fd0: 2053 7562 7472 6163 7420 616e 6f74 6865   Subtract anothe
-00016fe0: 7220 4172 7261 7920 6f72 2061 206e 756d  r Array or a num
-00016ff0: 6265 7220 6672 6f6d 2074 6865 2041 7272  ber from the Arr
-00017000: 6179 2e0a 0a20 2020 2020 2020 2041 7267  ay...        Arg
-00017010: 733a 0a20 2020 2020 2020 2020 2020 206f  s:.            o
-00017020: 7468 6572 3a20 5468 6520 6f74 6865 7220  ther: The other 
-00017030: 4172 7261 7920 6f72 206e 756d 6265 7220  Array or number 
-00017040: 746f 2073 7562 7472 6163 742e 0a0a 2020  to subtract...  
-00017050: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
-00017060: 2020 2020 2020 2020 2020 2041 206e 6577             A new
-00017070: 2041 7272 6179 206f 626a 6563 7420 7769   Array object wi
-00017080: 7468 2074 6865 2072 6573 756c 7420 6f66  th the result of
-00017090: 2074 6865 2073 7562 7472 6163 7469 6f6e   the subtraction
-000170a0: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-000170b0: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-000170c0: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
-000170d0: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
-000170e0: 3120 3d20 7b27 6469 6d31 273a 205b 2761  1 = {'dim1': ['a
-000170f0: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
-00017100: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
-00017110: 2020 2020 203e 3e3e 206c 6f6e 6731 203d       >>> long1 =
-00017120: 204c 6f6e 6728 696e 6465 783d 7b27 6469   Long(index={'di
-00017130: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
-00017140: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
-00017150: 2c20 7661 6c75 653d 5b31 302c 2032 305d  , value=[10, 20]
-00017160: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-00017170: 3e20 6172 7231 203d 2041 7272 6179 2864  > arr1 = Array(d
-00017180: 6174 613d 6c6f 6e67 312c 2063 6f6f 7264  ata=long1, coord
-00017190: 733d 636f 6f72 6473 3129 0a20 2020 2020  s=coords1).     
-000171a0: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
-000171b0: 7332 203d 207b 2764 696d 3127 3a20 5b27  s2 = {'dim1': ['
-000171c0: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
-000171d0: 3a20 5b31 2c20 325d 7d0a 2020 2020 2020  : [1, 2]}.      
-000171e0: 2020 2020 2020 3e3e 3e20 6c6f 6e67 3220        >>> long2 
-000171f0: 3d20 4c6f 6e67 2869 6e64 6578 3d7b 2764  = Long(index={'d
-00017200: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
-00017210: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
-00017220: 7d2c 2076 616c 7565 3d5b 3330 2c20 3430  }, value=[30, 40
-00017230: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
-00017240: 3e3e 2061 7272 3220 3d20 4172 7261 7928  >> arr2 = Array(
-00017250: 6461 7461 3d6c 6f6e 6732 2c20 636f 6f72  data=long2, coor
-00017260: 6473 3d63 6f6f 7264 7332 290a 2020 2020  ds=coords2).    
-00017270: 2020 2020 2020 2020 3e3e 3e20 6172 7231          >>> arr1
-00017280: 202d 2061 7272 320a 2020 2020 2020 2020   - arr2.        
-00017290: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
-000172a0: 7272 6179 285b 5b2d 3230 2e2c 2020 2030  rray([[-20.,   0
-000172b0: 2e5d 2c0a 2020 2020 2020 2020 2020 2020  .],.            
-000172c0: 2020 2020 2020 205b 2020 302e 2c20 2d32         [  0., -2
-000172d0: 302e 5d5d 292c 2063 6f6f 7264 733d 7b27  0.]]), coords={'
-000172e0: 6469 6d31 273a 2061 7272 6179 285b 2761  dim1': array(['a
-000172f0: 272c 2027 6227 5d2c 2064 7479 7065 3d6f  ', 'b'], dtype=o
-00017300: 626a 6563 7429 2c20 2764 696d 3227 3a20  bject), 'dim2': 
-00017310: 6172 7261 7928 5b31 2c20 325d 297d 290a  array([1, 2])}).
-00017320: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00017330: 6172 7231 202d 2035 0a20 2020 2020 2020  arr1 - 5.       
-00017340: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
-00017350: 6172 7261 7928 5b5b 2035 2e2c 202d 352e  array([[ 5., -5.
-00017360: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00017370: 2020 2020 2020 5b2d 352e 2c20 3135 2e5d        [-5., 15.]
-00017380: 5d29 2c20 636f 6f72 6473 3d7b 2764 696d  ]), coords={'dim
-00017390: 3127 3a20 6172 7261 7928 5b27 6127 2c20  1': array(['a', 
-000173a0: 2762 275d 2c20 6474 7970 653d 6f62 6a65  'b'], dtype=obje
-000173b0: 6374 292c 2027 6469 6d32 273a 2061 7272  ct), 'dim2': arr
-000173c0: 6179 285b 312c 2032 5d29 7d29 0a0a 2020  ay([1, 2])})..  
-000173d0: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
-000173e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000173f0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00017400: 6f74 6865 722c 2028 696e 742c 2066 6c6f  other, (int, flo
-00017410: 6174 2929 3a0a 2020 2020 2020 2020 2020  at)):.          
-00017420: 2020 6172 7220 3d20 7365 6c66 2e64 6174    arr = self.dat
-00017430: 6120 2d20 6f74 6865 720a 2020 2020 2020  a - other.      
-00017440: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00017450: 662e 5f70 6f73 745f 6f70 6572 6174 696f  f._post_operatio
-00017460: 6e28 6172 722c 2073 656c 662e 636f 6f72  n(arr, self.coor
-00017470: 6473 290a 2020 2020 2020 2020 656c 6966  ds).        elif
-00017480: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
-00017490: 722c 2041 7272 6179 293a 0a20 2020 2020  r, Array):.     
-000174a0: 2020 2020 2020 2073 656c 665f 6172 722c         self_arr,
-000174b0: 206f 7468 6572 5f61 7272 2c20 636f 6f72   other_arr, coor
-000174c0: 6473 203d 2073 656c 662e 5f70 7265 5f6f  ds = self._pre_o
-000174d0: 7065 7261 7469 6f6e 5f77 6974 685f 6172  peration_with_ar
-000174e0: 7261 7928 6f74 6865 7229 0a20 2020 2020  ray(other).     
-000174f0: 2020 2020 2020 2061 7272 203d 2073 656c         arr = sel
-00017500: 662e 5f6f 7065 7261 7469 6f6e 2873 656c  f._operation(sel
-00017510: 665f 6172 722c 206f 7468 6572 5f61 7272  f_arr, other_arr
-00017520: 2c20 2773 7562 7472 6163 7427 290a 2020  , 'subtract').  
-00017530: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00017540: 2073 656c 662e 5f70 6f73 745f 6f70 6572   self._post_oper
-00017550: 6174 696f 6e28 6172 722e 542c 2063 6f6f  ation(arr.T, coo
-00017560: 7264 7329 0a0a 2020 2020 6465 6620 5f5f  rds)..    def __
-00017570: 7472 7565 6469 765f 5f28 7365 6c66 2c20  truediv__(self, 
-00017580: 6f74 6865 723a 2055 6e69 6f6e 5b69 6e74  other: Union[int
-00017590: 2c20 666c 6f61 742c 2027 4172 7261 7927  , float, 'Array'
-000175a0: 5d29 202d 3e20 2741 7272 6179 273a 0a20  ]) -> 'Array':. 
-000175b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000175c0: 2020 2044 6976 6964 6520 7468 6520 4172     Divide the Ar
-000175d0: 7261 7920 6279 2061 6e6f 7468 6572 2041  ray by another A
-000175e0: 7272 6179 206f 7220 6120 6e75 6d62 6572  rray or a number
-000175f0: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-00017600: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
-00017610: 6572 3a20 5468 6520 6f74 6865 7220 4172  er: The other Ar
-00017620: 7261 7920 6f72 206e 756d 6265 7220 746f  ray or number to
-00017630: 2064 6976 6964 6520 6279 2e0a 0a20 2020   divide by...   
-00017640: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
-00017650: 2020 2020 2020 2020 2020 4120 6e65 7720            A new 
-00017660: 4172 7261 7920 6f62 6a65 6374 2077 6974  Array object wit
-00017670: 6820 7468 6520 7265 7375 6c74 206f 6620  h the result of 
-00017680: 7468 6520 6469 7669 7369 6f6e 2e0a 0a20  the division... 
-00017690: 2020 2020 2020 2045 7861 6d70 6c65 3a0a         Example:.
-000176a0: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
-000176b0: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
-000176c0: 2020 3e3e 3e20 636f 6f72 6473 3120 3d20    >>> coords1 = 
-000176d0: 7b27 6469 6d31 273a 205b 2761 272c 2027  {'dim1': ['a', '
-000176e0: 6227 5d2c 2027 6469 6d32 273a 205b 312c  b'], 'dim2': [1,
-000176f0: 2032 5d7d 0a20 2020 2020 2020 2020 2020   2]}.           
-00017700: 203e 3e3e 206c 6f6e 6731 203d 204c 6f6e   >>> long1 = Lon
-00017710: 6728 696e 6465 783d 7b27 6469 6d31 273a  g(index={'dim1':
-00017720: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
-00017730: 6d32 273a 205b 312c 2032 5d7d 2c20 7661  m2': [1, 2]}, va
-00017740: 6c75 653d 5b31 302c 2032 305d 290a 2020  lue=[10, 20]).  
-00017750: 2020 2020 2020 2020 2020 3e3e 3e20 6172            >>> ar
-00017760: 7231 203d 2041 7272 6179 2864 6174 613d  r1 = Array(data=
-00017770: 6c6f 6e67 312c 2063 6f6f 7264 733d 636f  long1, coords=co
-00017780: 6f72 6473 3129 0a20 2020 2020 2020 2020  ords1).         
-00017790: 2020 203e 3e3e 2063 6f6f 7264 7332 203d     >>> coords2 =
-000177a0: 207b 2764 696d 3127 3a20 5b27 6127 2c20   {'dim1': ['a', 
-000177b0: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
-000177c0: 2c20 325d 7d0a 2020 2020 2020 2020 2020  , 2]}.          
-000177d0: 2020 3e3e 3e20 6c6f 6e67 3220 3d20 4c6f    >>> long2 = Lo
-000177e0: 6e67 2869 6e64 6578 3d7b 2764 696d 3127  ng(index={'dim1'
-000177f0: 3a20 5b27 6127 2c27 6127 2c20 2762 272c  : ['a','a', 'b',
-00017800: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-00017810: 312c 2032 2c20 312c 2032 5d7d 2c20 7661  1, 2, 1, 2]}, va
-00017820: 6c75 653d 5b33 302c 2034 302c 2035 302c  lue=[30, 40, 50,
-00017830: 2036 305d 290a 2020 2020 2020 2020 2020   60]).          
-00017840: 2020 3e3e 3e20 6172 7232 203d 2041 7272    >>> arr2 = Arr
-00017850: 6179 2864 6174 613d 6c6f 6e67 322c 2063  ay(data=long2, c
-00017860: 6f6f 7264 733d 636f 6f72 6473 3229 0a20  oords=coords2). 
-00017870: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
-00017880: 7272 3120 2f20 6172 7232 0a20 2020 2020  rr1 / arr2.     
-00017890: 2020 2020 2020 2041 7272 6179 2864 6174         Array(dat
-000178a0: 613d 6172 7261 7928 5b5b 302e 3333 3333  a=array([[0.3333
-000178b0: 3333 3333 2c20 302e 2020 2020 2020 2020  3333, 0.        
-000178c0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-000178d0: 2020 2020 2020 5b30 2e20 2020 2020 2020        [0.       
-000178e0: 202c 2030 2e33 3333 3333 3333 335d 5d29   , 0.33333333]])
-000178f0: 2c20 636f 6f72 6473 3d7b 2764 696d 3127  , coords={'dim1'
-00017900: 3a20 6172 7261 7928 5b27 6127 2c20 2762  : array(['a', 'b
-00017910: 275d 2c20 6474 7970 653d 6f62 6a65 6374  '], dtype=object
-00017920: 292c 2027 6469 6d32 273a 2061 7272 6179  ), 'dim2': array
-00017930: 285b 312c 2032 5d29 7d29 0a20 2020 2020  ([1, 2])}).     
-00017940: 2020 2020 2020 203e 3e3e 2061 7272 3120         >>> arr1 
-00017950: 2f20 350a 2020 2020 2020 2020 2020 2020  / 5.            
-00017960: 4172 7261 7928 6461 7461 3d61 7272 6179  Array(data=array
-00017970: 285b 5b32 2e2c 2030 2e5d 2c0a 2020 2020  ([[2., 0.],.    
-00017980: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00017990: 302e 2c20 342e 5d5d 292c 2063 6f6f 7264  0., 4.]]), coord
-000179a0: 733d 7b27 6469 6d31 273a 2061 7272 6179  s={'dim1': array
-000179b0: 285b 2761 272c 2027 6227 5d2c 2064 7479  (['a', 'b'], dty
-000179c0: 7065 3d6f 626a 6563 7429 2c20 2764 696d  pe=object), 'dim
-000179d0: 3227 3a20 6172 7261 7928 5b31 2c20 325d  2': array([1, 2]
-000179e0: 297d 290a 0a20 2020 2020 2020 2020 2020  )})..           
-000179f0: 2060 6060 0a20 2020 2020 2020 2022 2222   ```.        """
-00017a00: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00017a10: 7374 616e 6365 286f 7468 6572 2c20 2869  stance(other, (i
-00017a20: 6e74 2c20 666c 6f61 7429 293a 0a20 2020  nt, float)):.   
-00017a30: 2020 2020 2020 2020 2061 7272 203d 2073           arr = s
-00017a40: 656c 662e 6461 7461 202f 206f 7468 6572  elf.data / other
-00017a50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00017a60: 7572 6e20 7365 6c66 2e5f 706f 7374 5f6f  urn self._post_o
-00017a70: 7065 7261 7469 6f6e 2861 7272 2c20 7365  peration(arr, se
-00017a80: 6c66 2e63 6f6f 7264 7329 0a20 2020 2020  lf.coords).     
-00017a90: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-00017aa0: 6365 286f 7468 6572 2c20 4172 7261 7929  ce(other, Array)
-00017ab0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00017ac0: 6c66 5f61 7272 2c20 6f74 6865 725f 6172  lf_arr, other_ar
-00017ad0: 722c 2063 6f6f 7264 7320 3d20 7365 6c66  r, coords = self
-00017ae0: 2e5f 7072 655f 6f70 6572 6174 696f 6e5f  ._pre_operation_
-00017af0: 7769 7468 5f61 7272 6179 286f 7468 6572  with_array(other
-00017b00: 290a 2020 2020 2020 2020 2020 2020 6172  ).            ar
-00017b10: 7220 3d20 7365 6c66 2e5f 6f70 6572 6174  r = self._operat
-00017b20: 696f 6e28 7365 6c66 5f61 7272 2c20 6f74  ion(self_arr, ot
-00017b30: 6865 725f 6172 722c 2027 7472 7565 5f64  her_arr, 'true_d
-00017b40: 6976 6964 6527 290a 2020 2020 2020 2020  ivide').        
-00017b50: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00017b60: 5f70 6f73 745f 6f70 6572 6174 696f 6e28  _post_operation(
-00017b70: 6172 722e 542c 2063 6f6f 7264 7329 0a0a  arr.T, coords)..
-00017b80: 2020 2020 6465 6620 5f5f 7261 6464 5f5f      def __radd__
-00017b90: 2873 656c 662c 206f 7468 6572 3a20 556e  (self, other: Un
-00017ba0: 696f 6e5b 696e 742c 2066 6c6f 6174 5d29  ion[int, float])
-00017bb0: 202d 3e20 2741 7272 6179 273a 0a20 2020   -> 'Array':.   
-00017bc0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00017bd0: 2041 6464 2061 206e 756d 6265 7220 746f   Add a number to
-00017be0: 2074 6865 2041 7272 6179 2028 7265 7665   the Array (reve
-00017bf0: 7273 6520 6164 6469 7469 6f6e 292e 0a0a  rse addition)...
-00017c00: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00017c10: 2020 2020 2020 2020 2020 6f74 6865 723a            other:
-00017c20: 2054 6865 206e 756d 6265 7220 746f 2061   The number to a
-00017c30: 6464 2e0a 0a20 2020 2020 2020 2052 6574  dd...        Ret
-00017c40: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-00017c50: 2020 4120 6e65 7720 4172 7261 7920 6f62    A new Array ob
-00017c60: 6a65 6374 2077 6974 6820 7468 6520 7265  ject with the re
-00017c70: 7375 6c74 206f 6620 7468 6520 6164 6469  sult of the addi
-00017c80: 7469 6f6e 2e0a 0a20 2020 2020 2020 2045  tion...        E
-00017c90: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-00017ca0: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
-00017cb0: 2020 2020 2020 2020 2020 3e3e 3e20 636f            >>> co
-00017cc0: 6f72 6473 203d 207b 2764 696d 3127 3a20  ords = {'dim1': 
-00017cd0: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
-00017ce0: 3227 3a20 5b31 2c20 325d 7d0a 2020 2020  2': [1, 2]}.    
-00017cf0: 2020 2020 2020 2020 3e3e 3e20 6c6f 6e67          >>> long
-00017d00: 203d 204c 6f6e 6728 696e 6465 783d 7b27   = Long(index={'
-00017d10: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
-00017d20: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
-00017d30: 5d7d 2c20 7661 6c75 653d 5b31 302c 2032  ]}, value=[10, 2
-00017d40: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-00017d50: 3e3e 3e20 6172 7220 3d20 4172 7261 7928  >>> arr = Array(
-00017d60: 6461 7461 3d6c 6f6e 672c 2063 6f6f 7264  data=long, coord
-00017d70: 733d 636f 6f72 6473 290a 2020 2020 2020  s=coords).      
-00017d80: 2020 2020 2020 3e3e 3e20 3520 2b20 6172        >>> 5 + ar
-00017d90: 720a 2020 2020 2020 2020 2020 2020 4172  r.            Ar
-00017da0: 7261 7928 6461 7461 3d61 7272 6179 285b  ray(data=array([
-00017db0: 5b31 352e 2c20 2035 2e5d 2c0a 2020 2020  [15.,  5.],.    
-00017dc0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00017dd0: 2035 2e2c 2032 352e 5d5d 292c 2063 6f6f   5., 25.]]), coo
-00017de0: 7264 733d 7b27 6469 6d31 273a 2061 7272  rds={'dim1': arr
-00017df0: 6179 285b 2761 272c 2027 6227 5d2c 2064  ay(['a', 'b'], d
-00017e00: 7479 7065 3d6f 626a 6563 7429 2c20 2764  type=object), 'd
-00017e10: 696d 3227 3a20 6172 7261 7928 5b31 2c20  im2': array([1, 
-00017e20: 325d 297d 290a 0a20 2020 2020 2020 2020  2])})..         
-00017e30: 2020 2060 6060 0a20 2020 2020 2020 2022     ```.        "
-00017e40: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
-00017e50: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
-00017e60: 2869 6e74 2c20 666c 6f61 7429 293a 0a20  (int, float)):. 
-00017e70: 2020 2020 2020 2020 2020 2061 7272 203d             arr =
-00017e80: 2073 656c 662e 6461 7461 202b 206f 7468   self.data + oth
-00017e90: 6572 0a20 2020 2020 2020 2020 2020 2072  er.            r
-00017ea0: 6574 7572 6e20 7365 6c66 2e5f 706f 7374  eturn self._post
-00017eb0: 5f6f 7065 7261 7469 6f6e 2861 7272 2c20  _operation(arr, 
-00017ec0: 7365 6c66 2e63 6f6f 7264 7329 0a0a 2020  self.coords)..  
-00017ed0: 2020 6465 6620 5f5f 726d 756c 5f5f 2873    def __rmul__(s
-00017ee0: 656c 662c 206f 7468 6572 3a20 556e 696f  elf, other: Unio
-00017ef0: 6e5b 696e 742c 2066 6c6f 6174 5d29 202d  n[int, float]) -
-00017f00: 3e20 2741 7272 6179 273a 0a20 2020 2020  > 'Array':.     
-00017f10: 2020 2022 2222 0a20 2020 2020 2020 204d     """.        M
-00017f20: 756c 7469 706c 7920 6120 6e75 6d62 6572  ultiply a number
-00017f30: 2077 6974 6820 7468 6520 4172 7261 7920   with the Array 
-00017f40: 2872 6576 6572 7365 206d 756c 7469 706c  (reverse multipl
-00017f50: 6963 6174 696f 6e29 2e0a 0a20 2020 2020  ication)...     
-00017f60: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-00017f70: 2020 2020 206f 7468 6572 3a20 5468 6520       other: The 
-00017f80: 6e75 6d62 6572 2074 6f20 6d75 6c74 6970  number to multip
-00017f90: 6c79 2e0a 0a20 2020 2020 2020 2052 6574  ly...        Ret
-00017fa0: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-00017fb0: 2020 4120 6e65 7720 4172 7261 7920 6f62    A new Array ob
-00017fc0: 6a65 6374 2077 6974 6820 7468 6520 7265  ject with the re
-00017fd0: 7375 6c74 206f 6620 7468 6520 6d75 6c74  sult of the mult
-00017fe0: 6970 6c69 6361 7469 6f6e 2e0a 0a20 2020  iplication...   
-00017ff0: 2020 2020 2045 7861 6d70 6c65 3a0a 2020       Example:.  
-00018000: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
-00018010: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
-00018020: 3e3e 3e20 636f 6f72 6473 203d 207b 2764  >>> coords = {'d
-00018030: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
-00018040: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
-00018050: 7d0a 2020 2020 2020 2020 2020 2020 3e3e  }.            >>
-00018060: 3e20 6c6f 6e67 203d 204c 6f6e 6728 696e  > long = Long(in
-00018070: 6465 783d 7b27 6469 6d31 273a 205b 2761  dex={'dim1': ['a
-00018080: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
-00018090: 205b 312c 2032 5d7d 2c20 7661 6c75 653d   [1, 2]}, value=
-000180a0: 5b31 302c 2032 305d 290a 2020 2020 2020  [10, 20]).      
-000180b0: 2020 2020 2020 3e3e 3e20 6172 7220 3d20        >>> arr = 
-000180c0: 4172 7261 7928 6461 7461 3d6c 6f6e 672c  Array(data=long,
-000180d0: 2063 6f6f 7264 733d 636f 6f72 6473 290a   coords=coords).
-000180e0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-000180f0: 3520 2a20 6172 720a 2020 2020 2020 2020  5 * arr.        
-00018100: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
-00018110: 7272 6179 285b 5b20 3530 2e2c 2020 2030  rray([[ 50.,   0
-00018120: 2e5d 2c0a 2020 2020 2020 2020 2020 2020  .],.            
-00018130: 2020 2020 2020 205b 2020 302e 2c20 3130         [  0., 10
-00018140: 302e 5d5d 292c 2063 6f6f 7264 733d 7b27  0.]]), coords={'
-00018150: 6469 6d31 273a 2061 7272 6179 285b 2761  dim1': array(['a
-00018160: 272c 2027 6227 5d2c 2064 7479 7065 3d6f  ', 'b'], dtype=o
-00018170: 626a 6563 7429 2c20 2764 696d 3227 3a20  bject), 'dim2': 
-00018180: 6172 7261 7928 5b31 2c20 325d 297d 290a  array([1, 2])}).
-00018190: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-000181a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000181b0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-000181c0: 6365 286f 7468 6572 2c20 2869 6e74 2c20  ce(other, (int, 
-000181d0: 666c 6f61 7429 293a 0a20 2020 2020 2020  float)):.       
-000181e0: 2020 2020 2061 7272 203d 2073 656c 662e       arr = self.
-000181f0: 6461 7461 202a 206f 7468 6572 0a20 2020  data * other.   
-00018200: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00018210: 7365 6c66 2e5f 706f 7374 5f6f 7065 7261  self._post_opera
-00018220: 7469 6f6e 2861 7272 2c20 7365 6c66 2e63  tion(arr, self.c
-00018230: 6f6f 7264 7329 0a0a 2020 2020 6465 6620  oords)..    def 
-00018240: 5f5f 7273 7562 5f5f 2873 656c 662c 206f  __rsub__(self, o
-00018250: 7468 6572 3a20 556e 696f 6e5b 696e 742c  ther: Union[int,
-00018260: 2066 6c6f 6174 5d29 202d 3e20 2741 7272   float]) -> 'Arr
-00018270: 6179 273a 0a20 2020 2020 2020 2022 2222  ay':.        """
-00018280: 0a20 2020 2020 2020 2053 7562 7472 6163  .        Subtrac
-00018290: 7420 7468 6520 4172 7261 7920 6672 6f6d  t the Array from
-000182a0: 2061 206e 756d 6265 7220 2872 6576 6572   a number (rever
-000182b0: 7365 2073 7562 7472 6163 7469 6f6e 292e  se subtraction).
-000182c0: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
-000182d0: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
-000182e0: 723a 2054 6865 206e 756d 6265 7220 746f  r: The number to
-000182f0: 2073 7562 7472 6163 7420 6672 6f6d 2e0a   subtract from..
-00018300: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00018310: 3a0a 2020 2020 2020 2020 2020 2020 4120  :.            A 
-00018320: 6e65 7720 4172 7261 7920 6f62 6a65 6374  new Array object
-00018330: 2077 6974 6820 7468 6520 7265 7375 6c74   with the result
-00018340: 206f 6620 7468 6520 7375 6274 7261 6374   of the subtract
-00018350: 696f 6e2e 0a0a 2020 2020 2020 2020 4578  ion...        Ex
-00018360: 616d 706c 653a 0a20 2020 2020 2020 2020  ample:.         
-00018370: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
-00018380: 2020 2020 2020 2020 203e 3e3e 2063 6f6f           >>> coo
-00018390: 7264 7320 3d20 7b27 6469 6d31 273a 205b  rds = {'dim1': [
-000183a0: 2761 272c 2027 6227 5d2c 2027 6469 6d32  'a', 'b'], 'dim2
-000183b0: 273a 205b 312c 2032 5d7d 0a20 2020 2020  ': [1, 2]}.     
-000183c0: 2020 2020 2020 203e 3e3e 206c 6f6e 6720         >>> long 
-000183d0: 3d20 4c6f 6e67 2869 6e64 6578 3d7b 2764  = Long(index={'d
-000183e0: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
-000183f0: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
-00018400: 7d2c 2076 616c 7565 3d5b 3130 2c20 3230  }, value=[10, 20
-00018410: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
-00018420: 3e3e 2061 7272 203d 2041 7272 6179 2864  >> arr = Array(d
-00018430: 6174 613d 6c6f 6e67 2c20 636f 6f72 6473  ata=long, coords
-00018440: 3d63 6f6f 7264 7329 0a20 2020 2020 2020  =coords).       
-00018450: 2020 2020 203e 3e3e 2035 202d 2061 7272       >>> 5 - arr
-00018460: 0a20 2020 2020 2020 2020 2020 2041 7272  .            Arr
-00018470: 6179 2864 6174 613d 6172 7261 7928 5b5b  ay(data=array([[
-00018480: 202d 352e 2c20 2020 352e 5d2c 0a20 2020   -5.,   5.],.   
-00018490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000184a0: 5b20 2035 2e2c 202d 3135 2e5d 5d29 2c20  [  5., -15.]]), 
-000184b0: 636f 6f72 6473 3d7b 2764 696d 3127 3a20  coords={'dim1': 
-000184c0: 6172 7261 7928 5b27 6127 2c20 2762 275d  array(['a', 'b']
-000184d0: 2c20 6474 7970 653d 6f62 6a65 6374 292c  , dtype=object),
-000184e0: 2027 6469 6d32 273a 2061 7272 6179 285b   'dim2': array([
-000184f0: 312c 2032 5d29 7d29 0a0a 2020 2020 2020  1, 2])})..      
-00018500: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
-00018510: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00018520: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
-00018530: 722c 2028 696e 742c 2066 6c6f 6174 2929  r, (int, float))
-00018540: 3a0a 2020 2020 2020 2020 2020 2020 6172  :.            ar
-00018550: 7220 3d20 2d73 656c 662e 6461 7461 202b  r = -self.data +
-00018560: 206f 7468 6572 0a20 2020 2020 2020 2020   other.         
-00018570: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00018580: 706f 7374 5f6f 7065 7261 7469 6f6e 2861  post_operation(a
-00018590: 7272 2c20 7365 6c66 2e63 6f6f 7264 7329  rr, self.coords)
-000185a0: 0a0a 2020 2020 6465 6620 5f5f 7274 7275  ..    def __rtru
-000185b0: 6564 6976 5f5f 2873 656c 662c 206f 7468  ediv__(self, oth
-000185c0: 6572 3a20 556e 696f 6e5b 696e 742c 2066  er: Union[int, f
-000185d0: 6c6f 6174 5d29 202d 3e20 2741 7272 6179  loat]) -> 'Array
-000185e0: 273a 0a20 2020 2020 2020 2022 2222 0a20  ':.        """. 
-000185f0: 2020 2020 2020 2044 6976 6964 6520 6120         Divide a 
-00018600: 6e75 6d62 6572 2062 7920 7468 6520 4172  number by the Ar
-00018610: 7261 7920 2872 6576 6572 7365 2064 6976  ray (reverse div
-00018620: 6973 696f 6e29 2e0a 0a20 2020 2020 2020  ision)...       
-00018630: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-00018640: 2020 206f 7468 6572 3a20 5468 6520 6e75     other: The nu
-00018650: 6d62 6572 2074 6f20 6469 7669 6465 2e0a  mber to divide..
-00018660: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00018670: 3a0a 2020 2020 2020 2020 2020 2020 4120  :.            A 
-00018680: 6e65 7720 4172 7261 7920 6f62 6a65 6374  new Array object
-00018690: 2077 6974 6820 7468 6520 7265 7375 6c74   with the result
-000186a0: 206f 6620 7468 6520 6469 7669 7369 6f6e   of the division
-000186b0: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-000186c0: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-000186d0: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
-000186e0: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
-000186f0: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
-00018700: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
-00018710: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
-00018720: 2020 2020 3e3e 3e20 6c6f 6e67 203d 204c      >>> long = L
-00018730: 6f6e 6728 696e 6465 783d 7b27 6469 6d31  ong(index={'dim1
-00018740: 273a 205b 2761 272c 2027 6127 2c20 2762  ': ['a', 'a', 'b
-00018750: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
-00018760: 205b 312c 2032 2c20 312c 2032 5d7d 2c20   [1, 2, 1, 2]}, 
-00018770: 7661 6c75 653d 5b31 302c 2032 302c 2033  value=[10, 20, 3
-00018780: 302c 2034 305d 290a 2020 2020 2020 2020  0, 40]).        
-00018790: 2020 2020 3e3e 3e20 6172 7220 3d20 4172      >>> arr = Ar
-000187a0: 7261 7928 6461 7461 3d6c 6f6e 672c 2063  ray(data=long, c
-000187b0: 6f6f 7264 733d 636f 6f72 6473 290a 2020  oords=coords).  
-000187c0: 2020 2020 2020 2020 2020 3e3e 3e20 3130            >>> 10
-000187d0: 3020 2f20 6172 720a 2020 2020 2020 2020  0 / arr.        
-000187e0: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
-000187f0: 7272 6179 285b 5b31 302e 2020 2020 2020  rray([[10.      
-00018800: 2020 2c20 2035 2e20 2020 2020 2020 205d    ,  5.        ]
-00018810: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00018820: 2020 2020 205b 2033 2e33 3333 3333 3333       [ 3.3333333
-00018830: 332c 2020 322e 3520 2020 2020 2020 5d5d  3,  2.5       ]]
-00018840: 292c 2063 6f6f 7264 733d 7b27 6469 6d31  ), coords={'dim1
-00018850: 273a 2061 7272 6179 285b 2761 272c 2027  ': array(['a', '
-00018860: 6227 5d2c 2064 7479 7065 3d6f 626a 6563  b'], dtype=objec
-00018870: 7429 2c20 2764 696d 3227 3a20 6172 7261  t), 'dim2': arra
-00018880: 7928 5b31 2c20 325d 297d 290a 0a20 2020  y([1, 2])})..   
-00018890: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
-000188a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000188b0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
-000188c0: 7468 6572 2c20 2869 6e74 2c20 666c 6f61  ther, (int, floa
-000188d0: 7429 293a 0a20 2020 2020 2020 2020 2020  t)):.           
-000188e0: 2061 7272 203d 206f 7468 6572 202f 2073   arr = other / s
-000188f0: 656c 662e 6461 7461 0a20 2020 2020 2020  elf.data.       
-00018900: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00018910: 2e5f 706f 7374 5f6f 7065 7261 7469 6f6e  ._post_operation
-00018920: 2861 7272 2c20 7365 6c66 2e63 6f6f 7264  (arr, self.coord
-00018930: 7329 0a0a 2020 2020 6465 6620 5f5f 6e65  s)..    def __ne
-00018940: 675f 5f28 7365 6c66 2920 2d3e 2027 4172  g__(self) -> 'Ar
-00018950: 7261 7927 3a0a 2020 2020 2020 2020 2222  ray':.        ""
-00018960: 220a 2020 2020 2020 2020 4e65 6761 7465  ".        Negate
-00018970: 2074 6865 2041 7272 6179 2e0a 0a20 2020   the Array...   
-00018980: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
-00018990: 2020 2020 2020 2020 2020 4120 6e65 7720            A new 
-000189a0: 4172 7261 7920 6f62 6a65 6374 2077 6974  Array object wit
-000189b0: 6820 7468 6520 6e65 6761 7465 6420 7661  h the negated va
-000189c0: 6c75 6573 2e0a 0a20 2020 2020 2020 2045  lues...        E
-000189d0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-000189e0: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
-000189f0: 2020 2020 2020 2020 2020 3e3e 3e20 636f            >>> co
-00018a00: 6f72 6473 203d 207b 2764 696d 3127 3a20  ords = {'dim1': 
-00018a10: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
-00018a20: 3227 3a20 5b31 2c20 325d 7d0a 2020 2020  2': [1, 2]}.    
-00018a30: 2020 2020 2020 2020 3e3e 3e20 6c6f 6e67          >>> long
-00018a40: 203d 204c 6f6e 6728 696e 6465 783d 7b27   = Long(index={'
-00018a50: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
-00018a60: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
-00018a70: 5d7d 2c20 7661 6c75 653d 5b31 302c 2032  ]}, value=[10, 2
-00018a80: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-00018a90: 3e3e 3e20 6172 7220 3d20 4172 7261 7928  >>> arr = Array(
-00018aa0: 6461 7461 3d6c 6f6e 672c 2063 6f6f 7264  data=long, coord
-00018ab0: 733d 636f 6f72 6473 290a 2020 2020 2020  s=coords).      
-00018ac0: 2020 2020 2020 3e3e 3e20 2d61 7272 0a20        >>> -arr. 
-00018ad0: 2020 2020 2020 2020 2020 2041 7272 6179             Array
-00018ae0: 2864 6174 613d 6172 7261 7928 5b5b 2d31  (data=array([[-1
-00018af0: 302e 2c20 2020 302e 5d2c 0a20 2020 2020  0.,   0.],.     
-00018b00: 2020 2020 2020 2020 2020 2020 2020 5b20                [ 
-00018b10: 2030 2e2c 202d 3230 2e5d 5d29 2c20 636f   0., -20.]]), co
-00018b20: 6f72 6473 3d7b 2764 696d 3127 3a20 6172  ords={'dim1': ar
-00018b30: 7261 7928 5b27 6127 2c20 2762 275d 2c20  ray(['a', 'b'], 
-00018b40: 6474 7970 653d 6f62 6a65 6374 292c 2027  dtype=object), '
-00018b50: 6469 6d32 273a 2061 7272 6179 285b 312c  dim2': array([1,
-00018b60: 2032 5d29 7d29 0a0a 2020 2020 2020 2020   2])})..        
-00018b70: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
-00018b80: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00018b90: 726e 2073 656c 662e 5f70 6f73 745f 6f70  rn self._post_op
-00018ba0: 6572 6174 696f 6e28 2d73 656c 662e 6461  eration(-self.da
-00018bb0: 7461 2c20 7365 6c66 2e63 6f6f 7264 7329  ta, self.coords)
-00018bc0: 0a0a 2020 2020 6465 6620 5f5f 706f 735f  ..    def __pos_
-00018bd0: 5f28 7365 6c66 2920 2d3e 2027 4172 7261  _(self) -> 'Arra
-00018be0: 7927 3a0a 2020 2020 2020 2020 2222 220a  y':.        """.
-00018bf0: 2020 2020 2020 2020 4170 706c 7920 7468          Apply th
-00018c00: 6520 756e 6172 7920 706f 7369 7469 7665  e unary positive
-00018c10: 206f 7065 7261 746f 7220 746f 2074 6865   operator to the
-00018c20: 2041 7272 6179 2e0a 0a20 2020 2020 2020   Array...       
-00018c30: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-00018c40: 2020 2020 2020 4120 6e65 7720 4172 7261        A new Arra
-00018c50: 7920 6f62 6a65 6374 2077 6974 6820 7468  y object with th
-00018c60: 6520 7361 6d65 2076 616c 7565 732e 0a0a  e same values...
-00018c70: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
-00018c80: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-00018c90: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
-00018ca0: 2020 203e 3e3e 2063 6f6f 7264 7320 3d20     >>> coords = 
-00018cb0: 7b27 6469 6d31 273a 205b 2761 272c 2027  {'dim1': ['a', '
-00018cc0: 6227 5d2c 2027 6469 6d32 273a 205b 312c  b'], 'dim2': [1,
-00018cd0: 2032 5d7d 0a20 2020 2020 2020 2020 2020   2]}.           
-00018ce0: 203e 3e3e 206c 6f6e 6720 3d20 4c6f 6e67   >>> long = Long
-00018cf0: 2869 6e64 6578 3d7b 2764 696d 3127 3a20  (index={'dim1': 
-00018d00: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
-00018d10: 3227 3a20 5b31 2c20 325d 7d2c 2076 616c  2': [1, 2]}, val
-00018d20: 7565 3d5b 3130 2c20 3230 5d29 0a20 2020  ue=[10, 20]).   
-00018d30: 2020 2020 2020 2020 203e 3e3e 2061 7272           >>> arr
-00018d40: 203d 2041 7272 6179 2864 6174 613d 6c6f   = Array(data=lo
-00018d50: 6e67 2c20 636f 6f72 6473 3d63 6f6f 7264  ng, coords=coord
-00018d60: 7329 0a20 2020 2020 2020 2020 2020 203e  s).            >
-00018d70: 3e3e 202b 6172 720a 2020 2020 2020 2020  >> +arr.        
-00018d80: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
-00018d90: 7272 6179 285b 5b31 302e 2c20 2030 2e5d  rray([[10.,  0.]
-00018da0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00018db0: 2020 2020 205b 2030 2e2c 2032 302e 5d5d       [ 0., 20.]]
-00018dc0: 292c 2063 6f6f 7264 733d 7b27 6469 6d31  ), coords={'dim1
-00018dd0: 273a 2061 7272 6179 285b 2761 272c 2027  ': array(['a', '
-00018de0: 6227 5d2c 2064 7479 7065 3d6f 626a 6563  b'], dtype=objec
-00018df0: 7429 2c20 2764 696d 3227 3a20 6172 7261  t), 'dim2': arra
-00018e00: 7928 5b31 2c20 325d 297d 290a 0a20 2020  y([1, 2])})..   
-00018e10: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
-00018e20: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00018e30: 2072 6574 7572 6e20 7365 6c66 2e5f 706f   return self._po
-00018e40: 7374 5f6f 7065 7261 7469 6f6e 282b 7365  st_operation(+se
-00018e50: 6c66 2e64 6174 612c 2073 656c 662e 636f  lf.data, self.co
-00018e60: 6f72 6473 290a 0a20 2020 2064 6566 205f  ords)..    def _
-00018e70: 5f65 715f 5f28 7365 6c66 2c20 6f74 6865  _eq__(self, othe
-00018e80: 723a 2055 6e69 6f6e 5b69 6e74 2c20 666c  r: Union[int, fl
-00018e90: 6f61 742c 2027 4172 7261 7927 5d29 202d  oat, 'Array']) -
-00018ea0: 3e20 2741 7272 6179 273a 0a20 2020 2020  > 'Array':.     
-00018eb0: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-00018ec0: 6865 636b 2065 7175 616c 6974 7920 6265  heck equality be
-00018ed0: 7477 6565 6e20 7468 6520 4172 7261 7920  tween the Array 
-00018ee0: 616e 6420 616e 6f74 6865 7220 4172 7261  and another Arra
-00018ef0: 7920 6f72 2061 206e 756d 6265 722e 0a0a  y or a number...
-00018f00: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00018f10: 2020 2020 2020 2020 2020 6f74 6865 723a            other:
-00018f20: 2054 6865 206f 7468 6572 2041 7272 6179   The other Array
-00018f30: 206f 7220 6e75 6d62 6572 2074 6f20 636f   or number to co
-00018f40: 6d70 6172 652e 0a0a 2020 2020 2020 2020  mpare...        
-00018f50: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-00018f60: 2020 2020 2041 206e 6577 2041 7272 6179       A new Array
-00018f70: 206f 626a 6563 7420 7769 7468 2062 6f6f   object with boo
-00018f80: 6c65 616e 2076 616c 7565 7320 696e 6469  lean values indi
-00018f90: 6361 7469 6e67 2065 7175 616c 6974 792e  cating equality.
-00018fa0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00018fb0: 653a 0a20 2020 2020 2020 2020 2020 2060  e:.            `
-00018fc0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-00018fd0: 2020 2020 203e 3e3e 2063 6f6f 7264 7331       >>> coords1
-00018fe0: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
-00018ff0: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
-00019000: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
-00019010: 2020 2020 3e3e 3e20 6c6f 6e67 3120 3d20      >>> long1 = 
-00019020: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
-00019030: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-00019040: 2764 696d 3227 3a20 5b31 2c20 325d 7d2c  'dim2': [1, 2]},
-00019050: 2076 616c 7565 3d5b 3130 2c20 3230 5d29   value=[10, 20])
-00019060: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00019070: 2061 7272 3120 3d20 4172 7261 7928 6461   arr1 = Array(da
-00019080: 7461 3d6c 6f6e 6731 2c20 636f 6f72 6473  ta=long1, coords
-00019090: 3d63 6f6f 7264 7331 290a 2020 2020 2020  =coords1).      
-000190a0: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
-000190b0: 3220 3d20 7b27 6469 6d31 273a 205b 2761  2 = {'dim1': ['a
-000190c0: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
-000190d0: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
-000190e0: 2020 2020 203e 3e3e 206c 6f6e 6732 203d       >>> long2 =
-000190f0: 204c 6f6e 6728 696e 6465 783d 7b27 6469   Long(index={'di
-00019100: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
-00019110: 2027 6469 6d32 273a 205b 322c 2031 5d7d   'dim2': [2, 1]}
-00019120: 2c20 7661 6c75 653d 5b32 302c 2031 305d  , value=[20, 10]
-00019130: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-00019140: 3e20 6172 7232 203d 2041 7272 6179 2864  > arr2 = Array(d
-00019150: 6174 613d 6c6f 6e67 322c 2063 6f6f 7264  ata=long2, coord
-00019160: 733d 636f 6f72 6473 3229 0a20 2020 2020  s=coords2).     
-00019170: 2020 2020 2020 203e 3e3e 2061 7272 3120         >>> arr1 
-00019180: 3d3d 2061 7272 320a 2020 2020 2020 2020  == arr2.        
-00019190: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
-000191a0: 7272 6179 285b 5b46 616c 7365 2c20 4661  rray([[False, Fa
-000191b0: 6c73 655d 2c0a 2020 2020 2020 2020 2020  lse],.          
-000191c0: 2020 2020 2020 2020 205b 4661 6c73 652c           [False,
-000191d0: 2046 616c 7365 5d5d 292c 2063 6f6f 7264   False]]), coord
-000191e0: 733d 7b27 6469 6d31 273a 2061 7272 6179  s={'dim1': array
-000191f0: 285b 2761 272c 2027 6227 5d2c 2064 7479  (['a', 'b'], dty
-00019200: 7065 3d6f 626a 6563 7429 2c20 2764 696d  pe=object), 'dim
-00019210: 3227 3a20 6172 7261 7928 5b31 2c20 325d  2': array([1, 2]
-00019220: 297d 290a 2020 2020 2020 2020 2020 2020  )}).            
-00019230: 3e3e 3e20 6172 7231 203d 3d20 3130 0a20  >>> arr1 == 10. 
-00019240: 2020 2020 2020 2020 2020 2041 7272 6179             Array
-00019250: 2864 6174 613d 6172 7261 7928 5b5b 2054  (data=array([[ T
-00019260: 7275 652c 2046 616c 7365 5d2c 0a20 2020  rue, False],.   
-00019270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019280: 5b46 616c 7365 2c20 4661 6c73 655d 5d29  [False, False]])
-00019290: 2c20 636f 6f72 6473 3d7b 2764 696d 3127  , coords={'dim1'
-000192a0: 3a20 6172 7261 7928 5b27 6127 2c20 2762  : array(['a', 'b
-000192b0: 275d 2c20 6474 7970 653d 6f62 6a65 6374  '], dtype=object
-000192c0: 292c 2027 6469 6d32 273a 2061 7272 6179  ), 'dim2': array
-000192d0: 285b 312c 2032 5d29 7d29 0a0a 2020 2020  ([1, 2])})..    
-000192e0: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-000192f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00019300: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
-00019310: 6865 722c 2028 696e 742c 2066 6c6f 6174  her, (int, float
-00019320: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00019330: 6172 7220 3d20 7365 6c66 2e64 6174 6120  arr = self.data 
-00019340: 3d3d 206f 7468 6572 0a20 2020 2020 2020  == other.       
-00019350: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00019360: 2e5f 706f 7374 5f6f 7065 7261 7469 6f6e  ._post_operation
-00019370: 2861 7272 2c20 7365 6c66 2e63 6f6f 7264  (arr, self.coord
-00019380: 7329 0a20 2020 2020 2020 2065 6c69 6620  s).        elif 
-00019390: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
-000193a0: 2c20 4172 7261 7929 3a0a 2020 2020 2020  , Array):.      
-000193b0: 2020 2020 2020 7365 6c66 5f61 7272 2c20        self_arr, 
-000193c0: 6f74 6865 725f 6172 722c 2063 6f6f 7264  other_arr, coord
-000193d0: 7320 3d20 7365 6c66 2e5f 7072 655f 6f70  s = self._pre_op
-000193e0: 6572 6174 696f 6e5f 7769 7468 5f61 7272  eration_with_arr
-000193f0: 6179 286f 7468 6572 290a 2020 2020 2020  ay(other).      
-00019400: 2020 2020 2020 6172 7220 3d20 7365 6c66        arr = self
-00019410: 5f61 7272 203d 3d20 6f74 6865 725f 6172  _arr == other_ar
-00019420: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
-00019430: 7475 726e 2073 656c 662e 5f70 6f73 745f  turn self._post_
-00019440: 6f70 6572 6174 696f 6e28 6172 722e 542c  operation(arr.T,
-00019450: 2063 6f6f 7264 7329 0a0a 2020 2020 6465   coords)..    de
-00019460: 6620 5f5f 6e65 5f5f 2873 656c 662c 206f  f __ne__(self, o
-00019470: 7468 6572 3a20 556e 696f 6e5b 696e 742c  ther: Union[int,
-00019480: 2066 6c6f 6174 2c20 2741 7272 6179 275d   float, 'Array']
-00019490: 2920 2d3e 2027 4172 7261 7927 3a0a 2020  ) -> 'Array':.  
-000194a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000194b0: 2020 4368 6563 6b20 696e 6571 7561 6c69    Check inequali
-000194c0: 7479 2062 6574 7765 656e 2074 6865 2041  ty between the A
-000194d0: 7272 6179 2061 6e64 2061 6e6f 7468 6572  rray and another
-000194e0: 2041 7272 6179 206f 7220 6120 6e75 6d62   Array or a numb
-000194f0: 6572 2e0a 0a20 2020 2020 2020 2041 7267  er...        Arg
-00019500: 733a 0a20 2020 2020 2020 2020 2020 206f  s:.            o
-00019510: 7468 6572 3a20 5468 6520 6f74 6865 7220  ther: The other 
-00019520: 4172 7261 7920 6f72 206e 756d 6265 7220  Array or number 
-00019530: 746f 2063 6f6d 7061 7265 2e0a 0a20 2020  to compare...   
-00019540: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
-00019550: 2020 2020 2020 2020 2020 4120 6e65 7720            A new 
-00019560: 4172 7261 7920 6f62 6a65 6374 2077 6974  Array object wit
-00019570: 6820 626f 6f6c 6561 6e20 7661 6c75 6573  h boolean values
-00019580: 2069 6e64 6963 6174 696e 6720 696e 6571   indicating ineq
-00019590: 7561 6c69 7479 2e0a 0a20 2020 2020 2020  uality...       
-000195a0: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
-000195b0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
-000195c0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-000195d0: 636f 6f72 6473 3120 3d20 7b27 6469 6d31  coords1 = {'dim1
-000195e0: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
-000195f0: 6469 6d32 273a 205b 312c 2032 5d7d 0a20  dim2': [1, 2]}. 
-00019600: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
-00019610: 6174 6131 203d 2028 7b27 6469 6d31 273a  ata1 = ({'dim1':
-00019620: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
-00019630: 6d32 273a 205b 312c 2032 5d7d 2c20 5b31  m2': [1, 2]}, [1
-00019640: 302c 2032 305d 290a 2020 2020 2020 2020  0, 20]).        
-00019650: 2020 2020 3e3e 3e20 6172 7231 203d 2041      >>> arr1 = A
-00019660: 7272 6179 2864 6174 613d 6461 7461 312c  rray(data=data1,
-00019670: 2063 6f6f 7264 733d 636f 6f72 6473 3129   coords=coords1)
-00019680: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00019690: 2063 6f6f 7264 7332 203d 207b 2764 696d   coords2 = {'dim
-000196a0: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-000196b0: 2764 696d 3227 3a20 5b31 2c20 325d 7d0a  'dim2': [1, 2]}.
-000196c0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-000196d0: 6461 7461 3220 3d20 287b 2764 696d 3127  data2 = ({'dim1'
-000196e0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
-000196f0: 696d 3227 3a20 5b32 2c20 315d 7d2c 205b  im2': [2, 1]}, [
-00019700: 3230 2c20 3130 5d29 0a20 2020 2020 2020  20, 10]).       
-00019710: 2020 2020 203e 3e3e 2061 7272 3220 3d20       >>> arr2 = 
-00019720: 4172 7261 7928 6461 7461 3d64 6174 6132  Array(data=data2
-00019730: 2c20 636f 6f72 6473 3d63 6f6f 7264 7332  , coords=coords2
-00019740: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-00019750: 3e20 6172 7231 2021 3d20 6172 7232 0a20  > arr1 != arr2. 
-00019760: 2020 2020 2020 2020 2020 2041 7272 6179             Array
-00019770: 2864 6174 613d 6172 7261 7928 5b5b 2054  (data=array([[ T
-00019780: 7275 652c 2020 5472 7565 5d2c 0a20 2020  rue,  True],.   
-00019790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000197a0: 5b20 5472 7565 2c20 2054 7275 655d 5d29  [ True,  True]])
-000197b0: 2c20 636f 6f72 6473 3d7b 2764 696d 3127  , coords={'dim1'
-000197c0: 3a20 6172 7261 7928 5b27 6127 2c20 2762  : array(['a', 'b
-000197d0: 275d 2c20 6474 7970 653d 6f62 6a65 6374  '], dtype=object
-000197e0: 292c 2027 6469 6d32 273a 2061 7272 6179  ), 'dim2': array
-000197f0: 285b 312c 2032 5d29 7d29 0a20 2020 2020  ([1, 2])}).     
-00019800: 2020 2020 2020 203e 3e3e 2061 7272 3120         >>> arr1 
-00019810: 213d 2031 300a 2020 2020 2020 2020 2020  != 10.          
-00019820: 2020 4172 7261 7928 6461 7461 3d61 7272    Array(data=arr
-00019830: 6179 285b 5b46 616c 7365 2c20 2054 7275  ay([[False,  Tru
-00019840: 655d 2c0a 2020 2020 2020 2020 2020 2020  e],.            
-00019850: 2020 2020 2020 205b 2054 7275 652c 2020         [ True,  
-00019860: 5472 7565 5d5d 292c 2063 6f6f 7264 733d  True]]), coords=
-00019870: 7b27 6469 6d31 273a 2061 7272 6179 285b  {'dim1': array([
-00019880: 2761 272c 2027 6227 5d2c 2064 7479 7065  'a', 'b'], dtype
-00019890: 3d6f 626a 6563 7429 2c20 2764 696d 3227  =object), 'dim2'
-000198a0: 3a20 6172 7261 7928 5b31 2c20 325d 297d  : array([1, 2])}
-000198b0: 290a 0a20 2020 2020 2020 2020 2020 2060  )..            `
-000198c0: 6060 0a20 2020 2020 2020 2022 2222 0a20  ``.        """. 
-000198d0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000198e0: 616e 6365 286f 7468 6572 2c20 2869 6e74  ance(other, (int
-000198f0: 2c20 666c 6f61 7429 293a 0a20 2020 2020  , float)):.     
-00019900: 2020 2020 2020 2061 7272 203d 2073 656c         arr = sel
-00019910: 662e 6461 7461 2021 3d20 6f74 6865 720a  f.data != other.
-00019920: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00019930: 726e 2073 656c 662e 5f70 6f73 745f 6f70  rn self._post_op
-00019940: 6572 6174 696f 6e28 6172 722c 2073 656c  eration(arr, sel
-00019950: 662e 636f 6f72 6473 290a 2020 2020 2020  f.coords).      
-00019960: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-00019970: 6528 6f74 6865 722c 2041 7272 6179 293a  e(other, Array):
-00019980: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00019990: 665f 6172 722c 206f 7468 6572 5f61 7272  f_arr, other_arr
-000199a0: 2c20 636f 6f72 6473 203d 2073 656c 662e  , coords = self.
-000199b0: 5f70 7265 5f6f 7065 7261 7469 6f6e 5f77  _pre_operation_w
-000199c0: 6974 685f 6172 7261 7928 6f74 6865 7229  ith_array(other)
-000199d0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-000199e0: 203d 2073 656c 665f 6172 7220 213d 206f   = self_arr != o
-000199f0: 7468 6572 5f61 7272 0a20 2020 2020 2020  ther_arr.       
-00019a00: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00019a10: 2e5f 706f 7374 5f6f 7065 7261 7469 6f6e  ._post_operation
-00019a20: 2861 7272 2e54 2c20 636f 6f72 6473 290a  (arr.T, coords).
-00019a30: 0a20 2020 2064 6566 205f 5f6c 745f 5f28  .    def __lt__(
-00019a40: 7365 6c66 2c20 6f74 6865 723a 2055 6e69  self, other: Uni
-00019a50: 6f6e 5b69 6e74 2c20 666c 6f61 742c 2027  on[int, float, '
-00019a60: 4172 7261 7927 5d29 202d 3e20 2741 7272  Array']) -> 'Arr
-00019a70: 6179 273a 0a20 2020 2020 2020 2022 2222  ay':.        """
-00019a80: 0a20 2020 2020 2020 2043 6865 636b 2069  .        Check i
-00019a90: 6620 7468 6520 4172 7261 7920 6973 206c  f the Array is l
-00019aa0: 6573 7320 7468 616e 2061 6e6f 7468 6572  ess than another
-00019ab0: 2041 7272 6179 206f 7220 6120 6e75 6d62   Array or a numb
-00019ac0: 6572 2e0a 0a20 2020 2020 2020 2041 7267  er...        Arg
-00019ad0: 733a 0a20 2020 2020 2020 2020 2020 206f  s:.            o
-00019ae0: 7468 6572 3a20 5468 6520 6f74 6865 7220  ther: The other 
-00019af0: 4172 7261 7920 6f72 206e 756d 6265 7220  Array or number 
-00019b00: 746f 2063 6f6d 7061 7265 2e0a 0a20 2020  to compare...   
-00019b10: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
-00019b20: 2020 2020 2020 2020 2020 4120 6e65 7720            A new 
-00019b30: 4172 7261 7920 6f62 6a65 6374 2077 6974  Array object wit
-00019b40: 6820 626f 6f6c 6561 6e20 7661 6c75 6573  h boolean values
-00019b50: 2069 6e64 6963 6174 696e 6720 6c65 7373   indicating less
-00019b60: 2074 6861 6e2e 0a0a 2020 2020 2020 2020   than...        
-00019b70: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
-00019b80: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
-00019b90: 2020 2020 2020 2020 2020 203e 3e3e 2063             >>> c
-00019ba0: 6f6f 7264 7331 203d 207b 2764 696d 3127  oords1 = {'dim1'
-00019bb0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
-00019bc0: 696d 3227 3a20 5b31 2c20 325d 7d0a 2020  im2': [1, 2]}.  
-00019bd0: 2020 2020 2020 2020 2020 3e3e 3e20 6461            >>> da
-00019be0: 7461 3120 3d20 287b 2764 696d 3127 3a20  ta1 = ({'dim1': 
-00019bf0: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
-00019c00: 3227 3a20 5b31 2c20 325d 7d2c 205b 3130  2': [1, 2]}, [10
-00019c10: 2c20 3230 5d29 0a20 2020 2020 2020 2020  , 20]).         
-00019c20: 2020 203e 3e3e 2061 7272 3120 3d20 4172     >>> arr1 = Ar
-00019c30: 7261 7928 6461 7461 3d64 6174 6131 2c20  ray(data=data1, 
-00019c40: 636f 6f72 6473 3d63 6f6f 7264 7331 290a  coords=coords1).
-00019c50: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00019c60: 636f 6f72 6473 3220 3d20 7b27 6469 6d31  coords2 = {'dim1
-00019c70: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
-00019c80: 6469 6d32 273a 205b 312c 2032 5d7d 0a20  dim2': [1, 2]}. 
-00019c90: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
-00019ca0: 6174 6132 203d 2028 7b27 6469 6d31 273a  ata2 = ({'dim1':
-00019cb0: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
-00019cc0: 6d32 273a 205b 322c 2031 5d7d 2c20 5b32  m2': [2, 1]}, [2
-00019cd0: 302c 2031 305d 290a 2020 2020 2020 2020  0, 10]).        
-00019ce0: 2020 2020 3e3e 3e20 6172 7232 203d 2041      >>> arr2 = A
-00019cf0: 7272 6179 2864 6174 613d 6461 7461 322c  rray(data=data2,
-00019d00: 2063 6f6f 7264 733d 636f 6f72 6473 3229   coords=coords2)
-00019d10: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00019d20: 2061 7272 3120 3c20 6172 7232 0a20 2020   arr1 < arr2.   
-00019d30: 2020 2020 2020 2020 2041 7272 6179 2864           Array(d
-00019d40: 6174 613d 6172 7261 7928 5b5b 4661 6c73  ata=array([[Fals
-00019d50: 652c 2020 5472 7565 5d2c 0a20 2020 2020  e,  True],.     
-00019d60: 2020 2020 2020 2020 2020 2020 2020 5b20                [ 
-00019d70: 5472 7565 2c20 4661 6c73 655d 5d29 2c20  True, False]]), 
-00019d80: 636f 6f72 6473 3d7b 2764 696d 3127 3a20  coords={'dim1': 
-00019d90: 6172 7261 7928 5b27 6127 2c20 2762 275d  array(['a', 'b']
-00019da0: 2c20 6474 7970 653d 6f62 6a65 6374 292c  , dtype=object),
-00019db0: 2027 6469 6d32 273a 2061 7272 6179 285b   'dim2': array([
-00019dc0: 312c 2032 5d29 7d29 0a20 2020 2020 2020  1, 2])}).       
-00019dd0: 2020 2020 203e 3e3e 2061 7272 3120 3c20       >>> arr1 < 
-00019de0: 3135 0a20 2020 2020 2020 2020 2020 2041  15.            A
-00019df0: 7272 6179 2864 6174 613d 6172 7261 7928  rray(data=array(
-00019e00: 5b5b 2054 7275 652c 2020 5472 7565 5d2c  [[ True,  True],
-00019e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019e20: 2020 2020 5b20 5472 7565 2c20 4661 6c73      [ True, Fals
-00019e30: 655d 5d29 2c20 636f 6f72 6473 3d7b 2764  e]]), coords={'d
-00019e40: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
-00019e50: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
-00019e60: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
-00019e70: 7272 6179 285b 312c 2032 5d29 7d29 0a0a  rray([1, 2])})..
-00019e80: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-00019e90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00019ea0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00019eb0: 6528 6f74 6865 722c 2028 696e 742c 2066  e(other, (int, f
-00019ec0: 6c6f 6174 2929 3a0a 2020 2020 2020 2020  loat)):.        
-00019ed0: 2020 2020 6172 7220 3d20 7365 6c66 2e64      arr = self.d
-00019ee0: 6174 6120 3c20 6f74 6865 720a 2020 2020  ata < other.    
-00019ef0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00019f00: 656c 662e 5f70 6f73 745f 6f70 6572 6174  elf._post_operat
-00019f10: 696f 6e28 6172 722c 2073 656c 662e 636f  ion(arr, self.co
-00019f20: 6f72 6473 290a 2020 2020 2020 2020 656c  ords).        el
-00019f30: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
-00019f40: 6865 722c 2041 7272 6179 293a 0a20 2020  her, Array):.   
-00019f50: 2020 2020 2020 2020 2073 656c 665f 6172           self_ar
-00019f60: 722c 206f 7468 6572 5f61 7272 2c20 636f  r, other_arr, co
-00019f70: 6f72 6473 203d 2073 656c 662e 5f70 7265  ords = self._pre
-00019f80: 5f6f 7065 7261 7469 6f6e 5f77 6974 685f  _operation_with_
-00019f90: 6172 7261 7928 6f74 6865 7229 0a20 2020  array(other).   
-00019fa0: 2020 2020 2020 2020 2061 7272 203d 2073           arr = s
-00019fb0: 656c 665f 6172 7220 3c20 6f74 6865 725f  elf_arr < other_
-00019fc0: 6172 720a 2020 2020 2020 2020 2020 2020  arr.            
-00019fd0: 7265 7475 726e 2073 656c 662e 5f70 6f73  return self._pos
-00019fe0: 745f 6f70 6572 6174 696f 6e28 6172 722e  t_operation(arr.
-00019ff0: 542c 2063 6f6f 7264 7329 0a0a 2020 2020  T, coords)..    
-0001a000: 6465 6620 5f5f 726c 745f 5f28 7365 6c66  def __rlt__(self
-0001a010: 2c20 6f74 6865 723a 2055 6e69 6f6e 5b69  , other: Union[i
-0001a020: 6e74 2c20 666c 6f61 745d 2920 2d3e 2027  nt, float]) -> '
-0001a030: 4172 7261 7927 3a0a 2020 2020 2020 2020  Array':.        
-0001a040: 2222 220a 2020 2020 2020 2020 4368 6563  """.        Chec
-0001a050: 6b20 6966 2061 206e 756d 6265 7220 6973  k if a number is
-0001a060: 206c 6573 7320 7468 616e 2074 6865 2041   less than the A
-0001a070: 7272 6179 2028 7265 7665 7273 6520 6c65  rray (reverse le
-0001a080: 7373 2074 6861 6e29 2e0a 0a20 2020 2020  ss than)...     
-0001a090: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0001a0a0: 2020 2020 206f 7468 6572 3a20 5468 6520       other: The 
-0001a0b0: 6e75 6d62 6572 2074 6f20 636f 6d70 6172  number to compar
-0001a0c0: 652e 0a0a 2020 2020 2020 2020 5265 7475  e...        Retu
-0001a0d0: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
-0001a0e0: 2041 206e 6577 2041 7272 6179 206f 626a   A new Array obj
-0001a0f0: 6563 7420 7769 7468 2062 6f6f 6c65 616e  ect with boolean
-0001a100: 2076 616c 7565 7320 696e 6469 6361 7469   values indicati
-0001a110: 6e67 206c 6573 7320 7468 616e 2e0a 0a20  ng less than... 
-0001a120: 2020 2020 2020 2045 7861 6d70 6c65 3a0a         Example:.
-0001a130: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
-0001a140: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
-0001a150: 2020 3e3e 3e20 636f 6f72 6473 203d 207b    >>> coords = {
-0001a160: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
-0001a170: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
-0001a180: 325d 7d0a 2020 2020 2020 2020 2020 2020  2]}.            
-0001a190: 3e3e 3e20 6461 7461 203d 2028 7b27 6469  >>> data = ({'di
-0001a1a0: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
-0001a1b0: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
-0001a1c0: 2c20 5b31 302c 2032 305d 290a 2020 2020  , [10, 20]).    
-0001a1d0: 2020 2020 2020 2020 3e3e 3e20 6172 7220          >>> arr 
-0001a1e0: 3d20 4172 7261 7928 6461 7461 3d64 6174  = Array(data=dat
-0001a1f0: 612c 2063 6f6f 7264 733d 636f 6f72 6473  a, coords=coords
-0001a200: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-0001a210: 3e20 3520 3c20 6172 720a 2020 2020 2020  > 5 < arr.      
-0001a220: 2020 2020 2020 4172 7261 7928 6461 7461        Array(data
-0001a230: 3d61 7272 6179 285b 5b20 5472 7565 2c20  =array([[ True, 
-0001a240: 4661 6c73 655d 2c0a 2020 2020 2020 2020  False],.        
-0001a250: 2020 2020 2020 2020 2020 205b 4661 6c73             [Fals
-0001a260: 652c 2020 5472 7565 5d5d 292c 2063 6f6f  e,  True]]), coo
-0001a270: 7264 733d 7b27 6469 6d31 273a 2061 7272  rds={'dim1': arr
-0001a280: 6179 285b 2761 272c 2027 6227 5d2c 2064  ay(['a', 'b'], d
-0001a290: 7479 7065 3d6f 626a 6563 7429 2c20 2764  type=object), 'd
-0001a2a0: 696d 3227 3a20 6172 7261 7928 5b31 2c20  im2': array([1, 
-0001a2b0: 325d 297d 290a 0a20 2020 2020 2020 2020  2])})..         
-0001a2c0: 2020 2060 6060 0a20 2020 2020 2020 2022     ```.        "
-0001a2d0: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
-0001a2e0: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
-0001a2f0: 2869 6e74 2c20 666c 6f61 7429 293a 0a20  (int, float)):. 
-0001a300: 2020 2020 2020 2020 2020 2061 7272 203d             arr =
-0001a310: 206f 7468 6572 203c 2073 656c 662e 6461   other < self.da
-0001a320: 7461 0a20 2020 2020 2020 2020 2020 2072  ta.            r
-0001a330: 6574 7572 6e20 7365 6c66 2e5f 706f 7374  eturn self._post
-0001a340: 5f6f 7065 7261 7469 6f6e 2861 7272 2c20  _operation(arr, 
-0001a350: 7365 6c66 2e63 6f6f 7264 7329 0a0a 2020  self.coords)..  
-0001a360: 2020 6465 6620 5f5f 6c65 5f5f 2873 656c    def __le__(sel
-0001a370: 662c 206f 7468 6572 3a20 556e 696f 6e5b  f, other: Union[
-0001a380: 696e 742c 2066 6c6f 6174 2c20 2741 7272  int, float, 'Arr
-0001a390: 6179 275d 2920 2d3e 2027 4172 7261 7927  ay']) -> 'Array'
-0001a3a0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0001a3b0: 2020 2020 2020 4368 6563 6b20 6966 2074        Check if t
-0001a3c0: 6865 2041 7272 6179 2069 7320 6c65 7373  he Array is less
-0001a3d0: 2074 6861 6e20 6f72 2065 7175 616c 2074   than or equal t
-0001a3e0: 6f20 616e 6f74 6865 7220 4172 7261 7920  o another Array 
-0001a3f0: 6f72 2061 206e 756d 6265 722e 0a0a 2020  or a number...  
-0001a400: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
-0001a410: 2020 2020 2020 2020 6f74 6865 723a 2054          other: T
-0001a420: 6865 206f 7468 6572 2041 7272 6179 206f  he other Array o
-0001a430: 7220 6e75 6d62 6572 2074 6f20 636f 6d70  r number to comp
-0001a440: 6172 652e 0a0a 2020 2020 2020 2020 5265  are...        Re
-0001a450: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
-0001a460: 2020 2041 206e 6577 2041 7272 6179 206f     A new Array o
-0001a470: 626a 6563 7420 7769 7468 2062 6f6f 6c65  bject with boole
-0001a480: 616e 2076 616c 7565 7320 696e 6469 6361  an values indica
-0001a490: 7469 6e67 206c 6573 7320 7468 616e 206f  ting less than o
-0001a4a0: 7220 6571 7561 6c20 746f 2e0a 0a20 2020  r equal to...   
-0001a4b0: 2020 2020 2045 7861 6d70 6c65 3a0a 2020       Example:.  
-0001a4c0: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
-0001a4d0: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
-0001a4e0: 3e3e 3e20 636f 6f72 6473 3120 3d20 7b27  >>> coords1 = {'
-0001a4f0: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
-0001a500: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
-0001a510: 5d7d 0a20 2020 2020 2020 2020 2020 203e  ]}.            >
-0001a520: 3e3e 2064 6174 6131 203d 2028 7b27 6469  >> data1 = ({'di
-0001a530: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
-0001a540: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
-0001a550: 2c20 5b31 302c 2032 305d 290a 2020 2020  , [10, 20]).    
-0001a560: 2020 2020 2020 2020 3e3e 3e20 6172 7231          >>> arr1
-0001a570: 203d 2041 7272 6179 2864 6174 613d 6461   = Array(data=da
-0001a580: 7461 312c 2063 6f6f 7264 733d 636f 6f72  ta1, coords=coor
-0001a590: 6473 3129 0a20 2020 2020 2020 2020 2020  ds1).           
-0001a5a0: 203e 3e3e 2063 6f6f 7264 7332 203d 207b   >>> coords2 = {
-0001a5b0: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
-0001a5c0: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
-0001a5d0: 325d 7d0a 2020 2020 2020 2020 2020 2020  2]}.            
-0001a5e0: 3e3e 3e20 6c6f 6e67 3220 3d20 4c6f 6e67  >>> long2 = Long
-0001a5f0: 2869 6e64 6578 3d7b 2764 696d 3127 3a20  (index={'dim1': 
-0001a600: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
-0001a610: 3227 3a20 5b32 2c20 315d 7d2c 2076 616c  2': [2, 1]}, val
-0001a620: 7565 3d5b 3230 2c20 3130 5d29 0a20 2020  ue=[20, 10]).   
-0001a630: 2020 2020 2020 2020 203e 3e3e 2061 7272           >>> arr
-0001a640: 3220 3d20 4172 7261 7928 6461 7461 3d6c  2 = Array(data=l
-0001a650: 6f6e 6732 2c20 636f 6f72 6473 3d63 6f6f  ong2, coords=coo
-0001a660: 7264 7332 290a 2020 2020 2020 2020 2020  rds2).          
-0001a670: 2020 3e3e 3e20 6172 7231 203c 3d20 6172    >>> arr1 <= ar
-0001a680: 7232 0a20 2020 2020 2020 2020 2020 2041  r2.            A
-0001a690: 7272 6179 2864 6174 613d 6172 7261 7928  rray(data=array(
-0001a6a0: 5b5b 4661 6c73 652c 2020 5472 7565 5d2c  [[False,  True],
-0001a6b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a6c0: 2020 2020 5b20 5472 7565 2c20 4661 6c73      [ True, Fals
-0001a6d0: 655d 5d29 2c20 636f 6f72 6473 3d7b 2764  e]]), coords={'d
-0001a6e0: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
-0001a6f0: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
-0001a700: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
-0001a710: 7272 6179 285b 312c 2032 5d29 7d29 0a20  rray([1, 2])}). 
-0001a720: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
-0001a730: 7272 3120 3c3d 2031 300a 2020 2020 2020  rr1 <= 10.      
-0001a740: 2020 2020 2020 4172 7261 7928 6461 7461        Array(data
-0001a750: 3d61 7272 6179 285b 5b20 5472 7565 2c20  =array([[ True, 
-0001a760: 2054 7275 655d 2c0a 2020 2020 2020 2020   True],.        
-0001a770: 2020 2020 2020 2020 2020 205b 2054 7275             [ Tru
-0001a780: 652c 2046 616c 7365 5d5d 292c 2063 6f6f  e, False]]), coo
-0001a790: 7264 733d 7b27 6469 6d31 273a 2061 7272  rds={'dim1': arr
-0001a7a0: 6179 285b 2761 272c 2027 6227 5d2c 2064  ay(['a', 'b'], d
-0001a7b0: 7479 7065 3d6f 626a 6563 7429 2c20 2764  type=object), 'd
-0001a7c0: 696d 3227 3a20 6172 7261 7928 5b31 2c20  im2': array([1, 
-0001a7d0: 325d 297d 290a 0a20 2020 2020 2020 2020  2])})..         
-0001a7e0: 2020 2060 6060 0a20 2020 2020 2020 2022     ```.        "
-0001a7f0: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
-0001a800: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
-0001a810: 2869 6e74 2c20 666c 6f61 7429 293a 0a20  (int, float)):. 
-0001a820: 2020 2020 2020 2020 2020 2061 7272 203d             arr =
-0001a830: 2073 656c 662e 6461 7461 203c 3d20 6f74   self.data <= ot
-0001a840: 6865 720a 2020 2020 2020 2020 2020 2020  her.            
-0001a850: 7265 7475 726e 2073 656c 662e 5f70 6f73  return self._pos
-0001a860: 745f 6f70 6572 6174 696f 6e28 6172 722c  t_operation(arr,
-0001a870: 2073 656c 662e 636f 6f72 6473 290a 2020   self.coords).  
-0001a880: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-0001a890: 7461 6e63 6528 6f74 6865 722c 2041 7272  tance(other, Arr
-0001a8a0: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
-0001a8b0: 2073 656c 665f 6172 722c 206f 7468 6572   self_arr, other
-0001a8c0: 5f61 7272 2c20 636f 6f72 6473 203d 2073  _arr, coords = s
-0001a8d0: 656c 662e 5f70 7265 5f6f 7065 7261 7469  elf._pre_operati
-0001a8e0: 6f6e 5f77 6974 685f 6172 7261 7928 6f74  on_with_array(ot
-0001a8f0: 6865 7229 0a20 2020 2020 2020 2020 2020  her).           
-0001a900: 2061 7272 203d 2073 656c 665f 6172 7220   arr = self_arr 
-0001a910: 3c3d 206f 7468 6572 5f61 7272 0a20 2020  <= other_arr.   
-0001a920: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001a930: 7365 6c66 2e5f 706f 7374 5f6f 7065 7261  self._post_opera
-0001a940: 7469 6f6e 2861 7272 2e54 2c20 636f 6f72  tion(arr.T, coor
-0001a950: 6473 290a 0a20 2020 2064 6566 205f 5f72  ds)..    def __r
-0001a960: 6c65 5f5f 2873 656c 662c 206f 7468 6572  le__(self, other
-0001a970: 3a20 556e 696f 6e5b 696e 742c 2066 6c6f  : Union[int, flo
-0001a980: 6174 5d29 202d 3e20 2741 7272 6179 273a  at]) -> 'Array':
-0001a990: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001a9a0: 2020 2020 2043 6865 636b 2069 6620 6120       Check if a 
-0001a9b0: 6e75 6d62 6572 2069 7320 6c65 7373 2074  number is less t
-0001a9c0: 6861 6e20 6f72 2065 7175 616c 2074 6f20  han or equal to 
-0001a9d0: 7468 6520 4172 7261 7920 2872 6576 6572  the Array (rever
-0001a9e0: 7365 206c 6573 7320 7468 616e 206f 7220  se less than or 
-0001a9f0: 6571 7561 6c20 746f 292e 0a0a 2020 2020  equal to)...    
-0001aa00: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0001aa10: 2020 2020 2020 6f74 6865 723a 2054 6865        other: The
-0001aa20: 206e 756d 6265 7220 746f 2063 6f6d 7061   number to compa
-0001aa30: 7265 2e0a 0a20 2020 2020 2020 2052 6574  re...        Ret
-0001aa40: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-0001aa50: 2020 4120 6e65 7720 4172 7261 7920 6f62    A new Array ob
-0001aa60: 6a65 6374 2077 6974 6820 626f 6f6c 6561  ject with boolea
-0001aa70: 6e20 7661 6c75 6573 2069 6e64 6963 6174  n values indicat
-0001aa80: 696e 6720 6c65 7373 2074 6861 6e20 6f72  ing less than or
-0001aa90: 2065 7175 616c 2074 6f2e 0a0a 2020 2020   equal to...    
-0001aaa0: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
-0001aab0: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-0001aac0: 6f6e 0a20 2020 2020 2020 2020 2020 203e  on.            >
-0001aad0: 3e3e 2063 6f6f 7264 7320 3d20 7b27 6469  >> coords = {'di
-0001aae0: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
-0001aaf0: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
-0001ab00: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-0001ab10: 2064 6174 6120 3d20 287b 2764 696d 3127   data = ({'dim1'
-0001ab20: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
-0001ab30: 696d 3227 3a20 5b31 2c20 325d 7d2c 205b  im2': [1, 2]}, [
-0001ab40: 3130 2c20 3230 5d29 0a20 2020 2020 2020  10, 20]).       
-0001ab50: 2020 2020 203e 3e3e 2061 7272 203d 2041       >>> arr = A
-0001ab60: 7272 6179 2864 6174 613d 6461 7461 2c20  rray(data=data, 
-0001ab70: 636f 6f72 6473 3d63 6f6f 7264 7329 0a20  coords=coords). 
-0001ab80: 2020 2020 2020 2020 2020 203e 3e3e 2031             >>> 1
-0001ab90: 3020 3c3d 2061 7272 0a20 2020 2020 2020  0 <= arr.       
-0001aba0: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
-0001abb0: 6172 7261 7928 5b5b 2054 7275 652c 2046  array([[ True, F
-0001abc0: 616c 7365 5d2c 0a20 2020 2020 2020 2020  alse],.         
-0001abd0: 2020 2020 2020 2020 2020 5b46 616c 7365            [False
-0001abe0: 2c20 2054 7275 655d 5d29 2c20 636f 6f72  ,  True]]), coor
-0001abf0: 6473 3d7b 2764 696d 3127 3a20 6172 7261  ds={'dim1': arra
-0001ac00: 7928 5b27 6127 2c20 2762 275d 2c20 6474  y(['a', 'b'], dt
-0001ac10: 7970 653d 6f62 6a65 6374 292c 2027 6469  ype=object), 'di
-0001ac20: 6d32 273a 2061 7272 6179 285b 312c 2032  m2': array([1, 2
-0001ac30: 5d29 7d29 0a0a 2020 2020 2020 2020 2020  ])})..          
-0001ac40: 2020 6060 600a 2020 2020 2020 2020 2222    ```.        ""
-0001ac50: 220a 2020 2020 2020 2020 6966 2069 7369  ".        if isi
-0001ac60: 6e73 7461 6e63 6528 6f74 6865 722c 2028  nstance(other, (
-0001ac70: 696e 742c 2066 6c6f 6174 2929 3a0a 2020  int, float)):.  
-0001ac80: 2020 2020 2020 2020 2020 6172 7220 3d20            arr = 
-0001ac90: 6f74 6865 7220 3c3d 2073 656c 662e 6461  other <= self.da
-0001aca0: 7461 0a20 2020 2020 2020 2020 2020 2072  ta.            r
-0001acb0: 6574 7572 6e20 7365 6c66 2e5f 706f 7374  eturn self._post
-0001acc0: 5f6f 7065 7261 7469 6f6e 2861 7272 2c20  _operation(arr, 
-0001acd0: 7365 6c66 2e63 6f6f 7264 7329 0a0a 2020  self.coords)..  
-0001ace0: 2020 6465 6620 5f5f 6774 5f5f 2873 656c    def __gt__(sel
-0001acf0: 662c 206f 7468 6572 3a20 556e 696f 6e5b  f, other: Union[
-0001ad00: 696e 742c 2066 6c6f 6174 2c20 2741 7272  int, float, 'Arr
-0001ad10: 6179 275d 2920 2d3e 2027 4172 7261 7927  ay']) -> 'Array'
-0001ad20: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0001ad30: 2020 2020 2020 4368 6563 6b20 6966 2074        Check if t
-0001ad40: 6865 2041 7272 6179 2069 7320 6772 6561  he Array is grea
-0001ad50: 7465 7220 7468 616e 2061 6e6f 7468 6572  ter than another
-0001ad60: 2041 7272 6179 206f 7220 6120 6e75 6d62   Array or a numb
-0001ad70: 6572 2e0a 0a20 2020 2020 2020 2041 7267  er...        Arg
-0001ad80: 733a 0a20 2020 2020 2020 2020 2020 206f  s:.            o
-0001ad90: 7468 6572 3a20 5468 6520 6f74 6865 7220  ther: The other 
-0001ada0: 4172 7261 7920 6f72 206e 756d 6265 7220  Array or number 
-0001adb0: 746f 2063 6f6d 7061 7265 2e0a 0a20 2020  to compare...   
-0001adc0: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
-0001add0: 2020 2020 2020 2020 2020 4120 6e65 7720            A new 
-0001ade0: 4172 7261 7920 6f62 6a65 6374 2077 6974  Array object wit
-0001adf0: 6820 626f 6f6c 6561 6e20 7661 6c75 6573  h boolean values
-0001ae00: 2069 6e64 6963 6174 696e 6720 6772 6561   indicating grea
-0001ae10: 7465 7220 7468 616e 2e0a 0a20 2020 2020  ter than...     
-0001ae20: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-0001ae30: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-0001ae40: 6e0a 2020 2020 2020 2020 2020 2020 3e3e  n.            >>
-0001ae50: 3e20 636f 6f72 6473 3120 3d20 7b27 6469  > coords1 = {'di
-0001ae60: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
-0001ae70: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
-0001ae80: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-0001ae90: 206c 6f6e 6731 203d 204c 6f6e 6728 696e   long1 = Long(in
-0001aea0: 6465 783d 7b27 6469 6d31 273a 205b 2761  dex={'dim1': ['a
-0001aeb0: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
-0001aec0: 205b 312c 2032 5d7d 2c20 7661 6c75 653d   [1, 2]}, value=
-0001aed0: 5b31 302c 2032 305d 290a 2020 2020 2020  [10, 20]).      
-0001aee0: 2020 2020 2020 3e3e 3e20 6172 7231 203d        >>> arr1 =
-0001aef0: 2041 7272 6179 2864 6174 613d 6c6f 6e67   Array(data=long
-0001af00: 312c 2063 6f6f 7264 733d 636f 6f72 6473  1, coords=coords
-0001af10: 3129 0a20 2020 2020 2020 2020 2020 203e  1).            >
-0001af20: 3e3e 2063 6f6f 7264 7332 203d 207b 2764  >> coords2 = {'d
-0001af30: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
-0001af40: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
-0001af50: 7d0a 2020 2020 2020 2020 2020 2020 3e3e  }.            >>
-0001af60: 3e20 6461 7461 3220 3d20 287b 2764 696d  > data2 = ({'dim
-0001af70: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-0001af80: 2764 696d 3227 3a20 5b31 2c20 325d 7d2c  'dim2': [1, 2]},
-0001af90: 205b 3230 2c20 3130 5d29 0a20 2020 2020   [20, 10]).     
-0001afa0: 2020 2020 2020 203e 3e3e 2061 7272 3220         >>> arr2 
-0001afb0: 3d20 4172 7261 7928 6461 7461 3d64 6174  = Array(data=dat
-0001afc0: 6132 2c20 636f 6f72 6473 3d63 6f6f 7264  a2, coords=coord
-0001afd0: 7332 290a 2020 2020 2020 2020 2020 2020  s2).            
-0001afe0: 3e3e 3e20 6172 7231 203e 2061 7272 320a  >>> arr1 > arr2.
-0001aff0: 2020 2020 2020 2020 2020 2020 4172 7261              Arra
-0001b000: 7928 6461 7461 3d61 7272 6179 285b 5b46  y(data=array([[F
-0001b010: 616c 7365 2c20 4661 6c73 655d 2c0a 2020  alse, False],.  
-0001b020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b030: 205b 4661 6c73 652c 2020 5472 7565 5d5d   [False,  True]]
-0001b040: 292c 2063 6f6f 7264 733d 7b27 6469 6d31  ), coords={'dim1
-0001b050: 273a 2061 7272 6179 285b 2761 272c 2027  ': array(['a', '
-0001b060: 6227 5d2c 2064 7479 7065 3d6f 626a 6563  b'], dtype=objec
-0001b070: 7429 2c20 2764 696d 3227 3a20 6172 7261  t), 'dim2': arra
-0001b080: 7928 5b31 2c20 325d 297d 290a 2020 2020  y([1, 2])}).    
-0001b090: 2020 2020 2020 2020 3e3e 3e20 6172 7231          >>> arr1
-0001b0a0: 203e 2031 350a 2020 2020 2020 2020 2020   > 15.          
-0001b0b0: 2020 4172 7261 7928 6461 7461 3d61 7272    Array(data=arr
-0001b0c0: 6179 285b 5b46 616c 7365 2c20 4661 6c73  ay([[False, Fals
-0001b0d0: 655d 2c0a 2020 2020 2020 2020 2020 2020  e],.            
-0001b0e0: 2020 2020 2020 205b 4661 6c73 652c 2020         [False,  
-0001b0f0: 5472 7565 5d5d 292c 2063 6f6f 7264 733d  True]]), coords=
-0001b100: 7b27 6469 6d31 273a 2061 7272 6179 285b  {'dim1': array([
-0001b110: 2761 272c 2027 6227 5d2c 2064 7479 7065  'a', 'b'], dtype
-0001b120: 3d6f 626a 6563 7429 2c20 2764 696d 3227  =object), 'dim2'
-0001b130: 3a20 6172 7261 7928 5b31 2c20 325d 297d  : array([1, 2])}
-0001b140: 290a 0a20 2020 2020 2020 2020 2020 2060  )..            `
-0001b150: 6060 0a20 2020 2020 2020 2022 2222 0a20  ``.        """. 
-0001b160: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001b170: 616e 6365 286f 7468 6572 2c20 2869 6e74  ance(other, (int
-0001b180: 2c20 666c 6f61 7429 293a 0a20 2020 2020  , float)):.     
-0001b190: 2020 2020 2020 2061 7272 203d 2073 656c         arr = sel
-0001b1a0: 662e 6461 7461 203e 206f 7468 6572 0a20  f.data > other. 
-0001b1b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001b1c0: 6e20 7365 6c66 2e5f 706f 7374 5f6f 7065  n self._post_ope
-0001b1d0: 7261 7469 6f6e 2861 7272 2c20 7365 6c66  ration(arr, self
-0001b1e0: 2e63 6f6f 7264 7329 0a20 2020 2020 2020  .coords).       
-0001b1f0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-0001b200: 286f 7468 6572 2c20 4172 7261 7929 3a0a  (other, Array):.
-0001b210: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001b220: 5f61 7272 2c20 6f74 6865 725f 6172 722c  _arr, other_arr,
-0001b230: 2063 6f6f 7264 7320 3d20 7365 6c66 2e5f   coords = self._
-0001b240: 7072 655f 6f70 6572 6174 696f 6e5f 7769  pre_operation_wi
-0001b250: 7468 5f61 7272 6179 286f 7468 6572 290a  th_array(other).
-0001b260: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
-0001b270: 3d20 7365 6c66 5f61 7272 203e 206f 7468  = self_arr > oth
-0001b280: 6572 5f61 7272 0a20 2020 2020 2020 2020  er_arr.         
-0001b290: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0001b2a0: 706f 7374 5f6f 7065 7261 7469 6f6e 2861  post_operation(a
-0001b2b0: 7272 2e54 2c20 636f 6f72 6473 290a 0a20  rr.T, coords).. 
-0001b2c0: 2020 2064 6566 205f 5f72 6774 5f5f 2873     def __rgt__(s
-0001b2d0: 656c 662c 206f 7468 6572 3a20 556e 696f  elf, other: Unio
-0001b2e0: 6e5b 696e 742c 2066 6c6f 6174 5d29 202d  n[int, float]) -
-0001b2f0: 3e20 2741 7272 6179 273a 0a20 2020 2020  > 'Array':.     
-0001b300: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-0001b310: 6865 636b 2069 6620 6120 6e75 6d62 6572  heck if a number
-0001b320: 2069 7320 6772 6561 7465 7220 7468 616e   is greater than
-0001b330: 2074 6865 2041 7272 6179 2028 7265 7665   the Array (reve
-0001b340: 7273 6520 6772 6561 7465 7220 7468 616e  rse greater than
-0001b350: 292e 0a0a 2020 2020 2020 2020 4172 6773  )...        Args
-0001b360: 3a0a 2020 2020 2020 2020 2020 2020 6f74  :.            ot
-0001b370: 6865 723a 2054 6865 206e 756d 6265 7220  her: The number 
-0001b380: 746f 2063 6f6d 7061 7265 2e0a 0a20 2020  to compare...   
-0001b390: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
-0001b3a0: 2020 2020 2020 2020 2020 4120 6e65 7720            A new 
-0001b3b0: 4172 7261 7920 6f62 6a65 6374 2077 6974  Array object wit
-0001b3c0: 6820 626f 6f6c 6561 6e20 7661 6c75 6573  h boolean values
-0001b3d0: 2069 6e64 6963 6174 696e 6720 6772 6561   indicating grea
-0001b3e0: 7465 7220 7468 616e 2e0a 0a20 2020 2020  ter than...     
-0001b3f0: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-0001b400: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-0001b410: 6e0a 2020 2020 2020 2020 2020 2020 3e3e  n.            >>
-0001b420: 3e20 636f 6f72 6473 203d 207b 2764 696d  > coords = {'dim
-0001b430: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-0001b440: 2764 696d 3227 3a20 5b31 2c20 325d 7d0a  'dim2': [1, 2]}.
-0001b450: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-0001b460: 6465 6e73 6520 3d20 6e70 2e61 7272 6179  dense = np.array
-0001b470: 285b 5b31 302c 2032 305d 2c20 5b32 302c  ([[10, 20], [20,
-0001b480: 2031 305d 5d29 0a20 2020 2020 2020 2020   10]]).         
-0001b490: 2020 203e 3e3e 2061 7272 203d 2041 7272     >>> arr = Arr
-0001b4a0: 6179 2864 6174 613d 6465 6e73 652c 2063  ay(data=dense, c
-0001b4b0: 6f6f 7264 733d 636f 6f72 6473 290a 2020  oords=coords).  
-0001b4c0: 2020 2020 2020 2020 2020 3e3e 3e20 3135            >>> 15
-0001b4d0: 203e 2061 7272 0a20 2020 2020 2020 2020   > arr.         
-0001b4e0: 2020 2041 7272 6179 2864 6174 613d 6172     Array(data=ar
-0001b4f0: 7261 7928 5b5b 2054 7275 652c 2046 616c  ray([[ True, Fal
-0001b500: 7365 5d2c 0a20 2020 2020 2020 2020 2020  se],.           
-0001b510: 2020 2020 2020 2020 5b46 616c 7365 2c20          [False, 
-0001b520: 2054 7275 655d 5d29 2c20 636f 6f72 6473   True]]), coords
-0001b530: 3d7b 2764 696d 3127 3a20 6172 7261 7928  ={'dim1': array(
-0001b540: 5b27 6127 2c20 2762 275d 2c20 6474 7970  ['a', 'b'], dtyp
-0001b550: 653d 6f62 6a65 6374 292c 2027 6469 6d32  e=object), 'dim2
-0001b560: 273a 2061 7272 6179 285b 312c 2032 5d29  ': array([1, 2])
-0001b570: 7d29 0a0a 2020 2020 2020 2020 2020 2020  })..            
-0001b580: 6060 600a 2020 2020 2020 2020 2222 220a  ```.        """.
-0001b590: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0001b5a0: 7461 6e63 6528 6f74 6865 722c 2028 696e  tance(other, (in
-0001b5b0: 742c 2066 6c6f 6174 2929 3a0a 2020 2020  t, float)):.    
-0001b5c0: 2020 2020 2020 2020 6172 7220 3d20 6f74          arr = ot
-0001b5d0: 6865 7220 3e20 7365 6c66 2e64 6174 610a  her > self.data.
-0001b5e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001b5f0: 726e 2073 656c 662e 5f70 6f73 745f 6f70  rn self._post_op
-0001b600: 6572 6174 696f 6e28 6172 722c 2073 656c  eration(arr, sel
-0001b610: 662e 636f 6f72 6473 290a 0a20 2020 2064  f.coords)..    d
-0001b620: 6566 205f 5f67 655f 5f28 7365 6c66 2c20  ef __ge__(self, 
-0001b630: 6f74 6865 723a 2055 6e69 6f6e 5b69 6e74  other: Union[int
-0001b640: 2c20 666c 6f61 742c 2027 4172 7261 7927  , float, 'Array'
-0001b650: 5d29 202d 3e20 2741 7272 6179 273a 0a20  ]) -> 'Array':. 
-0001b660: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001b670: 2020 2043 6865 636b 2069 6620 7468 6520     Check if the 
-0001b680: 4172 7261 7920 6973 2067 7265 6174 6572  Array is greater
-0001b690: 2074 6861 6e20 6f72 2065 7175 616c 2074   than or equal t
-0001b6a0: 6f20 616e 6f74 6865 7220 4172 7261 7920  o another Array 
-0001b6b0: 6f72 2061 206e 756d 6265 722e 0a0a 2020  or a number...  
-0001b6c0: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
-0001b6d0: 2020 2020 2020 2020 6f74 6865 723a 2054          other: T
-0001b6e0: 6865 206f 7468 6572 2041 7272 6179 206f  he other Array o
-0001b6f0: 7220 6e75 6d62 6572 2074 6f20 636f 6d70  r number to comp
-0001b700: 6172 652e 0a0a 2020 2020 2020 2020 5265  are...        Re
-0001b710: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
-0001b720: 2020 2041 206e 6577 2041 7272 6179 206f     A new Array o
-0001b730: 626a 6563 7420 7769 7468 2062 6f6f 6c65  bject with boole
-0001b740: 616e 2076 616c 7565 7320 696e 6469 6361  an values indica
-0001b750: 7469 6e67 2067 7265 6174 6572 2074 6861  ting greater tha
-0001b760: 6e20 6f72 2065 7175 616c 2074 6f2e 0a0a  n or equal to...
-0001b770: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
-0001b780: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-0001b790: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
-0001b7a0: 2020 203e 3e3e 2063 6f6f 7264 7320 3d20     >>> coords = 
-0001b7b0: 7b27 6469 6d31 273a 205b 2761 272c 2027  {'dim1': ['a', '
-0001b7c0: 6227 5d2c 2027 6469 6d32 273a 205b 312c  b'], 'dim2': [1,
-0001b7d0: 2032 5d7d 0a20 2020 2020 2020 2020 2020   2]}.           
-0001b7e0: 203e 3e3e 206c 6f6e 6731 203d 204c 6f6e   >>> long1 = Lon
-0001b7f0: 6728 696e 6465 783d 7b27 6469 6d31 273a  g(index={'dim1':
-0001b800: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
-0001b810: 6d32 273a 205b 312c 2032 5d7d 2c20 7661  m2': [1, 2]}, va
-0001b820: 6c75 653d 5b31 302c 2032 305d 290a 2020  lue=[10, 20]).  
-0001b830: 2020 2020 2020 2020 2020 3e3e 3e20 6c6f            >>> lo
-0001b840: 6e67 3220 3d20 4c6f 6e67 2869 6e64 6578  ng2 = Long(index
-0001b850: 3d7b 2764 696d 3127 3a20 5b27 6127 2c20  ={'dim1': ['a', 
-0001b860: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
-0001b870: 2c20 325d 7d2c 2076 616c 7565 3d5b 3230  , 2]}, value=[20
-0001b880: 2c20 3130 5d29 0a20 2020 2020 2020 2020  , 10]).         
-0001b890: 2020 203e 3e3e 2061 7272 3120 3d20 4172     >>> arr1 = Ar
-0001b8a0: 7261 7928 6461 7461 3d6c 6f6e 6731 2c20  ray(data=long1, 
-0001b8b0: 636f 6f72 6473 3d63 6f6f 7264 7329 0a20  coords=coords). 
-0001b8c0: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
-0001b8d0: 7272 3220 3d20 4172 7261 7928 6461 7461  rr2 = Array(data
-0001b8e0: 3d6c 6f6e 6732 2c20 636f 6f72 6473 3d63  =long2, coords=c
-0001b8f0: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
-0001b900: 2020 203e 3e3e 2061 7272 3120 3e3d 2061     >>> arr1 >= a
-0001b910: 7272 320a 2020 2020 2020 2020 2020 2020  rr2.            
-0001b920: 4172 7261 7928 6461 7461 3d61 7272 6179  Array(data=array
-0001b930: 285b 5b46 616c 7365 2c20 2054 7275 655d  ([[False,  True]
-0001b940: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001b950: 2020 2020 205b 2054 7275 652c 2020 5472       [ True,  Tr
-0001b960: 7565 5d5d 292c 2063 6f6f 7264 733d 7b27  ue]]), coords={'
-0001b970: 6469 6d31 273a 2061 7272 6179 285b 2761  dim1': array(['a
-0001b980: 272c 2027 6227 5d2c 2064 7479 7065 3d6f  ', 'b'], dtype=o
-0001b990: 626a 6563 7429 2c20 2764 696d 3227 3a20  bject), 'dim2': 
-0001b9a0: 6172 7261 7928 5b31 2c20 325d 297d 290a  array([1, 2])}).
-0001b9b0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-0001b9c0: 6172 7231 203e 3d20 3130 0a20 2020 2020  arr1 >= 10.     
-0001b9d0: 2020 2020 2020 2041 7272 6179 2864 6174         Array(dat
-0001b9e0: 613d 6172 7261 7928 5b5b 2054 7275 652c  a=array([[ True,
-0001b9f0: 2046 616c 7365 5d2c 0a20 2020 2020 2020   False],.       
-0001ba00: 2020 2020 2020 2020 2020 2020 5b46 616c              [Fal
-0001ba10: 7365 2c20 2054 7275 655d 5d29 2c20 636f  se,  True]]), co
-0001ba20: 6f72 6473 3d7b 2764 696d 3127 3a20 6172  ords={'dim1': ar
-0001ba30: 7261 7928 5b27 6127 2c20 2762 275d 2c20  ray(['a', 'b'], 
-0001ba40: 6474 7970 653d 6f62 6a65 6374 292c 2027  dtype=object), '
-0001ba50: 6469 6d32 273a 2061 7272 6179 285b 312c  dim2': array([1,
-0001ba60: 2032 5d29 7d29 0a0a 2020 2020 2020 2020   2])})..        
-0001ba70: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
-0001ba80: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
-0001ba90: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
-0001baa0: 2028 696e 742c 2066 6c6f 6174 2929 3a0a   (int, float)):.
-0001bab0: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
-0001bac0: 3d20 7365 6c66 2e64 6174 6120 3e3d 206f  = self.data >= o
-0001bad0: 7468 6572 0a20 2020 2020 2020 2020 2020  ther.           
-0001bae0: 2072 6574 7572 6e20 7365 6c66 2e5f 706f   return self._po
-0001baf0: 7374 5f6f 7065 7261 7469 6f6e 2861 7272  st_operation(arr
-0001bb00: 2c20 7365 6c66 2e63 6f6f 7264 7329 0a20  , self.coords). 
-0001bb10: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-0001bb20: 7374 616e 6365 286f 7468 6572 2c20 4172  stance(other, Ar
-0001bb30: 7261 7929 3a0a 2020 2020 2020 2020 2020  ray):.          
-0001bb40: 2020 7365 6c66 5f61 7272 2c20 6f74 6865    self_arr, othe
-0001bb50: 725f 6172 722c 2063 6f6f 7264 7320 3d20  r_arr, coords = 
-0001bb60: 7365 6c66 2e5f 7072 655f 6f70 6572 6174  self._pre_operat
-0001bb70: 696f 6e5f 7769 7468 5f61 7272 6179 286f  ion_with_array(o
-0001bb80: 7468 6572 290a 2020 2020 2020 2020 2020  ther).          
-0001bb90: 2020 6172 7220 3d20 7365 6c66 5f61 7272    arr = self_arr
-0001bba0: 203e 3d20 6f74 6865 725f 6172 720a 2020   >= other_arr.  
-0001bbb0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001bbc0: 2073 656c 662e 5f70 6f73 745f 6f70 6572   self._post_oper
-0001bbd0: 6174 696f 6e28 6172 722e 542c 2063 6f6f  ation(arr.T, coo
-0001bbe0: 7264 7329 0a0a 2020 2020 6465 6620 5f5f  rds)..    def __
-0001bbf0: 7267 655f 5f28 7365 6c66 2c20 6f74 6865  rge__(self, othe
-0001bc00: 723a 2055 6e69 6f6e 5b69 6e74 2c20 666c  r: Union[int, fl
-0001bc10: 6f61 745d 2920 2d3e 2027 4172 7261 7927  oat]) -> 'Array'
-0001bc20: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0001bc30: 2020 2020 2020 4368 6563 6b20 6966 2061        Check if a
-0001bc40: 206e 756d 6265 7220 6973 2067 7265 6174   number is great
-0001bc50: 6572 2074 6861 6e20 6f72 2065 7175 616c  er than or equal
-0001bc60: 2074 6f20 7468 6520 4172 7261 7920 2872   to the Array (r
-0001bc70: 6576 6572 7365 2067 7265 6174 6572 2074  everse greater t
-0001bc80: 6861 6e20 6f72 2065 7175 616c 2074 6f29  han or equal to)
-0001bc90: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-0001bca0: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
-0001bcb0: 6572 3a20 5468 6520 6e75 6d62 6572 2074  er: The number t
-0001bcc0: 6f20 636f 6d70 6172 652e 0a0a 2020 2020  o compare...    
-0001bcd0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-0001bce0: 2020 2020 2020 2020 2041 206e 6577 2041           A new A
-0001bcf0: 7272 6179 206f 626a 6563 7420 7769 7468  rray object with
-0001bd00: 2062 6f6f 6c65 616e 2076 616c 7565 7320   boolean values 
-0001bd10: 696e 6469 6361 7469 6e67 2067 7265 6174  indicating great
-0001bd20: 6572 2074 6861 6e20 6f72 2065 7175 616c  er than or equal
-0001bd30: 2074 6f2e 0a0a 2020 2020 2020 2020 4578   to...        Ex
-0001bd40: 616d 706c 653a 0a20 2020 2020 2020 2020  ample:.         
-0001bd50: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
-0001bd60: 2020 2020 2020 2020 203e 3e3e 2063 6f6f           >>> coo
-0001bd70: 7264 7320 3d20 7b27 6469 6d31 273a 205b  rds = {'dim1': [
-0001bd80: 2761 272c 2027 6227 5d2c 2027 6469 6d32  'a', 'b'], 'dim2
-0001bd90: 273a 205b 312c 2032 5d7d 0a20 2020 2020  ': [1, 2]}.     
-0001bda0: 2020 2020 2020 203e 3e3e 206c 6f6e 6720         >>> long 
-0001bdb0: 3d20 4c6f 6e67 2869 6e64 6578 3d7b 2764  = Long(index={'d
-0001bdc0: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
-0001bdd0: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
-0001bde0: 7d2c 2076 616c 7565 3d5b 3130 2c20 3230  }, value=[10, 20
-0001bdf0: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
-0001be00: 3e3e 2061 7272 203d 2041 7272 6179 2864  >> arr = Array(d
-0001be10: 6174 613d 6c6f 6e67 2c20 636f 6f72 6473  ata=long, coords
-0001be20: 3d63 6f6f 7264 7329 0a20 2020 2020 2020  =coords).       
-0001be30: 2020 2020 203e 3e3e 2031 3020 3e3d 2061       >>> 10 >= a
-0001be40: 7272 0a20 2020 2020 2020 2020 2020 2041  rr.            A
-0001be50: 7272 6179 2864 6174 613d 6172 7261 7928  rray(data=array(
-0001be60: 5b5b 2054 7275 652c 2020 5472 7565 5d2c  [[ True,  True],
-0001be70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001be80: 2020 2020 5b20 5472 7565 2c20 4661 6c73      [ True, Fals
-0001be90: 655d 5d29 2c20 636f 6f72 6473 3d7b 2764  e]]), coords={'d
-0001bea0: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
-0001beb0: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
-0001bec0: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
-0001bed0: 7272 6179 285b 312c 2032 5d29 7d29 0a0a  rray([1, 2])})..
-0001bee0: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-0001bef0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001bf00: 2020 2020 6172 7220 3d20 6f74 6865 7220      arr = other 
-0001bf10: 3e3d 2073 656c 662e 6461 7461 0a20 2020  >= self.data.   
-0001bf20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001bf30: 2e5f 706f 7374 5f6f 7065 7261 7469 6f6e  ._post_operation
-0001bf40: 2861 7272 2c20 7365 6c66 2e63 6f6f 7264  (arr, self.coord
-0001bf50: 7329 0a0a 2020 2020 6465 6620 5f5f 616e  s)..    def __an
-0001bf60: 645f 5f28 7365 6c66 2c20 6f74 6865 723a  d__(self, other:
-0001bf70: 2055 6e69 6f6e 5b62 6f6f 6c2c 2027 4172   Union[bool, 'Ar
-0001bf80: 7261 7927 5d29 202d 3e20 2741 7272 6179  ray']) -> 'Array
-0001bf90: 273a 0a20 2020 2020 2020 2022 2222 0a20  ':.        """. 
-0001bfa0: 2020 2020 2020 2050 6572 666f 726d 2065         Perform e
-0001bfb0: 6c65 6d65 6e74 2d77 6973 6520 6c6f 6769  lement-wise logi
-0001bfc0: 6361 6c20 414e 4420 6f70 6572 6174 696f  cal AND operatio
-0001bfd0: 6e20 6265 7477 6565 6e20 7468 6520 4172  n between the Ar
-0001bfe0: 7261 7920 616e 6420 616e 6f74 6865 7220  ray and another 
-0001bff0: 4172 7261 7920 6f72 2061 2062 6f6f 6c65  Array or a boole
-0001c000: 616e 2e0a 0a20 2020 2020 2020 2041 7267  an...        Arg
-0001c010: 733a 0a20 2020 2020 2020 2020 2020 206f  s:.            o
-0001c020: 7468 6572 3a20 5468 6520 6f74 6865 7220  ther: The other 
-0001c030: 4172 7261 7920 6f72 2062 6f6f 6c65 616e  Array or boolean
-0001c040: 2074 6f20 7065 7266 6f72 6d20 7468 6520   to perform the 
-0001c050: 6f70 6572 6174 696f 6e20 7769 7468 2e0a  operation with..
-0001c060: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0001c070: 3a0a 2020 2020 2020 2020 2020 2020 4120  :.            A 
-0001c080: 6e65 7720 4172 7261 7920 6f62 6a65 6374  new Array object
-0001c090: 2077 6974 6820 7468 6520 7265 7375 6c74   with the result
-0001c0a0: 206f 6620 7468 6520 6c6f 6769 6361 6c20   of the logical 
-0001c0b0: 414e 4420 6f70 6572 6174 696f 6e2e 0a0a  AND operation...
-0001c0c0: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
-0001c0d0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-0001c0e0: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
-0001c0f0: 2020 203e 3e3e 2063 6f6f 7264 7320 3d20     >>> coords = 
-0001c100: 7b27 6469 6d31 273a 205b 2761 272c 2027  {'dim1': ['a', '
-0001c110: 6227 5d2c 2027 6469 6d32 273a 205b 312c  b'], 'dim2': [1,
-0001c120: 2032 5d7d 0a20 2020 2020 2020 2020 2020   2]}.           
-0001c130: 203e 3e3e 206c 6f6e 6731 203d 204c 6f6e   >>> long1 = Lon
-0001c140: 6728 696e 6465 783d 7b27 6469 6d31 273a  g(index={'dim1':
-0001c150: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
-0001c160: 6d32 273a 205b 312c 2032 5d7d 2c20 7661  m2': [1, 2]}, va
-0001c170: 6c75 653d 5b31 302c 2032 305d 290a 2020  lue=[10, 20]).  
-0001c180: 2020 2020 2020 2020 2020 3e3e 3e20 6c6f            >>> lo
-0001c190: 6e67 3220 3d20 4c6f 6e67 2869 6e64 6578  ng2 = Long(index
-0001c1a0: 3d7b 2764 696d 3127 3a20 5b27 6127 2c20  ={'dim1': ['a', 
-0001c1b0: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
-0001c1c0: 2c20 325d 7d2c 2076 616c 7565 3d5b 3230  , 2]}, value=[20
-0001c1d0: 2c20 3130 5d29 0a20 2020 2020 2020 2020  , 10]).         
-0001c1e0: 2020 203e 3e3e 2061 7272 3120 3d20 4172     >>> arr1 = Ar
-0001c1f0: 7261 7928 6461 7461 3d6c 6f6e 6731 2c20  ray(data=long1, 
-0001c200: 636f 6f72 6473 3d63 6f6f 7264 7329 0a20  coords=coords). 
-0001c210: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
-0001c220: 7272 3220 3d20 4172 7261 7928 6461 7461  rr2 = Array(data
-0001c230: 3d6c 6f6e 6732 2c20 636f 6f72 6473 3d63  =long2, coords=c
-0001c240: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
-0001c250: 2020 203e 3e3e 2061 7272 3120 2620 6172     >>> arr1 & ar
-0001c260: 7232 0a20 2020 2020 2020 2020 2020 2041  r2.            A
-0001c270: 7272 6179 2864 6174 613d 6172 7261 7928  rray(data=array(
-0001c280: 5b5b 302e 2c20 302e 5d2c 0a20 2020 2020  [[0., 0.],.     
-0001c290: 2020 2020 2020 2020 2020 2020 2020 5b30                [0
-0001c2a0: 2e2c 2030 2e5d 5d29 2c20 636f 6f72 6473  ., 0.]]), coords
-0001c2b0: 3d7b 2764 696d 3127 3a20 6172 7261 7928  ={'dim1': array(
-0001c2c0: 5b27 6127 2c20 2762 275d 2c20 6474 7970  ['a', 'b'], dtyp
-0001c2d0: 653d 6f62 6a65 6374 292c 2027 6469 6d32  e=object), 'dim2
-0001c2e0: 273a 2061 7272 6179 285b 312c 2032 5d29  ': array([1, 2])
-0001c2f0: 7d29 0a20 2020 2020 2020 2020 2020 203e  }).            >
-0001c300: 3e3e 2061 7272 3120 2620 5472 7565 0a20  >> arr1 & True. 
-0001c310: 2020 2020 2020 2020 2020 2041 7272 6179             Array
-0001c320: 2864 6174 613d 6172 7261 7928 5b5b 302e  (data=array([[0.
-0001c330: 2c20 302e 5d2c 0a20 2020 2020 2020 2020  , 0.],.         
-0001c340: 2020 2020 2020 2020 2020 5b30 2e2c 2030            [0., 0
-0001c350: 2e5d 5d29 2c20 636f 6f72 6473 3d7b 2764  .]]), coords={'d
-0001c360: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
-0001c370: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
-0001c380: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
-0001c390: 7272 6179 285b 312c 2032 5d29 7d29 0a0a  rray([1, 2])})..
-0001c3a0: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-0001c3b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001c3c0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0001c3d0: 6528 6f74 6865 722c 2028 696e 742c 2066  e(other, (int, f
-0001c3e0: 6c6f 6174 2929 3a0a 2020 2020 2020 2020  loat)):.        
-0001c3f0: 2020 2020 6172 7220 3d20 7365 6c66 2e64      arr = self.d
-0001c400: 6174 6120 2620 6f74 6865 720a 2020 2020  ata & other.    
-0001c410: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001c420: 656c 662e 5f70 6f73 745f 6f70 6572 6174  elf._post_operat
-0001c430: 696f 6e28 6172 722c 2073 656c 662e 636f  ion(arr, self.co
-0001c440: 6f72 6473 290a 2020 2020 2020 2020 656c  ords).        el
-0001c450: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
-0001c460: 6865 722c 2041 7272 6179 293a 0a20 2020  her, Array):.   
-0001c470: 2020 2020 2020 2020 2073 656c 665f 6172           self_ar
-0001c480: 722c 206f 7468 6572 5f61 7272 2c20 636f  r, other_arr, co
-0001c490: 6f72 6473 203d 2073 656c 662e 5f70 7265  ords = self._pre
-0001c4a0: 5f6f 7065 7261 7469 6f6e 5f77 6974 685f  _operation_with_
-0001c4b0: 6172 7261 7928 6f74 6865 7229 0a20 2020  array(other).   
-0001c4c0: 2020 2020 2020 2020 2061 7272 203d 2073           arr = s
-0001c4d0: 656c 665f 6172 7220 2620 6f74 6865 725f  elf_arr & other_
-0001c4e0: 6172 720a 2020 2020 2020 2020 2020 2020  arr.            
-0001c4f0: 7265 7475 726e 2073 656c 662e 5f70 6f73  return self._pos
-0001c500: 745f 6f70 6572 6174 696f 6e28 6172 722e  t_operation(arr.
-0001c510: 542c 2063 6f6f 7264 7329 0a0a 2020 2020  T, coords)..    
-0001c520: 6465 6620 5f5f 7261 6e64 5f5f 2873 656c  def __rand__(sel
-0001c530: 662c 206f 7468 6572 3a20 626f 6f6c 2920  f, other: bool) 
-0001c540: 2d3e 2027 4172 7261 7927 3a0a 2020 2020  -> 'Array':.    
-0001c550: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001c560: 5065 7266 6f72 6d20 656c 656d 656e 742d  Perform element-
-0001c570: 7769 7365 206c 6f67 6963 616c 2041 4e44  wise logical AND
-0001c580: 206f 7065 7261 7469 6f6e 2062 6574 7765   operation betwe
-0001c590: 656e 2061 2062 6f6f 6c65 616e 2061 6e64  en a boolean and
-0001c5a0: 2074 6865 2041 7272 6179 2028 7265 7665   the Array (reve
-0001c5b0: 7273 6520 414e 4429 2e0a 0a20 2020 2020  rse AND)...     
-0001c5c0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0001c5d0: 2020 2020 206f 7468 6572 3a20 5468 6520       other: The 
-0001c5e0: 626f 6f6c 6561 6e20 746f 2070 6572 666f  boolean to perfo
-0001c5f0: 726d 2074 6865 206f 7065 7261 7469 6f6e  rm the operation
-0001c600: 2077 6974 682e 0a0a 2020 2020 2020 2020   with...        
-0001c610: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-0001c620: 2020 2020 2041 206e 6577 2041 7272 6179       A new Array
-0001c630: 206f 626a 6563 7420 7769 7468 2074 6865   object with the
-0001c640: 2072 6573 756c 7420 6f66 2074 6865 206c   result of the l
-0001c650: 6f67 6963 616c 2041 4e44 206f 7065 7261  ogical AND opera
-0001c660: 7469 6f6e 2e0a 0a20 2020 2020 2020 2045  tion...        E
-0001c670: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-0001c680: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
-0001c690: 2020 2020 2020 2020 2020 3e3e 3e20 6c6f            >>> lo
-0001c6a0: 6e67 203d 204c 6f6e 6728 696e 6465 783d  ng = Long(index=
-0001c6b0: 7b27 6469 6d31 273a 205b 2761 272c 2027  {'dim1': ['a', '
-0001c6c0: 6227 5d2c 2027 6469 6d32 273a 205b 312c  b'], 'dim2': [1,
-0001c6d0: 2032 5d7d 2c20 7661 6c75 653d 5b31 302c   2]}, value=[10,
-0001c6e0: 2032 305d 290a 2020 2020 2020 2020 2020   20]).          
-0001c6f0: 2020 3e3e 3e20 6172 7220 3d20 4172 7261    >>> arr = Arra
-0001c700: 7928 6461 7461 3d6c 6f6e 6729 0a20 2020  y(data=long).   
-0001c710: 2020 2020 2020 2020 203e 3e3e 2054 7275           >>> Tru
-0001c720: 6520 2620 6172 720a 2020 2020 2020 2020  e & arr.        
-0001c730: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
-0001c740: 7272 6179 285b 5b30 2e2c 2030 2e5d 2c0a  rray([[0., 0.],.
-0001c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c760: 2020 205b 302e 2c20 302e 5d5d 292c 2063     [0., 0.]]), c
-0001c770: 6f6f 7264 733d 7b27 6469 6d31 273a 2061  oords={'dim1': a
-0001c780: 7272 6179 285b 2761 272c 2027 6227 5d2c  rray(['a', 'b'],
-0001c790: 2064 7479 7065 3d6f 626a 6563 7429 2c20   dtype=object), 
-0001c7a0: 2764 696d 3227 3a20 6172 7261 7928 5b31  'dim2': array([1
-0001c7b0: 2c20 325d 297d 290a 0a20 2020 2020 2020  , 2])})..       
-0001c7c0: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-0001c7d0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-0001c7e0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
-0001c7f0: 2c20 626f 6f6c 293a 0a20 2020 2020 2020  , bool):.       
-0001c800: 2020 2020 2061 7272 203d 206f 7468 6572       arr = other
-0001c810: 2026 2073 656c 662e 6461 7461 0a20 2020   & self.data.   
-0001c820: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001c830: 7365 6c66 2e5f 706f 7374 5f6f 7065 7261  self._post_opera
-0001c840: 7469 6f6e 2861 7272 2c20 7365 6c66 2e63  tion(arr, self.c
-0001c850: 6f6f 7264 7329 0a0a 2020 2020 6465 6620  oords)..    def 
-0001c860: 5f5f 6f72 5f5f 2873 656c 662c 206f 7468  __or__(self, oth
-0001c870: 6572 3a20 556e 696f 6e5b 696e 742c 2066  er: Union[int, f
-0001c880: 6c6f 6174 2c20 2741 7272 6179 275d 2920  loat, 'Array']) 
-0001c890: 2d3e 2027 4172 7261 7927 3a0a 2020 2020  -> 'Array':.    
-0001c8a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001c8b0: 5065 7266 6f72 6d20 656c 656d 656e 742d  Perform element-
-0001c8c0: 7769 7365 206c 6f67 6963 616c 204f 5220  wise logical OR 
-0001c8d0: 6f70 6572 6174 696f 6e20 6265 7477 6565  operation betwee
-0001c8e0: 6e20 7468 6520 4172 7261 7920 616e 6420  n the Array and 
-0001c8f0: 616e 6f74 6865 7220 4172 7261 7920 6f72  another Array or
-0001c900: 2061 206e 756d 6265 722e 0a0a 2020 2020   a number...    
-0001c910: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0001c920: 2020 2020 2020 6f74 6865 723a 2054 6865        other: The
-0001c930: 206f 7468 6572 2041 7272 6179 206f 7220   other Array or 
-0001c940: 6e75 6d62 6572 2074 6f20 7065 7266 6f72  number to perfor
-0001c950: 6d20 7468 6520 6f70 6572 6174 696f 6e20  m the operation 
-0001c960: 7769 7468 2e0a 0a20 2020 2020 2020 2052  with...        R
-0001c970: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-0001c980: 2020 2020 4120 6e65 7720 4172 7261 7920      A new Array 
-0001c990: 6f62 6a65 6374 2077 6974 6820 7468 6520  object with the 
-0001c9a0: 7265 7375 6c74 206f 6620 7468 6520 6c6f  result of the lo
-0001c9b0: 6769 6361 6c20 4f52 206f 7065 7261 7469  gical OR operati
-0001c9c0: 6f6e 2e0a 0a20 2020 2020 2020 2045 7861  on...        Exa
-0001c9d0: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
-0001c9e0: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-0001c9f0: 2020 2020 2020 2020 3e3e 3e20 636f 6f72          >>> coor
-0001ca00: 6473 203d 207b 2764 696d 3127 3a20 5b27  ds = {'dim1': ['
-0001ca10: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
-0001ca20: 3a20 5b31 2c20 325d 7d0a 2020 2020 2020  : [1, 2]}.      
-0001ca30: 2020 2020 2020 3e3e 3e20 6c6f 6e67 3120        >>> long1 
-0001ca40: 3d20 4c6f 6e67 2869 6e64 6578 3d7b 2764  = Long(index={'d
-0001ca50: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
-0001ca60: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
-0001ca70: 7d2c 2076 616c 7565 3d5b 3130 2c20 3230  }, value=[10, 20
-0001ca80: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
-0001ca90: 3e3e 206c 6f6e 6732 203d 204c 6f6e 6728  >> long2 = Long(
-0001caa0: 696e 6465 783d 7b27 6469 6d31 273a 205b  index={'dim1': [
-0001cab0: 2761 272c 2027 6227 5d2c 2027 6469 6d32  'a', 'b'], 'dim2
-0001cac0: 273a 205b 312c 2032 5d7d 2c20 7661 6c75  ': [1, 2]}, valu
-0001cad0: 653d 5b32 302c 2031 305d 290a 2020 2020  e=[20, 10]).    
-0001cae0: 2020 2020 2020 2020 3e3e 3e20 6172 7231          >>> arr1
-0001caf0: 203d 2041 7272 6179 2864 6174 613d 6c6f   = Array(data=lo
-0001cb00: 6e67 312c 2063 6f6f 7264 733d 636f 6f72  ng1, coords=coor
-0001cb10: 6473 290a 2020 2020 2020 2020 2020 2020  ds).            
-0001cb20: 3e3e 3e20 6172 7232 203d 2041 7272 6179  >>> arr2 = Array
-0001cb30: 2864 6174 613d 6c6f 6e67 322c 2063 6f6f  (data=long2, coo
-0001cb40: 7264 733d 636f 6f72 6473 290a 2020 2020  rds=coords).    
-0001cb50: 2020 2020 2020 2020 3e3e 3e20 6172 7231          >>> arr1
-0001cb60: 207c 2061 7272 320a 2020 2020 2020 2020   | arr2.        
-0001cb70: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
-0001cb80: 7272 6179 285b 5b33 302e 2c20 2030 2e5d  rray([[30.,  0.]
-0001cb90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001cba0: 2020 2020 205b 2030 2e2c 2033 302e 5d5d       [ 0., 30.]]
-0001cbb0: 292c 2063 6f6f 7264 733d 7b27 6469 6d31  ), coords={'dim1
-0001cbc0: 273a 2061 7272 6179 285b 2761 272c 2027  ': array(['a', '
-0001cbd0: 6227 5d2c 2064 7479 7065 3d6f 626a 6563  b'], dtype=objec
-0001cbe0: 7429 2c20 2764 696d 3227 3a20 6172 7261  t), 'dim2': arra
-0001cbf0: 7928 5b31 2c20 325d 297d 290a 2020 2020  y([1, 2])}).    
-0001cc00: 2020 2020 2020 2020 3e3e 3e20 6172 7231          >>> arr1
-0001cc10: 207c 2030 0a20 2020 2020 2020 2020 2020   | 0.           
-0001cc20: 2041 7272 6179 2864 6174 613d 6172 7261   Array(data=arra
-0001cc30: 7928 5b5b 3130 2e2c 2020 302e 5d2c 0a20  y([[10.,  0.],. 
-0001cc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc50: 2020 5b20 302e 2c20 3230 2e5d 5d29 2c20    [ 0., 20.]]), 
-0001cc60: 636f 6f72 6473 3d7b 2764 696d 3127 3a20  coords={'dim1': 
-0001cc70: 6172 7261 7928 5b27 6127 2c20 2762 275d  array(['a', 'b']
-0001cc80: 2c20 6474 7970 653d 6f62 6a65 6374 292c  , dtype=object),
-0001cc90: 2027 6469 6d32 273a 2061 7272 6179 285b   'dim2': array([
-0001cca0: 312c 2032 5d29 7d29 0a0a 2020 2020 2020  1, 2])})..      
-0001ccb0: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
-0001ccc0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-0001ccd0: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
-0001cce0: 722c 2028 696e 742c 2066 6c6f 6174 2929  r, (int, float))
-0001ccf0: 3a0a 2020 2020 2020 2020 2020 2020 6172  :.            ar
-0001cd00: 7220 3d20 7365 6c66 2e64 6174 6120 7c20  r = self.data | 
-0001cd10: 6f74 6865 720a 2020 2020 2020 2020 2020  other.          
-0001cd20: 2020 7265 7475 726e 2073 656c 662e 5f70    return self._p
-0001cd30: 6f73 745f 6f70 6572 6174 696f 6e28 6172  ost_operation(ar
-0001cd40: 722c 2073 656c 662e 636f 6f72 6473 290a  r, self.coords).
-0001cd50: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-0001cd60: 6e73 7461 6e63 6528 6f74 6865 722c 2041  nstance(other, A
-0001cd70: 7272 6179 293a 0a20 2020 2020 2020 2020  rray):.         
-0001cd80: 2020 2073 656c 665f 6172 722c 206f 7468     self_arr, oth
-0001cd90: 6572 5f61 7272 2c20 636f 6f72 6473 203d  er_arr, coords =
-0001cda0: 2073 656c 662e 5f70 7265 5f6f 7065 7261   self._pre_opera
-0001cdb0: 7469 6f6e 5f77 6974 685f 6172 7261 7928  tion_with_array(
-0001cdc0: 6f74 6865 7229 0a20 2020 2020 2020 2020  other).         
-0001cdd0: 2020 2061 7272 203d 2073 656c 665f 6172     arr = self_ar
-0001cde0: 7220 7c20 6f74 6865 725f 6172 720a 2020  r | other_arr.  
-0001cdf0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001ce00: 2073 656c 662e 5f70 6f73 745f 6f70 6572   self._post_oper
-0001ce10: 6174 696f 6e28 6172 722e 542c 2063 6f6f  ation(arr.T, coo
-0001ce20: 7264 7329 0a0a 2020 2020 6465 6620 5f5f  rds)..    def __
-0001ce30: 726f 725f 5f28 7365 6c66 2c20 6f74 6865  ror__(self, othe
-0001ce40: 723a 2062 6f6f 6c29 202d 3e20 2741 7272  r: bool) -> 'Arr
-0001ce50: 6179 273a 0a20 2020 2020 2020 2022 2222  ay':.        """
-0001ce60: 0a20 2020 2020 2020 2050 6572 666f 726d  .        Perform
-0001ce70: 2065 6c65 6d65 6e74 2d77 6973 6520 6c6f   element-wise lo
-0001ce80: 6769 6361 6c20 4f52 206f 7065 7261 7469  gical OR operati
-0001ce90: 6f6e 2062 6574 7765 656e 2061 2062 6f6f  on between a boo
-0001cea0: 6c65 616e 2061 6e64 2074 6865 2041 7272  lean and the Arr
-0001ceb0: 6179 2028 7265 7665 7273 6520 4f52 292e  ay (reverse OR).
-0001cec0: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
-0001ced0: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
-0001cee0: 723a 2054 6865 2062 6f6f 6c65 616e 2074  r: The boolean t
-0001cef0: 6f20 7065 7266 6f72 6d20 7468 6520 6f70  o perform the op
-0001cf00: 6572 6174 696f 6e20 7769 7468 2e0a 0a20  eration with... 
-0001cf10: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
-0001cf20: 2020 2020 2020 2020 2020 2020 4120 6e65              A ne
-0001cf30: 7720 4172 7261 7920 6f62 6a65 6374 2077  w Array object w
-0001cf40: 6974 6820 7468 6520 7265 7375 6c74 206f  ith the result o
-0001cf50: 6620 7468 6520 6c6f 6769 6361 6c20 4f52  f the logical OR
-0001cf60: 206f 7065 7261 7469 6f6e 2e0a 0a20 2020   operation...   
-0001cf70: 2020 2020 2045 7861 6d70 6c65 3a0a 2020       Example:.  
-0001cf80: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
-0001cf90: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
-0001cfa0: 3e3e 3e20 6c6f 6e67 203d 204c 6f6e 6728  >>> long = Long(
-0001cfb0: 696e 6465 783d 7b27 6469 6d31 273a 205b  index={'dim1': [
-0001cfc0: 2761 272c 2027 6227 5d2c 2027 6469 6d32  'a', 'b'], 'dim2
-0001cfd0: 273a 205b 312c 2032 5d7d 2c20 7661 6c75  ': [1, 2]}, valu
-0001cfe0: 653d 5b31 302c 2032 305d 290a 2020 2020  e=[10, 20]).    
-0001cff0: 2020 2020 2020 2020 3e3e 3e20 6172 7220          >>> arr 
-0001d000: 3d20 4172 7261 7928 6461 7461 3d6c 6f6e  = Array(data=lon
-0001d010: 6729 0a20 2020 2020 2020 2020 2020 203e  g).            >
-0001d020: 3e3e 2054 7275 6520 7c20 6172 720a 2020  >> True | arr.  
-0001d030: 2020 2020 2020 2020 2020 4172 7261 7928            Array(
-0001d040: 6461 7461 3d61 7272 6179 285b 5b31 312e  data=array([[11.
-0001d050: 2c20 2031 2e5d 2c0a 2020 2020 2020 2020  ,  1.],.        
-0001d060: 2020 2020 2020 2020 2020 205b 2031 2e2c             [ 1.,
-0001d070: 2032 312e 5d5d 292c 2063 6f6f 7264 733d   21.]]), coords=
-0001d080: 7b27 6469 6d31 273a 2061 7272 6179 285b  {'dim1': array([
-0001d090: 2761 272c 2027 6227 5d2c 2064 7479 7065  'a', 'b'], dtype
-0001d0a0: 3d6f 626a 6563 7429 2c20 2764 696d 3227  =object), 'dim2'
-0001d0b0: 3a20 6172 7261 7928 5b31 2c20 325d 297d  : array([1, 2])}
-0001d0c0: 290a 0a20 2020 2020 2020 2020 2020 2060  )..            `
-0001d0d0: 6060 0a20 2020 2020 2020 2022 2222 0a20  ``.        """. 
-0001d0e0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001d0f0: 616e 6365 286f 7468 6572 2c20 626f 6f6c  ance(other, bool
-0001d100: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-0001d110: 7272 203d 206f 7468 6572 207c 2073 656c  rr = other | sel
-0001d120: 662e 6461 7461 0a20 2020 2020 2020 2020  f.data.         
-0001d130: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0001d140: 706f 7374 5f6f 7065 7261 7469 6f6e 2861  post_operation(a
-0001d150: 7272 2c20 7365 6c66 2e63 6f6f 7264 7329  rr, self.coords)
-0001d160: 0a0a 2020 2020 6465 6620 5f5f 696e 7665  ..    def __inve
-0001d170: 7274 5f5f 2873 656c 6629 202d 3e20 2741  rt__(self) -> 'A
-0001d180: 7272 6179 273a 0a20 2020 2020 2020 2022  rray':.        "
-0001d190: 2222 0a20 2020 2020 2020 2050 6572 666f  "".        Perfo
-0001d1a0: 726d 2065 6c65 6d65 6e74 2d77 6973 6520  rm element-wise 
-0001d1b0: 6c6f 6769 6361 6c20 4e4f 5420 6f70 6572  logical NOT oper
-0001d1c0: 6174 696f 6e20 6f6e 2074 6865 2041 7272  ation on the Arr
-0001d1d0: 6179 2e0a 0a20 2020 2020 2020 2052 6574  ay...        Ret
-0001d1e0: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-0001d1f0: 2020 4120 6e65 7720 4172 7261 7920 6f62    A new Array ob
-0001d200: 6a65 6374 2077 6974 6820 7468 6520 7265  ject with the re
-0001d210: 7375 6c74 206f 6620 7468 6520 6c6f 6769  sult of the logi
-0001d220: 6361 6c20 4e4f 5420 6f70 6572 6174 696f  cal NOT operatio
-0001d230: 6e2e 0a0a 2020 2020 2020 2020 4578 616d  n...        Exam
-0001d240: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
-0001d250: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
-0001d260: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
-0001d270: 7320 3d20 7b27 6469 6d31 273a 205b 2761  s = {'dim1': ['a
-0001d280: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
-0001d290: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
-0001d2a0: 2020 2020 203e 3e3e 206c 6f6e 6720 3d20       >>> long = 
-0001d2b0: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
-0001d2c0: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-0001d2d0: 2764 696d 3227 3a20 5b31 2c20 325d 7d2c  'dim2': [1, 2]},
-0001d2e0: 2076 616c 7565 3d5b 3130 2c20 3230 5d29   value=[10, 20])
-0001d2f0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-0001d300: 2061 7272 203d 2041 7272 6179 2864 6174   arr = Array(dat
-0001d310: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d63  a=long, coords=c
-0001d320: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
-0001d330: 2020 203e 3e3e 207e 6172 720a 2020 2020     >>> ~arr.    
-0001d340: 2020 2020 2020 2020 4172 7261 7928 6461          Array(da
-0001d350: 7461 3d61 7272 6179 285b 5b2d 3131 2e2c  ta=array([[-11.,
-0001d360: 2020 2d31 2e5d 2c0a 2020 2020 2020 2020    -1.],.        
-0001d370: 2020 2020 2020 2020 2020 205b 202d 312e             [ -1.
-0001d380: 2c20 2d32 312e 5d5d 292c 2063 6f6f 7264  , -21.]]), coord
-0001d390: 733d 7b27 6469 6d31 273a 2061 7272 6179  s={'dim1': array
-0001d3a0: 285b 2761 272c 2027 6227 5d2c 2064 7479  (['a', 'b'], dty
-0001d3b0: 7065 3d6f 626a 6563 7429 2c20 2764 696d  pe=object), 'dim
-0001d3c0: 3227 3a20 6172 7261 7928 5b31 2c20 325d  2': array([1, 2]
-0001d3d0: 297d 290a 0a20 2020 2020 2020 2020 2020  )})..           
-0001d3e0: 2060 6060 0a20 2020 2020 2020 2022 2222   ```.        """
-0001d3f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001d400: 7365 6c66 2e5f 706f 7374 5f6f 7065 7261  self._post_opera
-0001d410: 7469 6f6e 287e 7365 6c66 2e64 6174 612c  tion(~self.data,
-0001d420: 2063 6f6f 7264 733d 7365 6c66 2e63 6f6f   coords=self.coo
-0001d430: 7264 7329 0a0a 2020 2020 6465 6620 5f5f  rds)..    def __
-0001d440: 626f 6f6c 5f5f 2873 656c 6629 202d 3e20  bool__(self) -> 
-0001d450: 626f 6f6c 3a0a 2020 2020 2020 2020 2222  bool:.        ""
-0001d460: 220a 2020 2020 2020 2020 5261 6973 6520  ".        Raise 
-0001d470: 6120 5661 6c75 6545 7272 6f72 2077 6865  a ValueError whe
-0001d480: 6e20 7472 7969 6e67 2074 6f20 636f 6e76  n trying to conv
-0001d490: 6572 7420 616e 2041 7272 6179 2074 6f20  ert an Array to 
-0001d4a0: 6120 626f 6f6c 6561 6e2e 2055 7365 6675  a boolean. Usefu
-0001d4b0: 6c20 746f 2077 6172 6e20 7468 6520 7573  l to warn the us
-0001d4c0: 6572 2074 6f20 696d 706c 656d 656e 7420  er to implement 
-0001d4d0: 2e61 6c6c 2829 206f 7220 2e61 6e79 2829  .all() or .any()
-0001d4e0: 2069 6e73 7465 6164 206f 6620 626f 6f6c   instead of bool
-0001d4f0: 2861 7272 6179 292e 0a0a 2020 2020 2020  (array)...      
-0001d500: 2020 5261 6973 6573 3a0a 2020 2020 2020    Raises:.      
-0001d510: 2020 2020 2020 5661 6c75 6545 7272 6f72        ValueError
-0001d520: 3a20 4361 6e6e 6f74 2063 6f6e 7665 7274  : Cannot convert
-0001d530: 2061 6e20 4172 7261 7920 7769 7468 206d   an Array with m
-0001d540: 6f72 6520 7468 616e 206f 6e65 2065 6c65  ore than one ele
-0001d550: 6d65 6e74 2074 6f20 6120 626f 6f6c 6561  ment to a boolea
-0001d560: 6e2e 0a20 2020 2020 2020 2022 2222 0a20  n..        """. 
-0001d570: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0001d580: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-0001d590: 2020 2020 2022 5468 6520 7472 7574 6820       "The truth 
-0001d5a0: 7661 6c75 6520 6f66 2061 6e20 6172 7261  value of an arra
-0001d5b0: 7920 7769 7468 206d 6f72 6520 7468 616e  y with more than
-0001d5c0: 206f 6e65 2065 6c65 6d65 6e74 2069 7320   one element is 
-0001d5d0: 616d 6269 6775 6f75 732e 2055 7365 2041  ambiguous. Use A
-0001d5e0: 7272 6179 2e61 6e79 2829 206f 7220 4172  rray.any() or Ar
-0001d5f0: 7261 792e 616c 6c28 2922 290a 0a20 2020  ray.all()")..   
-0001d600: 2064 6566 2061 6e79 2873 656c 6629 202d   def any(self) -
-0001d610: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
-0001d620: 2222 220a 2020 2020 2020 2020 4368 6563  """.        Chec
-0001d630: 6b20 6966 2061 6e79 2065 6c65 6d65 6e74  k if any element
-0001d640: 2069 6e20 7468 6520 4172 7261 7920 6973   in the Array is
-0001d650: 2054 7275 652e 0a0a 2020 2020 2020 2020   True...        
-0001d660: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-0001d670: 2020 2020 2054 7275 6520 6966 2061 6e79       True if any
-0001d680: 2065 6c65 6d65 6e74 2069 7320 5472 7565   element is True
-0001d690: 2c20 4661 6c73 6520 6f74 6865 7277 6973  , False otherwis
-0001d6a0: 652e 0a0a 2020 2020 2020 2020 4578 616d  e...        Exam
-0001d6b0: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
-0001d6c0: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
-0001d6d0: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
-0001d6e0: 7320 3d20 7b27 6469 6d31 273a 205b 2761  s = {'dim1': ['a
-0001d6f0: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
-0001d700: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
-0001d710: 2020 2020 203e 3e3e 206c 6f6e 6720 3d20       >>> long = 
-0001d720: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
-0001d730: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-0001d740: 2764 696d 3227 3a20 5b31 2c20 325d 7d2c  'dim2': [1, 2]},
-0001d750: 2076 616c 7565 3d5b 3130 2c20 3230 5d29   value=[10, 20])
-0001d760: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-0001d770: 2061 7272 203d 2041 7272 6179 2864 6174   arr = Array(dat
-0001d780: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d63  a=long, coords=c
-0001d790: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
-0001d7a0: 2020 203e 3e3e 2061 7272 2e61 6e79 2829     >>> arr.any()
-0001d7b0: 0a20 2020 2020 2020 2020 2020 2054 7275  .            Tru
-0001d7c0: 650a 0a20 2020 2020 2020 2020 2020 2060  e..            `
-0001d7d0: 6060 0a20 2020 2020 2020 2022 2222 0a20  ``.        """. 
-0001d7e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001d7f0: 6c66 2e64 6174 612e 616e 7928 290a 0a20  lf.data.any().. 
-0001d800: 2020 2064 6566 2061 6c6c 2873 656c 6629     def all(self)
-0001d810: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
-0001d820: 2020 2222 220a 2020 2020 2020 2020 4368    """.        Ch
-0001d830: 6563 6b20 6966 2061 6c6c 2065 6c65 6d65  eck if all eleme
-0001d840: 6e74 7320 696e 2074 6865 2041 7272 6179  nts in the Array
-0001d850: 2061 7265 2054 7275 652e 0a0a 2020 2020   are True...    
-0001d860: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-0001d870: 2020 2020 2020 2020 2054 7275 6520 6966           True if
-0001d880: 2061 6c6c 2065 6c65 6d65 6e74 7320 6172   all elements ar
-0001d890: 6520 5472 7565 2c20 4661 6c73 6520 6f74  e True, False ot
-0001d8a0: 6865 7277 6973 652e 0a0a 2020 2020 2020  herwise...      
-0001d8b0: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
-0001d8c0: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-0001d8d0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-0001d8e0: 2063 6f6f 7264 7320 3d20 7b27 6469 6d31   coords = {'dim1
-0001d8f0: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
-0001d900: 6469 6d32 273a 205b 312c 2032 5d7d 0a20  dim2': [1, 2]}. 
-0001d910: 2020 2020 2020 2020 2020 203e 3e3e 206c             >>> l
-0001d920: 6f6e 6720 3d20 4c6f 6e67 2869 6e64 6578  ong = Long(index
-0001d930: 3d7b 2764 696d 3127 3a20 5b27 6127 2c20  ={'dim1': ['a', 
-0001d940: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
-0001d950: 2c20 325d 7d2c 2076 616c 7565 3d5b 3130  , 2]}, value=[10
-0001d960: 2c20 3230 5d29 0a20 2020 2020 2020 2020  , 20]).         
-0001d970: 2020 203e 3e3e 2061 7272 203d 2041 7272     >>> arr = Arr
-0001d980: 6179 2864 6174 613d 6c6f 6e67 2c20 636f  ay(data=long, co
-0001d990: 6f72 6473 3d63 6f6f 7264 7329 0a20 2020  ords=coords).   
-0001d9a0: 2020 2020 2020 2020 203e 3e3e 2061 7272           >>> arr
-0001d9b0: 2e61 6c6c 2829 0a20 2020 2020 2020 2020  .all().         
-0001d9c0: 2020 2046 616c 7365 0a0a 2020 2020 2020     False..      
-0001d9d0: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
-0001d9e0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-0001d9f0: 7475 726e 2073 656c 662e 6461 7461 2e61  turn self.data.a
-0001da00: 6c6c 2829 0a0a 2020 2020 6465 6620 746f  ll()..    def to
-0001da10: 5f64 6963 7428 7365 6c66 2c20 6465 6e73  _dict(self, dens
-0001da20: 653a 2062 6f6f 6c20 3d20 4661 6c73 6529  e: bool = False)
-0001da30: 202d 3e20 4469 6374 5b73 7472 2c20 6e70   -> Dict[str, np
-0001da40: 2e6e 6461 7272 6179 5d3a 0a20 2020 2020  .ndarray]:.     
-0001da50: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-0001da60: 6f6e 7665 7274 2074 6865 2041 7272 6179  onvert the Array
-0001da70: 2074 6f20 6120 6469 6374 696f 6e61 7279   to a dictionary
-0001da80: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-0001da90: 0a20 2020 2020 2020 2020 2020 2064 656e  .            den
-0001daa0: 7365 3a20 5768 6574 6865 7220 746f 2063  se: Whether to c
-0001dab0: 6f6e 7665 7274 2074 6865 2064 656e 7365  onvert the dense
-0001dac0: 2072 6570 7265 7365 6e74 6174 696f 6e20   representation 
-0001dad0: 6f66 2074 6865 2041 7272 6179 2e0a 0a20  of the Array... 
-0001dae0: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
-0001daf0: 2020 2020 2020 2020 2020 2020 4120 6469              A di
-0001db00: 6374 696f 6e61 7279 2072 6570 7265 7365  ctionary represe
-0001db10: 6e74 696e 6720 7468 6520 4172 7261 792e  nting the Array.
-0001db20: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-0001db30: 653a 0a20 2020 2020 2020 2020 2020 2060  e:.            `
-0001db40: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-0001db50: 2020 2020 203e 3e3e 2063 6f6f 7264 7320       >>> coords 
-0001db60: 3d20 7b27 6469 6d31 273a 205b 2761 272c  = {'dim1': ['a',
-0001db70: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-0001db80: 312c 2032 5d7d 0a20 2020 2020 2020 2020  1, 2]}.         
-0001db90: 2020 203e 3e3e 206c 6f6e 6720 3d20 4c6f     >>> long = Lo
-0001dba0: 6e67 2869 6e64 6578 3d7b 2764 696d 3127  ng(index={'dim1'
-0001dbb0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
-0001dbc0: 696d 3227 3a20 5b31 2c20 325d 7d2c 2076  im2': [1, 2]}, v
-0001dbd0: 616c 7565 3d5b 3130 2e2c 2032 302e 5d29  alue=[10., 20.])
-0001dbe0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-0001dbf0: 2061 7272 203d 2041 7272 6179 2864 6174   arr = Array(dat
-0001dc00: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d63  a=long, coords=c
-0001dc10: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
-0001dc20: 2020 203e 3e3e 2061 7272 2e74 6f5f 6469     >>> arr.to_di
-0001dc30: 6374 2864 656e 7365 3d54 7275 6529 0a20  ct(dense=True). 
-0001dc40: 2020 2020 2020 2020 2020 207b 2764 696d             {'dim
-0001dc50: 3127 3a20 6172 7261 7928 5b27 6127 2c20  1': array(['a', 
-0001dc60: 2761 272c 2027 6227 2c20 2762 275d 2c20  'a', 'b', 'b'], 
-0001dc70: 6474 7970 653d 6f62 6a65 6374 292c 2027  dtype=object), '
-0001dc80: 6469 6d32 273a 2061 7272 6179 285b 312c  dim2': array([1,
-0001dc90: 2032 2c20 312c 2032 5d29 2c20 2776 616c   2, 1, 2]), 'val
-0001dca0: 7565 273a 2061 7272 6179 285b 3130 2e2c  ue': array([10.,
-0001dcb0: 2020 302e 2c20 2030 2e2c 2032 302e 5d29    0.,  0., 20.])
-0001dcc0: 7d0a 0a20 2020 2020 2020 2020 2020 2060  }..            `
-0001dcd0: 6060 0a20 2020 2020 2020 2022 2222 0a20  ``.        """. 
-0001dce0: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
-0001dcf0: 6174 615f 7479 7065 203d 3d20 2764 656e  ata_type == 'den
-0001dd00: 7365 273a 0a20 2020 2020 2020 2020 2020  se':.           
-0001dd10: 2069 6620 6465 6e73 653a 0a20 2020 2020   if dense:.     
-0001dd20: 2020 2020 2020 2020 2020 2076 616c 7565             value
-0001dd30: 203d 2073 656c 662e 6465 6e73 652e 666c   = self.dense.fl
-0001dd40: 6174 7465 6e28 290a 2020 2020 2020 2020  atten().        
-0001dd50: 2020 2020 2020 2020 6172 7261 795f 6469          array_di
-0001dd60: 6374 203d 2064 6963 7428 7365 6c66 2e64  ct = dict(self.d
-0001dd70: 696e 6465 7828 2929 0a20 2020 2020 2020  index()).       
-0001dd80: 2020 2020 2020 2020 2061 7272 6179 5f64           array_d
-0001dd90: 6963 745b 2776 616c 7565 275d 203d 2076  ict['value'] = v
-0001dda0: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
-0001ddb0: 2020 2020 2072 6574 7572 6e20 6172 7261       return arra
-0001ddc0: 795f 6469 6374 0a20 2020 2020 2020 2020  y_dict.         
-0001ddd0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001dde0: 2020 2020 2020 2020 2072 6177 5f76 616c           raw_val
-0001ddf0: 7565 203d 2073 656c 662e 6465 6e73 652e  ue = self.dense.
-0001de00: 666c 6174 7465 6e28 290a 2020 2020 2020  flatten().      
-0001de10: 2020 2020 2020 2020 2020 6669 6c6c 6572            filler
-0001de20: 2c20 6474 7970 6520 3d20 7365 6c66 2e5f  , dtype = self._
-0001de30: 6669 6c6c 6572 5f61 6e64 5f64 7479 7065  filler_and_dtype
-0001de40: 2872 6177 5f76 616c 7565 2c20 7365 6c66  (raw_value, self
-0001de50: 2e66 696c 6c5f 7661 6c75 6529 0a20 2020  .fill_value).   
-0001de60: 2020 2020 2020 2020 2020 2020 2076 616c               val
-0001de70: 7565 203d 2072 6177 5f76 616c 7565 2e61  ue = raw_value.a
-0001de80: 7374 7970 6528 6474 7970 6529 0a20 2020  stype(dtype).   
-0001de90: 2020 2020 2020 2020 2020 2020 206e 6f6e               non
-0001dea0: 5f6d 6973 7369 6e67 5f6d 6173 6b20 3d20  _missing_mask = 
-0001deb0: 7661 6c75 6520 213d 2066 696c 6c65 720a  value != filler.
-0001dec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ded0: 6172 7261 795f 6469 6374 203d 207b 6469  array_dict = {di
-0001dee0: 6d3a 2069 6e64 6578 5b6e 6f6e 5f6d 6973  m: index[non_mis
-0001def0: 7369 6e67 5f6d 6173 6b5d 2066 6f72 2064  sing_mask] for d
-0001df00: 696d 2c20 696e 6465 7820 696e 2073 656c  im, index in sel
-0001df10: 662e 6469 6e64 6578 2829 7d0a 2020 2020  f.dindex()}.    
-0001df20: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-0001df30: 795f 6469 6374 5b27 7661 6c75 6527 5d20  y_dict['value'] 
-0001df40: 3d20 7661 6c75 655b 6e6f 6e5f 6d69 7373  = value[non_miss
-0001df50: 696e 675f 6d61 736b 5d0a 2020 2020 2020  ing_mask].      
-0001df60: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001df70: 2061 7272 6179 5f64 6963 740a 2020 2020   array_dict.    
-0001df80: 2020 2020 656c 6966 2073 656c 662e 6461      elif self.da
-0001df90: 7461 5f74 7970 6520 3d3d 2027 7370 6172  ta_type == 'spar
-0001dfa0: 7365 273a 0a20 2020 2020 2020 2020 2020  se':.           
-0001dfb0: 2069 6620 6465 6e73 653a 0a20 2020 2020   if dense:.     
-0001dfc0: 2020 2020 2020 2020 2020 2076 616c 7565             value
-0001dfd0: 203d 2073 656c 662e 746f 6465 6e73 6528   = self.todense(
-0001dfe0: 292e 666c 6174 7465 6e28 290a 2020 2020  ).flatten().    
-0001dff0: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-0001e000: 795f 6469 6374 203d 2064 6963 7428 7365  y_dict = dict(se
-0001e010: 6c66 2e64 696e 6465 7828 2929 0a20 2020  lf.dindex()).   
-0001e020: 2020 2020 2020 2020 2020 2020 2061 7272               arr
-0001e030: 6179 5f64 6963 745b 2776 616c 7565 275d  ay_dict['value']
-0001e040: 203d 2076 616c 7565 0a20 2020 2020 2020   = value.       
-0001e050: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001e060: 6172 7261 795f 6469 6374 0a20 2020 2020  array_dict.     
-0001e070: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001e080: 2020 2020 2020 2020 2020 2020 2076 616c               val
-0001e090: 7565 203d 2073 656c 662e 7370 6172 7365  ue = self.sparse
-0001e0a0: 2e64 6174 610a 2020 2020 2020 2020 2020  .data.          
-0001e0b0: 2020 2020 2020 6172 7261 795f 6469 6374        array_dict
-0001e0c0: 203d 2064 6963 7428 7365 6c66 2e73 696e   = dict(self.sin
-0001e0d0: 6465 7828 2929 0a20 2020 2020 2020 2020  dex()).         
-0001e0e0: 2020 2020 2020 2061 7272 6179 5f64 6963         array_dic
-0001e0f0: 745b 2776 616c 7565 275d 203d 2076 616c  t['value'] = val
-0001e100: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-0001e110: 2020 2072 6574 7572 6e20 6172 7261 795f     return array_
-0001e120: 6469 6374 0a0a 2020 2020 6465 6620 746f  dict..    def to
-0001e130: 5f70 616e 6461 7328 7365 6c66 2c20 6465  _pandas(self, de
-0001e140: 6e73 653a 2062 6f6f 6c20 3d20 4e6f 6e65  nse: bool = None
-0001e150: 2920 2d3e 2027 7064 2e44 6174 6146 7261  ) -> 'pd.DataFra
-0001e160: 6d65 273a 0a20 2020 2020 2020 2022 2222  me':.        """
-0001e170: 0a20 2020 2020 2020 2043 6f6e 7665 7274  .        Convert
-0001e180: 2074 6865 2041 7272 6179 2074 6f20 6120   the Array to a 
-0001e190: 7061 6e64 6173 2044 6174 6146 7261 6d65  pandas DataFrame
-0001e1a0: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-0001e1b0: 0a20 2020 2020 2020 2020 2020 2064 656e  .            den
-0001e1c0: 7365 3a20 5768 6574 6865 7220 746f 2063  se: Whether to c
-0001e1d0: 6f6e 7665 7274 2074 6865 2041 7272 6179  onvert the Array
-0001e1e0: 2074 6f20 6120 6465 6e73 6520 4461 7461   to a dense Data
-0001e1f0: 4672 616d 652e 2049 6620 4e6f 6e65 2c20  Frame. If None, 
-0001e200: 7573 6520 7468 6520 6465 6661 756c 7420  use the default 
-0001e210: 7365 7474 696e 672e 0a0a 2020 2020 2020  setting...      
-0001e220: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-0001e230: 2020 2020 2020 2041 2070 616e 6461 7320         A pandas 
-0001e240: 4461 7461 4672 616d 6520 7265 7072 6573  DataFrame repres
-0001e250: 656e 7469 6e67 2074 6865 2041 7272 6179  enting the Array
-0001e260: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-0001e270: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-0001e280: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
-0001e290: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
-0001e2a0: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
-0001e2b0: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
-0001e2c0: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
-0001e2d0: 2020 2020 3e3e 3e20 6c6f 6e67 203d 204c      >>> long = L
-0001e2e0: 6f6e 6728 696e 6465 783d 7b27 6469 6d31  ong(index={'dim1
-0001e2f0: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
-0001e300: 6469 6d32 273a 205b 312c 2032 5d7d 2c20  dim2': [1, 2]}, 
-0001e310: 7661 6c75 653d 5b31 302c 2032 305d 290a  value=[10, 20]).
-0001e320: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-0001e330: 6172 7220 3d20 4172 7261 7928 6461 7461  arr = Array(data
-0001e340: 3d6c 6f6e 672c 2063 6f6f 7264 733d 636f  =long, coords=co
-0001e350: 6f72 6473 290a 2020 2020 2020 2020 2020  ords).          
-0001e360: 2020 3e3e 3e20 6466 203d 2061 7272 2e74    >>> df = arr.t
-0001e370: 6f5f 7061 6e64 6173 2864 656e 7365 3d54  o_pandas(dense=T
-0001e380: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
-0001e390: 203e 3e3e 2064 660a 2020 2020 2020 2020   >>> df.        
-0001e3a0: 2020 2020 2020 6469 6d31 2020 6469 6d32        dim1  dim2
-0001e3b0: 2020 7661 6c75 650a 2020 2020 2020 2020    value.        
-0001e3c0: 2020 2020 3020 2020 2061 2020 2020 2031      0    a     1
-0001e3d0: 2020 2020 2031 300a 2020 2020 2020 2020       10.        
-0001e3e0: 2020 2020 3120 2020 2061 2020 2020 2032      1    a     2
-0001e3f0: 2020 2020 2020 300a 2020 2020 2020 2020        0.        
-0001e400: 2020 2020 3220 2020 2062 2020 2020 2031      2    b     1
-0001e410: 2020 2020 2020 300a 2020 2020 2020 2020        0.        
-0001e420: 2020 2020 3320 2020 2062 2020 2020 2032      3    b     2
-0001e430: 2020 2020 2032 300a 0a20 2020 2020 2020       20..       
-0001e440: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-0001e450: 2022 2222 0a20 2020 2020 2020 2064 6174   """.        dat
-0001e460: 6166 7261 6d65 5f61 735f 6465 6e73 6520  aframe_as_dense 
-0001e470: 3d20 5472 7565 2069 6620 7365 6c66 2e64  = True if self.d
-0001e480: 6174 6166 7261 6d65 5f61 7320 3d3d 2022  ataframe_as == "
-0001e490: 6465 6e73 6522 2065 6c73 6520 4661 6c73  dense" else Fals
-0001e4a0: 650a 2020 2020 2020 2020 7370 6172 7365  e.        sparse
-0001e4b0: 5f74 6f5f 6465 6e73 6520 3d20 6461 7461  _to_dense = data
-0001e4c0: 6672 616d 655f 6173 5f64 656e 7365 2069  frame_as_dense i
-0001e4d0: 6620 6465 6e73 6520 6973 204e 6f6e 6520  f dense is None 
-0001e4e0: 656c 7365 2064 656e 7365 0a20 2020 2020  else dense.     
-0001e4f0: 2020 2072 6574 7572 6e20 7064 2e44 6174     return pd.Dat
-0001e500: 6146 7261 6d65 2873 656c 662e 746f 5f64  aFrame(self.to_d
-0001e510: 6963 7428 6465 6e73 653d 7370 6172 7365  ict(dense=sparse
-0001e520: 5f74 6f5f 6465 6e73 6529 290a 0a20 2020  _to_dense))..   
-0001e530: 2064 6566 2074 6f5f 706f 6c61 7273 2873   def to_polars(s
-0001e540: 656c 662c 2064 656e 7365 3a20 626f 6f6c  elf, dense: bool
-0001e550: 203d 204e 6f6e 6529 202d 3e20 2770 6c2e   = None) -> 'pl.
-0001e560: 4461 7461 4672 616d 6527 3a0a 2020 2020  DataFrame':.    
-0001e570: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001e580: 436f 6e76 6572 7420 7468 6520 4172 7261  Convert the Arra
-0001e590: 7920 746f 2061 2070 6f6c 6172 7320 4461  y to a polars Da
-0001e5a0: 7461 4672 616d 652e 0a0a 2020 2020 2020  taFrame...      
-0001e5b0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-0001e5c0: 2020 2020 6465 6e73 653a 2057 6865 7468      dense: Wheth
-0001e5d0: 6572 2074 6f20 636f 6e76 6572 7420 7468  er to convert th
-0001e5e0: 6520 4172 7261 7920 746f 2061 2064 656e  e Array to a den
-0001e5f0: 7365 2044 6174 6146 7261 6d65 2e20 4966  se DataFrame. If
-0001e600: 204e 6f6e 652c 2075 7365 2074 6865 2064   None, use the d
-0001e610: 6566 6175 6c74 2073 6574 7469 6e67 2e0a  efault setting..
-0001e620: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0001e630: 3a0a 2020 2020 2020 2020 2020 2020 4120  :.            A 
-0001e640: 706f 6c61 7273 2044 6174 6146 7261 6d65  polars DataFrame
-0001e650: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-0001e660: 6520 4172 7261 792e 0a0a 2020 2020 2020  e Array...      
-0001e670: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
-0001e680: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-0001e690: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-0001e6a0: 2063 6f6f 7264 7320 3d20 7b27 6469 6d31   coords = {'dim1
-0001e6b0: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
-0001e6c0: 6469 6d32 273a 205b 312c 2032 5d7d 0a20  dim2': [1, 2]}. 
-0001e6d0: 2020 2020 2020 2020 2020 203e 3e3e 206c             >>> l
-0001e6e0: 6f6e 6720 3d20 4c6f 6e67 2869 6e64 6578  ong = Long(index
-0001e6f0: 3d7b 2764 696d 3127 3a20 5b27 6127 2c20  ={'dim1': ['a', 
-0001e700: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
-0001e710: 2c20 325d 7d2c 2076 616c 7565 3d5b 3130  , 2]}, value=[10
-0001e720: 2c20 3230 5d29 0a20 2020 2020 2020 2020  , 20]).         
-0001e730: 2020 203e 3e3e 2061 7272 203d 2041 7272     >>> arr = Arr
-0001e740: 6179 2864 6174 613d 6c6f 6e67 2c20 636f  ay(data=long, co
-0001e750: 6f72 6473 3d63 6f6f 7264 7329 0a20 2020  ords=coords).   
-0001e760: 2020 2020 2020 2020 203e 3e3e 2064 6620           >>> df 
-0001e770: 3d20 6172 722e 746f 5f70 6f6c 6172 7328  = arr.to_polars(
-0001e780: 6465 6e73 653d 4661 6c73 6529 0a20 2020  dense=False).   
-0001e790: 2020 2020 2020 2020 203e 3e3e 2064 660a           >>> df.
-0001e7a0: 2020 2020 2020 2020 2020 2020 7368 6170              shap
-0001e7b0: 653a 2028 322c 2033 290a 2020 2020 2020  e: (2, 3).      
-0001e7c0: 2020 2020 2020 e294 8ce2 9480 e294 80e2        ..........
-0001e7d0: 9480 e294 80e2 9480 e294 80e2 94ac e294  ................
-0001e7e0: 80e2 9480 e294 80e2 9480 e294 80e2 9480  ................
-0001e7f0: e294 ace2 9480 e294 80e2 9480 e294 80e2  ................
-0001e800: 9480 e294 80e2 9480 e294 900a 2020 2020  ............    
-0001e810: 2020 2020 2020 2020 e294 8220 6469 6d31          ... dim1
-0001e820: 20e2 9486 2064 696d 3220 e294 8620 7661   ... dim2 ... va
-0001e830: 6c75 6520 e294 820a 2020 2020 2020 2020  lue ....        
-0001e840: 2020 2020 e294 8220 2d2d 2d20 20e2 9486      ... ---  ...
-0001e850: 202d 2d2d 2020 e294 8620 2d2d 2d20 2020   ---  ... ---   
-0001e860: e294 820a 2020 2020 2020 2020 2020 2020  ....            
-0001e870: e294 8220 7374 7220 20e2 9486 2069 3332  ... str  ... i32
-0001e880: 2020 e294 8620 6936 3420 2020 e294 820a    ... i64   ....
-0001e890: 2020 2020 2020 2020 2020 2020 e295 9ee2              ....
-0001e8a0: 9590 e295 90e2 9590 e295 90e2 9590 e295  ................
-0001e8b0: 90e2 95aa e295 90e2 9590 e295 90e2 9590  ................
-0001e8c0: e295 90e2 9590 e295 aae2 9590 e295 90e2  ................
-0001e8d0: 9590 e295 90e2 9590 e295 90e2 9590 e295  ................
-0001e8e0: a10a 2020 2020 2020 2020 2020 2020 e294  ..            ..
-0001e8f0: 8220 6120 2020 20e2 9486 2031 2020 2020  . a    ... 1    
-0001e900: e294 8620 3130 2020 2020 e294 820a 2020  ... 10    ....  
-0001e910: 2020 2020 2020 2020 2020 e294 8220 6220            ... b 
-0001e920: 2020 20e2 9486 2032 2020 2020 e294 8620     ... 2    ... 
-0001e930: 3230 2020 2020 e294 820a 2020 2020 2020  20    ....      
-0001e940: 2020 2020 2020 e294 94e2 9480 e294 80e2        ..........
-0001e950: 9480 e294 80e2 9480 e294 80e2 94b4 e294  ................
-0001e960: 80e2 9480 e294 80e2 9480 e294 80e2 9480  ................
-0001e970: e294 b4e2 9480 e294 80e2 9480 e294 80e2  ................
-0001e980: 9480 e294 80e2 9480 e294 980a 0a20 2020  .............   
-0001e990: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
-0001e9a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001e9b0: 2064 6174 6166 7261 6d65 5f61 735f 6465   dataframe_as_de
-0001e9c0: 6e73 6520 3d20 5472 7565 2069 6620 7365  nse = True if se
-0001e9d0: 6c66 2e64 6174 6166 7261 6d65 5f61 7320  lf.dataframe_as 
-0001e9e0: 3d3d 2022 6465 6e73 6522 2065 6c73 6520  == "dense" else 
-0001e9f0: 4661 6c73 650a 2020 2020 2020 2020 7370  False.        sp
-0001ea00: 6172 7365 5f74 6f5f 6465 6e73 6520 3d20  arse_to_dense = 
-0001ea10: 6461 7461 6672 616d 655f 6173 5f64 656e  dataframe_as_den
-0001ea20: 7365 2069 6620 6465 6e73 6520 6973 204e  se if dense is N
-0001ea30: 6f6e 6520 656c 7365 2064 656e 7365 0a20  one else dense. 
-0001ea40: 2020 2020 2020 2072 6574 7572 6e20 706c         return pl
-0001ea50: 2e66 726f 6d5f 6469 6374 2873 656c 662e  .from_dict(self.
-0001ea60: 746f 5f64 6963 7428 6465 6e73 653d 7370  to_dict(dense=sp
-0001ea70: 6172 7365 5f74 6f5f 6465 6e73 6529 290a  arse_to_dense)).
-0001ea80: 0a20 2020 2064 6566 2074 6f5f 6461 7461  .    def to_data
-0001ea90: 6672 616d 6528 7365 6c66 2c20 6465 6e73  frame(self, dens
-0001eaa0: 653a 2062 6f6f 6c20 3d20 4e6f 6e65 2c20  e: bool = None, 
-0001eab0: 7769 7468 5f3a 2073 7472 203d 2027 7061  with_: str = 'pa
-0001eac0: 6e64 6173 2729 202d 3e20 556e 696f 6e5b  ndas') -> Union[
-0001ead0: 2770 642e 4461 7461 4672 616d 6527 2c20  'pd.DataFrame', 
-0001eae0: 2770 6c2e 4461 7461 4672 616d 6527 5d3a  'pl.DataFrame']:
-0001eaf0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001eb00: 2020 2020 2043 6f6e 7665 7274 2074 6865       Convert the
-0001eb10: 2041 7272 6179 2074 6f20 6120 4461 7461   Array to a Data
-0001eb20: 4672 616d 6520 7573 696e 6720 7468 6520  Frame using the 
-0001eb30: 7370 6563 6966 6965 6420 6c69 6272 6172  specified librar
-0001eb40: 792e 0a0a 2020 2020 2020 2020 4172 6773  y...        Args
-0001eb50: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
-0001eb60: 6e73 653a 2057 6865 7468 6572 2074 6f20  nse: Whether to 
-0001eb70: 636f 6e76 6572 7420 7468 6520 4172 7261  convert the Arra
-0001eb80: 7920 746f 2061 2064 656e 7365 2044 6174  y to a dense Dat
-0001eb90: 6146 7261 6d65 2e20 4966 204e 6f6e 652c  aFrame. If None,
-0001eba0: 2075 7365 2074 6865 2064 6566 6175 6c74   use the default
-0001ebb0: 2073 6574 7469 6e67 2e0a 2020 2020 2020   setting..      
-0001ebc0: 2020 2020 2020 7769 7468 5f3a 2054 6865        with_: The
-0001ebd0: 206c 6962 7261 7279 2074 6f20 7573 6520   library to use 
-0001ebe0: 666f 7220 6372 6561 7469 6e67 2074 6865  for creating the
-0001ebf0: 2044 6174 6146 7261 6d65 2e20 4361 6e20   DataFrame. Can 
-0001ec00: 6265 2027 7061 6e64 6173 2720 6f72 2027  be 'pandas' or '
-0001ec10: 706f 6c61 7273 272e 0a0a 2020 2020 2020  polars'...      
-0001ec20: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-0001ec30: 2020 2020 2020 2041 2044 6174 6146 7261         A DataFra
-0001ec40: 6d65 2072 6570 7265 7365 6e74 696e 6720  me representing 
-0001ec50: 7468 6520 4172 7261 792c 2063 7265 6174  the Array, creat
-0001ec60: 6564 2075 7369 6e67 2074 6865 2073 7065  ed using the spe
-0001ec70: 6369 6669 6564 206c 6962 7261 7279 2e0a  cified library..
-0001ec80: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-0001ec90: 3a0a 2020 2020 2020 2020 2020 2020 6060  :.            ``
-0001eca0: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
-0001ecb0: 2020 2020 3e3e 3e20 636f 6f72 6473 203d      >>> coords =
-0001ecc0: 207b 2764 696d 3127 3a20 5b27 6127 2c20   {'dim1': ['a', 
-0001ecd0: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
-0001ece0: 2c20 325d 7d0a 2020 2020 2020 2020 2020  , 2]}.          
-0001ecf0: 2020 3e3e 3e20 6c6f 6e67 203d 204c 6f6e    >>> long = Lon
-0001ed00: 6728 696e 6465 783d 7b27 6469 6d31 273a  g(index={'dim1':
-0001ed10: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
-0001ed20: 6d32 273a 205b 312c 2032 5d7d 2c20 7661  m2': [1, 2]}, va
-0001ed30: 6c75 653d 5b31 302c 2032 305d 290a 2020  lue=[10, 20]).  
-0001ed40: 2020 2020 2020 2020 2020 3e3e 3e20 6172            >>> ar
-0001ed50: 7220 3d20 4172 7261 7928 6461 7461 3d6c  r = Array(data=l
-0001ed60: 6f6e 672c 2063 6f6f 7264 733d 636f 6f72  ong, coords=coor
-0001ed70: 6473 290a 2020 2020 2020 2020 2020 2020  ds).            
-0001ed80: 3e3e 3e20 6466 203d 2061 7272 2e74 6f5f  >>> df = arr.to_
-0001ed90: 6461 7461 6672 616d 6528 6465 6e73 653d  dataframe(dense=
-0001eda0: 4661 6c73 652c 2077 6974 685f 3d27 7061  False, with_='pa
-0001edb0: 6e64 6173 2729 0a20 2020 2020 2020 2020  ndas').         
-0001edc0: 2020 203e 3e3e 2064 660a 2020 2020 2020     >>> df.      
-0001edd0: 2020 2020 2020 2020 6469 6d31 2020 6469          dim1  di
-0001ede0: 6d32 2020 7661 6c75 650a 2020 2020 2020  m2  value.      
-0001edf0: 2020 2020 2020 3020 2020 2061 2020 2020        0    a    
-0001ee00: 2031 2020 2020 2031 300a 2020 2020 2020   1     10.      
-0001ee10: 2020 2020 2020 3120 2020 2062 2020 2020        1    b    
-0001ee20: 2032 2020 2020 2032 300a 0a20 2020 2020   2     20..     
-0001ee30: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
-0001ee40: 2020 2022 2222 0a20 2020 2020 2020 2061     """.        a
-0001ee50: 7373 6572 7420 7769 7468 5f20 696e 205b  ssert with_ in [
-0001ee60: 2770 616e 6461 7327 2c20 2770 6f6c 6172  'pandas', 'polar
-0001ee70: 7327 5d0a 2020 2020 2020 2020 6966 2077  s'].        if w
-0001ee80: 6974 685f 203d 3d20 2270 616e 6461 7322  ith_ == "pandas"
-0001ee90: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0001eea0: 7475 726e 2073 656c 662e 746f 5f70 616e  turn self.to_pan
-0001eeb0: 6461 7328 6465 6e73 653d 6465 6e73 6529  das(dense=dense)
-0001eec0: 0a20 2020 2020 2020 2065 6c69 6620 7769  .        elif wi
-0001eed0: 7468 5f20 3d3d 2022 706f 6c61 7273 223a  th_ == "polars":
-0001eee0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001eef0: 7572 6e20 7365 6c66 2e74 6f5f 706f 6c61  urn self.to_pola
-0001ef00: 7273 2864 656e 7365 3d64 656e 7365 290a  rs(dense=dense).
-0001ef10: 0a20 2020 2064 6566 2074 6f5f 6172 726f  .    def to_arro
-0001ef20: 7728 7365 6c66 2920 2d3e 2027 7061 2e54  w(self) -> 'pa.T
-0001ef30: 6162 6c65 273a 0a20 2020 2020 2020 2022  able':.        "
-0001ef40: 2222 0a20 2020 2020 2020 2043 6f6e 7665  "".        Conve
-0001ef50: 7274 2074 6865 2041 7272 6179 2074 6f20  rt the Array to 
-0001ef60: 616e 2041 7061 6368 6520 4172 726f 7720  an Apache Arrow 
-0001ef70: 5461 626c 652e 0a0a 2020 2020 2020 2020  Table...        
-0001ef80: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-0001ef90: 2020 2020 2041 6e20 4170 6163 6865 2041       An Apache A
-0001efa0: 7272 6f77 2054 6162 6c65 2072 6570 7265  rrow Table repre
-0001efb0: 7365 6e74 696e 6720 7468 6520 4172 7261  senting the Arra
-0001efc0: 792e 0a0a 2020 2020 2020 2020 4578 616d  y...        Exam
-0001efd0: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
-0001efe0: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
-0001eff0: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
-0001f000: 7320 3d20 7b27 6469 6d31 273a 205b 2761  s = {'dim1': ['a
-0001f010: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
-0001f020: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
-0001f030: 2020 2020 203e 3e3e 206c 6f6e 6720 3d20       >>> long = 
-0001f040: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
-0001f050: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-0001f060: 2764 696d 3227 3a20 5b31 2c20 325d 7d2c  'dim2': [1, 2]},
-0001f070: 2076 616c 7565 3d5b 3130 2c20 3230 5d29   value=[10, 20])
-0001f080: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-0001f090: 2061 7272 203d 2041 7272 6179 2864 6174   arr = Array(dat
-0001f0a0: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d63  a=long, coords=c
-0001f0b0: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
-0001f0c0: 2020 203e 3e3e 2074 6162 6c65 203d 2061     >>> table = a
-0001f0d0: 7272 2e74 6f5f 6172 726f 7728 290a 2020  rr.to_arrow().  
-0001f0e0: 2020 2020 2020 2020 2020 3e3e 3e20 7461            >>> ta
-0001f0f0: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
-0001f100: 7079 6172 726f 772e 5461 626c 650a 2020  pyarrow.Table.  
-0001f110: 2020 2020 2020 2020 2020 6469 6d31 3a20            dim1: 
-0001f120: 7374 7269 6e67 0a20 2020 2020 2020 2020  string.         
-0001f130: 2020 2064 696d 323a 2069 6e74 3332 0a20     dim2: int32. 
-0001f140: 2020 2020 2020 2020 2020 2076 616c 7565             value
-0001f150: 3a20 696e 7436 340a 2020 2020 2020 2020  : int64.        
-0001f160: 2020 2020 2d2d 2d2d 0a20 2020 2020 2020      ----.       
-0001f170: 2020 2020 2064 696d 313a 205b 5b22 6122       dim1: [["a"
-0001f180: 2c22 6222 5d5d 0a20 2020 2020 2020 2020  ,"b"]].         
-0001f190: 2020 2064 696d 323a 205b 5b31 2c32 5d5d     dim2: [[1,2]]
-0001f1a0: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-0001f1b0: 7565 3a20 5b5b 3130 2c32 305d 5d0a 0a20  ue: [[10,20]].. 
-0001f1c0: 2020 2020 2020 2020 2020 2060 6060 0a20             ```. 
-0001f1d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001f1e0: 2020 2074 6162 6c65 203d 2070 612e 5461     table = pa.Ta
-0001f1f0: 626c 652e 6672 6f6d 5f70 7964 6963 7428  ble.from_pydict(
-0001f200: 7365 6c66 2e74 6f5f 6469 6374 2829 290a  self.to_dict()).
-0001f210: 2020 2020 2020 2020 6375 7374 6f6d 5f6d          custom_m
-0001f220: 6574 615f 6b65 7920 3d20 276b 6172 7261  eta_key = 'karra
-0001f230: 7927 0a20 2020 2020 2020 2063 7573 746f  y'.        custo
-0001f240: 6d5f 6d65 7461 6461 7461 203d 207b 2763  m_metadata = {'c
-0001f250: 6f6f 7264 7327 3a20 7b64 696d 3a20 7365  oords': {dim: se
-0001f260: 6c66 2e63 6f6f 7264 735b 6469 6d5d 2e74  lf.coords[dim].t
-0001f270: 6f6c 6973 7428 2920 666f 7220 6469 6d20  olist() for dim 
-0001f280: 696e 2073 656c 662e 636f 6f72 6473 7d7d  in self.coords}}
-0001f290: 0a20 2020 2020 2020 2063 7573 746f 6d5f  .        custom_
-0001f2a0: 6d65 7461 5f6a 736f 6e20 3d20 6a73 6f6e  meta_json = json
-0001f2b0: 2e64 756d 7073 2863 7573 746f 6d5f 6d65  .dumps(custom_me
-0001f2c0: 7461 6461 7461 290a 2020 2020 2020 2020  tadata).        
-0001f2d0: 6578 6973 7469 6e67 5f6d 6574 6120 3d20  existing_meta = 
-0001f2e0: 7461 626c 652e 7363 6865 6d61 2e6d 6574  table.schema.met
-0001f2f0: 6164 6174 6120 6966 2074 6162 6c65 2e73  adata if table.s
-0001f300: 6368 656d 612e 6d65 7461 6461 7461 2069  chema.metadata i
-0001f310: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-0001f320: 7b7d 0a20 2020 2020 2020 2063 6f6d 6269  {}.        combi
-0001f330: 6e65 645f 6d65 7461 203d 207b 6375 7374  ned_meta = {cust
-0001f340: 6f6d 5f6d 6574 615f 6b65 792e 656e 636f  om_meta_key.enco
-0001f350: 6465 2829 3a20 6375 7374 6f6d 5f6d 6574  de(): custom_met
-0001f360: 615f 6a73 6f6e 2e65 6e63 6f64 6528 292c  a_json.encode(),
-0001f370: 202a 2a65 7869 7374 696e 675f 6d65 7461   **existing_meta
-0001f380: 7d0a 2020 2020 2020 2020 7265 7475 726e  }.        return
-0001f390: 2074 6162 6c65 2e72 6570 6c61 6365 5f73   table.replace_s
-0001f3a0: 6368 656d 615f 6d65 7461 6461 7461 2863  chema_metadata(c
-0001f3b0: 6f6d 6269 6e65 645f 6d65 7461 290a 0a20  ombined_meta).. 
-0001f3c0: 2020 2064 6566 2074 6f5f 6665 6174 6865     def to_feathe
-0001f3d0: 7228 7365 6c66 2c20 7061 7468 3a20 7374  r(self, path: st
-0001f3e0: 7229 202d 3e20 4e6f 6e65 3a0a 2020 2020  r) -> None:.    
-0001f3f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001f400: 5361 7665 2074 6865 2041 7272 6179 2074  Save the Array t
-0001f410: 6f20 6120 4665 6174 6865 7220 6669 6c65  o a Feather file
-0001f420: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-0001f430: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-0001f440: 683a 2054 6865 2070 6174 6820 746f 2073  h: The path to s
-0001f450: 6176 6520 7468 6520 4665 6174 6865 7220  ave the Feather 
-0001f460: 6669 6c65 2e0a 0a20 2020 2020 2020 2045  file...        E
-0001f470: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-0001f480: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
-0001f490: 2020 2020 2020 2020 2020 3e3e 3e20 636f            >>> co
-0001f4a0: 6f72 6473 203d 207b 2764 696d 3127 3a20  ords = {'dim1': 
-0001f4b0: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
-0001f4c0: 3227 3a20 5b31 2c20 325d 7d0a 2020 2020  2': [1, 2]}.    
-0001f4d0: 2020 2020 2020 2020 3e3e 3e20 6c6f 6e67          >>> long
-0001f4e0: 203d 204c 6f6e 6728 696e 6465 783d 7b27   = Long(index={'
-0001f4f0: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
-0001f500: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
-0001f510: 5d7d 2c20 7661 6c75 653d 5b31 302c 2032  ]}, value=[10, 2
-0001f520: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-0001f530: 3e3e 3e20 6172 7220 3d20 4172 7261 7928  >>> arr = Array(
-0001f540: 6461 7461 3d6c 6f6e 672c 2063 6f6f 7264  data=long, coord
-0001f550: 733d 636f 6f72 6473 290a 2020 2020 2020  s=coords).      
-0001f560: 2020 2020 2020 3e3e 3e20 6172 722e 746f        >>> arr.to
-0001f570: 5f66 6561 7468 6572 2827 7465 7374 732f  _feather('tests/
-0001f580: 6461 7461 2f61 7272 6179 2e66 6561 7468  data/array.feath
-0001f590: 6572 2729 0a0a 2020 2020 2020 2020 2020  er')..          
-0001f5a0: 2020 6060 600a 2020 2020 2020 2020 2222    ```.        ""
-0001f5b0: 220a 2020 2020 2020 2020 7461 626c 6520  ".        table 
-0001f5c0: 3d20 7365 6c66 2e74 6f5f 6172 726f 7728  = self.to_arrow(
-0001f5d0: 290a 2020 2020 2020 2020 6665 6174 6865  ).        feathe
-0001f5e0: 722e 7772 6974 655f 6665 6174 6865 7228  r.write_feather(
-0001f5f0: 7461 626c 652c 2070 6174 6829 0a20 2020  table, path).   
-0001f600: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-0001f610: 0a0a 2020 2020 6465 6620 746f 5f63 7376  ..    def to_csv
-0001f620: 2873 656c 662c 2070 6174 683a 2073 7472  (self, path: str
-0001f630: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0001f640: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
-0001f650: 6176 6520 7468 6520 4172 7261 7920 746f  ave the Array to
-0001f660: 2061 2043 5356 2066 696c 652e 0a0a 2020   a CSV file...  
-0001f670: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
-0001f680: 2020 2020 2020 2020 7061 7468 3a20 5468          path: Th
-0001f690: 6520 7061 7468 2074 6f20 7361 7665 2074  e path to save t
-0001f6a0: 6865 2043 5356 2066 696c 652e 0a0a 2020  he CSV file...  
-0001f6b0: 2020 2020 2020 4578 616d 706c 653a 0a20        Example:. 
-0001f6c0: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
-0001f6d0: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
-0001f6e0: 203e 3e3e 2063 6f6f 7264 7320 3d20 7b27   >>> coords = {'
-0001f6f0: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
-0001f700: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
-0001f710: 5d7d 0a20 2020 2020 2020 2020 2020 203e  ]}.            >
-0001f720: 3e3e 206c 6f6e 6720 3d20 4c6f 6e67 2869  >> long = Long(i
-0001f730: 6e64 6578 3d7b 2764 696d 3127 3a20 5b27  ndex={'dim1': ['
-0001f740: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
-0001f750: 3a20 5b31 2c20 325d 7d2c 2076 616c 7565  : [1, 2]}, value
-0001f760: 3d5b 3130 2c20 3230 5d29 0a20 2020 2020  =[10, 20]).     
-0001f770: 2020 2020 2020 203e 3e3e 2061 7272 203d         >>> arr =
-0001f780: 2041 7272 6179 2864 6174 613d 6c6f 6e67   Array(data=long
-0001f790: 2c20 636f 6f72 6473 3d63 6f6f 7264 7329  , coords=coords)
-0001f7a0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-0001f7b0: 2061 7272 2e74 6f5f 6373 7628 2774 6573   arr.to_csv('tes
-0001f7c0: 7473 2f64 6174 612f 6172 7261 792e 6373  ts/data/array.cs
-0001f7d0: 7627 290a 0a20 2020 2020 2020 2020 2020  v')..           
-0001f7e0: 2060 6060 0a20 2020 2020 2020 2022 2222   ```.        """
-0001f7f0: 0a20 2020 2020 2020 2074 6162 6c65 203d  .        table =
-0001f800: 2073 656c 662e 746f 5f61 7272 6f77 2829   self.to_arrow()
-0001f810: 0a20 2020 2020 2020 2074 6162 6c65 2e74  .        table.t
-0001f820: 6f5f 7061 6e64 6173 2829 2e74 6f5f 6373  o_pandas().to_cs
-0001f830: 7628 7061 7468 2c20 696e 6465 783d 4661  v(path, index=Fa
-0001f840: 6c73 6529 0a20 2020 2020 2020 2072 6574  lse).        ret
-0001f850: 7572 6e20 4e6f 6e65 0a0a 2020 2020 6465  urn None..    de
-0001f860: 6620 7368 7269 6e6b 2873 656c 662c 202a  f shrink(self, *
-0001f870: 2a6b 7761 7267 733a 2055 6e69 6f6e 5b4c  *kwargs: Union[L
-0001f880: 6973 745b 416e 795d 2c20 6e70 2e6e 6461  ist[Any], np.nda
-0001f890: 7272 6179 5d29 202d 3e20 2741 7272 6179  rray]) -> 'Array
-0001f8a0: 273a 0a20 2020 2020 2020 2022 2222 0a20  ':.        """. 
-0001f8b0: 2020 2020 2020 2053 6872 696e 6b20 7468         Shrink th
-0001f8c0: 6520 4172 7261 7920 6279 2073 656c 6563  e Array by selec
-0001f8d0: 7469 6e67 2073 7065 6369 6669 6320 656c  ting specific el
-0001f8e0: 656d 656e 7473 2066 726f 6d20 7468 6520  ements from the 
-0001f8f0: 7370 6563 6966 6965 6420 6469 6d65 6e73  specified dimens
-0001f900: 696f 6e73 2e0a 0a20 2020 2020 2020 2041  ions...        A
-0001f910: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-0001f920: 202a 2a6b 7761 7267 733a 204b 6579 776f   **kwargs: Keywo
-0001f930: 7264 2061 7267 756d 656e 7473 2073 7065  rd arguments spe
-0001f940: 6369 6679 696e 6720 7468 6520 6469 6d65  cifying the dime
-0001f950: 6e73 696f 6e73 2061 6e64 2065 6c65 6d65  nsions and eleme
-0001f960: 6e74 7320 746f 206b 6565 702e 0a0a 2020  nts to keep...  
-0001f970: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
-0001f980: 2020 2020 2020 2020 2020 2041 206e 6577             A new
-0001f990: 2041 7272 6179 206f 626a 6563 7420 7769   Array object wi
-0001f9a0: 7468 2074 6865 2073 656c 6563 7465 6420  th the selected 
-0001f9b0: 656c 656d 656e 7473 2e0a 0a20 2020 2020  elements...     
-0001f9c0: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-0001f9d0: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-0001f9e0: 6e0a 2020 2020 2020 2020 2020 2020 3e3e  n.            >>
-0001f9f0: 3e20 636f 6f72 6473 203d 207b 2764 696d  > coords = {'dim
-0001fa00: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-0001fa10: 2764 696d 3227 3a20 5b31 2c20 325d 7d0a  'dim2': [1, 2]}.
-0001fa20: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-0001fa30: 6c6f 6e67 203d 204c 6f6e 6728 696e 6465  long = Long(inde
-0001fa40: 783d 7b27 6469 6d31 273a 205b 2761 272c  x={'dim1': ['a',
-0001fa50: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-0001fa60: 312c 2032 5d7d 2c20 7661 6c75 653d 5b31  1, 2]}, value=[1
-0001fa70: 302c 2032 305d 290a 2020 2020 2020 2020  0, 20]).        
-0001fa80: 2020 2020 3e3e 3e20 6172 7220 3d20 4172      >>> arr = Ar
-0001fa90: 7261 7928 6461 7461 3d6c 6f6e 672c 2063  ray(data=long, c
-0001faa0: 6f6f 7264 733d 636f 6f72 6473 290a 2020  oords=coords).  
-0001fab0: 2020 2020 2020 2020 2020 3e3e 3e20 6e65            >>> ne
-0001fac0: 775f 6172 7220 3d20 6172 722e 7368 7269  w_arr = arr.shri
-0001fad0: 6e6b 2864 696d 313d 5b27 6127 5d2c 2064  nk(dim1=['a'], d
-0001fae0: 696d 323d 5b31 5d29 0a20 2020 2020 2020  im2=[1]).       
-0001faf0: 2020 2020 203e 3e3e 206e 6577 5f61 7272       >>> new_arr
-0001fb00: 0a20 2020 2020 2020 2020 2020 2041 7272  .            Arr
-0001fb10: 6179 2864 6174 613d 6172 7261 7928 5b5b  ay(data=array([[
-0001fb20: 3130 5d5d 292c 2063 6f6f 7264 733d 7b27  10]]), coords={'
-0001fb30: 6469 6d31 273a 2061 7272 6179 285b 2761  dim1': array(['a
-0001fb40: 275d 2c20 6474 7970 653d 6f62 6a65 6374  '], dtype=object
-0001fb50: 292c 2027 6469 6d32 273a 2061 7272 6179  ), 'dim2': array
-0001fb60: 285b 315d 297d 290a 0a20 2020 2020 2020  ([1])})..       
-0001fb70: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-0001fb80: 2022 2222 0a20 2020 2020 2020 2061 7373   """.        ass
-0001fb90: 6572 7420 616c 6c28 5b6b 7720 696e 2073  ert all([kw in s
-0001fba0: 656c 662e 636f 6f72 6473 2066 6f72 206b  elf.coords for k
-0001fbb0: 7720 696e 206b 7761 7267 735d 0a20 2020  w in kwargs].   
-0001fbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fbd0: 292c 2022 5365 6c65 6374 6564 2064 696d  ), "Selected dim
-0001fbe0: 656e 7369 6f6e 206d 7573 7420 6265 2069  ension must be i
-0001fbf0: 6e20 636f 6f72 6473 220a 2020 2020 2020  n coords".      
-0001fc00: 2020 6173 7365 7274 2061 6c6c 285b 6973    assert all([is
-0001fc10: 696e 7374 616e 6365 286b 7761 7267 735b  instance(kwargs[
-0001fc20: 6469 6d5d 2c20 286c 6973 742c 206e 702e  dim], (list, np.
-0001fc30: 6e64 6172 7261 7929 2920 666f 7220 6469  ndarray)) for di
-0001fc40: 6d20 696e 206b 7761 7267 735d 0a20 2020  m in kwargs].   
-0001fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc60: 292c 2022 4b65 6570 696e 6720 656c 656d  ), "Keeping elem
-0001fc70: 656e 7473 206d 7573 7420 6265 2063 6f6e  ents must be con
-0001fc80: 7461 696e 6564 2069 6e20 6c69 7374 7320  tained in lists 
-0001fc90: 6f72 206e 702e 6e64 6172 7261 7922 0a20  or np.ndarray". 
-0001fca0: 2020 2020 2020 2061 7373 6572 7420 616c         assert al
-0001fcb0: 6c28 5b73 6574 286b 7761 7267 735b 6b77  l([set(kwargs[kw
-0001fcc0: 5d29 2e69 7373 7562 7365 7428 7365 6c66  ]).issubset(self
-0001fcd0: 2e63 6f6f 7264 735b 6b77 5d29 0a20 2020  .coords[kw]).   
-0001fce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fcf0: 666f 7220 6b77 2069 6e20 6b77 6172 6773  for kw in kwargs
-0001fd00: 5d29 2c20 2241 6c6c 206b 6565 7069 6e67  ]), "All keeping
-0001fd10: 2065 6c65 6d65 6e74 7320 6d75 7374 2062   elements must b
-0001fd20: 6520 696e 636c 7564 6564 206f 6620 636f  e included of co
-0001fd30: 6f72 6473 220a 2020 2020 2020 2020 6173  ords".        as
-0001fd40: 7365 7274 2061 6c6c 285b 6c65 6e28 7365  sert all([len(se
-0001fd50: 7428 6b77 6172 6773 5b6b 775d 2929 203d  t(kwargs[kw])) =
-0001fd60: 3d20 6c65 6e28 6b77 6172 6773 5b6b 775d  = len(kwargs[kw]
-0001fd70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001fd80: 2020 2020 2066 6f72 206b 7720 696e 206b       for kw in k
-0001fd90: 7761 7267 735d 292c 2022 4b65 6570 696e  wargs]), "Keepin
-0001fda0: 6720 656c 656d 656e 7473 2069 6e20 6c69  g elements in li
-0001fdb0: 7374 206d 7573 7420 6265 2075 6e69 7175  st must be uniqu
-0001fdc0: 6522 0a20 2020 2020 2020 206e 6577 5f63  e".        new_c
-0001fdd0: 6f6f 7264 7320 3d20 7b7d 0a20 2020 2020  oords = {}.     
-0001fde0: 2020 2066 6f72 2064 696d 2069 6e20 7365     for dim in se
-0001fdf0: 6c66 2e63 6f6f 7264 733a 0a20 2020 2020  lf.coords:.     
-0001fe00: 2020 2020 2020 2069 6620 6469 6d20 696e         if dim in
-0001fe10: 206b 7761 7267 733a 0a20 2020 2020 2020   kwargs:.       
-0001fe20: 2020 2020 2020 2020 206e 6577 5f63 6f6f           new_coo
-0001fe30: 7264 735b 6469 6d5d 203d 205f 7465 7374  rds[dim] = _test
-0001fe40: 5f74 7970 655f 616e 645f 7570 6461 7465  _type_and_update
-0001fe50: 286b 7761 7267 735b 6469 6d5d 290a 2020  (kwargs[dim]).  
-0001fe60: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001fe70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fe80: 6e65 775f 636f 6f72 6473 5b64 696d 5d20  new_coords[dim] 
-0001fe90: 3d20 7365 6c66 2e63 6f6f 7264 735b 6469  = self.coords[di
-0001fea0: 6d5d 0a20 2020 2020 2020 206c 6f6e 6720  m].        long 
-0001feb0: 3d20 7365 6c66 2e6c 6f6e 670a 2020 2020  = self.long.    
-0001fec0: 2020 2020 666f 7220 6469 6d20 696e 2073      for dim in s
-0001fed0: 656c 662e 6469 6d73 3a0a 2020 2020 2020  elf.dims:.      
-0001fee0: 2020 2020 2020 6966 2064 696d 2069 6e20        if dim in 
-0001fef0: 6b77 6172 6773 3a0a 2020 2020 2020 2020  kwargs:.        
-0001ff00: 2020 2020 2020 2020 6c6f 6e67 203d 206c          long = l
-0001ff10: 6f6e 675b 6469 6d2c 206b 7761 7267 735b  ong[dim, kwargs[
-0001ff20: 6469 6d5d 5d0a 2020 2020 2020 2020 7265  dim]].        re
-0001ff30: 7475 726e 2041 7272 6179 2864 6174 613d  turn Array(data=
-0001ff40: 6c6f 6e67 2c20 636f 6f72 6473 3d6e 6577  long, coords=new
-0001ff50: 5f63 6f6f 7264 7329 0a0a 2020 2020 6465  _coords)..    de
-0001ff60: 6620 6164 645f 656c 656d 2873 656c 662c  f add_elem(self,
-0001ff70: 202a 2a6b 7761 7267 733a 2055 6e69 6f6e   **kwargs: Union
-0001ff80: 5b4c 6973 745b 416e 795d 2c20 6e70 2e6e  [List[Any], np.n
-0001ff90: 6461 7272 6179 5d29 202d 3e20 2741 7272  darray]) -> 'Arr
-0001ffa0: 6179 273a 0a20 2020 2020 2020 2022 2222  ay':.        """
-0001ffb0: 0a20 2020 2020 2020 2041 6464 206e 6577  .        Add new
-0001ffc0: 2065 6c65 6d65 6e74 7320 746f 2074 6865   elements to the
-0001ffd0: 2073 7065 6369 6669 6564 2064 696d 656e   specified dimen
-0001ffe0: 7369 6f6e 7320 6f66 2074 6865 2041 7272  sions of the Arr
-0001fff0: 6179 2e0a 0a20 2020 2020 2020 2041 7267  ay...        Arg
-00020000: 733a 0a20 2020 2020 2020 2020 2020 202a  s:.            *
-00020010: 2a6b 7761 7267 733a 204b 6579 776f 7264  *kwargs: Keyword
-00020020: 2061 7267 756d 656e 7473 2073 7065 6369   arguments speci
-00020030: 6679 696e 6720 7468 6520 6469 6d65 6e73  fying the dimens
-00020040: 696f 6e73 2061 6e64 2065 6c65 6d65 6e74  ions and element
-00020050: 7320 746f 2061 6464 2e0a 0a20 2020 2020  s to add...     
-00020060: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
-00020070: 2020 2020 2020 2020 4120 6e65 7720 4172          A new Ar
-00020080: 7261 7920 6f62 6a65 6374 2077 6974 6820  ray object with 
-00020090: 7468 6520 6164 6465 6420 656c 656d 656e  the added elemen
-000200a0: 7473 2e0a 0a20 2020 2020 2020 2045 7861  ts...        Exa
-000200b0: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
-000200c0: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-000200d0: 2020 2020 2020 2020 3e3e 3e20 636f 6f72          >>> coor
-000200e0: 6473 203d 207b 2764 696d 3127 3a20 5b27  ds = {'dim1': ['
-000200f0: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
-00020100: 3a20 5b31 2c20 325d 7d0a 2020 2020 2020  : [1, 2]}.      
-00020110: 2020 2020 2020 3e3e 3e20 6c6f 6e67 203d        >>> long =
-00020120: 204c 6f6e 6728 696e 6465 783d 7b27 6469   Long(index={'di
-00020130: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
-00020140: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
-00020150: 2c20 7661 6c75 653d 5b31 302e 2c20 3230  , value=[10., 20
-00020160: 2e5d 290a 2020 2020 2020 2020 2020 2020  .]).            
-00020170: 3e3e 3e20 6172 7220 3d20 4172 7261 7928  >>> arr = Array(
-00020180: 6461 7461 3d6c 6f6e 672c 2063 6f6f 7264  data=long, coord
-00020190: 733d 636f 6f72 6473 290a 2020 2020 2020  s=coords).      
-000201a0: 2020 2020 2020 3e3e 3e20 6172 720a 2020        >>> arr.  
-000201b0: 2020 2020 2020 2020 2020 4172 7261 7928            Array(
-000201c0: 6461 7461 3d61 7272 6179 285b 5b31 302e  data=array([[10.
-000201d0: 2c20 2030 2e5d 2c0a 2020 2020 2020 2020  ,  0.],.        
-000201e0: 2020 2020 2020 2020 2020 205b 2030 2e2c             [ 0.,
-000201f0: 2032 302e 5d5d 292c 2063 6f6f 7264 733d   20.]]), coords=
-00020200: 7b27 6469 6d31 273a 2061 7272 6179 285b  {'dim1': array([
-00020210: 2761 272c 2027 6227 5d2c 2064 7479 7065  'a', 'b'], dtype
-00020220: 3d6f 626a 6563 7429 2c20 2764 696d 3227  =object), 'dim2'
-00020230: 3a20 6172 7261 7928 5b31 2c20 325d 297d  : array([1, 2])}
-00020240: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-00020250: 3e20 6e65 775f 6172 7220 3d20 6172 722e  > new_arr = arr.
-00020260: 6164 645f 656c 656d 2864 696d 313d 5b27  add_elem(dim1=['
-00020270: 6327 5d2c 2064 696d 323d 5b33 5d29 0a20  c'], dim2=[3]). 
-00020280: 2020 2020 2020 2020 2020 203e 3e3e 206e             >>> n
-00020290: 6577 5f61 7272 0a20 2020 2020 2020 2020  ew_arr.         
-000202a0: 2020 2041 7272 6179 2864 6174 613d 6172     Array(data=ar
-000202b0: 7261 7928 5b5b 3130 2e2c 2020 302e 2c20  ray([[10.,  0., 
-000202c0: 2030 2e5d 2c0a 2020 2020 2020 2020 2020   0.],.          
-000202d0: 2020 2020 2020 2020 205b 2030 2e2c 2032           [ 0., 2
-000202e0: 302e 2c20 2030 2e5d 2c0a 2020 2020 2020  0.,  0.],.      
-000202f0: 2020 2020 2020 2020 2020 2020 205b 2030               [ 0
-00020300: 2e2c 2020 302e 2c20 2030 2e5d 5d29 2c20  .,  0.,  0.]]), 
-00020310: 636f 6f72 6473 3d7b 2764 696d 3127 3a20  coords={'dim1': 
-00020320: 6172 7261 7928 5b27 6127 2c20 2762 272c  array(['a', 'b',
-00020330: 2027 6327 5d2c 2064 7479 7065 3d6f 626a   'c'], dtype=obj
-00020340: 6563 7429 2c20 2764 696d 3227 3a20 6172  ect), 'dim2': ar
-00020350: 7261 7928 5b31 2c20 322c 2033 5d29 7d29  ray([1, 2, 3])})
-00020360: 0a0a 2020 2020 2020 2020 2020 2020 6060  ..            ``
-00020370: 600a 2020 2020 2020 2020 2222 220a 2020  `.        """.  
-00020380: 2020 2020 2020 666f 7220 6469 6d20 696e        for dim in
-00020390: 206b 7761 7267 733a 0a20 2020 2020 2020   kwargs:.       
-000203a0: 2020 2020 2061 7373 6572 7420 6469 6d20       assert dim 
-000203b0: 696e 2073 656c 662e 6469 6d73 2c20 6627  in self.dims, f'
-000203c0: 6469 6d3a 207b 6469 6d7d 206d 7573 7420  dim: {dim} must 
-000203d0: 6578 6973 7420 696e 2073 656c 662e 6469  exist in self.di
-000203e0: 6d73 3a20 7b73 656c 662e 6469 6d73 7d27  ms: {self.dims}'
-000203f0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00020400: 616c 6c28 5b69 7369 6e73 7461 6e63 6528  all([isinstance(
-00020410: 6b77 6172 6773 5b64 696d 5d2c 2028 6c69  kwargs[dim], (li
-00020420: 7374 2c20 6e70 2e6e 6461 7272 6179 2c20  st, np.ndarray, 
-00020430: 2770 642e 4461 7465 7469 6d65 496e 6465  'pd.DatetimeInde
-00020440: 7827 2c20 2770 642e 4361 7465 676f 7269  x', 'pd.Categori
-00020450: 6361 6c27 2929 2066 6f72 2064 696d 2069  cal')) for dim i
-00020460: 6e20 6b77 6172 6773 5d0a 2020 2020 2020  n kwargs].      
-00020470: 2020 2020 2020 2020 2020 2020 2029 2c20               ), 
-00020480: 224b 6565 7069 6e67 2065 6c65 6d65 6e74  "Keeping element
-00020490: 7320 6d75 7374 2062 6520 636f 6e74 6169  s must be contai
-000204a0: 6e65 6420 696e 206c 6973 7473 2c20 6e70  ned in lists, np
-000204b0: 2e6e 6461 7272 6179 2c20 7064 2e43 6174  .ndarray, pd.Cat
-000204c0: 6567 6f72 6963 616c 206f 7220 7064 2e44  egorical or pd.D
-000204d0: 6174 6574 696d 6549 6e64 6578 220a 2020  atetimeIndex".  
-000204e0: 2020 2020 2020 636f 6f72 6473 203d 207b        coords = {
-000204f0: 7d0a 2020 2020 2020 2020 666f 7220 6469  }.        for di
-00020500: 6d20 696e 2073 656c 662e 636f 6f72 6473  m in self.coords
-00020510: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00020520: 2064 696d 2069 6e20 6b77 6172 6773 3a0a   dim in kwargs:.
-00020530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020540: 636f 6f72 6473 5b64 696d 5d20 3d20 6e70  coords[dim] = np
-00020550: 2e75 6e69 7175 6528 6e70 2e68 7374 6163  .unique(np.hstac
-00020560: 6b28 2873 656c 662e 636f 6f72 6473 5b64  k((self.coords[d
-00020570: 696d 5d2c 205f 7465 7374 5f74 7970 655f  im], _test_type_
-00020580: 616e 645f 7570 6461 7465 286b 7761 7267  and_update(kwarg
-00020590: 735b 6469 6d5d 2929 2929 0a20 2020 2020  s[dim])))).     
-000205a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000205b0: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
-000205c0: 7264 735b 6469 6d5d 203d 2073 656c 662e  rds[dim] = self.
-000205d0: 636f 6f72 6473 5b64 696d 5d0a 2020 2020  coords[dim].    
-000205e0: 2020 2020 7265 7475 726e 2041 7272 6179      return Array
-000205f0: 2864 6174 613d 7365 6c66 2e6c 6f6e 672c  (data=self.long,
-00020600: 2063 6f6f 7264 733d 636f 6f72 6473 290a   coords=coords).
-00020610: 0a20 2020 2064 6566 2072 6564 7563 6528  .    def reduce(
-00020620: 7365 6c66 2c20 6469 6d3a 2073 7472 2c20  self, dim: str, 
-00020630: 6167 6766 756e 633a 2055 6e69 6f6e 5b73  aggfunc: Union[s
-00020640: 7472 2c20 4361 6c6c 6162 6c65 5d20 3d20  tr, Callable] = 
-00020650: 6e70 2e61 6464 2e72 6564 7563 6529 202d  np.add.reduce) -
-00020660: 3e20 2741 7272 6179 273a 0a20 2020 2020  > 'Array':.     
-00020670: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00020680: 6564 7563 6520 7468 6520 4172 7261 7920  educe the Array 
-00020690: 616c 6f6e 6720 6120 7370 6563 6966 6965  along a specifie
-000206a0: 6420 6469 6d65 6e73 696f 6e20 7573 696e  d dimension usin
-000206b0: 6720 616e 2061 6767 7265 6761 7469 6f6e  g an aggregation
-000206c0: 2066 756e 6374 696f 6e2e 0a0a 2020 2020   function...    
-000206d0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-000206e0: 2020 2020 2020 6469 6d3a 2054 6865 2064        dim: The d
-000206f0: 696d 656e 7369 6f6e 2074 6f20 7265 6475  imension to redu
-00020700: 6365 2e0a 2020 2020 2020 2020 2020 2020  ce..            
-00020710: 6167 6766 756e 633a 2054 6865 2061 6767  aggfunc: The agg
-00020720: 7265 6761 7469 6f6e 2066 756e 6374 696f  regation functio
-00020730: 6e20 746f 2061 7070 6c79 2e20 4361 6e20  n to apply. Can 
-00020740: 6265 2061 2073 7472 696e 6720 2827 7375  be a string ('su
-00020750: 6d27 2c20 276d 6561 6e27 2c20 2770 726f  m', 'mean', 'pro
-00020760: 6427 2920 6f72 2061 2063 616c 6c61 626c  d') or a callabl
-00020770: 652e 0a0a 2020 2020 2020 2020 5265 7475  e...        Retu
-00020780: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
-00020790: 2041 206e 6577 2041 7272 6179 206f 626a   A new Array obj
-000207a0: 6563 7420 7769 7468 2074 6865 2072 6564  ect with the red
-000207b0: 7563 6564 2064 696d 656e 7369 6f6e 2e0a  uced dimension..
-000207c0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-000207d0: 3a0a 2020 2020 2020 2020 2020 2020 6060  :.            ``
-000207e0: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
-000207f0: 2020 2020 3e3e 3e20 636f 6f72 6473 203d      >>> coords =
-00020800: 207b 2764 696d 3127 3a20 5b27 6127 2c20   {'dim1': ['a', 
-00020810: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
-00020820: 2c20 325d 7d0a 2020 2020 2020 2020 2020  , 2]}.          
-00020830: 2020 3e3e 3e20 6c6f 6e67 203d 204c 6f6e    >>> long = Lon
-00020840: 6728 696e 6465 783d 7b27 6469 6d31 273a  g(index={'dim1':
-00020850: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
-00020860: 6d32 273a 205b 312c 2032 5d7d 2c20 7661  m2': [1, 2]}, va
-00020870: 6c75 653d 5b31 302c 2032 305d 290a 2020  lue=[10, 20]).  
-00020880: 2020 2020 2020 2020 2020 3e3e 3e20 6172            >>> ar
-00020890: 7220 3d20 4172 7261 7928 6461 7461 3d6c  r = Array(data=l
-000208a0: 6f6e 672c 2063 6f6f 7264 733d 636f 6f72  ong, coords=coor
-000208b0: 6473 290a 2020 2020 2020 2020 2020 2020  ds).            
-000208c0: 3e3e 3e20 7265 6475 6365 645f 6172 7220  >>> reduced_arr 
-000208d0: 3d20 6172 722e 7265 6475 6365 2827 6469  = arr.reduce('di
-000208e0: 6d31 272c 2061 6767 6675 6e63 3d27 7375  m1', aggfunc='su
-000208f0: 6d27 290a 2020 2020 2020 2020 2020 2020  m').            
-00020900: 3e3e 3e20 7265 6475 6365 645f 6172 720a  >>> reduced_arr.
-00020910: 2020 2020 2020 2020 2020 2020 4172 7261              Arra
-00020920: 7928 6461 7461 3d61 7272 6179 285b 3130  y(data=array([10
-00020930: 2e2c 2032 302e 5d29 2c20 636f 6f72 6473  ., 20.]), coords
-00020940: 3d7b 2764 696d 3227 3a20 6172 7261 7928  ={'dim2': array(
-00020950: 5b31 2c20 325d 297d 290a 0a20 2020 2020  [1, 2])})..     
-00020960: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
-00020970: 2020 2022 2222 0a20 2020 2020 2020 2061     """.        a
-00020980: 7373 6572 7420 6469 6d20 696e 2073 656c  ssert dim in sel
-00020990: 662e 6469 6d73 2c20 6622 6469 6d20 7b64  f.dims, f"dim {d
-000209a0: 696d 7d20 6e6f 7420 696e 2073 656c 662e  im} not in self.
-000209b0: 6469 6d73 3a20 7b73 656c 662e 6469 6d73  dims: {self.dims
-000209c0: 7d22 0a20 2020 2020 2020 2069 6620 6973  }".        if is
-000209d0: 696e 7374 616e 6365 2861 6767 6675 6e63  instance(aggfunc
-000209e0: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
-000209f0: 2020 2020 6173 7365 7274 2061 6767 6675      assert aggfu
-00020a00: 6e63 2069 6e20 5b0a 2020 2020 2020 2020  nc in [.        
-00020a10: 2020 2020 2020 2020 2773 756d 272c 2027          'sum', '
-00020a20: 6d65 616e 272c 2027 7072 6f64 275d 2c20  mean', 'prod'], 
-00020a30: 2253 7472 696e 6720 6f70 7469 6f6e 7320  "String options 
-00020a40: 666f 7220 6167 6766 756e 6320 6361 6e20  for aggfunc can 
-00020a50: 6265 2027 7375 6d27 2c20 276d 6561 6e27  be 'sum', 'mean'
-00020a60: 206f 7220 2770 726f 6427 220a 2020 2020   or 'prod'".    
-00020a70: 2020 2020 2020 2020 6966 2061 6767 6675          if aggfu
-00020a80: 6e63 203d 3d20 2773 756d 273a 0a20 2020  nc == 'sum':.   
-00020a90: 2020 2020 2020 2020 2020 2020 2061 6767               agg
-00020aa0: 6675 6e63 203d 206e 702e 6164 642e 7265  func = np.add.re
-00020ab0: 6475 6365 0a20 2020 2020 2020 2020 2020  duce.           
-00020ac0: 2065 6c69 6620 6167 6766 756e 6320 3d3d   elif aggfunc ==
-00020ad0: 2027 6d65 616e 273a 0a20 2020 2020 2020   'mean':.       
-00020ae0: 2020 2020 2020 2020 2061 6767 6675 6e63           aggfunc
-00020af0: 203d 206e 702e 6d65 616e 0a20 2020 2020   = np.mean.     
-00020b00: 2020 2020 2020 2065 6c69 6620 6167 6766         elif aggf
-00020b10: 756e 6320 3d3d 2027 7072 6f64 273a 0a20  unc == 'prod':. 
-00020b20: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00020b30: 6767 6675 6e63 203d 206e 702e 6d75 6c74  ggfunc = np.mult
-00020b40: 6970 6c79 2e72 6564 7563 650a 2020 2020  iply.reduce.    
-00020b50: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-00020b60: 6e63 6528 6167 6766 756e 632c 2043 616c  nce(aggfunc, Cal
-00020b70: 6c61 626c 6529 3a0a 2020 2020 2020 2020  lable):.        
-00020b80: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
-00020b90: 206e 6461 7272 6179 203d 2061 6767 6675   ndarray = aggfu
-00020ba0: 6e63 2873 656c 662e 6461 7461 2c20 6178  nc(self.data, ax
-00020bb0: 6973 3d73 656c 662e 6469 6d73 2e69 6e64  is=self.dims.ind
-00020bc0: 6578 2864 696d 2929 0a20 2020 2020 2020  ex(dim)).       
-00020bd0: 2064 696d 7320 3d20 5b64 2066 6f72 2064   dims = [d for d
-00020be0: 2069 6e20 7365 6c66 2e64 696d 7320 6966   in self.dims if
-00020bf0: 2064 2021 3d20 6469 6d5d 0a20 2020 2020   d != dim].     
-00020c00: 2020 2063 6f6f 7264 7320 3d20 7b6b 3a20     coords = {k: 
-00020c10: 7620 666f 7220 6b2c 2076 2069 6e20 7365  v for k, v in se
-00020c20: 6c66 2e63 6f6f 7264 732e 6974 656d 7328  lf.coords.items(
-00020c30: 2920 6966 206b 2069 6e20 6469 6d73 7d0a  ) if k in dims}.
-00020c40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00020c50: 656c 662e 5f70 6f73 745f 6f70 6572 6174  elf._post_operat
-00020c60: 696f 6e28 6e64 6172 7261 792c 2063 6f6f  ion(ndarray, coo
-00020c70: 7264 7329 0a0a 2020 2020 6465 6620 5f73  rds)..    def _s
-00020c80: 6869 6674 5f6f 6e65 5f64 696d 2873 656c  hift_one_dim(sel
-00020c90: 662c 2064 696d 3a20 7374 722c 2063 6f75  f, dim: str, cou
-00020ca0: 6e74 3a20 696e 742c 2066 696c 6c5f 7661  nt: int, fill_va
-00020cb0: 6c75 653a 2055 6e69 6f6e 5b66 6c6f 6174  lue: Union[float
-00020cc0: 2c20 4e6f 6e65 5d20 3d20 4e6f 6e65 2920  , None] = None) 
-00020cd0: 2d3e 2027 4172 7261 7927 3a0a 2020 2020  -> 'Array':.    
-00020ce0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00020cf0: 5368 6966 7420 7468 6520 4172 7261 7920  Shift the Array 
-00020d00: 616c 6f6e 6720 6120 7369 6e67 6c65 2064  along a single d
-00020d10: 696d 656e 7369 6f6e 2e0a 0a20 2020 2020  imension...     
-00020d20: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-00020d30: 2020 2020 2064 696d 3a20 5468 6520 6469       dim: The di
-00020d40: 6d65 6e73 696f 6e20 746f 2073 6869 6674  mension to shift
-00020d50: 2e0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-00020d60: 756e 743a 2054 6865 206e 756d 6265 7220  unt: The number 
-00020d70: 6f66 2070 6f73 6974 696f 6e73 2074 6f20  of positions to 
-00020d80: 7368 6966 742e 2050 6f73 6974 6976 6520  shift. Positive 
-00020d90: 7661 6c75 6573 2073 6869 6674 2066 6f72  values shift for
-00020da0: 7761 7264 2c20 6e65 6761 7469 7665 2076  ward, negative v
-00020db0: 616c 7565 7320 7368 6966 7420 6261 636b  alues shift back
-00020dc0: 7761 7264 2e0a 2020 2020 2020 2020 2020  ward..          
-00020dd0: 2020 6669 6c6c 5f76 616c 7565 3a20 5468    fill_value: Th
-00020de0: 6520 7661 6c75 6520 746f 2066 696c 6c20  e value to fill 
-00020df0: 7468 6520 656d 7074 7920 706f 7369 7469  the empty positi
-00020e00: 6f6e 7320 6166 7465 7220 7368 6966 7469  ons after shifti
-00020e10: 6e67 2e20 4966 204e 6f6e 652c 2075 7365  ng. If None, use
-00020e20: 2074 6865 2064 6566 6175 6c74 2066 696c   the default fil
-00020e30: 6c20 7661 6c75 652e 0a0a 2020 2020 2020  l value...      
-00020e40: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-00020e50: 2020 2020 2020 2041 206e 6577 2041 7272         A new Arr
-00020e60: 6179 206f 626a 6563 7420 7769 7468 2074  ay object with t
-00020e70: 6865 2073 6869 6674 6564 2076 616c 7565  he shifted value
-00020e80: 732e 0a0a 2020 2020 2020 2020 4578 616d  s...        Exam
-00020e90: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
-00020ea0: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
-00020eb0: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
-00020ec0: 7320 3d20 7b27 6469 6d31 273a 205b 2761  s = {'dim1': ['a
-00020ed0: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
-00020ee0: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
-00020ef0: 2020 2020 203e 3e3e 206c 6f6e 6720 3d20       >>> long = 
-00020f00: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
-00020f10: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-00020f20: 2764 696d 3227 3a20 5b31 2c20 325d 7d2c  'dim2': [1, 2]},
-00020f30: 2076 616c 7565 3d5b 3130 2c20 3230 5d29   value=[10, 20])
-00020f40: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00020f50: 2061 7272 203d 2041 7272 6179 2864 6174   arr = Array(dat
-00020f60: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d63  a=long, coords=c
-00020f70: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
-00020f80: 2020 203e 3e3e 2073 6869 6674 6564 5f61     >>> shifted_a
-00020f90: 7272 203d 2061 7272 2e5f 7368 6966 745f  rr = arr._shift_
-00020fa0: 6f6e 655f 6469 6d28 2764 696d 3127 2c20  one_dim('dim1', 
-00020fb0: 636f 756e 743d 312c 2066 696c 6c5f 7661  count=1, fill_va
-00020fc0: 6c75 653d 3029 0a20 2020 2020 2020 2020  lue=0).         
-00020fd0: 2020 203e 3e3e 2073 6869 6674 6564 5f61     >>> shifted_a
-00020fe0: 7272 0a20 2020 2020 2020 2020 2020 2041  rr.            A
-00020ff0: 7272 6179 2864 6174 613d 6172 7261 7928  rray(data=array(
-00021000: 5b5b 2030 2e2c 2020 302e 5d2c 0a20 2020  [[ 0.,  0.],.   
-00021010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021020: 5b31 302e 2c20 2030 2e5d 5d29 2c20 636f  [10.,  0.]]), co
-00021030: 6f72 6473 3d7b 2764 696d 3127 3a20 6172  ords={'dim1': ar
-00021040: 7261 7928 5b27 6127 2c20 2762 275d 2c20  ray(['a', 'b'], 
-00021050: 6474 7970 653d 6f62 6a65 6374 292c 2027  dtype=object), '
-00021060: 6469 6d32 273a 2061 7272 6179 285b 312c  dim2': array([1,
-00021070: 2032 5d29 7d29 0a0a 2020 2020 2020 2020   2])})..        
-00021080: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
-00021090: 2222 220a 2020 2020 2020 2020 6966 2066  """.        if f
-000210a0: 696c 6c5f 7661 6c75 6520 6973 204e 6f6e  ill_value is Non
-000210b0: 653a 0a20 2020 2020 2020 2020 2020 2066  e:.            f
-000210c0: 696c 6c5f 7661 6c75 652c 2064 7479 7065  ill_value, dtype
-000210d0: 203d 2073 656c 662e 5f66 696c 6c65 725f   = self._filler_
-000210e0: 616e 645f 6474 7970 6528 7365 6c66 2e64  and_dtype(self.d
-000210f0: 6174 612c 2073 656c 662e 6669 6c6c 5f76  ata, self.fill_v
-00021100: 616c 7565 290a 2020 2020 2020 2020 2020  alue).          
-00021110: 2020 7261 775f 6461 7461 203d 2073 656c    raw_data = sel
-00021120: 662e 6461 7461 2e61 7374 7970 6528 6474  f.data.astype(dt
-00021130: 7970 6529 0a20 2020 2020 2020 2065 6c73  ype).        els
-00021140: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00021150: 6177 5f64 6174 6120 3d20 7365 6c66 2e64  aw_data = self.d
-00021160: 6174 610a 2020 2020 2020 2020 6178 203d  ata.        ax =
-00021170: 2073 656c 662e 6469 6d73 2e69 6e64 6578   self.dims.index
-00021180: 2864 696d 290a 2020 2020 2020 2020 6461  (dim).        da
-00021190: 7461 203d 206e 702e 726f 6c6c 2872 6177  ta = np.roll(raw
-000211a0: 5f64 6174 612c 2073 6869 6674 3d63 6f75  _data, shift=cou
-000211b0: 6e74 2c20 6178 6973 3d61 7829 0a20 2020  nt, axis=ax).   
-000211c0: 2020 2020 2069 6620 7365 6c66 2e64 6174       if self.dat
-000211d0: 615f 7479 7065 203d 3d20 2764 656e 7365  a_type == 'dense
-000211e0: 273a 0a20 2020 2020 2020 2020 2020 2069  ':.            i
-000211f0: 6620 636f 756e 7420 3e20 303a 0a20 2020  f count > 0:.   
-00021200: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00021210: 612e 7377 6170 6178 6573 2830 2c20 6178  a.swapaxes(0, ax
-00021220: 295b 3a63 6f75 6e74 5d20 3d20 6669 6c6c  )[:count] = fill
-00021230: 5f76 616c 7565 0a20 2020 2020 2020 2020  _value.         
-00021240: 2020 2065 6c69 6620 636f 756e 7420 3c20     elif count < 
-00021250: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-00021260: 2020 2064 6174 612e 7377 6170 6178 6573     data.swapaxes
-00021270: 2830 2c20 6178 295b 636f 756e 743a 5d20  (0, ax)[count:] 
-00021280: 3d20 6669 6c6c 5f76 616c 7565 0a20 2020  = fill_value.   
-00021290: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000212a0: 7365 6c66 2e5f 706f 7374 5f6f 7065 7261  self._post_opera
-000212b0: 7469 6f6e 2864 6174 612c 2073 656c 662e  tion(data, self.
-000212c0: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
-000212d0: 656c 6966 2073 656c 662e 6461 7461 5f74  elif self.data_t
-000212e0: 7970 6520 3d3d 2027 7370 6172 7365 273a  ype == 'sparse':
-000212f0: 0a20 2020 2020 2020 2020 2020 2063 6f6f  .            coo
-00021300: 5f69 6e64 6578 203d 2064 6174 612e 636f  _index = data.co
-00021310: 6f72 6473 0a20 2020 2020 2020 2020 2020  ords.           
-00021320: 2073 6861 7065 203d 2064 6174 612e 7368   shape = data.sh
-00021330: 6170 650a 2020 2020 2020 2020 2020 2020  ape.            
-00021340: 7570 7065 7220 3d20 7368 6170 655b 6178  upper = shape[ax
-00021350: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
-00021360: 2063 6f75 6e74 203e 2030 3a0a 2020 2020   count > 0:.    
-00021370: 2020 2020 2020 2020 2020 2020 7374 6172              star
-00021380: 7420 3d20 300a 2020 2020 2020 2020 2020  t = 0.          
-00021390: 2020 2020 2020 656e 6420 3d20 636f 756e        end = coun
-000213a0: 740a 2020 2020 2020 2020 2020 2020 656c  t.            el
-000213b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000213c0: 2020 2020 7374 6172 7420 3d20 7570 7065      start = uppe
-000213d0: 7220 2b20 636f 756e 740a 2020 2020 2020  r + count.      
-000213e0: 2020 2020 2020 2020 2020 656e 6420 3d20            end = 
-000213f0: 7570 7065 720a 2020 2020 2020 2020 2020  upper.          
-00021400: 2020 6173 7365 7274 205f 6973 5f69 6e5f    assert _is_in_
-00021410: 7261 6e67 6528 7374 6172 742c 2065 6e64  range(start, end
-00021420: 2c20 302c 2075 7070 6572 2c20 7374 6570  , 0, upper, step
-00021430: 3d31 290a 2020 2020 2020 2020 2020 2020  =1).            
-00021440: 7365 6c65 6374 6564 203d 2063 6f6f 5f69  selected = coo_i
-00021450: 6e64 6578 5b61 785d 0a20 2020 2020 2020  ndex[ax].       
-00021460: 2020 2020 2073 6f72 7465 6469 6478 203d       sortedidx =
-00021470: 206e 702e 6172 6773 6f72 7428 7365 6c65   np.argsort(sele
-00021480: 6374 6564 290a 2020 2020 2020 2020 2020  cted).          
-00021490: 2020 6c20 3d20 6e70 2e73 6561 7263 6873    l = np.searchs
-000214a0: 6f72 7465 6428 7365 6c65 6374 6564 2c20  orted(selected, 
-000214b0: 7374 6172 742c 2073 6964 653d 276c 6566  start, side='lef
-000214c0: 7427 2c20 736f 7274 6572 3d73 6f72 7465  t', sorter=sorte
-000214d0: 6469 6478 290a 2020 2020 2020 2020 2020  didx).          
-000214e0: 2020 7220 3d20 6e70 2e73 6561 7263 6873    r = np.searchs
-000214f0: 6f72 7465 6428 7365 6c65 6374 6564 2c20  orted(selected, 
-00021500: 656e 642d 312c 2073 6964 653d 2772 6967  end-1, side='rig
-00021510: 6874 272c 2073 6f72 7465 723d 736f 7274  ht', sorter=sort
-00021520: 6564 6964 7829 0a20 2020 2020 2020 2020  edidx).         
-00021530: 2020 2069 6e64 7320 3d20 736f 7274 6564     inds = sorted
-00021540: 6964 785b 6c3a 725d 0a20 2020 2020 2020  idx[l:r].       
-00021550: 2020 2020 2063 6f6f 5f76 616c 7565 203d       coo_value =
-00021560: 2064 6174 612e 6461 7461 0a20 2020 2020   data.data.     
-00021570: 2020 2020 2020 2063 6f6f 5f76 616c 7565         coo_value
-00021580: 5b69 6e64 735d 203d 2066 696c 6c5f 7661  [inds] = fill_va
-00021590: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
-000215a0: 636f 6f20 3d20 7370 2e43 4f4f 2864 6174  coo = sp.COO(dat
-000215b0: 613d 636f 6f5f 7661 6c75 652c 2063 6f6f  a=coo_value, coo
-000215c0: 7264 733d 636f 6f5f 696e 6465 782c 2073  rds=coo_index, s
-000215d0: 6861 7065 3d73 6861 7065 290a 2020 2020  hape=shape).    
-000215e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000215f0: 656c 662e 5f70 6f73 745f 6f70 6572 6174  elf._post_operat
-00021600: 696f 6e28 636f 6f2c 2073 656c 662e 636f  ion(coo, self.co
-00021610: 6f72 6473 290a 0a20 2020 2064 6566 2073  ords)..    def s
-00021620: 6869 6674 2873 656c 662c 2066 696c 6c5f  hift(self, fill_
-00021630: 7661 6c75 653a 2055 6e69 6f6e 5b66 6c6f  value: Union[flo
-00021640: 6174 2c20 4e6f 6e65 5d20 3d20 4e6f 6e65  at, None] = None
-00021650: 2c20 2a2a 6b77 6172 6773 3a20 696e 7429  , **kwargs: int)
-00021660: 202d 3e20 2741 7272 6179 273a 0a20 2020   -> 'Array':.   
-00021670: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00021680: 2053 6869 6674 2074 6865 2041 7272 6179   Shift the Array
-00021690: 2061 6c6f 6e67 2073 7065 6369 6669 6564   along specified
-000216a0: 2064 696d 656e 7369 6f6e 732e 0a0a 2020   dimensions...  
-000216b0: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
-000216c0: 2020 2020 2020 2020 6669 6c6c 5f76 616c          fill_val
-000216d0: 7565 3a20 5468 6520 7661 6c75 6520 746f  ue: The value to
-000216e0: 2066 696c 6c20 7468 6520 656d 7074 7920   fill the empty 
-000216f0: 706f 7369 7469 6f6e 7320 6166 7465 7220  positions after 
-00021700: 7368 6966 7469 6e67 2e20 4966 204e 6f6e  shifting. If Non
-00021710: 652c 2075 7365 2074 6865 2064 6566 6175  e, use the defau
-00021720: 6c74 2066 696c 6c20 7661 6c75 652e 0a20  lt fill value.. 
-00021730: 2020 2020 2020 2020 2020 202a 2a6b 7761             **kwa
-00021740: 7267 733a 204b 6579 776f 7264 2061 7267  rgs: Keyword arg
-00021750: 756d 656e 7473 2073 7065 6369 6679 696e  uments specifyin
-00021760: 6720 7468 6520 6469 6d65 6e73 696f 6e73  g the dimensions
-00021770: 2061 6e64 2074 6865 206e 756d 6265 7220   and the number 
-00021780: 6f66 2070 6f73 6974 696f 6e73 2074 6f20  of positions to 
-00021790: 7368 6966 742e 0a0a 2020 2020 2020 2020  shift...        
-000217a0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-000217b0: 2020 2020 2041 206e 6577 2041 7272 6179       A new Array
-000217c0: 206f 626a 6563 7420 7769 7468 2074 6865   object with the
-000217d0: 2073 6869 6674 6564 2076 616c 7565 732e   shifted values.
-000217e0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-000217f0: 653a 0a20 2020 2020 2020 2020 2020 2060  e:.            `
-00021800: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-00021810: 2020 2020 203e 3e3e 2063 6f6f 7264 7320       >>> coords 
-00021820: 3d20 7b27 6469 6d31 273a 205b 2761 272c  = {'dim1': ['a',
-00021830: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-00021840: 312c 2032 5d7d 0a20 2020 2020 2020 2020  1, 2]}.         
-00021850: 2020 203e 3e3e 206c 6f6e 6720 3d20 4c6f     >>> long = Lo
-00021860: 6e67 2869 6e64 6578 3d7b 2764 696d 3127  ng(index={'dim1'
-00021870: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
-00021880: 696d 3227 3a20 5b31 2c20 325d 7d2c 2076  im2': [1, 2]}, v
-00021890: 616c 7565 3d5b 3130 2c20 3230 5d29 0a20  alue=[10, 20]). 
-000218a0: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
-000218b0: 7272 203d 2041 7272 6179 2864 6174 613d  rr = Array(data=
-000218c0: 6c6f 6e67 2c20 636f 6f72 6473 3d63 6f6f  long, coords=coo
-000218d0: 7264 7329 0a20 2020 2020 2020 2020 2020  rds).           
-000218e0: 203e 3e3e 2073 6869 6674 6564 5f61 7272   >>> shifted_arr
-000218f0: 203d 2061 7272 2e73 6869 6674 2864 696d   = arr.shift(dim
-00021900: 313d 312c 2064 696d 323d 2d31 2c20 6669  1=1, dim2=-1, fi
-00021910: 6c6c 5f76 616c 7565 3d30 290a 2020 2020  ll_value=0).    
-00021920: 2020 2020 2020 2020 3e3e 3e20 7368 6966          >>> shif
-00021930: 7465 645f 6172 720a 2020 2020 2020 2020  ted_arr.        
-00021940: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
-00021950: 7272 6179 285b 5b30 2e2c 2030 2e5d 2c0a  rray([[0., 0.],.
-00021960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021970: 2020 205b 302e 2c20 302e 5d5d 292c 2063     [0., 0.]]), c
-00021980: 6f6f 7264 733d 7b27 6469 6d31 273a 2061  oords={'dim1': a
-00021990: 7272 6179 285b 2761 272c 2027 6227 5d2c  rray(['a', 'b'],
-000219a0: 2064 7479 7065 3d6f 626a 6563 7429 2c20   dtype=object), 
-000219b0: 2764 696d 3227 3a20 6172 7261 7928 5b31  'dim2': array([1
-000219c0: 2c20 325d 297d 290a 0a20 2020 2020 2020  , 2])})..       
-000219d0: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-000219e0: 2022 2222 0a20 2020 2020 2020 2061 7373   """.        ass
-000219f0: 6572 7420 6c65 6e28 6b77 6172 6773 2920  ert len(kwargs) 
-00021a00: 3e20 300a 2020 2020 2020 2020 6173 7365  > 0.        asse
-00021a10: 7274 2061 6c6c 285b 6469 6d20 696e 2073  rt all([dim in s
-00021a20: 656c 662e 6469 6d73 2066 6f72 2064 696d  elf.dims for dim
-00021a30: 2069 6e20 6b77 6172 6773 5d29 0a20 2020   in kwargs]).   
-00021a40: 2020 2020 2061 7373 6572 7420 616c 6c28       assert all(
-00021a50: 5b69 7369 6e73 7461 6e63 6528 6b77 6172  [isinstance(kwar
-00021a60: 6773 5b64 696d 5d2c 2069 6e74 2920 666f  gs[dim], int) fo
-00021a70: 7220 6469 6d20 696e 206b 7761 7267 735d  r dim in kwargs]
-00021a80: 290a 2020 2020 2020 2020 6f62 6a20 3d20  ).        obj = 
-00021a90: 7365 6c66 0a20 2020 2020 2020 2066 6f72  self.        for
-00021aa0: 2064 696d 2069 6e20 6b77 6172 6773 3a0a   dim in kwargs:.
-00021ab0: 2020 2020 2020 2020 2020 2020 6f62 6a20              obj 
-00021ac0: 3d20 6f62 6a2e 5f73 6869 6674 5f6f 6e65  = obj._shift_one
-00021ad0: 5f64 696d 2864 696d 3d64 696d 2c20 636f  _dim(dim=dim, co
-00021ae0: 756e 743d 6b77 6172 6773 5b64 696d 5d2c  unt=kwargs[dim],
-00021af0: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
-00021b00: 5f76 616c 7565 290a 2020 2020 2020 2020  _value).        
-00021b10: 7265 7475 726e 206f 626a 0a0a 2020 2020  return obj..    
-00021b20: 6465 6620 5f72 6f6c 6c5f 6f6e 655f 6469  def _roll_one_di
-00021b30: 6d28 7365 6c66 2c20 6469 6d3a 2073 7472  m(self, dim: str
-00021b40: 2c20 636f 756e 743a 2069 6e74 2920 2d3e  , count: int) ->
-00021b50: 2027 4172 7261 7927 3a0a 2020 2020 2020   'Array':.      
-00021b60: 2020 2222 220a 2020 2020 2020 2020 526f    """.        Ro
-00021b70: 6c6c 2074 6865 2041 7272 6179 2061 6c6f  ll the Array alo
-00021b80: 6e67 2061 2073 696e 676c 6520 6469 6d65  ng a single dime
-00021b90: 6e73 696f 6e2e 0a0a 2020 2020 2020 2020  nsion...        
-00021ba0: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-00021bb0: 2020 6469 6d3a 2054 6865 2064 696d 656e    dim: The dimen
-00021bc0: 7369 6f6e 2074 6f20 726f 6c6c 2e0a 2020  sion to roll..  
-00021bd0: 2020 2020 2020 2020 2020 636f 756e 743a            count:
-00021be0: 2054 6865 206e 756d 6265 7220 6f66 2070   The number of p
-00021bf0: 6f73 6974 696f 6e73 2074 6f20 726f 6c6c  ositions to roll
-00021c00: 2e20 506f 7369 7469 7665 2076 616c 7565  . Positive value
-00021c10: 7320 726f 6c6c 2066 6f72 7761 7264 2c20  s roll forward, 
-00021c20: 6e65 6761 7469 7665 2076 616c 7565 7320  negative values 
-00021c30: 726f 6c6c 2062 6163 6b77 6172 642e 0a0a  roll backward...
-00021c40: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
-00021c50: 0a20 2020 2020 2020 2020 2020 2041 206e  .            A n
-00021c60: 6577 2041 7272 6179 206f 626a 6563 7420  ew Array object 
-00021c70: 7769 7468 2074 6865 2072 6f6c 6c65 6420  with the rolled 
-00021c80: 7661 6c75 6573 2e0a 0a20 2020 2020 2020  values...       
-00021c90: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
-00021ca0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
-00021cb0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00021cc0: 636f 6f72 6473 203d 207b 2764 696d 3127  coords = {'dim1'
-00021cd0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
-00021ce0: 696d 3227 3a20 5b31 2c20 325d 7d0a 2020  im2': [1, 2]}.  
-00021cf0: 2020 2020 2020 2020 2020 3e3e 3e20 6c6f            >>> lo
-00021d00: 6e67 203d 204c 6f6e 6728 696e 6465 783d  ng = Long(index=
-00021d10: 7b27 6469 6d31 273a 205b 2761 272c 2027  {'dim1': ['a', '
-00021d20: 6227 5d2c 2027 6469 6d32 273a 205b 312c  b'], 'dim2': [1,
-00021d30: 2032 5d7d 2c20 7661 6c75 653d 5b31 302c   2]}, value=[10,
-00021d40: 2032 305d 290a 2020 2020 2020 2020 2020   20]).          
-00021d50: 2020 3e3e 3e20 6172 7220 3d20 4172 7261    >>> arr = Arra
-00021d60: 7928 6461 7461 3d6c 6f6e 672c 2063 6f6f  y(data=long, coo
-00021d70: 7264 733d 636f 6f72 6473 290a 2020 2020  rds=coords).    
-00021d80: 2020 2020 2020 2020 3e3e 3e20 726f 6c6c          >>> roll
-00021d90: 6564 5f61 7272 203d 2061 7272 2e5f 726f  ed_arr = arr._ro
-00021da0: 6c6c 5f6f 6e65 5f64 696d 2827 6469 6d31  ll_one_dim('dim1
-00021db0: 272c 2063 6f75 6e74 3d31 290a 2020 2020  ', count=1).    
-00021dc0: 2020 2020 2020 2020 3e3e 3e20 726f 6c6c          >>> roll
-00021dd0: 6564 5f61 7272 0a20 2020 2020 2020 2020  ed_arr.         
-00021de0: 2020 2041 7272 6179 2864 6174 613d 6172     Array(data=ar
-00021df0: 7261 7928 5b5b 2030 2e2c 2032 302e 5d2c  ray([[ 0., 20.],
-00021e00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021e10: 2020 2020 5b31 302e 2c20 2030 2e5d 5d29      [10.,  0.]])
-00021e20: 2c20 636f 6f72 6473 3d7b 2764 696d 3127  , coords={'dim1'
-00021e30: 3a20 6172 7261 7928 5b27 6127 2c20 2762  : array(['a', 'b
-00021e40: 275d 2c20 6474 7970 653d 6f62 6a65 6374  '], dtype=object
-00021e50: 292c 2027 6469 6d32 273a 2061 7272 6179  ), 'dim2': array
-00021e60: 285b 312c 2032 5d29 7d29 0a0a 2020 2020  ([1, 2])})..    
-00021e70: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-00021e80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00021e90: 6173 7365 7274 2064 696d 2069 6e20 7365  assert dim in se
-00021ea0: 6c66 2e64 696d 732c 2066 227b 6469 6d7d  lf.dims, f"{dim}
-00021eb0: 206e 6f74 2069 6e20 6469 6d73 3a20 7b73   not in dims: {s
-00021ec0: 656c 662e 6469 6d73 7d22 0a20 2020 2020  elf.dims}".     
-00021ed0: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
-00021ee0: 616e 6365 2863 6f75 6e74 2c20 696e 7429  ance(count, int)
-00021ef0: 2c20 6622 7b63 6f75 6e74 7d20 6d75 7374  , f"{count} must
-00021f00: 2062 6520 696e 7422 0a20 2020 2020 2020   be int".       
-00021f10: 2061 7820 3d20 7365 6c66 2e64 696d 732e   ax = self.dims.
-00021f20: 696e 6465 7828 6469 6d29 0a20 2020 2020  index(dim).     
-00021f30: 2020 2064 6174 6120 3d20 6e70 2e72 6f6c     data = np.rol
-00021f40: 6c28 7365 6c66 2e64 6174 612c 2073 6869  l(self.data, shi
-00021f50: 6674 3d63 6f75 6e74 2c20 6178 6973 3d61  ft=count, axis=a
-00021f60: 7829 0a20 2020 2020 2020 2072 6574 7572  x).        retur
-00021f70: 6e20 7365 6c66 2e5f 706f 7374 5f6f 7065  n self._post_ope
-00021f80: 7261 7469 6f6e 2864 6174 612c 2073 656c  ration(data, sel
-00021f90: 662e 636f 6f72 6473 290a 0a20 2020 2064  f.coords)..    d
-00021fa0: 6566 2072 6f6c 6c28 7365 6c66 2c20 2a2a  ef roll(self, **
-00021fb0: 6b77 6172 6773 3a20 696e 7429 202d 3e20  kwargs: int) -> 
-00021fc0: 2741 7272 6179 273a 0a20 2020 2020 2020  'Array':.       
-00021fd0: 2022 2222 0a20 2020 2020 2020 2052 6f6c   """.        Rol
-00021fe0: 6c20 7468 6520 4172 7261 7920 616c 6f6e  l the Array alon
-00021ff0: 6720 7370 6563 6966 6965 6420 6469 6d65  g specified dime
-00022000: 6e73 696f 6e73 2e0a 0a20 2020 2020 2020  nsions...       
-00022010: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-00022020: 2020 202a 2a6b 7761 7267 733a 204b 6579     **kwargs: Key
-00022030: 776f 7264 2061 7267 756d 656e 7473 2073  word arguments s
-00022040: 7065 6369 6679 696e 6720 7468 6520 6469  pecifying the di
-00022050: 6d65 6e73 696f 6e73 2061 6e64 2074 6865  mensions and the
-00022060: 206e 756d 6265 7220 6f66 2070 6f73 6974   number of posit
-00022070: 696f 6e73 2074 6f20 726f 6c6c 2e0a 0a20  ions to roll... 
-00022080: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
-00022090: 2020 2020 2020 2020 2020 2020 4120 6e65              A ne
-000220a0: 7720 4172 7261 7920 6f62 6a65 6374 2077  w Array object w
-000220b0: 6974 6820 7468 6520 726f 6c6c 6564 2076  ith the rolled v
-000220c0: 616c 7565 732e 0a0a 2020 2020 2020 2020  alues...        
-000220d0: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
-000220e0: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
-000220f0: 2020 2020 2020 2020 2020 203e 3e3e 2063             >>> c
-00022100: 6f6f 7264 7320 3d20 7b27 6469 6d31 273a  oords = {'dim1':
-00022110: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
-00022120: 6d32 273a 205b 312c 2032 5d7d 0a20 2020  m2': [1, 2]}.   
-00022130: 2020 2020 2020 2020 203e 3e3e 206c 6f6e           >>> lon
-00022140: 6720 3d20 4c6f 6e67 2869 6e64 6578 3d7b  g = Long(index={
-00022150: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
-00022160: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
-00022170: 325d 7d2c 2076 616c 7565 3d5b 3130 2c20  2]}, value=[10, 
-00022180: 3230 5d29 0a20 2020 2020 2020 2020 2020  20]).           
-00022190: 203e 3e3e 2061 7272 203d 2041 7272 6179   >>> arr = Array
-000221a0: 2864 6174 613d 6c6f 6e67 2c20 636f 6f72  (data=long, coor
-000221b0: 6473 3d63 6f6f 7264 7329 0a20 2020 2020  ds=coords).     
-000221c0: 2020 2020 2020 203e 3e3e 2072 6f6c 6c65         >>> rolle
-000221d0: 645f 6172 7220 3d20 6172 722e 726f 6c6c  d_arr = arr.roll
-000221e0: 2864 696d 313d 312c 2064 696d 323d 2d31  (dim1=1, dim2=-1
-000221f0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-00022200: 3e20 726f 6c6c 6564 5f61 7272 0a20 2020  > rolled_arr.   
-00022210: 2020 2020 2020 2020 2041 7272 6179 2864           Array(d
-00022220: 6174 613d 6172 7261 7928 5b5b 3230 2e2c  ata=array([[20.,
-00022230: 2020 302e 5d2c 0a20 2020 2020 2020 2020    0.],.         
-00022240: 2020 2020 2020 2020 2020 5b20 302e 2c20            [ 0., 
-00022250: 3130 2e5d 5d29 2c20 636f 6f72 6473 3d7b  10.]]), coords={
-00022260: 2764 696d 3127 3a20 6172 7261 7928 5b27  'dim1': array(['
-00022270: 6127 2c20 2762 275d 2c20 6474 7970 653d  a', 'b'], dtype=
-00022280: 6f62 6a65 6374 292c 2027 6469 6d32 273a  object), 'dim2':
-00022290: 2061 7272 6179 285b 312c 2032 5d29 7d29   array([1, 2])})
-000222a0: 0a0a 2020 2020 2020 2020 2020 2020 6060  ..            ``
-000222b0: 600a 2020 2020 2020 2020 2222 220a 2020  `.        """.  
-000222c0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-000222d0: 286b 7761 7267 7329 203e 2030 2c20 224d  (kwargs) > 0, "M
-000222e0: 7573 7420 7370 6563 6966 7920 6174 206c  ust specify at l
-000222f0: 6561 7374 206f 6e65 2064 696d 656e 7369  east one dimensi
-00022300: 6f6e 2074 6f20 726f 6c6c 220a 2020 2020  on to roll".    
-00022310: 2020 2020 6173 7365 7274 2061 6c6c 285b      assert all([
-00022320: 6469 6d20 696e 2073 656c 662e 6469 6d73  dim in self.dims
-00022330: 2066 6f72 2064 696d 2069 6e20 6b77 6172   for dim in kwar
-00022340: 6773 5d29 2c20 6622 7b6b 7761 7267 737d  gs]), f"{kwargs}
-00022350: 206e 6f74 2069 6e20 6469 6d73 3a20 7b73   not in dims: {s
-00022360: 656c 662e 6469 6d73 7d22 0a20 2020 2020  elf.dims}".     
-00022370: 2020 2061 7373 6572 7420 616c 6c28 5b69     assert all([i
-00022380: 7369 6e73 7461 6e63 6528 6b77 6172 6773  sinstance(kwargs
-00022390: 5b64 696d 5d2c 2069 6e74 2920 666f 7220  [dim], int) for 
-000223a0: 6469 6d20 696e 206b 7761 7267 735d 292c  dim in kwargs]),
-000223b0: 2066 2241 6c6c 2076 616c 7565 7320 696e   f"All values in
-000223c0: 207b 6b77 6172 6773 7d20 6d75 7374 2062   {kwargs} must b
-000223d0: 6520 696e 7465 6765 7273 220a 2020 2020  e integers".    
-000223e0: 2020 2020 6f62 6a20 3d20 7365 6c66 0a20      obj = self. 
-000223f0: 2020 2020 2020 2066 6f72 2064 696d 2069         for dim i
-00022400: 6e20 6b77 6172 6773 3a0a 2020 2020 2020  n kwargs:.      
-00022410: 2020 2020 2020 6f62 6a20 3d20 6f62 6a2e        obj = obj.
-00022420: 5f72 6f6c 6c5f 6f6e 655f 6469 6d28 6469  _roll_one_dim(di
-00022430: 6d3d 6469 6d2c 2063 6f75 6e74 3d6b 7761  m=dim, count=kwa
-00022440: 7267 735b 6469 6d5d 290a 2020 2020 2020  rgs[dim]).      
-00022450: 2020 7265 7475 726e 206f 626a 0a0a 2020    return obj..  
-00022460: 2020 6465 6620 696e 7365 7274 2873 656c    def insert(sel
-00022470: 662c 202a 2a6b 7761 7267 733a 2055 6e69  f, **kwargs: Uni
-00022480: 6f6e 5b6e 702e 6474 7970 652c 2074 7970  on[np.dtype, typ
-00022490: 652c 2073 7472 2c20 696e 742c 2066 6c6f  e, str, int, flo
-000224a0: 6174 2c20 4469 6374 5b73 7472 2c20 556e  at, Dict[str, Un
-000224b0: 696f 6e5b 4469 6374 5b73 7472 2c20 416e  ion[Dict[str, An
-000224c0: 795d 2c20 4c69 7374 5b55 6e69 6f6e 5b4c  y], List[Union[L
-000224d0: 6973 745b 7374 725d 2c20 4c69 7374 5b41  ist[str], List[A
-000224e0: 6e79 5d5d 5d5d 5d5d 2920 2d3e 2027 4172  ny]]]]]]) -> 'Ar
-000224f0: 7261 7927 3a0a 2020 2020 2020 2020 2222  ray':.        ""
-00022500: 220a 2020 2020 2020 2020 496e 7365 7274  ".        Insert
-00022510: 206e 6577 2064 696d 656e 7369 6f6e 7320   new dimensions 
-00022520: 696e 746f 2074 6865 2041 7272 6179 2e20  into the Array. 
-00022530: 5468 6572 6520 6172 6520 666f 7572 2067  There are four g
-00022540: 726f 7570 7320 6f66 2076 616c 7565 7320  roups of values 
-00022550: 7468 6174 2063 616e 2062 6520 696e 7365  that can be inse
-00022560: 7274 6564 3a0a 0a20 2020 2020 2020 202d  rted:..        -
-00022570: 2073 7472 2c20 696e 742c 2066 6c6f 6174   str, int, float
-00022580: 0a0a 2020 2020 2020 2020 2d20 6469 6374  ..        - dict
-00022590: 206f 6620 6469 6374 206f 7220 6469 6374   of dict or dict
-000225a0: 206f 6620 6c69 7374 0a0a 2020 2020 2020   of list..      
-000225b0: 2020 2d20 6c69 7374 206f 6620 7374 7220    - list of str 
-000225c0: 7468 6174 2072 6570 7265 7365 6e74 7320  that represents 
-000225d0: 6375 7272 656e 7420 6469 6d65 6e73 696f  current dimensio
-000225e0: 6e73 0a0a 2020 2020 2020 2020 2d20 6e70  ns..        - np
-000225f0: 2e64 7479 7065 2c20 7479 7065 0a0a 2020  .dtype, type..  
-00022600: 2020 2020 2020 4361 7365 2031 3a20 7374        Case 1: st
-00022610: 722c 2069 6e74 2c20 666c 6f61 7420 6172  r, int, float ar
-00022620: 6520 7661 6c69 6420 666f 7220 6e6f 6e2d  e valid for non-
-00022630: 656d 7074 7920 6172 7261 7973 2e20 496e  empty arrays. In
-00022640: 2074 6869 7320 6361 7365 2c20 7765 2069   this case, we i
-00022650: 6e73 6572 7420 6120 6e65 7720 6469 6d65  nsert a new dime
-00022660: 6e73 696f 6e20 7769 7468 206f 6e6c 7920  nsion with only 
-00022670: 6f6e 6520 656c 656d 656e 742e 0a20 2020  one element..   
-00022680: 2020 2020 2043 6173 6520 3220 616e 6420       Case 2 and 
-00022690: 333a 2064 6963 7420 6f66 2064 6963 7420  3: dict of dict 
-000226a0: 6f72 2064 6963 7420 6f66 206c 6973 7420  or dict of list 
-000226b0: 6172 6520 7661 6c69 6420 666f 7220 6e6f  are valid for no
-000226c0: 6e2d 656d 7074 7920 6172 7261 7973 2e20  n-empty arrays. 
-000226d0: 496e 2074 6869 7320 6361 7365 2c20 7765  In this case, we
-000226e0: 2069 6e73 6572 7420 6120 6e65 7720 6469   insert a new di
-000226f0: 6d65 6e73 696f 6e20 7768 6963 6820 6973  mension which is
-00022700: 206d 6170 7065 6420 6261 7365 6420 6f6e   mapped based on
-00022710: 2061 2065 7869 7374 696e 6720 6469 6d65   a existing dime
-00022720: 6e73 696f 6e20 636f 6f72 6469 6e61 7465  nsion coordinate
-00022730: 732e 0a20 2020 2020 2020 2043 6173 6520  s..        Case 
-00022740: 343a 206c 6973 7420 6f66 2073 7472 2061  4: list of str a
-00022750: 7265 2076 616c 6964 2066 6f72 206e 6f6e  re valid for non
-00022760: 2d65 6d70 7479 2061 7272 6179 732e 2049  -empty arrays. I
-00022770: 6e20 7468 6973 2063 6173 652c 2077 6520  n this case, we 
-00022780: 696e 7365 7274 2061 206e 6577 2064 696d  insert a new dim
-00022790: 656e 7369 6f6e 2077 6974 6820 7468 6520  ension with the 
-000227a0: 636f 6e63 6174 656e 6174 696f 6e20 6f66  concatenation of
-000227b0: 2065 6c65 6d65 6e74 7320 6f66 2074 6865   elements of the
-000227c0: 2063 6f72 7265 7370 6f6e 6469 6e67 2064   corresponding d
-000227d0: 696d 7320 696e 2074 6865 206c 6973 742e  ims in the list.
-000227e0: 0a20 2020 2020 2020 2043 6173 6520 353a  .        Case 5:
-000227f0: 2074 7970 6573 2061 7265 206f 6e6c 7920   types are only 
-00022800: 7661 6c69 6420 666f 7220 656d 7074 7920  valid for empty 
-00022810: 6172 7261 7973 2e20 496e 206f 7264 6572  arrays. In order
-00022820: 2074 6f20 696e 7365 7274 2061 2064 696d   to insert a dim
-00022830: 656e 7369 6f6e 2077 6974 6820 6120 6474  ension with a dt
-00022840: 7970 652c 2077 6520 6e65 6564 2074 6f20  ype, we need to 
-00022850: 6372 6561 7465 2061 6e20 656d 7074 7920  create an empty 
-00022860: 6172 7261 790a 0a20 2020 2020 2020 2041  array..        A
-00022870: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-00022880: 202a 2a6b 7761 7267 733a 204b 6579 776f   **kwargs: Keywo
-00022890: 7264 2061 7267 756d 656e 7473 2073 7065  rd arguments spe
-000228a0: 6369 6679 696e 6720 7468 6520 6e65 7720  cifying the new 
-000228b0: 6469 6d65 6e73 696f 6e73 2061 6e64 2074  dimensions and t
-000228c0: 6865 6972 2076 616c 7565 732e 0a0a 2020  heir values...  
-000228d0: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
-000228e0: 2020 2020 2020 2020 2020 2041 206e 6577             A new
-000228f0: 2041 7272 6179 206f 626a 6563 7420 7769   Array object wi
-00022900: 7468 2074 6865 2069 6e73 6572 7465 6420  th the inserted 
-00022910: 6469 6d65 6e73 696f 6e73 2e0a 0a20 2020  dimensions...   
-00022920: 2020 2020 2045 7861 6d70 6c65 3a0a 2020       Example:.  
-00022930: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
-00022940: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
-00022950: 3e3e 3e20 2320 4361 7365 2031 3a20 7374  >>> # Case 1: st
-00022960: 722c 2069 6e74 2c20 666c 6f61 740a 0a20  r, int, float.. 
-00022970: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
-00022980: 7272 203d 2041 7272 6179 2864 6174 613d  rr = Array(data=
-00022990: 287b 2764 696d 3127 3a5b 2761 272c 2762  ({'dim1':['a','b
-000229a0: 275d 2c20 2764 696d 3227 3a5b 312c 325d  '], 'dim2':[1,2]
-000229b0: 7d2c 5b31 2e30 2c20 322e 305d 292c 2063  },[1.0, 2.0]), c
-000229c0: 6f6f 7264 733d 7b27 6469 6d31 273a 5b27  oords={'dim1':['
-000229d0: 6127 2c27 6227 5d2c 2027 6469 6d32 273a  a','b'], 'dim2':
-000229e0: 5b31 2c32 5d7d 290a 0a20 2020 2020 2020  [1,2]})..       
-000229f0: 2020 2020 203e 3e3e 206e 6577 5f61 7272       >>> new_arr
-00022a00: 203d 2061 7272 2e69 6e73 6572 7428 6469   = arr.insert(di
-00022a10: 6d33 3d27 6327 290a 0a20 2020 2020 2020  m3='c')..       
-00022a20: 2020 2020 203e 3e3e 206e 6577 5f61 7272       >>> new_arr
-00022a30: 0a20 2020 2020 2020 2020 2020 2041 7272  .            Arr
-00022a40: 6179 2864 6174 613d 6172 7261 7928 5b5b  ay(data=array([[
-00022a50: 5b31 2e2c 2030 2e5d 2c0a 2020 2020 2020  [1., 0.],.      
-00022a60: 2020 2020 2020 2020 2020 2020 2020 5b30                [0
-00022a70: 2e2c 2032 2e5d 5d5d 292c 2063 6f6f 7264  ., 2.]]]), coord
-00022a80: 733d 7b27 6469 6d33 273a 2061 7272 6179  s={'dim3': array
-00022a90: 285b 2763 275d 2c20 6474 7970 653d 6f62  (['c'], dtype=ob
-00022aa0: 6a65 6374 292c 2027 6469 6d31 273a 2061  ject), 'dim1': a
-00022ab0: 7272 6179 285b 2761 272c 2027 6227 5d2c  rray(['a', 'b'],
-00022ac0: 2064 7479 7065 3d6f 626a 6563 7429 2c20   dtype=object), 
-00022ad0: 2764 696d 3227 3a20 6172 7261 7928 5b31  'dim2': array([1
-00022ae0: 2c20 325d 297d 290a 0a20 2020 2020 2020  , 2])})..       
-00022af0: 2020 2020 203e 3e3e 2023 2043 6173 6520       >>> # Case 
-00022b00: 323a 2064 6963 7420 6f66 2064 6963 740a  2: dict of dict.
-00022b10: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00022b20: 2061 7272 203d 2041 7272 6179 2864 6174   arr = Array(dat
-00022b30: 613d 287b 2764 696d 3127 3a5b 2761 272c  a=({'dim1':['a',
-00022b40: 2762 275d 2c20 2764 696d 3227 3a5b 312c  'b'], 'dim2':[1,
-00022b50: 325d 7d2c 5b31 2e30 2c20 322e 305d 292c  2]},[1.0, 2.0]),
-00022b60: 2063 6f6f 7264 733d 7b27 6469 6d31 273a   coords={'dim1':
-00022b70: 5b27 6127 2c27 6227 5d2c 2027 6469 6d32  ['a','b'], 'dim2
-00022b80: 273a 5b31 2c32 5d7d 290a 0a20 2020 2020  ':[1,2]})..     
-00022b90: 2020 2020 2020 203e 3e3e 206e 6577 5f61         >>> new_a
-00022ba0: 7272 203d 2061 7272 2e69 6e73 6572 7428  rr = arr.insert(
-00022bb0: 6469 6d33 3d7b 2764 696d 3127 3a7b 2761  dim3={'dim1':{'a
-00022bc0: 273a 2763 272c 2027 6227 3a27 6327 7d7d  ':'c', 'b':'c'}}
-00022bd0: 290a 0a20 2020 2020 2020 2020 2020 203e  )..            >
-00022be0: 3e3e 2023 2043 6173 6520 333a 2064 6963  >> # Case 3: dic
-00022bf0: 7420 6f66 206c 6973 740a 0a20 2020 2020  t of list..     
-00022c00: 2020 2020 2020 203e 3e3e 206e 6577 5f61         >>> new_a
-00022c10: 7272 203d 2061 7272 2e69 6e73 6572 7428  rr = arr.insert(
-00022c20: 6469 6d33 3d7b 2764 696d 3127 3a5b 5b27  dim3={'dim1':[['
-00022c30: 6127 2c27 6227 5d2c 5b27 6327 2c20 2763  a','b'],['c', 'c
-00022c40: 275d 5d7d 290a 0a20 2020 2020 2020 2020  ']]})..         
-00022c50: 2020 203e 3e3e 206e 6577 5f61 7272 0a20     >>> new_arr. 
-00022c60: 2020 2020 2020 2020 2020 2041 7272 6179             Array
-00022c70: 2864 6174 613d 6172 7261 7928 5b5b 5b31  (data=array([[[1
-00022c80: 2e2c 2030 2e5d 2c0a 2020 2020 2020 2020  ., 0.],.        
-00022c90: 2020 2020 2020 2020 2020 2020 5b30 2e2c              [0.,
-00022ca0: 2032 2e5d 5d5d 292c 2063 6f6f 7264 733d   2.]]]), coords=
-00022cb0: 7b27 6469 6d33 273a 2061 7272 6179 285b  {'dim3': array([
-00022cc0: 2763 275d 2c20 6474 7970 653d 6f62 6a65  'c'], dtype=obje
-00022cd0: 6374 292c 2027 6469 6d31 273a 2061 7272  ct), 'dim1': arr
-00022ce0: 6179 285b 2761 272c 2027 6227 5d2c 2064  ay(['a', 'b'], d
-00022cf0: 7479 7065 3d6f 626a 6563 7429 2c20 2764  type=object), 'd
-00022d00: 696d 3227 3a20 6172 7261 7928 5b31 2c20  im2': array([1, 
-00022d10: 325d 297d 290a 0a20 2020 2020 2020 2020  2])})..         
-00022d20: 2020 203e 3e3e 2023 2043 6173 6520 343a     >>> # Case 4:
-00022d30: 206c 6973 7420 6f66 2064 696d 7320 2873   list of dims (s
-00022d40: 7472 290a 0a20 2020 2020 2020 2020 2020  tr)..           
-00022d50: 203e 3e3e 2061 7272 203d 2041 7272 6179   >>> arr = Array
-00022d60: 2864 6174 613d 287b 2764 696d 3127 3a5b  (data=({'dim1':[
-00022d70: 2761 272c 2762 275d 2c20 2764 696d 3227  'a','b'], 'dim2'
-00022d80: 3a5b 312c 325d 7d2c 5b31 2e30 2c20 322e  :[1,2]},[1.0, 2.
-00022d90: 305d 292c 2063 6f6f 7264 733d 7b27 6469  0]), coords={'di
-00022da0: 6d31 273a 5b27 6127 2c27 6227 5d2c 2027  m1':['a','b'], '
-00022db0: 6469 6d32 273a 5b31 2c32 5d7d 290a 0a20  dim2':[1,2]}).. 
-00022dc0: 2020 2020 2020 2020 2020 203e 3e3e 206e             >>> n
-00022dd0: 6577 5f61 7272 203d 2061 7272 2e69 6e73  ew_arr = arr.ins
-00022de0: 6572 7428 6469 6d33 3d5b 2764 696d 3127  ert(dim3=['dim1'
-00022df0: 2c20 2764 696d 3227 5d29 0a0a 2020 2020  , 'dim2'])..    
-00022e00: 2020 2020 2020 2020 3e3e 3e20 6e65 775f          >>> new_
-00022e10: 6172 720a 2020 2020 2020 2020 2020 2020  arr.            
-00022e20: 4172 7261 7928 6461 7461 3d61 7272 6179  Array(data=array
-00022e30: 285b 5b5b 312e 2c20 302e 5d2c 0a20 2020  ([[[1., 0.],.   
-00022e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e50: 205b 302e 2c20 302e 5d5d 2c0a 2020 2020   [0., 0.]],.    
-00022e60: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-00022e70: 4e45 3e0a 2020 2020 2020 2020 2020 2020  NE>.            
-00022e80: 2020 2020 2020 205b 5b30 2e2c 2030 2e5d         [[0., 0.]
-00022e90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00022ea0: 2020 2020 2020 5b30 2e2c 2030 2e5d 5d2c        [0., 0.]],
-00022eb0: 0a20 2020 2020 2020 2020 2020 203c 424c  .            <BL
-00022ec0: 414e 4b4c 494e 453e 0a20 2020 2020 2020  ANKLINE>.       
-00022ed0: 2020 2020 2020 2020 2020 2020 5b5b 302e              [[0.
-00022ee0: 2c20 302e 5d2c 0a20 2020 2020 2020 2020  , 0.],.         
-00022ef0: 2020 2020 2020 2020 2020 205b 302e 2c20             [0., 
-00022f00: 302e 5d5d 2c0a 2020 2020 2020 2020 2020  0.]],.          
-00022f10: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00022f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f30: 205b 5b30 2e2c 2030 2e5d 2c0a 2020 2020   [[0., 0.],.    
-00022f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f50: 5b30 2e2c 2032 2e5d 5d5d 292c 2063 6f6f  [0., 2.]]]), coo
-00022f60: 7264 733d 7b27 6469 6d33 273a 2061 7272  rds={'dim3': arr
-00022f70: 6179 285b 2761 3a31 272c 2027 613a 3227  ay(['a:1', 'a:2'
-00022f80: 2c20 2762 3a31 272c 2027 623a 3227 5d2c  , 'b:1', 'b:2'],
-00022f90: 2064 7479 7065 3d6f 626a 6563 7429 2c20   dtype=object), 
-00022fa0: 2764 696d 3127 3a20 6172 7261 7928 5b27  'dim1': array(['
-00022fb0: 6127 2c20 2762 275d 2c20 6474 7970 653d  a', 'b'], dtype=
-00022fc0: 6f62 6a65 6374 292c 2027 6469 6d32 273a  object), 'dim2':
-00022fd0: 2061 7272 6179 285b 312c 2032 5d29 7d29   array([1, 2])})
-00022fe0: 0a0a 2020 2020 2020 2020 2020 2020 3e3e  ..            >>
-00022ff0: 3e20 2320 4361 7365 2035 3a20 7479 7065  > # Case 5: type
-00023000: 730a 0a20 2020 2020 2020 2020 2020 203e  s..            >
-00023010: 3e3e 2061 7272 203d 2041 7272 6179 2864  >> arr = Array(d
-00023020: 6174 613d 287b 2764 696d 3127 3a5b 5d2c  ata=({'dim1':[],
-00023030: 2027 6469 6d32 273a 5b5d 7d2c 5b5d 292c   'dim2':[]},[]),
-00023040: 2063 6f6f 7264 733d 7b27 6469 6d31 273a   coords={'dim1':
-00023050: 5b5d 2c20 2764 696d 3227 3a5b 5d7d 290a  [], 'dim2':[]}).
-00023060: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00023070: 206e 6577 5f61 7272 203d 2061 7272 2e69   new_arr = arr.i
-00023080: 6e73 6572 7428 6469 6d33 3d6e 702e 6474  nsert(dim3=np.dt
-00023090: 7970 6528 2769 6e74 3634 2729 290a 0a20  ype('int64')).. 
-000230a0: 2020 2020 2020 2020 2020 203e 3e3e 206e             >>> n
-000230b0: 6577 5f61 7272 0a20 2020 2020 2020 2020  ew_arr.         
-000230c0: 2020 2041 7272 6179 2864 6174 613d 6172     Array(data=ar
-000230d0: 7261 7928 5b5d 2c20 7368 6170 653d 2830  ray([], shape=(0
-000230e0: 2c20 302c 2030 2929 2c20 636f 6f72 6473  , 0, 0)), coords
-000230f0: 3d7b 2764 696d 3327 3a20 6172 7261 7928  ={'dim3': array(
-00023100: 5b5d 292c 2027 6469 6d31 273a 2061 7272  []), 'dim1': arr
-00023110: 6179 285b 5d29 2c20 2764 696d 3227 3a20  ay([]), 'dim2': 
-00023120: 6172 7261 7928 5b5d 297d 290a 0a20 2020  array([])})..   
-00023130: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
-00023140: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00023150: 2063 6f6f 7264 7320 3d20 7b7d 0a20 2020   coords = {}.   
-00023160: 2020 2020 2066 6f72 206e 6577 5f64 696d       for new_dim
-00023170: 2069 6e20 6b77 6172 6773 3a0a 2020 2020   in kwargs:.    
-00023180: 2020 2020 2020 2020 6173 7365 7274 206e          assert n
-00023190: 6577 5f64 696d 206e 6f74 2069 6e20 7365  ew_dim not in se
-000231a0: 6c66 2e64 696d 732c 2066 226e 6577 2064  lf.dims, f"new d
-000231b0: 696d 656e 7369 6f6e 206e 616d 6520 277b  imension name '{
-000231c0: 6e65 775f 6469 6d7d 2720 6d75 7374 206e  new_dim}' must n
-000231d0: 6f74 2065 7869 7374 2069 6e20 7468 6520  ot exist in the 
-000231e0: 6578 6973 7469 6e67 2064 696d 656e 7369  existing dimensi
-000231f0: 6f6e 7322 0a20 2020 2020 2020 2020 2020  ons".           
-00023200: 2076 616c 7565 203d 206b 7761 7267 735b   value = kwargs[
-00023210: 6e65 775f 6469 6d5d 0a20 2020 2020 2020  new_dim].       
-00023220: 2020 2020 2023 2064 7479 7065 206f 7220       # dtype or 
-00023230: 7479 7065 206f 6e6c 7920 776f 726b 7320  type only works 
-00023240: 666f 7220 666f 7220 656d 7074 7920 6172  for for empty ar
-00023250: 7261 7973 2e20 496e 206f 7264 6572 2074  rays. In order t
-00023260: 6f20 696e 7365 7274 2061 2064 696d 656e  o insert a dimen
-00023270: 7369 6f6e 2077 6974 6820 6120 6474 7970  sion with a dtyp
-00023280: 652c 2077 6520 6e65 6564 2074 6f20 6372  e, we need to cr
-00023290: 6561 7465 2061 6e20 656d 7074 7920 6172  eate an empty ar
-000232a0: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-000232b0: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
-000232c0: 6c75 652c 2028 6e70 2e64 7479 7065 2c20  lue, (np.dtype, 
-000232d0: 7479 7065 2929 3a0a 2020 2020 2020 2020  type)):.        
-000232e0: 2020 2020 2020 2020 6669 6775 7265 7320          figures 
-000232f0: 3d20 6e70 2e61 7272 6179 285b 5d2c 2064  = np.array([], d
-00023300: 7479 7065 3d76 616c 7565 290a 2020 2020  type=value).    
-00023310: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
-00023320: 6473 5b6e 6577 5f64 696d 5d20 3d20 5f74  ds[new_dim] = _t
-00023330: 6573 745f 7479 7065 5f61 6e64 5f75 7064  est_type_and_upd
-00023340: 6174 6528 6669 6775 7265 7329 0a20 2020  ate(figures).   
-00023350: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
-00023360: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
-00023370: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
-00023380: 2020 2020 2020 636f 6f72 6473 5b6e 6577        coords[new
-00023390: 5f64 696d 5d20 3d20 6e70 2e61 7272 6179  _dim] = np.array
-000233a0: 285b 7661 6c75 655d 2c20 6474 7970 653d  ([value], dtype=
-000233b0: 6e70 2e6f 626a 6563 745f 290a 2020 2020  np.object_).    
-000233c0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-000233d0: 6e73 7461 6e63 6528 7661 6c75 652c 2069  nstance(value, i
-000233e0: 6e74 293a 0a20 2020 2020 2020 2020 2020  nt):.           
-000233f0: 2020 2020 2063 6f6f 7264 735b 6e65 775f       coords[new_
-00023400: 6469 6d5d 203d 206e 702e 6172 7261 7928  dim] = np.array(
-00023410: 5b76 616c 7565 5d2c 2064 7479 7065 3d6e  [value], dtype=n
-00023420: 702e 696e 7433 3229 0a20 2020 2020 2020  p.int32).       
-00023430: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-00023440: 616e 6365 2876 616c 7565 2c20 666c 6f61  ance(value, floa
-00023450: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-00023460: 2020 2020 636f 6f72 6473 5b6e 6577 5f64      coords[new_d
-00023470: 696d 5d20 3d20 6e70 2e61 7272 6179 285b  im] = np.array([
-00023480: 7661 6c75 655d 2c20 6474 7970 653d 6e70  value], dtype=np
-00023490: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
-000234a0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-000234b0: 7461 6e63 6528 7661 6c75 652c 2064 6963  tance(value, dic
-000234c0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-000234d0: 2020 2020 6173 7365 7274 206c 656e 280a      assert len(.
-000234e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000234f0: 2020 2020 7661 6c75 6529 203d 3d20 312c      value) == 1,
-00023500: 2066 2256 616c 7565 2061 7373 6f63 6961   f"Value associa
-00023510: 7465 6420 7769 7468 2027 7b6e 6577 5f64  ted with '{new_d
-00023520: 696d 7d27 206d 7573 7420 6265 2061 2064  im}' must be a d
-00023530: 6963 7420 7769 7468 206f 6e65 206b 6579  ict with one key
-00023540: 2e20 476f 7420 7b76 616c 7565 7d22 0a20  . Got {value}". 
-00023550: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00023560: 7869 7374 696e 675f 6469 6d20 3d20 6e65  xisting_dim = ne
-00023570: 7874 2869 7465 7228 7661 6c75 6529 290a  xt(iter(value)).
-00023580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023590: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
-000235a0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-000235b0: 2020 2020 2020 2065 7869 7374 696e 675f         existing_
-000235c0: 6469 6d2c 2073 7472 292c 2066 2256 616c  dim, str), f"Val
-000235d0: 7565 2061 7373 6f63 6961 7465 6420 7769  ue associated wi
-000235e0: 7468 2027 7b6e 6577 5f64 696d 7d27 206d  th '{new_dim}' m
-000235f0: 7573 7420 6265 2061 2073 7472 2e20 476f  ust be a str. Go
-00023600: 7420 7b74 7970 6528 6578 6973 7469 6e67  t {type(existing
-00023610: 5f64 696d 297d 220a 2020 2020 2020 2020  _dim)}".        
-00023620: 2020 2020 2020 2020 6173 7365 7274 2065          assert e
-00023630: 7869 7374 696e 675f 6469 6d20 696e 2073  xisting_dim in s
-00023640: 656c 662e 6469 6d73 2c20 6622 5661 6c75  elf.dims, f"Valu
-00023650: 6520 6173 736f 6369 6174 6564 2077 6974  e associated wit
-00023660: 6820 277b 6e65 775f 6469 6d7d 2720 616e  h '{new_dim}' an
-00023670: 6420 277b 6578 6973 7469 6e67 5f64 696d  d '{existing_dim
-00023680: 7d27 206d 7573 7420 6265 2069 6e20 7b73  }' must be in {s
-00023690: 656c 662e 6469 6d73 7d22 0a20 2020 2020  elf.dims}".     
-000236a0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-000236b0: 7420 6973 696e 7374 616e 6365 2876 616c  t isinstance(val
-000236c0: 7565 5b65 7869 7374 696e 675f 6469 6d5d  ue[existing_dim]
-000236d0: 2c20 280a 2020 2020 2020 2020 2020 2020  , (.            
-000236e0: 2020 2020 2020 2020 6469 6374 2c20 6c69          dict, li
-000236f0: 7374 2929 2c20 6622 5661 6c75 6520 6173  st)), f"Value as
-00023700: 736f 6369 6174 6564 2077 6974 6820 277b  sociated with '{
-00023710: 6e65 775f 6469 6d7d 2720 616e 6420 277b  new_dim}' and '{
-00023720: 6578 6973 7469 6e67 5f64 696d 7d27 206d  existing_dim}' m
-00023730: 7573 7420 6265 2061 2064 6963 7420 6f72  ust be a dict or
-00023740: 206c 6973 742e 2047 6f74 207b 7479 7065   list. Got {type
-00023750: 2876 616c 7565 5b65 7869 7374 696e 675f  (value[existing_
-00023760: 6469 6d5d 297d 220a 2020 2020 2020 2020  dim])}".        
-00023770: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00023780: 7461 6e63 6528 7661 6c75 655b 6578 6973  tance(value[exis
-00023790: 7469 6e67 5f64 696d 5d2c 2064 6963 7429  ting_dim], dict)
-000237a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000237b0: 2020 2020 2020 6f6c 645f 6469 6d5f 6974        old_dim_it
-000237c0: 656d 735f 7365 7420 3d20 7365 7428 7661  ems_set = set(va
-000237d0: 6c75 655b 6578 6973 7469 6e67 5f64 696d  lue[existing_dim
-000237e0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-000237f0: 2020 2020 2020 2061 7373 6572 7420 7365         assert se
-00023800: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00023810: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00023820: 636f 6f72 6473 5b65 7869 7374 696e 675f  coords[existing_
-00023830: 6469 6d5d 2920 3d3d 206f 6c64 5f64 696d  dim]) == old_dim
-00023840: 5f69 7465 6d73 5f73 6574 2c20 6622 416c  _items_set, f"Al
-00023850: 6c20 6974 656d 7320 6173 736f 6369 6174  l items associat
-00023860: 6564 2077 6974 6820 277b 6e65 775f 6469  ed with '{new_di
-00023870: 6d7d 2720 6d75 7374 206d 6174 6368 2065  m}' must match e
-00023880: 6c65 6d65 6e74 7320 696e 202e 636f 6f72  lements in .coor
-00023890: 6473 5b27 7b65 7869 7374 696e 675f 6469  ds['{existing_di
-000238a0: 6d7d 275d 2e20 5468 6520 6375 7272 656e  m}']. The curren
-000238b0: 7420 6d61 7070 696e 6720 6469 6374 696f  t mapping dictio
-000238c0: 6e61 7279 2062 6574 7765 656e 2027 7b6e  nary between '{n
-000238d0: 6577 5f64 696d 7d27 2061 6e64 2027 7b65  ew_dim}' and '{e
-000238e0: 7869 7374 696e 675f 6469 6d7d 2720 6973  xisting_dim}' is
-000238f0: 206d 6174 6368 6564 2070 6172 7469 616c   matched partial
-00023900: 6c79 220a 2020 2020 2020 2020 2020 2020  ly".            
-00023910: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-00023920: 656e 2876 616c 7565 5b65 7869 7374 696e  en(value[existin
-00023930: 675f 6469 6d5d 2920 3d3d 206c 656e 280a  g_dim]) == len(.
-00023940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023950: 2020 2020 2020 2020 6f6c 645f 6469 6d5f          old_dim_
-00023960: 6974 656d 735f 7365 7429 2c20 6622 5468  items_set), f"Th
-00023970: 6572 6520 6172 6520 6475 706c 6963 6174  ere are duplicat
-00023980: 6520 6974 656d 7320 696e 2074 6865 206d  e items in the m
-00023990: 6170 7069 6e67 2064 6963 7420 6173 736f  apping dict asso
-000239a0: 6369 6174 6564 2077 6974 6820 277b 6e65  ciated with '{ne
-000239b0: 775f 6469 6d7d 2720 616e 6420 277b 6578  w_dim}' and '{ex
-000239c0: 6973 7469 6e67 5f64 696d 7d27 220a 2020  isting_dim}'".  
-000239d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000239e0: 2020 636f 6f72 6473 5b6e 6577 5f64 696d    coords[new_dim
-000239f0: 5d20 3d20 6e70 2e75 6e69 7175 6528 5f74  ] = np.unique(_t
-00023a00: 6573 745f 7479 7065 5f61 6e64 5f75 7064  est_type_and_upd
-00023a10: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
-00023a20: 2020 2020 2020 2020 2020 2020 206c 6973               lis
-00023a30: 7428 7661 6c75 655b 6578 6973 7469 6e67  t(value[existing
-00023a40: 5f64 696d 5d2e 7661 6c75 6573 2829 2929  _dim].values()))
-00023a50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00023a60: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-00023a70: 6528 7661 6c75 655b 6578 6973 7469 6e67  e(value[existing
-00023a80: 5f64 696d 5d2c 206c 6973 7429 3a0a 2020  _dim], list):.  
-00023a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023aa0: 2020 6173 7365 7274 206c 656e 280a 2020    assert len(.  
-00023ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ac0: 2020 2020 2020 7661 6c75 655b 6578 6973        value[exis
-00023ad0: 7469 6e67 5f64 696d 5d29 203d 3d20 322c  ting_dim]) == 2,
-00023ae0: 2066 2256 616c 7565 2061 7373 6f63 6961   f"Value associa
-00023af0: 7465 6420 7769 7468 2027 7b6e 6577 5f64  ted with '{new_d
-00023b00: 696d 7d27 2061 6e64 2027 7b65 7869 7374  im}' and '{exist
-00023b10: 696e 675f 6469 6d7d 2720 6d75 7374 2062  ing_dim}' must b
-00023b20: 6520 6120 6c69 7374 2077 6974 6820 7477  e a list with tw
-00023b30: 6f20 6974 656d 732e 2047 6f74 207b 7661  o items. Got {va
-00023b40: 6c75 655b 6578 6973 7469 6e67 5f64 696d  lue[existing_dim
-00023b50: 5d7d 220a 2020 2020 2020 2020 2020 2020  ]}".            
-00023b60: 2020 2020 2020 2020 6f6c 645f 6469 6d5f          old_dim_
-00023b70: 6974 656d 735f 7365 7420 3d20 7365 7428  items_set = set(
-00023b80: 7661 6c75 655b 6578 6973 7469 6e67 5f64  value[existing_d
-00023b90: 696d 5d5b 305d 290a 2020 2020 2020 2020  im][0]).        
-00023ba0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00023bb0: 7274 2073 6574 280a 2020 2020 2020 2020  rt set(.        
-00023bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023bd0: 7365 6c66 2e63 6f6f 7264 735b 6578 6973  self.coords[exis
-00023be0: 7469 6e67 5f64 696d 5d29 203d 3d20 6f6c  ting_dim]) == ol
-00023bf0: 645f 6469 6d5f 6974 656d 735f 7365 742c  d_dim_items_set,
-00023c00: 2066 2241 6c6c 2069 7465 6d73 2069 6e20   f"All items in 
-00023c10: 7468 6520 6d61 7070 696e 6720 6469 6374  the mapping dict
-00023c20: 2061 7373 6f63 6961 7465 6420 7769 7468   associated with
-00023c30: 2027 7b6e 6577 5f64 696d 7d27 2061 6e64   '{new_dim}' and
-00023c40: 2027 7b65 7869 7374 696e 675f 6469 6d7d   '{existing_dim}
-00023c50: 2720 6d75 7374 2062 6520 696e 636c 7564  ' must be includ
-00023c60: 6564 2069 6e20 2e63 6f6f 7264 735b 277b  ed in .coords['{
-00023c70: 6578 6973 7469 6e67 5f64 696d 7d27 5d22  existing_dim}']"
-00023c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023c90: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-00023ca0: 7661 6c75 655b 6578 6973 7469 6e67 5f64  value[existing_d
-00023cb0: 696d 5d5b 305d 2920 3d3d 206c 656e 280a  im][0]) == len(.
-00023cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023cd0: 2020 2020 2020 2020 6f6c 645f 6469 6d5f          old_dim_
-00023ce0: 6974 656d 735f 7365 7429 2c20 6622 5468  items_set), f"Th
-00023cf0: 6572 6520 6172 6520 6475 706c 6963 6174  ere are duplicat
-00023d00: 6520 6974 656d 7320 696e 2074 6865 206d  e items in the m
-00023d10: 6170 7069 6e67 2064 6963 7420 6173 736f  apping dict asso
-00023d20: 6369 6174 6564 2077 6974 6820 277b 6e65  ciated with '{ne
-00023d30: 775f 6469 6d7d 2720 616e 6420 277b 6578  w_dim}' and '{ex
-00023d40: 6973 7469 6e67 5f64 696d 7d27 220a 2020  isting_dim}'".  
-00023d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d60: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00023d70: 7661 6c75 655b 6578 6973 7469 6e67 5f64  value[existing_d
-00023d80: 696d 5d5b 305d 2c20 6c69 7374 293a 0a20  im][0], list):. 
+00016610: 636f 6f72 6473 3220 3d20 7b27 6469 6d31  coords2 = {'dim1
+00016620: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+00016630: 6469 6d32 273a 205b 312c 2032 5d7d 0a20  dim2': [1, 2]}. 
+00016640: 2020 2020 2020 2020 2020 203e 3e3e 206c             >>> l
+00016650: 6f6e 6732 203d 204c 6f6e 6728 696e 6465  ong2 = Long(inde
+00016660: 783d 7b27 6469 6d31 273a 205b 2761 272c  x={'dim1': ['a',
+00016670: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
+00016680: 312c 2032 5d7d 2c20 7661 6c75 653d 5b33  1, 2]}, value=[3
+00016690: 302c 2034 305d 290a 2020 2020 2020 2020  0, 40]).        
+000166a0: 2020 2020 3e3e 3e20 6172 7232 203d 2041      >>> arr2 = A
+000166b0: 7272 6179 2864 6174 613d 6c6f 6e67 322c  rray(data=long2,
+000166c0: 2063 6f6f 7264 733d 636f 6f72 6473 3229   coords=coords2)
+000166d0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+000166e0: 2061 7272 3120 2b20 6172 7232 0a20 2020   arr1 + arr2.   
+000166f0: 2020 2020 2020 2020 2041 7272 6179 2864           Array(d
+00016700: 6174 613d 6172 7261 7928 5b5b 3430 2e2c  ata=array([[40.,
+00016710: 2020 302e 5d2c 0a20 2020 2020 2020 2020    0.],.         
+00016720: 2020 2020 2020 2020 2020 5b20 302e 2c20            [ 0., 
+00016730: 3630 2e5d 5d29 2c20 636f 6f72 6473 3d7b  60.]]), coords={
+00016740: 2764 696d 3127 3a20 6172 7261 7928 5b27  'dim1': array(['
+00016750: 6127 2c20 2762 275d 2c20 6474 7970 653d  a', 'b'], dtype=
+00016760: 6f62 6a65 6374 292c 2027 6469 6d32 273a  object), 'dim2':
+00016770: 2061 7272 6179 285b 312c 2032 5d29 7d29   array([1, 2])})
+00016780: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00016790: 2061 7272 3120 2b20 350a 2020 2020 2020   arr1 + 5.      
+000167a0: 2020 2020 2020 4172 7261 7928 6461 7461        Array(data
+000167b0: 3d61 7272 6179 285b 5b31 352e 2c20 2035  =array([[15.,  5
+000167c0: 2e5d 2c0a 2020 2020 2020 2020 2020 2020  .],.            
+000167d0: 2020 2020 2020 205b 2035 2e2c 2032 352e         [ 5., 25.
+000167e0: 5d5d 292c 2063 6f6f 7264 733d 7b27 6469  ]]), coords={'di
+000167f0: 6d31 273a 2061 7272 6179 285b 2761 272c  m1': array(['a',
+00016800: 2027 6227 5d2c 2064 7479 7065 3d6f 626a   'b'], dtype=obj
+00016810: 6563 7429 2c20 2764 696d 3227 3a20 6172  ect), 'dim2': ar
+00016820: 7261 7928 5b31 2c20 325d 297d 290a 0a20  ray([1, 2])}).. 
+00016830: 2020 2020 2020 2020 2020 2060 6060 0a20             ```. 
+00016840: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00016850: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00016860: 286f 7468 6572 2c20 2869 6e74 2c20 666c  (other, (int, fl
+00016870: 6f61 7429 293a 0a20 2020 2020 2020 2020  oat)):.         
+00016880: 2020 2061 7272 203d 2073 656c 662e 6461     arr = self.da
+00016890: 7461 202b 206f 7468 6572 0a20 2020 2020  ta + other.     
+000168a0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000168b0: 6c66 2e5f 706f 7374 5f6f 7065 7261 7469  lf._post_operati
+000168c0: 6f6e 2861 7272 2c20 7365 6c66 2e63 6f6f  on(arr, self.coo
+000168d0: 7264 7329 0a20 2020 2020 2020 2065 6c69  rds).        eli
+000168e0: 6620 6973 696e 7374 616e 6365 286f 7468  f isinstance(oth
+000168f0: 6572 2c20 4172 7261 7929 3a0a 2020 2020  er, Array):.    
+00016900: 2020 2020 2020 2020 7365 6c66 5f61 7272          self_arr
+00016910: 2c20 6f74 6865 725f 6172 722c 2063 6f6f  , other_arr, coo
+00016920: 7264 7320 3d20 7365 6c66 2e5f 7072 655f  rds = self._pre_
+00016930: 6f70 6572 6174 696f 6e5f 7769 7468 5f61  operation_with_a
+00016940: 7272 6179 286f 7468 6572 290a 2020 2020  rray(other).    
+00016950: 2020 2020 2020 2020 6172 7220 3d20 7365          arr = se
+00016960: 6c66 2e5f 6f70 6572 6174 696f 6e28 7365  lf._operation(se
+00016970: 6c66 5f61 7272 2c20 6f74 6865 725f 6172  lf_arr, other_ar
+00016980: 722c 2027 5f5f 6164 645f 5f27 290a 2020  r, '__add__').  
+00016990: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000169a0: 2073 656c 662e 5f70 6f73 745f 6f70 6572   self._post_oper
+000169b0: 6174 696f 6e28 6172 722e 542c 2063 6f6f  ation(arr.T, coo
+000169c0: 7264 7329 0a0a 2020 2020 6465 6620 5f5f  rds)..    def __
+000169d0: 6d75 6c5f 5f28 7365 6c66 2c20 6f74 6865  mul__(self, othe
+000169e0: 723a 2055 6e69 6f6e 5b69 6e74 2c20 666c  r: Union[int, fl
+000169f0: 6f61 742c 2027 4172 7261 7927 5d29 202d  oat, 'Array']) -
+00016a00: 3e20 2741 7272 6179 273a 0a20 2020 2020  > 'Array':.     
+00016a10: 2020 2022 2222 0a20 2020 2020 2020 204d     """.        M
+00016a20: 756c 7469 706c 7920 7468 6520 4172 7261  ultiply the Arra
+00016a30: 7920 7769 7468 2061 6e6f 7468 6572 2041  y with another A
+00016a40: 7272 6179 206f 7220 6120 6e75 6d62 6572  rray or a number
+00016a50: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
+00016a60: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+00016a70: 6572 3a20 5468 6520 6f74 6865 7220 4172  er: The other Ar
+00016a80: 7261 7920 6f72 206e 756d 6265 7220 746f  ray or number to
+00016a90: 206d 756c 7469 706c 792e 0a0a 2020 2020   multiply...    
+00016aa0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+00016ab0: 2020 2020 2020 2020 2041 206e 6577 2041           A new A
+00016ac0: 7272 6179 206f 626a 6563 7420 7769 7468  rray object with
+00016ad0: 2074 6865 2072 6573 756c 7420 6f66 2074   the result of t
+00016ae0: 6865 206d 756c 7469 706c 6963 6174 696f  he multiplicatio
+00016af0: 6e2e 0a0a 2020 2020 2020 2020 4578 616d  n...        Exam
+00016b00: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
+00016b10: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+00016b20: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
+00016b30: 7331 203d 207b 2764 696d 3127 3a20 5b27  s1 = {'dim1': ['
+00016b40: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
+00016b50: 3a20 5b31 2c20 325d 7d0a 2020 2020 2020  : [1, 2]}.      
+00016b60: 2020 2020 2020 3e3e 3e20 6c6f 6e67 3120        >>> long1 
+00016b70: 3d20 4c6f 6e67 2869 6e64 6578 3d7b 2764  = Long(index={'d
+00016b80: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
+00016b90: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
+00016ba0: 7d2c 2076 616c 7565 3d5b 3130 2c20 3230  }, value=[10, 20
+00016bb0: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
+00016bc0: 3e3e 2061 7272 3120 3d20 4172 7261 7928  >> arr1 = Array(
+00016bd0: 6461 7461 3d6c 6f6e 6731 2c20 636f 6f72  data=long1, coor
+00016be0: 6473 3d63 6f6f 7264 7331 290a 2020 2020  ds=coords1).    
+00016bf0: 2020 2020 2020 2020 3e3e 3e20 636f 6f72          >>> coor
+00016c00: 6473 3220 3d20 7b27 6469 6d31 273a 205b  ds2 = {'dim1': [
+00016c10: 2761 272c 2027 6227 5d2c 2027 6469 6d32  'a', 'b'], 'dim2
+00016c20: 273a 205b 312c 2032 5d7d 0a20 2020 2020  ': [1, 2]}.     
+00016c30: 2020 2020 2020 203e 3e3e 206c 6f6e 6732         >>> long2
+00016c40: 203d 204c 6f6e 6728 696e 6465 783d 7b27   = Long(index={'
+00016c50: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
+00016c60: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
+00016c70: 5d7d 2c20 7661 6c75 653d 5b33 302c 2034  ]}, value=[30, 4
+00016c80: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
+00016c90: 3e3e 3e20 6172 7232 203d 2041 7272 6179  >>> arr2 = Array
+00016ca0: 2864 6174 613d 6c6f 6e67 322c 2063 6f6f  (data=long2, coo
+00016cb0: 7264 733d 636f 6f72 6473 3229 0a20 2020  rds=coords2).   
+00016cc0: 2020 2020 2020 2020 203e 3e3e 2061 7272           >>> arr
+00016cd0: 3120 2a20 6172 7232 0a20 2020 2020 2020  1 * arr2.       
+00016ce0: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
+00016cf0: 6172 7261 7928 5b5b 3330 302e 2c20 2020  array([[300.,   
+00016d00: 302e 5d2c 0a20 2020 2020 2020 2020 2020  0.],.           
+00016d10: 2020 2020 2020 2020 5b20 2030 2e2c 2038          [  0., 8
+00016d20: 3030 2e5d 5d29 2c20 636f 6f72 6473 3d7b  00.]]), coords={
+00016d30: 2764 696d 3127 3a20 6172 7261 7928 5b27  'dim1': array(['
+00016d40: 6127 2c20 2762 275d 2c20 6474 7970 653d  a', 'b'], dtype=
+00016d50: 6f62 6a65 6374 292c 2027 6469 6d32 273a  object), 'dim2':
+00016d60: 2061 7272 6179 285b 312c 2032 5d29 7d29   array([1, 2])})
+00016d70: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00016d80: 2061 7272 3120 2a20 350a 2020 2020 2020   arr1 * 5.      
+00016d90: 2020 2020 2020 4172 7261 7928 6461 7461        Array(data
+00016da0: 3d61 7272 6179 285b 5b20 3530 2e2c 2020  =array([[ 50.,  
+00016db0: 2030 2e5d 2c0a 2020 2020 2020 2020 2020   0.],.          
+00016dc0: 2020 2020 2020 2020 205b 2020 302e 2c20           [  0., 
+00016dd0: 3130 302e 5d5d 292c 2063 6f6f 7264 733d  100.]]), coords=
+00016de0: 7b27 6469 6d31 273a 2061 7272 6179 285b  {'dim1': array([
+00016df0: 2761 272c 2027 6227 5d2c 2064 7479 7065  'a', 'b'], dtype
+00016e00: 3d6f 626a 6563 7429 2c20 2764 696d 3227  =object), 'dim2'
+00016e10: 3a20 6172 7261 7928 5b31 2c20 325d 297d  : array([1, 2])}
+00016e20: 290a 0a20 2020 2020 2020 2020 2020 2060  )..            `
+00016e30: 6060 0a20 2020 2020 2020 2022 2222 0a20  ``.        """. 
+00016e40: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00016e50: 616e 6365 286f 7468 6572 2c20 2869 6e74  ance(other, (int
+00016e60: 2c20 666c 6f61 7429 293a 0a20 2020 2020  , float)):.     
+00016e70: 2020 2020 2020 2061 7272 203d 2073 656c         arr = sel
+00016e80: 662e 6461 7461 202a 206f 7468 6572 0a20  f.data * other. 
+00016e90: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00016ea0: 6e20 7365 6c66 2e5f 706f 7374 5f6f 7065  n self._post_ope
+00016eb0: 7261 7469 6f6e 2861 7272 2c20 7365 6c66  ration(arr, self
+00016ec0: 2e63 6f6f 7264 7329 0a20 2020 2020 2020  .coords).       
+00016ed0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+00016ee0: 286f 7468 6572 2c20 4172 7261 7929 3a0a  (other, Array):.
+00016ef0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00016f00: 5f61 7272 2c20 6f74 6865 725f 6172 722c  _arr, other_arr,
+00016f10: 2063 6f6f 7264 7320 3d20 7365 6c66 2e5f   coords = self._
+00016f20: 7072 655f 6f70 6572 6174 696f 6e5f 7769  pre_operation_wi
+00016f30: 7468 5f61 7272 6179 286f 7468 6572 290a  th_array(other).
+00016f40: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
+00016f50: 3d20 7365 6c66 2e5f 6f70 6572 6174 696f  = self._operatio
+00016f60: 6e28 7365 6c66 5f61 7272 2c20 6f74 6865  n(self_arr, othe
+00016f70: 725f 6172 722c 2027 5f5f 6d75 6c5f 5f27  r_arr, '__mul__'
+00016f80: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00016f90: 7475 726e 2073 656c 662e 5f70 6f73 745f  turn self._post_
+00016fa0: 6f70 6572 6174 696f 6e28 6172 722e 542c  operation(arr.T,
+00016fb0: 2063 6f6f 7264 7329 0a0a 2020 2020 6465   coords)..    de
+00016fc0: 6620 5f5f 7375 625f 5f28 7365 6c66 2c20  f __sub__(self, 
+00016fd0: 6f74 6865 723a 2055 6e69 6f6e 5b69 6e74  other: Union[int
+00016fe0: 2c20 666c 6f61 742c 2027 4172 7261 7927  , float, 'Array'
+00016ff0: 5d29 202d 3e20 2741 7272 6179 273a 0a20  ]) -> 'Array':. 
+00017000: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00017010: 2020 2053 7562 7472 6163 7420 616e 6f74     Subtract anot
+00017020: 6865 7220 4172 7261 7920 6f72 2061 206e  her Array or a n
+00017030: 756d 6265 7220 6672 6f6d 2074 6865 2041  umber from the A
+00017040: 7272 6179 2e0a 0a20 2020 2020 2020 2041  rray...        A
+00017050: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+00017060: 206f 7468 6572 3a20 5468 6520 6f74 6865   other: The othe
+00017070: 7220 4172 7261 7920 6f72 206e 756d 6265  r Array or numbe
+00017080: 7220 746f 2073 7562 7472 6163 742e 0a0a  r to subtract...
+00017090: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
+000170a0: 0a20 2020 2020 2020 2020 2020 2041 206e  .            A n
+000170b0: 6577 2041 7272 6179 206f 626a 6563 7420  ew Array object 
+000170c0: 7769 7468 2074 6865 2072 6573 756c 7420  with the result 
+000170d0: 6f66 2074 6865 2073 7562 7472 6163 7469  of the subtracti
+000170e0: 6f6e 2e0a 0a20 2020 2020 2020 2045 7861  on...        Exa
+000170f0: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
+00017100: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
+00017110: 2020 2020 2020 2020 3e3e 3e20 636f 6f72          >>> coor
+00017120: 6473 3120 3d20 7b27 6469 6d31 273a 205b  ds1 = {'dim1': [
+00017130: 2761 272c 2027 6227 5d2c 2027 6469 6d32  'a', 'b'], 'dim2
+00017140: 273a 205b 312c 2032 5d7d 0a20 2020 2020  ': [1, 2]}.     
+00017150: 2020 2020 2020 203e 3e3e 206c 6f6e 6731         >>> long1
+00017160: 203d 204c 6f6e 6728 696e 6465 783d 7b27   = Long(index={'
+00017170: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
+00017180: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
+00017190: 5d7d 2c20 7661 6c75 653d 5b31 302c 2032  ]}, value=[10, 2
+000171a0: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
+000171b0: 3e3e 3e20 6172 7231 203d 2041 7272 6179  >>> arr1 = Array
+000171c0: 2864 6174 613d 6c6f 6e67 312c 2063 6f6f  (data=long1, coo
+000171d0: 7264 733d 636f 6f72 6473 3129 0a20 2020  rds=coords1).   
+000171e0: 2020 2020 2020 2020 203e 3e3e 2063 6f6f           >>> coo
+000171f0: 7264 7332 203d 207b 2764 696d 3127 3a20  rds2 = {'dim1': 
+00017200: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
+00017210: 3227 3a20 5b31 2c20 325d 7d0a 2020 2020  2': [1, 2]}.    
+00017220: 2020 2020 2020 2020 3e3e 3e20 6c6f 6e67          >>> long
+00017230: 3220 3d20 4c6f 6e67 2869 6e64 6578 3d7b  2 = Long(index={
+00017240: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
+00017250: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
+00017260: 325d 7d2c 2076 616c 7565 3d5b 3330 2c20  2]}, value=[30, 
+00017270: 3430 5d29 0a20 2020 2020 2020 2020 2020  40]).           
+00017280: 203e 3e3e 2061 7272 3220 3d20 4172 7261   >>> arr2 = Arra
+00017290: 7928 6461 7461 3d6c 6f6e 6732 2c20 636f  y(data=long2, co
+000172a0: 6f72 6473 3d63 6f6f 7264 7332 290a 2020  ords=coords2).  
+000172b0: 2020 2020 2020 2020 2020 3e3e 3e20 6172            >>> ar
+000172c0: 7231 202d 2061 7272 320a 2020 2020 2020  r1 - arr2.      
+000172d0: 2020 2020 2020 4172 7261 7928 6461 7461        Array(data
+000172e0: 3d61 7272 6179 285b 5b2d 3230 2e2c 2020  =array([[-20.,  
+000172f0: 2030 2e5d 2c0a 2020 2020 2020 2020 2020   0.],.          
+00017300: 2020 2020 2020 2020 205b 2020 302e 2c20           [  0., 
+00017310: 2d32 302e 5d5d 292c 2063 6f6f 7264 733d  -20.]]), coords=
+00017320: 7b27 6469 6d31 273a 2061 7272 6179 285b  {'dim1': array([
+00017330: 2761 272c 2027 6227 5d2c 2064 7479 7065  'a', 'b'], dtype
+00017340: 3d6f 626a 6563 7429 2c20 2764 696d 3227  =object), 'dim2'
+00017350: 3a20 6172 7261 7928 5b31 2c20 325d 297d  : array([1, 2])}
+00017360: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00017370: 3e20 6172 7231 202d 2035 0a20 2020 2020  > arr1 - 5.     
+00017380: 2020 2020 2020 2041 7272 6179 2864 6174         Array(dat
+00017390: 613d 6172 7261 7928 5b5b 2035 2e2c 202d  a=array([[ 5., -
+000173a0: 352e 5d2c 0a20 2020 2020 2020 2020 2020  5.],.           
+000173b0: 2020 2020 2020 2020 5b2d 352e 2c20 3135          [-5., 15
+000173c0: 2e5d 5d29 2c20 636f 6f72 6473 3d7b 2764  .]]), coords={'d
+000173d0: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
+000173e0: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
+000173f0: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
+00017400: 7272 6179 285b 312c 2032 5d29 7d29 0a0a  rray([1, 2])})..
+00017410: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
+00017420: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00017430: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00017440: 6528 6f74 6865 722c 2028 696e 742c 2066  e(other, (int, f
+00017450: 6c6f 6174 2929 3a0a 2020 2020 2020 2020  loat)):.        
+00017460: 2020 2020 6172 7220 3d20 7365 6c66 2e64      arr = self.d
+00017470: 6174 6120 2d20 6f74 6865 720a 2020 2020  ata - other.    
+00017480: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00017490: 656c 662e 5f70 6f73 745f 6f70 6572 6174  elf._post_operat
+000174a0: 696f 6e28 6172 722c 2073 656c 662e 636f  ion(arr, self.co
+000174b0: 6f72 6473 290a 2020 2020 2020 2020 656c  ords).        el
+000174c0: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
+000174d0: 6865 722c 2041 7272 6179 293a 0a20 2020  her, Array):.   
+000174e0: 2020 2020 2020 2020 2073 656c 665f 6172           self_ar
+000174f0: 722c 206f 7468 6572 5f61 7272 2c20 636f  r, other_arr, co
+00017500: 6f72 6473 203d 2073 656c 662e 5f70 7265  ords = self._pre
+00017510: 5f6f 7065 7261 7469 6f6e 5f77 6974 685f  _operation_with_
+00017520: 6172 7261 7928 6f74 6865 7229 0a20 2020  array(other).   
+00017530: 2020 2020 2020 2020 2061 7272 203d 2073           arr = s
+00017540: 656c 662e 5f6f 7065 7261 7469 6f6e 2873  elf._operation(s
+00017550: 656c 665f 6172 722c 206f 7468 6572 5f61  elf_arr, other_a
+00017560: 7272 2c20 275f 5f73 7562 5f5f 2729 0a20  rr, '__sub__'). 
+00017570: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00017580: 6e20 7365 6c66 2e5f 706f 7374 5f6f 7065  n self._post_ope
+00017590: 7261 7469 6f6e 2861 7272 2e54 2c20 636f  ration(arr.T, co
+000175a0: 6f72 6473 290a 0a20 2020 2064 6566 205f  ords)..    def _
+000175b0: 5f74 7275 6564 6976 5f5f 2873 656c 662c  _truediv__(self,
+000175c0: 206f 7468 6572 3a20 556e 696f 6e5b 696e   other: Union[in
+000175d0: 742c 2066 6c6f 6174 2c20 2741 7272 6179  t, float, 'Array
+000175e0: 275d 2920 2d3e 2027 4172 7261 7927 3a0a  ']) -> 'Array':.
+000175f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00017600: 2020 2020 4469 7669 6465 2074 6865 2041      Divide the A
+00017610: 7272 6179 2062 7920 616e 6f74 6865 7220  rray by another 
+00017620: 4172 7261 7920 6f72 2061 206e 756d 6265  Array or a numbe
+00017630: 722e 0a0a 2020 2020 2020 2020 4172 6773  r...        Args
+00017640: 3a0a 2020 2020 2020 2020 2020 2020 6f74  :.            ot
+00017650: 6865 723a 2054 6865 206f 7468 6572 2041  her: The other A
+00017660: 7272 6179 206f 7220 6e75 6d62 6572 2074  rray or number t
+00017670: 6f20 6469 7669 6465 2062 792e 0a0a 2020  o divide by...  
+00017680: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+00017690: 2020 2020 2020 2020 2020 2041 206e 6577             A new
+000176a0: 2041 7272 6179 206f 626a 6563 7420 7769   Array object wi
+000176b0: 7468 2074 6865 2072 6573 756c 7420 6f66  th the result of
+000176c0: 2074 6865 2064 6976 6973 696f 6e2e 0a0a   the division...
+000176d0: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
+000176e0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+000176f0: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
+00017700: 2020 203e 3e3e 2063 6f6f 7264 7331 203d     >>> coords1 =
+00017710: 207b 2764 696d 3127 3a20 5b27 6127 2c20   {'dim1': ['a', 
+00017720: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
+00017730: 2c20 325d 7d0a 2020 2020 2020 2020 2020  , 2]}.          
+00017740: 2020 3e3e 3e20 6c6f 6e67 3120 3d20 4c6f    >>> long1 = Lo
+00017750: 6e67 2869 6e64 6578 3d7b 2764 696d 3127  ng(index={'dim1'
+00017760: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+00017770: 696d 3227 3a20 5b31 2c20 325d 7d2c 2076  im2': [1, 2]}, v
+00017780: 616c 7565 3d5b 3130 2c20 3230 5d29 0a20  alue=[10, 20]). 
+00017790: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
+000177a0: 7272 3120 3d20 4172 7261 7928 6461 7461  rr1 = Array(data
+000177b0: 3d6c 6f6e 6731 2c20 636f 6f72 6473 3d63  =long1, coords=c
+000177c0: 6f6f 7264 7331 290a 2020 2020 2020 2020  oords1).        
+000177d0: 2020 2020 3e3e 3e20 636f 6f72 6473 3220      >>> coords2 
+000177e0: 3d20 7b27 6469 6d31 273a 205b 2761 272c  = {'dim1': ['a',
+000177f0: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
+00017800: 312c 2032 5d7d 0a20 2020 2020 2020 2020  1, 2]}.         
+00017810: 2020 203e 3e3e 206c 6f6e 6732 203d 204c     >>> long2 = L
+00017820: 6f6e 6728 696e 6465 783d 7b27 6469 6d31  ong(index={'dim1
+00017830: 273a 205b 2761 272c 2761 272c 2027 6227  ': ['a','a', 'b'
+00017840: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
+00017850: 5b31 2c20 322c 2031 2c20 325d 7d2c 2076  [1, 2, 1, 2]}, v
+00017860: 616c 7565 3d5b 3330 2c20 3430 2c20 3530  alue=[30, 40, 50
+00017870: 2c20 3630 5d29 0a20 2020 2020 2020 2020  , 60]).         
+00017880: 2020 203e 3e3e 2061 7272 3220 3d20 4172     >>> arr2 = Ar
+00017890: 7261 7928 6461 7461 3d6c 6f6e 6732 2c20  ray(data=long2, 
+000178a0: 636f 6f72 6473 3d63 6f6f 7264 7332 290a  coords=coords2).
+000178b0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+000178c0: 6172 7231 202f 2061 7272 320a 2020 2020  arr1 / arr2.    
+000178d0: 2020 2020 2020 2020 4172 7261 7928 6461          Array(da
+000178e0: 7461 3d61 7272 6179 285b 5b30 2e33 3333  ta=array([[0.333
+000178f0: 3333 3333 332c 2030 2e20 2020 2020 2020  33333, 0.       
+00017900: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
+00017910: 2020 2020 2020 205b 302e 2020 2020 2020         [0.      
+00017920: 2020 2c20 302e 3333 3333 3333 3333 5d5d    , 0.33333333]]
+00017930: 292c 2063 6f6f 7264 733d 7b27 6469 6d31  ), coords={'dim1
+00017940: 273a 2061 7272 6179 285b 2761 272c 2027  ': array(['a', '
+00017950: 6227 5d2c 2064 7479 7065 3d6f 626a 6563  b'], dtype=objec
+00017960: 7429 2c20 2764 696d 3227 3a20 6172 7261  t), 'dim2': arra
+00017970: 7928 5b31 2c20 325d 297d 290a 2020 2020  y([1, 2])}).    
+00017980: 2020 2020 2020 2020 3e3e 3e20 6172 7231          >>> arr1
+00017990: 202f 2035 0a20 2020 2020 2020 2020 2020   / 5.           
+000179a0: 2041 7272 6179 2864 6174 613d 6172 7261   Array(data=arra
+000179b0: 7928 5b5b 322e 2c20 302e 5d2c 0a20 2020  y([[2., 0.],.   
+000179c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000179d0: 5b30 2e2c 2034 2e5d 5d29 2c20 636f 6f72  [0., 4.]]), coor
+000179e0: 6473 3d7b 2764 696d 3127 3a20 6172 7261  ds={'dim1': arra
+000179f0: 7928 5b27 6127 2c20 2762 275d 2c20 6474  y(['a', 'b'], dt
+00017a00: 7970 653d 6f62 6a65 6374 292c 2027 6469  ype=object), 'di
+00017a10: 6d32 273a 2061 7272 6179 285b 312c 2032  m2': array([1, 2
+00017a20: 5d29 7d29 0a0a 2020 2020 2020 2020 2020  ])})..          
+00017a30: 2020 6060 600a 2020 2020 2020 2020 2222    ```.        ""
+00017a40: 220a 2020 2020 2020 2020 6966 2069 7369  ".        if isi
+00017a50: 6e73 7461 6e63 6528 6f74 6865 722c 2028  nstance(other, (
+00017a60: 696e 742c 2066 6c6f 6174 2929 3a0a 2020  int, float)):.  
+00017a70: 2020 2020 2020 2020 2020 6172 7220 3d20            arr = 
+00017a80: 7365 6c66 2e64 6174 6120 2f20 6f74 6865  self.data / othe
+00017a90: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
+00017aa0: 7475 726e 2073 656c 662e 5f70 6f73 745f  turn self._post_
+00017ab0: 6f70 6572 6174 696f 6e28 6172 722c 2073  operation(arr, s
+00017ac0: 656c 662e 636f 6f72 6473 290a 2020 2020  elf.coords).    
+00017ad0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00017ae0: 6e63 6528 6f74 6865 722c 2041 7272 6179  nce(other, Array
+00017af0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+00017b00: 656c 665f 6172 722c 206f 7468 6572 5f61  elf_arr, other_a
+00017b10: 7272 2c20 636f 6f72 6473 203d 2073 656c  rr, coords = sel
+00017b20: 662e 5f70 7265 5f6f 7065 7261 7469 6f6e  f._pre_operation
+00017b30: 5f77 6974 685f 6172 7261 7928 6f74 6865  _with_array(othe
+00017b40: 7229 0a20 2020 2020 2020 2020 2020 2061  r).            a
+00017b50: 7272 203d 2073 656c 662e 5f6f 7065 7261  rr = self._opera
+00017b60: 7469 6f6e 2873 656c 665f 6172 722c 206f  tion(self_arr, o
+00017b70: 7468 6572 5f61 7272 2c20 275f 5f74 7275  ther_arr, '__tru
+00017b80: 6564 6976 5f5f 2729 0a20 2020 2020 2020  ediv__').       
+00017b90: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00017ba0: 2e5f 706f 7374 5f6f 7065 7261 7469 6f6e  ._post_operation
+00017bb0: 2861 7272 2e54 2c20 636f 6f72 6473 290a  (arr.T, coords).
+00017bc0: 0a20 2020 2064 6566 205f 5f72 6164 645f  .    def __radd_
+00017bd0: 5f28 7365 6c66 2c20 6f74 6865 723a 2055  _(self, other: U
+00017be0: 6e69 6f6e 5b69 6e74 2c20 666c 6f61 745d  nion[int, float]
+00017bf0: 2920 2d3e 2027 4172 7261 7927 3a0a 2020  ) -> 'Array':.  
+00017c00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00017c10: 2020 4164 6420 6120 6e75 6d62 6572 2074    Add a number t
+00017c20: 6f20 7468 6520 4172 7261 7920 2872 6576  o the Array (rev
+00017c30: 6572 7365 2061 6464 6974 696f 6e29 2e0a  erse addition)..
+00017c40: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+00017c50: 2020 2020 2020 2020 2020 206f 7468 6572             other
+00017c60: 3a20 5468 6520 6e75 6d62 6572 2074 6f20  : The number to 
+00017c70: 6164 642e 0a0a 2020 2020 2020 2020 5265  add...        Re
+00017c80: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
+00017c90: 2020 2041 206e 6577 2041 7272 6179 206f     A new Array o
+00017ca0: 626a 6563 7420 7769 7468 2074 6865 2072  bject with the r
+00017cb0: 6573 756c 7420 6f66 2074 6865 2061 6464  esult of the add
+00017cc0: 6974 696f 6e2e 0a0a 2020 2020 2020 2020  ition...        
+00017cd0: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+00017ce0: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
+00017cf0: 2020 2020 2020 2020 2020 203e 3e3e 2063             >>> c
+00017d00: 6f6f 7264 7320 3d20 7b27 6469 6d31 273a  oords = {'dim1':
+00017d10: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
+00017d20: 6d32 273a 205b 312c 2032 5d7d 0a20 2020  m2': [1, 2]}.   
+00017d30: 2020 2020 2020 2020 203e 3e3e 206c 6f6e           >>> lon
+00017d40: 6720 3d20 4c6f 6e67 2869 6e64 6578 3d7b  g = Long(index={
+00017d50: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
+00017d60: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
+00017d70: 325d 7d2c 2076 616c 7565 3d5b 3130 2c20  2]}, value=[10, 
+00017d80: 3230 5d29 0a20 2020 2020 2020 2020 2020  20]).           
+00017d90: 203e 3e3e 2061 7272 203d 2041 7272 6179   >>> arr = Array
+00017da0: 2864 6174 613d 6c6f 6e67 2c20 636f 6f72  (data=long, coor
+00017db0: 6473 3d63 6f6f 7264 7329 0a20 2020 2020  ds=coords).     
+00017dc0: 2020 2020 2020 203e 3e3e 2035 202b 2061         >>> 5 + a
+00017dd0: 7272 0a20 2020 2020 2020 2020 2020 2041  rr.            A
+00017de0: 7272 6179 2864 6174 613d 6172 7261 7928  rray(data=array(
+00017df0: 5b5b 3135 2e2c 2020 352e 5d2c 0a20 2020  [[15.,  5.],.   
+00017e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017e10: 5b20 352e 2c20 3235 2e5d 5d29 2c20 636f  [ 5., 25.]]), co
+00017e20: 6f72 6473 3d7b 2764 696d 3127 3a20 6172  ords={'dim1': ar
+00017e30: 7261 7928 5b27 6127 2c20 2762 275d 2c20  ray(['a', 'b'], 
+00017e40: 6474 7970 653d 6f62 6a65 6374 292c 2027  dtype=object), '
+00017e50: 6469 6d32 273a 2061 7272 6179 285b 312c  dim2': array([1,
+00017e60: 2032 5d29 7d29 0a0a 2020 2020 2020 2020   2])})..        
+00017e70: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+00017e80: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
+00017e90: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
+00017ea0: 2028 696e 742c 2066 6c6f 6174 2929 3a0a   (int, float)):.
+00017eb0: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
+00017ec0: 3d20 7365 6c66 2e64 6174 6120 2b20 6f74  = self.data + ot
+00017ed0: 6865 720a 2020 2020 2020 2020 2020 2020  her.            
+00017ee0: 7265 7475 726e 2073 656c 662e 5f70 6f73  return self._pos
+00017ef0: 745f 6f70 6572 6174 696f 6e28 6172 722c  t_operation(arr,
+00017f00: 2073 656c 662e 636f 6f72 6473 290a 0a20   self.coords).. 
+00017f10: 2020 2064 6566 205f 5f72 6d75 6c5f 5f28     def __rmul__(
+00017f20: 7365 6c66 2c20 6f74 6865 723a 2055 6e69  self, other: Uni
+00017f30: 6f6e 5b69 6e74 2c20 666c 6f61 745d 2920  on[int, float]) 
+00017f40: 2d3e 2027 4172 7261 7927 3a0a 2020 2020  -> 'Array':.    
+00017f50: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00017f60: 4d75 6c74 6970 6c79 2061 206e 756d 6265  Multiply a numbe
+00017f70: 7220 7769 7468 2074 6865 2041 7272 6179  r with the Array
+00017f80: 2028 7265 7665 7273 6520 6d75 6c74 6970   (reverse multip
+00017f90: 6c69 6361 7469 6f6e 292e 0a0a 2020 2020  lication)...    
+00017fa0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+00017fb0: 2020 2020 2020 6f74 6865 723a 2054 6865        other: The
+00017fc0: 206e 756d 6265 7220 746f 206d 756c 7469   number to multi
+00017fd0: 706c 792e 0a0a 2020 2020 2020 2020 5265  ply...        Re
+00017fe0: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
+00017ff0: 2020 2041 206e 6577 2041 7272 6179 206f     A new Array o
+00018000: 626a 6563 7420 7769 7468 2074 6865 2072  bject with the r
+00018010: 6573 756c 7420 6f66 2074 6865 206d 756c  esult of the mul
+00018020: 7469 706c 6963 6174 696f 6e2e 0a0a 2020  tiplication...  
+00018030: 2020 2020 2020 4578 616d 706c 653a 0a20        Example:. 
+00018040: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
+00018050: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
+00018060: 203e 3e3e 2063 6f6f 7264 7320 3d20 7b27   >>> coords = {'
+00018070: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
+00018080: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
+00018090: 5d7d 0a20 2020 2020 2020 2020 2020 203e  ]}.            >
+000180a0: 3e3e 206c 6f6e 6720 3d20 4c6f 6e67 2869  >> long = Long(i
+000180b0: 6e64 6578 3d7b 2764 696d 3127 3a20 5b27  ndex={'dim1': ['
+000180c0: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
+000180d0: 3a20 5b31 2c20 325d 7d2c 2076 616c 7565  : [1, 2]}, value
+000180e0: 3d5b 3130 2c20 3230 5d29 0a20 2020 2020  =[10, 20]).     
+000180f0: 2020 2020 2020 203e 3e3e 2061 7272 203d         >>> arr =
+00018100: 2041 7272 6179 2864 6174 613d 6c6f 6e67   Array(data=long
+00018110: 2c20 636f 6f72 6473 3d63 6f6f 7264 7329  , coords=coords)
+00018120: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00018130: 2035 202a 2061 7272 0a20 2020 2020 2020   5 * arr.       
+00018140: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
+00018150: 6172 7261 7928 5b5b 2035 302e 2c20 2020  array([[ 50.,   
+00018160: 302e 5d2c 0a20 2020 2020 2020 2020 2020  0.],.           
+00018170: 2020 2020 2020 2020 5b20 2030 2e2c 2031          [  0., 1
+00018180: 3030 2e5d 5d29 2c20 636f 6f72 6473 3d7b  00.]]), coords={
+00018190: 2764 696d 3127 3a20 6172 7261 7928 5b27  'dim1': array(['
+000181a0: 6127 2c20 2762 275d 2c20 6474 7970 653d  a', 'b'], dtype=
+000181b0: 6f62 6a65 6374 292c 2027 6469 6d32 273a  object), 'dim2':
+000181c0: 2061 7272 6179 285b 312c 2032 5d29 7d29   array([1, 2])})
+000181d0: 0a0a 2020 2020 2020 2020 2020 2020 6060  ..            ``
+000181e0: 600a 2020 2020 2020 2020 2222 220a 2020  `.        """.  
+000181f0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00018200: 6e63 6528 6f74 6865 722c 2028 696e 742c  nce(other, (int,
+00018210: 2066 6c6f 6174 2929 3a0a 2020 2020 2020   float)):.      
+00018220: 2020 2020 2020 6172 7220 3d20 7365 6c66        arr = self
+00018230: 2e64 6174 6120 2a20 6f74 6865 720a 2020  .data * other.  
+00018240: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00018250: 2073 656c 662e 5f70 6f73 745f 6f70 6572   self._post_oper
+00018260: 6174 696f 6e28 6172 722c 2073 656c 662e  ation(arr, self.
+00018270: 636f 6f72 6473 290a 0a20 2020 2064 6566  coords)..    def
+00018280: 205f 5f72 7375 625f 5f28 7365 6c66 2c20   __rsub__(self, 
+00018290: 6f74 6865 723a 2055 6e69 6f6e 5b69 6e74  other: Union[int
+000182a0: 2c20 666c 6f61 745d 2920 2d3e 2027 4172  , float]) -> 'Ar
+000182b0: 7261 7927 3a0a 2020 2020 2020 2020 2222  ray':.        ""
+000182c0: 220a 2020 2020 2020 2020 5375 6274 7261  ".        Subtra
+000182d0: 6374 2074 6865 2041 7272 6179 2066 726f  ct the Array fro
+000182e0: 6d20 6120 6e75 6d62 6572 2028 7265 7665  m a number (reve
+000182f0: 7273 6520 7375 6274 7261 6374 696f 6e29  rse subtraction)
+00018300: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
+00018310: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+00018320: 6572 3a20 5468 6520 6e75 6d62 6572 2074  er: The number t
+00018330: 6f20 7375 6274 7261 6374 2066 726f 6d2e  o subtract from.
+00018340: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00018350: 733a 0a20 2020 2020 2020 2020 2020 2041  s:.            A
+00018360: 206e 6577 2041 7272 6179 206f 626a 6563   new Array objec
+00018370: 7420 7769 7468 2074 6865 2072 6573 756c  t with the resul
+00018380: 7420 6f66 2074 6865 2073 7562 7472 6163  t of the subtrac
+00018390: 7469 6f6e 2e0a 0a20 2020 2020 2020 2045  tion...        E
+000183a0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+000183b0: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
+000183c0: 2020 2020 2020 2020 2020 3e3e 3e20 636f            >>> co
+000183d0: 6f72 6473 203d 207b 2764 696d 3127 3a20  ords = {'dim1': 
+000183e0: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
+000183f0: 3227 3a20 5b31 2c20 325d 7d0a 2020 2020  2': [1, 2]}.    
+00018400: 2020 2020 2020 2020 3e3e 3e20 6c6f 6e67          >>> long
+00018410: 203d 204c 6f6e 6728 696e 6465 783d 7b27   = Long(index={'
+00018420: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
+00018430: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
+00018440: 5d7d 2c20 7661 6c75 653d 5b31 302c 2032  ]}, value=[10, 2
+00018450: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
+00018460: 3e3e 3e20 6172 7220 3d20 4172 7261 7928  >>> arr = Array(
+00018470: 6461 7461 3d6c 6f6e 672c 2063 6f6f 7264  data=long, coord
+00018480: 733d 636f 6f72 6473 290a 2020 2020 2020  s=coords).      
+00018490: 2020 2020 2020 3e3e 3e20 3520 2d20 6172        >>> 5 - ar
+000184a0: 720a 2020 2020 2020 2020 2020 2020 4172  r.            Ar
+000184b0: 7261 7928 6461 7461 3d61 7272 6179 285b  ray(data=array([
+000184c0: 5b20 2d35 2e2c 2020 2035 2e5d 2c0a 2020  [ -5.,   5.],.  
+000184d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000184e0: 205b 2020 352e 2c20 2d31 352e 5d5d 292c   [  5., -15.]]),
+000184f0: 2063 6f6f 7264 733d 7b27 6469 6d31 273a   coords={'dim1':
+00018500: 2061 7272 6179 285b 2761 272c 2027 6227   array(['a', 'b'
+00018510: 5d2c 2064 7479 7065 3d6f 626a 6563 7429  ], dtype=object)
+00018520: 2c20 2764 696d 3227 3a20 6172 7261 7928  , 'dim2': array(
+00018530: 5b31 2c20 325d 297d 290a 0a20 2020 2020  [1, 2])})..     
+00018540: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+00018550: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+00018560: 6620 6973 696e 7374 616e 6365 286f 7468  f isinstance(oth
+00018570: 6572 2c20 2869 6e74 2c20 666c 6f61 7429  er, (int, float)
+00018580: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+00018590: 7272 203d 202d 7365 6c66 2e64 6174 6120  rr = -self.data 
+000185a0: 2b20 6f74 6865 720a 2020 2020 2020 2020  + other.        
+000185b0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000185c0: 5f70 6f73 745f 6f70 6572 6174 696f 6e28  _post_operation(
+000185d0: 6172 722c 2073 656c 662e 636f 6f72 6473  arr, self.coords
+000185e0: 290a 0a20 2020 2064 6566 205f 5f72 7472  )..    def __rtr
+000185f0: 7565 6469 765f 5f28 7365 6c66 2c20 6f74  uediv__(self, ot
+00018600: 6865 723a 2055 6e69 6f6e 5b69 6e74 2c20  her: Union[int, 
+00018610: 666c 6f61 745d 2920 2d3e 2027 4172 7261  float]) -> 'Arra
+00018620: 7927 3a0a 2020 2020 2020 2020 2222 220a  y':.        """.
+00018630: 2020 2020 2020 2020 4469 7669 6465 2061          Divide a
+00018640: 206e 756d 6265 7220 6279 2074 6865 2041   number by the A
+00018650: 7272 6179 2028 7265 7665 7273 6520 6469  rray (reverse di
+00018660: 7669 7369 6f6e 292e 0a0a 2020 2020 2020  vision)...      
+00018670: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+00018680: 2020 2020 6f74 6865 723a 2054 6865 206e      other: The n
+00018690: 756d 6265 7220 746f 2064 6976 6964 652e  umber to divide.
+000186a0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+000186b0: 733a 0a20 2020 2020 2020 2020 2020 2041  s:.            A
+000186c0: 206e 6577 2041 7272 6179 206f 626a 6563   new Array objec
+000186d0: 7420 7769 7468 2074 6865 2072 6573 756c  t with the resul
+000186e0: 7420 6f66 2074 6865 2064 6976 6973 696f  t of the divisio
+000186f0: 6e2e 0a0a 2020 2020 2020 2020 4578 616d  n...        Exam
+00018700: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
+00018710: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+00018720: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
+00018730: 7320 3d20 7b27 6469 6d31 273a 205b 2761  s = {'dim1': ['a
+00018740: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
+00018750: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
+00018760: 2020 2020 203e 3e3e 206c 6f6e 6720 3d20       >>> long = 
+00018770: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
+00018780: 3127 3a20 5b27 6127 2c20 2761 272c 2027  1': ['a', 'a', '
+00018790: 6227 2c20 2762 275d 2c20 2764 696d 3227  b', 'b'], 'dim2'
+000187a0: 3a20 5b31 2c20 322c 2031 2c20 325d 7d2c  : [1, 2, 1, 2]},
+000187b0: 2076 616c 7565 3d5b 3130 2c20 3230 2c20   value=[10, 20, 
+000187c0: 3330 2c20 3430 5d29 0a20 2020 2020 2020  30, 40]).       
+000187d0: 2020 2020 203e 3e3e 2061 7272 203d 2041       >>> arr = A
+000187e0: 7272 6179 2864 6174 613d 6c6f 6e67 2c20  rray(data=long, 
+000187f0: 636f 6f72 6473 3d63 6f6f 7264 7329 0a20  coords=coords). 
+00018800: 2020 2020 2020 2020 2020 203e 3e3e 2031             >>> 1
+00018810: 3030 202f 2061 7272 0a20 2020 2020 2020  00 / arr.       
+00018820: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
+00018830: 6172 7261 7928 5b5b 3130 2e20 2020 2020  array([[10.     
+00018840: 2020 202c 2020 352e 2020 2020 2020 2020     ,  5.        
+00018850: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00018860: 2020 2020 2020 5b20 332e 3333 3333 3333        [ 3.333333
+00018870: 3333 2c20 2032 2e35 2020 2020 2020 205d  33,  2.5       ]
+00018880: 5d29 2c20 636f 6f72 6473 3d7b 2764 696d  ]), coords={'dim
+00018890: 3127 3a20 6172 7261 7928 5b27 6127 2c20  1': array(['a', 
+000188a0: 2762 275d 2c20 6474 7970 653d 6f62 6a65  'b'], dtype=obje
+000188b0: 6374 292c 2027 6469 6d32 273a 2061 7272  ct), 'dim2': arr
+000188c0: 6179 285b 312c 2032 5d29 7d29 0a0a 2020  ay([1, 2])})..  
+000188d0: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
+000188e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000188f0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00018900: 6f74 6865 722c 2028 696e 742c 2066 6c6f  other, (int, flo
+00018910: 6174 2929 3a0a 2020 2020 2020 2020 2020  at)):.          
+00018920: 2020 6172 7220 3d20 6f74 6865 7220 2f20    arr = other / 
+00018930: 7365 6c66 2e64 6174 610a 2020 2020 2020  self.data.      
+00018940: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00018950: 662e 5f70 6f73 745f 6f70 6572 6174 696f  f._post_operatio
+00018960: 6e28 6172 722c 2073 656c 662e 636f 6f72  n(arr, self.coor
+00018970: 6473 290a 0a20 2020 2064 6566 205f 5f6e  ds)..    def __n
+00018980: 6567 5f5f 2873 656c 6629 202d 3e20 2741  eg__(self) -> 'A
+00018990: 7272 6179 273a 0a20 2020 2020 2020 2022  rray':.        "
+000189a0: 2222 0a20 2020 2020 2020 204e 6567 6174  "".        Negat
+000189b0: 6520 7468 6520 4172 7261 792e 0a0a 2020  e the Array...  
+000189c0: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+000189d0: 2020 2020 2020 2020 2020 2041 206e 6577             A new
+000189e0: 2041 7272 6179 206f 626a 6563 7420 7769   Array object wi
+000189f0: 7468 2074 6865 206e 6567 6174 6564 2076  th the negated v
+00018a00: 616c 7565 732e 0a0a 2020 2020 2020 2020  alues...        
+00018a10: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+00018a20: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
+00018a30: 2020 2020 2020 2020 2020 203e 3e3e 2063             >>> c
+00018a40: 6f6f 7264 7320 3d20 7b27 6469 6d31 273a  oords = {'dim1':
+00018a50: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
+00018a60: 6d32 273a 205b 312c 2032 5d7d 0a20 2020  m2': [1, 2]}.   
+00018a70: 2020 2020 2020 2020 203e 3e3e 206c 6f6e           >>> lon
+00018a80: 6720 3d20 4c6f 6e67 2869 6e64 6578 3d7b  g = Long(index={
+00018a90: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
+00018aa0: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
+00018ab0: 325d 7d2c 2076 616c 7565 3d5b 3130 2c20  2]}, value=[10, 
+00018ac0: 3230 5d29 0a20 2020 2020 2020 2020 2020  20]).           
+00018ad0: 203e 3e3e 2061 7272 203d 2041 7272 6179   >>> arr = Array
+00018ae0: 2864 6174 613d 6c6f 6e67 2c20 636f 6f72  (data=long, coor
+00018af0: 6473 3d63 6f6f 7264 7329 0a20 2020 2020  ds=coords).     
+00018b00: 2020 2020 2020 203e 3e3e 202d 6172 720a         >>> -arr.
+00018b10: 2020 2020 2020 2020 2020 2020 4172 7261              Arra
+00018b20: 7928 6461 7461 3d61 7272 6179 285b 5b2d  y(data=array([[-
+00018b30: 3130 2e2c 2020 2030 2e5d 2c0a 2020 2020  10.,   0.],.    
+00018b40: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00018b50: 2020 302e 2c20 2d32 302e 5d5d 292c 2063    0., -20.]]), c
+00018b60: 6f6f 7264 733d 7b27 6469 6d31 273a 2061  oords={'dim1': a
+00018b70: 7272 6179 285b 2761 272c 2027 6227 5d2c  rray(['a', 'b'],
+00018b80: 2064 7479 7065 3d6f 626a 6563 7429 2c20   dtype=object), 
+00018b90: 2764 696d 3227 3a20 6172 7261 7928 5b31  'dim2': array([1
+00018ba0: 2c20 325d 297d 290a 0a20 2020 2020 2020  , 2])})..       
+00018bb0: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
+00018bc0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+00018bd0: 7572 6e20 7365 6c66 2e5f 706f 7374 5f6f  urn self._post_o
+00018be0: 7065 7261 7469 6f6e 282d 7365 6c66 2e64  peration(-self.d
+00018bf0: 6174 612c 2073 656c 662e 636f 6f72 6473  ata, self.coords
+00018c00: 290a 0a20 2020 2064 6566 205f 5f70 6f73  )..    def __pos
+00018c10: 5f5f 2873 656c 6629 202d 3e20 2741 7272  __(self) -> 'Arr
+00018c20: 6179 273a 0a20 2020 2020 2020 2022 2222  ay':.        """
+00018c30: 0a20 2020 2020 2020 2041 7070 6c79 2074  .        Apply t
+00018c40: 6865 2075 6e61 7279 2070 6f73 6974 6976  he unary positiv
+00018c50: 6520 6f70 6572 6174 6f72 2074 6f20 7468  e operator to th
+00018c60: 6520 4172 7261 792e 0a0a 2020 2020 2020  e Array...      
+00018c70: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+00018c80: 2020 2020 2020 2041 206e 6577 2041 7272         A new Arr
+00018c90: 6179 206f 626a 6563 7420 7769 7468 2074  ay object with t
+00018ca0: 6865 2073 616d 6520 7661 6c75 6573 2e0a  he same values..
+00018cb0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00018cc0: 3a0a 2020 2020 2020 2020 2020 2020 6060  :.            ``
+00018cd0: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
+00018ce0: 2020 2020 3e3e 3e20 636f 6f72 6473 203d      >>> coords =
+00018cf0: 207b 2764 696d 3127 3a20 5b27 6127 2c20   {'dim1': ['a', 
+00018d00: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
+00018d10: 2c20 325d 7d0a 2020 2020 2020 2020 2020  , 2]}.          
+00018d20: 2020 3e3e 3e20 6c6f 6e67 203d 204c 6f6e    >>> long = Lon
+00018d30: 6728 696e 6465 783d 7b27 6469 6d31 273a  g(index={'dim1':
+00018d40: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
+00018d50: 6d32 273a 205b 312c 2032 5d7d 2c20 7661  m2': [1, 2]}, va
+00018d60: 6c75 653d 5b31 302c 2032 305d 290a 2020  lue=[10, 20]).  
+00018d70: 2020 2020 2020 2020 2020 3e3e 3e20 6172            >>> ar
+00018d80: 7220 3d20 4172 7261 7928 6461 7461 3d6c  r = Array(data=l
+00018d90: 6f6e 672c 2063 6f6f 7264 733d 636f 6f72  ong, coords=coor
+00018da0: 6473 290a 2020 2020 2020 2020 2020 2020  ds).            
+00018db0: 3e3e 3e20 2b61 7272 0a20 2020 2020 2020  >>> +arr.       
+00018dc0: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
+00018dd0: 6172 7261 7928 5b5b 3130 2e2c 2020 302e  array([[10.,  0.
+00018de0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00018df0: 2020 2020 2020 5b20 302e 2c20 3230 2e5d        [ 0., 20.]
+00018e00: 5d29 2c20 636f 6f72 6473 3d7b 2764 696d  ]), coords={'dim
+00018e10: 3127 3a20 6172 7261 7928 5b27 6127 2c20  1': array(['a', 
+00018e20: 2762 275d 2c20 6474 7970 653d 6f62 6a65  'b'], dtype=obje
+00018e30: 6374 292c 2027 6469 6d32 273a 2061 7272  ct), 'dim2': arr
+00018e40: 6179 285b 312c 2032 5d29 7d29 0a0a 2020  ay([1, 2])})..  
+00018e50: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
+00018e60: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00018e70: 2020 7265 7475 726e 2073 656c 662e 5f70    return self._p
+00018e80: 6f73 745f 6f70 6572 6174 696f 6e28 2b73  ost_operation(+s
+00018e90: 656c 662e 6461 7461 2c20 7365 6c66 2e63  elf.data, self.c
+00018ea0: 6f6f 7264 7329 0a0a 2020 2020 6465 6620  oords)..    def 
+00018eb0: 5f5f 6571 5f5f 2873 656c 662c 206f 7468  __eq__(self, oth
+00018ec0: 6572 3a20 556e 696f 6e5b 696e 742c 2066  er: Union[int, f
+00018ed0: 6c6f 6174 2c20 2741 7272 6179 275d 2920  loat, 'Array']) 
+00018ee0: 2d3e 2027 4172 7261 7927 3a0a 2020 2020  -> 'Array':.    
+00018ef0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00018f00: 4368 6563 6b20 6571 7561 6c69 7479 2062  Check equality b
+00018f10: 6574 7765 656e 2074 6865 2041 7272 6179  etween the Array
+00018f20: 2061 6e64 2061 6e6f 7468 6572 2041 7272   and another Arr
+00018f30: 6179 206f 7220 6120 6e75 6d62 6572 2e0a  ay or a number..
+00018f40: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+00018f50: 2020 2020 2020 2020 2020 206f 7468 6572             other
+00018f60: 3a20 5468 6520 6f74 6865 7220 4172 7261  : The other Arra
+00018f70: 7920 6f72 206e 756d 6265 7220 746f 2063  y or number to c
+00018f80: 6f6d 7061 7265 2e0a 0a20 2020 2020 2020  ompare...       
+00018f90: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+00018fa0: 2020 2020 2020 4120 6e65 7720 4172 7261        A new Arra
+00018fb0: 7920 6f62 6a65 6374 2077 6974 6820 626f  y object with bo
+00018fc0: 6f6c 6561 6e20 7661 6c75 6573 2069 6e64  olean values ind
+00018fd0: 6963 6174 696e 6720 6571 7561 6c69 7479  icating equality
+00018fe0: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+00018ff0: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+00019000: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+00019010: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
+00019020: 3120 3d20 7b27 6469 6d31 273a 205b 2761  1 = {'dim1': ['a
+00019030: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
+00019040: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
+00019050: 2020 2020 203e 3e3e 206c 6f6e 6731 203d       >>> long1 =
+00019060: 204c 6f6e 6728 696e 6465 783d 7b27 6469   Long(index={'di
+00019070: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+00019080: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+00019090: 2c20 7661 6c75 653d 5b31 302c 2032 305d  , value=[10, 20]
+000190a0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+000190b0: 3e20 6172 7231 203d 2041 7272 6179 2864  > arr1 = Array(d
+000190c0: 6174 613d 6c6f 6e67 312c 2063 6f6f 7264  ata=long1, coord
+000190d0: 733d 636f 6f72 6473 3129 0a20 2020 2020  s=coords1).     
+000190e0: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
+000190f0: 7332 203d 207b 2764 696d 3127 3a20 5b27  s2 = {'dim1': ['
+00019100: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
+00019110: 3a20 5b31 2c20 325d 7d0a 2020 2020 2020  : [1, 2]}.      
+00019120: 2020 2020 2020 3e3e 3e20 6c6f 6e67 3220        >>> long2 
+00019130: 3d20 4c6f 6e67 2869 6e64 6578 3d7b 2764  = Long(index={'d
+00019140: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
+00019150: 2c20 2764 696d 3227 3a20 5b32 2c20 315d  , 'dim2': [2, 1]
+00019160: 7d2c 2076 616c 7565 3d5b 3230 2c20 3130  }, value=[20, 10
+00019170: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
+00019180: 3e3e 2061 7272 3220 3d20 4172 7261 7928  >> arr2 = Array(
+00019190: 6461 7461 3d6c 6f6e 6732 2c20 636f 6f72  data=long2, coor
+000191a0: 6473 3d63 6f6f 7264 7332 290a 2020 2020  ds=coords2).    
+000191b0: 2020 2020 2020 2020 3e3e 3e20 6172 7231          >>> arr1
+000191c0: 203d 3d20 6172 7232 0a20 2020 2020 2020   == arr2.       
+000191d0: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
+000191e0: 6172 7261 7928 5b5b 4661 6c73 652c 2046  array([[False, F
+000191f0: 616c 7365 5d2c 0a20 2020 2020 2020 2020  alse],.         
+00019200: 2020 2020 2020 2020 2020 5b46 616c 7365            [False
+00019210: 2c20 4661 6c73 655d 5d29 2c20 636f 6f72  , False]]), coor
+00019220: 6473 3d7b 2764 696d 3127 3a20 6172 7261  ds={'dim1': arra
+00019230: 7928 5b27 6127 2c20 2762 275d 2c20 6474  y(['a', 'b'], dt
+00019240: 7970 653d 6f62 6a65 6374 292c 2027 6469  ype=object), 'di
+00019250: 6d32 273a 2061 7272 6179 285b 312c 2032  m2': array([1, 2
+00019260: 5d29 7d29 0a20 2020 2020 2020 2020 2020  ])}).           
+00019270: 203e 3e3e 2061 7272 3120 3d3d 2031 300a   >>> arr1 == 10.
+00019280: 2020 2020 2020 2020 2020 2020 4172 7261              Arra
+00019290: 7928 6461 7461 3d61 7272 6179 285b 5b20  y(data=array([[ 
+000192a0: 5472 7565 2c20 4661 6c73 655d 2c0a 2020  True, False],.  
+000192b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000192c0: 205b 4661 6c73 652c 2046 616c 7365 5d5d   [False, False]]
+000192d0: 292c 2063 6f6f 7264 733d 7b27 6469 6d31  ), coords={'dim1
+000192e0: 273a 2061 7272 6179 285b 2761 272c 2027  ': array(['a', '
+000192f0: 6227 5d2c 2064 7479 7065 3d6f 626a 6563  b'], dtype=objec
+00019300: 7429 2c20 2764 696d 3227 3a20 6172 7261  t), 'dim2': arra
+00019310: 7928 5b31 2c20 325d 297d 290a 0a20 2020  y([1, 2])})..   
+00019320: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
+00019330: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00019340: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
+00019350: 7468 6572 2c20 2869 6e74 2c20 666c 6f61  ther, (int, floa
+00019360: 7429 293a 0a20 2020 2020 2020 2020 2020  t)):.           
+00019370: 2061 7272 203d 2073 656c 662e 6461 7461   arr = self.data
+00019380: 203d 3d20 6f74 6865 720a 2020 2020 2020   == other.      
+00019390: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000193a0: 662e 5f70 6f73 745f 6f70 6572 6174 696f  f._post_operatio
+000193b0: 6e28 6172 722c 2073 656c 662e 636f 6f72  n(arr, self.coor
+000193c0: 6473 290a 2020 2020 2020 2020 656c 6966  ds).        elif
+000193d0: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
+000193e0: 722c 2041 7272 6179 293a 0a20 2020 2020  r, Array):.     
+000193f0: 2020 2020 2020 2073 656c 665f 6172 722c         self_arr,
+00019400: 206f 7468 6572 5f61 7272 2c20 636f 6f72   other_arr, coor
+00019410: 6473 203d 2073 656c 662e 5f70 7265 5f6f  ds = self._pre_o
+00019420: 7065 7261 7469 6f6e 5f77 6974 685f 6172  peration_with_ar
+00019430: 7261 7928 6f74 6865 7229 0a20 2020 2020  ray(other).     
+00019440: 2020 2020 2020 2061 7272 203d 2073 656c         arr = sel
+00019450: 665f 6172 7220 3d3d 206f 7468 6572 5f61  f_arr == other_a
+00019460: 7272 0a20 2020 2020 2020 2020 2020 2072  rr.            r
+00019470: 6574 7572 6e20 7365 6c66 2e5f 706f 7374  eturn self._post
+00019480: 5f6f 7065 7261 7469 6f6e 2861 7272 2e54  _operation(arr.T
+00019490: 2c20 636f 6f72 6473 290a 0a20 2020 2064  , coords)..    d
+000194a0: 6566 205f 5f6e 655f 5f28 7365 6c66 2c20  ef __ne__(self, 
+000194b0: 6f74 6865 723a 2055 6e69 6f6e 5b69 6e74  other: Union[int
+000194c0: 2c20 666c 6f61 742c 2027 4172 7261 7927  , float, 'Array'
+000194d0: 5d29 202d 3e20 2741 7272 6179 273a 0a20  ]) -> 'Array':. 
+000194e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000194f0: 2020 2043 6865 636b 2069 6e65 7175 616c     Check inequal
+00019500: 6974 7920 6265 7477 6565 6e20 7468 6520  ity between the 
+00019510: 4172 7261 7920 616e 6420 616e 6f74 6865  Array and anothe
+00019520: 7220 4172 7261 7920 6f72 2061 206e 756d  r Array or a num
+00019530: 6265 722e 0a0a 2020 2020 2020 2020 4172  ber...        Ar
+00019540: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00019550: 6f74 6865 723a 2054 6865 206f 7468 6572  other: The other
+00019560: 2041 7272 6179 206f 7220 6e75 6d62 6572   Array or number
+00019570: 2074 6f20 636f 6d70 6172 652e 0a0a 2020   to compare...  
+00019580: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+00019590: 2020 2020 2020 2020 2020 2041 206e 6577             A new
+000195a0: 2041 7272 6179 206f 626a 6563 7420 7769   Array object wi
+000195b0: 7468 2062 6f6f 6c65 616e 2076 616c 7565  th boolean value
+000195c0: 7320 696e 6469 6361 7469 6e67 2069 6e65  s indicating ine
+000195d0: 7175 616c 6974 792e 0a0a 2020 2020 2020  quality...      
+000195e0: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
+000195f0: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
+00019600: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00019610: 2063 6f6f 7264 7331 203d 207b 2764 696d   coords1 = {'dim
+00019620: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
+00019630: 2764 696d 3227 3a20 5b31 2c20 325d 7d0a  'dim2': [1, 2]}.
+00019640: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00019650: 6461 7461 3120 3d20 287b 2764 696d 3127  data1 = ({'dim1'
+00019660: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+00019670: 696d 3227 3a20 5b31 2c20 325d 7d2c 205b  im2': [1, 2]}, [
+00019680: 3130 2c20 3230 5d29 0a20 2020 2020 2020  10, 20]).       
+00019690: 2020 2020 203e 3e3e 2061 7272 3120 3d20       >>> arr1 = 
+000196a0: 4172 7261 7928 6461 7461 3d64 6174 6131  Array(data=data1
+000196b0: 2c20 636f 6f72 6473 3d63 6f6f 7264 7331  , coords=coords1
+000196c0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+000196d0: 3e20 636f 6f72 6473 3220 3d20 7b27 6469  > coords2 = {'di
+000196e0: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+000196f0: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+00019700: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00019710: 2064 6174 6132 203d 2028 7b27 6469 6d31   data2 = ({'dim1
+00019720: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+00019730: 6469 6d32 273a 205b 322c 2031 5d7d 2c20  dim2': [2, 1]}, 
+00019740: 5b32 302c 2031 305d 290a 2020 2020 2020  [20, 10]).      
+00019750: 2020 2020 2020 3e3e 3e20 6172 7232 203d        >>> arr2 =
+00019760: 2041 7272 6179 2864 6174 613d 6461 7461   Array(data=data
+00019770: 322c 2063 6f6f 7264 733d 636f 6f72 6473  2, coords=coords
+00019780: 3229 0a20 2020 2020 2020 2020 2020 203e  2).            >
+00019790: 3e3e 2061 7272 3120 213d 2061 7272 320a  >> arr1 != arr2.
+000197a0: 2020 2020 2020 2020 2020 2020 4172 7261              Arra
+000197b0: 7928 6461 7461 3d61 7272 6179 285b 5b20  y(data=array([[ 
+000197c0: 5472 7565 2c20 2054 7275 655d 2c0a 2020  True,  True],.  
+000197d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000197e0: 205b 2054 7275 652c 2020 5472 7565 5d5d   [ True,  True]]
+000197f0: 292c 2063 6f6f 7264 733d 7b27 6469 6d31  ), coords={'dim1
+00019800: 273a 2061 7272 6179 285b 2761 272c 2027  ': array(['a', '
+00019810: 6227 5d2c 2064 7479 7065 3d6f 626a 6563  b'], dtype=objec
+00019820: 7429 2c20 2764 696d 3227 3a20 6172 7261  t), 'dim2': arra
+00019830: 7928 5b31 2c20 325d 297d 290a 2020 2020  y([1, 2])}).    
+00019840: 2020 2020 2020 2020 3e3e 3e20 6172 7231          >>> arr1
+00019850: 2021 3d20 3130 0a20 2020 2020 2020 2020   != 10.         
+00019860: 2020 2041 7272 6179 2864 6174 613d 6172     Array(data=ar
+00019870: 7261 7928 5b5b 4661 6c73 652c 2020 5472  ray([[False,  Tr
+00019880: 7565 5d2c 0a20 2020 2020 2020 2020 2020  ue],.           
+00019890: 2020 2020 2020 2020 5b20 5472 7565 2c20          [ True, 
+000198a0: 2054 7275 655d 5d29 2c20 636f 6f72 6473   True]]), coords
+000198b0: 3d7b 2764 696d 3127 3a20 6172 7261 7928  ={'dim1': array(
+000198c0: 5b27 6127 2c20 2762 275d 2c20 6474 7970  ['a', 'b'], dtyp
+000198d0: 653d 6f62 6a65 6374 292c 2027 6469 6d32  e=object), 'dim2
+000198e0: 273a 2061 7272 6179 285b 312c 2032 5d29  ': array([1, 2])
+000198f0: 7d29 0a0a 2020 2020 2020 2020 2020 2020  })..            
+00019900: 6060 600a 2020 2020 2020 2020 2222 220a  ```.        """.
+00019910: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00019920: 7461 6e63 6528 6f74 6865 722c 2028 696e  tance(other, (in
+00019930: 742c 2066 6c6f 6174 2929 3a0a 2020 2020  t, float)):.    
+00019940: 2020 2020 2020 2020 6172 7220 3d20 7365          arr = se
+00019950: 6c66 2e64 6174 6120 213d 206f 7468 6572  lf.data != other
+00019960: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00019970: 7572 6e20 7365 6c66 2e5f 706f 7374 5f6f  urn self._post_o
+00019980: 7065 7261 7469 6f6e 2861 7272 2c20 7365  peration(arr, se
+00019990: 6c66 2e63 6f6f 7264 7329 0a20 2020 2020  lf.coords).     
+000199a0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+000199b0: 6365 286f 7468 6572 2c20 4172 7261 7929  ce(other, Array)
+000199c0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+000199d0: 6c66 5f61 7272 2c20 6f74 6865 725f 6172  lf_arr, other_ar
+000199e0: 722c 2063 6f6f 7264 7320 3d20 7365 6c66  r, coords = self
+000199f0: 2e5f 7072 655f 6f70 6572 6174 696f 6e5f  ._pre_operation_
+00019a00: 7769 7468 5f61 7272 6179 286f 7468 6572  with_array(other
+00019a10: 290a 2020 2020 2020 2020 2020 2020 6172  ).            ar
+00019a20: 7220 3d20 7365 6c66 5f61 7272 2021 3d20  r = self_arr != 
+00019a30: 6f74 6865 725f 6172 720a 2020 2020 2020  other_arr.      
+00019a40: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00019a50: 662e 5f70 6f73 745f 6f70 6572 6174 696f  f._post_operatio
+00019a60: 6e28 6172 722e 542c 2063 6f6f 7264 7329  n(arr.T, coords)
+00019a70: 0a0a 2020 2020 6465 6620 5f5f 6c74 5f5f  ..    def __lt__
+00019a80: 2873 656c 662c 206f 7468 6572 3a20 556e  (self, other: Un
+00019a90: 696f 6e5b 696e 742c 2066 6c6f 6174 2c20  ion[int, float, 
+00019aa0: 2741 7272 6179 275d 2920 2d3e 2027 4172  'Array']) -> 'Ar
+00019ab0: 7261 7927 3a0a 2020 2020 2020 2020 2222  ray':.        ""
+00019ac0: 220a 2020 2020 2020 2020 4368 6563 6b20  ".        Check 
+00019ad0: 6966 2074 6865 2041 7272 6179 2069 7320  if the Array is 
+00019ae0: 6c65 7373 2074 6861 6e20 616e 6f74 6865  less than anothe
+00019af0: 7220 4172 7261 7920 6f72 2061 206e 756d  r Array or a num
+00019b00: 6265 722e 0a0a 2020 2020 2020 2020 4172  ber...        Ar
+00019b10: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00019b20: 6f74 6865 723a 2054 6865 206f 7468 6572  other: The other
+00019b30: 2041 7272 6179 206f 7220 6e75 6d62 6572   Array or number
+00019b40: 2074 6f20 636f 6d70 6172 652e 0a0a 2020   to compare...  
+00019b50: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+00019b60: 2020 2020 2020 2020 2020 2041 206e 6577             A new
+00019b70: 2041 7272 6179 206f 626a 6563 7420 7769   Array object wi
+00019b80: 7468 2062 6f6f 6c65 616e 2076 616c 7565  th boolean value
+00019b90: 7320 696e 6469 6361 7469 6e67 206c 6573  s indicating les
+00019ba0: 7320 7468 616e 2e0a 0a20 2020 2020 2020  s than...       
+00019bb0: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
+00019bc0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+00019bd0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00019be0: 636f 6f72 6473 3120 3d20 7b27 6469 6d31  coords1 = {'dim1
+00019bf0: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+00019c00: 6469 6d32 273a 205b 312c 2032 5d7d 0a20  dim2': [1, 2]}. 
+00019c10: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
+00019c20: 6174 6131 203d 2028 7b27 6469 6d31 273a  ata1 = ({'dim1':
+00019c30: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
+00019c40: 6d32 273a 205b 312c 2032 5d7d 2c20 5b31  m2': [1, 2]}, [1
+00019c50: 302c 2032 305d 290a 2020 2020 2020 2020  0, 20]).        
+00019c60: 2020 2020 3e3e 3e20 6172 7231 203d 2041      >>> arr1 = A
+00019c70: 7272 6179 2864 6174 613d 6461 7461 312c  rray(data=data1,
+00019c80: 2063 6f6f 7264 733d 636f 6f72 6473 3129   coords=coords1)
+00019c90: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00019ca0: 2063 6f6f 7264 7332 203d 207b 2764 696d   coords2 = {'dim
+00019cb0: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
+00019cc0: 2764 696d 3227 3a20 5b31 2c20 325d 7d0a  'dim2': [1, 2]}.
+00019cd0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00019ce0: 6461 7461 3220 3d20 287b 2764 696d 3127  data2 = ({'dim1'
+00019cf0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+00019d00: 696d 3227 3a20 5b32 2c20 315d 7d2c 205b  im2': [2, 1]}, [
+00019d10: 3230 2c20 3130 5d29 0a20 2020 2020 2020  20, 10]).       
+00019d20: 2020 2020 203e 3e3e 2061 7272 3220 3d20       >>> arr2 = 
+00019d30: 4172 7261 7928 6461 7461 3d64 6174 6132  Array(data=data2
+00019d40: 2c20 636f 6f72 6473 3d63 6f6f 7264 7332  , coords=coords2
+00019d50: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00019d60: 3e20 6172 7231 203c 2061 7272 320a 2020  > arr1 < arr2.  
+00019d70: 2020 2020 2020 2020 2020 4172 7261 7928            Array(
+00019d80: 6461 7461 3d61 7272 6179 285b 5b46 616c  data=array([[Fal
+00019d90: 7365 2c20 2054 7275 655d 2c0a 2020 2020  se,  True],.    
+00019da0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00019db0: 2054 7275 652c 2046 616c 7365 5d5d 292c   True, False]]),
+00019dc0: 2063 6f6f 7264 733d 7b27 6469 6d31 273a   coords={'dim1':
+00019dd0: 2061 7272 6179 285b 2761 272c 2027 6227   array(['a', 'b'
+00019de0: 5d2c 2064 7479 7065 3d6f 626a 6563 7429  ], dtype=object)
+00019df0: 2c20 2764 696d 3227 3a20 6172 7261 7928  , 'dim2': array(
+00019e00: 5b31 2c20 325d 297d 290a 2020 2020 2020  [1, 2])}).      
+00019e10: 2020 2020 2020 3e3e 3e20 6172 7231 203c        >>> arr1 <
+00019e20: 2031 350a 2020 2020 2020 2020 2020 2020   15.            
+00019e30: 4172 7261 7928 6461 7461 3d61 7272 6179  Array(data=array
+00019e40: 285b 5b20 5472 7565 2c20 2054 7275 655d  ([[ True,  True]
+00019e50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019e60: 2020 2020 205b 2054 7275 652c 2046 616c       [ True, Fal
+00019e70: 7365 5d5d 292c 2063 6f6f 7264 733d 7b27  se]]), coords={'
+00019e80: 6469 6d31 273a 2061 7272 6179 285b 2761  dim1': array(['a
+00019e90: 272c 2027 6227 5d2c 2064 7479 7065 3d6f  ', 'b'], dtype=o
+00019ea0: 626a 6563 7429 2c20 2764 696d 3227 3a20  bject), 'dim2': 
+00019eb0: 6172 7261 7928 5b31 2c20 325d 297d 290a  array([1, 2])}).
+00019ec0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+00019ed0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00019ee0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00019ef0: 6365 286f 7468 6572 2c20 2869 6e74 2c20  ce(other, (int, 
+00019f00: 666c 6f61 7429 293a 0a20 2020 2020 2020  float)):.       
+00019f10: 2020 2020 2061 7272 203d 2073 656c 662e       arr = self.
+00019f20: 6461 7461 203c 206f 7468 6572 0a20 2020  data < other.   
+00019f30: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00019f40: 7365 6c66 2e5f 706f 7374 5f6f 7065 7261  self._post_opera
+00019f50: 7469 6f6e 2861 7272 2c20 7365 6c66 2e63  tion(arr, self.c
+00019f60: 6f6f 7264 7329 0a20 2020 2020 2020 2065  oords).        e
+00019f70: 6c69 6620 6973 696e 7374 616e 6365 286f  lif isinstance(o
+00019f80: 7468 6572 2c20 4172 7261 7929 3a0a 2020  ther, Array):.  
+00019f90: 2020 2020 2020 2020 2020 7365 6c66 5f61            self_a
+00019fa0: 7272 2c20 6f74 6865 725f 6172 722c 2063  rr, other_arr, c
+00019fb0: 6f6f 7264 7320 3d20 7365 6c66 2e5f 7072  oords = self._pr
+00019fc0: 655f 6f70 6572 6174 696f 6e5f 7769 7468  e_operation_with
+00019fd0: 5f61 7272 6179 286f 7468 6572 290a 2020  _array(other).  
+00019fe0: 2020 2020 2020 2020 2020 6172 7220 3d20            arr = 
+00019ff0: 7365 6c66 5f61 7272 203c 206f 7468 6572  self_arr < other
+0001a000: 5f61 7272 0a20 2020 2020 2020 2020 2020  _arr.           
+0001a010: 2072 6574 7572 6e20 7365 6c66 2e5f 706f   return self._po
+0001a020: 7374 5f6f 7065 7261 7469 6f6e 2861 7272  st_operation(arr
+0001a030: 2e54 2c20 636f 6f72 6473 290a 0a20 2020  .T, coords)..   
+0001a040: 2064 6566 205f 5f72 6c74 5f5f 2873 656c   def __rlt__(sel
+0001a050: 662c 206f 7468 6572 3a20 556e 696f 6e5b  f, other: Union[
+0001a060: 696e 742c 2066 6c6f 6174 5d29 202d 3e20  int, float]) -> 
+0001a070: 2741 7272 6179 273a 0a20 2020 2020 2020  'Array':.       
+0001a080: 2022 2222 0a20 2020 2020 2020 2043 6865   """.        Che
+0001a090: 636b 2069 6620 6120 6e75 6d62 6572 2069  ck if a number i
+0001a0a0: 7320 6c65 7373 2074 6861 6e20 7468 6520  s less than the 
+0001a0b0: 4172 7261 7920 2872 6576 6572 7365 206c  Array (reverse l
+0001a0c0: 6573 7320 7468 616e 292e 0a0a 2020 2020  ess than)...    
+0001a0d0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0001a0e0: 2020 2020 2020 6f74 6865 723a 2054 6865        other: The
+0001a0f0: 206e 756d 6265 7220 746f 2063 6f6d 7061   number to compa
+0001a100: 7265 2e0a 0a20 2020 2020 2020 2052 6574  re...        Ret
+0001a110: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
+0001a120: 2020 4120 6e65 7720 4172 7261 7920 6f62    A new Array ob
+0001a130: 6a65 6374 2077 6974 6820 626f 6f6c 6561  ject with boolea
+0001a140: 6e20 7661 6c75 6573 2069 6e64 6963 6174  n values indicat
+0001a150: 696e 6720 6c65 7373 2074 6861 6e2e 0a0a  ing less than...
+0001a160: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
+0001a170: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+0001a180: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
+0001a190: 2020 203e 3e3e 2063 6f6f 7264 7320 3d20     >>> coords = 
+0001a1a0: 7b27 6469 6d31 273a 205b 2761 272c 2027  {'dim1': ['a', '
+0001a1b0: 6227 5d2c 2027 6469 6d32 273a 205b 312c  b'], 'dim2': [1,
+0001a1c0: 2032 5d7d 0a20 2020 2020 2020 2020 2020   2]}.           
+0001a1d0: 203e 3e3e 2064 6174 6120 3d20 287b 2764   >>> data = ({'d
+0001a1e0: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
+0001a1f0: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
+0001a200: 7d2c 205b 3130 2c20 3230 5d29 0a20 2020  }, [10, 20]).   
+0001a210: 2020 2020 2020 2020 203e 3e3e 2061 7272           >>> arr
+0001a220: 203d 2041 7272 6179 2864 6174 613d 6461   = Array(data=da
+0001a230: 7461 2c20 636f 6f72 6473 3d63 6f6f 7264  ta, coords=coord
+0001a240: 7329 0a20 2020 2020 2020 2020 2020 203e  s).            >
+0001a250: 3e3e 2035 203c 2061 7272 0a20 2020 2020  >> 5 < arr.     
+0001a260: 2020 2020 2020 2041 7272 6179 2864 6174         Array(dat
+0001a270: 613d 6172 7261 7928 5b5b 2054 7275 652c  a=array([[ True,
+0001a280: 2046 616c 7365 5d2c 0a20 2020 2020 2020   False],.       
+0001a290: 2020 2020 2020 2020 2020 2020 5b46 616c              [Fal
+0001a2a0: 7365 2c20 2054 7275 655d 5d29 2c20 636f  se,  True]]), co
+0001a2b0: 6f72 6473 3d7b 2764 696d 3127 3a20 6172  ords={'dim1': ar
+0001a2c0: 7261 7928 5b27 6127 2c20 2762 275d 2c20  ray(['a', 'b'], 
+0001a2d0: 6474 7970 653d 6f62 6a65 6374 292c 2027  dtype=object), '
+0001a2e0: 6469 6d32 273a 2061 7272 6179 285b 312c  dim2': array([1,
+0001a2f0: 2032 5d29 7d29 0a0a 2020 2020 2020 2020   2])})..        
+0001a300: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+0001a310: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
+0001a320: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
+0001a330: 2028 696e 742c 2066 6c6f 6174 2929 3a0a   (int, float)):.
+0001a340: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
+0001a350: 3d20 6f74 6865 7220 3c20 7365 6c66 2e64  = other < self.d
+0001a360: 6174 610a 2020 2020 2020 2020 2020 2020  ata.            
+0001a370: 7265 7475 726e 2073 656c 662e 5f70 6f73  return self._pos
+0001a380: 745f 6f70 6572 6174 696f 6e28 6172 722c  t_operation(arr,
+0001a390: 2073 656c 662e 636f 6f72 6473 290a 0a20   self.coords).. 
+0001a3a0: 2020 2064 6566 205f 5f6c 655f 5f28 7365     def __le__(se
+0001a3b0: 6c66 2c20 6f74 6865 723a 2055 6e69 6f6e  lf, other: Union
+0001a3c0: 5b69 6e74 2c20 666c 6f61 742c 2027 4172  [int, float, 'Ar
+0001a3d0: 7261 7927 5d29 202d 3e20 2741 7272 6179  ray']) -> 'Array
+0001a3e0: 273a 0a20 2020 2020 2020 2022 2222 0a20  ':.        """. 
+0001a3f0: 2020 2020 2020 2043 6865 636b 2069 6620         Check if 
+0001a400: 7468 6520 4172 7261 7920 6973 206c 6573  the Array is les
+0001a410: 7320 7468 616e 206f 7220 6571 7561 6c20  s than or equal 
+0001a420: 746f 2061 6e6f 7468 6572 2041 7272 6179  to another Array
+0001a430: 206f 7220 6120 6e75 6d62 6572 2e0a 0a20   or a number... 
+0001a440: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+0001a450: 2020 2020 2020 2020 206f 7468 6572 3a20           other: 
+0001a460: 5468 6520 6f74 6865 7220 4172 7261 7920  The other Array 
+0001a470: 6f72 206e 756d 6265 7220 746f 2063 6f6d  or number to com
+0001a480: 7061 7265 2e0a 0a20 2020 2020 2020 2052  pare...        R
+0001a490: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+0001a4a0: 2020 2020 4120 6e65 7720 4172 7261 7920      A new Array 
+0001a4b0: 6f62 6a65 6374 2077 6974 6820 626f 6f6c  object with bool
+0001a4c0: 6561 6e20 7661 6c75 6573 2069 6e64 6963  ean values indic
+0001a4d0: 6174 696e 6720 6c65 7373 2074 6861 6e20  ating less than 
+0001a4e0: 6f72 2065 7175 616c 2074 6f2e 0a0a 2020  or equal to...  
+0001a4f0: 2020 2020 2020 4578 616d 706c 653a 0a20        Example:. 
+0001a500: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
+0001a510: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
+0001a520: 203e 3e3e 2063 6f6f 7264 7331 203d 207b   >>> coords1 = {
+0001a530: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
+0001a540: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
+0001a550: 325d 7d0a 2020 2020 2020 2020 2020 2020  2]}.            
+0001a560: 3e3e 3e20 6461 7461 3120 3d20 287b 2764  >>> data1 = ({'d
+0001a570: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
+0001a580: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
+0001a590: 7d2c 205b 3130 2c20 3230 5d29 0a20 2020  }, [10, 20]).   
+0001a5a0: 2020 2020 2020 2020 203e 3e3e 2061 7272           >>> arr
+0001a5b0: 3120 3d20 4172 7261 7928 6461 7461 3d64  1 = Array(data=d
+0001a5c0: 6174 6131 2c20 636f 6f72 6473 3d63 6f6f  ata1, coords=coo
+0001a5d0: 7264 7331 290a 2020 2020 2020 2020 2020  rds1).          
+0001a5e0: 2020 3e3e 3e20 636f 6f72 6473 3220 3d20    >>> coords2 = 
+0001a5f0: 7b27 6469 6d31 273a 205b 2761 272c 2027  {'dim1': ['a', '
+0001a600: 6227 5d2c 2027 6469 6d32 273a 205b 312c  b'], 'dim2': [1,
+0001a610: 2032 5d7d 0a20 2020 2020 2020 2020 2020   2]}.           
+0001a620: 203e 3e3e 206c 6f6e 6732 203d 204c 6f6e   >>> long2 = Lon
+0001a630: 6728 696e 6465 783d 7b27 6469 6d31 273a  g(index={'dim1':
+0001a640: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
+0001a650: 6d32 273a 205b 322c 2031 5d7d 2c20 7661  m2': [2, 1]}, va
+0001a660: 6c75 653d 5b32 302c 2031 305d 290a 2020  lue=[20, 10]).  
+0001a670: 2020 2020 2020 2020 2020 3e3e 3e20 6172            >>> ar
+0001a680: 7232 203d 2041 7272 6179 2864 6174 613d  r2 = Array(data=
+0001a690: 6c6f 6e67 322c 2063 6f6f 7264 733d 636f  long2, coords=co
+0001a6a0: 6f72 6473 3229 0a20 2020 2020 2020 2020  ords2).         
+0001a6b0: 2020 203e 3e3e 2061 7272 3120 3c3d 2061     >>> arr1 <= a
+0001a6c0: 7272 320a 2020 2020 2020 2020 2020 2020  rr2.            
+0001a6d0: 4172 7261 7928 6461 7461 3d61 7272 6179  Array(data=array
+0001a6e0: 285b 5b46 616c 7365 2c20 2054 7275 655d  ([[False,  True]
+0001a6f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001a700: 2020 2020 205b 2054 7275 652c 2046 616c       [ True, Fal
+0001a710: 7365 5d5d 292c 2063 6f6f 7264 733d 7b27  se]]), coords={'
+0001a720: 6469 6d31 273a 2061 7272 6179 285b 2761  dim1': array(['a
+0001a730: 272c 2027 6227 5d2c 2064 7479 7065 3d6f  ', 'b'], dtype=o
+0001a740: 626a 6563 7429 2c20 2764 696d 3227 3a20  bject), 'dim2': 
+0001a750: 6172 7261 7928 5b31 2c20 325d 297d 290a  array([1, 2])}).
+0001a760: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0001a770: 6172 7231 203c 3d20 3130 0a20 2020 2020  arr1 <= 10.     
+0001a780: 2020 2020 2020 2041 7272 6179 2864 6174         Array(dat
+0001a790: 613d 6172 7261 7928 5b5b 2054 7275 652c  a=array([[ True,
+0001a7a0: 2020 5472 7565 5d2c 0a20 2020 2020 2020    True],.       
+0001a7b0: 2020 2020 2020 2020 2020 2020 5b20 5472              [ Tr
+0001a7c0: 7565 2c20 4661 6c73 655d 5d29 2c20 636f  ue, False]]), co
+0001a7d0: 6f72 6473 3d7b 2764 696d 3127 3a20 6172  ords={'dim1': ar
+0001a7e0: 7261 7928 5b27 6127 2c20 2762 275d 2c20  ray(['a', 'b'], 
+0001a7f0: 6474 7970 653d 6f62 6a65 6374 292c 2027  dtype=object), '
+0001a800: 6469 6d32 273a 2061 7272 6179 285b 312c  dim2': array([1,
+0001a810: 2032 5d29 7d29 0a0a 2020 2020 2020 2020   2])})..        
+0001a820: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+0001a830: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
+0001a840: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
+0001a850: 2028 696e 742c 2066 6c6f 6174 2929 3a0a   (int, float)):.
+0001a860: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
+0001a870: 3d20 7365 6c66 2e64 6174 6120 3c3d 206f  = self.data <= o
+0001a880: 7468 6572 0a20 2020 2020 2020 2020 2020  ther.           
+0001a890: 2072 6574 7572 6e20 7365 6c66 2e5f 706f   return self._po
+0001a8a0: 7374 5f6f 7065 7261 7469 6f6e 2861 7272  st_operation(arr
+0001a8b0: 2c20 7365 6c66 2e63 6f6f 7264 7329 0a20  , self.coords). 
+0001a8c0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+0001a8d0: 7374 616e 6365 286f 7468 6572 2c20 4172  stance(other, Ar
+0001a8e0: 7261 7929 3a0a 2020 2020 2020 2020 2020  ray):.          
+0001a8f0: 2020 7365 6c66 5f61 7272 2c20 6f74 6865    self_arr, othe
+0001a900: 725f 6172 722c 2063 6f6f 7264 7320 3d20  r_arr, coords = 
+0001a910: 7365 6c66 2e5f 7072 655f 6f70 6572 6174  self._pre_operat
+0001a920: 696f 6e5f 7769 7468 5f61 7272 6179 286f  ion_with_array(o
+0001a930: 7468 6572 290a 2020 2020 2020 2020 2020  ther).          
+0001a940: 2020 6172 7220 3d20 7365 6c66 5f61 7272    arr = self_arr
+0001a950: 203c 3d20 6f74 6865 725f 6172 720a 2020   <= other_arr.  
+0001a960: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001a970: 2073 656c 662e 5f70 6f73 745f 6f70 6572   self._post_oper
+0001a980: 6174 696f 6e28 6172 722e 542c 2063 6f6f  ation(arr.T, coo
+0001a990: 7264 7329 0a0a 2020 2020 6465 6620 5f5f  rds)..    def __
+0001a9a0: 726c 655f 5f28 7365 6c66 2c20 6f74 6865  rle__(self, othe
+0001a9b0: 723a 2055 6e69 6f6e 5b69 6e74 2c20 666c  r: Union[int, fl
+0001a9c0: 6f61 745d 2920 2d3e 2027 4172 7261 7927  oat]) -> 'Array'
+0001a9d0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001a9e0: 2020 2020 2020 4368 6563 6b20 6966 2061        Check if a
+0001a9f0: 206e 756d 6265 7220 6973 206c 6573 7320   number is less 
+0001aa00: 7468 616e 206f 7220 6571 7561 6c20 746f  than or equal to
+0001aa10: 2074 6865 2041 7272 6179 2028 7265 7665   the Array (reve
+0001aa20: 7273 6520 6c65 7373 2074 6861 6e20 6f72  rse less than or
+0001aa30: 2065 7175 616c 2074 6f29 2e0a 0a20 2020   equal to)...   
+0001aa40: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
+0001aa50: 2020 2020 2020 206f 7468 6572 3a20 5468         other: Th
+0001aa60: 6520 6e75 6d62 6572 2074 6f20 636f 6d70  e number to comp
+0001aa70: 6172 652e 0a0a 2020 2020 2020 2020 5265  are...        Re
+0001aa80: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
+0001aa90: 2020 2041 206e 6577 2041 7272 6179 206f     A new Array o
+0001aaa0: 626a 6563 7420 7769 7468 2062 6f6f 6c65  bject with boole
+0001aab0: 616e 2076 616c 7565 7320 696e 6469 6361  an values indica
+0001aac0: 7469 6e67 206c 6573 7320 7468 616e 206f  ting less than o
+0001aad0: 7220 6571 7561 6c20 746f 2e0a 0a20 2020  r equal to...   
+0001aae0: 2020 2020 2045 7861 6d70 6c65 3a0a 2020       Example:.  
+0001aaf0: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
+0001ab00: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
+0001ab10: 3e3e 3e20 636f 6f72 6473 203d 207b 2764  >>> coords = {'d
+0001ab20: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
+0001ab30: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
+0001ab40: 7d0a 2020 2020 2020 2020 2020 2020 3e3e  }.            >>
+0001ab50: 3e20 6461 7461 203d 2028 7b27 6469 6d31  > data = ({'dim1
+0001ab60: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+0001ab70: 6469 6d32 273a 205b 312c 2032 5d7d 2c20  dim2': [1, 2]}, 
+0001ab80: 5b31 302c 2032 305d 290a 2020 2020 2020  [10, 20]).      
+0001ab90: 2020 2020 2020 3e3e 3e20 6172 7220 3d20        >>> arr = 
+0001aba0: 4172 7261 7928 6461 7461 3d64 6174 612c  Array(data=data,
+0001abb0: 2063 6f6f 7264 733d 636f 6f72 6473 290a   coords=coords).
+0001abc0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0001abd0: 3130 203c 3d20 6172 720a 2020 2020 2020  10 <= arr.      
+0001abe0: 2020 2020 2020 4172 7261 7928 6461 7461        Array(data
+0001abf0: 3d61 7272 6179 285b 5b20 5472 7565 2c20  =array([[ True, 
+0001ac00: 4661 6c73 655d 2c0a 2020 2020 2020 2020  False],.        
+0001ac10: 2020 2020 2020 2020 2020 205b 4661 6c73             [Fals
+0001ac20: 652c 2020 5472 7565 5d5d 292c 2063 6f6f  e,  True]]), coo
+0001ac30: 7264 733d 7b27 6469 6d31 273a 2061 7272  rds={'dim1': arr
+0001ac40: 6179 285b 2761 272c 2027 6227 5d2c 2064  ay(['a', 'b'], d
+0001ac50: 7479 7065 3d6f 626a 6563 7429 2c20 2764  type=object), 'd
+0001ac60: 696d 3227 3a20 6172 7261 7928 5b31 2c20  im2': array([1, 
+0001ac70: 325d 297d 290a 0a20 2020 2020 2020 2020  2])})..         
+0001ac80: 2020 2060 6060 0a20 2020 2020 2020 2022     ```.        "
+0001ac90: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
+0001aca0: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
+0001acb0: 2869 6e74 2c20 666c 6f61 7429 293a 0a20  (int, float)):. 
+0001acc0: 2020 2020 2020 2020 2020 2061 7272 203d             arr =
+0001acd0: 206f 7468 6572 203c 3d20 7365 6c66 2e64   other <= self.d
+0001ace0: 6174 610a 2020 2020 2020 2020 2020 2020  ata.            
+0001acf0: 7265 7475 726e 2073 656c 662e 5f70 6f73  return self._pos
+0001ad00: 745f 6f70 6572 6174 696f 6e28 6172 722c  t_operation(arr,
+0001ad10: 2073 656c 662e 636f 6f72 6473 290a 0a20   self.coords).. 
+0001ad20: 2020 2064 6566 205f 5f67 745f 5f28 7365     def __gt__(se
+0001ad30: 6c66 2c20 6f74 6865 723a 2055 6e69 6f6e  lf, other: Union
+0001ad40: 5b69 6e74 2c20 666c 6f61 742c 2027 4172  [int, float, 'Ar
+0001ad50: 7261 7927 5d29 202d 3e20 2741 7272 6179  ray']) -> 'Array
+0001ad60: 273a 0a20 2020 2020 2020 2022 2222 0a20  ':.        """. 
+0001ad70: 2020 2020 2020 2043 6865 636b 2069 6620         Check if 
+0001ad80: 7468 6520 4172 7261 7920 6973 2067 7265  the Array is gre
+0001ad90: 6174 6572 2074 6861 6e20 616e 6f74 6865  ater than anothe
+0001ada0: 7220 4172 7261 7920 6f72 2061 206e 756d  r Array or a num
+0001adb0: 6265 722e 0a0a 2020 2020 2020 2020 4172  ber...        Ar
+0001adc0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+0001add0: 6f74 6865 723a 2054 6865 206f 7468 6572  other: The other
+0001ade0: 2041 7272 6179 206f 7220 6e75 6d62 6572   Array or number
+0001adf0: 2074 6f20 636f 6d70 6172 652e 0a0a 2020   to compare...  
+0001ae00: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+0001ae10: 2020 2020 2020 2020 2020 2041 206e 6577             A new
+0001ae20: 2041 7272 6179 206f 626a 6563 7420 7769   Array object wi
+0001ae30: 7468 2062 6f6f 6c65 616e 2076 616c 7565  th boolean value
+0001ae40: 7320 696e 6469 6361 7469 6e67 2067 7265  s indicating gre
+0001ae50: 6174 6572 2074 6861 6e2e 0a0a 2020 2020  ater than...    
+0001ae60: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+0001ae70: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+0001ae80: 6f6e 0a20 2020 2020 2020 2020 2020 203e  on.            >
+0001ae90: 3e3e 2063 6f6f 7264 7331 203d 207b 2764  >> coords1 = {'d
+0001aea0: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
+0001aeb0: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
+0001aec0: 7d0a 2020 2020 2020 2020 2020 2020 3e3e  }.            >>
+0001aed0: 3e20 6c6f 6e67 3120 3d20 4c6f 6e67 2869  > long1 = Long(i
+0001aee0: 6e64 6578 3d7b 2764 696d 3127 3a20 5b27  ndex={'dim1': ['
+0001aef0: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
+0001af00: 3a20 5b31 2c20 325d 7d2c 2076 616c 7565  : [1, 2]}, value
+0001af10: 3d5b 3130 2c20 3230 5d29 0a20 2020 2020  =[10, 20]).     
+0001af20: 2020 2020 2020 203e 3e3e 2061 7272 3120         >>> arr1 
+0001af30: 3d20 4172 7261 7928 6461 7461 3d6c 6f6e  = Array(data=lon
+0001af40: 6731 2c20 636f 6f72 6473 3d63 6f6f 7264  g1, coords=coord
+0001af50: 7331 290a 2020 2020 2020 2020 2020 2020  s1).            
+0001af60: 3e3e 3e20 636f 6f72 6473 3220 3d20 7b27  >>> coords2 = {'
+0001af70: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
+0001af80: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
+0001af90: 5d7d 0a20 2020 2020 2020 2020 2020 203e  ]}.            >
+0001afa0: 3e3e 2064 6174 6132 203d 2028 7b27 6469  >> data2 = ({'di
+0001afb0: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+0001afc0: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+0001afd0: 2c20 5b32 302c 2031 305d 290a 2020 2020  , [20, 10]).    
+0001afe0: 2020 2020 2020 2020 3e3e 3e20 6172 7232          >>> arr2
+0001aff0: 203d 2041 7272 6179 2864 6174 613d 6461   = Array(data=da
+0001b000: 7461 322c 2063 6f6f 7264 733d 636f 6f72  ta2, coords=coor
+0001b010: 6473 3229 0a20 2020 2020 2020 2020 2020  ds2).           
+0001b020: 203e 3e3e 2061 7272 3120 3e20 6172 7232   >>> arr1 > arr2
+0001b030: 0a20 2020 2020 2020 2020 2020 2041 7272  .            Arr
+0001b040: 6179 2864 6174 613d 6172 7261 7928 5b5b  ay(data=array([[
+0001b050: 4661 6c73 652c 2046 616c 7365 5d2c 0a20  False, False],. 
+0001b060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b070: 2020 5b46 616c 7365 2c20 2054 7275 655d    [False,  True]
+0001b080: 5d29 2c20 636f 6f72 6473 3d7b 2764 696d  ]), coords={'dim
+0001b090: 3127 3a20 6172 7261 7928 5b27 6127 2c20  1': array(['a', 
+0001b0a0: 2762 275d 2c20 6474 7970 653d 6f62 6a65  'b'], dtype=obje
+0001b0b0: 6374 292c 2027 6469 6d32 273a 2061 7272  ct), 'dim2': arr
+0001b0c0: 6179 285b 312c 2032 5d29 7d29 0a20 2020  ay([1, 2])}).   
+0001b0d0: 2020 2020 2020 2020 203e 3e3e 2061 7272           >>> arr
+0001b0e0: 3120 3e20 3135 0a20 2020 2020 2020 2020  1 > 15.         
+0001b0f0: 2020 2041 7272 6179 2864 6174 613d 6172     Array(data=ar
+0001b100: 7261 7928 5b5b 4661 6c73 652c 2046 616c  ray([[False, Fal
+0001b110: 7365 5d2c 0a20 2020 2020 2020 2020 2020  se],.           
+0001b120: 2020 2020 2020 2020 5b46 616c 7365 2c20          [False, 
+0001b130: 2054 7275 655d 5d29 2c20 636f 6f72 6473   True]]), coords
+0001b140: 3d7b 2764 696d 3127 3a20 6172 7261 7928  ={'dim1': array(
+0001b150: 5b27 6127 2c20 2762 275d 2c20 6474 7970  ['a', 'b'], dtyp
+0001b160: 653d 6f62 6a65 6374 292c 2027 6469 6d32  e=object), 'dim2
+0001b170: 273a 2061 7272 6179 285b 312c 2032 5d29  ': array([1, 2])
+0001b180: 7d29 0a0a 2020 2020 2020 2020 2020 2020  })..            
+0001b190: 6060 600a 2020 2020 2020 2020 2222 220a  ```.        """.
+0001b1a0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0001b1b0: 7461 6e63 6528 6f74 6865 722c 2028 696e  tance(other, (in
+0001b1c0: 742c 2066 6c6f 6174 2929 3a0a 2020 2020  t, float)):.    
+0001b1d0: 2020 2020 2020 2020 6172 7220 3d20 7365          arr = se
+0001b1e0: 6c66 2e64 6174 6120 3e20 6f74 6865 720a  lf.data > other.
+0001b1f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001b200: 726e 2073 656c 662e 5f70 6f73 745f 6f70  rn self._post_op
+0001b210: 6572 6174 696f 6e28 6172 722c 2073 656c  eration(arr, sel
+0001b220: 662e 636f 6f72 6473 290a 2020 2020 2020  f.coords).      
+0001b230: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+0001b240: 6528 6f74 6865 722c 2041 7272 6179 293a  e(other, Array):
+0001b250: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001b260: 665f 6172 722c 206f 7468 6572 5f61 7272  f_arr, other_arr
+0001b270: 2c20 636f 6f72 6473 203d 2073 656c 662e  , coords = self.
+0001b280: 5f70 7265 5f6f 7065 7261 7469 6f6e 5f77  _pre_operation_w
+0001b290: 6974 685f 6172 7261 7928 6f74 6865 7229  ith_array(other)
+0001b2a0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+0001b2b0: 203d 2073 656c 665f 6172 7220 3e20 6f74   = self_arr > ot
+0001b2c0: 6865 725f 6172 720a 2020 2020 2020 2020  her_arr.        
+0001b2d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001b2e0: 5f70 6f73 745f 6f70 6572 6174 696f 6e28  _post_operation(
+0001b2f0: 6172 722e 542c 2063 6f6f 7264 7329 0a0a  arr.T, coords)..
+0001b300: 2020 2020 6465 6620 5f5f 7267 745f 5f28      def __rgt__(
+0001b310: 7365 6c66 2c20 6f74 6865 723a 2055 6e69  self, other: Uni
+0001b320: 6f6e 5b69 6e74 2c20 666c 6f61 745d 2920  on[int, float]) 
+0001b330: 2d3e 2027 4172 7261 7927 3a0a 2020 2020  -> 'Array':.    
+0001b340: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001b350: 4368 6563 6b20 6966 2061 206e 756d 6265  Check if a numbe
+0001b360: 7220 6973 2067 7265 6174 6572 2074 6861  r is greater tha
+0001b370: 6e20 7468 6520 4172 7261 7920 2872 6576  n the Array (rev
+0001b380: 6572 7365 2067 7265 6174 6572 2074 6861  erse greater tha
+0001b390: 6e29 2e0a 0a20 2020 2020 2020 2041 7267  n)...        Arg
+0001b3a0: 733a 0a20 2020 2020 2020 2020 2020 206f  s:.            o
+0001b3b0: 7468 6572 3a20 5468 6520 6e75 6d62 6572  ther: The number
+0001b3c0: 2074 6f20 636f 6d70 6172 652e 0a0a 2020   to compare...  
+0001b3d0: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+0001b3e0: 2020 2020 2020 2020 2020 2041 206e 6577             A new
+0001b3f0: 2041 7272 6179 206f 626a 6563 7420 7769   Array object wi
+0001b400: 7468 2062 6f6f 6c65 616e 2076 616c 7565  th boolean value
+0001b410: 7320 696e 6469 6361 7469 6e67 2067 7265  s indicating gre
+0001b420: 6174 6572 2074 6861 6e2e 0a0a 2020 2020  ater than...    
+0001b430: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+0001b440: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+0001b450: 6f6e 0a20 2020 2020 2020 2020 2020 203e  on.            >
+0001b460: 3e3e 2063 6f6f 7264 7320 3d20 7b27 6469  >> coords = {'di
+0001b470: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+0001b480: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+0001b490: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+0001b4a0: 2064 656e 7365 203d 206e 702e 6172 7261   dense = np.arra
+0001b4b0: 7928 5b5b 3130 2c20 3230 5d2c 205b 3230  y([[10, 20], [20
+0001b4c0: 2c20 3130 5d5d 290a 2020 2020 2020 2020  , 10]]).        
+0001b4d0: 2020 2020 3e3e 3e20 6172 7220 3d20 4172      >>> arr = Ar
+0001b4e0: 7261 7928 6461 7461 3d64 656e 7365 2c20  ray(data=dense, 
+0001b4f0: 636f 6f72 6473 3d63 6f6f 7264 7329 0a20  coords=coords). 
+0001b500: 2020 2020 2020 2020 2020 203e 3e3e 2031             >>> 1
+0001b510: 3520 3e20 6172 720a 2020 2020 2020 2020  5 > arr.        
+0001b520: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
+0001b530: 7272 6179 285b 5b20 5472 7565 2c20 4661  rray([[ True, Fa
+0001b540: 6c73 655d 2c0a 2020 2020 2020 2020 2020  lse],.          
+0001b550: 2020 2020 2020 2020 205b 4661 6c73 652c           [False,
+0001b560: 2020 5472 7565 5d5d 292c 2063 6f6f 7264    True]]), coord
+0001b570: 733d 7b27 6469 6d31 273a 2061 7272 6179  s={'dim1': array
+0001b580: 285b 2761 272c 2027 6227 5d2c 2064 7479  (['a', 'b'], dty
+0001b590: 7065 3d6f 626a 6563 7429 2c20 2764 696d  pe=object), 'dim
+0001b5a0: 3227 3a20 6172 7261 7928 5b31 2c20 325d  2': array([1, 2]
+0001b5b0: 297d 290a 0a20 2020 2020 2020 2020 2020  )})..           
+0001b5c0: 2060 6060 0a20 2020 2020 2020 2022 2222   ```.        """
+0001b5d0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0001b5e0: 7374 616e 6365 286f 7468 6572 2c20 2869  stance(other, (i
+0001b5f0: 6e74 2c20 666c 6f61 7429 293a 0a20 2020  nt, float)):.   
+0001b600: 2020 2020 2020 2020 2061 7272 203d 206f           arr = o
+0001b610: 7468 6572 203e 2073 656c 662e 6461 7461  ther > self.data
+0001b620: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001b630: 7572 6e20 7365 6c66 2e5f 706f 7374 5f6f  urn self._post_o
+0001b640: 7065 7261 7469 6f6e 2861 7272 2c20 7365  peration(arr, se
+0001b650: 6c66 2e63 6f6f 7264 7329 0a0a 2020 2020  lf.coords)..    
+0001b660: 6465 6620 5f5f 6765 5f5f 2873 656c 662c  def __ge__(self,
+0001b670: 206f 7468 6572 3a20 556e 696f 6e5b 696e   other: Union[in
+0001b680: 742c 2066 6c6f 6174 2c20 2741 7272 6179  t, float, 'Array
+0001b690: 275d 2920 2d3e 2027 4172 7261 7927 3a0a  ']) -> 'Array':.
+0001b6a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001b6b0: 2020 2020 4368 6563 6b20 6966 2074 6865      Check if the
+0001b6c0: 2041 7272 6179 2069 7320 6772 6561 7465   Array is greate
+0001b6d0: 7220 7468 616e 206f 7220 6571 7561 6c20  r than or equal 
+0001b6e0: 746f 2061 6e6f 7468 6572 2041 7272 6179  to another Array
+0001b6f0: 206f 7220 6120 6e75 6d62 6572 2e0a 0a20   or a number... 
+0001b700: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+0001b710: 2020 2020 2020 2020 206f 7468 6572 3a20           other: 
+0001b720: 5468 6520 6f74 6865 7220 4172 7261 7920  The other Array 
+0001b730: 6f72 206e 756d 6265 7220 746f 2063 6f6d  or number to com
+0001b740: 7061 7265 2e0a 0a20 2020 2020 2020 2052  pare...        R
+0001b750: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+0001b760: 2020 2020 4120 6e65 7720 4172 7261 7920      A new Array 
+0001b770: 6f62 6a65 6374 2077 6974 6820 626f 6f6c  object with bool
+0001b780: 6561 6e20 7661 6c75 6573 2069 6e64 6963  ean values indic
+0001b790: 6174 696e 6720 6772 6561 7465 7220 7468  ating greater th
+0001b7a0: 616e 206f 7220 6571 7561 6c20 746f 2e0a  an or equal to..
+0001b7b0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+0001b7c0: 3a0a 2020 2020 2020 2020 2020 2020 6060  :.            ``
+0001b7d0: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
+0001b7e0: 2020 2020 3e3e 3e20 636f 6f72 6473 203d      >>> coords =
+0001b7f0: 207b 2764 696d 3127 3a20 5b27 6127 2c20   {'dim1': ['a', 
+0001b800: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
+0001b810: 2c20 325d 7d0a 2020 2020 2020 2020 2020  , 2]}.          
+0001b820: 2020 3e3e 3e20 6c6f 6e67 3120 3d20 4c6f    >>> long1 = Lo
+0001b830: 6e67 2869 6e64 6578 3d7b 2764 696d 3127  ng(index={'dim1'
+0001b840: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+0001b850: 696d 3227 3a20 5b31 2c20 325d 7d2c 2076  im2': [1, 2]}, v
+0001b860: 616c 7565 3d5b 3130 2c20 3230 5d29 0a20  alue=[10, 20]). 
+0001b870: 2020 2020 2020 2020 2020 203e 3e3e 206c             >>> l
+0001b880: 6f6e 6732 203d 204c 6f6e 6728 696e 6465  ong2 = Long(inde
+0001b890: 783d 7b27 6469 6d31 273a 205b 2761 272c  x={'dim1': ['a',
+0001b8a0: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
+0001b8b0: 312c 2032 5d7d 2c20 7661 6c75 653d 5b32  1, 2]}, value=[2
+0001b8c0: 302c 2031 305d 290a 2020 2020 2020 2020  0, 10]).        
+0001b8d0: 2020 2020 3e3e 3e20 6172 7231 203d 2041      >>> arr1 = A
+0001b8e0: 7272 6179 2864 6174 613d 6c6f 6e67 312c  rray(data=long1,
+0001b8f0: 2063 6f6f 7264 733d 636f 6f72 6473 290a   coords=coords).
+0001b900: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0001b910: 6172 7232 203d 2041 7272 6179 2864 6174  arr2 = Array(dat
+0001b920: 613d 6c6f 6e67 322c 2063 6f6f 7264 733d  a=long2, coords=
+0001b930: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
+0001b940: 2020 2020 3e3e 3e20 6172 7231 203e 3d20      >>> arr1 >= 
+0001b950: 6172 7232 0a20 2020 2020 2020 2020 2020  arr2.           
+0001b960: 2041 7272 6179 2864 6174 613d 6172 7261   Array(data=arra
+0001b970: 7928 5b5b 4661 6c73 652c 2020 5472 7565  y([[False,  True
+0001b980: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0001b990: 2020 2020 2020 5b20 5472 7565 2c20 2054        [ True,  T
+0001b9a0: 7275 655d 5d29 2c20 636f 6f72 6473 3d7b  rue]]), coords={
+0001b9b0: 2764 696d 3127 3a20 6172 7261 7928 5b27  'dim1': array(['
+0001b9c0: 6127 2c20 2762 275d 2c20 6474 7970 653d  a', 'b'], dtype=
+0001b9d0: 6f62 6a65 6374 292c 2027 6469 6d32 273a  object), 'dim2':
+0001b9e0: 2061 7272 6179 285b 312c 2032 5d29 7d29   array([1, 2])})
+0001b9f0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+0001ba00: 2061 7272 3120 3e3d 2031 300a 2020 2020   arr1 >= 10.    
+0001ba10: 2020 2020 2020 2020 4172 7261 7928 6461          Array(da
+0001ba20: 7461 3d61 7272 6179 285b 5b20 5472 7565  ta=array([[ True
+0001ba30: 2c20 4661 6c73 655d 2c0a 2020 2020 2020  , False],.      
+0001ba40: 2020 2020 2020 2020 2020 2020 205b 4661               [Fa
+0001ba50: 6c73 652c 2020 5472 7565 5d5d 292c 2063  lse,  True]]), c
+0001ba60: 6f6f 7264 733d 7b27 6469 6d31 273a 2061  oords={'dim1': a
+0001ba70: 7272 6179 285b 2761 272c 2027 6227 5d2c  rray(['a', 'b'],
+0001ba80: 2064 7479 7065 3d6f 626a 6563 7429 2c20   dtype=object), 
+0001ba90: 2764 696d 3227 3a20 6172 7261 7928 5b31  'dim2': array([1
+0001baa0: 2c20 325d 297d 290a 0a20 2020 2020 2020  , 2])})..       
+0001bab0: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
+0001bac0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+0001bad0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
+0001bae0: 2c20 2869 6e74 2c20 666c 6f61 7429 293a  , (int, float)):
+0001baf0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+0001bb00: 203d 2073 656c 662e 6461 7461 203e 3d20   = self.data >= 
+0001bb10: 6f74 6865 720a 2020 2020 2020 2020 2020  other.          
+0001bb20: 2020 7265 7475 726e 2073 656c 662e 5f70    return self._p
+0001bb30: 6f73 745f 6f70 6572 6174 696f 6e28 6172  ost_operation(ar
+0001bb40: 722c 2073 656c 662e 636f 6f72 6473 290a  r, self.coords).
+0001bb50: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+0001bb60: 6e73 7461 6e63 6528 6f74 6865 722c 2041  nstance(other, A
+0001bb70: 7272 6179 293a 0a20 2020 2020 2020 2020  rray):.         
+0001bb80: 2020 2073 656c 665f 6172 722c 206f 7468     self_arr, oth
+0001bb90: 6572 5f61 7272 2c20 636f 6f72 6473 203d  er_arr, coords =
+0001bba0: 2073 656c 662e 5f70 7265 5f6f 7065 7261   self._pre_opera
+0001bbb0: 7469 6f6e 5f77 6974 685f 6172 7261 7928  tion_with_array(
+0001bbc0: 6f74 6865 7229 0a20 2020 2020 2020 2020  other).         
+0001bbd0: 2020 2061 7272 203d 2073 656c 665f 6172     arr = self_ar
+0001bbe0: 7220 3e3d 206f 7468 6572 5f61 7272 0a20  r >= other_arr. 
+0001bbf0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001bc00: 6e20 7365 6c66 2e5f 706f 7374 5f6f 7065  n self._post_ope
+0001bc10: 7261 7469 6f6e 2861 7272 2e54 2c20 636f  ration(arr.T, co
+0001bc20: 6f72 6473 290a 0a20 2020 2064 6566 205f  ords)..    def _
+0001bc30: 5f72 6765 5f5f 2873 656c 662c 206f 7468  _rge__(self, oth
+0001bc40: 6572 3a20 556e 696f 6e5b 696e 742c 2066  er: Union[int, f
+0001bc50: 6c6f 6174 5d29 202d 3e20 2741 7272 6179  loat]) -> 'Array
+0001bc60: 273a 0a20 2020 2020 2020 2022 2222 0a20  ':.        """. 
+0001bc70: 2020 2020 2020 2043 6865 636b 2069 6620         Check if 
+0001bc80: 6120 6e75 6d62 6572 2069 7320 6772 6561  a number is grea
+0001bc90: 7465 7220 7468 616e 206f 7220 6571 7561  ter than or equa
+0001bca0: 6c20 746f 2074 6865 2041 7272 6179 2028  l to the Array (
+0001bcb0: 7265 7665 7273 6520 6772 6561 7465 7220  reverse greater 
+0001bcc0: 7468 616e 206f 7220 6571 7561 6c20 746f  than or equal to
+0001bcd0: 292e 0a0a 2020 2020 2020 2020 4172 6773  )...        Args
+0001bce0: 3a0a 2020 2020 2020 2020 2020 2020 6f74  :.            ot
+0001bcf0: 6865 723a 2054 6865 206e 756d 6265 7220  her: The number 
+0001bd00: 746f 2063 6f6d 7061 7265 2e0a 0a20 2020  to compare...   
+0001bd10: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
+0001bd20: 2020 2020 2020 2020 2020 4120 6e65 7720            A new 
+0001bd30: 4172 7261 7920 6f62 6a65 6374 2077 6974  Array object wit
+0001bd40: 6820 626f 6f6c 6561 6e20 7661 6c75 6573  h boolean values
+0001bd50: 2069 6e64 6963 6174 696e 6720 6772 6561   indicating grea
+0001bd60: 7465 7220 7468 616e 206f 7220 6571 7561  ter than or equa
+0001bd70: 6c20 746f 2e0a 0a20 2020 2020 2020 2045  l to...        E
+0001bd80: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+0001bd90: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
+0001bda0: 2020 2020 2020 2020 2020 3e3e 3e20 636f            >>> co
+0001bdb0: 6f72 6473 203d 207b 2764 696d 3127 3a20  ords = {'dim1': 
+0001bdc0: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
+0001bdd0: 3227 3a20 5b31 2c20 325d 7d0a 2020 2020  2': [1, 2]}.    
+0001bde0: 2020 2020 2020 2020 3e3e 3e20 6c6f 6e67          >>> long
+0001bdf0: 203d 204c 6f6e 6728 696e 6465 783d 7b27   = Long(index={'
+0001be00: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
+0001be10: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
+0001be20: 5d7d 2c20 7661 6c75 653d 5b31 302c 2032  ]}, value=[10, 2
+0001be30: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
+0001be40: 3e3e 3e20 6172 7220 3d20 4172 7261 7928  >>> arr = Array(
+0001be50: 6461 7461 3d6c 6f6e 672c 2063 6f6f 7264  data=long, coord
+0001be60: 733d 636f 6f72 6473 290a 2020 2020 2020  s=coords).      
+0001be70: 2020 2020 2020 3e3e 3e20 3130 203e 3d20        >>> 10 >= 
+0001be80: 6172 720a 2020 2020 2020 2020 2020 2020  arr.            
+0001be90: 4172 7261 7928 6461 7461 3d61 7272 6179  Array(data=array
+0001bea0: 285b 5b20 5472 7565 2c20 2054 7275 655d  ([[ True,  True]
+0001beb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001bec0: 2020 2020 205b 2054 7275 652c 2046 616c       [ True, Fal
+0001bed0: 7365 5d5d 292c 2063 6f6f 7264 733d 7b27  se]]), coords={'
+0001bee0: 6469 6d31 273a 2061 7272 6179 285b 2761  dim1': array(['a
+0001bef0: 272c 2027 6227 5d2c 2064 7479 7065 3d6f  ', 'b'], dtype=o
+0001bf00: 626a 6563 7429 2c20 2764 696d 3227 3a20  bject), 'dim2': 
+0001bf10: 6172 7261 7928 5b31 2c20 325d 297d 290a  array([1, 2])}).
+0001bf20: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+0001bf30: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001bf40: 2020 2020 2061 7272 203d 206f 7468 6572       arr = other
+0001bf50: 203e 3d20 7365 6c66 2e64 6174 610a 2020   >= self.data.  
+0001bf60: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001bf70: 662e 5f70 6f73 745f 6f70 6572 6174 696f  f._post_operatio
+0001bf80: 6e28 6172 722c 2073 656c 662e 636f 6f72  n(arr, self.coor
+0001bf90: 6473 290a 0a20 2020 2064 6566 205f 5f61  ds)..    def __a
+0001bfa0: 6e64 5f5f 2873 656c 662c 206f 7468 6572  nd__(self, other
+0001bfb0: 3a20 556e 696f 6e5b 626f 6f6c 2c20 2741  : Union[bool, 'A
+0001bfc0: 7272 6179 275d 2920 2d3e 2027 4172 7261  rray']) -> 'Arra
+0001bfd0: 7927 3a0a 2020 2020 2020 2020 2222 220a  y':.        """.
+0001bfe0: 2020 2020 2020 2020 5065 7266 6f72 6d20          Perform 
+0001bff0: 656c 656d 656e 742d 7769 7365 206c 6f67  element-wise log
+0001c000: 6963 616c 2041 4e44 206f 7065 7261 7469  ical AND operati
+0001c010: 6f6e 2062 6574 7765 656e 2074 6865 2041  on between the A
+0001c020: 7272 6179 2061 6e64 2061 6e6f 7468 6572  rray and another
+0001c030: 2041 7272 6179 206f 7220 6120 626f 6f6c   Array or a bool
+0001c040: 6561 6e2e 0a0a 2020 2020 2020 2020 4172  ean...        Ar
+0001c050: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+0001c060: 6f74 6865 723a 2054 6865 206f 7468 6572  other: The other
+0001c070: 2041 7272 6179 206f 7220 626f 6f6c 6561   Array or boolea
+0001c080: 6e20 746f 2070 6572 666f 726d 2074 6865  n to perform the
+0001c090: 206f 7065 7261 7469 6f6e 2077 6974 682e   operation with.
+0001c0a0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0001c0b0: 733a 0a20 2020 2020 2020 2020 2020 2041  s:.            A
+0001c0c0: 206e 6577 2041 7272 6179 206f 626a 6563   new Array objec
+0001c0d0: 7420 7769 7468 2074 6865 2072 6573 756c  t with the resul
+0001c0e0: 7420 6f66 2074 6865 206c 6f67 6963 616c  t of the logical
+0001c0f0: 2041 4e44 206f 7065 7261 7469 6f6e 2e0a   AND operation..
+0001c100: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+0001c110: 3a0a 2020 2020 2020 2020 2020 2020 6060  :.            ``
+0001c120: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
+0001c130: 2020 2020 3e3e 3e20 636f 6f72 6473 203d      >>> coords =
+0001c140: 207b 2764 696d 3127 3a20 5b27 6127 2c20   {'dim1': ['a', 
+0001c150: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
+0001c160: 2c20 325d 7d0a 2020 2020 2020 2020 2020  , 2]}.          
+0001c170: 2020 3e3e 3e20 6c6f 6e67 3120 3d20 4c6f    >>> long1 = Lo
+0001c180: 6e67 2869 6e64 6578 3d7b 2764 696d 3127  ng(index={'dim1'
+0001c190: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+0001c1a0: 696d 3227 3a20 5b31 2c20 325d 7d2c 2076  im2': [1, 2]}, v
+0001c1b0: 616c 7565 3d5b 3130 2c20 3230 5d29 0a20  alue=[10, 20]). 
+0001c1c0: 2020 2020 2020 2020 2020 203e 3e3e 206c             >>> l
+0001c1d0: 6f6e 6732 203d 204c 6f6e 6728 696e 6465  ong2 = Long(inde
+0001c1e0: 783d 7b27 6469 6d31 273a 205b 2761 272c  x={'dim1': ['a',
+0001c1f0: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
+0001c200: 312c 2032 5d7d 2c20 7661 6c75 653d 5b32  1, 2]}, value=[2
+0001c210: 302c 2031 305d 290a 2020 2020 2020 2020  0, 10]).        
+0001c220: 2020 2020 3e3e 3e20 6172 7231 203d 2041      >>> arr1 = A
+0001c230: 7272 6179 2864 6174 613d 6c6f 6e67 312c  rray(data=long1,
+0001c240: 2063 6f6f 7264 733d 636f 6f72 6473 290a   coords=coords).
+0001c250: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0001c260: 6172 7232 203d 2041 7272 6179 2864 6174  arr2 = Array(dat
+0001c270: 613d 6c6f 6e67 322c 2063 6f6f 7264 733d  a=long2, coords=
+0001c280: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
+0001c290: 2020 2020 3e3e 3e20 6172 7231 2026 2061      >>> arr1 & a
+0001c2a0: 7272 320a 2020 2020 2020 2020 2020 2020  rr2.            
+0001c2b0: 4172 7261 7928 6461 7461 3d61 7272 6179  Array(data=array
+0001c2c0: 285b 5b30 2e2c 2030 2e5d 2c0a 2020 2020  ([[0., 0.],.    
+0001c2d0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0001c2e0: 302e 2c20 302e 5d5d 292c 2063 6f6f 7264  0., 0.]]), coord
+0001c2f0: 733d 7b27 6469 6d31 273a 2061 7272 6179  s={'dim1': array
+0001c300: 285b 2761 272c 2027 6227 5d2c 2064 7479  (['a', 'b'], dty
+0001c310: 7065 3d6f 626a 6563 7429 2c20 2764 696d  pe=object), 'dim
+0001c320: 3227 3a20 6172 7261 7928 5b31 2c20 325d  2': array([1, 2]
+0001c330: 297d 290a 2020 2020 2020 2020 2020 2020  )}).            
+0001c340: 3e3e 3e20 6172 7231 2026 2054 7275 650a  >>> arr1 & True.
+0001c350: 2020 2020 2020 2020 2020 2020 4172 7261              Arra
+0001c360: 7928 6461 7461 3d61 7272 6179 285b 5b30  y(data=array([[0
+0001c370: 2e2c 2030 2e5d 2c0a 2020 2020 2020 2020  ., 0.],.        
+0001c380: 2020 2020 2020 2020 2020 205b 302e 2c20             [0., 
+0001c390: 302e 5d5d 292c 2063 6f6f 7264 733d 7b27  0.]]), coords={'
+0001c3a0: 6469 6d31 273a 2061 7272 6179 285b 2761  dim1': array(['a
+0001c3b0: 272c 2027 6227 5d2c 2064 7479 7065 3d6f  ', 'b'], dtype=o
+0001c3c0: 626a 6563 7429 2c20 2764 696d 3227 3a20  bject), 'dim2': 
+0001c3d0: 6172 7261 7928 5b31 2c20 325d 297d 290a  array([1, 2])}).
+0001c3e0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+0001c3f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001c400: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0001c410: 6365 286f 7468 6572 2c20 2869 6e74 2c20  ce(other, (int, 
+0001c420: 666c 6f61 7429 293a 0a20 2020 2020 2020  float)):.       
+0001c430: 2020 2020 2061 7272 203d 2073 656c 662e       arr = self.
+0001c440: 6461 7461 2026 206f 7468 6572 0a20 2020  data & other.   
+0001c450: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001c460: 7365 6c66 2e5f 706f 7374 5f6f 7065 7261  self._post_opera
+0001c470: 7469 6f6e 2861 7272 2c20 7365 6c66 2e63  tion(arr, self.c
+0001c480: 6f6f 7264 7329 0a20 2020 2020 2020 2065  oords).        e
+0001c490: 6c69 6620 6973 696e 7374 616e 6365 286f  lif isinstance(o
+0001c4a0: 7468 6572 2c20 4172 7261 7929 3a0a 2020  ther, Array):.  
+0001c4b0: 2020 2020 2020 2020 2020 7365 6c66 5f61            self_a
+0001c4c0: 7272 2c20 6f74 6865 725f 6172 722c 2063  rr, other_arr, c
+0001c4d0: 6f6f 7264 7320 3d20 7365 6c66 2e5f 7072  oords = self._pr
+0001c4e0: 655f 6f70 6572 6174 696f 6e5f 7769 7468  e_operation_with
+0001c4f0: 5f61 7272 6179 286f 7468 6572 290a 2020  _array(other).  
+0001c500: 2020 2020 2020 2020 2020 6172 7220 3d20            arr = 
+0001c510: 7365 6c66 5f61 7272 2026 206f 7468 6572  self_arr & other
+0001c520: 5f61 7272 0a20 2020 2020 2020 2020 2020  _arr.           
+0001c530: 2072 6574 7572 6e20 7365 6c66 2e5f 706f   return self._po
+0001c540: 7374 5f6f 7065 7261 7469 6f6e 2861 7272  st_operation(arr
+0001c550: 2e54 2c20 636f 6f72 6473 290a 0a20 2020  .T, coords)..   
+0001c560: 2064 6566 205f 5f72 616e 645f 5f28 7365   def __rand__(se
+0001c570: 6c66 2c20 6f74 6865 723a 2062 6f6f 6c29  lf, other: bool)
+0001c580: 202d 3e20 2741 7272 6179 273a 0a20 2020   -> 'Array':.   
+0001c590: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001c5a0: 2050 6572 666f 726d 2065 6c65 6d65 6e74   Perform element
+0001c5b0: 2d77 6973 6520 6c6f 6769 6361 6c20 414e  -wise logical AN
+0001c5c0: 4420 6f70 6572 6174 696f 6e20 6265 7477  D operation betw
+0001c5d0: 6565 6e20 6120 626f 6f6c 6561 6e20 616e  een a boolean an
+0001c5e0: 6420 7468 6520 4172 7261 7920 2872 6576  d the Array (rev
+0001c5f0: 6572 7365 2041 4e44 292e 0a0a 2020 2020  erse AND)...    
+0001c600: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0001c610: 2020 2020 2020 6f74 6865 723a 2054 6865        other: The
+0001c620: 2062 6f6f 6c65 616e 2074 6f20 7065 7266   boolean to perf
+0001c630: 6f72 6d20 7468 6520 6f70 6572 6174 696f  orm the operatio
+0001c640: 6e20 7769 7468 2e0a 0a20 2020 2020 2020  n with...       
+0001c650: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+0001c660: 2020 2020 2020 4120 6e65 7720 4172 7261        A new Arra
+0001c670: 7920 6f62 6a65 6374 2077 6974 6820 7468  y object with th
+0001c680: 6520 7265 7375 6c74 206f 6620 7468 6520  e result of the 
+0001c690: 6c6f 6769 6361 6c20 414e 4420 6f70 6572  logical AND oper
+0001c6a0: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+0001c6b0: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+0001c6c0: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
+0001c6d0: 2020 2020 2020 2020 2020 203e 3e3e 206c             >>> l
+0001c6e0: 6f6e 6720 3d20 4c6f 6e67 2869 6e64 6578  ong = Long(index
+0001c6f0: 3d7b 2764 696d 3127 3a20 5b27 6127 2c20  ={'dim1': ['a', 
+0001c700: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
+0001c710: 2c20 325d 7d2c 2076 616c 7565 3d5b 3130  , 2]}, value=[10
+0001c720: 2c20 3230 5d29 0a20 2020 2020 2020 2020  , 20]).         
+0001c730: 2020 203e 3e3e 2061 7272 203d 2041 7272     >>> arr = Arr
+0001c740: 6179 2864 6174 613d 6c6f 6e67 290a 2020  ay(data=long).  
+0001c750: 2020 2020 2020 2020 2020 3e3e 3e20 5472            >>> Tr
+0001c760: 7565 2026 2061 7272 0a20 2020 2020 2020  ue & arr.       
+0001c770: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
+0001c780: 6172 7261 7928 5b5b 302e 2c20 302e 5d2c  array([[0., 0.],
+0001c790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c7a0: 2020 2020 5b30 2e2c 2030 2e5d 5d29 2c20      [0., 0.]]), 
+0001c7b0: 636f 6f72 6473 3d7b 2764 696d 3127 3a20  coords={'dim1': 
+0001c7c0: 6172 7261 7928 5b27 6127 2c20 2762 275d  array(['a', 'b']
+0001c7d0: 2c20 6474 7970 653d 6f62 6a65 6374 292c  , dtype=object),
+0001c7e0: 2027 6469 6d32 273a 2061 7272 6179 285b   'dim2': array([
+0001c7f0: 312c 2032 5d29 7d29 0a0a 2020 2020 2020  1, 2])})..      
+0001c800: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
+0001c810: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+0001c820: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
+0001c830: 722c 2062 6f6f 6c29 3a0a 2020 2020 2020  r, bool):.      
+0001c840: 2020 2020 2020 6172 7220 3d20 6f74 6865        arr = othe
+0001c850: 7220 2620 7365 6c66 2e64 6174 610a 2020  r & self.data.  
+0001c860: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001c870: 2073 656c 662e 5f70 6f73 745f 6f70 6572   self._post_oper
+0001c880: 6174 696f 6e28 6172 722c 2073 656c 662e  ation(arr, self.
+0001c890: 636f 6f72 6473 290a 0a20 2020 2064 6566  coords)..    def
+0001c8a0: 205f 5f6f 725f 5f28 7365 6c66 2c20 6f74   __or__(self, ot
+0001c8b0: 6865 723a 2055 6e69 6f6e 5b69 6e74 2c20  her: Union[int, 
+0001c8c0: 666c 6f61 742c 2027 4172 7261 7927 5d29  float, 'Array'])
+0001c8d0: 202d 3e20 2741 7272 6179 273a 0a20 2020   -> 'Array':.   
+0001c8e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001c8f0: 2050 6572 666f 726d 2065 6c65 6d65 6e74   Perform element
+0001c900: 2d77 6973 6520 6c6f 6769 6361 6c20 4f52  -wise logical OR
+0001c910: 206f 7065 7261 7469 6f6e 2062 6574 7765   operation betwe
+0001c920: 656e 2074 6865 2041 7272 6179 2061 6e64  en the Array and
+0001c930: 2061 6e6f 7468 6572 2041 7272 6179 206f   another Array o
+0001c940: 7220 6120 6e75 6d62 6572 2e0a 0a20 2020  r a number...   
+0001c950: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
+0001c960: 2020 2020 2020 206f 7468 6572 3a20 5468         other: Th
+0001c970: 6520 6f74 6865 7220 4172 7261 7920 6f72  e other Array or
+0001c980: 206e 756d 6265 7220 746f 2070 6572 666f   number to perfo
+0001c990: 726d 2074 6865 206f 7065 7261 7469 6f6e  rm the operation
+0001c9a0: 2077 6974 682e 0a0a 2020 2020 2020 2020   with...        
+0001c9b0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+0001c9c0: 2020 2020 2041 206e 6577 2041 7272 6179       A new Array
+0001c9d0: 206f 626a 6563 7420 7769 7468 2074 6865   object with the
+0001c9e0: 2072 6573 756c 7420 6f66 2074 6865 206c   result of the l
+0001c9f0: 6f67 6963 616c 204f 5220 6f70 6572 6174  ogical OR operat
+0001ca00: 696f 6e2e 0a0a 2020 2020 2020 2020 4578  ion...        Ex
+0001ca10: 616d 706c 653a 0a20 2020 2020 2020 2020  ample:.         
+0001ca20: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+0001ca30: 2020 2020 2020 2020 203e 3e3e 2063 6f6f           >>> coo
+0001ca40: 7264 7320 3d20 7b27 6469 6d31 273a 205b  rds = {'dim1': [
+0001ca50: 2761 272c 2027 6227 5d2c 2027 6469 6d32  'a', 'b'], 'dim2
+0001ca60: 273a 205b 312c 2032 5d7d 0a20 2020 2020  ': [1, 2]}.     
+0001ca70: 2020 2020 2020 203e 3e3e 206c 6f6e 6731         >>> long1
+0001ca80: 203d 204c 6f6e 6728 696e 6465 783d 7b27   = Long(index={'
+0001ca90: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
+0001caa0: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
+0001cab0: 5d7d 2c20 7661 6c75 653d 5b31 302c 2032  ]}, value=[10, 2
+0001cac0: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
+0001cad0: 3e3e 3e20 6c6f 6e67 3220 3d20 4c6f 6e67  >>> long2 = Long
+0001cae0: 2869 6e64 6578 3d7b 2764 696d 3127 3a20  (index={'dim1': 
+0001caf0: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
+0001cb00: 3227 3a20 5b31 2c20 325d 7d2c 2076 616c  2': [1, 2]}, val
+0001cb10: 7565 3d5b 3230 2c20 3130 5d29 0a20 2020  ue=[20, 10]).   
+0001cb20: 2020 2020 2020 2020 203e 3e3e 2061 7272           >>> arr
+0001cb30: 3120 3d20 4172 7261 7928 6461 7461 3d6c  1 = Array(data=l
+0001cb40: 6f6e 6731 2c20 636f 6f72 6473 3d63 6f6f  ong1, coords=coo
+0001cb50: 7264 7329 0a20 2020 2020 2020 2020 2020  rds).           
+0001cb60: 203e 3e3e 2061 7272 3220 3d20 4172 7261   >>> arr2 = Arra
+0001cb70: 7928 6461 7461 3d6c 6f6e 6732 2c20 636f  y(data=long2, co
+0001cb80: 6f72 6473 3d63 6f6f 7264 7329 0a20 2020  ords=coords).   
+0001cb90: 2020 2020 2020 2020 203e 3e3e 2061 7272           >>> arr
+0001cba0: 3120 7c20 6172 7232 0a20 2020 2020 2020  1 | arr2.       
+0001cbb0: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
+0001cbc0: 6172 7261 7928 5b5b 3330 2e2c 2020 302e  array([[30.,  0.
+0001cbd0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0001cbe0: 2020 2020 2020 5b20 302e 2c20 3330 2e5d        [ 0., 30.]
+0001cbf0: 5d29 2c20 636f 6f72 6473 3d7b 2764 696d  ]), coords={'dim
+0001cc00: 3127 3a20 6172 7261 7928 5b27 6127 2c20  1': array(['a', 
+0001cc10: 2762 275d 2c20 6474 7970 653d 6f62 6a65  'b'], dtype=obje
+0001cc20: 6374 292c 2027 6469 6d32 273a 2061 7272  ct), 'dim2': arr
+0001cc30: 6179 285b 312c 2032 5d29 7d29 0a20 2020  ay([1, 2])}).   
+0001cc40: 2020 2020 2020 2020 203e 3e3e 2061 7272           >>> arr
+0001cc50: 3120 7c20 300a 2020 2020 2020 2020 2020  1 | 0.          
+0001cc60: 2020 4172 7261 7928 6461 7461 3d61 7272    Array(data=arr
+0001cc70: 6179 285b 5b31 302e 2c20 2030 2e5d 2c0a  ay([[10.,  0.],.
+0001cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cc90: 2020 205b 2030 2e2c 2032 302e 5d5d 292c     [ 0., 20.]]),
+0001cca0: 2063 6f6f 7264 733d 7b27 6469 6d31 273a   coords={'dim1':
+0001ccb0: 2061 7272 6179 285b 2761 272c 2027 6227   array(['a', 'b'
+0001ccc0: 5d2c 2064 7479 7065 3d6f 626a 6563 7429  ], dtype=object)
+0001ccd0: 2c20 2764 696d 3227 3a20 6172 7261 7928  , 'dim2': array(
+0001cce0: 5b31 2c20 325d 297d 290a 0a20 2020 2020  [1, 2])})..     
+0001ccf0: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+0001cd00: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0001cd10: 6620 6973 696e 7374 616e 6365 286f 7468  f isinstance(oth
+0001cd20: 6572 2c20 2869 6e74 2c20 666c 6f61 7429  er, (int, float)
+0001cd30: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+0001cd40: 7272 203d 2073 656c 662e 6461 7461 207c  rr = self.data |
+0001cd50: 206f 7468 6572 0a20 2020 2020 2020 2020   other.         
+0001cd60: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0001cd70: 706f 7374 5f6f 7065 7261 7469 6f6e 2861  post_operation(a
+0001cd80: 7272 2c20 7365 6c66 2e63 6f6f 7264 7329  rr, self.coords)
+0001cd90: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
+0001cda0: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
+0001cdb0: 4172 7261 7929 3a0a 2020 2020 2020 2020  Array):.        
+0001cdc0: 2020 2020 7365 6c66 5f61 7272 2c20 6f74      self_arr, ot
+0001cdd0: 6865 725f 6172 722c 2063 6f6f 7264 7320  her_arr, coords 
+0001cde0: 3d20 7365 6c66 2e5f 7072 655f 6f70 6572  = self._pre_oper
+0001cdf0: 6174 696f 6e5f 7769 7468 5f61 7272 6179  ation_with_array
+0001ce00: 286f 7468 6572 290a 2020 2020 2020 2020  (other).        
+0001ce10: 2020 2020 6172 7220 3d20 7365 6c66 5f61      arr = self_a
+0001ce20: 7272 207c 206f 7468 6572 5f61 7272 0a20  rr | other_arr. 
+0001ce30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001ce40: 6e20 7365 6c66 2e5f 706f 7374 5f6f 7065  n self._post_ope
+0001ce50: 7261 7469 6f6e 2861 7272 2e54 2c20 636f  ration(arr.T, co
+0001ce60: 6f72 6473 290a 0a20 2020 2064 6566 205f  ords)..    def _
+0001ce70: 5f72 6f72 5f5f 2873 656c 662c 206f 7468  _ror__(self, oth
+0001ce80: 6572 3a20 626f 6f6c 2920 2d3e 2027 4172  er: bool) -> 'Ar
+0001ce90: 7261 7927 3a0a 2020 2020 2020 2020 2222  ray':.        ""
+0001cea0: 220a 2020 2020 2020 2020 5065 7266 6f72  ".        Perfor
+0001ceb0: 6d20 656c 656d 656e 742d 7769 7365 206c  m element-wise l
+0001cec0: 6f67 6963 616c 204f 5220 6f70 6572 6174  ogical OR operat
+0001ced0: 696f 6e20 6265 7477 6565 6e20 6120 626f  ion between a bo
+0001cee0: 6f6c 6561 6e20 616e 6420 7468 6520 4172  olean and the Ar
+0001cef0: 7261 7920 2872 6576 6572 7365 204f 5229  ray (reverse OR)
+0001cf00: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
+0001cf10: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+0001cf20: 6572 3a20 5468 6520 626f 6f6c 6561 6e20  er: The boolean 
+0001cf30: 746f 2070 6572 666f 726d 2074 6865 206f  to perform the o
+0001cf40: 7065 7261 7469 6f6e 2077 6974 682e 0a0a  peration with...
+0001cf50: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
+0001cf60: 0a20 2020 2020 2020 2020 2020 2041 206e  .            A n
+0001cf70: 6577 2041 7272 6179 206f 626a 6563 7420  ew Array object 
+0001cf80: 7769 7468 2074 6865 2072 6573 756c 7420  with the result 
+0001cf90: 6f66 2074 6865 206c 6f67 6963 616c 204f  of the logical O
+0001cfa0: 5220 6f70 6572 6174 696f 6e2e 0a0a 2020  R operation...  
+0001cfb0: 2020 2020 2020 4578 616d 706c 653a 0a20        Example:. 
+0001cfc0: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
+0001cfd0: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
+0001cfe0: 203e 3e3e 206c 6f6e 6720 3d20 4c6f 6e67   >>> long = Long
+0001cff0: 2869 6e64 6578 3d7b 2764 696d 3127 3a20  (index={'dim1': 
+0001d000: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
+0001d010: 3227 3a20 5b31 2c20 325d 7d2c 2076 616c  2': [1, 2]}, val
+0001d020: 7565 3d5b 3130 2c20 3230 5d29 0a20 2020  ue=[10, 20]).   
+0001d030: 2020 2020 2020 2020 203e 3e3e 2061 7272           >>> arr
+0001d040: 203d 2041 7272 6179 2864 6174 613d 6c6f   = Array(data=lo
+0001d050: 6e67 290a 2020 2020 2020 2020 2020 2020  ng).            
+0001d060: 3e3e 3e20 5472 7565 207c 2061 7272 0a20  >>> True | arr. 
+0001d070: 2020 2020 2020 2020 2020 2041 7272 6179             Array
+0001d080: 2864 6174 613d 6172 7261 7928 5b5b 3131  (data=array([[11
+0001d090: 2e2c 2020 312e 5d2c 0a20 2020 2020 2020  .,  1.],.       
+0001d0a0: 2020 2020 2020 2020 2020 2020 5b20 312e              [ 1.
+0001d0b0: 2c20 3231 2e5d 5d29 2c20 636f 6f72 6473  , 21.]]), coords
+0001d0c0: 3d7b 2764 696d 3127 3a20 6172 7261 7928  ={'dim1': array(
+0001d0d0: 5b27 6127 2c20 2762 275d 2c20 6474 7970  ['a', 'b'], dtyp
+0001d0e0: 653d 6f62 6a65 6374 292c 2027 6469 6d32  e=object), 'dim2
+0001d0f0: 273a 2061 7272 6179 285b 312c 2032 5d29  ': array([1, 2])
+0001d100: 7d29 0a0a 2020 2020 2020 2020 2020 2020  })..            
+0001d110: 6060 600a 2020 2020 2020 2020 2222 220a  ```.        """.
+0001d120: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0001d130: 7461 6e63 6528 6f74 6865 722c 2062 6f6f  tance(other, boo
+0001d140: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+0001d150: 6172 7220 3d20 6f74 6865 7220 7c20 7365  arr = other | se
+0001d160: 6c66 2e64 6174 610a 2020 2020 2020 2020  lf.data.        
+0001d170: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001d180: 5f70 6f73 745f 6f70 6572 6174 696f 6e28  _post_operation(
+0001d190: 6172 722c 2073 656c 662e 636f 6f72 6473  arr, self.coords
+0001d1a0: 290a 0a20 2020 2064 6566 205f 5f69 6e76  )..    def __inv
+0001d1b0: 6572 745f 5f28 7365 6c66 2920 2d3e 2027  ert__(self) -> '
+0001d1c0: 4172 7261 7927 3a0a 2020 2020 2020 2020  Array':.        
+0001d1d0: 2222 220a 2020 2020 2020 2020 5065 7266  """.        Perf
+0001d1e0: 6f72 6d20 656c 656d 656e 742d 7769 7365  orm element-wise
+0001d1f0: 206c 6f67 6963 616c 204e 4f54 206f 7065   logical NOT ope
+0001d200: 7261 7469 6f6e 206f 6e20 7468 6520 4172  ration on the Ar
+0001d210: 7261 792e 0a0a 2020 2020 2020 2020 5265  ray...        Re
+0001d220: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
+0001d230: 2020 2041 206e 6577 2041 7272 6179 206f     A new Array o
+0001d240: 626a 6563 7420 7769 7468 2074 6865 2072  bject with the r
+0001d250: 6573 756c 7420 6f66 2074 6865 206c 6f67  esult of the log
+0001d260: 6963 616c 204e 4f54 206f 7065 7261 7469  ical NOT operati
+0001d270: 6f6e 2e0a 0a20 2020 2020 2020 2045 7861  on...        Exa
+0001d280: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
+0001d290: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
+0001d2a0: 2020 2020 2020 2020 3e3e 3e20 636f 6f72          >>> coor
+0001d2b0: 6473 203d 207b 2764 696d 3127 3a20 5b27  ds = {'dim1': ['
+0001d2c0: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
+0001d2d0: 3a20 5b31 2c20 325d 7d0a 2020 2020 2020  : [1, 2]}.      
+0001d2e0: 2020 2020 2020 3e3e 3e20 6c6f 6e67 203d        >>> long =
+0001d2f0: 204c 6f6e 6728 696e 6465 783d 7b27 6469   Long(index={'di
+0001d300: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+0001d310: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+0001d320: 2c20 7661 6c75 653d 5b31 302c 2032 305d  , value=[10, 20]
+0001d330: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+0001d340: 3e20 6172 7220 3d20 4172 7261 7928 6461  > arr = Array(da
+0001d350: 7461 3d6c 6f6e 672c 2063 6f6f 7264 733d  ta=long, coords=
+0001d360: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
+0001d370: 2020 2020 3e3e 3e20 7e61 7272 0a20 2020      >>> ~arr.   
+0001d380: 2020 2020 2020 2020 2041 7272 6179 2864           Array(d
+0001d390: 6174 613d 6172 7261 7928 5b5b 2d31 312e  ata=array([[-11.
+0001d3a0: 2c20 202d 312e 5d2c 0a20 2020 2020 2020  ,  -1.],.       
+0001d3b0: 2020 2020 2020 2020 2020 2020 5b20 2d31              [ -1
+0001d3c0: 2e2c 202d 3231 2e5d 5d29 2c20 636f 6f72  ., -21.]]), coor
+0001d3d0: 6473 3d7b 2764 696d 3127 3a20 6172 7261  ds={'dim1': arra
+0001d3e0: 7928 5b27 6127 2c20 2762 275d 2c20 6474  y(['a', 'b'], dt
+0001d3f0: 7970 653d 6f62 6a65 6374 292c 2027 6469  ype=object), 'di
+0001d400: 6d32 273a 2061 7272 6179 285b 312c 2032  m2': array([1, 2
+0001d410: 5d29 7d29 0a0a 2020 2020 2020 2020 2020  ])})..          
+0001d420: 2020 6060 600a 2020 2020 2020 2020 2222    ```.        ""
+0001d430: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0001d440: 2073 656c 662e 5f70 6f73 745f 6f70 6572   self._post_oper
+0001d450: 6174 696f 6e28 7e73 656c 662e 6461 7461  ation(~self.data
+0001d460: 2c20 636f 6f72 6473 3d73 656c 662e 636f  , coords=self.co
+0001d470: 6f72 6473 290a 0a20 2020 2064 6566 205f  ords)..    def _
+0001d480: 5f62 6f6f 6c5f 5f28 7365 6c66 2920 2d3e  _bool__(self) ->
+0001d490: 2062 6f6f 6c3a 0a20 2020 2020 2020 2022   bool:.        "
+0001d4a0: 2222 0a20 2020 2020 2020 2052 6169 7365  "".        Raise
+0001d4b0: 2061 2056 616c 7565 4572 726f 7220 7768   a ValueError wh
+0001d4c0: 656e 2074 7279 696e 6720 746f 2063 6f6e  en trying to con
+0001d4d0: 7665 7274 2061 6e20 4172 7261 7920 746f  vert an Array to
+0001d4e0: 2061 2062 6f6f 6c65 616e 2e20 5573 6566   a boolean. Usef
+0001d4f0: 756c 2074 6f20 7761 726e 2074 6865 2075  ul to warn the u
+0001d500: 7365 7220 746f 2069 6d70 6c65 6d65 6e74  ser to implement
+0001d510: 202e 616c 6c28 2920 6f72 202e 616e 7928   .all() or .any(
+0001d520: 2920 696e 7374 6561 6420 6f66 2062 6f6f  ) instead of boo
+0001d530: 6c28 6172 7261 7929 2e0a 0a20 2020 2020  l(array)...     
+0001d540: 2020 2052 6169 7365 733a 0a20 2020 2020     Raises:.     
+0001d550: 2020 2020 2020 2056 616c 7565 4572 726f         ValueErro
+0001d560: 723a 2043 616e 6e6f 7420 636f 6e76 6572  r: Cannot conver
+0001d570: 7420 616e 2041 7272 6179 2077 6974 6820  t an Array with 
+0001d580: 6d6f 7265 2074 6861 6e20 6f6e 6520 656c  more than one el
+0001d590: 656d 656e 7420 746f 2061 2062 6f6f 6c65  ement to a boole
+0001d5a0: 616e 2e0a 2020 2020 2020 2020 2222 220a  an..        """.
+0001d5b0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001d5c0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+0001d5d0: 2020 2020 2020 2254 6865 2074 7275 7468        "The truth
+0001d5e0: 2076 616c 7565 206f 6620 616e 2061 7272   value of an arr
+0001d5f0: 6179 2077 6974 6820 6d6f 7265 2074 6861  ay with more tha
+0001d600: 6e20 6f6e 6520 656c 656d 656e 7420 6973  n one element is
+0001d610: 2061 6d62 6967 756f 7573 2e20 5573 6520   ambiguous. Use 
+0001d620: 4172 7261 792e 616e 7928 2920 6f72 2041  Array.any() or A
+0001d630: 7272 6179 2e61 6c6c 2829 2229 0a0a 2020  rray.all()")..  
+0001d640: 2020 6465 6620 616e 7928 7365 6c66 2920    def any(self) 
+0001d650: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+0001d660: 2022 2222 0a20 2020 2020 2020 2043 6865   """.        Che
+0001d670: 636b 2069 6620 616e 7920 656c 656d 656e  ck if any elemen
+0001d680: 7420 696e 2074 6865 2041 7272 6179 2069  t in the Array i
+0001d690: 7320 5472 7565 2e0a 0a20 2020 2020 2020  s True...       
+0001d6a0: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+0001d6b0: 2020 2020 2020 5472 7565 2069 6620 616e        True if an
+0001d6c0: 7920 656c 656d 656e 7420 6973 2054 7275  y element is Tru
+0001d6d0: 652c 2046 616c 7365 206f 7468 6572 7769  e, False otherwi
+0001d6e0: 7365 2e0a 0a20 2020 2020 2020 2045 7861  se...        Exa
+0001d6f0: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
+0001d700: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
+0001d710: 2020 2020 2020 2020 3e3e 3e20 636f 6f72          >>> coor
+0001d720: 6473 203d 207b 2764 696d 3127 3a20 5b27  ds = {'dim1': ['
+0001d730: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
+0001d740: 3a20 5b31 2c20 325d 7d0a 2020 2020 2020  : [1, 2]}.      
+0001d750: 2020 2020 2020 3e3e 3e20 6c6f 6e67 203d        >>> long =
+0001d760: 204c 6f6e 6728 696e 6465 783d 7b27 6469   Long(index={'di
+0001d770: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+0001d780: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+0001d790: 2c20 7661 6c75 653d 5b31 302c 2032 305d  , value=[10, 20]
+0001d7a0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+0001d7b0: 3e20 6172 7220 3d20 4172 7261 7928 6461  > arr = Array(da
+0001d7c0: 7461 3d6c 6f6e 672c 2063 6f6f 7264 733d  ta=long, coords=
+0001d7d0: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
+0001d7e0: 2020 2020 3e3e 3e20 6172 722e 616e 7928      >>> arr.any(
+0001d7f0: 290a 2020 2020 2020 2020 2020 2020 5472  ).            Tr
+0001d800: 7565 0a0a 2020 2020 2020 2020 2020 2020  ue..            
+0001d810: 6060 600a 2020 2020 2020 2020 2222 220a  ```.        """.
+0001d820: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001d830: 656c 662e 6461 7461 2e61 6e79 2829 0a0a  elf.data.any()..
+0001d840: 2020 2020 6465 6620 616c 6c28 7365 6c66      def all(self
+0001d850: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
+0001d860: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+0001d870: 6865 636b 2069 6620 616c 6c20 656c 656d  heck if all elem
+0001d880: 656e 7473 2069 6e20 7468 6520 4172 7261  ents in the Arra
+0001d890: 7920 6172 6520 5472 7565 2e0a 0a20 2020  y are True...   
+0001d8a0: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
+0001d8b0: 2020 2020 2020 2020 2020 5472 7565 2069            True i
+0001d8c0: 6620 616c 6c20 656c 656d 656e 7473 2061  f all elements a
+0001d8d0: 7265 2054 7275 652c 2046 616c 7365 206f  re True, False o
+0001d8e0: 7468 6572 7769 7365 2e0a 0a20 2020 2020  therwise...     
+0001d8f0: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
+0001d900: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
+0001d910: 6e0a 2020 2020 2020 2020 2020 2020 3e3e  n.            >>
+0001d920: 3e20 636f 6f72 6473 203d 207b 2764 696d  > coords = {'dim
+0001d930: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
+0001d940: 2764 696d 3227 3a20 5b31 2c20 325d 7d0a  'dim2': [1, 2]}.
+0001d950: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0001d960: 6c6f 6e67 203d 204c 6f6e 6728 696e 6465  long = Long(inde
+0001d970: 783d 7b27 6469 6d31 273a 205b 2761 272c  x={'dim1': ['a',
+0001d980: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
+0001d990: 312c 2032 5d7d 2c20 7661 6c75 653d 5b31  1, 2]}, value=[1
+0001d9a0: 302c 2032 305d 290a 2020 2020 2020 2020  0, 20]).        
+0001d9b0: 2020 2020 3e3e 3e20 6172 7220 3d20 4172      >>> arr = Ar
+0001d9c0: 7261 7928 6461 7461 3d6c 6f6e 672c 2063  ray(data=long, c
+0001d9d0: 6f6f 7264 733d 636f 6f72 6473 290a 2020  oords=coords).  
+0001d9e0: 2020 2020 2020 2020 2020 3e3e 3e20 6172            >>> ar
+0001d9f0: 722e 616c 6c28 290a 2020 2020 2020 2020  r.all().        
+0001da00: 2020 2020 4661 6c73 650a 0a20 2020 2020      False..     
+0001da10: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+0001da20: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+0001da30: 6574 7572 6e20 7365 6c66 2e64 6174 612e  eturn self.data.
+0001da40: 616c 6c28 290a 0a20 2020 2064 6566 2074  all()..    def t
+0001da50: 6f5f 6469 6374 2873 656c 662c 2064 656e  o_dict(self, den
+0001da60: 7365 3a20 626f 6f6c 203d 2046 616c 7365  se: bool = False
+0001da70: 2920 2d3e 2044 6963 745b 7374 722c 206e  ) -> Dict[str, n
+0001da80: 702e 6e64 6172 7261 795d 3a0a 2020 2020  p.ndarray]:.    
+0001da90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001daa0: 436f 6e76 6572 7420 7468 6520 4172 7261  Convert the Arra
+0001dab0: 7920 746f 2061 2064 6963 7469 6f6e 6172  y to a dictionar
+0001dac0: 792e 0a0a 2020 2020 2020 2020 4172 6773  y...        Args
+0001dad0: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
+0001dae0: 6e73 653a 2057 6865 7468 6572 2074 6f20  nse: Whether to 
+0001daf0: 636f 6e76 6572 7420 7468 6520 6465 6e73  convert the dens
+0001db00: 6520 7265 7072 6573 656e 7461 7469 6f6e  e representation
+0001db10: 206f 6620 7468 6520 4172 7261 792e 0a0a   of the Array...
+0001db20: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
+0001db30: 0a20 2020 2020 2020 2020 2020 2041 2064  .            A d
+0001db40: 6963 7469 6f6e 6172 7920 7265 7072 6573  ictionary repres
+0001db50: 656e 7469 6e67 2074 6865 2041 7272 6179  enting the Array
+0001db60: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+0001db70: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+0001db80: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+0001db90: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
+0001dba0: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
+0001dbb0: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
+0001dbc0: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
+0001dbd0: 2020 2020 3e3e 3e20 6c6f 6e67 203d 204c      >>> long = L
+0001dbe0: 6f6e 6728 696e 6465 783d 7b27 6469 6d31  ong(index={'dim1
+0001dbf0: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+0001dc00: 6469 6d32 273a 205b 312c 2032 5d7d 2c20  dim2': [1, 2]}, 
+0001dc10: 7661 6c75 653d 5b31 302e 2c20 3230 2e5d  value=[10., 20.]
+0001dc20: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+0001dc30: 3e20 6172 7220 3d20 4172 7261 7928 6461  > arr = Array(da
+0001dc40: 7461 3d6c 6f6e 672c 2063 6f6f 7264 733d  ta=long, coords=
+0001dc50: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
+0001dc60: 2020 2020 3e3e 3e20 6172 722e 746f 5f64      >>> arr.to_d
+0001dc70: 6963 7428 6465 6e73 653d 5472 7565 290a  ict(dense=True).
+0001dc80: 2020 2020 2020 2020 2020 2020 7b27 6469              {'di
+0001dc90: 6d31 273a 2061 7272 6179 285b 2761 272c  m1': array(['a',
+0001dca0: 2027 6127 2c20 2762 272c 2027 6227 5d2c   'a', 'b', 'b'],
+0001dcb0: 2064 7479 7065 3d6f 626a 6563 7429 2c20   dtype=object), 
+0001dcc0: 2764 696d 3227 3a20 6172 7261 7928 5b31  'dim2': array([1
+0001dcd0: 2c20 322c 2031 2c20 325d 292c 2027 7661  , 2, 1, 2]), 'va
+0001dce0: 6c75 6527 3a20 6172 7261 7928 5b31 302e  lue': array([10.
+0001dcf0: 2c20 2030 2e2c 2020 302e 2c20 3230 2e5d  ,  0.,  0., 20.]
+0001dd00: 297d 0a0a 2020 2020 2020 2020 2020 2020  )}..            
+0001dd10: 6060 600a 2020 2020 2020 2020 2222 220a  ```.        """.
+0001dd20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001dd30: 6461 7461 5f74 7970 6520 3d3d 2027 6465  data_type == 'de
+0001dd40: 6e73 6527 3a0a 2020 2020 2020 2020 2020  nse':.          
+0001dd50: 2020 6966 2064 656e 7365 3a0a 2020 2020    if dense:.    
+0001dd60: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+0001dd70: 6520 3d20 7365 6c66 2e64 656e 7365 2e66  e = self.dense.f
+0001dd80: 6c61 7474 656e 2829 0a20 2020 2020 2020  latten().       
+0001dd90: 2020 2020 2020 2020 2061 7272 6179 5f64           array_d
+0001dda0: 6963 7420 3d20 6469 6374 2873 656c 662e  ict = dict(self.
+0001ddb0: 6469 6e64 6578 2829 290a 2020 2020 2020  dindex()).      
+0001ddc0: 2020 2020 2020 2020 2020 6172 7261 795f            array_
+0001ddd0: 6469 6374 5b27 7661 6c75 6527 5d20 3d20  dict['value'] = 
+0001dde0: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
+0001ddf0: 2020 2020 2020 7265 7475 726e 2061 7272        return arr
+0001de00: 6179 5f64 6963 740a 2020 2020 2020 2020  ay_dict.        
+0001de10: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001de20: 2020 2020 2020 2020 2020 7261 775f 7661            raw_va
+0001de30: 6c75 6520 3d20 7365 6c66 2e64 656e 7365  lue = self.dense
+0001de40: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
+0001de50: 2020 2020 2020 2020 2020 2066 696c 6c65             fille
+0001de60: 722c 2064 7479 7065 203d 2073 656c 662e  r, dtype = self.
+0001de70: 5f66 696c 6c65 725f 616e 645f 6474 7970  _filler_and_dtyp
+0001de80: 6528 7261 775f 7661 6c75 652c 2073 656c  e(raw_value, sel
+0001de90: 662e 6669 6c6c 5f76 616c 7565 290a 2020  f.fill_value).  
+0001dea0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+0001deb0: 6c75 6520 3d20 7261 775f 7661 6c75 652e  lue = raw_value.
+0001dec0: 6173 7479 7065 2864 7479 7065 290a 2020  astype(dtype).  
+0001ded0: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
+0001dee0: 6e5f 6d69 7373 696e 675f 6d61 736b 203d  n_missing_mask =
+0001def0: 2076 616c 7565 2021 3d20 6669 6c6c 6572   value != filler
+0001df00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001df10: 2061 7272 6179 5f64 6963 7420 3d20 7b64   array_dict = {d
+0001df20: 696d 3a20 696e 6465 785b 6e6f 6e5f 6d69  im: index[non_mi
+0001df30: 7373 696e 675f 6d61 736b 5d20 666f 7220  ssing_mask] for 
+0001df40: 6469 6d2c 2069 6e64 6578 2069 6e20 7365  dim, index in se
+0001df50: 6c66 2e64 696e 6465 7828 297d 0a20 2020  lf.dindex()}.   
+0001df60: 2020 2020 2020 2020 2020 2020 2061 7272               arr
+0001df70: 6179 5f64 6963 745b 2776 616c 7565 275d  ay_dict['value']
+0001df80: 203d 2076 616c 7565 5b6e 6f6e 5f6d 6973   = value[non_mis
+0001df90: 7369 6e67 5f6d 6173 6b5d 0a20 2020 2020  sing_mask].     
+0001dfa0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001dfb0: 6e20 6172 7261 795f 6469 6374 0a20 2020  n array_dict.   
+0001dfc0: 2020 2020 2065 6c69 6620 7365 6c66 2e64       elif self.d
+0001dfd0: 6174 615f 7479 7065 203d 3d20 2773 7061  ata_type == 'spa
+0001dfe0: 7273 6527 3a0a 2020 2020 2020 2020 2020  rse':.          
+0001dff0: 2020 6966 2064 656e 7365 3a0a 2020 2020    if dense:.    
+0001e000: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+0001e010: 6520 3d20 7365 6c66 2e74 6f64 656e 7365  e = self.todense
+0001e020: 2829 2e66 6c61 7474 656e 2829 0a20 2020  ().flatten().   
+0001e030: 2020 2020 2020 2020 2020 2020 2061 7272               arr
+0001e040: 6179 5f64 6963 7420 3d20 6469 6374 2873  ay_dict = dict(s
+0001e050: 656c 662e 6469 6e64 6578 2829 290a 2020  elf.dindex()).  
+0001e060: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+0001e070: 7261 795f 6469 6374 5b27 7661 6c75 6527  ray_dict['value'
+0001e080: 5d20 3d20 7661 6c75 650a 2020 2020 2020  ] = value.      
+0001e090: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001e0a0: 2061 7272 6179 5f64 6963 740a 2020 2020   array_dict.    
+0001e0b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001e0c0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+0001e0d0: 6c75 6520 3d20 7365 6c66 2e73 7061 7273  lue = self.spars
+0001e0e0: 652e 6461 7461 0a20 2020 2020 2020 2020  e.data.         
+0001e0f0: 2020 2020 2020 2061 7272 6179 5f64 6963         array_dic
+0001e100: 7420 3d20 6469 6374 2873 656c 662e 7369  t = dict(self.si
+0001e110: 6e64 6578 2829 290a 2020 2020 2020 2020  ndex()).        
+0001e120: 2020 2020 2020 2020 6172 7261 795f 6469          array_di
+0001e130: 6374 5b27 7661 6c75 6527 5d20 3d20 7661  ct['value'] = va
+0001e140: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
+0001e150: 2020 2020 7265 7475 726e 2061 7272 6179      return array
+0001e160: 5f64 6963 740a 0a20 2020 2064 6566 2074  _dict..    def t
+0001e170: 6f5f 7061 6e64 6173 2873 656c 662c 2064  o_pandas(self, d
+0001e180: 656e 7365 3a20 626f 6f6c 203d 204e 6f6e  ense: bool = Non
+0001e190: 6529 202d 3e20 2770 642e 4461 7461 4672  e) -> 'pd.DataFr
+0001e1a0: 616d 6527 3a0a 2020 2020 2020 2020 2222  ame':.        ""
+0001e1b0: 220a 2020 2020 2020 2020 436f 6e76 6572  ".        Conver
+0001e1c0: 7420 7468 6520 4172 7261 7920 746f 2061  t the Array to a
+0001e1d0: 2070 616e 6461 7320 4461 7461 4672 616d   pandas DataFram
+0001e1e0: 652e 0a0a 2020 2020 2020 2020 4172 6773  e...        Args
+0001e1f0: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
+0001e200: 6e73 653a 2057 6865 7468 6572 2074 6f20  nse: Whether to 
+0001e210: 636f 6e76 6572 7420 7468 6520 4172 7261  convert the Arra
+0001e220: 7920 746f 2061 2064 656e 7365 2044 6174  y to a dense Dat
+0001e230: 6146 7261 6d65 2e20 4966 204e 6f6e 652c  aFrame. If None,
+0001e240: 2075 7365 2074 6865 2064 6566 6175 6c74   use the default
+0001e250: 2073 6574 7469 6e67 2e0a 0a20 2020 2020   setting...     
+0001e260: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
+0001e270: 2020 2020 2020 2020 4120 7061 6e64 6173          A pandas
+0001e280: 2044 6174 6146 7261 6d65 2072 6570 7265   DataFrame repre
+0001e290: 7365 6e74 696e 6720 7468 6520 4172 7261  senting the Arra
+0001e2a0: 792e 0a0a 2020 2020 2020 2020 4578 616d  y...        Exam
+0001e2b0: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
+0001e2c0: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+0001e2d0: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
+0001e2e0: 7320 3d20 7b27 6469 6d31 273a 205b 2761  s = {'dim1': ['a
+0001e2f0: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
+0001e300: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
+0001e310: 2020 2020 203e 3e3e 206c 6f6e 6720 3d20       >>> long = 
+0001e320: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
+0001e330: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
+0001e340: 2764 696d 3227 3a20 5b31 2c20 325d 7d2c  'dim2': [1, 2]},
+0001e350: 2076 616c 7565 3d5b 3130 2c20 3230 5d29   value=[10, 20])
+0001e360: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+0001e370: 2061 7272 203d 2041 7272 6179 2864 6174   arr = Array(dat
+0001e380: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d63  a=long, coords=c
+0001e390: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
+0001e3a0: 2020 203e 3e3e 2064 6620 3d20 6172 722e     >>> df = arr.
+0001e3b0: 746f 5f70 616e 6461 7328 6465 6e73 653d  to_pandas(dense=
+0001e3c0: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
+0001e3d0: 2020 3e3e 3e20 6466 0a20 2020 2020 2020    >>> df.       
+0001e3e0: 2020 2020 2020 2064 696d 3120 2064 696d         dim1  dim
+0001e3f0: 3220 2076 616c 7565 0a20 2020 2020 2020  2  value.       
+0001e400: 2020 2020 2030 2020 2020 6120 2020 2020       0    a     
+0001e410: 3120 2020 2020 3130 0a20 2020 2020 2020  1     10.       
+0001e420: 2020 2020 2031 2020 2020 6120 2020 2020       1    a     
+0001e430: 3220 2020 2020 2030 0a20 2020 2020 2020  2      0.       
+0001e440: 2020 2020 2032 2020 2020 6220 2020 2020       2    b     
+0001e450: 3120 2020 2020 2030 0a20 2020 2020 2020  1      0.       
+0001e460: 2020 2020 2033 2020 2020 6220 2020 2020       3    b     
+0001e470: 3220 2020 2020 3230 0a0a 2020 2020 2020  2     20..      
+0001e480: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
+0001e490: 2020 2222 220a 2020 2020 2020 2020 6461    """.        da
+0001e4a0: 7461 6672 616d 655f 6173 5f64 656e 7365  taframe_as_dense
+0001e4b0: 203d 2054 7275 6520 6966 2073 656c 662e   = True if self.
+0001e4c0: 6461 7461 6672 616d 655f 6173 203d 3d20  dataframe_as == 
+0001e4d0: 2264 656e 7365 2220 656c 7365 2046 616c  "dense" else Fal
+0001e4e0: 7365 0a20 2020 2020 2020 2073 7061 7273  se.        spars
+0001e4f0: 655f 746f 5f64 656e 7365 203d 2064 6174  e_to_dense = dat
+0001e500: 6166 7261 6d65 5f61 735f 6465 6e73 6520  aframe_as_dense 
+0001e510: 6966 2064 656e 7365 2069 7320 4e6f 6e65  if dense is None
+0001e520: 2065 6c73 6520 6465 6e73 650a 2020 2020   else dense.    
+0001e530: 2020 2020 7265 7475 726e 2070 642e 4461      return pd.Da
+0001e540: 7461 4672 616d 6528 7365 6c66 2e74 6f5f  taFrame(self.to_
+0001e550: 6469 6374 2864 656e 7365 3d73 7061 7273  dict(dense=spars
+0001e560: 655f 746f 5f64 656e 7365 2929 0a0a 2020  e_to_dense))..  
+0001e570: 2020 6465 6620 746f 5f70 6f6c 6172 7328    def to_polars(
+0001e580: 7365 6c66 2c20 6465 6e73 653a 2062 6f6f  self, dense: boo
+0001e590: 6c20 3d20 4e6f 6e65 2920 2d3e 2027 706c  l = None) -> 'pl
+0001e5a0: 2e44 6174 6146 7261 6d65 273a 0a20 2020  .DataFrame':.   
+0001e5b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001e5c0: 2043 6f6e 7665 7274 2074 6865 2041 7272   Convert the Arr
+0001e5d0: 6179 2074 6f20 6120 706f 6c61 7273 2044  ay to a polars D
+0001e5e0: 6174 6146 7261 6d65 2e0a 0a20 2020 2020  ataFrame...     
+0001e5f0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+0001e600: 2020 2020 2064 656e 7365 3a20 5768 6574       dense: Whet
+0001e610: 6865 7220 746f 2063 6f6e 7665 7274 2074  her to convert t
+0001e620: 6865 2041 7272 6179 2074 6f20 6120 6465  he Array to a de
+0001e630: 6e73 6520 4461 7461 4672 616d 652e 2049  nse DataFrame. I
+0001e640: 6620 4e6f 6e65 2c20 7573 6520 7468 6520  f None, use the 
+0001e650: 6465 6661 756c 7420 7365 7474 696e 672e  default setting.
+0001e660: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0001e670: 733a 0a20 2020 2020 2020 2020 2020 2041  s:.            A
+0001e680: 2070 6f6c 6172 7320 4461 7461 4672 616d   polars DataFram
+0001e690: 6520 7265 7072 6573 656e 7469 6e67 2074  e representing t
+0001e6a0: 6865 2041 7272 6179 2e0a 0a20 2020 2020  he Array...     
+0001e6b0: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
+0001e6c0: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
+0001e6d0: 6e0a 2020 2020 2020 2020 2020 2020 3e3e  n.            >>
+0001e6e0: 3e20 636f 6f72 6473 203d 207b 2764 696d  > coords = {'dim
+0001e6f0: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
+0001e700: 2764 696d 3227 3a20 5b31 2c20 325d 7d0a  'dim2': [1, 2]}.
+0001e710: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0001e720: 6c6f 6e67 203d 204c 6f6e 6728 696e 6465  long = Long(inde
+0001e730: 783d 7b27 6469 6d31 273a 205b 2761 272c  x={'dim1': ['a',
+0001e740: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
+0001e750: 312c 2032 5d7d 2c20 7661 6c75 653d 5b31  1, 2]}, value=[1
+0001e760: 302c 2032 305d 290a 2020 2020 2020 2020  0, 20]).        
+0001e770: 2020 2020 3e3e 3e20 6172 7220 3d20 4172      >>> arr = Ar
+0001e780: 7261 7928 6461 7461 3d6c 6f6e 672c 2063  ray(data=long, c
+0001e790: 6f6f 7264 733d 636f 6f72 6473 290a 2020  oords=coords).  
+0001e7a0: 2020 2020 2020 2020 2020 3e3e 3e20 6466            >>> df
+0001e7b0: 203d 2061 7272 2e74 6f5f 706f 6c61 7273   = arr.to_polars
+0001e7c0: 2864 656e 7365 3d46 616c 7365 290a 2020  (dense=False).  
+0001e7d0: 2020 2020 2020 2020 2020 3e3e 3e20 6466            >>> df
+0001e7e0: 0a20 2020 2020 2020 2020 2020 2073 6861  .            sha
+0001e7f0: 7065 3a20 2832 2c20 3329 0a20 2020 2020  pe: (2, 3).     
+0001e800: 2020 2020 2020 20e2 948c e294 80e2 9480         .........
+0001e810: e294 80e2 9480 e294 80e2 9480 e294 ace2  ................
+0001e820: 9480 e294 80e2 9480 e294 80e2 9480 e294  ................
+0001e830: 80e2 94ac e294 80e2 9480 e294 80e2 9480  ................
+0001e840: e294 80e2 9480 e294 80e2 9490 0a20 2020  .............   
+0001e850: 2020 2020 2020 2020 20e2 9482 2064 696d           ... dim
+0001e860: 3120 e294 8620 6469 6d32 20e2 9486 2076  1 ... dim2 ... v
+0001e870: 616c 7565 20e2 9482 0a20 2020 2020 2020  alue ....       
+0001e880: 2020 2020 20e2 9482 202d 2d2d 2020 e294       ... ---  ..
+0001e890: 8620 2d2d 2d20 20e2 9486 202d 2d2d 2020  . ---  ... ---  
+0001e8a0: 20e2 9482 0a20 2020 2020 2020 2020 2020   ....           
+0001e8b0: 20e2 9482 2073 7472 2020 e294 8620 6933   ... str  ... i3
+0001e8c0: 3220 20e2 9486 2069 3634 2020 20e2 9482  2  ... i64   ...
+0001e8d0: 0a20 2020 2020 2020 2020 2020 20e2 959e  .            ...
+0001e8e0: e295 90e2 9590 e295 90e2 9590 e295 90e2  ................
+0001e8f0: 9590 e295 aae2 9590 e295 90e2 9590 e295  ................
+0001e900: 90e2 9590 e295 90e2 95aa e295 90e2 9590  ................
+0001e910: e295 90e2 9590 e295 90e2 9590 e295 90e2  ................
+0001e920: 95a1 0a20 2020 2020 2020 2020 2020 20e2  ...            .
+0001e930: 9482 2061 2020 2020 e294 8620 3120 2020  .. a    ... 1   
+0001e940: 20e2 9486 2031 3020 2020 20e2 9482 0a20   ... 10    .... 
+0001e950: 2020 2020 2020 2020 2020 20e2 9482 2062             ... b
+0001e960: 2020 2020 e294 8620 3220 2020 20e2 9486      ... 2    ...
+0001e970: 2032 3020 2020 20e2 9482 0a20 2020 2020   20    ....     
+0001e980: 2020 2020 2020 20e2 9494 e294 80e2 9480         .........
+0001e990: e294 80e2 9480 e294 80e2 9480 e294 b4e2  ................
+0001e9a0: 9480 e294 80e2 9480 e294 80e2 9480 e294  ................
+0001e9b0: 80e2 94b4 e294 80e2 9480 e294 80e2 9480  ................
+0001e9c0: e294 80e2 9480 e294 80e2 9498 0a0a 2020  ..............  
+0001e9d0: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
+0001e9e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001e9f0: 2020 6461 7461 6672 616d 655f 6173 5f64    dataframe_as_d
+0001ea00: 656e 7365 203d 2054 7275 6520 6966 2073  ense = True if s
+0001ea10: 656c 662e 6461 7461 6672 616d 655f 6173  elf.dataframe_as
+0001ea20: 203d 3d20 2264 656e 7365 2220 656c 7365   == "dense" else
+0001ea30: 2046 616c 7365 0a20 2020 2020 2020 2073   False.        s
+0001ea40: 7061 7273 655f 746f 5f64 656e 7365 203d  parse_to_dense =
+0001ea50: 2064 6174 6166 7261 6d65 5f61 735f 6465   dataframe_as_de
+0001ea60: 6e73 6520 6966 2064 656e 7365 2069 7320  nse if dense is 
+0001ea70: 4e6f 6e65 2065 6c73 6520 6465 6e73 650a  None else dense.
+0001ea80: 2020 2020 2020 2020 7265 7475 726e 2070          return p
+0001ea90: 6c2e 6672 6f6d 5f64 6963 7428 7365 6c66  l.from_dict(self
+0001eaa0: 2e74 6f5f 6469 6374 2864 656e 7365 3d73  .to_dict(dense=s
+0001eab0: 7061 7273 655f 746f 5f64 656e 7365 2929  parse_to_dense))
+0001eac0: 0a0a 2020 2020 6465 6620 746f 5f64 6174  ..    def to_dat
+0001ead0: 6166 7261 6d65 2873 656c 662c 2064 656e  aframe(self, den
+0001eae0: 7365 3a20 626f 6f6c 203d 204e 6f6e 652c  se: bool = None,
+0001eaf0: 2077 6974 685f 3a20 7374 7220 3d20 2770   with_: str = 'p
+0001eb00: 616e 6461 7327 2920 2d3e 2055 6e69 6f6e  andas') -> Union
+0001eb10: 5b27 7064 2e44 6174 6146 7261 6d65 272c  ['pd.DataFrame',
+0001eb20: 2027 706c 2e44 6174 6146 7261 6d65 275d   'pl.DataFrame']
+0001eb30: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001eb40: 2020 2020 2020 436f 6e76 6572 7420 7468        Convert th
+0001eb50: 6520 4172 7261 7920 746f 2061 2044 6174  e Array to a Dat
+0001eb60: 6146 7261 6d65 2075 7369 6e67 2074 6865  aFrame using the
+0001eb70: 2073 7065 6369 6669 6564 206c 6962 7261   specified libra
+0001eb80: 7279 2e0a 0a20 2020 2020 2020 2041 7267  ry...        Arg
+0001eb90: 733a 0a20 2020 2020 2020 2020 2020 2064  s:.            d
+0001eba0: 656e 7365 3a20 5768 6574 6865 7220 746f  ense: Whether to
+0001ebb0: 2063 6f6e 7665 7274 2074 6865 2041 7272   convert the Arr
+0001ebc0: 6179 2074 6f20 6120 6465 6e73 6520 4461  ay to a dense Da
+0001ebd0: 7461 4672 616d 652e 2049 6620 4e6f 6e65  taFrame. If None
+0001ebe0: 2c20 7573 6520 7468 6520 6465 6661 756c  , use the defaul
+0001ebf0: 7420 7365 7474 696e 672e 0a20 2020 2020  t setting..     
+0001ec00: 2020 2020 2020 2077 6974 685f 3a20 5468         with_: Th
+0001ec10: 6520 6c69 6272 6172 7920 746f 2075 7365  e library to use
+0001ec20: 2066 6f72 2063 7265 6174 696e 6720 7468   for creating th
+0001ec30: 6520 4461 7461 4672 616d 652e 2043 616e  e DataFrame. Can
+0001ec40: 2062 6520 2770 616e 6461 7327 206f 7220   be 'pandas' or 
+0001ec50: 2770 6f6c 6172 7327 2e0a 0a20 2020 2020  'polars'...     
+0001ec60: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
+0001ec70: 2020 2020 2020 2020 4120 4461 7461 4672          A DataFr
+0001ec80: 616d 6520 7265 7072 6573 656e 7469 6e67  ame representing
+0001ec90: 2074 6865 2041 7272 6179 2c20 6372 6561   the Array, crea
+0001eca0: 7465 6420 7573 696e 6720 7468 6520 7370  ted using the sp
+0001ecb0: 6563 6966 6965 6420 6c69 6272 6172 792e  ecified library.
+0001ecc0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+0001ecd0: 653a 0a20 2020 2020 2020 2020 2020 2060  e:.            `
+0001ece0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
+0001ecf0: 2020 2020 203e 3e3e 2063 6f6f 7264 7320       >>> coords 
+0001ed00: 3d20 7b27 6469 6d31 273a 205b 2761 272c  = {'dim1': ['a',
+0001ed10: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
+0001ed20: 312c 2032 5d7d 0a20 2020 2020 2020 2020  1, 2]}.         
+0001ed30: 2020 203e 3e3e 206c 6f6e 6720 3d20 4c6f     >>> long = Lo
+0001ed40: 6e67 2869 6e64 6578 3d7b 2764 696d 3127  ng(index={'dim1'
+0001ed50: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+0001ed60: 696d 3227 3a20 5b31 2c20 325d 7d2c 2076  im2': [1, 2]}, v
+0001ed70: 616c 7565 3d5b 3130 2c20 3230 5d29 0a20  alue=[10, 20]). 
+0001ed80: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
+0001ed90: 7272 203d 2041 7272 6179 2864 6174 613d  rr = Array(data=
+0001eda0: 6c6f 6e67 2c20 636f 6f72 6473 3d63 6f6f  long, coords=coo
+0001edb0: 7264 7329 0a20 2020 2020 2020 2020 2020  rds).           
+0001edc0: 203e 3e3e 2064 6620 3d20 6172 722e 746f   >>> df = arr.to
+0001edd0: 5f64 6174 6166 7261 6d65 2864 656e 7365  _dataframe(dense
+0001ede0: 3d46 616c 7365 2c20 7769 7468 5f3d 2770  =False, with_='p
+0001edf0: 616e 6461 7327 290a 2020 2020 2020 2020  andas').        
+0001ee00: 2020 2020 3e3e 3e20 6466 0a20 2020 2020      >>> df.     
+0001ee10: 2020 2020 2020 2020 2064 696d 3120 2064           dim1  d
+0001ee20: 696d 3220 2076 616c 7565 0a20 2020 2020  im2  value.     
+0001ee30: 2020 2020 2020 2030 2020 2020 6120 2020         0    a   
+0001ee40: 2020 3120 2020 2020 3130 0a20 2020 2020    1     10.     
+0001ee50: 2020 2020 2020 2031 2020 2020 6220 2020         1    b   
+0001ee60: 2020 3220 2020 2020 3230 0a0a 2020 2020    2     20..    
+0001ee70: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+0001ee80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001ee90: 6173 7365 7274 2077 6974 685f 2069 6e20  assert with_ in 
+0001eea0: 5b27 7061 6e64 6173 272c 2027 706f 6c61  ['pandas', 'pola
+0001eeb0: 7273 275d 0a20 2020 2020 2020 2069 6620  rs'].        if 
+0001eec0: 7769 7468 5f20 3d3d 2022 7061 6e64 6173  with_ == "pandas
+0001eed0: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
+0001eee0: 6574 7572 6e20 7365 6c66 2e74 6f5f 7061  eturn self.to_pa
+0001eef0: 6e64 6173 2864 656e 7365 3d64 656e 7365  ndas(dense=dense
+0001ef00: 290a 2020 2020 2020 2020 656c 6966 2077  ).        elif w
+0001ef10: 6974 685f 203d 3d20 2270 6f6c 6172 7322  ith_ == "polars"
+0001ef20: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0001ef30: 7475 726e 2073 656c 662e 746f 5f70 6f6c  turn self.to_pol
+0001ef40: 6172 7328 6465 6e73 653d 6465 6e73 6529  ars(dense=dense)
+0001ef50: 0a0a 2020 2020 6465 6620 746f 5f61 7272  ..    def to_arr
+0001ef60: 6f77 2873 656c 6629 202d 3e20 2770 612e  ow(self) -> 'pa.
+0001ef70: 5461 626c 6527 3a0a 2020 2020 2020 2020  Table':.        
+0001ef80: 2222 220a 2020 2020 2020 2020 436f 6e76  """.        Conv
+0001ef90: 6572 7420 7468 6520 4172 7261 7920 746f  ert the Array to
+0001efa0: 2061 6e20 4170 6163 6865 2041 7272 6f77   an Apache Arrow
+0001efb0: 2054 6162 6c65 2e0a 0a20 2020 2020 2020   Table...       
+0001efc0: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+0001efd0: 2020 2020 2020 416e 2041 7061 6368 6520        An Apache 
+0001efe0: 4172 726f 7720 5461 626c 6520 7265 7072  Arrow Table repr
+0001eff0: 6573 656e 7469 6e67 2074 6865 2041 7272  esenting the Arr
+0001f000: 6179 2e0a 0a20 2020 2020 2020 2045 7861  ay...        Exa
+0001f010: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
+0001f020: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
+0001f030: 2020 2020 2020 2020 3e3e 3e20 636f 6f72          >>> coor
+0001f040: 6473 203d 207b 2764 696d 3127 3a20 5b27  ds = {'dim1': ['
+0001f050: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
+0001f060: 3a20 5b31 2c20 325d 7d0a 2020 2020 2020  : [1, 2]}.      
+0001f070: 2020 2020 2020 3e3e 3e20 6c6f 6e67 203d        >>> long =
+0001f080: 204c 6f6e 6728 696e 6465 783d 7b27 6469   Long(index={'di
+0001f090: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+0001f0a0: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+0001f0b0: 2c20 7661 6c75 653d 5b31 302c 2032 305d  , value=[10, 20]
+0001f0c0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+0001f0d0: 3e20 6172 7220 3d20 4172 7261 7928 6461  > arr = Array(da
+0001f0e0: 7461 3d6c 6f6e 672c 2063 6f6f 7264 733d  ta=long, coords=
+0001f0f0: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
+0001f100: 2020 2020 3e3e 3e20 7461 626c 6520 3d20      >>> table = 
+0001f110: 6172 722e 746f 5f61 7272 6f77 2829 0a20  arr.to_arrow(). 
+0001f120: 2020 2020 2020 2020 2020 203e 3e3e 2074             >>> t
+0001f130: 6162 6c65 0a20 2020 2020 2020 2020 2020  able.           
+0001f140: 2070 7961 7272 6f77 2e54 6162 6c65 0a20   pyarrow.Table. 
+0001f150: 2020 2020 2020 2020 2020 2064 696d 313a             dim1:
+0001f160: 2073 7472 696e 670a 2020 2020 2020 2020   string.        
+0001f170: 2020 2020 6469 6d32 3a20 696e 7433 320a      dim2: int32.
+0001f180: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+0001f190: 653a 2069 6e74 3634 0a20 2020 2020 2020  e: int64.       
+0001f1a0: 2020 2020 202d 2d2d 2d0a 2020 2020 2020       ----.      
+0001f1b0: 2020 2020 2020 6469 6d31 3a20 5b5b 2261        dim1: [["a
+0001f1c0: 222c 2262 225d 5d0a 2020 2020 2020 2020  ","b"]].        
+0001f1d0: 2020 2020 6469 6d32 3a20 5b5b 312c 325d      dim2: [[1,2]
+0001f1e0: 5d0a 2020 2020 2020 2020 2020 2020 7661  ].            va
+0001f1f0: 6c75 653a 205b 5b31 302c 3230 5d5d 0a0a  lue: [[10,20]]..
+0001f200: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
+0001f210: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001f220: 2020 2020 7461 626c 6520 3d20 7061 2e54      table = pa.T
+0001f230: 6162 6c65 2e66 726f 6d5f 7079 6469 6374  able.from_pydict
+0001f240: 2873 656c 662e 746f 5f64 6963 7428 2929  (self.to_dict())
+0001f250: 0a20 2020 2020 2020 2063 7573 746f 6d5f  .        custom_
+0001f260: 6d65 7461 5f6b 6579 203d 2027 6b61 7272  meta_key = 'karr
+0001f270: 6179 270a 2020 2020 2020 2020 6375 7374  ay'.        cust
+0001f280: 6f6d 5f6d 6574 6164 6174 6120 3d20 7b27  om_metadata = {'
+0001f290: 636f 6f72 6473 273a 207b 6469 6d3a 2073  coords': {dim: s
+0001f2a0: 656c 662e 636f 6f72 6473 5b64 696d 5d2e  elf.coords[dim].
+0001f2b0: 746f 6c69 7374 2829 2066 6f72 2064 696d  tolist() for dim
+0001f2c0: 2069 6e20 7365 6c66 2e63 6f6f 7264 737d   in self.coords}
+0001f2d0: 7d0a 2020 2020 2020 2020 6375 7374 6f6d  }.        custom
+0001f2e0: 5f6d 6574 615f 6a73 6f6e 203d 206a 736f  _meta_json = jso
+0001f2f0: 6e2e 6475 6d70 7328 6375 7374 6f6d 5f6d  n.dumps(custom_m
+0001f300: 6574 6164 6174 6129 0a20 2020 2020 2020  etadata).       
+0001f310: 2065 7869 7374 696e 675f 6d65 7461 203d   existing_meta =
+0001f320: 2074 6162 6c65 2e73 6368 656d 612e 6d65   table.schema.me
+0001f330: 7461 6461 7461 2069 6620 7461 626c 652e  tadata if table.
+0001f340: 7363 6865 6d61 2e6d 6574 6164 6174 6120  schema.metadata 
+0001f350: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
+0001f360: 207b 7d0a 2020 2020 2020 2020 636f 6d62   {}.        comb
+0001f370: 696e 6564 5f6d 6574 6120 3d20 7b63 7573  ined_meta = {cus
+0001f380: 746f 6d5f 6d65 7461 5f6b 6579 2e65 6e63  tom_meta_key.enc
+0001f390: 6f64 6528 293a 2063 7573 746f 6d5f 6d65  ode(): custom_me
+0001f3a0: 7461 5f6a 736f 6e2e 656e 636f 6465 2829  ta_json.encode()
+0001f3b0: 2c20 2a2a 6578 6973 7469 6e67 5f6d 6574  , **existing_met
+0001f3c0: 617d 0a20 2020 2020 2020 2072 6574 7572  a}.        retur
+0001f3d0: 6e20 7461 626c 652e 7265 706c 6163 655f  n table.replace_
+0001f3e0: 7363 6865 6d61 5f6d 6574 6164 6174 6128  schema_metadata(
+0001f3f0: 636f 6d62 696e 6564 5f6d 6574 6129 0a0a  combined_meta)..
+0001f400: 2020 2020 6465 6620 746f 5f66 6561 7468      def to_feath
+0001f410: 6572 2873 656c 662c 2070 6174 683a 2073  er(self, path: s
+0001f420: 7472 2920 2d3e 204e 6f6e 653a 0a20 2020  tr) -> None:.   
+0001f430: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001f440: 2053 6176 6520 7468 6520 4172 7261 7920   Save the Array 
+0001f450: 746f 2061 2046 6561 7468 6572 2066 696c  to a Feather fil
+0001f460: 652e 0a0a 2020 2020 2020 2020 4172 6773  e...        Args
+0001f470: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
+0001f480: 7468 3a20 5468 6520 7061 7468 2074 6f20  th: The path to 
+0001f490: 7361 7665 2074 6865 2046 6561 7468 6572  save the Feather
+0001f4a0: 2066 696c 652e 0a0a 2020 2020 2020 2020   file...        
+0001f4b0: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+0001f4c0: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
+0001f4d0: 2020 2020 2020 2020 2020 203e 3e3e 2063             >>> c
+0001f4e0: 6f6f 7264 7320 3d20 7b27 6469 6d31 273a  oords = {'dim1':
+0001f4f0: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
+0001f500: 6d32 273a 205b 312c 2032 5d7d 0a20 2020  m2': [1, 2]}.   
+0001f510: 2020 2020 2020 2020 203e 3e3e 206c 6f6e           >>> lon
+0001f520: 6720 3d20 4c6f 6e67 2869 6e64 6578 3d7b  g = Long(index={
+0001f530: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
+0001f540: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
+0001f550: 325d 7d2c 2076 616c 7565 3d5b 3130 2c20  2]}, value=[10, 
+0001f560: 3230 5d29 0a20 2020 2020 2020 2020 2020  20]).           
+0001f570: 203e 3e3e 2061 7272 203d 2041 7272 6179   >>> arr = Array
+0001f580: 2864 6174 613d 6c6f 6e67 2c20 636f 6f72  (data=long, coor
+0001f590: 6473 3d63 6f6f 7264 7329 0a20 2020 2020  ds=coords).     
+0001f5a0: 2020 2020 2020 203e 3e3e 2061 7272 2e74         >>> arr.t
+0001f5b0: 6f5f 6665 6174 6865 7228 2774 6573 7473  o_feather('tests
+0001f5c0: 2f64 6174 612f 6172 7261 792e 6665 6174  /data/array.feat
+0001f5d0: 6865 7227 290a 0a20 2020 2020 2020 2020  her')..         
+0001f5e0: 2020 2060 6060 0a20 2020 2020 2020 2022     ```.        "
+0001f5f0: 2222 0a20 2020 2020 2020 2074 6162 6c65  "".        table
+0001f600: 203d 2073 656c 662e 746f 5f61 7272 6f77   = self.to_arrow
+0001f610: 2829 0a20 2020 2020 2020 2066 6561 7468  ().        feath
+0001f620: 6572 2e77 7269 7465 5f66 6561 7468 6572  er.write_feather
+0001f630: 2874 6162 6c65 2c20 7061 7468 290a 2020  (table, path).  
+0001f640: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+0001f650: 650a 0a20 2020 2064 6566 2074 6f5f 6373  e..    def to_cs
+0001f660: 7628 7365 6c66 2c20 7061 7468 3a20 7374  v(self, path: st
+0001f670: 7229 202d 3e20 4e6f 6e65 3a0a 2020 2020  r) -> None:.    
+0001f680: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001f690: 5361 7665 2074 6865 2041 7272 6179 2074  Save the Array t
+0001f6a0: 6f20 6120 4353 5620 6669 6c65 2e0a 0a20  o a CSV file... 
+0001f6b0: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+0001f6c0: 2020 2020 2020 2020 2070 6174 683a 2054           path: T
+0001f6d0: 6865 2070 6174 6820 746f 2073 6176 6520  he path to save 
+0001f6e0: 7468 6520 4353 5620 6669 6c65 2e0a 0a20  the CSV file... 
+0001f6f0: 2020 2020 2020 2045 7861 6d70 6c65 3a0a         Example:.
+0001f700: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
+0001f710: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
+0001f720: 2020 3e3e 3e20 636f 6f72 6473 203d 207b    >>> coords = {
+0001f730: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
+0001f740: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
+0001f750: 325d 7d0a 2020 2020 2020 2020 2020 2020  2]}.            
+0001f760: 3e3e 3e20 6c6f 6e67 203d 204c 6f6e 6728  >>> long = Long(
+0001f770: 696e 6465 783d 7b27 6469 6d31 273a 205b  index={'dim1': [
+0001f780: 2761 272c 2027 6227 5d2c 2027 6469 6d32  'a', 'b'], 'dim2
+0001f790: 273a 205b 312c 2032 5d7d 2c20 7661 6c75  ': [1, 2]}, valu
+0001f7a0: 653d 5b31 302c 2032 305d 290a 2020 2020  e=[10, 20]).    
+0001f7b0: 2020 2020 2020 2020 3e3e 3e20 6172 7220          >>> arr 
+0001f7c0: 3d20 4172 7261 7928 6461 7461 3d6c 6f6e  = Array(data=lon
+0001f7d0: 672c 2063 6f6f 7264 733d 636f 6f72 6473  g, coords=coords
+0001f7e0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+0001f7f0: 3e20 6172 722e 746f 5f63 7376 2827 7465  > arr.to_csv('te
+0001f800: 7374 732f 6461 7461 2f61 7272 6179 2e63  sts/data/array.c
+0001f810: 7376 2729 0a0a 2020 2020 2020 2020 2020  sv')..          
+0001f820: 2020 6060 600a 2020 2020 2020 2020 2222    ```.        ""
+0001f830: 220a 2020 2020 2020 2020 7461 626c 6520  ".        table 
+0001f840: 3d20 7365 6c66 2e74 6f5f 6172 726f 7728  = self.to_arrow(
+0001f850: 290a 2020 2020 2020 2020 7461 626c 652e  ).        table.
+0001f860: 746f 5f70 616e 6461 7328 292e 746f 5f63  to_pandas().to_c
+0001f870: 7376 2870 6174 682c 2069 6e64 6578 3d46  sv(path, index=F
+0001f880: 616c 7365 290a 2020 2020 2020 2020 7265  alse).        re
+0001f890: 7475 726e 204e 6f6e 650a 0a20 2020 2064  turn None..    d
+0001f8a0: 6566 2073 6872 696e 6b28 7365 6c66 2c20  ef shrink(self, 
+0001f8b0: 2a2a 6b77 6172 6773 3a20 556e 696f 6e5b  **kwargs: Union[
+0001f8c0: 4c69 7374 5b41 6e79 5d2c 206e 702e 6e64  List[Any], np.nd
+0001f8d0: 6172 7261 795d 2920 2d3e 2027 4172 7261  array]) -> 'Arra
+0001f8e0: 7927 3a0a 2020 2020 2020 2020 2222 220a  y':.        """.
+0001f8f0: 2020 2020 2020 2020 5368 7269 6e6b 2074          Shrink t
+0001f900: 6865 2041 7272 6179 2062 7920 7365 6c65  he Array by sele
+0001f910: 6374 696e 6720 7370 6563 6966 6963 2065  cting specific e
+0001f920: 6c65 6d65 6e74 7320 6672 6f6d 2074 6865  lements from the
+0001f930: 2073 7065 6369 6669 6564 2064 696d 656e   specified dimen
+0001f940: 7369 6f6e 732e 0a0a 2020 2020 2020 2020  sions...        
+0001f950: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+0001f960: 2020 2a2a 6b77 6172 6773 3a20 4b65 7977    **kwargs: Keyw
+0001f970: 6f72 6420 6172 6775 6d65 6e74 7320 7370  ord arguments sp
+0001f980: 6563 6966 7969 6e67 2074 6865 2064 696d  ecifying the dim
+0001f990: 656e 7369 6f6e 7320 616e 6420 656c 656d  ensions and elem
+0001f9a0: 656e 7473 2074 6f20 6b65 6570 2e0a 0a20  ents to keep... 
+0001f9b0: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
+0001f9c0: 2020 2020 2020 2020 2020 2020 4120 6e65              A ne
+0001f9d0: 7720 4172 7261 7920 6f62 6a65 6374 2077  w Array object w
+0001f9e0: 6974 6820 7468 6520 7365 6c65 6374 6564  ith the selected
+0001f9f0: 2065 6c65 6d65 6e74 732e 0a0a 2020 2020   elements...    
+0001fa00: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+0001fa10: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+0001fa20: 6f6e 0a20 2020 2020 2020 2020 2020 203e  on.            >
+0001fa30: 3e3e 2063 6f6f 7264 7320 3d20 7b27 6469  >> coords = {'di
+0001fa40: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+0001fa50: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+0001fa60: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+0001fa70: 206c 6f6e 6720 3d20 4c6f 6e67 2869 6e64   long = Long(ind
+0001fa80: 6578 3d7b 2764 696d 3127 3a20 5b27 6127  ex={'dim1': ['a'
+0001fa90: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
+0001faa0: 5b31 2c20 325d 7d2c 2076 616c 7565 3d5b  [1, 2]}, value=[
+0001fab0: 3130 2c20 3230 5d29 0a20 2020 2020 2020  10, 20]).       
+0001fac0: 2020 2020 203e 3e3e 2061 7272 203d 2041       >>> arr = A
+0001fad0: 7272 6179 2864 6174 613d 6c6f 6e67 2c20  rray(data=long, 
+0001fae0: 636f 6f72 6473 3d63 6f6f 7264 7329 0a20  coords=coords). 
+0001faf0: 2020 2020 2020 2020 2020 203e 3e3e 206e             >>> n
+0001fb00: 6577 5f61 7272 203d 2061 7272 2e73 6872  ew_arr = arr.shr
+0001fb10: 696e 6b28 6469 6d31 3d5b 2761 275d 2c20  ink(dim1=['a'], 
+0001fb20: 6469 6d32 3d5b 315d 290a 2020 2020 2020  dim2=[1]).      
+0001fb30: 2020 2020 2020 3e3e 3e20 6e65 775f 6172        >>> new_ar
+0001fb40: 720a 2020 2020 2020 2020 2020 2020 4172  r.            Ar
+0001fb50: 7261 7928 6461 7461 3d61 7272 6179 285b  ray(data=array([
+0001fb60: 5b31 305d 5d29 2c20 636f 6f72 6473 3d7b  [10]]), coords={
+0001fb70: 2764 696d 3127 3a20 6172 7261 7928 5b27  'dim1': array(['
+0001fb80: 6127 5d2c 2064 7479 7065 3d6f 626a 6563  a'], dtype=objec
+0001fb90: 7429 2c20 2764 696d 3227 3a20 6172 7261  t), 'dim2': arra
+0001fba0: 7928 5b31 5d29 7d29 0a0a 2020 2020 2020  y([1])})..      
+0001fbb0: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
+0001fbc0: 2020 2222 220a 2020 2020 2020 2020 6173    """.        as
+0001fbd0: 7365 7274 2061 6c6c 285b 6b77 2069 6e20  sert all([kw in 
+0001fbe0: 7365 6c66 2e63 6f6f 7264 7320 666f 7220  self.coords for 
+0001fbf0: 6b77 2069 6e20 6b77 6172 6773 5d0a 2020  kw in kwargs].  
+0001fc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc10: 2029 2c20 2253 656c 6563 7465 6420 6469   ), "Selected di
+0001fc20: 6d65 6e73 696f 6e20 6d75 7374 2062 6520  mension must be 
+0001fc30: 696e 2063 6f6f 7264 7322 0a20 2020 2020  in coords".     
+0001fc40: 2020 2061 7373 6572 7420 616c 6c28 5b69     assert all([i
+0001fc50: 7369 6e73 7461 6e63 6528 6b77 6172 6773  sinstance(kwargs
+0001fc60: 5b64 696d 5d2c 2028 6c69 7374 2c20 6e70  [dim], (list, np
+0001fc70: 2e6e 6461 7272 6179 2929 2066 6f72 2064  .ndarray)) for d
+0001fc80: 696d 2069 6e20 6b77 6172 6773 5d0a 2020  im in kwargs].  
+0001fc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fca0: 2029 2c20 224b 6565 7069 6e67 2065 6c65   ), "Keeping ele
+0001fcb0: 6d65 6e74 7320 6d75 7374 2062 6520 636f  ments must be co
+0001fcc0: 6e74 6169 6e65 6420 696e 206c 6973 7473  ntained in lists
+0001fcd0: 206f 7220 6e70 2e6e 6461 7272 6179 220a   or np.ndarray".
+0001fce0: 2020 2020 2020 2020 6173 7365 7274 2061          assert a
+0001fcf0: 6c6c 285b 7365 7428 6b77 6172 6773 5b6b  ll([set(kwargs[k
+0001fd00: 775d 292e 6973 7375 6273 6574 2873 656c  w]).issubset(sel
+0001fd10: 662e 636f 6f72 6473 5b6b 775d 290a 2020  f.coords[kw]).  
+0001fd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fd30: 2066 6f72 206b 7720 696e 206b 7761 7267   for kw in kwarg
+0001fd40: 735d 292c 2022 416c 6c20 6b65 6570 696e  s]), "All keepin
+0001fd50: 6720 656c 656d 656e 7473 206d 7573 7420  g elements must 
+0001fd60: 6265 2069 6e63 6c75 6465 6420 6f66 2063  be included of c
+0001fd70: 6f6f 7264 7322 0a20 2020 2020 2020 2061  oords".        a
+0001fd80: 7373 6572 7420 616c 6c28 5b6c 656e 2873  ssert all([len(s
+0001fd90: 6574 286b 7761 7267 735b 6b77 5d29 2920  et(kwargs[kw])) 
+0001fda0: 3d3d 206c 656e 286b 7761 7267 735b 6b77  == len(kwargs[kw
+0001fdb0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+0001fdc0: 2020 2020 2020 666f 7220 6b77 2069 6e20        for kw in 
+0001fdd0: 6b77 6172 6773 5d29 2c20 224b 6565 7069  kwargs]), "Keepi
+0001fde0: 6e67 2065 6c65 6d65 6e74 7320 696e 206c  ng elements in l
+0001fdf0: 6973 7420 6d75 7374 2062 6520 756e 6971  ist must be uniq
+0001fe00: 7565 220a 2020 2020 2020 2020 6e65 775f  ue".        new_
+0001fe10: 636f 6f72 6473 203d 207b 7d0a 2020 2020  coords = {}.    
+0001fe20: 2020 2020 666f 7220 6469 6d20 696e 2073      for dim in s
+0001fe30: 656c 662e 636f 6f72 6473 3a0a 2020 2020  elf.coords:.    
+0001fe40: 2020 2020 2020 2020 6966 2064 696d 2069          if dim i
+0001fe50: 6e20 6b77 6172 6773 3a0a 2020 2020 2020  n kwargs:.      
+0001fe60: 2020 2020 2020 2020 2020 6e65 775f 636f            new_co
+0001fe70: 6f72 6473 5b64 696d 5d20 3d20 5f74 6573  ords[dim] = _tes
+0001fe80: 745f 7479 7065 5f61 6e64 5f75 7064 6174  t_type_and_updat
+0001fe90: 6528 6b77 6172 6773 5b64 696d 5d29 0a20  e(kwargs[dim]). 
+0001fea0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0001feb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fec0: 206e 6577 5f63 6f6f 7264 735b 6469 6d5d   new_coords[dim]
+0001fed0: 203d 2073 656c 662e 636f 6f72 6473 5b64   = self.coords[d
+0001fee0: 696d 5d0a 2020 2020 2020 2020 6c6f 6e67  im].        long
+0001fef0: 203d 2073 656c 662e 6c6f 6e67 0a20 2020   = self.long.   
+0001ff00: 2020 2020 2066 6f72 2064 696d 2069 6e20       for dim in 
+0001ff10: 7365 6c66 2e64 696d 733a 0a20 2020 2020  self.dims:.     
+0001ff20: 2020 2020 2020 2069 6620 6469 6d20 696e         if dim in
+0001ff30: 206b 7761 7267 733a 0a20 2020 2020 2020   kwargs:.       
+0001ff40: 2020 2020 2020 2020 206c 6f6e 6720 3d20           long = 
+0001ff50: 6c6f 6e67 5b64 696d 2c20 6b77 6172 6773  long[dim, kwargs
+0001ff60: 5b64 696d 5d5d 0a20 2020 2020 2020 2072  [dim]].        r
+0001ff70: 6574 7572 6e20 4172 7261 7928 6461 7461  eturn Array(data
+0001ff80: 3d6c 6f6e 672c 2063 6f6f 7264 733d 6e65  =long, coords=ne
+0001ff90: 775f 636f 6f72 6473 290a 0a20 2020 2064  w_coords)..    d
+0001ffa0: 6566 2061 6464 5f65 6c65 6d28 7365 6c66  ef add_elem(self
+0001ffb0: 2c20 2a2a 6b77 6172 6773 3a20 556e 696f  , **kwargs: Unio
+0001ffc0: 6e5b 4c69 7374 5b41 6e79 5d2c 206e 702e  n[List[Any], np.
+0001ffd0: 6e64 6172 7261 795d 2920 2d3e 2027 4172  ndarray]) -> 'Ar
+0001ffe0: 7261 7927 3a0a 2020 2020 2020 2020 2222  ray':.        ""
+0001fff0: 220a 2020 2020 2020 2020 4164 6420 6e65  ".        Add ne
+00020000: 7720 656c 656d 656e 7473 2074 6f20 7468  w elements to th
+00020010: 6520 7370 6563 6966 6965 6420 6469 6d65  e specified dime
+00020020: 6e73 696f 6e73 206f 6620 7468 6520 4172  nsions of the Ar
+00020030: 7261 792e 0a0a 2020 2020 2020 2020 4172  ray...        Ar
+00020040: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00020050: 2a2a 6b77 6172 6773 3a20 4b65 7977 6f72  **kwargs: Keywor
+00020060: 6420 6172 6775 6d65 6e74 7320 7370 6563  d arguments spec
+00020070: 6966 7969 6e67 2074 6865 2064 696d 656e  ifying the dimen
+00020080: 7369 6f6e 7320 616e 6420 656c 656d 656e  sions and elemen
+00020090: 7473 2074 6f20 6164 642e 0a0a 2020 2020  ts to add...    
+000200a0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+000200b0: 2020 2020 2020 2020 2041 206e 6577 2041           A new A
+000200c0: 7272 6179 206f 626a 6563 7420 7769 7468  rray object with
+000200d0: 2074 6865 2061 6464 6564 2065 6c65 6d65   the added eleme
+000200e0: 6e74 732e 0a0a 2020 2020 2020 2020 4578  nts...        Ex
+000200f0: 616d 706c 653a 0a20 2020 2020 2020 2020  ample:.         
+00020100: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+00020110: 2020 2020 2020 2020 203e 3e3e 2063 6f6f           >>> coo
+00020120: 7264 7320 3d20 7b27 6469 6d31 273a 205b  rds = {'dim1': [
+00020130: 2761 272c 2027 6227 5d2c 2027 6469 6d32  'a', 'b'], 'dim2
+00020140: 273a 205b 312c 2032 5d7d 0a20 2020 2020  ': [1, 2]}.     
+00020150: 2020 2020 2020 203e 3e3e 206c 6f6e 6720         >>> long 
+00020160: 3d20 4c6f 6e67 2869 6e64 6578 3d7b 2764  = Long(index={'d
+00020170: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
+00020180: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
+00020190: 7d2c 2076 616c 7565 3d5b 3130 2e2c 2032  }, value=[10., 2
+000201a0: 302e 5d29 0a20 2020 2020 2020 2020 2020  0.]).           
+000201b0: 203e 3e3e 2061 7272 203d 2041 7272 6179   >>> arr = Array
+000201c0: 2864 6174 613d 6c6f 6e67 2c20 636f 6f72  (data=long, coor
+000201d0: 6473 3d63 6f6f 7264 7329 0a20 2020 2020  ds=coords).     
+000201e0: 2020 2020 2020 203e 3e3e 2061 7272 0a20         >>> arr. 
+000201f0: 2020 2020 2020 2020 2020 2041 7272 6179             Array
+00020200: 2864 6174 613d 6172 7261 7928 5b5b 3130  (data=array([[10
+00020210: 2e2c 2020 302e 5d2c 0a20 2020 2020 2020  .,  0.],.       
+00020220: 2020 2020 2020 2020 2020 2020 5b20 302e              [ 0.
+00020230: 2c20 3230 2e5d 5d29 2c20 636f 6f72 6473  , 20.]]), coords
+00020240: 3d7b 2764 696d 3127 3a20 6172 7261 7928  ={'dim1': array(
+00020250: 5b27 6127 2c20 2762 275d 2c20 6474 7970  ['a', 'b'], dtyp
+00020260: 653d 6f62 6a65 6374 292c 2027 6469 6d32  e=object), 'dim2
+00020270: 273a 2061 7272 6179 285b 312c 2032 5d29  ': array([1, 2])
+00020280: 7d29 0a20 2020 2020 2020 2020 2020 203e  }).            >
+00020290: 3e3e 206e 6577 5f61 7272 203d 2061 7272  >> new_arr = arr
+000202a0: 2e61 6464 5f65 6c65 6d28 6469 6d31 3d5b  .add_elem(dim1=[
+000202b0: 2763 275d 2c20 6469 6d32 3d5b 335d 290a  'c'], dim2=[3]).
+000202c0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+000202d0: 6e65 775f 6172 720a 2020 2020 2020 2020  new_arr.        
+000202e0: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
+000202f0: 7272 6179 285b 5b31 302e 2c20 2030 2e2c  rray([[10.,  0.,
+00020300: 2020 302e 5d2c 0a20 2020 2020 2020 2020    0.],.         
+00020310: 2020 2020 2020 2020 2020 5b20 302e 2c20            [ 0., 
+00020320: 3230 2e2c 2020 302e 5d2c 0a20 2020 2020  20.,  0.],.     
+00020330: 2020 2020 2020 2020 2020 2020 2020 5b20                [ 
+00020340: 302e 2c20 2030 2e2c 2020 302e 5d5d 292c  0.,  0.,  0.]]),
+00020350: 2063 6f6f 7264 733d 7b27 6469 6d31 273a   coords={'dim1':
+00020360: 2061 7272 6179 285b 2761 272c 2027 6227   array(['a', 'b'
+00020370: 2c20 2763 275d 2c20 6474 7970 653d 6f62  , 'c'], dtype=ob
+00020380: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
+00020390: 7272 6179 285b 312c 2032 2c20 335d 297d  rray([1, 2, 3])}
+000203a0: 290a 0a20 2020 2020 2020 2020 2020 2060  )..            `
+000203b0: 6060 0a20 2020 2020 2020 2022 2222 0a20  ``.        """. 
+000203c0: 2020 2020 2020 2066 6f72 2064 696d 2069         for dim i
+000203d0: 6e20 6b77 6172 6773 3a0a 2020 2020 2020  n kwargs:.      
+000203e0: 2020 2020 2020 6173 7365 7274 2064 696d        assert dim
+000203f0: 2069 6e20 7365 6c66 2e64 696d 732c 2066   in self.dims, f
+00020400: 2764 696d 3a20 7b64 696d 7d20 6d75 7374  'dim: {dim} must
+00020410: 2065 7869 7374 2069 6e20 7365 6c66 2e64   exist in self.d
+00020420: 696d 733a 207b 7365 6c66 2e64 696d 737d  ims: {self.dims}
+00020430: 270a 2020 2020 2020 2020 6173 7365 7274  '.        assert
+00020440: 2061 6c6c 285b 6973 696e 7374 616e 6365   all([isinstance
+00020450: 286b 7761 7267 735b 6469 6d5d 2c20 286c  (kwargs[dim], (l
+00020460: 6973 742c 206e 702e 6e64 6172 7261 792c  ist, np.ndarray,
+00020470: 2027 7064 2e44 6174 6574 696d 6549 6e64   'pd.DatetimeInd
+00020480: 6578 272c 2027 7064 2e43 6174 6567 6f72  ex', 'pd.Categor
+00020490: 6963 616c 2729 2920 666f 7220 6469 6d20  ical')) for dim 
+000204a0: 696e 206b 7761 7267 735d 0a20 2020 2020  in kwargs].     
+000204b0: 2020 2020 2020 2020 2020 2020 2020 292c                ),
+000204c0: 2022 4b65 6570 696e 6720 656c 656d 656e   "Keeping elemen
+000204d0: 7473 206d 7573 7420 6265 2063 6f6e 7461  ts must be conta
+000204e0: 696e 6564 2069 6e20 6c69 7374 732c 206e  ined in lists, n
+000204f0: 702e 6e64 6172 7261 792c 2070 642e 4361  p.ndarray, pd.Ca
+00020500: 7465 676f 7269 6361 6c20 6f72 2070 642e  tegorical or pd.
+00020510: 4461 7465 7469 6d65 496e 6465 7822 0a20  DatetimeIndex". 
+00020520: 2020 2020 2020 2063 6f6f 7264 7320 3d20         coords = 
+00020530: 7b7d 0a20 2020 2020 2020 2066 6f72 2064  {}.        for d
+00020540: 696d 2069 6e20 7365 6c66 2e63 6f6f 7264  im in self.coord
+00020550: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
+00020560: 6620 6469 6d20 696e 206b 7761 7267 733a  f dim in kwargs:
+00020570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020580: 2063 6f6f 7264 735b 6469 6d5d 203d 206e   coords[dim] = n
+00020590: 702e 756e 6971 7565 286e 702e 6873 7461  p.unique(np.hsta
+000205a0: 636b 2828 7365 6c66 2e63 6f6f 7264 735b  ck((self.coords[
+000205b0: 6469 6d5d 2c20 5f74 6573 745f 7479 7065  dim], _test_type
+000205c0: 5f61 6e64 5f75 7064 6174 6528 6b77 6172  _and_update(kwar
+000205d0: 6773 5b64 696d 5d29 2929 290a 2020 2020  gs[dim])))).    
+000205e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000205f0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00020600: 6f72 6473 5b64 696d 5d20 3d20 7365 6c66  ords[dim] = self
+00020610: 2e63 6f6f 7264 735b 6469 6d5d 0a20 2020  .coords[dim].   
+00020620: 2020 2020 2072 6574 7572 6e20 4172 7261       return Arra
+00020630: 7928 6461 7461 3d73 656c 662e 6c6f 6e67  y(data=self.long
+00020640: 2c20 636f 6f72 6473 3d63 6f6f 7264 7329  , coords=coords)
+00020650: 0a0a 2020 2020 6465 6620 7265 6475 6365  ..    def reduce
+00020660: 2873 656c 662c 2064 696d 3a20 7374 722c  (self, dim: str,
+00020670: 2061 6767 6675 6e63 3a20 556e 696f 6e5b   aggfunc: Union[
+00020680: 7374 722c 2043 616c 6c61 626c 655d 203d  str, Callable] =
+00020690: 206e 702e 6164 642e 7265 6475 6365 2920   np.add.reduce) 
+000206a0: 2d3e 2027 4172 7261 7927 3a0a 2020 2020  -> 'Array':.    
+000206b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000206c0: 5265 6475 6365 2074 6865 2041 7272 6179  Reduce the Array
+000206d0: 2061 6c6f 6e67 2061 2073 7065 6369 6669   along a specifi
+000206e0: 6564 2064 696d 656e 7369 6f6e 2075 7369  ed dimension usi
+000206f0: 6e67 2061 6e20 6167 6772 6567 6174 696f  ng an aggregatio
+00020700: 6e20 6675 6e63 7469 6f6e 2e0a 0a20 2020  n function...   
+00020710: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
+00020720: 2020 2020 2020 2064 696d 3a20 5468 6520         dim: The 
+00020730: 6469 6d65 6e73 696f 6e20 746f 2072 6564  dimension to red
+00020740: 7563 652e 0a20 2020 2020 2020 2020 2020  uce..           
+00020750: 2061 6767 6675 6e63 3a20 5468 6520 6167   aggfunc: The ag
+00020760: 6772 6567 6174 696f 6e20 6675 6e63 7469  gregation functi
+00020770: 6f6e 2074 6f20 6170 706c 792e 2043 616e  on to apply. Can
+00020780: 2062 6520 6120 7374 7269 6e67 2028 2773   be a string ('s
+00020790: 756d 272c 2027 6d65 616e 272c 2027 7072  um', 'mean', 'pr
+000207a0: 6f64 2729 206f 7220 6120 6361 6c6c 6162  od') or a callab
+000207b0: 6c65 2e0a 0a20 2020 2020 2020 2052 6574  le...        Ret
+000207c0: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
+000207d0: 2020 4120 6e65 7720 4172 7261 7920 6f62    A new Array ob
+000207e0: 6a65 6374 2077 6974 6820 7468 6520 7265  ject with the re
+000207f0: 6475 6365 6420 6469 6d65 6e73 696f 6e2e  duced dimension.
+00020800: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+00020810: 653a 0a20 2020 2020 2020 2020 2020 2060  e:.            `
+00020820: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
+00020830: 2020 2020 203e 3e3e 2063 6f6f 7264 7320       >>> coords 
+00020840: 3d20 7b27 6469 6d31 273a 205b 2761 272c  = {'dim1': ['a',
+00020850: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
+00020860: 312c 2032 5d7d 0a20 2020 2020 2020 2020  1, 2]}.         
+00020870: 2020 203e 3e3e 206c 6f6e 6720 3d20 4c6f     >>> long = Lo
+00020880: 6e67 2869 6e64 6578 3d7b 2764 696d 3127  ng(index={'dim1'
+00020890: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+000208a0: 696d 3227 3a20 5b31 2c20 325d 7d2c 2076  im2': [1, 2]}, v
+000208b0: 616c 7565 3d5b 3130 2c20 3230 5d29 0a20  alue=[10, 20]). 
+000208c0: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
+000208d0: 7272 203d 2041 7272 6179 2864 6174 613d  rr = Array(data=
+000208e0: 6c6f 6e67 2c20 636f 6f72 6473 3d63 6f6f  long, coords=coo
+000208f0: 7264 7329 0a20 2020 2020 2020 2020 2020  rds).           
+00020900: 203e 3e3e 2072 6564 7563 6564 5f61 7272   >>> reduced_arr
+00020910: 203d 2061 7272 2e72 6564 7563 6528 2764   = arr.reduce('d
+00020920: 696d 3127 2c20 6167 6766 756e 633d 2773  im1', aggfunc='s
+00020930: 756d 2729 0a20 2020 2020 2020 2020 2020  um').           
+00020940: 203e 3e3e 2072 6564 7563 6564 5f61 7272   >>> reduced_arr
+00020950: 0a20 2020 2020 2020 2020 2020 2041 7272  .            Arr
+00020960: 6179 2864 6174 613d 6172 7261 7928 5b31  ay(data=array([1
+00020970: 302e 2c20 3230 2e5d 292c 2063 6f6f 7264  0., 20.]), coord
+00020980: 733d 7b27 6469 6d32 273a 2061 7272 6179  s={'dim2': array
+00020990: 285b 312c 2032 5d29 7d29 0a0a 2020 2020  ([1, 2])})..    
+000209a0: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+000209b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000209c0: 6173 7365 7274 2064 696d 2069 6e20 7365  assert dim in se
+000209d0: 6c66 2e64 696d 732c 2066 2264 696d 207b  lf.dims, f"dim {
+000209e0: 6469 6d7d 206e 6f74 2069 6e20 7365 6c66  dim} not in self
+000209f0: 2e64 696d 733a 207b 7365 6c66 2e64 696d  .dims: {self.dim
+00020a00: 737d 220a 2020 2020 2020 2020 6966 2069  s}".        if i
+00020a10: 7369 6e73 7461 6e63 6528 6167 6766 756e  sinstance(aggfun
+00020a20: 632c 2073 7472 293a 0a20 2020 2020 2020  c, str):.       
+00020a30: 2020 2020 2061 7373 6572 7420 6167 6766       assert aggf
+00020a40: 756e 6320 696e 205b 0a20 2020 2020 2020  unc in [.       
+00020a50: 2020 2020 2020 2020 2027 7375 6d27 2c20           'sum', 
+00020a60: 276d 6561 6e27 2c20 2770 726f 6427 5d2c  'mean', 'prod'],
+00020a70: 2022 5374 7269 6e67 206f 7074 696f 6e73   "String options
+00020a80: 2066 6f72 2061 6767 6675 6e63 2063 616e   for aggfunc can
+00020a90: 2062 6520 2773 756d 272c 2027 6d65 616e   be 'sum', 'mean
+00020aa0: 2720 6f72 2027 7072 6f64 2722 0a20 2020  ' or 'prod'".   
+00020ab0: 2020 2020 2020 2020 2069 6620 6167 6766           if aggf
+00020ac0: 756e 6320 3d3d 2027 7375 6d27 3a0a 2020  unc == 'sum':.  
+00020ad0: 2020 2020 2020 2020 2020 2020 2020 6167                ag
+00020ae0: 6766 756e 6320 3d20 6e70 2e61 6464 2e72  gfunc = np.add.r
+00020af0: 6564 7563 650a 2020 2020 2020 2020 2020  educe.          
+00020b00: 2020 656c 6966 2061 6767 6675 6e63 203d    elif aggfunc =
+00020b10: 3d20 276d 6561 6e27 3a0a 2020 2020 2020  = 'mean':.      
+00020b20: 2020 2020 2020 2020 2020 6167 6766 756e            aggfun
+00020b30: 6320 3d20 6e70 2e6d 6561 6e0a 2020 2020  c = np.mean.    
+00020b40: 2020 2020 2020 2020 656c 6966 2061 6767          elif agg
+00020b50: 6675 6e63 203d 3d20 2770 726f 6427 3a0a  func == 'prod':.
+00020b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b70: 6167 6766 756e 6320 3d20 6e70 2e6d 756c  aggfunc = np.mul
+00020b80: 7469 706c 792e 7265 6475 6365 0a20 2020  tiply.reduce.   
+00020b90: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
+00020ba0: 616e 6365 2861 6767 6675 6e63 2c20 4361  ance(aggfunc, Ca
+00020bb0: 6c6c 6162 6c65 293a 0a20 2020 2020 2020  llable):.       
+00020bc0: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
+00020bd0: 2020 6e64 6172 7261 7920 3d20 6167 6766    ndarray = aggf
+00020be0: 756e 6328 7365 6c66 2e64 6174 612c 2061  unc(self.data, a
+00020bf0: 7869 733d 7365 6c66 2e64 696d 732e 696e  xis=self.dims.in
+00020c00: 6465 7828 6469 6d29 290a 2020 2020 2020  dex(dim)).      
+00020c10: 2020 6469 6d73 203d 205b 6420 666f 7220    dims = [d for 
+00020c20: 6420 696e 2073 656c 662e 6469 6d73 2069  d in self.dims i
+00020c30: 6620 6420 213d 2064 696d 5d0a 2020 2020  f d != dim].    
+00020c40: 2020 2020 636f 6f72 6473 203d 207b 6b3a      coords = {k:
+00020c50: 2076 2066 6f72 206b 2c20 7620 696e 2073   v for k, v in s
+00020c60: 656c 662e 636f 6f72 6473 2e69 7465 6d73  elf.coords.items
+00020c70: 2829 2069 6620 6b20 696e 2064 696d 737d  () if k in dims}
+00020c80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00020c90: 7365 6c66 2e5f 706f 7374 5f6f 7065 7261  self._post_opera
+00020ca0: 7469 6f6e 286e 6461 7272 6179 2c20 636f  tion(ndarray, co
+00020cb0: 6f72 6473 290a 0a20 2020 2064 6566 205f  ords)..    def _
+00020cc0: 7368 6966 745f 6f6e 655f 6469 6d28 7365  shift_one_dim(se
+00020cd0: 6c66 2c20 6469 6d3a 2073 7472 2c20 636f  lf, dim: str, co
+00020ce0: 756e 743a 2069 6e74 2c20 6669 6c6c 5f76  unt: int, fill_v
+00020cf0: 616c 7565 3a20 556e 696f 6e5b 666c 6f61  alue: Union[floa
+00020d00: 742c 204e 6f6e 655d 203d 204e 6f6e 6529  t, None] = None)
+00020d10: 202d 3e20 2741 7272 6179 273a 0a20 2020   -> 'Array':.   
+00020d20: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00020d30: 2053 6869 6674 2074 6865 2041 7272 6179   Shift the Array
+00020d40: 2061 6c6f 6e67 2061 2073 696e 676c 6520   along a single 
+00020d50: 6469 6d65 6e73 696f 6e2e 0a0a 2020 2020  dimension...    
+00020d60: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+00020d70: 2020 2020 2020 6469 6d3a 2054 6865 2064        dim: The d
+00020d80: 696d 656e 7369 6f6e 2074 6f20 7368 6966  imension to shif
+00020d90: 742e 0a20 2020 2020 2020 2020 2020 2063  t..            c
+00020da0: 6f75 6e74 3a20 5468 6520 6e75 6d62 6572  ount: The number
+00020db0: 206f 6620 706f 7369 7469 6f6e 7320 746f   of positions to
+00020dc0: 2073 6869 6674 2e20 506f 7369 7469 7665   shift. Positive
+00020dd0: 2076 616c 7565 7320 7368 6966 7420 666f   values shift fo
+00020de0: 7277 6172 642c 206e 6567 6174 6976 6520  rward, negative 
+00020df0: 7661 6c75 6573 2073 6869 6674 2062 6163  values shift bac
+00020e00: 6b77 6172 642e 0a20 2020 2020 2020 2020  kward..         
+00020e10: 2020 2066 696c 6c5f 7661 6c75 653a 2054     fill_value: T
+00020e20: 6865 2076 616c 7565 2074 6f20 6669 6c6c  he value to fill
+00020e30: 2074 6865 2065 6d70 7479 2070 6f73 6974   the empty posit
+00020e40: 696f 6e73 2061 6674 6572 2073 6869 6674  ions after shift
+00020e50: 696e 672e 2049 6620 4e6f 6e65 2c20 7573  ing. If None, us
+00020e60: 6520 7468 6520 6465 6661 756c 7420 6669  e the default fi
+00020e70: 6c6c 2076 616c 7565 2e0a 0a20 2020 2020  ll value...     
+00020e80: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
+00020e90: 2020 2020 2020 2020 4120 6e65 7720 4172          A new Ar
+00020ea0: 7261 7920 6f62 6a65 6374 2077 6974 6820  ray object with 
+00020eb0: 7468 6520 7368 6966 7465 6420 7661 6c75  the shifted valu
+00020ec0: 6573 2e0a 0a20 2020 2020 2020 2045 7861  es...        Exa
+00020ed0: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
+00020ee0: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
+00020ef0: 2020 2020 2020 2020 3e3e 3e20 636f 6f72          >>> coor
+00020f00: 6473 203d 207b 2764 696d 3127 3a20 5b27  ds = {'dim1': ['
+00020f10: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
+00020f20: 3a20 5b31 2c20 325d 7d0a 2020 2020 2020  : [1, 2]}.      
+00020f30: 2020 2020 2020 3e3e 3e20 6c6f 6e67 203d        >>> long =
+00020f40: 204c 6f6e 6728 696e 6465 783d 7b27 6469   Long(index={'di
+00020f50: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+00020f60: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+00020f70: 2c20 7661 6c75 653d 5b31 302c 2032 305d  , value=[10, 20]
+00020f80: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00020f90: 3e20 6172 7220 3d20 4172 7261 7928 6461  > arr = Array(da
+00020fa0: 7461 3d6c 6f6e 672c 2063 6f6f 7264 733d  ta=long, coords=
+00020fb0: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
+00020fc0: 2020 2020 3e3e 3e20 7368 6966 7465 645f      >>> shifted_
+00020fd0: 6172 7220 3d20 6172 722e 5f73 6869 6674  arr = arr._shift
+00020fe0: 5f6f 6e65 5f64 696d 2827 6469 6d31 272c  _one_dim('dim1',
+00020ff0: 2063 6f75 6e74 3d31 2c20 6669 6c6c 5f76   count=1, fill_v
+00021000: 616c 7565 3d30 290a 2020 2020 2020 2020  alue=0).        
+00021010: 2020 2020 3e3e 3e20 7368 6966 7465 645f      >>> shifted_
+00021020: 6172 720a 2020 2020 2020 2020 2020 2020  arr.            
+00021030: 4172 7261 7928 6461 7461 3d61 7272 6179  Array(data=array
+00021040: 285b 5b20 302e 2c20 2030 2e5d 2c0a 2020  ([[ 0.,  0.],.  
+00021050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021060: 205b 3130 2e2c 2020 302e 5d5d 292c 2063   [10.,  0.]]), c
+00021070: 6f6f 7264 733d 7b27 6469 6d31 273a 2061  oords={'dim1': a
+00021080: 7272 6179 285b 2761 272c 2027 6227 5d2c  rray(['a', 'b'],
+00021090: 2064 7479 7065 3d6f 626a 6563 7429 2c20   dtype=object), 
+000210a0: 2764 696d 3227 3a20 6172 7261 7928 5b31  'dim2': array([1
+000210b0: 2c20 325d 297d 290a 0a20 2020 2020 2020  , 2])})..       
+000210c0: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
+000210d0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+000210e0: 6669 6c6c 5f76 616c 7565 2069 7320 4e6f  fill_value is No
+000210f0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00021100: 6669 6c6c 5f76 616c 7565 2c20 6474 7970  fill_value, dtyp
+00021110: 6520 3d20 7365 6c66 2e5f 6669 6c6c 6572  e = self._filler
+00021120: 5f61 6e64 5f64 7479 7065 2873 656c 662e  _and_dtype(self.
+00021130: 6461 7461 2c20 7365 6c66 2e66 696c 6c5f  data, self.fill_
+00021140: 7661 6c75 6529 0a20 2020 2020 2020 2020  value).         
+00021150: 2020 2072 6177 5f64 6174 6120 3d20 7365     raw_data = se
+00021160: 6c66 2e64 6174 612e 6173 7479 7065 2864  lf.data.astype(d
+00021170: 7479 7065 290a 2020 2020 2020 2020 656c  type).        el
+00021180: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00021190: 7261 775f 6461 7461 203d 2073 656c 662e  raw_data = self.
+000211a0: 6461 7461 0a20 2020 2020 2020 2061 7820  data.        ax 
+000211b0: 3d20 7365 6c66 2e64 696d 732e 696e 6465  = self.dims.inde
+000211c0: 7828 6469 6d29 0a20 2020 2020 2020 2064  x(dim).        d
+000211d0: 6174 6120 3d20 6e70 2e72 6f6c 6c28 7261  ata = np.roll(ra
+000211e0: 775f 6461 7461 2c20 7368 6966 743d 636f  w_data, shift=co
+000211f0: 756e 742c 2061 7869 733d 6178 290a 2020  unt, axis=ax).  
+00021200: 2020 2020 2020 6966 2073 656c 662e 6461        if self.da
+00021210: 7461 5f74 7970 6520 3d3d 2027 6465 6e73  ta_type == 'dens
+00021220: 6527 3a0a 2020 2020 2020 2020 2020 2020  e':.            
+00021230: 6966 2063 6f75 6e74 203e 2030 3a0a 2020  if count > 0:.  
+00021240: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00021250: 7461 2e73 7761 7061 7865 7328 302c 2061  ta.swapaxes(0, a
+00021260: 7829 5b3a 636f 756e 745d 203d 2066 696c  x)[:count] = fil
+00021270: 6c5f 7661 6c75 650a 2020 2020 2020 2020  l_value.        
+00021280: 2020 2020 656c 6966 2063 6f75 6e74 203c      elif count <
+00021290: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000212a0: 2020 2020 6461 7461 2e73 7761 7061 7865      data.swapaxe
+000212b0: 7328 302c 2061 7829 5b63 6f75 6e74 3a5d  s(0, ax)[count:]
+000212c0: 203d 2066 696c 6c5f 7661 6c75 650a 2020   = fill_value.  
+000212d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000212e0: 2073 656c 662e 5f70 6f73 745f 6f70 6572   self._post_oper
+000212f0: 6174 696f 6e28 6461 7461 2c20 7365 6c66  ation(data, self
+00021300: 2e63 6f6f 7264 7329 0a20 2020 2020 2020  .coords).       
+00021310: 2065 6c69 6620 7365 6c66 2e64 6174 615f   elif self.data_
+00021320: 7479 7065 203d 3d20 2773 7061 7273 6527  type == 'sparse'
+00021330: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+00021340: 6f5f 696e 6465 7820 3d20 6461 7461 2e63  o_index = data.c
+00021350: 6f6f 7264 730a 2020 2020 2020 2020 2020  oords.          
+00021360: 2020 7368 6170 6520 3d20 6461 7461 2e73    shape = data.s
+00021370: 6861 7065 0a20 2020 2020 2020 2020 2020  hape.           
+00021380: 2075 7070 6572 203d 2073 6861 7065 5b61   upper = shape[a
+00021390: 785d 0a20 2020 2020 2020 2020 2020 2069  x].            i
+000213a0: 6620 636f 756e 7420 3e20 303a 0a20 2020  f count > 0:.   
+000213b0: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+000213c0: 7274 203d 2030 0a20 2020 2020 2020 2020  rt = 0.         
+000213d0: 2020 2020 2020 2065 6e64 203d 2063 6f75         end = cou
+000213e0: 6e74 0a20 2020 2020 2020 2020 2020 2065  nt.            e
+000213f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00021400: 2020 2020 2073 7461 7274 203d 2075 7070       start = upp
+00021410: 6572 202b 2063 6f75 6e74 0a20 2020 2020  er + count.     
+00021420: 2020 2020 2020 2020 2020 2065 6e64 203d             end =
+00021430: 2075 7070 6572 0a20 2020 2020 2020 2020   upper.         
+00021440: 2020 2061 7373 6572 7420 5f69 735f 696e     assert _is_in
+00021450: 5f72 616e 6765 2873 7461 7274 2c20 656e  _range(start, en
+00021460: 642c 2030 2c20 7570 7065 722c 2073 7465  d, 0, upper, ste
+00021470: 703d 3129 0a20 2020 2020 2020 2020 2020  p=1).           
+00021480: 2073 656c 6563 7465 6420 3d20 636f 6f5f   selected = coo_
+00021490: 696e 6465 785b 6178 5d0a 2020 2020 2020  index[ax].      
+000214a0: 2020 2020 2020 736f 7274 6564 6964 7820        sortedidx 
+000214b0: 3d20 6e70 2e61 7267 736f 7274 2873 656c  = np.argsort(sel
+000214c0: 6563 7465 6429 0a20 2020 2020 2020 2020  ected).         
+000214d0: 2020 206c 203d 206e 702e 7365 6172 6368     l = np.search
+000214e0: 736f 7274 6564 2873 656c 6563 7465 642c  sorted(selected,
+000214f0: 2073 7461 7274 2c20 7369 6465 3d27 6c65   start, side='le
+00021500: 6674 272c 2073 6f72 7465 723d 736f 7274  ft', sorter=sort
+00021510: 6564 6964 7829 0a20 2020 2020 2020 2020  edidx).         
+00021520: 2020 2072 203d 206e 702e 7365 6172 6368     r = np.search
+00021530: 736f 7274 6564 2873 656c 6563 7465 642c  sorted(selected,
+00021540: 2065 6e64 2d31 2c20 7369 6465 3d27 7269   end-1, side='ri
+00021550: 6768 7427 2c20 736f 7274 6572 3d73 6f72  ght', sorter=sor
+00021560: 7465 6469 6478 290a 2020 2020 2020 2020  tedidx).        
+00021570: 2020 2020 696e 6473 203d 2073 6f72 7465      inds = sorte
+00021580: 6469 6478 5b6c 3a72 5d0a 2020 2020 2020  didx[l:r].      
+00021590: 2020 2020 2020 636f 6f5f 7661 6c75 6520        coo_value 
+000215a0: 3d20 6461 7461 2e64 6174 610a 2020 2020  = data.data.    
+000215b0: 2020 2020 2020 2020 636f 6f5f 7661 6c75          coo_valu
+000215c0: 655b 696e 6473 5d20 3d20 6669 6c6c 5f76  e[inds] = fill_v
+000215d0: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+000215e0: 2063 6f6f 203d 2073 702e 434f 4f28 6461   coo = sp.COO(da
+000215f0: 7461 3d63 6f6f 5f76 616c 7565 2c20 636f  ta=coo_value, co
+00021600: 6f72 6473 3d63 6f6f 5f69 6e64 6578 2c20  ords=coo_index, 
+00021610: 7368 6170 653d 7368 6170 6529 0a20 2020  shape=shape).   
+00021620: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00021630: 7365 6c66 2e5f 706f 7374 5f6f 7065 7261  self._post_opera
+00021640: 7469 6f6e 2863 6f6f 2c20 7365 6c66 2e63  tion(coo, self.c
+00021650: 6f6f 7264 7329 0a0a 2020 2020 6465 6620  oords)..    def 
+00021660: 7368 6966 7428 7365 6c66 2c20 6669 6c6c  shift(self, fill
+00021670: 5f76 616c 7565 3a20 556e 696f 6e5b 666c  _value: Union[fl
+00021680: 6f61 742c 204e 6f6e 655d 203d 204e 6f6e  oat, None] = Non
+00021690: 652c 202a 2a6b 7761 7267 733a 2069 6e74  e, **kwargs: int
+000216a0: 2920 2d3e 2027 4172 7261 7927 3a0a 2020  ) -> 'Array':.  
+000216b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000216c0: 2020 5368 6966 7420 7468 6520 4172 7261    Shift the Arra
+000216d0: 7920 616c 6f6e 6720 7370 6563 6966 6965  y along specifie
+000216e0: 6420 6469 6d65 6e73 696f 6e73 2e0a 0a20  d dimensions... 
+000216f0: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+00021700: 2020 2020 2020 2020 2066 696c 6c5f 7661           fill_va
+00021710: 6c75 653a 2054 6865 2076 616c 7565 2074  lue: The value t
+00021720: 6f20 6669 6c6c 2074 6865 2065 6d70 7479  o fill the empty
+00021730: 2070 6f73 6974 696f 6e73 2061 6674 6572   positions after
+00021740: 2073 6869 6674 696e 672e 2049 6620 4e6f   shifting. If No
+00021750: 6e65 2c20 7573 6520 7468 6520 6465 6661  ne, use the defa
+00021760: 756c 7420 6669 6c6c 2076 616c 7565 2e0a  ult fill value..
+00021770: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
+00021780: 6172 6773 3a20 4b65 7977 6f72 6420 6172  args: Keyword ar
+00021790: 6775 6d65 6e74 7320 7370 6563 6966 7969  guments specifyi
+000217a0: 6e67 2074 6865 2064 696d 656e 7369 6f6e  ng the dimension
+000217b0: 7320 616e 6420 7468 6520 6e75 6d62 6572  s and the number
+000217c0: 206f 6620 706f 7369 7469 6f6e 7320 746f   of positions to
+000217d0: 2073 6869 6674 2e0a 0a20 2020 2020 2020   shift...       
+000217e0: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+000217f0: 2020 2020 2020 4120 6e65 7720 4172 7261        A new Arra
+00021800: 7920 6f62 6a65 6374 2077 6974 6820 7468  y object with th
+00021810: 6520 7368 6966 7465 6420 7661 6c75 6573  e shifted values
+00021820: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+00021830: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+00021840: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+00021850: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
+00021860: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
+00021870: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
+00021880: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
+00021890: 2020 2020 3e3e 3e20 6c6f 6e67 203d 204c      >>> long = L
+000218a0: 6f6e 6728 696e 6465 783d 7b27 6469 6d31  ong(index={'dim1
+000218b0: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+000218c0: 6469 6d32 273a 205b 312c 2032 5d7d 2c20  dim2': [1, 2]}, 
+000218d0: 7661 6c75 653d 5b31 302c 2032 305d 290a  value=[10, 20]).
+000218e0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+000218f0: 6172 7220 3d20 4172 7261 7928 6461 7461  arr = Array(data
+00021900: 3d6c 6f6e 672c 2063 6f6f 7264 733d 636f  =long, coords=co
+00021910: 6f72 6473 290a 2020 2020 2020 2020 2020  ords).          
+00021920: 2020 3e3e 3e20 7368 6966 7465 645f 6172    >>> shifted_ar
+00021930: 7220 3d20 6172 722e 7368 6966 7428 6469  r = arr.shift(di
+00021940: 6d31 3d31 2c20 6469 6d32 3d2d 312c 2066  m1=1, dim2=-1, f
+00021950: 696c 6c5f 7661 6c75 653d 3029 0a20 2020  ill_value=0).   
+00021960: 2020 2020 2020 2020 203e 3e3e 2073 6869           >>> shi
+00021970: 6674 6564 5f61 7272 0a20 2020 2020 2020  fted_arr.       
+00021980: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
+00021990: 6172 7261 7928 5b5b 302e 2c20 302e 5d2c  array([[0., 0.],
+000219a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000219b0: 2020 2020 5b30 2e2c 2030 2e5d 5d29 2c20      [0., 0.]]), 
+000219c0: 636f 6f72 6473 3d7b 2764 696d 3127 3a20  coords={'dim1': 
+000219d0: 6172 7261 7928 5b27 6127 2c20 2762 275d  array(['a', 'b']
+000219e0: 2c20 6474 7970 653d 6f62 6a65 6374 292c  , dtype=object),
+000219f0: 2027 6469 6d32 273a 2061 7272 6179 285b   'dim2': array([
+00021a00: 312c 2032 5d29 7d29 0a0a 2020 2020 2020  1, 2])})..      
+00021a10: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
+00021a20: 2020 2222 220a 2020 2020 2020 2020 6173    """.        as
+00021a30: 7365 7274 206c 656e 286b 7761 7267 7329  sert len(kwargs)
+00021a40: 203e 2030 0a20 2020 2020 2020 2061 7373   > 0.        ass
+00021a50: 6572 7420 616c 6c28 5b64 696d 2069 6e20  ert all([dim in 
+00021a60: 7365 6c66 2e64 696d 7320 666f 7220 6469  self.dims for di
+00021a70: 6d20 696e 206b 7761 7267 735d 290a 2020  m in kwargs]).  
+00021a80: 2020 2020 2020 6173 7365 7274 2061 6c6c        assert all
+00021a90: 285b 6973 696e 7374 616e 6365 286b 7761  ([isinstance(kwa
+00021aa0: 7267 735b 6469 6d5d 2c20 696e 7429 2066  rgs[dim], int) f
+00021ab0: 6f72 2064 696d 2069 6e20 6b77 6172 6773  or dim in kwargs
+00021ac0: 5d29 0a20 2020 2020 2020 206f 626a 203d  ]).        obj =
+00021ad0: 2073 656c 660a 2020 2020 2020 2020 666f   self.        fo
+00021ae0: 7220 6469 6d20 696e 206b 7761 7267 733a  r dim in kwargs:
+00021af0: 0a20 2020 2020 2020 2020 2020 206f 626a  .            obj
+00021b00: 203d 206f 626a 2e5f 7368 6966 745f 6f6e   = obj._shift_on
+00021b10: 655f 6469 6d28 6469 6d3d 6469 6d2c 2063  e_dim(dim=dim, c
+00021b20: 6f75 6e74 3d6b 7761 7267 735b 6469 6d5d  ount=kwargs[dim]
+00021b30: 2c20 6669 6c6c 5f76 616c 7565 3d66 696c  , fill_value=fil
+00021b40: 6c5f 7661 6c75 6529 0a20 2020 2020 2020  l_value).       
+00021b50: 2072 6574 7572 6e20 6f62 6a0a 0a20 2020   return obj..   
+00021b60: 2064 6566 205f 726f 6c6c 5f6f 6e65 5f64   def _roll_one_d
+00021b70: 696d 2873 656c 662c 2064 696d 3a20 7374  im(self, dim: st
+00021b80: 722c 2063 6f75 6e74 3a20 696e 7429 202d  r, count: int) -
+00021b90: 3e20 2741 7272 6179 273a 0a20 2020 2020  > 'Array':.     
+00021ba0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+00021bb0: 6f6c 6c20 7468 6520 4172 7261 7920 616c  oll the Array al
+00021bc0: 6f6e 6720 6120 7369 6e67 6c65 2064 696d  ong a single dim
+00021bd0: 656e 7369 6f6e 2e0a 0a20 2020 2020 2020  ension...       
+00021be0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+00021bf0: 2020 2064 696d 3a20 5468 6520 6469 6d65     dim: The dime
+00021c00: 6e73 696f 6e20 746f 2072 6f6c 6c2e 0a20  nsion to roll.. 
+00021c10: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
+00021c20: 3a20 5468 6520 6e75 6d62 6572 206f 6620  : The number of 
+00021c30: 706f 7369 7469 6f6e 7320 746f 2072 6f6c  positions to rol
+00021c40: 6c2e 2050 6f73 6974 6976 6520 7661 6c75  l. Positive valu
+00021c50: 6573 2072 6f6c 6c20 666f 7277 6172 642c  es roll forward,
+00021c60: 206e 6567 6174 6976 6520 7661 6c75 6573   negative values
+00021c70: 2072 6f6c 6c20 6261 636b 7761 7264 2e0a   roll backward..
+00021c80: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00021c90: 3a0a 2020 2020 2020 2020 2020 2020 4120  :.            A 
+00021ca0: 6e65 7720 4172 7261 7920 6f62 6a65 6374  new Array object
+00021cb0: 2077 6974 6820 7468 6520 726f 6c6c 6564   with the rolled
+00021cc0: 2076 616c 7565 732e 0a0a 2020 2020 2020   values...      
+00021cd0: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
+00021ce0: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
+00021cf0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00021d00: 2063 6f6f 7264 7320 3d20 7b27 6469 6d31   coords = {'dim1
+00021d10: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+00021d20: 6469 6d32 273a 205b 312c 2032 5d7d 0a20  dim2': [1, 2]}. 
+00021d30: 2020 2020 2020 2020 2020 203e 3e3e 206c             >>> l
+00021d40: 6f6e 6720 3d20 4c6f 6e67 2869 6e64 6578  ong = Long(index
+00021d50: 3d7b 2764 696d 3127 3a20 5b27 6127 2c20  ={'dim1': ['a', 
+00021d60: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
+00021d70: 2c20 325d 7d2c 2076 616c 7565 3d5b 3130  , 2]}, value=[10
+00021d80: 2c20 3230 5d29 0a20 2020 2020 2020 2020  , 20]).         
+00021d90: 2020 203e 3e3e 2061 7272 203d 2041 7272     >>> arr = Arr
+00021da0: 6179 2864 6174 613d 6c6f 6e67 2c20 636f  ay(data=long, co
+00021db0: 6f72 6473 3d63 6f6f 7264 7329 0a20 2020  ords=coords).   
+00021dc0: 2020 2020 2020 2020 203e 3e3e 2072 6f6c           >>> rol
+00021dd0: 6c65 645f 6172 7220 3d20 6172 722e 5f72  led_arr = arr._r
+00021de0: 6f6c 6c5f 6f6e 655f 6469 6d28 2764 696d  oll_one_dim('dim
+00021df0: 3127 2c20 636f 756e 743d 3129 0a20 2020  1', count=1).   
+00021e00: 2020 2020 2020 2020 203e 3e3e 2072 6f6c           >>> rol
+00021e10: 6c65 645f 6172 720a 2020 2020 2020 2020  led_arr.        
+00021e20: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
+00021e30: 7272 6179 285b 5b20 302e 2c20 3230 2e5d  rray([[ 0., 20.]
+00021e40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00021e50: 2020 2020 205b 3130 2e2c 2020 302e 5d5d       [10.,  0.]]
+00021e60: 292c 2063 6f6f 7264 733d 7b27 6469 6d31  ), coords={'dim1
+00021e70: 273a 2061 7272 6179 285b 2761 272c 2027  ': array(['a', '
+00021e80: 6227 5d2c 2064 7479 7065 3d6f 626a 6563  b'], dtype=objec
+00021e90: 7429 2c20 2764 696d 3227 3a20 6172 7261  t), 'dim2': arra
+00021ea0: 7928 5b31 2c20 325d 297d 290a 0a20 2020  y([1, 2])})..   
+00021eb0: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
+00021ec0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00021ed0: 2061 7373 6572 7420 6469 6d20 696e 2073   assert dim in s
+00021ee0: 656c 662e 6469 6d73 2c20 6622 7b64 696d  elf.dims, f"{dim
+00021ef0: 7d20 6e6f 7420 696e 2064 696d 733a 207b  } not in dims: {
+00021f00: 7365 6c66 2e64 696d 737d 220a 2020 2020  self.dims}".    
+00021f10: 2020 2020 6173 7365 7274 2069 7369 6e73      assert isins
+00021f20: 7461 6e63 6528 636f 756e 742c 2069 6e74  tance(count, int
+00021f30: 292c 2066 227b 636f 756e 747d 206d 7573  ), f"{count} mus
+00021f40: 7420 6265 2069 6e74 220a 2020 2020 2020  t be int".      
+00021f50: 2020 6178 203d 2073 656c 662e 6469 6d73    ax = self.dims
+00021f60: 2e69 6e64 6578 2864 696d 290a 2020 2020  .index(dim).    
+00021f70: 2020 2020 6461 7461 203d 206e 702e 726f      data = np.ro
+00021f80: 6c6c 2873 656c 662e 6461 7461 2c20 7368  ll(self.data, sh
+00021f90: 6966 743d 636f 756e 742c 2061 7869 733d  ift=count, axis=
+00021fa0: 6178 290a 2020 2020 2020 2020 7265 7475  ax).        retu
+00021fb0: 726e 2073 656c 662e 5f70 6f73 745f 6f70  rn self._post_op
+00021fc0: 6572 6174 696f 6e28 6461 7461 2c20 7365  eration(data, se
+00021fd0: 6c66 2e63 6f6f 7264 7329 0a0a 2020 2020  lf.coords)..    
+00021fe0: 6465 6620 726f 6c6c 2873 656c 662c 202a  def roll(self, *
+00021ff0: 2a6b 7761 7267 733a 2069 6e74 2920 2d3e  *kwargs: int) ->
+00022000: 2027 4172 7261 7927 3a0a 2020 2020 2020   'Array':.      
+00022010: 2020 2222 220a 2020 2020 2020 2020 526f    """.        Ro
+00022020: 6c6c 2074 6865 2041 7272 6179 2061 6c6f  ll the Array alo
+00022030: 6e67 2073 7065 6369 6669 6564 2064 696d  ng specified dim
+00022040: 656e 7369 6f6e 732e 0a0a 2020 2020 2020  ensions...      
+00022050: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+00022060: 2020 2020 2a2a 6b77 6172 6773 3a20 4b65      **kwargs: Ke
+00022070: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
+00022080: 7370 6563 6966 7969 6e67 2074 6865 2064  specifying the d
+00022090: 696d 656e 7369 6f6e 7320 616e 6420 7468  imensions and th
+000220a0: 6520 6e75 6d62 6572 206f 6620 706f 7369  e number of posi
+000220b0: 7469 6f6e 7320 746f 2072 6f6c 6c2e 0a0a  tions to roll...
+000220c0: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
+000220d0: 0a20 2020 2020 2020 2020 2020 2041 206e  .            A n
+000220e0: 6577 2041 7272 6179 206f 626a 6563 7420  ew Array object 
+000220f0: 7769 7468 2074 6865 2072 6f6c 6c65 6420  with the rolled 
+00022100: 7661 6c75 6573 2e0a 0a20 2020 2020 2020  values...       
+00022110: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
+00022120: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+00022130: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00022140: 636f 6f72 6473 203d 207b 2764 696d 3127  coords = {'dim1'
+00022150: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+00022160: 696d 3227 3a20 5b31 2c20 325d 7d0a 2020  im2': [1, 2]}.  
+00022170: 2020 2020 2020 2020 2020 3e3e 3e20 6c6f            >>> lo
+00022180: 6e67 203d 204c 6f6e 6728 696e 6465 783d  ng = Long(index=
+00022190: 7b27 6469 6d31 273a 205b 2761 272c 2027  {'dim1': ['a', '
+000221a0: 6227 5d2c 2027 6469 6d32 273a 205b 312c  b'], 'dim2': [1,
+000221b0: 2032 5d7d 2c20 7661 6c75 653d 5b31 302c   2]}, value=[10,
+000221c0: 2032 305d 290a 2020 2020 2020 2020 2020   20]).          
+000221d0: 2020 3e3e 3e20 6172 7220 3d20 4172 7261    >>> arr = Arra
+000221e0: 7928 6461 7461 3d6c 6f6e 672c 2063 6f6f  y(data=long, coo
+000221f0: 7264 733d 636f 6f72 6473 290a 2020 2020  rds=coords).    
+00022200: 2020 2020 2020 2020 3e3e 3e20 726f 6c6c          >>> roll
+00022210: 6564 5f61 7272 203d 2061 7272 2e72 6f6c  ed_arr = arr.rol
+00022220: 6c28 6469 6d31 3d31 2c20 6469 6d32 3d2d  l(dim1=1, dim2=-
+00022230: 3129 0a20 2020 2020 2020 2020 2020 203e  1).            >
+00022240: 3e3e 2072 6f6c 6c65 645f 6172 720a 2020  >> rolled_arr.  
+00022250: 2020 2020 2020 2020 2020 4172 7261 7928            Array(
+00022260: 6461 7461 3d61 7272 6179 285b 5b32 302e  data=array([[20.
+00022270: 2c20 2030 2e5d 2c0a 2020 2020 2020 2020  ,  0.],.        
+00022280: 2020 2020 2020 2020 2020 205b 2030 2e2c             [ 0.,
+00022290: 2031 302e 5d5d 292c 2063 6f6f 7264 733d   10.]]), coords=
+000222a0: 7b27 6469 6d31 273a 2061 7272 6179 285b  {'dim1': array([
+000222b0: 2761 272c 2027 6227 5d2c 2064 7479 7065  'a', 'b'], dtype
+000222c0: 3d6f 626a 6563 7429 2c20 2764 696d 3227  =object), 'dim2'
+000222d0: 3a20 6172 7261 7928 5b31 2c20 325d 297d  : array([1, 2])}
+000222e0: 290a 0a20 2020 2020 2020 2020 2020 2060  )..            `
+000222f0: 6060 0a20 2020 2020 2020 2022 2222 0a20  ``.        """. 
+00022300: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+00022310: 6e28 6b77 6172 6773 2920 3e20 302c 2022  n(kwargs) > 0, "
+00022320: 4d75 7374 2073 7065 6369 6679 2061 7420  Must specify at 
+00022330: 6c65 6173 7420 6f6e 6520 6469 6d65 6e73  least one dimens
+00022340: 696f 6e20 746f 2072 6f6c 6c22 0a20 2020  ion to roll".   
+00022350: 2020 2020 2061 7373 6572 7420 616c 6c28       assert all(
+00022360: 5b64 696d 2069 6e20 7365 6c66 2e64 696d  [dim in self.dim
+00022370: 7320 666f 7220 6469 6d20 696e 206b 7761  s for dim in kwa
+00022380: 7267 735d 292c 2066 227b 6b77 6172 6773  rgs]), f"{kwargs
+00022390: 7d20 6e6f 7420 696e 2064 696d 733a 207b  } not in dims: {
+000223a0: 7365 6c66 2e64 696d 737d 220a 2020 2020  self.dims}".    
+000223b0: 2020 2020 6173 7365 7274 2061 6c6c 285b      assert all([
+000223c0: 6973 696e 7374 616e 6365 286b 7761 7267  isinstance(kwarg
+000223d0: 735b 6469 6d5d 2c20 696e 7429 2066 6f72  s[dim], int) for
+000223e0: 2064 696d 2069 6e20 6b77 6172 6773 5d29   dim in kwargs])
+000223f0: 2c20 6622 416c 6c20 7661 6c75 6573 2069  , f"All values i
+00022400: 6e20 7b6b 7761 7267 737d 206d 7573 7420  n {kwargs} must 
+00022410: 6265 2069 6e74 6567 6572 7322 0a20 2020  be integers".   
+00022420: 2020 2020 206f 626a 203d 2073 656c 660a       obj = self.
+00022430: 2020 2020 2020 2020 666f 7220 6469 6d20          for dim 
+00022440: 696e 206b 7761 7267 733a 0a20 2020 2020  in kwargs:.     
+00022450: 2020 2020 2020 206f 626a 203d 206f 626a         obj = obj
+00022460: 2e5f 726f 6c6c 5f6f 6e65 5f64 696d 2864  ._roll_one_dim(d
+00022470: 696d 3d64 696d 2c20 636f 756e 743d 6b77  im=dim, count=kw
+00022480: 6172 6773 5b64 696d 5d29 0a20 2020 2020  args[dim]).     
+00022490: 2020 2072 6574 7572 6e20 6f62 6a0a 0a20     return obj.. 
+000224a0: 2020 2064 6566 2069 6e73 6572 7428 7365     def insert(se
+000224b0: 6c66 2c20 2a2a 6b77 6172 6773 3a20 556e  lf, **kwargs: Un
+000224c0: 696f 6e5b 6e70 2e64 7479 7065 2c20 7479  ion[np.dtype, ty
+000224d0: 7065 2c20 7374 722c 2069 6e74 2c20 666c  pe, str, int, fl
+000224e0: 6f61 742c 2044 6963 745b 7374 722c 2055  oat, Dict[str, U
+000224f0: 6e69 6f6e 5b44 6963 745b 7374 722c 2041  nion[Dict[str, A
+00022500: 6e79 5d2c 204c 6973 745b 556e 696f 6e5b  ny], List[Union[
+00022510: 4c69 7374 5b73 7472 5d2c 204c 6973 745b  List[str], List[
+00022520: 416e 795d 5d5d 5d5d 5d29 202d 3e20 2741  Any]]]]]]) -> 'A
+00022530: 7272 6179 273a 0a20 2020 2020 2020 2022  rray':.        "
+00022540: 2222 0a20 2020 2020 2020 2049 6e73 6572  "".        Inser
+00022550: 7420 6e65 7720 6469 6d65 6e73 696f 6e73  t new dimensions
+00022560: 2069 6e74 6f20 7468 6520 4172 7261 792e   into the Array.
+00022570: 2054 6865 7265 2061 7265 2066 6f75 7220   There are four 
+00022580: 6772 6f75 7073 206f 6620 7661 6c75 6573  groups of values
+00022590: 2074 6861 7420 6361 6e20 6265 2069 6e73   that can be ins
+000225a0: 6572 7465 643a 0a0a 2020 2020 2020 2020  erted:..        
+000225b0: 2d20 7374 722c 2069 6e74 2c20 666c 6f61  - str, int, floa
+000225c0: 740a 0a20 2020 2020 2020 202d 2064 6963  t..        - dic
+000225d0: 7420 6f66 2064 6963 7420 6f72 2064 6963  t of dict or dic
+000225e0: 7420 6f66 206c 6973 740a 0a20 2020 2020  t of list..     
+000225f0: 2020 202d 206c 6973 7420 6f66 2073 7472     - list of str
+00022600: 2074 6861 7420 7265 7072 6573 656e 7473   that represents
+00022610: 2063 7572 7265 6e74 2064 696d 656e 7369   current dimensi
+00022620: 6f6e 730a 0a20 2020 2020 2020 202d 206e  ons..        - n
+00022630: 702e 6474 7970 652c 2074 7970 650a 0a20  p.dtype, type.. 
+00022640: 2020 2020 2020 2043 6173 6520 313a 2073         Case 1: s
+00022650: 7472 2c20 696e 742c 2066 6c6f 6174 2061  tr, int, float a
+00022660: 7265 2076 616c 6964 2066 6f72 206e 6f6e  re valid for non
+00022670: 2d65 6d70 7479 2061 7272 6179 732e 2049  -empty arrays. I
+00022680: 6e20 7468 6973 2063 6173 652c 2077 6520  n this case, we 
+00022690: 696e 7365 7274 2061 206e 6577 2064 696d  insert a new dim
+000226a0: 656e 7369 6f6e 2077 6974 6820 6f6e 6c79  ension with only
+000226b0: 206f 6e65 2065 6c65 6d65 6e74 2e0a 2020   one element..  
+000226c0: 2020 2020 2020 4361 7365 2032 2061 6e64        Case 2 and
+000226d0: 2033 3a20 6469 6374 206f 6620 6469 6374   3: dict of dict
+000226e0: 206f 7220 6469 6374 206f 6620 6c69 7374   or dict of list
+000226f0: 2061 7265 2076 616c 6964 2066 6f72 206e   are valid for n
+00022700: 6f6e 2d65 6d70 7479 2061 7272 6179 732e  on-empty arrays.
+00022710: 2049 6e20 7468 6973 2063 6173 652c 2077   In this case, w
+00022720: 6520 696e 7365 7274 2061 206e 6577 2064  e insert a new d
+00022730: 696d 656e 7369 6f6e 2077 6869 6368 2069  imension which i
+00022740: 7320 6d61 7070 6564 2062 6173 6564 206f  s mapped based o
+00022750: 6e20 6120 6578 6973 7469 6e67 2064 696d  n a existing dim
+00022760: 656e 7369 6f6e 2063 6f6f 7264 696e 6174  ension coordinat
+00022770: 6573 2e0a 2020 2020 2020 2020 4361 7365  es..        Case
+00022780: 2034 3a20 6c69 7374 206f 6620 7374 7220   4: list of str 
+00022790: 6172 6520 7661 6c69 6420 666f 7220 6e6f  are valid for no
+000227a0: 6e2d 656d 7074 7920 6172 7261 7973 2e20  n-empty arrays. 
+000227b0: 496e 2074 6869 7320 6361 7365 2c20 7765  In this case, we
+000227c0: 2069 6e73 6572 7420 6120 6e65 7720 6469   insert a new di
+000227d0: 6d65 6e73 696f 6e20 7769 7468 2074 6865  mension with the
+000227e0: 2063 6f6e 6361 7465 6e61 7469 6f6e 206f   concatenation o
+000227f0: 6620 656c 656d 656e 7473 206f 6620 7468  f elements of th
+00022800: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
+00022810: 6469 6d73 2069 6e20 7468 6520 6c69 7374  dims in the list
+00022820: 2e0a 2020 2020 2020 2020 4361 7365 2035  ..        Case 5
+00022830: 3a20 7479 7065 7320 6172 6520 6f6e 6c79  : types are only
+00022840: 2076 616c 6964 2066 6f72 2065 6d70 7479   valid for empty
+00022850: 2061 7272 6179 732e 2049 6e20 6f72 6465   arrays. In orde
+00022860: 7220 746f 2069 6e73 6572 7420 6120 6469  r to insert a di
+00022870: 6d65 6e73 696f 6e20 7769 7468 2061 2064  mension with a d
+00022880: 7479 7065 2c20 7765 206e 6565 6420 746f  type, we need to
+00022890: 2063 7265 6174 6520 616e 2065 6d70 7479   create an empty
+000228a0: 2061 7272 6179 0a0a 2020 2020 2020 2020   array..        
+000228b0: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+000228c0: 2020 2a2a 6b77 6172 6773 3a20 4b65 7977    **kwargs: Keyw
+000228d0: 6f72 6420 6172 6775 6d65 6e74 7320 7370  ord arguments sp
+000228e0: 6563 6966 7969 6e67 2074 6865 206e 6577  ecifying the new
+000228f0: 2064 696d 656e 7369 6f6e 7320 616e 6420   dimensions and 
+00022900: 7468 6569 7220 7661 6c75 6573 2e0a 0a20  their values... 
+00022910: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
+00022920: 2020 2020 2020 2020 2020 2020 4120 6e65              A ne
+00022930: 7720 4172 7261 7920 6f62 6a65 6374 2077  w Array object w
+00022940: 6974 6820 7468 6520 696e 7365 7274 6564  ith the inserted
+00022950: 2064 696d 656e 7369 6f6e 732e 0a0a 2020   dimensions...  
+00022960: 2020 2020 2020 4578 616d 706c 653a 0a20        Example:. 
+00022970: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
+00022980: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
+00022990: 203e 3e3e 2023 2043 6173 6520 313a 2073   >>> # Case 1: s
+000229a0: 7472 2c20 696e 742c 2066 6c6f 6174 0a0a  tr, int, float..
+000229b0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+000229c0: 6172 7220 3d20 4172 7261 7928 6461 7461  arr = Array(data
+000229d0: 3d28 7b27 6469 6d31 273a 5b27 6127 2c27  =({'dim1':['a','
+000229e0: 6227 5d2c 2027 6469 6d32 273a 5b31 2c32  b'], 'dim2':[1,2
+000229f0: 5d7d 2c5b 312e 302c 2032 2e30 5d29 2c20  ]},[1.0, 2.0]), 
+00022a00: 636f 6f72 6473 3d7b 2764 696d 3127 3a5b  coords={'dim1':[
+00022a10: 2761 272c 2762 275d 2c20 2764 696d 3227  'a','b'], 'dim2'
+00022a20: 3a5b 312c 325d 7d29 0a0a 2020 2020 2020  :[1,2]})..      
+00022a30: 2020 2020 2020 3e3e 3e20 6e65 775f 6172        >>> new_ar
+00022a40: 7220 3d20 6172 722e 696e 7365 7274 2864  r = arr.insert(d
+00022a50: 696d 333d 2763 2729 0a0a 2020 2020 2020  im3='c')..      
+00022a60: 2020 2020 2020 3e3e 3e20 6e65 775f 6172        >>> new_ar
+00022a70: 720a 2020 2020 2020 2020 2020 2020 4172  r.            Ar
+00022a80: 7261 7928 6461 7461 3d61 7272 6179 285b  ray(data=array([
+00022a90: 5b5b 312e 2c20 302e 5d2c 0a20 2020 2020  [[1., 0.],.     
+00022aa0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00022ab0: 302e 2c20 322e 5d5d 5d29 2c20 636f 6f72  0., 2.]]]), coor
+00022ac0: 6473 3d7b 2764 696d 3327 3a20 6172 7261  ds={'dim3': arra
+00022ad0: 7928 5b27 6327 5d2c 2064 7479 7065 3d6f  y(['c'], dtype=o
+00022ae0: 626a 6563 7429 2c20 2764 696d 3127 3a20  bject), 'dim1': 
+00022af0: 6172 7261 7928 5b27 6127 2c20 2762 275d  array(['a', 'b']
+00022b00: 2c20 6474 7970 653d 6f62 6a65 6374 292c  , dtype=object),
+00022b10: 2027 6469 6d32 273a 2061 7272 6179 285b   'dim2': array([
+00022b20: 312c 2032 5d29 7d29 0a0a 2020 2020 2020  1, 2])})..      
+00022b30: 2020 2020 2020 3e3e 3e20 2320 4361 7365        >>> # Case
+00022b40: 2032 3a20 6469 6374 206f 6620 6469 6374   2: dict of dict
+00022b50: 0a0a 2020 2020 2020 2020 2020 2020 3e3e  ..            >>
+00022b60: 3e20 6172 7220 3d20 4172 7261 7928 6461  > arr = Array(da
+00022b70: 7461 3d28 7b27 6469 6d31 273a 5b27 6127  ta=({'dim1':['a'
+00022b80: 2c27 6227 5d2c 2027 6469 6d32 273a 5b31  ,'b'], 'dim2':[1
+00022b90: 2c32 5d7d 2c5b 312e 302c 2032 2e30 5d29  ,2]},[1.0, 2.0])
+00022ba0: 2c20 636f 6f72 6473 3d7b 2764 696d 3127  , coords={'dim1'
+00022bb0: 3a5b 2761 272c 2762 275d 2c20 2764 696d  :['a','b'], 'dim
+00022bc0: 3227 3a5b 312c 325d 7d29 0a0a 2020 2020  2':[1,2]})..    
+00022bd0: 2020 2020 2020 2020 3e3e 3e20 6e65 775f          >>> new_
+00022be0: 6172 7220 3d20 6172 722e 696e 7365 7274  arr = arr.insert
+00022bf0: 2864 696d 333d 7b27 6469 6d31 273a 7b27  (dim3={'dim1':{'
+00022c00: 6127 3a27 6327 2c20 2762 273a 2763 277d  a':'c', 'b':'c'}
+00022c10: 7d29 0a0a 2020 2020 2020 2020 2020 2020  })..            
+00022c20: 3e3e 3e20 2320 4361 7365 2033 3a20 6469  >>> # Case 3: di
+00022c30: 6374 206f 6620 6c69 7374 0a0a 2020 2020  ct of list..    
+00022c40: 2020 2020 2020 2020 3e3e 3e20 6e65 775f          >>> new_
+00022c50: 6172 7220 3d20 6172 722e 696e 7365 7274  arr = arr.insert
+00022c60: 2864 696d 333d 7b27 6469 6d31 273a 5b5b  (dim3={'dim1':[[
+00022c70: 2761 272c 2762 275d 2c5b 2763 272c 2027  'a','b'],['c', '
+00022c80: 6327 5d5d 7d29 0a0a 2020 2020 2020 2020  c']]})..        
+00022c90: 2020 2020 3e3e 3e20 6e65 775f 6172 720a      >>> new_arr.
+00022ca0: 2020 2020 2020 2020 2020 2020 4172 7261              Arra
+00022cb0: 7928 6461 7461 3d61 7272 6179 285b 5b5b  y(data=array([[[
+00022cc0: 312e 2c20 302e 5d2c 0a20 2020 2020 2020  1., 0.],.       
+00022cd0: 2020 2020 2020 2020 2020 2020 205b 302e               [0.
+00022ce0: 2c20 322e 5d5d 5d29 2c20 636f 6f72 6473  , 2.]]]), coords
+00022cf0: 3d7b 2764 696d 3327 3a20 6172 7261 7928  ={'dim3': array(
+00022d00: 5b27 6327 5d2c 2064 7479 7065 3d6f 626a  ['c'], dtype=obj
+00022d10: 6563 7429 2c20 2764 696d 3127 3a20 6172  ect), 'dim1': ar
+00022d20: 7261 7928 5b27 6127 2c20 2762 275d 2c20  ray(['a', 'b'], 
+00022d30: 6474 7970 653d 6f62 6a65 6374 292c 2027  dtype=object), '
+00022d40: 6469 6d32 273a 2061 7272 6179 285b 312c  dim2': array([1,
+00022d50: 2032 5d29 7d29 0a0a 2020 2020 2020 2020   2])})..        
+00022d60: 2020 2020 3e3e 3e20 2320 4361 7365 2034      >>> # Case 4
+00022d70: 3a20 6c69 7374 206f 6620 6469 6d73 2028  : list of dims (
+00022d80: 7374 7229 0a0a 2020 2020 2020 2020 2020  str)..          
+00022d90: 2020 3e3e 3e20 6172 7220 3d20 4172 7261    >>> arr = Arra
+00022da0: 7928 6461 7461 3d28 7b27 6469 6d31 273a  y(data=({'dim1':
+00022db0: 5b27 6127 2c27 6227 5d2c 2027 6469 6d32  ['a','b'], 'dim2
+00022dc0: 273a 5b31 2c32 5d7d 2c5b 312e 302c 2032  ':[1,2]},[1.0, 2
+00022dd0: 2e30 5d29 2c20 636f 6f72 6473 3d7b 2764  .0]), coords={'d
+00022de0: 696d 3127 3a5b 2761 272c 2762 275d 2c20  im1':['a','b'], 
+00022df0: 2764 696d 3227 3a5b 312c 325d 7d29 0a0a  'dim2':[1,2]})..
+00022e00: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00022e10: 6e65 775f 6172 7220 3d20 6172 722e 696e  new_arr = arr.in
+00022e20: 7365 7274 2864 696d 333d 5b27 6469 6d31  sert(dim3=['dim1
+00022e30: 272c 2027 6469 6d32 275d 290a 0a20 2020  ', 'dim2'])..   
+00022e40: 2020 2020 2020 2020 203e 3e3e 206e 6577           >>> new
+00022e50: 5f61 7272 0a20 2020 2020 2020 2020 2020  _arr.           
+00022e60: 2041 7272 6179 2864 6174 613d 6172 7261   Array(data=arra
+00022e70: 7928 5b5b 5b31 2e2c 2030 2e5d 2c0a 2020  y([[[1., 0.],.  
+00022e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e90: 2020 5b30 2e2c 2030 2e5d 5d2c 0a20 2020    [0., 0.]],.   
+00022ea0: 2020 2020 2020 2020 203c 424c 414e 4b4c           <BLANKL
+00022eb0: 494e 453e 0a20 2020 2020 2020 2020 2020  INE>.           
+00022ec0: 2020 2020 2020 2020 5b5b 302e 2c20 302e          [[0., 0.
+00022ed0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00022ee0: 2020 2020 2020 205b 302e 2c20 302e 5d5d         [0., 0.]]
+00022ef0: 2c0a 2020 2020 2020 2020 2020 2020 3c42  ,.            <B
+00022f00: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2020  LANKLINE>.      
+00022f10: 2020 2020 2020 2020 2020 2020 205b 5b30               [[0
+00022f20: 2e2c 2030 2e5d 2c0a 2020 2020 2020 2020  ., 0.],.        
+00022f30: 2020 2020 2020 2020 2020 2020 5b30 2e2c              [0.,
+00022f40: 2030 2e5d 5d2c 0a20 2020 2020 2020 2020   0.]],.         
+00022f50: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+00022f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f70: 2020 5b5b 302e 2c20 302e 5d2c 0a20 2020    [[0., 0.],.   
+00022f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f90: 205b 302e 2c20 322e 5d5d 5d29 2c20 636f   [0., 2.]]]), co
+00022fa0: 6f72 6473 3d7b 2764 696d 3327 3a20 6172  ords={'dim3': ar
+00022fb0: 7261 7928 5b27 613a 3127 2c20 2761 3a32  ray(['a:1', 'a:2
+00022fc0: 272c 2027 623a 3127 2c20 2762 3a32 275d  ', 'b:1', 'b:2']
+00022fd0: 2c20 6474 7970 653d 6f62 6a65 6374 292c  , dtype=object),
+00022fe0: 2027 6469 6d31 273a 2061 7272 6179 285b   'dim1': array([
+00022ff0: 2761 272c 2027 6227 5d2c 2064 7479 7065  'a', 'b'], dtype
+00023000: 3d6f 626a 6563 7429 2c20 2764 696d 3227  =object), 'dim2'
+00023010: 3a20 6172 7261 7928 5b31 2c20 325d 297d  : array([1, 2])}
+00023020: 290a 0a20 2020 2020 2020 2020 2020 203e  )..            >
+00023030: 3e3e 2023 2043 6173 6520 353a 2074 7970  >> # Case 5: typ
+00023040: 6573 0a0a 2020 2020 2020 2020 2020 2020  es..            
+00023050: 3e3e 3e20 6172 7220 3d20 4172 7261 7928  >>> arr = Array(
+00023060: 6461 7461 3d28 7b27 6469 6d31 273a 5b5d  data=({'dim1':[]
+00023070: 2c20 2764 696d 3227 3a5b 5d7d 2c5b 5d29  , 'dim2':[]},[])
+00023080: 2c20 636f 6f72 6473 3d7b 2764 696d 3127  , coords={'dim1'
+00023090: 3a5b 5d2c 2027 6469 6d32 273a 5b5d 7d29  :[], 'dim2':[]})
+000230a0: 0a0a 2020 2020 2020 2020 2020 2020 3e3e  ..            >>
+000230b0: 3e20 6e65 775f 6172 7220 3d20 6172 722e  > new_arr = arr.
+000230c0: 696e 7365 7274 2864 696d 333d 6e70 2e64  insert(dim3=np.d
+000230d0: 7479 7065 2827 696e 7436 3427 2929 0a0a  type('int64'))..
+000230e0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+000230f0: 6e65 775f 6172 720a 2020 2020 2020 2020  new_arr.        
+00023100: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
+00023110: 7272 6179 285b 5d2c 2073 6861 7065 3d28  rray([], shape=(
+00023120: 302c 2030 2c20 3029 292c 2063 6f6f 7264  0, 0, 0)), coord
+00023130: 733d 7b27 6469 6d33 273a 2061 7272 6179  s={'dim3': array
+00023140: 285b 5d29 2c20 2764 696d 3127 3a20 6172  ([]), 'dim1': ar
+00023150: 7261 7928 5b5d 292c 2027 6469 6d32 273a  ray([]), 'dim2':
+00023160: 2061 7272 6179 285b 5d29 7d29 0a0a 2020   array([])})..  
+00023170: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
+00023180: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00023190: 2020 636f 6f72 6473 203d 207b 7d0a 2020    coords = {}.  
+000231a0: 2020 2020 2020 666f 7220 6e65 775f 6469        for new_di
+000231b0: 6d20 696e 206b 7761 7267 733a 0a20 2020  m in kwargs:.   
+000231c0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+000231d0: 6e65 775f 6469 6d20 6e6f 7420 696e 2073  new_dim not in s
+000231e0: 656c 662e 6469 6d73 2c20 6622 6e65 7720  elf.dims, f"new 
+000231f0: 6469 6d65 6e73 696f 6e20 6e61 6d65 2027  dimension name '
+00023200: 7b6e 6577 5f64 696d 7d27 206d 7573 7420  {new_dim}' must 
+00023210: 6e6f 7420 6578 6973 7420 696e 2074 6865  not exist in the
+00023220: 2065 7869 7374 696e 6720 6469 6d65 6e73   existing dimens
+00023230: 696f 6e73 220a 2020 2020 2020 2020 2020  ions".          
+00023240: 2020 7661 6c75 6520 3d20 6b77 6172 6773    value = kwargs
+00023250: 5b6e 6577 5f64 696d 5d0a 2020 2020 2020  [new_dim].      
+00023260: 2020 2020 2020 2320 6474 7970 6520 6f72        # dtype or
+00023270: 2074 7970 6520 6f6e 6c79 2077 6f72 6b73   type only works
+00023280: 2066 6f72 2066 6f72 2065 6d70 7479 2061   for for empty a
+00023290: 7272 6179 732e 2049 6e20 6f72 6465 7220  rrays. In order 
+000232a0: 746f 2069 6e73 6572 7420 6120 6469 6d65  to insert a dime
+000232b0: 6e73 696f 6e20 7769 7468 2061 2064 7479  nsion with a dty
+000232c0: 7065 2c20 7765 206e 6565 6420 746f 2063  pe, we need to c
+000232d0: 7265 6174 6520 616e 2065 6d70 7479 2061  reate an empty a
+000232e0: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+000232f0: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
+00023300: 616c 7565 2c20 286e 702e 6474 7970 652c  alue, (np.dtype,
+00023310: 2074 7970 6529 293a 0a20 2020 2020 2020   type)):.       
+00023320: 2020 2020 2020 2020 2066 6967 7572 6573           figures
+00023330: 203d 206e 702e 6172 7261 7928 5b5d 2c20   = np.array([], 
+00023340: 6474 7970 653d 7661 6c75 6529 0a20 2020  dtype=value).   
+00023350: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+00023360: 7264 735b 6e65 775f 6469 6d5d 203d 205f  rds[new_dim] = _
+00023370: 7465 7374 5f74 7970 655f 616e 645f 7570  test_type_and_up
+00023380: 6461 7465 2866 6967 7572 6573 290a 2020  date(figures).  
+00023390: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+000233a0: 7369 6e73 7461 6e63 6528 7661 6c75 652c  sinstance(value,
+000233b0: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
+000233c0: 2020 2020 2020 2063 6f6f 7264 735b 6e65         coords[ne
+000233d0: 775f 6469 6d5d 203d 206e 702e 6172 7261  w_dim] = np.arra
+000233e0: 7928 5b76 616c 7565 5d2c 2064 7479 7065  y([value], dtype
+000233f0: 3d6e 702e 6f62 6a65 6374 5f29 0a20 2020  =np.object_).   
+00023400: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
+00023410: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
+00023420: 696e 7429 3a0a 2020 2020 2020 2020 2020  int):.          
+00023430: 2020 2020 2020 636f 6f72 6473 5b6e 6577        coords[new
+00023440: 5f64 696d 5d20 3d20 6e70 2e61 7272 6179  _dim] = np.array
+00023450: 285b 7661 6c75 655d 2c20 6474 7970 653d  ([value], dtype=
+00023460: 6e70 2e69 6e74 3332 290a 2020 2020 2020  np.int32).      
+00023470: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00023480: 7461 6e63 6528 7661 6c75 652c 2066 6c6f  tance(value, flo
+00023490: 6174 293a 0a20 2020 2020 2020 2020 2020  at):.           
+000234a0: 2020 2020 2063 6f6f 7264 735b 6e65 775f       coords[new_
+000234b0: 6469 6d5d 203d 206e 702e 6172 7261 7928  dim] = np.array(
+000234c0: 5b76 616c 7565 5d2c 2064 7479 7065 3d6e  [value], dtype=n
+000234d0: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
+000234e0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+000234f0: 7374 616e 6365 2876 616c 7565 2c20 6469  stance(value, di
+00023500: 6374 293a 0a20 2020 2020 2020 2020 2020  ct):.           
+00023510: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+00023520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023530: 2020 2020 2076 616c 7565 2920 3d3d 2031       value) == 1
+00023540: 2c20 6622 5661 6c75 6520 6173 736f 6369  , f"Value associ
+00023550: 6174 6564 2077 6974 6820 277b 6e65 775f  ated with '{new_
+00023560: 6469 6d7d 2720 6d75 7374 2062 6520 6120  dim}' must be a 
+00023570: 6469 6374 2077 6974 6820 6f6e 6520 6b65  dict with one ke
+00023580: 792e 2047 6f74 207b 7661 6c75 657d 220a  y. Got {value}".
+00023590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000235a0: 6578 6973 7469 6e67 5f64 696d 203d 206e  existing_dim = n
+000235b0: 6578 7428 6974 6572 2876 616c 7565 2929  ext(iter(value))
+000235c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000235d0: 2061 7373 6572 7420 6973 696e 7374 616e   assert isinstan
+000235e0: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
+000235f0: 2020 2020 2020 2020 6578 6973 7469 6e67          existing
+00023600: 5f64 696d 2c20 7374 7229 2c20 6622 5661  _dim, str), f"Va
+00023610: 6c75 6520 6173 736f 6369 6174 6564 2077  lue associated w
+00023620: 6974 6820 277b 6e65 775f 6469 6d7d 2720  ith '{new_dim}' 
+00023630: 6d75 7374 2062 6520 6120 7374 722e 2047  must be a str. G
+00023640: 6f74 207b 7479 7065 2865 7869 7374 696e  ot {type(existin
+00023650: 675f 6469 6d29 7d22 0a20 2020 2020 2020  g_dim)}".       
+00023660: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+00023670: 6578 6973 7469 6e67 5f64 696d 2069 6e20  existing_dim in 
+00023680: 7365 6c66 2e64 696d 732c 2066 2256 616c  self.dims, f"Val
+00023690: 7565 2061 7373 6f63 6961 7465 6420 7769  ue associated wi
+000236a0: 7468 2027 7b6e 6577 5f64 696d 7d27 2061  th '{new_dim}' a
+000236b0: 6e64 2027 7b65 7869 7374 696e 675f 6469  nd '{existing_di
+000236c0: 6d7d 2720 6d75 7374 2062 6520 696e 207b  m}' must be in {
+000236d0: 7365 6c66 2e64 696d 737d 220a 2020 2020  self.dims}".    
+000236e0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+000236f0: 7274 2069 7369 6e73 7461 6e63 6528 7661  rt isinstance(va
+00023700: 6c75 655b 6578 6973 7469 6e67 5f64 696d  lue[existing_dim
+00023710: 5d2c 2028 0a20 2020 2020 2020 2020 2020  ], (.           
+00023720: 2020 2020 2020 2020 2064 6963 742c 206c           dict, l
+00023730: 6973 7429 292c 2066 2256 616c 7565 2061  ist)), f"Value a
+00023740: 7373 6f63 6961 7465 6420 7769 7468 2027  ssociated with '
+00023750: 7b6e 6577 5f64 696d 7d27 2061 6e64 2027  {new_dim}' and '
+00023760: 7b65 7869 7374 696e 675f 6469 6d7d 2720  {existing_dim}' 
+00023770: 6d75 7374 2062 6520 6120 6469 6374 206f  must be a dict o
+00023780: 7220 6c69 7374 2e20 476f 7420 7b74 7970  r list. Got {typ
+00023790: 6528 7661 6c75 655b 6578 6973 7469 6e67  e(value[existing
+000237a0: 5f64 696d 5d29 7d22 0a20 2020 2020 2020  _dim])}".       
+000237b0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+000237c0: 7374 616e 6365 2876 616c 7565 5b65 7869  stance(value[exi
+000237d0: 7374 696e 675f 6469 6d5d 2c20 6469 6374  sting_dim], dict
+000237e0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000237f0: 2020 2020 2020 206f 6c64 5f64 696d 5f69         old_dim_i
+00023800: 7465 6d73 5f73 6574 203d 2073 6574 2876  tems_set = set(v
+00023810: 616c 7565 5b65 7869 7374 696e 675f 6469  alue[existing_di
+00023820: 6d5d 290a 2020 2020 2020 2020 2020 2020  m]).            
+00023830: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
+00023840: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+00023850: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00023860: 2e63 6f6f 7264 735b 6578 6973 7469 6e67  .coords[existing
+00023870: 5f64 696d 5d29 203d 3d20 6f6c 645f 6469  _dim]) == old_di
+00023880: 6d5f 6974 656d 735f 7365 742c 2066 2241  m_items_set, f"A
+00023890: 6c6c 2069 7465 6d73 2061 7373 6f63 6961  ll items associa
+000238a0: 7465 6420 7769 7468 2027 7b6e 6577 5f64  ted with '{new_d
+000238b0: 696d 7d27 206d 7573 7420 6d61 7463 6820  im}' must match 
+000238c0: 656c 656d 656e 7473 2069 6e20 2e63 6f6f  elements in .coo
+000238d0: 7264 735b 277b 6578 6973 7469 6e67 5f64  rds['{existing_d
+000238e0: 696d 7d27 5d2e 2054 6865 2063 7572 7265  im}']. The curre
+000238f0: 6e74 206d 6170 7069 6e67 2064 6963 7469  nt mapping dicti
+00023900: 6f6e 6172 7920 6265 7477 6565 6e20 277b  onary between '{
+00023910: 6e65 775f 6469 6d7d 2720 616e 6420 277b  new_dim}' and '{
+00023920: 6578 6973 7469 6e67 5f64 696d 7d27 2069  existing_dim}' i
+00023930: 7320 6d61 7463 6865 6420 7061 7274 6961  s matched partia
+00023940: 6c6c 7922 0a20 2020 2020 2020 2020 2020  lly".           
+00023950: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+00023960: 6c65 6e28 7661 6c75 655b 6578 6973 7469  len(value[existi
+00023970: 6e67 5f64 696d 5d29 203d 3d20 6c65 6e28  ng_dim]) == len(
+00023980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023990: 2020 2020 2020 2020 206f 6c64 5f64 696d           old_dim
+000239a0: 5f69 7465 6d73 5f73 6574 292c 2066 2254  _items_set), f"T
+000239b0: 6865 7265 2061 7265 2064 7570 6c69 6361  here are duplica
+000239c0: 7465 2069 7465 6d73 2069 6e20 7468 6520  te items in the 
+000239d0: 6d61 7070 696e 6720 6469 6374 2061 7373  mapping dict ass
+000239e0: 6f63 6961 7465 6420 7769 7468 2027 7b6e  ociated with '{n
+000239f0: 6577 5f64 696d 7d27 2061 6e64 2027 7b65  ew_dim}' and '{e
+00023a00: 7869 7374 696e 675f 6469 6d7d 2722 0a20  xisting_dim}'". 
+00023a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023a20: 2020 2063 6f6f 7264 735b 6e65 775f 6469     coords[new_di
+00023a30: 6d5d 203d 206e 702e 756e 6971 7565 285f  m] = np.unique(_
+00023a40: 7465 7374 5f74 7970 655f 616e 645f 7570  test_type_and_up
+00023a50: 6461 7465 280a 2020 2020 2020 2020 2020  date(.          
+00023a60: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00023a70: 7374 2876 616c 7565 5b65 7869 7374 696e  st(value[existin
+00023a80: 675f 6469 6d5d 2e76 616c 7565 7328 2929  g_dim].values())
+00023a90: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00023aa0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+00023ab0: 6365 2876 616c 7565 5b65 7869 7374 696e  ce(value[existin
+00023ac0: 675f 6469 6d5d 2c20 6c69 7374 293a 0a20  g_dim], list):. 
+00023ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023ae0: 2020 2061 7373 6572 7420 6c65 6e28 0a20     assert len(. 
+00023af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023b00: 2020 2020 2020 2076 616c 7565 5b65 7869         value[exi
+00023b10: 7374 696e 675f 6469 6d5d 2920 3d3d 2032  sting_dim]) == 2
+00023b20: 2c20 6622 5661 6c75 6520 6173 736f 6369  , f"Value associ
+00023b30: 6174 6564 2077 6974 6820 277b 6e65 775f  ated with '{new_
+00023b40: 6469 6d7d 2720 616e 6420 277b 6578 6973  dim}' and '{exis
+00023b50: 7469 6e67 5f64 696d 7d27 206d 7573 7420  ting_dim}' must 
+00023b60: 6265 2061 206c 6973 7420 7769 7468 2074  be a list with t
+00023b70: 776f 2069 7465 6d73 2e20 476f 7420 7b76  wo items. Got {v
+00023b80: 616c 7565 5b65 7869 7374 696e 675f 6469  alue[existing_di
+00023b90: 6d5d 7d22 0a20 2020 2020 2020 2020 2020  m]}".           
+00023ba0: 2020 2020 2020 2020 206f 6c64 5f64 696d           old_dim
+00023bb0: 5f69 7465 6d73 5f73 6574 203d 2073 6574  _items_set = set
+00023bc0: 2876 616c 7565 5b65 7869 7374 696e 675f  (value[existing_
+00023bd0: 6469 6d5d 5b30 5d29 0a20 2020 2020 2020  dim][0]).       
+00023be0: 2020 2020 2020 2020 2020 2020 2061 7373               ass
+00023bf0: 6572 7420 7365 7428 0a20 2020 2020 2020  ert set(.       
+00023c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c10: 2073 656c 662e 636f 6f72 6473 5b65 7869   self.coords[exi
+00023c20: 7374 696e 675f 6469 6d5d 2920 3d3d 206f  sting_dim]) == o
+00023c30: 6c64 5f64 696d 5f69 7465 6d73 5f73 6574  ld_dim_items_set
+00023c40: 2c20 6622 416c 6c20 6974 656d 7320 696e  , f"All items in
+00023c50: 2074 6865 206d 6170 7069 6e67 2064 6963   the mapping dic
+00023c60: 7420 6173 736f 6369 6174 6564 2077 6974  t associated wit
+00023c70: 6820 277b 6e65 775f 6469 6d7d 2720 616e  h '{new_dim}' an
+00023c80: 6420 277b 6578 6973 7469 6e67 5f64 696d  d '{existing_dim
+00023c90: 7d27 206d 7573 7420 6265 2069 6e63 6c75  }' must be inclu
+00023ca0: 6465 6420 696e 202e 636f 6f72 6473 5b27  ded in .coords['
+00023cb0: 7b65 7869 7374 696e 675f 6469 6d7d 275d  {existing_dim}']
+00023cc0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00023cd0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+00023ce0: 2876 616c 7565 5b65 7869 7374 696e 675f  (value[existing_
+00023cf0: 6469 6d5d 5b30 5d29 203d 3d20 6c65 6e28  dim][0]) == len(
+00023d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023d10: 2020 2020 2020 2020 206f 6c64 5f64 696d           old_dim
+00023d20: 5f69 7465 6d73 5f73 6574 292c 2066 2254  _items_set), f"T
+00023d30: 6865 7265 2061 7265 2064 7570 6c69 6361  here are duplica
+00023d40: 7465 2069 7465 6d73 2069 6e20 7468 6520  te items in the 
+00023d50: 6d61 7070 696e 6720 6469 6374 2061 7373  mapping dict ass
+00023d60: 6f63 6961 7465 6420 7769 7468 2027 7b6e  ociated with '{n
+00023d70: 6577 5f64 696d 7d27 2061 6e64 2027 7b65  ew_dim}' and '{e
+00023d80: 7869 7374 696e 675f 6469 6d7d 2722 0a20  xisting_dim}'". 
 00023d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023da0: 2020 2020 2020 206b 7761 7267 735b 6e65         kwargs[ne
-00023db0: 775f 6469 6d5d 5b65 7869 7374 696e 675f  w_dim][existing_
-00023dc0: 6469 6d5d 5b30 5d20 3d20 5f74 6573 745f  dim][0] = _test_
-00023dd0: 7479 7065 5f61 6e64 5f75 7064 6174 6528  type_and_update(
-00023de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023df0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00023e00: 7565 5b65 7869 7374 696e 675f 6469 6d5d  ue[existing_dim]
-00023e10: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
-00023e20: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-00023e30: 6973 696e 7374 616e 6365 280a 2020 2020  isinstance(.    
-00023e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e50: 2020 2020 6b77 6172 6773 5b6e 6577 5f64      kwargs[new_d
-00023e60: 696d 5d5b 6578 6973 7469 6e67 5f64 696d  im][existing_dim
-00023e70: 5d5b 305d 2c20 6e70 2e6e 6461 7272 6179  ][0], np.ndarray
-00023e80: 292c 2066 2256 616c 7565 2061 7373 6f63  ), f"Value assoc
-00023e90: 6961 7465 6420 7769 7468 2027 7b6e 6577  iated with '{new
-00023ea0: 5f64 696d 7d27 2061 6e64 2027 7b65 7869  _dim}' and '{exi
-00023eb0: 7374 696e 675f 6469 6d7d 2720 6d75 7374  sting_dim}' must
-00023ec0: 2062 6520 6120 6e75 6d70 7920 6172 7261   be a numpy arra
-00023ed0: 792e 2047 6f74 207b 7479 7065 286b 7761  y. Got {type(kwa
-00023ee0: 7267 735b 6e65 775f 6469 6d5d 5b65 7869  rgs[new_dim][exi
-00023ef0: 7374 696e 675f 6469 6d5d 5b30 5d29 7d22  sting_dim][0])}"
-00023f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023f10: 2020 2020 206e 6577 5f64 696d 5f69 7465       new_dim_ite
-00023f20: 6d73 203d 2076 616c 7565 5b65 7869 7374  ms = value[exist
-00023f30: 696e 675f 6469 6d5d 5b31 5d0a 2020 2020  ing_dim][1].    
-00023f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023f50: 6e65 775f 6469 6d5f 6974 656d 735f 7365  new_dim_items_se
-00023f60: 7420 3d20 7365 7428 6e65 775f 6469 6d5f  t = set(new_dim_
-00023f70: 6974 656d 7329 0a20 2020 2020 2020 2020  items).         
-00023f80: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00023f90: 6e28 6e65 775f 6469 6d5f 6974 656d 7329  n(new_dim_items)
-00023fa0: 203d 3d20 6c65 6e28 6e65 775f 6469 6d5f   == len(new_dim_
-00023fb0: 6974 656d 735f 7365 7429 3a0a 2020 2020  items_set):.    
-00023fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023fd0: 2020 2020 636f 6f72 6473 5b6e 6577 5f64      coords[new_d
-00023fe0: 696d 5d20 3d20 5f74 6573 745f 7479 7065  im] = _test_type
-00023ff0: 5f61 6e64 5f75 7064 6174 6528 0a20 2020  _and_update(.   
+00023da0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00023db0: 2876 616c 7565 5b65 7869 7374 696e 675f  (value[existing_
+00023dc0: 6469 6d5d 5b30 5d2c 206c 6973 7429 3a0a  dim][0], list):.
+00023dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023de0: 2020 2020 2020 2020 6b77 6172 6773 5b6e          kwargs[n
+00023df0: 6577 5f64 696d 5d5b 6578 6973 7469 6e67  ew_dim][existing
+00023e00: 5f64 696d 5d5b 305d 203d 205f 7465 7374  _dim][0] = _test
+00023e10: 5f74 7970 655f 616e 645f 7570 6461 7465  _type_and_update
+00023e20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00023e30: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00023e40: 6c75 655b 6578 6973 7469 6e67 5f64 696d  lue[existing_dim
+00023e50: 5d5b 305d 290a 2020 2020 2020 2020 2020  ][0]).          
+00023e60: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00023e70: 2069 7369 6e73 7461 6e63 6528 0a20 2020   isinstance(.   
+00023e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023e90: 2020 2020 206b 7761 7267 735b 6e65 775f       kwargs[new_
+00023ea0: 6469 6d5d 5b65 7869 7374 696e 675f 6469  dim][existing_di
+00023eb0: 6d5d 5b30 5d2c 206e 702e 6e64 6172 7261  m][0], np.ndarra
+00023ec0: 7929 2c20 6622 5661 6c75 6520 6173 736f  y), f"Value asso
+00023ed0: 6369 6174 6564 2077 6974 6820 277b 6e65  ciated with '{ne
+00023ee0: 775f 6469 6d7d 2720 616e 6420 277b 6578  w_dim}' and '{ex
+00023ef0: 6973 7469 6e67 5f64 696d 7d27 206d 7573  isting_dim}' mus
+00023f00: 7420 6265 2061 206e 756d 7079 2061 7272  t be a numpy arr
+00023f10: 6179 2e20 476f 7420 7b74 7970 6528 6b77  ay. Got {type(kw
+00023f20: 6172 6773 5b6e 6577 5f64 696d 5d5b 6578  args[new_dim][ex
+00023f30: 6973 7469 6e67 5f64 696d 5d5b 305d 297d  isting_dim][0])}
+00023f40: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00023f50: 2020 2020 2020 6e65 775f 6469 6d5f 6974        new_dim_it
+00023f60: 656d 7320 3d20 7661 6c75 655b 6578 6973  ems = value[exis
+00023f70: 7469 6e67 5f64 696d 5d5b 315d 0a20 2020  ting_dim][1].   
+00023f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f90: 206e 6577 5f64 696d 5f69 7465 6d73 5f73   new_dim_items_s
+00023fa0: 6574 203d 2073 6574 286e 6577 5f64 696d  et = set(new_dim
+00023fb0: 5f69 7465 6d73 290a 2020 2020 2020 2020  _items).        
+00023fc0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00023fd0: 656e 286e 6577 5f64 696d 5f69 7465 6d73  en(new_dim_items
+00023fe0: 2920 3d3d 206c 656e 286e 6577 5f64 696d  ) == len(new_dim
+00023ff0: 5f69 7465 6d73 5f73 6574 293a 0a20 2020  _items_set):.   
 00024000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024010: 2020 2020 2020 2020 2076 616c 7565 5b65           value[e
-00024020: 7869 7374 696e 675f 6469 6d5d 5b31 5d29  xisting_dim][1])
-00024030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024040: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00024050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024060: 2020 2063 6f6f 7264 735b 6e65 775f 6469     coords[new_di
-00024070: 6d5d 203d 206e 702e 756e 6971 7565 280a  m] = np.unique(.
-00024080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024090: 2020 2020 2020 2020 2020 2020 5f74 6573              _tes
-000240a0: 745f 7479 7065 5f61 6e64 5f75 7064 6174  t_type_and_updat
-000240b0: 6528 7661 6c75 655b 6578 6973 7469 6e67  e(value[existing
-000240c0: 5f64 696d 5d5b 315d 2929 0a20 2020 2020  _dim][1])).     
-000240d0: 2020 2020 2020 2023 2074 6869 7320 6973         # this is
-000240e0: 2061 206c 6973 7420 6f66 2073 7472 696e   a list of strin
-000240f0: 6773 2074 6861 7420 7265 7072 6573 656e  gs that represen
-00024100: 7420 7365 7665 7261 6c20 6469 6d65 6e73  t several dimens
-00024110: 696f 6e73 206e 616d 6564 2069 6e20 7365  ions named in se
-00024120: 6c66 2e64 696d 732e 2054 6865 206e 6577  lf.dims. The new
-00024130: 2064 696d 656e 7369 6f6e 2069 7320 7468   dimension is th
-00024140: 6520 636f 6e63 6174 656e 6174 696f 6e20  e concatenation 
-00024150: 6f66 2074 6865 2073 656c 6563 7465 6420  of the selected 
-00024160: 6469 6d65 6e73 696f 6e73 0a20 2020 2020  dimensions.     
-00024170: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-00024180: 7374 616e 6365 2876 616c 7565 2c20 6c69  stance(value, li
-00024190: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
-000241a0: 2020 2020 2061 7373 6572 7420 7661 6c75       assert valu
-000241b0: 652c 2022 4c69 7374 2063 616e 6e6f 7420  e, "List cannot 
-000241c0: 6265 2065 6d70 7479 220a 2020 2020 2020  be empty".      
-000241d0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-000241e0: 2061 6c6c 285b 6973 696e 7374 616e 6365   all([isinstance
-000241f0: 2869 7465 6d2c 2073 7472 2920 666f 7220  (item, str) for 
-00024200: 6974 656d 2069 6e20 7661 6c75 655d 292c  item in value]),
-00024210: 2022 416c 6c20 6974 656d 7320 696e 2074   "All items in t
-00024220: 6865 206c 6973 7420 6d75 7374 2062 6520  he list must be 
-00024230: 7374 7222 0a20 2020 2020 2020 2020 2020  str".           
-00024240: 2020 2020 2061 7373 6572 7420 616c 6c28       assert all(
-00024250: 5b64 696d 2069 6e20 7365 6c66 2e64 696d  [dim in self.dim
-00024260: 7320 666f 7220 6469 6d20 696e 2076 616c  s for dim in val
-00024270: 7565 5d29 2c20 2241 6c6c 2069 7465 6d73  ue]), "All items
-00024280: 2069 6e20 7468 6520 6c69 7374 206d 7573   in the list mus
-00024290: 7420 6265 2069 6e20 6469 6d73 220a 2020  t be in dims".  
-000242a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000242b0: 6c65 6374 6564 5f63 6f6f 7264 7320 3d20  lected_coords = 
-000242c0: 7b64 696d 3a20 7365 6c66 2e63 6f6f 7264  {dim: self.coord
-000242d0: 735b 6469 6d5d 2066 6f72 2064 696d 2069  s[dim] for dim i
-000242e0: 6e20 7661 6c75 657d 0a20 2020 2020 2020  n value}.       
-000242f0: 2020 2020 2020 2020 2061 7272 6179 7320           arrays 
-00024300: 3d20 6e70 2e75 6e72 6176 656c 5f69 6e64  = np.unravel_ind
-00024310: 6578 286e 702e 6172 616e 6765 2873 656c  ex(np.arange(sel
-00024320: 662e 5f63 6170 6163 6974 7928 0a20 2020  f._capacity(.   
-00024330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024340: 2073 656c 6563 7465 645f 636f 6f72 6473   selected_coords
-00024350: 2929 2c20 7365 6c66 2e5f 7368 6170 6528  )), self._shape(
-00024360: 7365 6c65 6374 6564 5f63 6f6f 7264 7329  selected_coords)
-00024370: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00024380: 2020 696e 6465 7820 3d20 7b64 696d 3a20    index = {dim: 
-00024390: 7365 6c66 2e63 6f6f 7264 735b 6469 6d5d  self.coords[dim]
-000243a0: 5b69 6478 5d20 666f 7220 6469 6d2c 2069  [idx] for dim, i
-000243b0: 6478 2069 6e20 7a69 7028 7365 6c65 6374  dx in zip(select
-000243c0: 6564 5f63 6f6f 7264 732c 2061 7272 6179  ed_coords, array
-000243d0: 7329 7d0a 2020 2020 2020 2020 2020 2020  s)}.            
-000243e0: 2020 2020 636f 6f72 6473 5b6e 6577 5f64      coords[new_d
-000243f0: 696d 5d20 3d20 5f6a 6f69 6e5f 7374 7228  im] = _join_str(
-00024400: 6c69 7374 2869 6e64 6578 2e76 616c 7565  list(index.value
-00024410: 7328 2929 2c20 7365 703d 223a 2229 0a20  s()), sep=":"). 
-00024420: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-00024430: 7761 7267 735b 6e65 775f 6469 6d5d 203d  wargs[new_dim] =
-00024440: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00024450: 2020 2020 2020 2074 7570 6c65 2876 616c         tuple(val
-00024460: 7565 293a 205b 7365 6c65 6374 6564 5f63  ue): [selected_c
-00024470: 6f6f 7264 732c 2063 6f6f 7264 735b 6e65  oords, coords[ne
-00024480: 775f 6469 6d5d 5d7d 0a20 2020 2020 2020  w_dim]]}.       
-00024490: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000244a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000244b0: 2041 7373 6572 7469 6f6e 4572 726f 7228   AssertionError(
-000244c0: 6622 556e 6578 7065 6374 6564 2074 7970  f"Unexpected typ
-000244d0: 653a 207b 7479 7065 2876 616c 7565 297d  e: {type(value)}
-000244e0: 2229 0a20 2020 2020 2020 2066 6f72 2064  ").        for d
-000244f0: 696d 2069 6e20 7365 6c66 2e63 6f6f 7264  im in self.coord
-00024500: 733a 0a20 2020 2020 2020 2020 2020 2063  s:.            c
-00024510: 6f6f 7264 735b 6469 6d5d 203d 2073 656c  oords[dim] = sel
-00024520: 662e 636f 6f72 6473 5b64 696d 5d0a 2020  f.coords[dim].  
-00024530: 2020 2020 2020 6c6f 6e67 203d 2073 656c        long = sel
-00024540: 662e 6c6f 6e67 2e69 6e73 6572 7428 2a2a  f.long.insert(**
-00024550: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
-00024560: 7265 7475 726e 2041 7272 6179 2864 6174  return Array(dat
-00024570: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d63  a=long, coords=c
-00024580: 6f6f 7264 7329 0a0a 2020 2020 6465 6620  oords)..    def 
-00024590: 6164 645f 6469 6d28 7365 6c66 2c20 2a2a  add_dim(self, **
-000245a0: 6b77 6172 6773 3a20 556e 696f 6e5b 6e70  kwargs: Union[np
-000245b0: 2e64 7479 7065 2c20 7479 7065 2c20 7374  .dtype, type, st
-000245c0: 722c 2069 6e74 2c20 4469 6374 5b73 7472  r, int, Dict[str
-000245d0: 2c20 556e 696f 6e5b 4469 6374 5b73 7472  , Union[Dict[str
-000245e0: 2c20 416e 795d 2c20 4c69 7374 5b55 6e69  , Any], List[Uni
-000245f0: 6f6e 5b4c 6973 745b 7374 725d 2c20 4c69  on[List[str], Li
-00024600: 7374 5b41 6e79 5d5d 5d5d 5d5d 2920 2d3e  st[Any]]]]]]) ->
-00024610: 2027 4172 7261 7927 3a0a 2020 2020 2020   'Array':.      
-00024620: 2020 2222 220a 2020 2020 2020 2020 4164    """.        Ad
-00024630: 6420 6e65 7720 6469 6d65 6e73 696f 6e73  d new dimensions
-00024640: 2074 6f20 7468 6520 4172 7261 792e 0a0a   to the Array...
-00024650: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00024660: 2020 2020 2020 2020 2020 2a2a 6b77 6172            **kwar
-00024670: 6773 3a20 4b65 7977 6f72 6420 6172 6775  gs: Keyword argu
-00024680: 6d65 6e74 7320 7370 6563 6966 7969 6e67  ments specifying
-00024690: 2074 6865 206e 6577 2064 696d 656e 7369   the new dimensi
-000246a0: 6f6e 7320 616e 6420 7468 6569 7220 7661  ons and their va
-000246b0: 6c75 6573 2e0a 0a20 2020 2020 2020 2052  lues...        R
-000246c0: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-000246d0: 2020 2020 4120 6e65 7720 4172 7261 7920      A new Array 
-000246e0: 6f62 6a65 6374 2077 6974 6820 7468 6520  object with the 
-000246f0: 6164 6465 6420 6469 6d65 6e73 696f 6e73  added dimensions
-00024700: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-00024710: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-00024720: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
-00024730: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
-00024740: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
-00024750: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
-00024760: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
-00024770: 2020 2020 3e3e 3e20 6c6f 6e67 203d 204c      >>> long = L
-00024780: 6f6e 6728 696e 6465 783d 7b27 6469 6d31  ong(index={'dim1
-00024790: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
-000247a0: 6469 6d32 273a 205b 312c 2032 5d7d 2c20  dim2': [1, 2]}, 
-000247b0: 7661 6c75 653d 5b31 302c 2032 305d 290a  value=[10, 20]).
-000247c0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-000247d0: 6172 7220 3d20 4172 7261 7928 6461 7461  arr = Array(data
-000247e0: 3d6c 6f6e 672c 2063 6f6f 7264 733d 636f  =long, coords=co
-000247f0: 6f72 6473 290a 2020 2020 2020 2020 2020  ords).          
-00024800: 2020 3e3e 3e20 6e65 775f 6172 7220 3d20    >>> new_arr = 
-00024810: 6172 722e 6164 645f 6469 6d28 783d 3029  arr.add_dim(x=0)
-00024820: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00024830: 206e 6577 5f61 7272 0a20 2020 2020 2020   new_arr.       
-00024840: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
-00024850: 6172 7261 7928 5b5b 5b31 302c 2020 305d  array([[[10,  0]
-00024860: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00024870: 2020 2020 2020 5b20 302c 2032 305d 5d5d        [ 0, 20]]]
-00024880: 292c 2063 6f6f 7264 733d 7b27 7827 3a20  ), coords={'x': 
-00024890: 6172 7261 7928 5b30 5d29 2c20 2764 696d  array([0]), 'dim
-000248a0: 3127 3a20 6172 7261 7928 5b27 6127 2c20  1': array(['a', 
-000248b0: 2762 275d 2c20 6474 7970 653d 6f62 6a65  'b'], dtype=obje
-000248c0: 6374 292c 2027 6469 6d32 273a 2061 7272  ct), 'dim2': arr
-000248d0: 6179 285b 312c 2032 5d29 7d29 0a0a 2020  ay([1, 2])})..  
-000248e0: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
-000248f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00024900: 2020 7265 7475 726e 2073 656c 662e 696e    return self.in
-00024910: 7365 7274 282a 2a6b 7761 7267 7329 0a0a  sert(**kwargs)..
-00024920: 2020 2020 6465 6620 7265 6e61 6d65 2873      def rename(s
-00024930: 656c 662c 202a 2a6b 7761 7267 733a 2073  elf, **kwargs: s
-00024940: 7472 2920 2d3e 2027 4172 7261 7927 3a0a  tr) -> 'Array':.
-00024950: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00024960: 2020 2020 5265 6e61 6d65 2064 696d 656e      Rename dimen
-00024970: 7369 6f6e 7320 6f66 2074 6865 2041 7272  sions of the Arr
-00024980: 6179 2e0a 0a20 2020 2020 2020 2041 7267  ay...        Arg
-00024990: 733a 0a20 2020 2020 2020 2020 2020 202a  s:.            *
-000249a0: 2a6b 7761 7267 733a 204b 6579 776f 7264  *kwargs: Keyword
-000249b0: 2061 7267 756d 656e 7473 2073 7065 6369   arguments speci
-000249c0: 6679 696e 6720 7468 6520 6f6c 6420 6469  fying the old di
-000249d0: 6d65 6e73 696f 6e20 6e61 6d65 7320 616e  mension names an
-000249e0: 6420 7468 6569 7220 6e65 7720 6e61 6d65  d their new name
-000249f0: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
-00024a00: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
-00024a10: 2041 206e 6577 2041 7272 6179 206f 626a   A new Array obj
-00024a20: 6563 7420 7769 7468 2074 6865 2072 656e  ect with the ren
-00024a30: 616d 6564 2064 696d 656e 7369 6f6e 732e  amed dimensions.
-00024a40: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00024a50: 653a 0a20 2020 2020 2020 2020 2020 2060  e:.            `
-00024a60: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-00024a70: 2020 2020 203e 3e3e 2063 6f6f 7264 7320       >>> coords 
-00024a80: 3d20 7b27 6469 6d31 273a 205b 2761 272c  = {'dim1': ['a',
-00024a90: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-00024aa0: 312c 2032 5d7d 0a20 2020 2020 2020 2020  1, 2]}.         
-00024ab0: 2020 203e 3e3e 206c 6f6e 6720 3d20 4c6f     >>> long = Lo
-00024ac0: 6e67 2869 6e64 6578 3d7b 2764 696d 3127  ng(index={'dim1'
-00024ad0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
-00024ae0: 696d 3227 3a20 5b31 2c20 325d 7d2c 2076  im2': [1, 2]}, v
-00024af0: 616c 7565 3d5b 3130 2c20 3230 5d29 0a20  alue=[10, 20]). 
-00024b00: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
-00024b10: 7272 203d 2041 7272 6179 2864 6174 613d  rr = Array(data=
-00024b20: 6c6f 6e67 2c20 636f 6f72 6473 3d63 6f6f  long, coords=coo
-00024b30: 7264 7329 0a20 2020 2020 2020 2020 2020  rds).           
-00024b40: 203e 3e3e 206e 6577 5f61 7272 203d 2061   >>> new_arr = a
-00024b50: 7272 2e72 656e 616d 6528 6469 6d31 3d27  rr.rename(dim1='
-00024b60: 6e65 775f 6469 6d31 2729 0a20 2020 2020  new_dim1').     
-00024b70: 2020 2020 2020 203e 3e3e 206e 6577 5f61         >>> new_a
-00024b80: 7272 0a20 2020 2020 2020 2020 2020 2041  rr.            A
-00024b90: 7272 6179 2864 6174 613d 6172 7261 7928  rray(data=array(
-00024ba0: 5b5b 3130 2e2c 2020 302e 5d2c 0a20 2020  [[10.,  0.],.   
-00024bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024bc0: 5b20 302e 2c20 3230 2e5d 5d29 2c20 636f  [ 0., 20.]]), co
-00024bd0: 6f72 6473 3d7b 276e 6577 5f64 696d 3127  ords={'new_dim1'
-00024be0: 3a20 6172 7261 7928 5b27 6127 2c20 2762  : array(['a', 'b
-00024bf0: 275d 2c20 6474 7970 653d 6f62 6a65 6374  '], dtype=object
-00024c00: 292c 2027 6469 6d32 273a 2061 7272 6179  ), 'dim2': array
-00024c10: 285b 312c 2032 5d29 7d29 0a0a 2020 2020  ([1, 2])})..    
-00024c20: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-00024c30: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00024c40: 666f 7220 6f6c 6464 696d 2c20 6e65 7764  for olddim, newd
-00024c50: 696d 2069 6e20 6b77 6172 6773 2e69 7465  im in kwargs.ite
-00024c60: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
-00024c70: 2020 6173 7365 7274 206f 6c64 6469 6d20    assert olddim 
-00024c80: 696e 2073 656c 662e 6469 6d73 2c20 6622  in self.dims, f"
-00024c90: 4469 6d65 6e73 696f 6e20 7b6f 6c64 6469  Dimension {olddi
-00024ca0: 6d7d 206d 7573 7420 6265 2069 6e20 6469  m} must be in di
-00024cb0: 6d73 207b 7365 6c66 2e64 696d 737d 220a  ms {self.dims}".
-00024cc0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00024cd0: 7274 206e 6577 6469 6d20 6e6f 7420 696e  rt newdim not in
-00024ce0: 2073 656c 662e 6469 6d73 2c20 6622 4469   self.dims, f"Di
-00024cf0: 6d65 6e73 696f 6e20 7b6e 6577 6469 6d7d  mension {newdim}
-00024d00: 206d 7573 7420 6e6f 7420 6265 2069 6e20   must not be in 
-00024d10: 6469 6d73 207b 7365 6c66 2e64 696d 737d  dims {self.dims}
-00024d20: 220a 2020 2020 2020 2020 636f 6f72 6473  ".        coords
-00024d30: 203d 207b 7d0a 2020 2020 2020 2020 666f   = {}.        fo
-00024d40: 7220 6469 6d2c 2065 6c65 6d73 2069 6e20  r dim, elems in 
-00024d50: 7365 6c66 2e63 6f6f 7264 732e 6974 656d  self.coords.item
-00024d60: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-00024d70: 2069 6620 6469 6d20 696e 206b 7761 7267   if dim in kwarg
-00024d80: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00024d90: 2020 2063 6f6f 7264 735b 6b77 6172 6773     coords[kwargs
-00024da0: 5b64 696d 5d5d 203d 2065 6c65 6d73 0a20  [dim]] = elems. 
-00024db0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00024dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024dd0: 2063 6f6f 7264 735b 6469 6d5d 203d 2065   coords[dim] = e
-00024de0: 6c65 6d73 0a20 2020 2020 2020 2072 6574  lems.        ret
-00024df0: 7572 6e20 4172 7261 7928 6461 7461 3d73  urn Array(data=s
-00024e00: 656c 662e 6461 7461 2c20 636f 6f72 6473  elf.data, coords
-00024e10: 3d63 6f6f 7264 7329 0a0a 2020 2020 6465  =coords)..    de
-00024e20: 6620 6472 6f70 2873 656c 662c 2064 696d  f drop(self, dim
-00024e30: 733a 2055 6e69 6f6e 5b73 7472 2c20 4c69  s: Union[str, Li
-00024e40: 7374 5b73 7472 5d5d 2920 2d3e 2027 4172  st[str]]) -> 'Ar
-00024e50: 7261 7927 3a0a 2020 2020 2020 2020 2222  ray':.        ""
-00024e60: 220a 2020 2020 2020 2020 4472 6f70 2073  ".        Drop s
-00024e70: 7065 6369 6669 6564 2064 696d 656e 7369  pecified dimensi
-00024e80: 6f6e 7320 6672 6f6d 2074 6865 2041 7272  ons from the Arr
-00024e90: 6179 2e0a 0a20 2020 2020 2020 2041 7267  ay...        Arg
-00024ea0: 733a 0a20 2020 2020 2020 2020 2020 2064  s:.            d
-00024eb0: 696d 733a 2041 2073 696e 676c 6520 6469  ims: A single di
-00024ec0: 6d65 6e73 696f 6e20 6f72 2061 206c 6973  mension or a lis
-00024ed0: 7420 6f66 2064 696d 656e 7369 6f6e 7320  t of dimensions 
-00024ee0: 746f 2064 726f 702e 0a0a 2020 2020 2020  to drop...      
-00024ef0: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-00024f00: 2020 2020 2020 2041 206e 6577 2041 7272         A new Arr
-00024f10: 6179 206f 626a 6563 7420 7769 7468 2074  ay object with t
-00024f20: 6865 2073 7065 6369 6669 6564 2064 696d  he specified dim
-00024f30: 656e 7369 6f6e 7320 6472 6f70 7065 642e  ensions dropped.
-00024f40: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00024f50: 653a 0a20 2020 2020 2020 2020 2020 2060  e:.            `
-00024f60: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-00024f70: 2020 2020 203e 3e3e 2063 6f6f 7264 7320       >>> coords 
-00024f80: 3d20 7b27 6469 6d31 273a 205b 2761 275d  = {'dim1': ['a']
-00024f90: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
-00024fa0: 7d0a 2020 2020 2020 2020 2020 2020 3e3e  }.            >>
-00024fb0: 3e20 6c6f 6e67 203d 204c 6f6e 6728 696e  > long = Long(in
-00024fc0: 6465 783d 7b27 6469 6d31 273a 205b 2761  dex={'dim1': ['a
-00024fd0: 272c 2027 6127 5d2c 2027 6469 6d32 273a  ', 'a'], 'dim2':
-00024fe0: 205b 312c 2032 5d7d 2c20 7661 6c75 653d   [1, 2]}, value=
-00024ff0: 5b31 302c 2032 305d 290a 2020 2020 2020  [10, 20]).      
-00025000: 2020 2020 2020 3e3e 3e20 6172 7220 3d20        >>> arr = 
-00025010: 4172 7261 7928 6461 7461 3d6c 6f6e 672c  Array(data=long,
-00025020: 2063 6f6f 7264 733d 636f 6f72 6473 290a   coords=coords).
-00025030: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00025040: 6e65 775f 6172 7220 3d20 6172 722e 6472  new_arr = arr.dr
-00025050: 6f70 2827 6469 6d31 2729 0a20 2020 2020  op('dim1').     
-00025060: 2020 2020 2020 203e 3e3e 206e 6577 5f61         >>> new_a
-00025070: 7272 0a20 2020 2020 2020 2020 2020 2041  rr.            A
-00025080: 7272 6179 2864 6174 613d 6172 7261 7928  rray(data=array(
-00025090: 5b31 302c 2032 305d 292c 2063 6f6f 7264  [10, 20]), coord
-000250a0: 733d 7b27 6469 6d32 273a 2061 7272 6179  s={'dim2': array
-000250b0: 285b 312c 2032 5d29 7d29 0a0a 2020 2020  ([1, 2])})..    
-000250c0: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-000250d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000250e0: 6c6f 6e67 203d 2073 656c 662e 6c6f 6e67  long = self.long
-000250f0: 2e64 726f 7028 6469 6d73 3d64 696d 7329  .drop(dims=dims)
-00025100: 0a20 2020 2020 2020 2063 6f6f 7264 7320  .        coords 
-00025110: 3d20 7b64 696d 3a20 7365 6c66 2e63 6f6f  = {dim: self.coo
-00025120: 7264 735b 6469 6d5d 2066 6f72 2064 696d  rds[dim] for dim
-00025130: 2069 6e20 6c6f 6e67 2e64 696d 737d 0a20   in long.dims}. 
-00025140: 2020 2020 2020 2072 6574 7572 6e20 4172         return Ar
-00025150: 7261 7928 6461 7461 3d6c 6f6e 672c 2063  ray(data=long, c
-00025160: 6f6f 7264 733d 636f 6f72 6473 290a 0a20  oords=coords).. 
-00025170: 2020 2064 6566 2064 726f 706e 6128 7365     def dropna(se
-00025180: 6c66 2920 2d3e 2027 4172 7261 7927 3a0a  lf) -> 'Array':.
-00025190: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000251a0: 2020 2020 4472 6f70 206d 6973 7369 6e67      Drop missing
-000251b0: 2076 616c 7565 7320 284e 614e 2920 6672   values (NaN) fr
-000251c0: 6f6d 2074 6865 2041 7272 6179 2e0a 2020  om the Array..  
-000251d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000251e0: 2020 6c6f 6e67 203d 2073 656c 662e 6c6f    long = self.lo
-000251f0: 6e67 0a20 2020 2020 2020 206c 6f6e 6720  ng.        long 
-00025200: 3d20 6c6f 6e67 5b6c 6f6e 6720 213d 206e  = long[long != n
-00025210: 702e 6e61 6e5d 0a20 2020 2020 2020 2072  p.nan].        r
-00025220: 6574 7572 6e20 4172 7261 7928 6461 7461  eturn Array(data
-00025230: 3d6c 6f6e 672c 2063 6f6f 7264 733d 7365  =long, coords=se
-00025240: 6c66 2e63 6f6f 7264 7329 0a0a 2020 2020  lf.coords)..    
-00025250: 6465 6620 6472 6f70 696e 6628 7365 6c66  def dropinf(self
-00025260: 2c20 706f 733a 2062 6f6f 6c20 3d20 4661  , pos: bool = Fa
-00025270: 6c73 652c 206e 6567 3a20 626f 6f6c 203d  lse, neg: bool =
-00025280: 2046 616c 7365 2920 2d3e 2027 4172 7261   False) -> 'Arra
-00025290: 7927 3a0a 2020 2020 2020 2020 2222 220a  y':.        """.
-000252a0: 2020 2020 2020 2020 4472 6f70 2069 6e66          Drop inf
-000252b0: 696e 6974 6520 7661 6c75 6573 2028 696e  inite values (in
-000252c0: 6620 6f72 202d 696e 6629 2066 726f 6d20  f or -inf) from 
-000252d0: 7468 6520 4172 7261 792e 0a0a 2020 2020  the Array...    
-000252e0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-000252f0: 2020 2020 2020 706f 733a 2057 6865 7468        pos: Wheth
-00025300: 6572 2074 6f20 6472 6f70 2070 6f73 6974  er to drop posit
-00025310: 6976 6520 696e 6669 6e69 7479 2076 616c  ive infinity val
-00025320: 7565 732e 0a20 2020 2020 2020 2020 2020  ues..           
-00025330: 206e 6567 3a20 5768 6574 6865 7220 746f   neg: Whether to
-00025340: 2064 726f 7020 6e65 6761 7469 7665 2069   drop negative i
-00025350: 6e66 696e 6974 7920 7661 6c75 6573 2e0a  nfinity values..
-00025360: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00025370: 3a0a 2020 2020 2020 2020 2020 2020 4120  :.            A 
-00025380: 6e65 7720 4172 7261 7920 6f62 6a65 6374  new Array object
-00025390: 2077 6974 6820 696e 6669 6e69 7465 2076   with infinite v
-000253a0: 616c 7565 7320 7265 6d6f 7665 642e 0a20  alues removed.. 
-000253b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000253c0: 2020 2061 7373 6572 7420 616e 7928 5b70     assert any([p
-000253d0: 6f73 2c20 6e65 675d 292c 2022 706f 7320  os, neg]), "pos 
-000253e0: 616e 6420 6e65 6720 6361 6e6e 6f74 2062  and neg cannot b
-000253f0: 6520 626f 7468 2046 616c 7365 220a 2020  e both False".  
-00025400: 2020 2020 2020 6c6f 6e67 203d 2073 656c        long = sel
-00025410: 662e 6c6f 6e67 0a20 2020 2020 2020 2069  f.long.        i
-00025420: 6620 706f 733a 0a20 2020 2020 2020 2020  f pos:.         
-00025430: 2020 206c 6f6e 6720 3d20 6c6f 6e67 5b6c     long = long[l
-00025440: 6f6e 6720 213d 206e 702e 696e 665d 0a20  ong != np.inf]. 
-00025450: 2020 2020 2020 2069 6620 6e65 673a 0a20         if neg:. 
-00025460: 2020 2020 2020 2020 2020 206c 6f6e 6720             long 
-00025470: 3d20 6c6f 6e67 5b6c 6f6e 6720 213d 202d  = long[long != -
-00025480: 6e70 2e69 6e66 5d0a 2020 2020 2020 2020  np.inf].        
-00025490: 7265 7475 726e 2041 7272 6179 2864 6174  return Array(dat
-000254a0: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d73  a=long, coords=s
-000254b0: 656c 662e 636f 6f72 6473 290a 0a20 2020  elf.coords)..   
-000254c0: 2064 6566 2072 6f75 6e64 2873 656c 662c   def round(self,
-000254d0: 2064 6563 696d 616c 733a 2069 6e74 2920   decimals: int) 
-000254e0: 2d3e 2027 4172 7261 7927 3a0a 2020 2020  -> 'Array':.    
-000254f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00025500: 526f 756e 6420 7468 6520 7661 6c75 6573  Round the values
-00025510: 2069 6e20 7468 6520 4172 7261 7920 746f   in the Array to
-00025520: 2074 6865 2073 7065 6369 6669 6564 206e   the specified n
-00025530: 756d 6265 7220 6f66 2064 6563 696d 616c  umber of decimal
-00025540: 2070 6c61 6365 732e 0a0a 2020 2020 2020   places...      
-00025550: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-00025560: 2020 2020 6465 6369 6d61 6c73 3a20 5468      decimals: Th
-00025570: 6520 6e75 6d62 6572 206f 6620 6465 6369  e number of deci
-00025580: 6d61 6c20 706c 6163 6573 2074 6f20 726f  mal places to ro
-00025590: 756e 6420 746f 2e0a 0a20 2020 2020 2020  und to...       
-000255a0: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-000255b0: 2020 2020 2020 4120 6e65 7720 4172 7261        A new Arra
-000255c0: 7920 6f62 6a65 6374 2077 6974 6820 7468  y object with th
-000255d0: 6520 726f 756e 6465 6420 7661 6c75 6573  e rounded values
-000255e0: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-000255f0: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-00025600: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
-00025610: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
-00025620: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
-00025630: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
-00025640: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
-00025650: 2020 2020 3e3e 3e20 6c6f 6e67 5f77 6974      >>> long_wit
-00025660: 685f 6465 6369 6d61 6c73 203d 204c 6f6e  h_decimals = Lon
-00025670: 6728 696e 6465 783d 7b27 6469 6d31 273a  g(index={'dim1':
-00025680: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
-00025690: 6d32 273a 205b 312c 2032 5d7d 2c20 7661  m2': [1, 2]}, va
-000256a0: 6c75 653d 5b31 302e 3132 332c 2032 302e  lue=[10.123, 20.
-000256b0: 3435 365d 290a 2020 2020 2020 2020 2020  456]).          
-000256c0: 2020 3e3e 3e20 6172 725f 7769 7468 5f64    >>> arr_with_d
-000256d0: 6563 696d 616c 7320 3d20 4172 7261 7928  ecimals = Array(
-000256e0: 6461 7461 3d6c 6f6e 675f 7769 7468 5f64  data=long_with_d
-000256f0: 6563 696d 616c 732c 2063 6f6f 7264 733d  ecimals, coords=
-00025700: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
-00025710: 2020 2020 3e3e 3e20 726f 756e 6465 645f      >>> rounded_
-00025720: 6172 7220 3d20 6172 725f 7769 7468 5f64  arr = arr_with_d
-00025730: 6563 696d 616c 732e 726f 756e 6428 6465  ecimals.round(de
-00025740: 6369 6d61 6c73 3d31 290a 2020 2020 2020  cimals=1).      
-00025750: 2020 2020 2020 3e3e 3e20 726f 756e 6465        >>> rounde
-00025760: 645f 6172 720a 2020 2020 2020 2020 2020  d_arr.          
-00025770: 2020 4172 7261 7928 6461 7461 3d61 7272    Array(data=arr
-00025780: 6179 285b 5b31 302e 312c 2020 302e 205d  ay([[10.1,  0. ]
-00025790: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000257a0: 2020 2020 205b 2030 2e20 2c20 3230 2e35       [ 0. , 20.5
-000257b0: 5d5d 292c 2063 6f6f 7264 733d 7b27 6469  ]]), coords={'di
-000257c0: 6d31 273a 2061 7272 6179 285b 2761 272c  m1': array(['a',
-000257d0: 2027 6227 5d2c 2064 7479 7065 3d6f 626a   'b'], dtype=obj
-000257e0: 6563 7429 2c20 2764 696d 3227 3a20 6172  ect), 'dim2': ar
-000257f0: 7261 7928 5b31 2c20 325d 297d 290a 0a20  ray([1, 2])}).. 
-00025800: 2020 2020 2020 2020 2020 2060 6060 0a20             ```. 
-00025810: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00025820: 2020 206e 6461 7272 6179 203d 2073 656c     ndarray = sel
-00025830: 662e 6461 7461 2e72 6f75 6e64 2864 6563  f.data.round(dec
-00025840: 696d 616c 733d 6465 6369 6d61 6c73 290a  imals=decimals).
-00025850: 2020 2020 2020 2020 636f 6f72 6473 203d          coords =
-00025860: 2073 656c 662e 636f 6f72 6473 0a20 2020   self.coords.   
-00025870: 2020 2020 2072 6574 7572 6e20 4172 7261       return Arra
-00025880: 7928 6461 7461 3d6e 6461 7272 6179 2c20  y(data=ndarray, 
-00025890: 636f 6f72 6473 3d63 6f6f 7264 7329 0a0a  coords=coords)..
-000258a0: 2020 2020 6465 6620 656c 656d 735f 746f      def elems_to
-000258b0: 5f64 6174 6574 696d 6528 7365 6c66 2c20  _datetime(self, 
-000258c0: 6e65 775f 6469 6d3a 2073 7472 2c20 6163  new_dim: str, ac
-000258d0: 7475 616c 5f64 696d 3a20 7374 722c 2072  tual_dim: str, r
-000258e0: 6566 6572 656e 6365 5f64 6174 653a 2073  eference_date: s
-000258f0: 7472 2c20 6672 6571 3a20 7374 722c 2073  tr, freq: str, s
-00025900: 6f72 745f 636f 6f72 6473 3a20 626f 6f6c  ort_coords: bool
-00025910: 203d 2054 7275 6529 202d 3e20 2741 7272   = True) -> 'Arr
-00025920: 6179 273a 0a20 2020 2020 2020 2022 2222  ay':.        """
-00025930: 0a20 2020 2020 2020 2043 6f6e 7665 7274  .        Convert
-00025940: 2065 6c65 6d65 6e74 7320 6f66 2061 2064   elements of a d
-00025950: 696d 656e 7369 6f6e 2074 6f20 6461 7465  imension to date
-00025960: 7469 6d65 2076 616c 7565 7320 616e 6420  time values and 
-00025970: 6372 6561 7465 2061 206e 6577 2064 696d  create a new dim
-00025980: 656e 7369 6f6e 2e0a 0a20 2020 2020 2020  ension...       
-00025990: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-000259a0: 2020 206e 6577 5f64 696d 3a20 5468 6520     new_dim: The 
-000259b0: 6e61 6d65 206f 6620 7468 6520 6e65 7720  name of the new 
-000259c0: 6469 6d65 6e73 696f 6e20 746f 2063 7265  dimension to cre
-000259d0: 6174 652e 0a20 2020 2020 2020 2020 2020  ate..           
-000259e0: 2061 6374 7561 6c5f 6469 6d3a 2054 6865   actual_dim: The
-000259f0: 206e 616d 6520 6f66 2074 6865 2065 7869   name of the exi
-00025a00: 7374 696e 6720 6469 6d65 6e73 696f 6e20  sting dimension 
-00025a10: 746f 2063 6f6e 7665 7274 2e0a 2020 2020  to convert..    
-00025a20: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
-00025a30: 655f 6461 7465 3a20 5468 6520 7265 6665  e_date: The refe
-00025a40: 7265 6e63 6520 6461 7465 2074 6f20 7374  rence date to st
-00025a50: 6172 7420 7468 6520 6461 7465 7469 6d65  art the datetime
-00025a60: 2072 616e 6765 2066 726f 6d2e 0a20 2020   range from..   
-00025a70: 2020 2020 2020 2020 2066 7265 713a 2054           freq: T
-00025a80: 6865 2066 7265 7175 656e 6379 206f 6620  he frequency of 
-00025a90: 7468 6520 6461 7465 7469 6d65 2072 616e  the datetime ran
-00025aa0: 6765 2e0a 2020 2020 2020 2020 2020 2020  ge..            
-00025ab0: 736f 7274 5f63 6f6f 7264 733a 2057 6865  sort_coords: Whe
-00025ac0: 7468 6572 2074 6f20 736f 7274 2074 6865  ther to sort the
-00025ad0: 2063 6f6f 7264 696e 6174 6573 206f 6620   coordinates of 
-00025ae0: 7468 6520 6163 7475 616c 2064 696d 656e  the actual dimen
-00025af0: 7369 6f6e 2e0a 0a20 2020 2020 2020 2052  sion...        R
-00025b00: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-00025b10: 2020 2020 4120 6e65 7720 4172 7261 7920      A new Array 
-00025b20: 6f62 6a65 6374 2077 6974 6820 7468 6520  object with the 
-00025b30: 6461 7465 7469 6d65 2064 696d 656e 7369  datetime dimensi
-00025b40: 6f6e 2061 6464 6564 2e0a 0a20 2020 2020  on added...     
-00025b50: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-00025b60: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-00025b70: 6e0a 2020 2020 2020 2020 2020 2020 3e3e  n.            >>
-00025b80: 3e20 636f 6f72 6473 203d 207b 2764 696d  > coords = {'dim
-00025b90: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-00025ba0: 2764 696d 3227 3a20 5b31 2c20 325d 7d0a  'dim2': [1, 2]}.
-00025bb0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00025bc0: 6c6f 6e67 203d 204c 6f6e 6728 696e 6465  long = Long(inde
-00025bd0: 783d 7b27 6469 6d31 273a 205b 2761 272c  x={'dim1': ['a',
-00025be0: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-00025bf0: 312c 2032 5d7d 2c20 7661 6c75 653d 5b31  1, 2]}, value=[1
-00025c00: 302c 2032 305d 290a 2020 2020 2020 2020  0, 20]).        
-00025c10: 2020 2020 3e3e 3e20 6172 7220 3d20 4172      >>> arr = Ar
-00025c20: 7261 7928 6461 7461 3d6c 6f6e 672c 2063  ray(data=long, c
-00025c30: 6f6f 7264 733d 636f 6f72 6473 290a 2020  oords=coords).  
-00025c40: 2020 2020 2020 2020 2020 3e3e 3e20 6e65            >>> ne
-00025c50: 775f 6172 7220 3d20 6172 722e 656c 656d  w_arr = arr.elem
-00025c60: 735f 746f 5f64 6174 6574 696d 6528 6e65  s_to_datetime(ne
-00025c70: 775f 6469 6d3d 2764 6174 6527 2c20 6163  w_dim='date', ac
-00025c80: 7475 616c 5f64 696d 3d27 6469 6d32 272c  tual_dim='dim2',
-00025c90: 2072 6566 6572 656e 6365 5f64 6174 653d   reference_date=
-00025ca0: 2732 3032 322d 3031 2d30 3127 2c20 6672  '2022-01-01', fr
-00025cb0: 6571 3d27 4427 290a 2020 2020 2020 2020  eq='D').        
-00025cc0: 2020 2020 3e3e 3e20 6e65 775f 6172 720a      >>> new_arr.
-00025cd0: 2020 2020 2020 2020 2020 2020 4172 7261              Arra
-00025ce0: 7928 6461 7461 3d61 7272 6179 285b 5b5b  y(data=array([[[
-00025cf0: 3130 2c20 2030 5d2c 0a20 2020 2020 2020  10,  0],.       
-00025d00: 2020 2020 2020 2020 2020 2020 205b 2030               [ 0
-00025d10: 2c20 2030 5d5d 2c0a 2020 2020 2020 2020  ,  0]],.        
-00025d20: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00025d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d40: 2020 205b 5b20 302c 2020 305d 2c0a 2020     [[ 0,  0],.  
-00025d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d60: 2020 5b20 302c 2032 305d 5d5d 292c 2063    [ 0, 20]]]), c
-00025d70: 6f6f 7264 733d 7b27 6461 7465 273a 2061  oords={'date': a
-00025d80: 7272 6179 285b 2732 3032 322d 3031 2d30  rray(['2022-01-0
-00025d90: 3154 3030 3a30 303a 3030 2e30 3030 3030  1T00:00:00.00000
-00025da0: 3030 3030 272c 2027 3230 3232 2d30 312d  0000', '2022-01-
-00025db0: 3032 5430 303a 3030 3a30 302e 3030 3030  02T00:00:00.0000
-00025dc0: 3030 3030 3027 5d2c 0a20 2020 2020 2020  00000'],.       
-00025dd0: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
-00025de0: 3d27 6461 7465 7469 6d65 3634 5b6e 735d  ='datetime64[ns]
-00025df0: 2729 2c20 2764 696d 3127 3a20 6172 7261  '), 'dim1': arra
-00025e00: 7928 5b27 6127 2c20 2762 275d 2c20 6474  y(['a', 'b'], dt
-00025e10: 7970 653d 6f62 6a65 6374 292c 2027 6469  ype=object), 'di
-00025e20: 6d32 273a 2061 7272 6179 285b 312c 2032  m2': array([1, 2
-00025e30: 5d29 7d29 0a0a 2020 2020 2020 2020 2020  ])})..          
-00025e40: 2020 6060 600a 2020 2020 2020 2020 2222    ```.        ""
-00025e50: 220a 2020 2020 2020 2020 6173 7365 7274  ".        assert
-00025e60: 2061 6374 7561 6c5f 6469 6d20 696e 2073   actual_dim in s
-00025e70: 656c 662e 6469 6d73 0a20 2020 2020 2020  elf.dims.       
-00025e80: 2073 7461 7274 5f64 6174 6520 3d20 7064   start_date = pd
-00025e90: 2e74 6f5f 6461 7465 7469 6d65 2872 6566  .to_datetime(ref
-00025ea0: 6572 656e 6365 5f64 6174 6529 0a20 2020  erence_date).   
-00025eb0: 2020 2020 2074 203d 2070 642e 6461 7465       t = pd.date
-00025ec0: 5f72 616e 6765 2873 7461 7274 3d73 7461  _range(start=sta
-00025ed0: 7274 5f64 6174 652c 2070 6572 696f 6473  rt_date, periods
-00025ee0: 3d73 656c 662e 636f 6f72 6473 5b61 6374  =self.coords[act
-00025ef0: 7561 6c5f 6469 6d5d 2e73 697a 652c 2066  ual_dim].size, f
-00025f00: 7265 713d 6672 6571 290a 2020 2020 2020  req=freq).      
-00025f10: 2020 6966 2073 6f72 745f 636f 6f72 6473    if sort_coords
-00025f20: 3a0a 2020 2020 2020 2020 2020 2020 6e65  :.            ne
-00025f30: 775f 6172 7261 7920 3d20 7365 6c66 2e69  w_array = self.i
-00025f40: 6e73 6572 7428 2a2a 7b6e 6577 5f64 696d  nsert(**{new_dim
-00025f50: 3a20 7b61 6374 7561 6c5f 6469 6d3a 205b  : {actual_dim: [
-00025f60: 6e70 2e73 6f72 7428 7365 6c66 2e63 6f6f  np.sort(self.coo
-00025f70: 7264 735b 6163 7475 616c 5f64 696d 5d29  rds[actual_dim])
-00025f80: 2c20 745d 7d7d 290a 2020 2020 2020 2020  , t]}}).        
-00025f90: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00025fa0: 2020 6e65 775f 6172 7261 7920 3d20 7365    new_array = se
-00025fb0: 6c66 2e69 6e73 6572 7428 2a2a 7b6e 6577  lf.insert(**{new
-00025fc0: 5f64 696d 3a20 7b61 6374 7561 6c5f 6469  _dim: {actual_di
-00025fd0: 6d3a 205b 7365 6c66 2e63 6f6f 7264 735b  m: [self.coords[
-00025fe0: 6163 7475 616c 5f64 696d 5d2c 2074 5d7d  actual_dim], t]}
-00025ff0: 7d29 0a20 2020 2020 2020 2072 6574 7572  }).        retur
-00026000: 6e20 6e65 775f 6172 7261 790a 0a20 2020  n new_array..   
-00026010: 2064 6566 2065 6c65 6d73 5f74 6f5f 696e   def elems_to_in
-00026020: 7428 7365 6c66 2c20 6e65 775f 6469 6d3a  t(self, new_dim:
-00026030: 2073 7472 2c20 6163 7475 616c 5f64 696d   str, actual_dim
-00026040: 3a20 7374 7229 202d 3e20 2741 7272 6179  : str) -> 'Array
-00026050: 273a 0a20 2020 2020 2020 2022 2222 0a20  ':.        """. 
-00026060: 2020 2020 2020 2043 6f6e 7665 7274 2065         Convert e
-00026070: 6c65 6d65 6e74 7320 6f66 2061 2064 696d  lements of a dim
-00026080: 656e 7369 6f6e 2074 6f20 696e 7465 6765  ension to intege
-00026090: 7220 7661 6c75 6573 2061 6e64 2063 7265  r values and cre
-000260a0: 6174 6520 6120 6e65 7720 6469 6d65 6e73  ate a new dimens
-000260b0: 696f 6e2e 0a0a 2020 2020 2020 2020 4172  ion...        Ar
-000260c0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-000260d0: 6e65 775f 6469 6d3a 2054 6865 206e 616d  new_dim: The nam
-000260e0: 6520 6f66 2074 6865 206e 6577 2064 696d  e of the new dim
-000260f0: 656e 7369 6f6e 2074 6f20 6372 6561 7465  ension to create
-00026100: 2e0a 2020 2020 2020 2020 2020 2020 6163  ..            ac
-00026110: 7475 616c 5f64 696d 3a20 5468 6520 6e61  tual_dim: The na
-00026120: 6d65 206f 6620 7468 6520 6578 6973 7469  me of the existi
-00026130: 6e67 2064 696d 656e 7369 6f6e 2074 6f20  ng dimension to 
-00026140: 636f 6e76 6572 742e 0a0a 2020 2020 2020  convert...      
-00026150: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-00026160: 2020 2020 2020 2041 206e 6577 2041 7272         A new Arr
-00026170: 6179 206f 626a 6563 7420 7769 7468 2074  ay object with t
-00026180: 6865 2069 6e74 6567 6572 2064 696d 656e  he integer dimen
-00026190: 7369 6f6e 2061 6464 6564 2e0a 0a20 2020  sion added...   
-000261a0: 2020 2020 2045 7861 6d70 6c65 3a0a 2020       Example:.  
-000261b0: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
-000261c0: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
-000261d0: 3e3e 3e20 6c6f 6e67 203d 204c 6f6e 6728  >>> long = Long(
-000261e0: 696e 6465 783d 7b27 6469 6d31 273a 205b  index={'dim1': [
-000261f0: 2761 272c 2027 6227 5d2c 2027 6469 6d32  'a', 'b'], 'dim2
-00026200: 273a 205b 2731 272c 2027 3227 5d7d 2c20  ': ['1', '2']}, 
-00026210: 7661 6c75 653d 5b31 302c 2032 305d 290a  value=[10, 20]).
-00026220: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00026230: 6172 7220 3d20 4172 7261 7928 6461 7461  arr = Array(data
-00026240: 3d6c 6f6e 672c 2063 6f6f 7264 733d 7b27  =long, coords={'
-00026250: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
-00026260: 5d2c 2027 6469 6d32 273a 205b 2731 272c  ], 'dim2': ['1',
-00026270: 2027 3227 5d7d 290a 2020 2020 2020 2020   '2']}).        
-00026280: 2020 2020 3e3e 3e20 6e65 775f 6172 7220      >>> new_arr 
-00026290: 3d20 6172 722e 656c 656d 735f 746f 5f69  = arr.elems_to_i
-000262a0: 6e74 286e 6577 5f64 696d 3d27 696e 745f  nt(new_dim='int_
-000262b0: 6469 6d27 2c20 6163 7475 616c 5f64 696d  dim', actual_dim
-000262c0: 3d27 6469 6d32 2729 0a20 2020 2020 2020  ='dim2').       
-000262d0: 2020 2020 203e 3e3e 206e 6577 5f61 7272       >>> new_arr
-000262e0: 0a20 2020 2020 2020 2020 2020 2041 7272  .            Arr
-000262f0: 6179 2864 6174 613d 6172 7261 7928 5b5b  ay(data=array([[
-00026300: 5b31 302c 2020 305d 2c0a 2020 2020 2020  [10,  0],.      
-00026310: 2020 2020 2020 2020 2020 2020 2020 5b20                [ 
-00026320: 302c 2020 305d 5d2c 0a20 2020 2020 2020  0,  0]],.       
-00026330: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-00026340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026350: 2020 2020 5b5b 2030 2c20 2030 5d2c 0a20      [[ 0,  0],. 
-00026360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026370: 2020 205b 2030 2c20 3230 5d5d 5d29 2c20     [ 0, 20]]]), 
-00026380: 636f 6f72 6473 3d7b 2769 6e74 5f64 696d  coords={'int_dim
-00026390: 273a 2061 7272 6179 285b 312c 2032 5d29  ': array([1, 2])
-000263a0: 2c20 2764 696d 3127 3a20 6172 7261 7928  , 'dim1': array(
-000263b0: 5b27 6127 2c20 2762 275d 2c20 6474 7970  ['a', 'b'], dtyp
-000263c0: 653d 6f62 6a65 6374 292c 2027 6469 6d32  e=object), 'dim2
-000263d0: 273a 2061 7272 6179 285b 2731 272c 2027  ': array(['1', '
-000263e0: 3227 5d2c 2064 7479 7065 3d6f 626a 6563  2'], dtype=objec
-000263f0: 7429 7d29 0a0a 2020 2020 2020 2020 2020  t)})..          
-00026400: 2020 6060 600a 2020 2020 2020 2020 2222    ```.        ""
-00026410: 220a 2020 2020 2020 2020 7365 7269 6520  ".        serie 
-00026420: 3d20 7064 2e53 6572 6965 7328 6461 7461  = pd.Series(data
-00026430: 3d73 656c 662e 636f 6f72 6473 5b61 6374  =self.coords[act
-00026440: 7561 6c5f 6469 6d5d 290a 2020 2020 2020  ual_dim]).      
-00026450: 2020 7365 7269 6520 3d20 7365 7269 652e    serie = serie.
-00026460: 7374 722e 6578 7472 6163 7428 7222 285c  str.extract(r"(\
-00026470: 642b 2922 2c20 6578 7061 6e64 3d46 616c  d+)", expand=Fal
-00026480: 7365 292e 6173 7479 7065 2822 696e 7422  se).astype("int"
-00026490: 290a 2020 2020 2020 2020 6e65 775f 6172  ).        new_ar
-000264a0: 7261 7920 3d20 7365 6c66 2e69 6e73 6572  ray = self.inser
-000264b0: 7428 2a2a 7b6e 6577 5f64 696d 3a20 7b61  t(**{new_dim: {a
-000264c0: 6374 7561 6c5f 6469 6d3a 205b 7365 6c66  ctual_dim: [self
-000264d0: 2e63 6f6f 7264 735b 6163 7475 616c 5f64  .coords[actual_d
-000264e0: 696d 5d2c 2073 6572 6965 2e76 616c 7565  im], serie.value
-000264f0: 735d 7d7d 290a 2020 2020 2020 2020 7265  s]}}).        re
-00026500: 7475 726e 206e 6577 5f61 7272 6179 0a0a  turn new_array..
-00026510: 2020 2020 6465 6620 656d 7074 7928 7365      def empty(se
-00026520: 6c66 2920 2d3e 2027 4172 7261 7927 3a0a  lf) -> 'Array':.
-00026530: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00026540: 2020 2020 4372 6561 7465 2061 6e20 656d      Create an em
-00026550: 7074 7920 4172 7261 7920 7769 7468 2074  pty Array with t
-00026560: 6865 2073 616d 6520 6469 6d65 6e73 696f  he same dimensio
-00026570: 6e73 2061 6e64 2063 6f6f 7264 696e 6174  ns and coordinat
-00026580: 6573 2061 7320 7468 6520 6f72 6967 696e  es as the origin
-00026590: 616c 2041 7272 6179 2e0a 0a20 2020 2020  al Array...     
-000265a0: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
-000265b0: 2020 2020 2020 2020 4120 6e65 7720 656d          A new em
-000265c0: 7074 7920 4172 7261 7920 6f62 6a65 6374  pty Array object
-000265d0: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-000265e0: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-000265f0: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
-00026600: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
-00026610: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
-00026620: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
-00026630: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
-00026640: 2020 2020 3e3e 3e20 6c6f 6e67 203d 204c      >>> long = L
-00026650: 6f6e 6728 696e 6465 783d 7b27 6469 6d31  ong(index={'dim1
-00026660: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
-00026670: 6469 6d32 273a 205b 312c 2032 5d7d 2c20  dim2': [1, 2]}, 
-00026680: 7661 6c75 653d 5b31 302c 2032 305d 290a  value=[10, 20]).
-00026690: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-000266a0: 6172 7220 3d20 4172 7261 7928 6461 7461  arr = Array(data
-000266b0: 3d6c 6f6e 672c 2063 6f6f 7264 733d 636f  =long, coords=co
-000266c0: 6f72 6473 290a 2020 2020 2020 2020 2020  ords).          
-000266d0: 2020 3e3e 3e20 656d 7074 795f 6172 7220    >>> empty_arr 
-000266e0: 3d20 6172 722e 656d 7074 7928 290a 2020  = arr.empty().  
-000266f0: 2020 2020 2020 2020 2020 3e3e 3e20 656d            >>> em
-00026700: 7074 795f 6172 720a 2020 2020 2020 2020  pty_arr.        
-00026710: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
-00026720: 7272 6179 285b 5b30 2c20 305d 2c0a 2020  rray([[0, 0],.  
-00026730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026740: 205b 302c 2030 5d5d 292c 2063 6f6f 7264   [0, 0]]), coord
-00026750: 733d 7b27 6469 6d31 273a 2061 7272 6179  s={'dim1': array
-00026760: 285b 2761 272c 2027 6227 5d2c 2064 7479  (['a', 'b'], dty
-00026770: 7065 3d6f 626a 6563 7429 2c20 2764 696d  pe=object), 'dim
-00026780: 3227 3a20 6172 7261 7928 5b31 2c20 325d  2': array([1, 2]
-00026790: 297d 290a 0a20 2020 2020 2020 2020 2020  )})..           
-000267a0: 2060 6060 0a20 2020 2020 2020 2022 2222   ```.        """
-000267b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000267c0: 4172 7261 7928 6461 7461 3d28 7b64 696d  Array(data=({dim
-000267d0: 3a20 5b5d 2066 6f72 2064 696d 2069 6e20  : [] for dim in 
-000267e0: 7365 6c66 2e64 696d 737d 2c20 6e70 2e61  self.dims}, np.a
-000267f0: 7272 6179 285b 5d2c 2064 7479 7065 3d73  rray([], dtype=s
-00026800: 656c 662e 6461 7461 2e64 7479 7065 2929  elf.data.dtype))
-00026810: 2c20 636f 6f72 6473 3d73 656c 662e 636f  , coords=self.co
-00026820: 6f72 6473 290a 0a20 2020 2064 6566 2063  ords)..    def c
-00026830: 686f 6963 6528 7365 6c66 2c20 6469 6d3a  hoice(self, dim:
-00026840: 2073 7472 2c20 7365 6564 3a20 696e 7420   str, seed: int 
-00026850: 3d20 3129 202d 3e20 2741 7272 6179 273a  = 1) -> 'Array':
-00026860: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00026870: 2020 2020 2052 616e 646f 6d6c 7920 6368       Randomly ch
-00026880: 6f6f 7365 2065 6c65 6d65 6e74 7320 616c  oose elements al
-00026890: 6f6e 6720 6120 7370 6563 6966 6965 6420  ong a specified 
-000268a0: 6469 6d65 6e73 696f 6e20 6261 7365 6420  dimension based 
-000268b0: 6f6e 2074 6865 2041 7272 6179 2076 616c  on the Array val
-000268c0: 7565 7320 6173 2070 726f 6261 6269 6c69  ues as probabili
-000268d0: 7469 6573 2e0a 0a20 2020 2020 2020 2041  ties...        A
-000268e0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-000268f0: 2064 696d 3a20 5468 6520 6469 6d65 6e73   dim: The dimens
-00026900: 696f 6e20 746f 2070 6572 666f 726d 2074  ion to perform t
-00026910: 6865 2063 686f 6963 6520 616c 6f6e 672e  he choice along.
-00026920: 0a20 2020 2020 2020 2020 2020 2073 6565  .            see
-00026930: 643a 2054 6865 2072 616e 646f 6d20 7365  d: The random se
-00026940: 6564 2074 6f20 7573 6520 666f 7220 7265  ed to use for re
-00026950: 7072 6f64 7563 6962 696c 6974 792e 0a0a  producibility...
-00026960: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
-00026970: 0a20 2020 2020 2020 2020 2020 2041 206e  .            A n
-00026980: 6577 2041 7272 6179 206f 626a 6563 7420  ew Array object 
-00026990: 7769 7468 2074 6865 2063 686f 7365 6e20  with the chosen 
-000269a0: 656c 656d 656e 7473 2e0a 0a20 2020 2020  elements...     
-000269b0: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-000269c0: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-000269d0: 6e0a 2020 2020 2020 2020 2020 2020 3e3e  n.            >>
-000269e0: 3e20 636f 6f72 6473 203d 207b 2764 696d  > coords = {'dim
-000269f0: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-00026a00: 2764 696d 3227 3a20 5b31 2c20 325d 7d0a  'dim2': [1, 2]}.
-00026a10: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00026a20: 6c6f 6e67 203d 204c 6f6e 6728 696e 6465  long = Long(inde
-00026a30: 783d 7b27 6469 6d31 273a 205b 2761 272c  x={'dim1': ['a',
-00026a40: 2027 6127 2c20 2762 272c 2027 6227 5d2c   'a', 'b', 'b'],
-00026a50: 2027 6469 6d32 273a 205b 312c 2032 2c20   'dim2': [1, 2, 
-00026a60: 312c 2032 5d7d 2c20 7661 6c75 653d 5b30  1, 2]}, value=[0
-00026a70: 2e33 2c20 302e 342c 2030 2e37 2c20 302e  .3, 0.4, 0.7, 0.
-00026a80: 365d 290a 2020 2020 2020 2020 2020 2020  6]).            
-00026a90: 3e3e 3e20 6172 7220 3d20 4172 7261 7928  >>> arr = Array(
-00026aa0: 6461 7461 3d6c 6f6e 672c 2063 6f6f 7264  data=long, coord
-00026ab0: 733d 636f 6f72 6473 290a 2020 2020 2020  s=coords).      
-00026ac0: 2020 2020 2020 3e3e 3e20 6368 6f73 656e        >>> chosen
-00026ad0: 5f61 7272 203d 2061 7272 2e63 686f 6963  _arr = arr.choic
-00026ae0: 6528 6469 6d3d 2764 696d 3127 2c20 7365  e(dim='dim1', se
-00026af0: 6564 3d34 3229 0a20 2020 2020 2020 2020  ed=42).         
-00026b00: 2020 203e 3e3e 2063 686f 7365 6e5f 6172     >>> chosen_ar
-00026b10: 720a 2020 2020 2020 2020 2020 2020 4172  r.            Ar
-00026b20: 7261 7928 6461 7461 3d61 7272 6179 285b  ray(data=array([
-00026b30: 5b46 616c 7365 2c20 4661 6c73 655d 2c0a  [False, False],.
-00026b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026b50: 2020 205b 2054 7275 652c 2020 5472 7565     [ True,  True
-00026b60: 5d5d 292c 2063 6f6f 7264 733d 7b27 6469  ]]), coords={'di
-00026b70: 6d31 273a 2061 7272 6179 285b 2761 272c  m1': array(['a',
-00026b80: 2027 6227 5d2c 2064 7479 7065 3d6f 626a   'b'], dtype=obj
-00026b90: 6563 7429 2c20 2764 696d 3227 3a20 6172  ect), 'dim2': ar
-00026ba0: 7261 7928 5b31 2c20 325d 297d 290a 0a20  ray([1, 2])}).. 
-00026bb0: 2020 2020 2020 2020 2020 2060 6060 0a20             ```. 
-00026bc0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00026bd0: 2020 2072 6e67 203d 206e 702e 7261 6e64     rng = np.rand
-00026be0: 6f6d 2e64 6566 6175 6c74 5f72 6e67 2873  om.default_rng(s
-00026bf0: 6565 643d 7365 6564 290a 2020 2020 2020  eed=seed).      
-00026c00: 2020 6173 7365 7274 2064 696d 2069 6e20    assert dim in 
-00026c10: 7365 6c66 2e64 696d 732c 2066 2264 696d  self.dims, f"dim
-00026c20: 207b 6469 6d7d 206e 6f74 2069 6e20 7365   {dim} not in se
-00026c30: 6c66 2e64 696d 733a 207b 7365 6c66 2e64  lf.dims: {self.d
-00026c40: 696d 737d 220a 2020 2020 2020 2020 6178  ims}".        ax
-00026c50: 6973 203d 2073 656c 662e 6469 6d73 2e69  is = self.dims.i
-00026c60: 6e64 6578 2864 696d 290a 2020 2020 2020  ndex(dim).      
-00026c70: 2020 7072 6f62 6162 696c 6974 6965 7320    probabilities 
-00026c80: 3d20 7365 6c66 2e64 6174 610a 2020 2020  = self.data.    
-00026c90: 2020 2020 6d61 736b 203d 206e 6461 7272      mask = ndarr
-00026ca0: 6179 5f63 686f 6963 6528 703d 7072 6f62  ay_choice(p=prob
-00026cb0: 6162 696c 6974 6965 732c 2061 7869 733d  abilities, axis=
-00026cc0: 6178 6973 2c20 726e 673d 726e 6729 0a20  axis, rng=rng). 
-00026cd0: 2020 2020 2020 2061 7373 6572 7420 6d61         assert ma
-00026ce0: 736b 2e73 6861 7065 203d 3d20 7072 6f62  sk.shape == prob
-00026cf0: 6162 696c 6974 6965 732e 7368 6170 650a  abilities.shape.
-00026d00: 2020 2020 2020 2020 7265 7475 726e 2041          return A
-00026d10: 7272 6179 2864 6174 613d 6d61 736b 2c20  rray(data=mask, 
-00026d20: 636f 6f72 6473 3d73 656c 662e 636f 6f72  coords=self.coor
-00026d30: 6473 290a 0a20 2020 2064 6566 2065 7870  ds)..    def exp
-00026d40: 616e 6428 7365 6c66 2c20 2a2a 6b77 6172  and(self, **kwar
-00026d50: 6773 3a20 4469 6374 5b73 7472 2c20 556e  gs: Dict[str, Un
-00026d60: 696f 6e5b 6e70 2e6e 6461 7272 6179 2c20  ion[np.ndarray, 
-00026d70: 4c69 7374 5b73 7472 5d2c 204c 6973 745b  List[str], List[
-00026d80: 696e 745d 2c20 4c69 7374 5b66 6c6f 6174  int], List[float
-00026d90: 5d2c 204c 6973 745b 276e 702e 6461 7465  ], List['np.date
-00026da0: 7469 6d65 3634 275d 2c20 4c69 7374 5b27  time64'], List['
-00026db0: 7064 2e44 6174 6574 696d 6549 6e64 6578  pd.DatetimeIndex
-00026dc0: 275d 2c20 4c69 7374 5b27 7064 2e43 6174  '], List['pd.Cat
-00026dd0: 6567 6f72 6963 616c 275d 5d5d 2920 2d3e  egorical']]]) ->
-00026de0: 2027 4172 7261 7927 3a0a 2020 2020 2020   'Array':.      
-00026df0: 2020 2222 220a 2020 2020 2020 2020 4578    """.        Ex
-00026e00: 7061 6e64 2074 6865 2041 7272 6179 2077  pand the Array w
-00026e10: 6974 6820 6e65 7720 6469 6d65 6e73 696f  ith new dimensio
-00026e20: 6e73 2061 6e64 2063 6f6f 7264 696e 6174  ns and coordinat
-00026e30: 6573 2e20 4974 2062 726f 6164 6361 7374  es. It broadcast
-00026e40: 7320 7468 6520 7661 6c75 6573 2061 6c6f  s the values alo
-00026e50: 6e67 2074 6865 206e 6577 2064 696d 656e  ng the new dimen
-00026e60: 7369 6f6e 732e 0a0a 2020 2020 2020 2020  sions...        
-00026e70: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-00026e80: 2020 2a2a 6b77 6172 6773 3a20 4b65 7977    **kwargs: Keyw
-00026e90: 6f72 6420 6172 6775 6d65 6e74 7320 7370  ord arguments sp
-00026ea0: 6563 6966 7969 6e67 2074 6865 206e 6577  ecifying the new
-00026eb0: 2064 696d 656e 7369 6f6e 7320 616e 6420   dimensions and 
-00026ec0: 7468 6569 7220 636f 6f72 6469 6e61 7465  their coordinate
-00026ed0: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
-00026ee0: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
-00026ef0: 2041 206e 6577 2041 7272 6179 206f 626a   A new Array obj
-00026f00: 6563 7420 7769 7468 2074 6865 2065 7870  ect with the exp
-00026f10: 616e 6465 6420 6469 6d65 6e73 696f 6e73  anded dimensions
-00026f20: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-00026f30: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-00026f40: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
-00026f50: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
-00026f60: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
-00026f70: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
-00026f80: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
-00026f90: 2020 2020 3e3e 3e20 6c6f 6e67 203d 204c      >>> long = L
-00026fa0: 6f6e 6728 696e 6465 783d 7b27 6469 6d31  ong(index={'dim1
-00026fb0: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
-00026fc0: 6469 6d32 273a 205b 312c 2032 5d7d 2c20  dim2': [1, 2]}, 
-00026fd0: 7661 6c75 653d 5b31 302c 2032 305d 290a  value=[10, 20]).
-00026fe0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00026ff0: 6172 7220 3d20 4172 7261 7928 6461 7461  arr = Array(data
-00027000: 3d6c 6f6e 672c 2063 6f6f 7264 733d 636f  =long, coords=co
-00027010: 6f72 6473 290a 2020 2020 2020 2020 2020  ords).          
-00027020: 2020 3e3e 3e20 6578 7061 6e64 6564 5f61    >>> expanded_a
-00027030: 7272 203d 2061 7272 2e65 7870 616e 6428  rr = arr.expand(
-00027040: 6e65 775f 6469 6d3d 5b27 7827 2c27 7927  new_dim=['x','y'
-00027050: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
-00027060: 3e3e 2065 7870 616e 6465 645f 6172 722e  >> expanded_arr.
-00027070: 7265 6f72 6465 7228 7265 6f72 6465 723d  reorder(reorder=
-00027080: 5b27 6469 6d31 272c 2027 6469 6d32 272c  ['dim1', 'dim2',
-00027090: 2027 6e65 775f 6469 6d27 5d29 0a20 2020   'new_dim']).   
-000270a0: 2020 2020 2020 2020 2041 7272 6179 2864           Array(d
-000270b0: 6174 613d 6172 7261 7928 5b5b 5b31 302e  ata=array([[[10.
-000270c0: 2c20 3130 2e5d 2c0a 2020 2020 2020 2020  , 10.],.        
-000270d0: 2020 2020 2020 2020 2020 2020 5b20 302e              [ 0.
-000270e0: 2c20 2030 2e5d 5d2c 0a20 2020 2020 2020  ,  0.]],.       
-000270f0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-00027100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027110: 2020 2020 5b5b 2030 2e2c 2020 302e 5d2c      [[ 0.,  0.],
-00027120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027130: 2020 2020 205b 3230 2e2c 2032 302e 5d5d       [20., 20.]]
-00027140: 5d29 2c20 636f 6f72 6473 3d7b 2764 696d  ]), coords={'dim
-00027150: 3127 3a20 6172 7261 7928 5b27 6127 2c20  1': array(['a', 
-00027160: 2762 275d 2c20 6474 7970 653d 6f62 6a65  'b'], dtype=obje
-00027170: 6374 292c 2027 6469 6d32 273a 2061 7272  ct), 'dim2': arr
-00027180: 6179 285b 312c 2032 5d29 2c20 276e 6577  ay([1, 2]), 'new
-00027190: 5f64 696d 273a 2061 7272 6179 285b 2778  _dim': array(['x
-000271a0: 272c 2027 7927 5d2c 2064 7479 7065 3d6f  ', 'y'], dtype=o
-000271b0: 626a 6563 7429 7d29 0a0a 2020 2020 2020  bject)})..      
-000271c0: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
-000271d0: 2020 2222 220a 2020 2020 2020 2020 7479    """.        ty
-000271e0: 7065 7320 3d20 7b7d 0a20 2020 2020 2020  pes = {}.       
-000271f0: 2066 6f72 2064 696d 2069 6e20 6b77 6172   for dim in kwar
-00027200: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-00027210: 6173 7365 7274 2064 696d 206e 6f74 2069  assert dim not i
-00027220: 6e20 7365 6c66 2e64 696d 732c 2066 2264  n self.dims, f"d
-00027230: 696d 207b 6469 6d7d 2061 6c72 6561 6479  im {dim} already
-00027240: 2065 7869 7374 7320 696e 2073 656c 662e   exists in self.
-00027250: 6469 6d73 3a20 7b73 656c 662e 6469 6d73  dims: {self.dims
-00027260: 7d22 0a20 2020 2020 2020 2020 2020 2074  }".            t
-00027270: 7970 6573 5b64 696d 5d20 3d20 5f74 6573  ypes[dim] = _tes
-00027280: 745f 7479 7065 5f61 6e64 5f75 7064 6174  t_type_and_updat
-00027290: 6528 6b77 6172 6773 5b64 696d 5d29 2e64  e(kwargs[dim]).d
-000272a0: 7479 7065 0a20 2020 2020 2020 2072 6574  type.        ret
-000272b0: 7572 6e20 7365 6c66 2e65 6d70 7479 2829  urn self.empty()
-000272c0: 2e69 6e73 6572 7428 2a2a 7479 7065 7329  .insert(**types)
-000272d0: 2e61 6464 5f65 6c65 6d28 2a2a 6b77 6172  .add_elem(**kwar
-000272e0: 6773 2920 2b20 7365 6c66 0a0a 2020 2020  gs) + self..    
-000272f0: 6465 6620 7566 756e 6328 7365 6c66 2c20  def ufunc(self, 
-00027300: 6469 6d3a 2073 7472 2c20 6675 6e63 3a20  dim: str, func: 
-00027310: 4361 6c6c 6162 6c65 2c20 6b65 6570 6469  Callable, keepdi
-00027320: 6d73 3a20 626f 6f6c 203d 2046 616c 7365  ms: bool = False
-00027330: 2c20 2a2a 6675 6e63 5f6b 7761 7267 733a  , **func_kwargs:
-00027340: 2041 6e79 2920 2d3e 2027 4172 7261 7927   Any) -> 'Array'
-00027350: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00027360: 2020 2020 2020 4170 706c 7920 6120 756e        Apply a un
-00027370: 6976 6572 7361 6c20 6675 6e63 7469 6f6e  iversal function
-00027380: 2061 6c6f 6e67 2061 2073 7065 6369 6669   along a specifi
-00027390: 6564 2064 696d 656e 7369 6f6e 206f 6620  ed dimension of 
-000273a0: 7468 6520 4172 7261 792e 0a0a 2020 2020  the Array...    
-000273b0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-000273c0: 2020 2020 2020 6469 6d3a 2054 6865 2064        dim: The d
-000273d0: 696d 656e 7369 6f6e 2074 6f20 6170 706c  imension to appl
-000273e0: 7920 7468 6520 6675 6e63 7469 6f6e 2061  y the function a
-000273f0: 6c6f 6e67 2e0a 2020 2020 2020 2020 2020  long..          
-00027400: 2020 6675 6e63 3a20 5468 6520 756e 6976    func: The univ
-00027410: 6572 7361 6c20 6675 6e63 7469 6f6e 2074  ersal function t
-00027420: 6f20 6170 706c 792e 0a20 2020 2020 2020  o apply..       
-00027430: 2020 2020 206b 6565 7064 696d 733a 2057       keepdims: W
-00027440: 6865 7468 6572 2074 6f20 6b65 6570 2074  hether to keep t
-00027450: 6865 2072 6564 7563 6564 2064 696d 656e  he reduced dimen
-00027460: 7369 6f6e 2069 6e20 7468 6520 7265 7375  sion in the resu
-00027470: 6c74 2e0a 2020 2020 2020 2020 2020 2020  lt..            
-00027480: 2a2a 6675 6e63 5f6b 7761 7267 733a 2041  **func_kwargs: A
-00027490: 6464 6974 696f 6e61 6c20 6b65 7977 6f72  dditional keywor
-000274a0: 6420 6172 6775 6d65 6e74 7320 746f 2070  d arguments to p
-000274b0: 6173 7320 746f 2074 6865 2066 756e 6374  ass to the funct
-000274c0: 696f 6e2e 0a0a 2020 2020 2020 2020 5265  ion...        Re
-000274d0: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
-000274e0: 2020 2041 206e 6577 2041 7272 6179 206f     A new Array o
-000274f0: 626a 6563 7420 7769 7468 2074 6865 2066  bject with the f
-00027500: 756e 6374 696f 6e20 6170 706c 6965 642e  unction applied.
-00027510: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00027520: 653a 0a20 2020 2020 2020 2020 2020 2060  e:.            `
-00027530: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-00027540: 2020 2020 203e 3e3e 2063 6f6f 7264 7320       >>> coords 
-00027550: 3d20 7b27 6469 6d31 273a 205b 2761 272c  = {'dim1': ['a',
-00027560: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-00027570: 312c 2032 5d7d 0a20 2020 2020 2020 2020  1, 2]}.         
-00027580: 2020 203e 3e3e 206c 6f6e 6720 3d20 4c6f     >>> long = Lo
-00027590: 6e67 2869 6e64 6578 3d7b 2764 696d 3127  ng(index={'dim1'
-000275a0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
-000275b0: 696d 3227 3a20 5b31 2c20 325d 7d2c 2076  im2': [1, 2]}, v
-000275c0: 616c 7565 3d5b 3130 2c20 3230 5d29 0a20  alue=[10, 20]). 
-000275d0: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
-000275e0: 7272 203d 2041 7272 6179 2864 6174 613d  rr = Array(data=
-000275f0: 6c6f 6e67 2c20 636f 6f72 6473 3d63 6f6f  long, coords=coo
-00027600: 7264 7329 0a20 2020 2020 2020 2020 2020  rds).           
-00027610: 203e 3e3e 2072 6573 756c 745f 6172 7220   >>> result_arr 
-00027620: 3d20 6172 722e 7566 756e 6328 6469 6d3d  = arr.ufunc(dim=
-00027630: 2764 696d 3127 2c20 6675 6e63 3d6e 702e  'dim1', func=np.
-00027640: 7375 6d2c 206b 6565 7064 696d 733d 5472  sum, keepdims=Tr
-00027650: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
-00027660: 3e3e 3e20 7265 7375 6c74 5f61 7272 0a20  >>> result_arr. 
-00027670: 2020 2020 2020 2020 2020 2041 7272 6179             Array
-00027680: 2864 6174 613d 6172 7261 7928 5b5b 3130  (data=array([[10
-00027690: 2e2c 2032 302e 5d2c 0a20 2020 2020 2020  ., 20.],.       
-000276a0: 2020 2020 2020 2020 2020 2020 5b31 302e              [10.
-000276b0: 2c20 3230 2e5d 5d29 2c20 636f 6f72 6473  , 20.]]), coords
-000276c0: 3d7b 2764 696d 3127 3a20 6172 7261 7928  ={'dim1': array(
-000276d0: 5b27 6127 2c20 2762 275d 2c20 6474 7970  ['a', 'b'], dtyp
-000276e0: 653d 6f62 6a65 6374 292c 2027 6469 6d32  e=object), 'dim2
-000276f0: 273a 2061 7272 6179 285b 312c 2032 5d29  ': array([1, 2])
-00027700: 7d29 0a0a 2020 2020 2020 2020 2020 2020  })..            
-00027710: 6060 600a 2020 2020 2020 2020 2222 220a  ```.        """.
-00027720: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
-00027730: 656c 662e 6469 6d73 2e69 6e64 6578 2864  elf.dims.index(d
-00027740: 696d 290a 2020 2020 2020 2020 7265 7375  im).        resu
-00027750: 6c74 203d 2066 756e 6328 7365 6c66 2e74  lt = func(self.t
-00027760: 6f64 656e 7365 2829 2c20 6178 6973 3d61  odense(), axis=a
-00027770: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
-00027780: 2020 2020 2020 2020 2020 206b 6565 7064             keepd
-00027790: 696d 733d 6b65 6570 6469 6d73 2c20 2a2a  ims=keepdims, **
-000277a0: 6675 6e63 5f6b 7761 7267 7329 0a20 2020  func_kwargs).   
-000277b0: 2020 2020 2069 6620 6b65 6570 6469 6d73       if keepdims
-000277c0: 3a0a 2020 2020 2020 2020 2020 2020 7368  :.            sh
-000277d0: 6170 6520 3d20 7365 6c66 2e73 6861 7065  ape = self.shape
-000277e0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-000277f0: 756c 7420 3d20 6e70 2e62 726f 6164 6361  ult = np.broadca
-00027800: 7374 5f74 6f28 7265 7375 6c74 2c20 7368  st_to(result, sh
-00027810: 6170 6529 0a20 2020 2020 2020 2020 2020  ape).           
-00027820: 2063 6f6f 7264 7320 3d20 7b64 3a20 7365   coords = {d: se
-00027830: 6c66 2e63 6f6f 7264 735b 645d 2066 6f72  lf.coords[d] for
-00027840: 2064 2069 6e20 7365 6c66 2e63 6f6f 7264   d in self.coord
-00027850: 737d 0a20 2020 2020 2020 2065 6c73 653a  s}.        else:
-00027860: 0a20 2020 2020 2020 2020 2020 2063 6f6f  .            coo
-00027870: 7264 7320 3d20 7b64 3a20 7365 6c66 2e63  rds = {d: self.c
-00027880: 6f6f 7264 735b 645d 2066 6f72 2064 2069  oords[d] for d i
-00027890: 6e20 7365 6c66 2e63 6f6f 7264 7320 6966  n self.coords if
-000278a0: 2064 2021 3d20 6469 6d7d 0a20 2020 2020   d != dim}.     
-000278b0: 2020 2072 6574 7572 6e20 4172 7261 7928     return Array(
-000278c0: 6461 7461 3d72 6573 756c 742c 2063 6f6f  data=result, coo
-000278d0: 7264 733d 636f 6f72 6473 290a 0a20 2020  rds=coords)..   
-000278e0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-000278f0: 6566 2064 6628 7365 6c66 2920 2d3e 2055  ef df(self) -> U
-00027900: 6e69 6f6e 5b27 7064 2e44 6174 6146 7261  nion['pd.DataFra
-00027910: 6d65 272c 2027 706c 2e44 6174 6146 7261  me', 'pl.DataFra
-00027920: 6d65 275d 3a0a 2020 2020 2020 2020 2222  me']:.        ""
-00027930: 220a 2020 2020 2020 2020 4765 7420 7468  ".        Get th
-00027940: 6520 4461 7461 4672 616d 6520 7265 7072  e DataFrame repr
-00027950: 6573 656e 7461 7469 6f6e 206f 6620 7468  esentation of th
-00027960: 6520 4172 7261 7920 6261 7365 6420 6f6e  e Array based on
-00027970: 2074 6865 2064 6566 6175 6c74 2073 6574   the default set
-00027980: 7469 6e67 2e0a 0a20 2020 2020 2020 2052  ting...        R
-00027990: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-000279a0: 2020 2020 4120 4461 7461 4672 616d 6520      A DataFrame 
-000279b0: 2870 616e 6461 7320 6f72 2070 6f6c 6172  (pandas or polar
-000279c0: 7329 2072 6570 7265 7365 6e74 696e 6720  s) representing 
-000279d0: 7468 6520 4172 7261 792e 0a0a 2020 2020  the Array...    
-000279e0: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
-000279f0: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-00027a00: 6f6e 0a20 2020 2020 2020 2020 2020 203e  on.            >
-00027a10: 3e3e 2063 6f6f 7264 7320 3d20 7b27 6469  >> coords = {'di
-00027a20: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
-00027a30: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
-00027a40: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00027a50: 206c 6f6e 6720 3d20 4c6f 6e67 2869 6e64   long = Long(ind
-00027a60: 6578 3d7b 2764 696d 3127 3a20 5b27 6127  ex={'dim1': ['a'
-00027a70: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
-00027a80: 5b31 2c20 325d 7d2c 2076 616c 7565 3d5b  [1, 2]}, value=[
-00027a90: 3130 2c20 3230 5d29 0a20 2020 2020 2020  10, 20]).       
-00027aa0: 2020 2020 203e 3e3e 2061 7272 203d 2041       >>> arr = A
-00027ab0: 7272 6179 2864 6174 613d 6c6f 6e67 2c20  rray(data=long, 
-00027ac0: 636f 6f72 6473 3d63 6f6f 7264 7329 0a20  coords=coords). 
-00027ad0: 2020 2020 2020 2020 2020 203e 3e3e 2061             >>> a
-00027ae0: 7272 2e64 660a 2020 2020 2020 2020 2020  rr.df.          
-00027af0: 2020 2020 6469 6d31 2020 6469 6d32 2020      dim1  dim2  
-00027b00: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00027b10: 2020 3020 2020 2061 2020 2020 2031 2020    0    a     1  
-00027b20: 2020 2031 300a 2020 2020 2020 2020 2020     10.          
-00027b30: 2020 3120 2020 2061 2020 2020 2032 2020    1    a     2  
-00027b40: 2020 2020 300a 2020 2020 2020 2020 2020      0.          
-00027b50: 2020 3220 2020 2062 2020 2020 2031 2020    2    b     1  
-00027b60: 2020 2020 300a 2020 2020 2020 2020 2020      0.          
-00027b70: 2020 3320 2020 2062 2020 2020 2032 2020    3    b     2  
-00027b80: 2020 2032 300a 0a20 2020 2020 2020 2020     20..         
-00027b90: 2020 2060 6060 0a20 2020 2020 2020 2022     ```.        "
-00027ba0: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
-00027bb0: 6c66 2e64 665f 7769 7468 203d 3d20 2270  lf.df_with == "p
-00027bc0: 616e 6461 7322 3a0a 2020 2020 2020 2020  andas":.        
-00027bd0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00027be0: 746f 5f70 616e 6461 7328 290a 2020 2020  to_pandas().    
-00027bf0: 2020 2020 656c 6966 2073 656c 662e 6466      elif self.df
-00027c00: 5f77 6974 6820 3d3d 2022 706f 6c61 7273  _with == "polars
-00027c10: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
-00027c20: 6574 7572 6e20 7365 6c66 2e74 6f5f 706f  eturn self.to_po
-00027c30: 6c61 7273 2829 0a20 2020 2020 2020 2065  lars().        e
-00027c40: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00027c50: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
-00027c60: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00027c70: 2020 226b 612e 7365 7474 696e 6773 2e64    "ka.settings.d
-00027c80: 665f 7769 7468 206d 7573 7420 6265 2065  f_with must be e
-00027c90: 6974 6865 7220 2770 616e 6461 7327 206f  ither 'pandas' o
-00027ca0: 7220 2770 6f6c 6172 7327 2229 0a0a 2020  r 'polars'")..  
-00027cb0: 2020 6465 6620 746f 6465 6e73 6528 7365    def todense(se
-00027cc0: 6c66 2920 2d3e 206e 702e 6e64 6172 7261  lf) -> np.ndarra
-00027cd0: 793a 0a20 2020 2020 2020 2022 2222 0a20  y:.        """. 
-00027ce0: 2020 2020 2020 2054 616b 6573 2064 6174         Takes dat
-00027cf0: 6120 7072 6f70 6572 7479 2061 6e64 2070  a property and p
-00027d00: 726f 7669 6465 2061 2064 656e 7365 206e  rovide a dense n
-00027d10: 756d 7079 2061 7272 6179 2e20 4966 2064  umpy array. If d
-00027d20: 6174 6120 7072 6f70 6572 7479 2072 6574  ata property ret
-00027d30: 7572 6e20 6120 7370 6172 7365 206f 626a  urn a sparse obj
-00027d40: 6563 7420 7468 656e 2063 6f6e 7665 7274  ect then convert
-00027d50: 2069 7420 746f 2061 2064 656e 7365 206e   it to a dense n
-00027d60: 756d 7079 2061 7272 6179 2e20 4966 2069  umpy array. If i
-00027d70: 7420 7265 7475 726e 7320 6465 6e73 6520  t returns dense 
-00027d80: 6f62 6a65 6374 2074 6865 6e20 7265 7475  object then retu
-00027d90: 726e 2074 6865 206f 7269 6769 6e61 6c20  rn the original 
-00027da0: 6465 6e73 6520 6e75 6d70 7920 6172 7261  dense numpy arra
-00027db0: 792e 0a0a 2020 2020 2020 2020 5265 7475  y...        Retu
-00027dc0: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
-00027dd0: 2041 2064 656e 7365 206e 756d 7079 2061   A dense numpy a
-00027de0: 7272 6179 2e0a 2020 2020 2020 2020 2222  rray..        ""
-00027df0: 220a 2020 2020 2020 2020 6966 2069 7369  ".        if isi
-00027e00: 6e73 7461 6e63 6528 7365 6c66 2e64 6174  nstance(self.dat
-00027e10: 612c 206e 702e 6e64 6172 7261 7929 3a0a  a, np.ndarray):.
-00027e20: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00027e30: 726e 2073 656c 662e 6461 7461 0a20 2020  rn self.data.   
-00027e40: 2020 2020 2065 6c69 6620 5f69 7369 6e73       elif _isins
-00027e50: 7461 6e63 655f 6f70 7469 6f6e 616c 5f70  tance_optional_p
-00027e60: 6b67 7328 7365 6c66 2e64 6174 612c 2027  kgs(self.data, '
-00027e70: 7370 2e43 4f4f 2729 3a0a 2020 2020 2020  sp.COO'):.      
-00027e80: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00027e90: 662e 6461 7461 2e74 6f64 656e 7365 2829  f.data.todense()
-00027ea0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00027eb0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00027ec0: 2045 7863 6570 7469 6f6e 2866 2249 6e76   Exception(f"Inv
-00027ed0: 616c 6964 2074 7970 6520 666f 7220 2764  alid type for 'd
-00027ee0: 6174 6127 3a20 7b74 7970 6528 7365 6c66  ata': {type(self
-00027ef0: 2e64 6174 6129 7d22 290a 0a20 2020 2064  .data)}")..    d
-00027f00: 6566 205f 6368 6563 6b5f 6475 706c 6963  ef _check_duplic
-00027f10: 6174 655f 696e 6465 7865 7328 7365 6c66  ate_indexes(self
-00027f20: 2c20 696e 6465 7865 733a 206e 702e 6e64  , indexes: np.nd
-00027f30: 6172 7261 792c 2064 696d 733a 204c 6973  array, dims: Lis
-00027f40: 745b 7374 725d 2c20 636f 6f72 6473 3a20  t[str], coords: 
-00027f50: 4469 6374 5b73 7472 2c20 6e70 2e6e 6461  Dict[str, np.nda
-00027f60: 7272 6179 5d29 202d 3e20 4e6f 6e65 3a0a  rray]) -> None:.
-00027f70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00027f80: 2020 2020 4368 6563 6b20 6966 2074 6865      Check if the
-00027f90: 2069 6e64 6578 6573 2063 6f6e 7461 696e   indexes contain
-00027fa0: 7320 6475 706c 6963 6174 6520 7661 6c75  s duplicate valu
-00027fb0: 6573 2e0a 0a20 2020 2020 2020 2041 7267  es...        Arg
-00027fc0: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-00027fd0: 6e64 6578 6573 3a20 5468 6520 696e 6465  ndexes: The inde
-00027fe0: 7865 7320 746f 2063 6865 636b 2e0a 2020  xes to check..  
-00027ff0: 2020 2020 2020 2020 2020 6469 6d73 3a20            dims: 
-00028000: 5468 6520 6469 6d65 6e73 696f 6e73 206f  The dimensions o
-00028010: 6620 7468 6520 696e 6465 7865 732e 0a20  f the indexes.. 
-00028020: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
-00028030: 733a 2054 6865 2063 6f6f 7264 696e 6174  s: The coordinat
-00028040: 6573 206f 6620 7468 6520 696e 6465 7865  es of the indexe
-00028050: 732e 0a0a 2020 2020 2020 2020 5261 6973  s...        Rais
-00028060: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00028070: 5661 6c75 6545 7272 6f72 3a20 4966 2074  ValueError: If t
-00028080: 6865 2069 6e64 6578 6573 2063 6f6e 7461  he indexes conta
-00028090: 696e 7320 6475 706c 6963 6174 6520 7661  ins duplicate va
-000280a0: 6c75 6573 2e0a 0a20 2020 2020 2020 2045  lues...        E
-000280b0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-000280c0: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
-000280d0: 2020 2020 2020 2020 2020 3e3e 3e20 636f            >>> co
-000280e0: 6f72 6473 203d 207b 2764 696d 3127 3a20  ords = {'dim1': 
-000280f0: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
-00028100: 3227 3a20 5b31 2c20 325d 7d0a 2020 2020  2': [1, 2]}.    
-00028110: 2020 2020 2020 2020 3e3e 3e20 6c6f 6e67          >>> long
-00028120: 203d 204c 6f6e 6728 696e 6465 783d 7b27   = Long(index={'
-00028130: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
-00028140: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
-00028150: 5d7d 2c20 7661 6c75 653d 5b31 302c 2032  ]}, value=[10, 2
-00028160: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-00028170: 3e3e 3e20 6172 7220 3d20 4172 7261 7928  >>> arr = Array(
-00028180: 6461 7461 3d6c 6f6e 672c 2063 6f6f 7264  data=long, coord
-00028190: 733d 636f 6f72 6473 290a 2020 2020 2020  s=coords).      
-000281a0: 2020 2020 2020 3e3e 3e20 6172 722e 5f63        >>> arr._c
-000281b0: 6865 636b 5f64 7570 6c69 6361 7465 5f69  heck_duplicate_i
-000281c0: 6e64 6578 6573 2869 6e64 6578 6573 3d6e  ndexes(indexes=n
-000281d0: 702e 6172 7261 7928 5b30 2c20 302c 2031  p.array([0, 0, 1
-000281e0: 5d29 2c20 6469 6d73 3d5b 2764 696d 3127  ]), dims=['dim1'
-000281f0: 2c20 2764 696d 3227 5d2c 2063 6f6f 7264  , 'dim2'], coord
-00028200: 733d 636f 6f72 6473 290a 2020 2020 2020  s=coords).      
-00028210: 2020 2020 2020 5472 6163 6562 6163 6b20        Traceback 
-00028220: 286d 6f73 7420 7265 6365 6e74 2063 616c  (most recent cal
-00028230: 6c20 6c61 7374 293a 0a20 2020 2020 2020  l last):.       
-00028240: 2020 2020 202e 2e2e 0a20 2020 2020 2020       ....       
-00028250: 2020 2020 2056 616c 7565 4572 726f 723a       ValueError:
-00028260: 2054 6865 204c 6f6e 6720 6f62 6a65 6374   The Long object
-00028270: 2063 6f6e 7461 696e 7320 6475 706c 6963   contains duplic
-00028280: 6174 6520 696e 6465 7865 732e 2044 7570  ate indexes. Dup
-00028290: 6c69 6361 7465 2069 6e64 6578 6573 2061  licate indexes a
-000282a0: 7265 3a20 5b7b 276c 6f63 273a 207b 2764  re: [{'loc': {'d
-000282b0: 696d 3127 3a20 2761 272c 2027 6469 6d32  im1': 'a', 'dim2
-000282c0: 273a 2031 7d2c 2027 636f 756e 7427 3a20  ': 1}, 'count': 
-000282d0: 327d 5d2e 0a0a 2020 2020 2020 2020 2020  2}]...          
-000282e0: 2020 6060 600a 2020 2020 2020 2020 2222    ```.        ""
-000282f0: 220a 2020 2020 2020 2020 6966 206e 6f74  ".        if not
-00028300: 206e 702e 756e 6971 7565 2869 6e64 6578   np.unique(index
-00028310: 6573 292e 7369 7a65 203d 3d20 696e 6465  es).size == inde
-00028320: 7865 732e 7369 7a65 3a0a 2020 2020 2020  xes.size:.      
-00028330: 2020 2020 2020 636f 756e 745f 7265 7065        count_repe
-00028340: 6174 6564 203d 206e 702e 6269 6e63 6f75  ated = np.bincou
-00028350: 6e74 2869 6e64 6578 6573 290a 2020 2020  nt(indexes).    
-00028360: 2020 2020 2020 2020 6475 706c 6963 6174          duplicat
-00028370: 655f 696e 6465 7865 7320 3d20 6e70 2e77  e_indexes = np.w
-00028380: 6865 7265 2863 6f75 6e74 5f72 6570 6561  here(count_repea
-00028390: 7465 6420 3e20 3129 5b30 5d0a 2020 2020  ted > 1)[0].    
-000283a0: 2020 2020 2020 2020 7265 7065 6174 6564          repeated
-000283b0: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
-000283c0: 2020 6172 7261 7973 203d 206e 702e 756e    arrays = np.un
-000283d0: 7261 7665 6c5f 696e 6465 7828 696e 6465  ravel_index(inde
-000283e0: 7865 732c 2073 656c 662e 5f73 6861 7065  xes, self._shape
-000283f0: 2863 6f6f 7264 7329 290a 2020 2020 2020  (coords)).      
-00028400: 2020 2020 2020 696e 6465 785f 6469 6374        index_dict
-00028410: 203d 207b 6469 6d3a 2063 6f6f 7264 735b   = {dim: coords[
-00028420: 6469 6d5d 5b69 6478 5d0a 2020 2020 2020  dim][idx].      
-00028430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028440: 2020 2020 666f 7220 6469 6d2c 2069 6478      for dim, idx
-00028450: 2069 6e20 7a69 7028 636f 6f72 6473 2c20   in zip(coords, 
-00028460: 6172 7261 7973 297d 0a20 2020 2020 2020  arrays)}.       
-00028470: 2020 2020 2066 6f72 2069 2069 6e20 6475       for i in du
-00028480: 706c 6963 6174 655f 696e 6465 7865 733a  plicate_indexes:
-00028490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000284a0: 2072 6570 6561 7465 642e 6170 7065 6e64   repeated.append
-000284b0: 287b 276c 6f63 273a 207b 6469 6d3a 2069  ({'loc': {dim: i
-000284c0: 6e64 6578 5f64 6963 745b 6469 6d5d 5b6e  ndex_dict[dim][n
-000284d0: 702e 6172 676d 6178 280a 2020 2020 2020  p.argmax(.      
-000284e0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000284f0: 6465 7865 7320 3d3d 2069 295d 2066 6f72  dexes == i)] for
-00028500: 2064 696d 2069 6e20 6469 6d73 7d2c 2027   dim in dims}, '
-00028510: 636f 756e 7427 3a20 636f 756e 745f 7265  count': count_re
-00028520: 7065 6174 6564 5b69 5d7d 290a 2020 2020  peated[i]}).    
-00028530: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00028540: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00028550: 2020 2020 2020 2020 2020 6622 5468 6520            f"The 
-00028560: 4c6f 6e67 206f 626a 6563 7420 636f 6e74  Long object cont
-00028570: 6169 6e73 2064 7570 6c69 6361 7465 2069  ains duplicate i
-00028580: 6e64 6578 6573 2e20 4475 706c 6963 6174  ndexes. Duplicat
-00028590: 6520 696e 6465 7865 7320 6172 653a 207b  e indexes are: {
-000285a0: 7265 7065 6174 6564 7d2e 2229 0a0a 0a64  repeated}.")...d
-000285b0: 6566 2063 6f6e 6361 7428 6172 7261 7973  ef concat(arrays
-000285c0: 3a20 4c69 7374 5b41 7272 6179 5d29 202d  : List[Array]) -
-000285d0: 3e20 4172 7261 793a 0a20 2020 2022 2222  > Array:.    """
-000285e0: 0a20 2020 2043 6f6e 6361 7465 6e61 7465  .    Concatenate
-000285f0: 206d 756c 7469 706c 6520 4172 7261 7920   multiple Array 
-00028600: 6f62 6a65 6374 7320 616c 6f6e 6720 6120  objects along a 
-00028610: 6e65 7720 6469 6d65 6e73 696f 6e2e 0a0a  new dimension...
-00028620: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00028630: 2020 6172 7261 7973 3a20 4120 6c69 7374    arrays: A list
-00028640: 206f 6620 4172 7261 7920 6f62 6a65 6374   of Array object
-00028650: 7320 746f 2063 6f6e 6361 7465 6e61 7465  s to concatenate
-00028660: 2e0a 0a20 2020 2052 6574 7572 6e73 3a0a  ...    Returns:.
-00028670: 2020 2020 2020 2020 4120 6e65 7720 4172          A new Ar
-00028680: 7261 7920 6f62 6a65 6374 2077 6974 6820  ray object with 
-00028690: 7468 6520 636f 6e63 6174 656e 6174 6564  the concatenated
-000286a0: 2061 7272 6179 732e 0a0a 2020 2020 4578   arrays...    Ex
-000286b0: 616d 706c 653a 0a20 2020 2020 2020 2060  ample:.        `
-000286c0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-000286d0: 203e 3e3e 2063 6f6f 7264 7320 3d20 7b27   >>> coords = {'
-000286e0: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
-000286f0: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
-00028700: 5d7d 0a20 2020 2020 2020 203e 3e3e 206c  ]}.        >>> l
-00028710: 6f6e 6731 203d 204c 6f6e 6728 696e 6465  ong1 = Long(inde
-00028720: 783d 7b27 6469 6d31 273a 205b 2761 272c  x={'dim1': ['a',
-00028730: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-00028740: 312c 2031 5d7d 2c20 7661 6c75 653d 5b31  1, 1]}, value=[1
-00028750: 302c 2032 305d 290a 2020 2020 2020 2020  0, 20]).        
-00028760: 3e3e 3e20 6172 7231 203d 2041 7272 6179  >>> arr1 = Array
-00028770: 2864 6174 613d 6c6f 6e67 312c 2063 6f6f  (data=long1, coo
-00028780: 7264 733d 636f 6f72 6473 290a 2020 2020  rds=coords).    
-00028790: 2020 2020 3e3e 3e20 6c6f 6e67 3220 3d20      >>> long2 = 
-000287a0: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
-000287b0: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-000287c0: 2764 696d 3227 3a20 5b32 2c20 325d 7d2c  'dim2': [2, 2]},
-000287d0: 2076 616c 7565 3d5b 3330 2c20 3430 5d29   value=[30, 40])
-000287e0: 0a20 2020 2020 2020 203e 3e3e 2061 7272  .        >>> arr
-000287f0: 3220 3d20 4172 7261 7928 6461 7461 3d6c  2 = Array(data=l
-00028800: 6f6e 6732 2c20 636f 6f72 6473 3d63 6f6f  ong2, coords=coo
-00028810: 7264 7329 0a20 2020 2020 2020 203e 3e3e  rds).        >>>
-00028820: 2063 6f6e 6361 7465 6e61 7465 645f 6172   concatenated_ar
-00028830: 7220 3d20 636f 6e63 6174 285b 6172 7231  r = concat([arr1
-00028840: 2c20 6172 7232 5d29 0a20 2020 2020 2020  , arr2]).       
-00028850: 203e 3e3e 2063 6f6e 6361 7465 6e61 7465   >>> concatenate
-00028860: 645f 6172 720a 2020 2020 2020 2020 4172  d_arr.        Ar
-00028870: 7261 7928 6461 7461 3d61 7272 6179 285b  ray(data=array([
-00028880: 5b31 302c 2033 305d 2c0a 2020 2020 2020  [10, 30],.      
-00028890: 2020 2020 2020 2020 205b 3230 2c20 3430           [20, 40
-000288a0: 5d5d 292c 2063 6f6f 7264 733d 7b27 6469  ]]), coords={'di
-000288b0: 6d31 273a 2061 7272 6179 285b 2761 272c  m1': array(['a',
-000288c0: 2027 6227 5d2c 2064 7479 7065 3d6f 626a   'b'], dtype=obj
-000288d0: 6563 7429 2c20 2764 696d 3227 3a20 6172  ect), 'dim2': ar
-000288e0: 7261 7928 5b31 2c20 325d 297d 290a 0a20  ray([1, 2])}).. 
-000288f0: 2020 2020 2020 2060 6060 0a20 2020 2022         ```.    "
-00028900: 2222 0a20 2020 2064 696d 7320 3d20 6172  "".    dims = ar
-00028910: 7261 7973 5b30 5d2e 6469 6d73 5b3a 5d0a  rays[0].dims[:].
-00028920: 2020 2020 6173 7365 7274 2061 6c6c 285b      assert all([
-00028930: 6973 696e 7374 616e 6365 2861 7272 2c20  isinstance(arr, 
-00028940: 4172 7261 7929 2066 6f72 2061 7272 2069  Array) for arr i
-00028950: 6e20 6172 7261 7973 5d0a 2020 2020 2020  n arrays].      
-00028960: 2020 2020 2020 2020 2029 2c20 2241 6c6c           ), "All
-00028970: 206c 6973 7420 6974 656d 7320 6d75 7374   list items must
-00028980: 2062 6520 6b61 7272 6179 2e61 7272 6179   be karray.array
-00028990: 220a 2020 2020 6173 7365 7274 2061 6c6c  ".    assert all
-000289a0: 285b 7365 7428 6172 722e 6469 6d73 2920  ([set(arr.dims) 
-000289b0: 3d3d 2073 6574 2864 696d 7329 2066 6f72  == set(dims) for
-000289c0: 2061 7272 2069 6e20 6172 7261 7973 5d0a   arr in arrays].
-000289d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000289e0: 2c20 2241 6c6c 2061 7272 6179 206d 7573  , "All array mus
-000289f0: 7420 6861 7665 2074 6865 2073 616d 6520  t have the same 
-00028a00: 6469 6d65 6e73 696f 6e73 220a 2020 2020  dimensions".    
-00028a10: 696e 6465 7820 3d20 7b64 696d 3a20 5b5d  index = {dim: []
-00028a20: 2066 6f72 2064 696d 2069 6e20 6469 6d73   for dim in dims
-00028a30: 7d0a 2020 2020 7661 6c75 6520 3d20 5b5d  }.    value = []
-00028a40: 0a20 2020 205b 696e 6465 785b 6469 6d5d  .    [index[dim]
-00028a50: 2e61 7070 656e 6428 6172 722e 6c6f 6e67  .append(arr.long
-00028a60: 2e69 6e64 6578 5b64 696d 5d29 0a20 2020  .index[dim]).   
-00028a70: 2020 666f 7220 6172 7220 696e 2061 7272    for arr in arr
-00028a80: 6179 7320 666f 7220 6469 6d20 696e 2061  ays for dim in a
-00028a90: 7272 2e64 696d 735d 0a20 2020 2069 6e64  rr.dims].    ind
-00028aa0: 6578 203d 207b 6469 6d3a 206e 702e 6873  ex = {dim: np.hs
-00028ab0: 7461 636b 2869 6e64 6578 5b64 696d 5d29  tack(index[dim])
-00028ac0: 2066 6f72 2064 696d 2069 6e20 6469 6d73   for dim in dims
-00028ad0: 7d0a 2020 2020 5b76 616c 7565 2e61 7070  }.    [value.app
-00028ae0: 656e 6428 6172 722e 6c6f 6e67 2e76 616c  end(arr.long.val
-00028af0: 7565 2920 666f 7220 6172 7220 696e 2061  ue) for arr in a
-00028b00: 7272 6179 735d 0a20 2020 2076 616c 7565  rrays].    value
-00028b10: 203d 206e 702e 6873 7461 636b 2876 616c   = np.hstack(val
-00028b20: 7565 290a 2020 2020 6c69 7374 5f6f 665f  ue).    list_of_
-00028b30: 636f 6f72 6473 203d 205b 6172 722e 636f  coords = [arr.co
-00028b40: 6f72 6473 2066 6f72 2061 7272 2069 6e20  ords for arr in 
-00028b50: 6172 7261 7973 5d0a 2020 2020 636f 6f72  arrays].    coor
-00028b60: 6473 203d 2075 6e69 6f6e 5f6d 756c 7469  ds = union_multi
-00028b70: 5f63 6f6f 7264 7328 2a6c 6973 745f 6f66  _coords(*list_of
-00028b80: 5f63 6f6f 7264 7329 0a20 2020 2072 6574  _coords).    ret
-00028b90: 7572 6e20 4172 7261 7928 6461 7461 3d28  urn Array(data=(
-00028ba0: 696e 6465 782c 2076 616c 7565 292c 2063  index, value), c
-00028bb0: 6f6f 7264 733d 636f 6f72 6473 290a 0a0a  oords=coords)...
-00028bc0: 6465 6620 6e75 6d70 795f 746f 5f6c 6f6e  def numpy_to_lon
-00028bd0: 6728 6172 7261 793a 206e 702e 6e64 6172  g(array: np.ndar
-00028be0: 7261 792c 2064 696d 733a 204c 6973 745b  ray, dims: List[
-00028bf0: 7374 725d 2920 2d3e 204c 6f6e 673a 0a20  str]) -> Long:. 
-00028c00: 2020 2022 2222 0a20 2020 2043 6f6e 7665     """.    Conve
-00028c10: 7274 2061 204e 756d 5079 2061 7272 6179  rt a NumPy array
-00028c20: 2074 6f20 6120 4c6f 6e67 206f 626a 6563   to a Long objec
-00028c30: 742e 0a0a 2020 2020 4172 6773 3a0a 2020  t...    Args:.  
-00028c40: 2020 2020 2020 6172 7261 793a 2054 6865        array: The
-00028c50: 204e 756d 5079 2061 7272 6179 2074 6f20   NumPy array to 
-00028c60: 636f 6e76 6572 742e 0a20 2020 2020 2020  convert..       
-00028c70: 2064 696d 733a 2054 6865 206c 6973 7420   dims: The list 
-00028c80: 6f66 2064 696d 656e 7369 6f6e 206e 616d  of dimension nam
-00028c90: 6573 2066 6f72 2074 6865 204c 6f6e 6720  es for the Long 
-00028ca0: 6f62 6a65 6374 2e0a 0a20 2020 2052 6574  object...    Ret
-00028cb0: 7572 6e73 3a0a 2020 2020 2020 2020 4120  urns:.        A 
-00028cc0: 4c6f 6e67 206f 626a 6563 7420 6372 6561  Long object crea
-00028cd0: 7465 6420 6672 6f6d 2074 6865 204e 756d  ted from the Num
-00028ce0: 5079 2061 7272 6179 2e0a 0a20 2020 2045  Py array...    E
-00028cf0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-00028d00: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
-00028d10: 2020 3e3e 3e20 6172 7261 7920 3d20 6e70    >>> array = np
-00028d20: 2e61 7272 6179 285b 5b31 2c20 322c 2031  .array([[1, 2, 1
-00028d30: 305d 2c20 5b33 2c20 342c 2032 305d 5d29  0], [3, 4, 20]])
-00028d40: 0a20 2020 2020 2020 203e 3e3e 2064 696d  .        >>> dim
-00028d50: 7320 3d20 5b27 6469 6d31 272c 2027 6469  s = ['dim1', 'di
-00028d60: 6d32 275d 0a20 2020 2020 2020 203e 3e3e  m2'].        >>>
-00028d70: 206c 6f6e 675f 6f62 6a20 3d20 6e75 6d70   long_obj = nump
-00028d80: 795f 746f 5f6c 6f6e 6728 6172 7261 792c  y_to_long(array,
-00028d90: 2064 696d 7329 0a20 2020 2020 2020 203e   dims).        >
-00028da0: 3e3e 206c 6f6e 675f 6f62 6a0a 2020 2020  >> long_obj.    
-00028db0: 2020 2020 4c6f 6e67 2869 6e64 6578 3d7b      Long(index={
-00028dc0: 2764 696d 3127 3a20 6172 7261 7928 5b31  'dim1': array([1
-00028dd0: 2c20 335d 292c 2027 6469 6d32 273a 2061  , 3]), 'dim2': a
-00028de0: 7272 6179 285b 322c 2034 5d29 7d2c 2076  rray([2, 4])}, v
-00028df0: 616c 7565 3d61 7272 6179 285b 3130 2e2c  alue=array([10.,
-00028e00: 2032 302e 5d29 290a 0a20 2020 2020 2020   20.]))..       
-00028e10: 2060 6060 0a20 2020 2022 2222 0a20 2020   ```.    """.   
-00028e20: 2061 7373 6572 7420 6973 696e 7374 616e   assert isinstan
-00028e30: 6365 2861 7272 6179 2c20 6e70 2e6e 6461  ce(array, np.nda
-00028e40: 7272 6179 290a 2020 2020 6173 7365 7274  rray).    assert
-00028e50: 2069 7369 6e73 7461 6e63 6528 6469 6d73   isinstance(dims
-00028e60: 2c20 6c69 7374 290a 2020 2020 6173 7365  , list).    asse
-00028e70: 7274 2061 7272 6179 2e6e 6469 6d20 3d3d  rt array.ndim ==
-00028e80: 2032 2c20 2241 7272 6179 206d 7573 7420   2, "Array must 
-00028e90: 6265 2061 2032 2064 696d 656e 7369 6f6e  be a 2 dimension
-00028ea0: 7320 6172 7261 7922 0a20 2020 2061 7373  s array".    ass
-00028eb0: 6572 7420 6c65 6e28 0a20 2020 2020 2020  ert len(.       
-00028ec0: 2064 696d 7329 202b 2031 203d 3d20 6c65   dims) + 1 == le
-00028ed0: 6e28 6172 7261 792e 5429 2c20 6622 4e75  n(array.T), f"Nu
-00028ee0: 6d70 7920 6172 7261 7920 6d75 7374 2063  mpy array must c
-00028ef0: 6f6e 7461 696e 207b 6c65 6e28 6469 6d73  ontain {len(dims
-00028f00: 2920 2b20 317d 2063 6f6c 756d 6e73 220a  ) + 1} columns".
-00028f10: 2020 2020 7661 6c75 6520 3d20 6172 7261      value = arra
-00028f20: 792e 545b 6c65 6e28 6469 6d73 295d 0a20  y.T[len(dims)]. 
-00028f30: 2020 205f 696e 6465 7820 3d20 7b64 696d     _index = {dim
-00028f40: 3a20 6172 7220 666f 7220 6469 6d2c 2061  : arr for dim, a
-00028f50: 7272 2069 6e20 7a69 7028 6469 6d73 2c20  rr in zip(dims, 
-00028f60: 6172 7261 792e 545b 303a 6c65 6e28 6469  array.T[0:len(di
-00028f70: 6d73 295d 297d 0a20 2020 205f 7661 6c75  ms)])}.    _valu
-00028f80: 6520 3d20 7661 6c75 6520 6966 2069 7373  e = value if iss
-00028f90: 7562 636c 6173 7328 0a20 2020 2020 2020  ubclass(.       
-00028fa0: 2076 616c 7565 2e64 7479 7065 2e74 7970   value.dtype.typ
-00028fb0: 652c 2066 6c6f 6174 2920 656c 7365 2076  e, float) else v
-00028fc0: 616c 7565 2e61 7374 7970 6528 666c 6f61  alue.astype(floa
-00028fd0: 7429 0a20 2020 2072 6574 7572 6e20 4c6f  t).    return Lo
-00028fe0: 6e67 285f 696e 6465 782c 205f 7661 6c75  ng(_index, _valu
-00028ff0: 6529 0a0a 0a64 6566 205f 7061 6e64 6173  e)...def _pandas
-00029000: 5f74 6f5f 6172 7261 7928 6466 3a20 2770  _to_array(df: 'p
-00029010: 642e 4461 7461 4672 616d 6527 2c20 636f  d.DataFrame', co
-00029020: 6f72 6473 3a20 556e 696f 6e5b 4469 6374  ords: Union[Dict
-00029030: 5b73 7472 2c20 6e70 2e6e 6461 7272 6179  [str, np.ndarray
-00029040: 5d2c 204e 6f6e 655d 203d 204e 6f6e 6529  ], None] = None)
-00029050: 202d 3e20 4469 6374 5b73 7472 2c20 556e   -> Dict[str, Un
-00029060: 696f 6e5b 5475 706c 655b 4469 6374 5b73  ion[Tuple[Dict[s
-00029070: 7472 2c20 6e70 2e6e 6461 7272 6179 5d2c  tr, np.ndarray],
-00029080: 206e 702e 6e64 6172 7261 795d 2c20 4469   np.ndarray], Di
-00029090: 6374 5b73 7472 2c20 6e70 2e6e 6461 7272  ct[str, np.ndarr
-000290a0: 6179 5d5d 5d3a 0a20 2020 2022 2222 0a20  ay]]]:.    """. 
-000290b0: 2020 2043 6f6e 7665 7274 2061 2070 616e     Convert a pan
-000290c0: 6461 7320 4461 7461 4672 616d 6520 746f  das DataFrame to
-000290d0: 2061 6e20 4172 7261 7920 6469 6374 696f   an Array dictio
-000290e0: 6e61 7279 2e0a 0a20 2020 2041 7267 733a  nary...    Args:
-000290f0: 0a20 2020 2020 2020 2064 663a 2054 6865  .        df: The
-00029100: 2070 616e 6461 7320 4461 7461 4672 616d   pandas DataFram
-00029110: 6520 746f 2063 6f6e 7665 7274 2e0a 2020  e to convert..  
-00029120: 2020 2020 2020 636f 6f72 6473 3a20 5468        coords: Th
-00029130: 6520 636f 6f72 6469 6e61 7465 7320 666f  e coordinates fo
-00029140: 7220 7468 6520 4172 7261 792e 0a0a 2020  r the Array...  
-00029150: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-00029160: 2020 2041 2064 6963 7469 6f6e 6172 7920     A dictionary 
-00029170: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-00029180: 2041 7272 6179 2064 6174 6120 616e 6420   Array data and 
-00029190: 636f 6f72 6469 6e61 7465 732e 0a0a 2020  coordinates...  
-000291a0: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
-000291b0: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
-000291c0: 2020 2020 203e 3e3e 2064 6620 3d20 7064       >>> df = pd
-000291d0: 2e44 6174 6146 7261 6d65 287b 2764 696d  .DataFrame({'dim
-000291e0: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-000291f0: 2764 696d 3227 3a20 5b31 2c20 325d 2c20  'dim2': [1, 2], 
-00029200: 2776 616c 7565 273a 205b 3130 2c20 3230  'value': [10, 20
-00029210: 5d7d 290a 2020 2020 2020 2020 3e3e 3e20  ]}).        >>> 
-00029220: 636f 6f72 6473 203d 207b 2764 696d 3127  coords = {'dim1'
-00029230: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
-00029240: 696d 3227 3a20 5b31 2c20 325d 7d0a 2020  im2': [1, 2]}.  
-00029250: 2020 2020 2020 3e3e 3e20 6172 7261 795f        >>> array_
-00029260: 6469 6374 203d 205f 7061 6e64 6173 5f74  dict = _pandas_t
-00029270: 6f5f 6172 7261 7928 6466 2c20 636f 6f72  o_array(df, coor
-00029280: 6473 290a 2020 2020 2020 2020 3e3e 3e20  ds).        >>> 
-00029290: 6172 7261 795f 6469 6374 0a20 2020 2020  array_dict.     
-000292a0: 2020 207b 2764 6174 6127 3a20 287b 2764     {'data': ({'d
-000292b0: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
-000292c0: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
-000292d0: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
-000292e0: 7272 6179 285b 312c 2032 5d29 7d2c 2061  rray([1, 2])}, a
-000292f0: 7272 6179 285b 3130 2c20 3230 5d29 292c  rray([10, 20])),
-00029300: 2027 636f 6f72 6473 273a 207b 2764 696d   'coords': {'dim
-00029310: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-00029320: 2764 696d 3227 3a20 5b31 2c20 325d 7d7d  'dim2': [1, 2]}}
-00029330: 0a0a 2020 2020 2020 2020 6060 600a 2020  ..        ```.  
-00029340: 2020 2222 220a 2020 2020 6173 7365 7274    """.    assert
-00029350: 2022 7661 6c75 6522 2069 6e20 6466 2e63   "value" in df.c
-00029360: 6f6c 756d 6e73 2c20 2243 6f6c 756d 6e20  olumns, "Column 
-00029370: 6e61 6d65 6420 2776 616c 7565 2720 6d75  named 'value' mu
-00029380: 7374 2065 7869 7374 220a 2020 2020 7661  st exist".    va
-00029390: 6c75 6520 3d20 6466 5b22 7661 6c75 6522  lue = df["value"
-000293a0: 5d2e 7661 6c75 6573 0a20 2020 2064 6620  ].values.    df 
-000293b0: 3d20 6466 2e64 726f 7028 6c61 6265 6c73  = df.drop(labels
-000293c0: 3d22 7661 6c75 6522 2c20 6178 6973 3d31  ="value", axis=1
-000293d0: 290a 2020 2020 696e 6465 7820 3d20 7b7d  ).    index = {}
-000293e0: 0a20 2020 2066 6f72 2063 6f6c 2069 6e20  .    for col in 
-000293f0: 6466 2e63 6f6c 756d 6e73 3a0a 2020 2020  df.columns:.    
-00029400: 2020 2020 696e 6465 785b 636f 6c5d 203d      index[col] =
-00029410: 2064 665b 636f 6c5d 2e76 616c 7565 730a   df[col].values.
-00029420: 2020 2020 7265 7475 726e 2064 6963 7428      return dict(
-00029430: 6461 7461 3d28 696e 6465 782c 2076 616c  data=(index, val
-00029440: 7565 292c 2063 6f6f 7264 733d 636f 6f72  ue), coords=coor
-00029450: 6473 290a 0a0a 6465 6620 6672 6f6d 5f70  ds)...def from_p
-00029460: 616e 6461 7328 6466 3a20 2770 642e 4461  andas(df: 'pd.Da
-00029470: 7461 4672 616d 6527 2c20 636f 6f72 6473  taFrame', coords
-00029480: 3a20 556e 696f 6e5b 4469 6374 5b73 7472  : Union[Dict[str
-00029490: 2c20 6e70 2e6e 6461 7272 6179 5d2c 204e  , np.ndarray], N
-000294a0: 6f6e 655d 203d 204e 6f6e 6529 202d 3e20  one] = None) -> 
-000294b0: 4172 7261 793a 0a20 2020 2022 2222 0a20  Array:.    """. 
-000294c0: 2020 2043 7265 6174 6520 616e 2041 7272     Create an Arr
-000294d0: 6179 206f 626a 6563 7420 6672 6f6d 2061  ay object from a
-000294e0: 2070 616e 6461 7320 4461 7461 4672 616d   pandas DataFram
-000294f0: 652e 0a0a 2020 2020 4172 6773 3a0a 2020  e...    Args:.  
-00029500: 2020 2020 2020 6466 3a20 5468 6520 7061        df: The pa
-00029510: 6e64 6173 2044 6174 6146 7261 6d65 2074  ndas DataFrame t
-00029520: 6f20 636f 6e76 6572 742e 0a20 2020 2020  o convert..     
-00029530: 2020 2063 6f6f 7264 733a 2054 6865 2063     coords: The c
-00029540: 6f6f 7264 696e 6174 6573 2066 6f72 2074  oordinates for t
-00029550: 6865 2041 7272 6179 2e0a 0a20 2020 2052  he Array...    R
-00029560: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-00029570: 416e 2041 7272 6179 206f 626a 6563 7420  An Array object 
-00029580: 6372 6561 7465 6420 6672 6f6d 2074 6865  created from the
-00029590: 2070 616e 6461 7320 4461 7461 4672 616d   pandas DataFram
-000295a0: 652e 0a0a 2020 2020 4578 616d 706c 653a  e...    Example:
-000295b0: 0a20 2020 2020 2020 2060 6060 7079 7468  .        ```pyth
-000295c0: 6f6e 0a20 2020 2020 2020 203e 3e3e 2064  on.        >>> d
-000295d0: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
-000295e0: 287b 2764 696d 3127 3a20 5b27 6127 2c20  ({'dim1': ['a', 
-000295f0: 2762 275d 2c20 2764 696d 3227 3a20 5b31  'b'], 'dim2': [1
-00029600: 2c20 325d 2c20 2776 616c 7565 273a 205b  , 2], 'value': [
-00029610: 3130 2c20 3230 5d7d 290a 2020 2020 2020  10, 20]}).      
-00029620: 2020 3e3e 3e20 636f 6f72 6473 203d 207b    >>> coords = {
-00029630: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
-00029640: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
-00029650: 325d 7d0a 2020 2020 2020 2020 3e3e 3e20  2]}.        >>> 
-00029660: 6172 7220 3d20 6672 6f6d 5f70 616e 6461  arr = from_panda
-00029670: 7328 6466 2c20 636f 6f72 6473 290a 2020  s(df, coords).  
-00029680: 2020 2020 2020 3e3e 3e20 6172 720a 2020        >>> arr.  
-00029690: 2020 2020 2020 4172 7261 7928 6461 7461        Array(data
-000296a0: 3d61 7272 6179 285b 5b31 302c 2020 305d  =array([[10,  0]
-000296b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000296c0: 205b 2030 2c20 3230 5d5d 292c 2063 6f6f   [ 0, 20]]), coo
-000296d0: 7264 733d 7b27 6469 6d31 273a 2061 7272  rds={'dim1': arr
-000296e0: 6179 285b 2761 272c 2027 6227 5d2c 2064  ay(['a', 'b'], d
-000296f0: 7479 7065 3d6f 626a 6563 7429 2c20 2764  type=object), 'd
-00029700: 696d 3227 3a20 6172 7261 7928 5b31 2c20  im2': array([1, 
-00029710: 325d 297d 290a 0a20 2020 2020 2020 2060  2])})..        `
-00029720: 6060 0a20 2020 2022 2222 0a20 2020 2072  ``.    """.    r
-00029730: 6574 7572 6e20 4172 7261 7928 2a2a 5f70  eturn Array(**_p
-00029740: 616e 6461 735f 746f 5f61 7272 6179 2864  andas_to_array(d
-00029750: 662c 2063 6f6f 7264 733d 636f 6f72 6473  f, coords=coords
-00029760: 2929 0a0a 0a64 6566 205f 706f 6c61 7273  ))...def _polars
-00029770: 5f74 6f5f 6172 7261 7928 6466 3a20 2770  _to_array(df: 'p
-00029780: 6c2e 4461 7461 4672 616d 6527 2c20 636f  l.DataFrame', co
-00029790: 6f72 6473 3a20 556e 696f 6e5b 4469 6374  ords: Union[Dict
-000297a0: 5b73 7472 2c20 6e70 2e6e 6461 7272 6179  [str, np.ndarray
-000297b0: 5d2c 204e 6f6e 655d 203d 204e 6f6e 6529  ], None] = None)
-000297c0: 202d 3e20 4469 6374 5b73 7472 2c20 556e   -> Dict[str, Un
-000297d0: 696f 6e5b 5475 706c 655b 4469 6374 5b73  ion[Tuple[Dict[s
-000297e0: 7472 2c20 6e70 2e6e 6461 7272 6179 5d2c  tr, np.ndarray],
-000297f0: 206e 702e 6e64 6172 7261 795d 2c20 4469   np.ndarray], Di
-00029800: 6374 5b73 7472 2c20 6e70 2e6e 6461 7272  ct[str, np.ndarr
-00029810: 6179 5d5d 5d3a 0a20 2020 2022 2222 0a20  ay]]]:.    """. 
-00029820: 2020 2043 6f6e 7665 7274 2061 2070 6f6c     Convert a pol
-00029830: 6172 7320 4461 7461 4672 616d 6520 746f  ars DataFrame to
-00029840: 2061 6e20 4172 7261 7920 6469 6374 696f   an Array dictio
-00029850: 6e61 7279 2e0a 0a20 2020 2041 7267 733a  nary...    Args:
-00029860: 0a20 2020 2020 2020 2064 663a 2054 6865  .        df: The
-00029870: 2070 6f6c 6172 7320 4461 7461 4672 616d   polars DataFram
-00029880: 6520 746f 2063 6f6e 7665 7274 2e0a 2020  e to convert..  
-00029890: 2020 2020 2020 636f 6f72 6473 3a20 5468        coords: Th
-000298a0: 6520 636f 6f72 6469 6e61 7465 7320 666f  e coordinates fo
-000298b0: 7220 7468 6520 4172 7261 792e 0a0a 2020  r the Array...  
-000298c0: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-000298d0: 2020 2041 2064 6963 7469 6f6e 6172 7920     A dictionary 
-000298e0: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-000298f0: 2041 7272 6179 2064 6174 6120 616e 6420   Array data and 
-00029900: 636f 6f72 6469 6e61 7465 732e 0a0a 2020  coordinates...  
-00029910: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
-00029920: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
-00029930: 2020 2020 203e 3e3e 2064 6620 3d20 706c       >>> df = pl
-00029940: 2e44 6174 6146 7261 6d65 287b 2764 696d  .DataFrame({'dim
-00029950: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
-00029960: 2764 696d 3227 3a20 5b31 2c20 325d 2c20  'dim2': [1, 2], 
-00029970: 2776 616c 7565 273a 205b 3130 2c20 3230  'value': [10, 20
-00029980: 5d7d 290a 2020 2020 2020 2020 3e3e 3e20  ]}).        >>> 
-00029990: 636f 6f72 6473 203d 207b 2764 696d 3127  coords = {'dim1'
-000299a0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
-000299b0: 696d 3227 3a20 5b31 2c20 325d 7d0a 2020  im2': [1, 2]}.  
-000299c0: 2020 2020 2020 3e3e 3e20 6172 7261 795f        >>> array_
-000299d0: 6469 6374 203d 205f 706f 6c61 7273 5f74  dict = _polars_t
-000299e0: 6f5f 6172 7261 7928 6466 2c20 636f 6f72  o_array(df, coor
-000299f0: 6473 290a 2020 2020 2020 2020 3e3e 3e20  ds).        >>> 
-00029a00: 6172 7261 795f 6469 6374 0a20 2020 2020  array_dict.     
-00029a10: 2020 207b 2764 6174 6127 3a20 287b 2764     {'data': ({'d
-00029a20: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
-00029a30: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
-00029a40: 7d2c 2061 7272 6179 285b 3130 2c20 3230  }, array([10, 20
-00029a50: 5d29 292c 2027 636f 6f72 6473 273a 207b  ])), 'coords': {
-00029a60: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
-00029a70: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
-00029a80: 325d 7d7d 0a0a 2020 2020 2020 2020 6060  2]}}..        ``
-00029a90: 600a 2020 2020 2222 220a 2020 2020 6173  `.    """.    as
-00029aa0: 7365 7274 2022 7661 6c75 6522 2069 6e20  sert "value" in 
-00029ab0: 6466 2e63 6f6c 756d 6e73 2c20 2243 6f6c  df.columns, "Col
-00029ac0: 756d 6e20 6e61 6d65 6420 2776 616c 7565  umn named 'value
-00029ad0: 2720 6d75 7374 2065 7869 7374 220a 2020  ' must exist".  
-00029ae0: 2020 7661 6c75 6520 3d20 6466 5b22 7661    value = df["va
-00029af0: 6c75 6522 5d2e 746f 5f6e 756d 7079 2829  lue"].to_numpy()
-00029b00: 0a20 2020 2064 6620 3d20 6466 2e64 726f  .    df = df.dro
-00029b10: 7028 2276 616c 7565 2229 0a20 2020 2069  p("value").    i
-00029b20: 6e64 6578 203d 2064 662e 746f 5f64 6963  ndex = df.to_dic
-00029b30: 7428 6173 5f73 6572 6965 733d 4661 6c73  t(as_series=Fals
-00029b40: 6529 0a20 2020 2072 6574 7572 6e20 6469  e).    return di
-00029b50: 6374 2864 6174 613d 2869 6e64 6578 2c20  ct(data=(index, 
-00029b60: 7661 6c75 6529 2c20 636f 6f72 6473 3d63  value), coords=c
-00029b70: 6f6f 7264 7329 0a0a 0a64 6566 2066 726f  oords)...def fro
-00029b80: 6d5f 706f 6c61 7273 2864 663a 2027 706c  m_polars(df: 'pl
-00029b90: 2e44 6174 6146 7261 6d65 272c 2063 6f6f  .DataFrame', coo
-00029ba0: 7264 733a 2055 6e69 6f6e 5b44 6963 745b  rds: Union[Dict[
-00029bb0: 7374 722c 206e 702e 6e64 6172 7261 795d  str, np.ndarray]
-00029bc0: 2c20 4e6f 6e65 5d20 3d20 4e6f 6e65 2920  , None] = None) 
-00029bd0: 2d3e 2041 7272 6179 3a0a 2020 2020 2222  -> Array:.    ""
-00029be0: 220a 2020 2020 4372 6561 7465 2061 6e20  ".    Create an 
-00029bf0: 4172 7261 7920 6f62 6a65 6374 2066 726f  Array object fro
-00029c00: 6d20 6120 706f 6c61 7273 2044 6174 6146  m a polars DataF
-00029c10: 7261 6d65 2e0a 0a20 2020 2041 7267 733a  rame...    Args:
-00029c20: 0a20 2020 2020 2020 2064 663a 2054 6865  .        df: The
-00029c30: 2070 6f6c 6172 7320 4461 7461 4672 616d   polars DataFram
-00029c40: 6520 746f 2063 6f6e 7665 7274 2e0a 2020  e to convert..  
-00029c50: 2020 2020 2020 636f 6f72 6473 3a20 5468        coords: Th
-00029c60: 6520 636f 6f72 6469 6e61 7465 7320 666f  e coordinates fo
-00029c70: 7220 7468 6520 4172 7261 792e 0a0a 2020  r the Array...  
-00029c80: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-00029c90: 2020 2041 6e20 4172 7261 7920 6f62 6a65     An Array obje
-00029ca0: 6374 2063 7265 6174 6564 2066 726f 6d20  ct created from 
-00029cb0: 7468 6520 706f 6c61 7273 2044 6174 6146  the polars DataF
-00029cc0: 7261 6d65 2e0a 0a20 2020 2045 7861 6d70  rame...    Examp
-00029cd0: 6c65 3a0a 2020 2020 2020 2020 6060 6070  le:.        ```p
-00029ce0: 7974 686f 6e0a 2020 2020 2020 2020 3e3e  ython.        >>
-00029cf0: 3e20 6466 203d 2070 6c2e 4461 7461 4672  > df = pl.DataFr
-00029d00: 616d 6528 7b27 6469 6d31 273a 205b 2761  ame({'dim1': ['a
-00029d10: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
-00029d20: 205b 312c 2032 5d2c 2027 7661 6c75 6527   [1, 2], 'value'
-00029d30: 3a20 5b31 302c 2032 305d 7d29 0a20 2020  : [10, 20]}).   
-00029d40: 2020 2020 203e 3e3e 2063 6f6f 7264 7320       >>> coords 
-00029d50: 3d20 7b27 6469 6d31 273a 205b 2761 272c  = {'dim1': ['a',
-00029d60: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-00029d70: 312c 2032 5d7d 0a20 2020 2020 2020 203e  1, 2]}.        >
-00029d80: 3e3e 2061 7272 203d 2066 726f 6d5f 706f  >> arr = from_po
-00029d90: 6c61 7273 2864 662c 2063 6f6f 7264 7329  lars(df, coords)
-00029da0: 0a20 2020 2020 2020 203e 3e3e 2061 7272  .        >>> arr
-00029db0: 0a20 2020 2020 2020 2041 7272 6179 2864  .        Array(d
-00029dc0: 6174 613d 6172 7261 7928 5b5b 3130 2c20  ata=array([[10, 
-00029dd0: 2030 5d2c 0a20 2020 2020 2020 2020 2020   0],.           
-00029de0: 2020 2020 5b20 302c 2032 305d 5d29 2c20      [ 0, 20]]), 
-00029df0: 636f 6f72 6473 3d7b 2764 696d 3127 3a20  coords={'dim1': 
-00029e00: 6172 7261 7928 5b27 6127 2c20 2762 275d  array(['a', 'b']
-00029e10: 2c20 6474 7970 653d 6f62 6a65 6374 292c  , dtype=object),
-00029e20: 2027 6469 6d32 273a 2061 7272 6179 285b   'dim2': array([
-00029e30: 312c 2032 5d29 7d29 0a0a 2020 2020 2020  1, 2])})..      
-00029e40: 2020 6060 600a 2020 2020 2222 220a 2020    ```.    """.  
-00029e50: 2020 7265 7475 726e 2041 7272 6179 282a    return Array(*
-00029e60: 2a5f 706f 6c61 7273 5f74 6f5f 6172 7261  *_polars_to_arra
-00029e70: 7928 6466 2c20 636f 6f72 6473 3d63 6f6f  y(df, coords=coo
-00029e80: 7264 7329 290a 0a0a 6465 6620 6672 6f6d  rds))...def from
-00029e90: 5f66 6561 7468 6572 5f74 6f5f 6469 6374  _feather_to_dict
-00029ea0: 2870 6174 683a 2073 7472 2c20 7573 655f  (path: str, use_
-00029eb0: 7468 7265 6164 733a 2062 6f6f 6c20 3d20  threads: bool = 
-00029ec0: 5472 7565 2c20 7769 7468 5f3a 2055 6e69  True, with_: Uni
-00029ed0: 6f6e 5b73 7472 2c20 4e6f 6e65 5d20 3d20  on[str, None] = 
-00029ee0: 4e6f 6e65 2920 2d3e 2044 6963 745b 7374  None) -> Dict[st
-00029ef0: 722c 2055 6e69 6f6e 5b54 7570 6c65 5b44  r, Union[Tuple[D
-00029f00: 6963 745b 7374 722c 206e 702e 6e64 6172  ict[str, np.ndar
-00029f10: 7261 795d 2c20 6e70 2e6e 6461 7272 6179  ray], np.ndarray
-00029f20: 5d2c 2044 6963 745b 7374 722c 206e 702e  ], Dict[str, np.
-00029f30: 6e64 6172 7261 795d 5d5d 3a0a 2020 2020  ndarray]]]:.    
-00029f40: 2222 220a 2020 2020 4c6f 6164 2061 6e20  """.    Load an 
-00029f50: 4172 7261 7920 6469 6374 696f 6e61 7279  Array dictionary
-00029f60: 2066 726f 6d20 6120 4665 6174 6865 7220   from a Feather 
-00029f70: 6669 6c65 2e0a 0a20 2020 2041 7267 733a  file...    Args:
-00029f80: 0a20 2020 2020 2020 2070 6174 683a 2054  .        path: T
-00029f90: 6865 2070 6174 6820 746f 2074 6865 2046  he path to the F
-00029fa0: 6561 7468 6572 2066 696c 652e 0a20 2020  eather file..   
-00029fb0: 2020 2020 2075 7365 5f74 6872 6561 6473       use_threads
-00029fc0: 3a20 5768 6574 6865 7220 746f 2075 7365  : Whether to use
-00029fd0: 2074 6872 6561 6473 2077 6865 6e20 7265   threads when re
-00029fe0: 6164 696e 6720 7468 6520 4665 6174 6865  ading the Feathe
-00029ff0: 7220 6669 6c65 2e0a 2020 2020 2020 2020  r file..        
-0002a000: 7769 7468 5f3a 2054 6865 206c 6962 7261  with_: The libra
-0002a010: 7279 2074 6f20 7573 6520 666f 7220 6c6f  ry to use for lo
-0002a020: 6164 696e 6720 7468 6520 4665 6174 6865  ading the Feathe
-0002a030: 7220 6669 6c65 2028 2770 616e 6461 7327  r file ('pandas'
-0002a040: 206f 7220 2770 6f6c 6172 7327 292e 0a0a   or 'polars')...
-0002a050: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-0002a060: 2020 2020 2041 2064 6963 7469 6f6e 6172       A dictionar
-0002a070: 7920 7265 7072 6573 656e 7469 6e67 2074  y representing t
-0002a080: 6865 2041 7272 6179 2064 6174 6120 616e  he Array data an
-0002a090: 6420 636f 6f72 6469 6e61 7465 7320 6c6f  d coordinates lo
-0002a0a0: 6164 6564 2066 726f 6d20 7468 6520 4665  aded from the Fe
-0002a0b0: 6174 6865 7220 6669 6c65 2e0a 0a20 2020  ather file...   
-0002a0c0: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
-0002a0d0: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-0002a0e0: 2020 2020 3e3e 3e20 6172 7261 795f 6469      >>> array_di
-0002a0f0: 6374 203d 2066 726f 6d5f 6665 6174 6865  ct = from_feathe
-0002a100: 725f 746f 5f64 6963 7428 2774 6573 7473  r_to_dict('tests
-0002a110: 2f64 6174 612f 6172 7261 792e 6665 6174  /data/array.feat
-0002a120: 6865 7227 2c20 7769 7468 5f3d 2770 616e  her', with_='pan
-0002a130: 6461 7327 290a 2020 2020 2020 2020 3e3e  das').        >>
-0002a140: 3e20 6172 7261 795f 6469 6374 0a20 2020  > array_dict.   
-0002a150: 2020 2020 207b 2764 6174 6127 3a20 287b       {'data': ({
-0002a160: 2764 696d 3127 3a20 6172 7261 7928 5b27  'dim1': array(['
-0002a170: 6127 2c20 2762 275d 2c20 6474 7970 653d  a', 'b'], dtype=
-0002a180: 6f62 6a65 6374 292c 2027 6469 6d32 273a  object), 'dim2':
-0002a190: 2061 7272 6179 285b 312c 2032 5d29 7d2c   array([1, 2])},
-0002a1a0: 2061 7272 6179 285b 3130 2c20 3230 5d29   array([10, 20])
-0002a1b0: 292c 2027 636f 6f72 6473 273a 207b 2764  ), 'coords': {'d
-0002a1c0: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
-0002a1d0: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
-0002a1e0: 7d7d 0a0a 2020 2020 2020 2020 6060 600a  }}..        ```.
-0002a1f0: 2020 2020 2222 220a 2020 2020 6173 7365      """.    asse
-0002a200: 7274 2077 6974 685f 2069 6e20 5b22 7061  rt with_ in ["pa
-0002a210: 6e64 6173 222c 2022 706f 6c61 7273 225d  ndas", "polars"]
-0002a220: 0a20 2020 2072 6573 746f 7265 645f 7461  .    restored_ta
-0002a230: 626c 6520 3d20 6665 6174 6865 722e 7265  ble = feather.re
-0002a240: 6164 5f74 6162 6c65 280a 2020 2020 2020  ad_table(.      
-0002a250: 2020 7061 7468 2c20 7573 655f 7468 7265    path, use_thre
-0002a260: 6164 733d 7573 655f 7468 7265 6164 732c  ads=use_threads,
-0002a270: 206d 656d 6f72 795f 6d61 703d 5472 7565   memory_map=True
-0002a280: 290a 2020 2020 636f 6c75 6d6e 5f6e 616d  ).    column_nam
-0002a290: 6573 203d 2072 6573 746f 7265 645f 7461  es = restored_ta
-0002a2a0: 626c 652e 636f 6c75 6d6e 5f6e 616d 6573  ble.column_names
-0002a2b0: 0a20 2020 2061 7373 6572 7420 2276 616c  .    assert "val
-0002a2c0: 7565 2220 696e 2063 6f6c 756d 6e5f 6e61  ue" in column_na
-0002a2d0: 6d65 732c 2022 436f 6c75 6d6e 206e 616d  mes, "Column nam
-0002a2e0: 6564 2027 7661 6c75 6527 206d 7573 7420  ed 'value' must 
-0002a2f0: 6578 6973 7422 0a20 2020 2063 7573 746f  exist".    custo
-0002a300: 6d5f 6d65 7461 5f6b 6579 203d 2027 6b61  m_meta_key = 'ka
-0002a310: 7272 6179 270a 2020 2020 6966 2063 7573  rray'.    if cus
-0002a320: 746f 6d5f 6d65 7461 5f6b 6579 2e65 6e63  tom_meta_key.enc
-0002a330: 6f64 6528 2920 696e 2072 6573 746f 7265  ode() in restore
-0002a340: 645f 7461 626c 652e 7363 6865 6d61 2e6d  d_table.schema.m
-0002a350: 6574 6164 6174 613a 0a20 2020 2020 2020  etadata:.       
-0002a360: 2072 6573 746f 7265 645f 6d65 7461 5f6a   restored_meta_j
-0002a370: 736f 6e20 3d20 7265 7374 6f72 6564 5f74  son = restored_t
-0002a380: 6162 6c65 2e73 6368 656d 612e 6d65 7461  able.schema.meta
-0002a390: 6461 7461 5b63 7573 746f 6d5f 6d65 7461  data[custom_meta
-0002a3a0: 5f6b 6579 2e65 6e63 6f64 6528 0a20 2020  _key.encode(.   
-0002a3b0: 2020 2020 2029 5d0a 2020 2020 2020 2020       )].        
-0002a3c0: 7265 7374 6f72 6564 5f6d 6574 6120 3d20  restored_meta = 
-0002a3d0: 6a73 6f6e 2e6c 6f61 6473 2872 6573 746f  json.loads(resto
-0002a3e0: 7265 645f 6d65 7461 5f6a 736f 6e29 0a20  red_meta_json). 
-0002a3f0: 2020 2020 2020 2061 7373 6572 7420 2263         assert "c
-0002a400: 6f6f 7264 7322 2069 6e20 7265 7374 6f72  oords" in restor
-0002a410: 6564 5f6d 6574 610a 2020 2020 2020 2020  ed_meta.        
-0002a420: 6966 2077 6974 685f 203d 3d20 2270 616e  if with_ == "pan
-0002a430: 6461 7322 3a0a 2020 2020 2020 2020 2020  das":.          
-0002a440: 2020 7265 7475 726e 205f 7061 6e64 6173    return _pandas
-0002a450: 5f74 6f5f 6172 7261 7928 6466 3d72 6573  _to_array(df=res
-0002a460: 746f 7265 645f 7461 626c 652e 746f 5f70  tored_table.to_p
-0002a470: 616e 6461 7328 292c 2063 6f6f 7264 733d  andas(), coords=
-0002a480: 7265 7374 6f72 6564 5f6d 6574 615b 2763  restored_meta['c
-0002a490: 6f6f 7264 7327 5d29 0a20 2020 2020 2020  oords']).       
-0002a4a0: 2065 6c69 6620 7769 7468 5f20 3d3d 2022   elif with_ == "
-0002a4b0: 706f 6c61 7273 223a 0a20 2020 2020 2020  polars":.       
-0002a4c0: 2020 2020 2072 6574 7572 6e20 5f70 6f6c       return _pol
-0002a4d0: 6172 735f 746f 5f61 7272 6179 2864 663d  ars_to_array(df=
-0002a4e0: 706c 2e66 726f 6d5f 6172 726f 7728 7265  pl.from_arrow(re
-0002a4f0: 7374 6f72 6564 5f74 6162 6c65 292c 2063  stored_table), c
-0002a500: 6f6f 7264 733d 7265 7374 6f72 6564 5f6d  oords=restored_m
-0002a510: 6574 615b 2763 6f6f 7264 7327 5d29 0a20  eta['coords']). 
-0002a520: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002a530: 2069 6620 7769 7468 5f20 3d3d 2022 7061   if with_ == "pa
-0002a540: 6e64 6173 223a 0a20 2020 2020 2020 2020  ndas":.         
-0002a550: 2020 2072 6574 7572 6e20 5f70 616e 6461     return _panda
-0002a560: 735f 746f 5f61 7272 6179 2864 663d 7265  s_to_array(df=re
-0002a570: 7374 6f72 6564 5f74 6162 6c65 2e74 6f5f  stored_table.to_
-0002a580: 7061 6e64 6173 2873 706c 6974 5f62 6c6f  pandas(split_blo
-0002a590: 636b 733d 5472 7565 2c20 7365 6c66 5f64  cks=True, self_d
-0002a5a0: 6573 7472 7563 743d 5472 7565 292c 2063  estruct=True), c
-0002a5b0: 6f6f 7264 733d 4e6f 6e65 290a 2020 2020  oords=None).    
-0002a5c0: 2020 2020 656c 6966 2077 6974 685f 203d      elif with_ =
-0002a5d0: 3d20 2270 6f6c 6172 7322 3a0a 2020 2020  = "polars":.    
-0002a5e0: 2020 2020 2020 2020 7265 7475 726e 205f          return _
-0002a5f0: 706f 6c61 7273 5f74 6f5f 6172 7261 7928  polars_to_array(
-0002a600: 6466 3d70 6c2e 6672 6f6d 5f61 7272 6f77  df=pl.from_arrow
-0002a610: 2872 6573 746f 7265 645f 7461 626c 6529  (restored_table)
-0002a620: 2c20 636f 6f72 6473 3d4e 6f6e 6529 0a0a  , coords=None)..
-0002a630: 0a64 6566 2066 726f 6d5f 6665 6174 6865  .def from_feathe
-0002a640: 7228 7061 7468 3a20 7374 722c 2075 7365  r(path: str, use
-0002a650: 5f74 6872 6561 6473 3a20 626f 6f6c 203d  _threads: bool =
-0002a660: 2054 7275 652c 2077 6974 685f 3a20 7374   True, with_: st
-0002a670: 7220 3d20 2770 616e 6461 7327 2920 2d3e  r = 'pandas') ->
-0002a680: 2041 7272 6179 3a0a 2020 2020 2222 220a   Array:.    """.
-0002a690: 2020 2020 4c6f 6164 2061 6e20 4172 7261      Load an Arra
-0002a6a0: 7920 6f62 6a65 6374 2066 726f 6d20 6120  y object from a 
-0002a6b0: 4665 6174 6865 7220 6669 6c65 2e0a 0a20  Feather file... 
-0002a6c0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0002a6d0: 2070 6174 683a 2054 6865 2070 6174 6820   path: The path 
-0002a6e0: 746f 2074 6865 2046 6561 7468 6572 2066  to the Feather f
-0002a6f0: 696c 652e 0a20 2020 2020 2020 2075 7365  ile..        use
-0002a700: 5f74 6872 6561 6473 3a20 5768 6574 6865  _threads: Whethe
-0002a710: 7220 746f 2075 7365 2074 6872 6561 6473  r to use threads
-0002a720: 2077 6865 6e20 7265 6164 696e 6720 7468   when reading th
-0002a730: 6520 4665 6174 6865 7220 6669 6c65 2e0a  e Feather file..
-0002a740: 2020 2020 2020 2020 7769 7468 5f3a 2054          with_: T
-0002a750: 6865 206c 6962 7261 7279 2074 6f20 7573  he library to us
-0002a760: 6520 666f 7220 6c6f 6164 696e 6720 7468  e for loading th
-0002a770: 6520 4665 6174 6865 7220 6669 6c65 2028  e Feather file (
-0002a780: 2770 616e 6461 7327 206f 7220 2770 6f6c  'pandas' or 'pol
-0002a790: 6172 7327 292e 0a0a 2020 2020 5265 7475  ars')...    Retu
-0002a7a0: 726e 733a 0a20 2020 2020 2020 2041 6e20  rns:.        An 
-0002a7b0: 4172 7261 7920 6f62 6a65 6374 206c 6f61  Array object loa
-0002a7c0: 6465 6420 6672 6f6d 2074 6865 2046 6561  ded from the Fea
-0002a7d0: 7468 6572 2066 696c 652e 0a0a 2020 2020  ther file...    
-0002a7e0: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
-0002a7f0: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
-0002a800: 2020 203e 3e3e 2061 7272 203d 2066 726f     >>> arr = fro
-0002a810: 6d5f 6665 6174 6865 7228 2774 6573 7473  m_feather('tests
-0002a820: 2f64 6174 612f 6172 7261 792e 6665 6174  /data/array.feat
-0002a830: 6865 7227 2c20 7769 7468 5f3d 2770 616e  her', with_='pan
-0002a840: 6461 7327 290a 2020 2020 2020 2020 3e3e  das').        >>
-0002a850: 3e20 6172 720a 2020 2020 2020 2020 4172  > arr.        Ar
-0002a860: 7261 7928 6461 7461 3d61 7272 6179 285b  ray(data=array([
-0002a870: 5b31 302c 2020 305d 2c0a 2020 2020 2020  [10,  0],.      
-0002a880: 2020 2020 2020 2020 205b 2030 2c20 3230           [ 0, 20
-0002a890: 5d5d 292c 2063 6f6f 7264 733d 7b27 6469  ]]), coords={'di
-0002a8a0: 6d31 273a 2061 7272 6179 285b 2761 272c  m1': array(['a',
-0002a8b0: 2027 6227 5d2c 2064 7479 7065 3d6f 626a   'b'], dtype=obj
-0002a8c0: 6563 7429 2c20 2764 696d 3227 3a20 6172  ect), 'dim2': ar
-0002a8d0: 7261 7928 5b31 2c20 325d 297d 290a 0a20  ray([1, 2])}).. 
-0002a8e0: 2020 2020 2020 2060 6060 0a20 2020 2022         ```.    "
-0002a8f0: 2222 0a20 2020 2072 6574 7572 6e20 4172  "".    return Ar
-0002a900: 7261 7928 2a2a 6672 6f6d 5f66 6561 7468  ray(**from_feath
-0002a910: 6572 5f74 6f5f 6469 6374 2870 6174 683d  er_to_dict(path=
-0002a920: 7061 7468 2c20 7573 655f 7468 7265 6164  path, use_thread
-0002a930: 733d 7573 655f 7468 7265 6164 732c 2077  s=use_threads, w
-0002a940: 6974 685f 3d77 6974 685f 2929 0a0a 0a64  ith_=with_))...d
-0002a950: 6566 205f 6373 765f 746f 5f61 7272 6179  ef _csv_to_array
-0002a960: 2870 6174 683a 2073 7472 2c20 636f 6f72  (path: str, coor
-0002a970: 6473 3a20 556e 696f 6e5b 4469 6374 5b73  ds: Union[Dict[s
-0002a980: 7472 2c20 6e70 2e6e 6461 7272 6179 5d2c  tr, np.ndarray],
-0002a990: 204e 6f6e 655d 203d 204e 6f6e 652c 2064   None] = None, d
-0002a9a0: 656c 696d 6974 6572 3a20 7374 7220 3d20  elimiter: str = 
-0002a9b0: 272c 272c 2065 6e63 6f64 696e 673a 2073  ',', encoding: s
-0002a9c0: 7472 203d 2027 7574 662d 3827 2920 2d3e  tr = 'utf-8') ->
-0002a9d0: 2044 6963 745b 7374 722c 2055 6e69 6f6e   Dict[str, Union
-0002a9e0: 5b54 7570 6c65 5b44 6963 745b 7374 722c  [Tuple[Dict[str,
-0002a9f0: 206e 702e 6e64 6172 7261 795d 2c20 6e70   np.ndarray], np
-0002aa00: 2e6e 6461 7272 6179 5d2c 2044 6963 745b  .ndarray], Dict[
-0002aa10: 7374 722c 206e 702e 6e64 6172 7261 795d  str, np.ndarray]
-0002aa20: 5d5d 3a0a 2020 2020 2222 220a 2020 2020  ]]:.    """.    
-0002aa30: 436f 6e76 6572 7420 6120 4353 5620 6669  Convert a CSV fi
-0002aa40: 6c65 2074 6f20 616e 2041 7272 6179 2064  le to an Array d
-0002aa50: 6963 7469 6f6e 6172 792e 0a0a 2020 2020  ictionary...    
-0002aa60: 4172 6773 3a0a 2020 2020 2020 2020 7061  Args:.        pa
-0002aa70: 7468 3a20 5468 6520 7061 7468 2074 6f20  th: The path to 
-0002aa80: 7468 6520 4353 5620 6669 6c65 2e0a 2020  the CSV file..  
-0002aa90: 2020 2020 2020 636f 6f72 6473 3a20 5468        coords: Th
-0002aaa0: 6520 636f 6f72 6469 6e61 7465 7320 666f  e coordinates fo
-0002aab0: 7220 7468 6520 4172 7261 792e 0a20 2020  r the Array..   
-0002aac0: 2020 2020 2064 656c 696d 6974 6572 3a20       delimiter: 
-0002aad0: 5468 6520 6465 6c69 6d69 7465 7220 7573  The delimiter us
-0002aae0: 6564 2069 6e20 7468 6520 4353 5620 6669  ed in the CSV fi
-0002aaf0: 6c65 2e0a 2020 2020 2020 2020 656e 636f  le..        enco
-0002ab00: 6469 6e67 3a20 5468 6520 656e 636f 6469  ding: The encodi
-0002ab10: 6e67 206f 6620 7468 6520 4353 5620 6669  ng of the CSV fi
-0002ab20: 6c65 2e0a 0a20 2020 2052 6574 7572 6e73  le...    Returns
-0002ab30: 3a0a 2020 2020 2020 2020 4120 6469 6374  :.        A dict
-0002ab40: 696f 6e61 7279 2072 6570 7265 7365 6e74  ionary represent
-0002ab50: 696e 6720 7468 6520 4172 7261 7920 6461  ing the Array da
-0002ab60: 7461 2061 6e64 2063 6f6f 7264 696e 6174  ta and coordinat
-0002ab70: 6573 2e0a 0a20 2020 2045 7861 6d70 6c65  es...    Example
-0002ab80: 3a0a 2020 2020 2020 2020 6060 6070 7974  :.        ```pyt
-0002ab90: 686f 6e0a 2020 2020 2020 2020 3e3e 3e20  hon.        >>> 
-0002aba0: 636f 6f72 6473 203d 207b 2764 696d 3127  coords = {'dim1'
-0002abb0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
-0002abc0: 696d 3227 3a20 5b31 2c20 325d 7d0a 2020  im2': [1, 2]}.  
-0002abd0: 2020 2020 2020 3e3e 3e20 6172 7261 795f        >>> array_
-0002abe0: 6469 6374 203d 205f 6373 765f 746f 5f61  dict = _csv_to_a
-0002abf0: 7272 6179 2827 7465 7374 732f 6461 7461  rray('tests/data
-0002ac00: 2f61 7272 6179 2e63 7376 272c 2063 6f6f  /array.csv', coo
-0002ac10: 7264 733d 636f 6f72 6473 290a 2020 2020  rds=coords).    
-0002ac20: 2020 2020 3e3e 3e20 6172 7261 795f 6469      >>> array_di
-0002ac30: 6374 0a20 2020 2020 2020 207b 2764 6174  ct.        {'dat
-0002ac40: 6127 3a20 287b 2764 696d 3127 3a20 6172  a': ({'dim1': ar
-0002ac50: 7261 7928 5b27 6127 2c20 2762 275d 2c20  ray(['a', 'b'], 
-0002ac60: 6474 7970 653d 6f62 6a65 6374 292c 2027  dtype=object), '
-0002ac70: 6469 6d32 273a 2061 7272 6179 285b 312c  dim2': array([1,
-0002ac80: 2032 5d29 7d2c 2061 7272 6179 285b 3130   2])}, array([10
-0002ac90: 2c20 3230 5d29 292c 2027 636f 6f72 6473  , 20])), 'coords
-0002aca0: 273a 207b 2764 696d 3127 3a20 5b27 6127  ': {'dim1': ['a'
-0002acb0: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
-0002acc0: 5b31 2c20 325d 7d7d 0a0a 2020 2020 2020  [1, 2]}}..      
-0002acd0: 2020 6060 600a 2020 2020 2222 220a 2020    ```.    """.  
-0002ace0: 2020 7769 7468 206f 7065 6e28 6669 6c65    with open(file
-0002acf0: 3d70 6174 682c 206d 6f64 653d 2772 272c  =path, mode='r',
-0002ad00: 2065 6e63 6f64 696e 673d 656e 636f 6469   encoding=encodi
-0002ad10: 6e67 2920 6173 2066 3a0a 2020 2020 2020  ng) as f:.      
-0002ad20: 2020 7265 6164 6572 203d 2063 7376 2e44    reader = csv.D
-0002ad30: 6963 7452 6561 6465 7228 662c 2064 656c  ictReader(f, del
-0002ad40: 696d 6974 6572 3d64 656c 696d 6974 6572  imiter=delimiter
-0002ad50: 290a 2020 2020 2020 2020 696e 6465 7820  ).        index 
-0002ad60: 3d20 7b7d 0a20 2020 2020 2020 2068 6561  = {}.        hea
-0002ad70: 6469 6e67 7320 3d20 6e65 7874 2872 6561  dings = next(rea
-0002ad80: 6465 7229 0a20 2020 2020 2020 2061 7373  der).        ass
-0002ad90: 6572 7420 2276 616c 7565 2220 696e 2068  ert "value" in h
-0002ada0: 6561 6469 6e67 732c 2022 436f 6c75 6d6e  eadings, "Column
-0002adb0: 206e 616d 6564 2027 7661 6c75 6527 206d   named 'value' m
-0002adc0: 7573 7420 6578 6973 7422 0a20 2020 2020  ust exist".     
-0002add0: 2020 2066 6f72 2069 2c20 636f 6c20 696e     for i, col in
-0002ade0: 2065 6e75 6d65 7261 7465 2868 6561 6469   enumerate(headi
-0002adf0: 6e67 7329 3a0a 2020 2020 2020 2020 2020  ngs):.          
-0002ae00: 2020 6669 7273 745f 7661 6c75 655f 7374    first_value_st
-0002ae10: 7220 3d20 6865 6164 696e 6773 5b63 6f6c  r = headings[col
-0002ae20: 5d0a 2020 2020 2020 2020 2020 2020 7374  ].            st
-0002ae30: 725f 7374 7269 7020 3d20 6669 7273 745f  r_strip = first_
-0002ae40: 7661 6c75 655f 7374 722e 6c73 7472 6970  value_str.lstrip
-0002ae50: 2827 2d27 290a 2020 2020 2020 2020 2020  ('-').          
-0002ae60: 2020 6966 2027 2e27 2069 6e20 7374 725f    if '.' in str_
-0002ae70: 7374 7269 703a 0a20 2020 2020 2020 2020  strip:.         
-0002ae80: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0002ae90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aea0: 666c 6f61 7428 7374 725f 7374 7269 7029  float(str_strip)
-0002aeb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002aec0: 2020 2020 2064 7479 7065 203d 2066 6c6f       dtype = flo
-0002aed0: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
-0002aee0: 2020 2065 7863 6570 7420 5661 6c75 6545     except ValueE
-0002aef0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-0002af00: 2020 2020 2020 2020 2020 6474 7970 6520            dtype 
-0002af10: 3d20 6e70 2e6f 626a 6563 745f 0a20 2020  = np.object_.   
-0002af20: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0002af30: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0002af40: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-0002af50: 2020 2020 2020 2020 696e 7428 7374 725f          int(str_
-0002af60: 7374 7269 7029 0a20 2020 2020 2020 2020  strip).         
-0002af70: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
-0002af80: 203d 2069 6e74 0a20 2020 2020 2020 2020   = int.         
-0002af90: 2020 2020 2020 2065 7863 6570 7420 5661         except Va
-0002afa0: 6c75 6545 7272 6f72 3a0a 2020 2020 2020  lueError:.      
-0002afb0: 2020 2020 2020 2020 2020 2020 2020 6474                dt
-0002afc0: 7970 6520 3d20 6e70 2e6f 626a 6563 745f  ype = np.object_
-0002afd0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0002afe0: 636f 6c20 3d3d 2027 7661 6c75 6527 3a0a  col == 'value':.
-0002aff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b000: 6173 7365 7274 2064 7479 7065 203d 3d20  assert dtype == 
-0002b010: 666c 6f61 7420 6f72 2064 7479 7065 203d  float or dtype =
-0002b020: 3d20 696e 742c 2066 2243 6f6c 756d 6e20  = int, f"Column 
-0002b030: 6e61 6d65 6420 2776 616c 7565 2720 6d75  named 'value' mu
-0002b040: 7374 2062 6520 6f66 2074 7970 6520 696e  st be of type in
-0002b050: 7420 6f72 2066 6c6f 6174 2e20 476f 7420  t or float. Got 
-0002b060: 7b64 7479 7065 7d22 0a20 2020 2020 2020  {dtype}".       
-0002b070: 2020 2020 2020 2020 2076 616c 7565 203d           value =
-0002b080: 206e 702e 6c6f 6164 7478 7428 0a20 2020   np.loadtxt(.   
-0002b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b0a0: 2070 6174 682c 2073 6b69 7072 6f77 733d   path, skiprows=
-0002b0b0: 312c 2064 656c 696d 6974 6572 3d64 656c  1, delimiter=del
-0002b0c0: 696d 6974 6572 2c20 7573 6563 6f6c 733d  imiter, usecols=
-0002b0d0: 692c 2064 7479 7065 3d64 7479 7065 290a  i, dtype=dtype).
-0002b0e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0002b0f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002b100: 2020 696e 6465 785b 636f 6c5d 203d 206e    index[col] = n
-0002b110: 702e 6c6f 6164 7478 7428 0a20 2020 2020  p.loadtxt(.     
-0002b120: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002b130: 6174 682c 2073 6b69 7072 6f77 733d 312c  ath, skiprows=1,
-0002b140: 2064 656c 696d 6974 6572 3d64 656c 696d   delimiter=delim
-0002b150: 6974 6572 2c20 7573 6563 6f6c 733d 692c  iter, usecols=i,
-0002b160: 2064 7479 7065 3d64 7479 7065 290a 2020   dtype=dtype).  
-0002b170: 2020 7265 7475 726e 2064 6963 7428 6461    return dict(da
-0002b180: 7461 3d28 696e 6465 782c 2076 616c 7565  ta=(index, value
-0002b190: 292c 2063 6f6f 7264 733d 636f 6f72 6473  ), coords=coords
-0002b1a0: 290a 0a0a 6465 6620 6672 6f6d 5f63 7376  )...def from_csv
-0002b1b0: 5f74 6f5f 6469 6374 2870 6174 683a 2073  _to_dict(path: s
-0002b1c0: 7472 2c20 636f 6f72 6473 3a20 556e 696f  tr, coords: Unio
-0002b1d0: 6e5b 4469 6374 5b73 7472 2c20 6e70 2e6e  n[Dict[str, np.n
-0002b1e0: 6461 7272 6179 5d2c 204e 6f6e 655d 203d  darray], None] =
-0002b1f0: 204e 6f6e 652c 2064 656c 696d 6974 6572   None, delimiter
-0002b200: 3a20 7374 7220 3d20 272c 272c 2065 6e63  : str = ',', enc
-0002b210: 6f64 696e 673a 2073 7472 203d 2027 7574  oding: str = 'ut
-0002b220: 662d 3827 2c20 7769 7468 5f3a 2073 7472  f-8', with_: str
-0002b230: 203d 2027 6373 7627 2920 2d3e 2044 6963   = 'csv') -> Dic
-0002b240: 745b 7374 722c 2055 6e69 6f6e 5b54 7570  t[str, Union[Tup
-0002b250: 6c65 5b44 6963 745b 7374 722c 206e 702e  le[Dict[str, np.
-0002b260: 6e64 6172 7261 795d 2c20 6e70 2e6e 6461  ndarray], np.nda
-0002b270: 7272 6179 5d2c 2044 6963 745b 7374 722c  rray], Dict[str,
-0002b280: 206e 702e 6e64 6172 7261 795d 5d5d 3a0a   np.ndarray]]]:.
-0002b290: 2020 2020 2222 220a 2020 2020 4c6f 6164      """.    Load
-0002b2a0: 2061 6e20 4172 7261 7920 6469 6374 696f   an Array dictio
-0002b2b0: 6e61 7279 2066 726f 6d20 6120 4353 5620  nary from a CSV 
-0002b2c0: 6669 6c65 2e0a 0a20 2020 2041 7267 733a  file...    Args:
-0002b2d0: 0a20 2020 2020 2020 2070 6174 683a 2054  .        path: T
-0002b2e0: 6865 2070 6174 6820 746f 2074 6865 2043  he path to the C
-0002b2f0: 5356 2066 696c 652e 0a20 2020 2020 2020  SV file..       
-0002b300: 2063 6f6f 7264 733a 2054 6865 2063 6f6f   coords: The coo
-0002b310: 7264 696e 6174 6573 2066 6f72 2074 6865  rdinates for the
-0002b320: 2041 7272 6179 2e0a 2020 2020 2020 2020   Array..        
-0002b330: 6465 6c69 6d69 7465 723a 2054 6865 2064  delimiter: The d
-0002b340: 656c 696d 6974 6572 2075 7365 6420 696e  elimiter used in
-0002b350: 2074 6865 2043 5356 2066 696c 652e 0a20   the CSV file.. 
-0002b360: 2020 2020 2020 2077 6974 685f 3a20 5468         with_: Th
-0002b370: 6520 6c69 6272 6172 7920 746f 2075 7365  e library to use
-0002b380: 2066 6f72 206c 6f61 6469 6e67 2074 6865   for loading the
-0002b390: 2043 5356 2066 696c 6520 2827 6373 7627   CSV file ('csv'
-0002b3a0: 2c20 2770 616e 6461 7327 2c20 6f72 2027  , 'pandas', or '
-0002b3b0: 706f 6c61 7273 2729 2e0a 0a20 2020 2052  polars')...    R
-0002b3c0: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-0002b3d0: 4120 6469 6374 696f 6e61 7279 2072 6570  A dictionary rep
-0002b3e0: 7265 7365 6e74 696e 6720 7468 6520 4172  resenting the Ar
-0002b3f0: 7261 7920 6461 7461 2061 6e64 2063 6f6f  ray data and coo
-0002b400: 7264 696e 6174 6573 206c 6f61 6465 6420  rdinates loaded 
-0002b410: 6672 6f6d 2074 6865 2043 5356 2066 696c  from the CSV fil
-0002b420: 652e 0a0a 2020 2020 4578 616d 706c 653a  e...    Example:
-0002b430: 0a20 2020 2020 2020 2060 6060 7079 7468  .        ```pyth
-0002b440: 6f6e 0a20 2020 2020 2020 203e 3e3e 2063  on.        >>> c
-0002b450: 6f6f 7264 7320 3d20 7b27 6469 6d31 273a  oords = {'dim1':
-0002b460: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
-0002b470: 6d32 273a 205b 312c 2032 5d7d 0a20 2020  m2': [1, 2]}.   
-0002b480: 2020 2020 203e 3e3e 2061 7272 6179 5f64       >>> array_d
-0002b490: 6963 7420 3d20 6672 6f6d 5f63 7376 5f74  ict = from_csv_t
-0002b4a0: 6f5f 6469 6374 2827 7465 7374 732f 6461  o_dict('tests/da
-0002b4b0: 7461 2f61 7272 6179 2e63 7376 272c 2063  ta/array.csv', c
-0002b4c0: 6f6f 7264 733d 636f 6f72 6473 2c20 7769  oords=coords, wi
-0002b4d0: 7468 5f3d 2763 7376 2729 0a20 2020 2020  th_='csv').     
-0002b4e0: 2020 203e 3e3e 2061 7272 6179 5f64 6963     >>> array_dic
-0002b4f0: 740a 2020 2020 2020 2020 7b27 6461 7461  t.        {'data
-0002b500: 273a 2028 7b27 6469 6d31 273a 2061 7272  ': ({'dim1': arr
-0002b510: 6179 285b 2761 272c 2027 6227 5d2c 2064  ay(['a', 'b'], d
-0002b520: 7479 7065 3d6f 626a 6563 7429 2c20 2764  type=object), 'd
-0002b530: 696d 3227 3a20 6172 7261 7928 5b31 2c20  im2': array([1, 
-0002b540: 325d 297d 2c20 6172 7261 7928 5b31 302c  2])}, array([10,
-0002b550: 2032 305d 2929 2c20 2763 6f6f 7264 7327   20])), 'coords'
-0002b560: 3a20 7b27 6469 6d31 273a 205b 2761 272c  : {'dim1': ['a',
-0002b570: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
-0002b580: 312c 2032 5d7d 7d0a 0a20 2020 2020 2020  1, 2]}}..       
-0002b590: 2060 6060 0a20 2020 2022 2222 0a20 2020   ```.    """.   
-0002b5a0: 2061 7373 6572 7420 7769 7468 5f20 696e   assert with_ in
-0002b5b0: 205b 2263 7376 222c 2022 7061 6e64 6173   ["csv", "pandas
-0002b5c0: 222c 2022 706f 6c61 7273 225d 0a20 2020  ", "polars"].   
-0002b5d0: 2069 6620 7769 7468 5f20 3d3d 2022 6373   if with_ == "cs
-0002b5e0: 7622 3a0a 2020 2020 2020 2020 7265 7475  v":.        retu
-0002b5f0: 726e 205f 6373 765f 746f 5f61 7272 6179  rn _csv_to_array
-0002b600: 2870 6174 683d 7061 7468 2c20 636f 6f72  (path=path, coor
-0002b610: 6473 3d63 6f6f 7264 732c 2064 656c 696d  ds=coords, delim
-0002b620: 6974 6572 3d64 656c 696d 6974 6572 2c20  iter=delimiter, 
-0002b630: 656e 636f 6469 6e67 3d65 6e63 6f64 696e  encoding=encodin
-0002b640: 6729 0a20 2020 2069 6620 7769 7468 5f20  g).    if with_ 
-0002b650: 3d3d 2022 7061 6e64 6173 223a 0a20 2020  == "pandas":.   
-0002b660: 2020 2020 2064 6620 3d20 7064 2e72 6561       df = pd.rea
-0002b670: 645f 6373 7628 7061 7468 290a 2020 2020  d_csv(path).    
-0002b680: 2020 2020 7265 7475 726e 205f 7061 6e64      return _pand
-0002b690: 6173 5f74 6f5f 6172 7261 7928 6466 3d64  as_to_array(df=d
-0002b6a0: 662c 2063 6f6f 7264 733d 636f 6f72 6473  f, coords=coords
-0002b6b0: 290a 2020 2020 656c 6966 2077 6974 685f  ).    elif with_
-0002b6c0: 203d 3d20 2270 6f6c 6172 7322 3a0a 2020   == "polars":.  
-0002b6d0: 2020 2020 2020 6466 203d 2070 6c2e 7265        df = pl.re
-0002b6e0: 6164 5f63 7376 2870 6174 6829 0a20 2020  ad_csv(path).   
-0002b6f0: 2020 2020 2072 6574 7572 6e20 5f70 6f6c       return _pol
-0002b700: 6172 735f 746f 5f61 7272 6179 2864 663d  ars_to_array(df=
-0002b710: 6466 2c20 636f 6f72 6473 3d63 6f6f 7264  df, coords=coord
-0002b720: 7329 0a0a 0a64 6566 2066 726f 6d5f 6373  s)...def from_cs
-0002b730: 7628 7061 7468 3a20 7374 722c 2063 6f6f  v(path: str, coo
-0002b740: 7264 733a 2055 6e69 6f6e 5b44 6963 745b  rds: Union[Dict[
-0002b750: 7374 722c 206e 702e 6e64 6172 7261 795d  str, np.ndarray]
-0002b760: 2c20 4e6f 6e65 5d20 3d20 4e6f 6e65 2c20  , None] = None, 
-0002b770: 6465 6c69 6d69 7465 723a 2073 7472 203d  delimiter: str =
-0002b780: 2027 2c27 2c20 656e 636f 6469 6e67 3a20   ',', encoding: 
-0002b790: 7374 7220 3d20 2775 7466 2d38 272c 2077  str = 'utf-8', w
-0002b7a0: 6974 685f 3a20 7374 7220 3d20 2763 7376  ith_: str = 'csv
-0002b7b0: 2729 202d 3e20 4172 7261 793a 0a20 2020  ') -> Array:.   
-0002b7c0: 2022 2222 0a20 2020 204c 6f61 6420 616e   """.    Load an
-0002b7d0: 2041 7272 6179 206f 626a 6563 7420 6672   Array object fr
-0002b7e0: 6f6d 2061 2043 5356 2066 696c 652e 0a0a  om a CSV file...
-0002b7f0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0002b800: 2020 7061 7468 3a20 5468 6520 7061 7468    path: The path
-0002b810: 2074 6f20 7468 6520 4353 5620 6669 6c65   to the CSV file
-0002b820: 2e0a 2020 2020 2020 2020 636f 6f72 6473  ..        coords
-0002b830: 3a20 5468 6520 636f 6f72 6469 6e61 7465  : The coordinate
-0002b840: 7320 666f 7220 7468 6520 4172 7261 792e  s for the Array.
-0002b850: 0a20 2020 2020 2020 2064 656c 696d 6974  .        delimit
-0002b860: 6572 3a20 5468 6520 6465 6c69 6d69 7465  er: The delimite
-0002b870: 7220 7573 6564 2069 6e20 7468 6520 4353  r used in the CS
-0002b880: 5620 6669 6c65 2e0a 2020 2020 2020 2020  V file..        
-0002b890: 656e 636f 6469 6e67 3a20 5468 6520 656e  encoding: The en
-0002b8a0: 636f 6469 6e67 206f 6620 7468 6520 4353  coding of the CS
-0002b8b0: 5620 6669 6c65 2e0a 2020 2020 2020 2020  V file..        
-0002b8c0: 7769 7468 5f3a 2054 6865 206c 6962 7261  with_: The libra
-0002b8d0: 7279 2074 6f20 7573 6520 666f 7220 6c6f  ry to use for lo
-0002b8e0: 6164 696e 6720 7468 6520 4353 5620 6669  ading the CSV fi
-0002b8f0: 6c65 2028 2763 7376 272c 2027 7061 6e64  le ('csv', 'pand
-0002b900: 6173 272c 206f 7220 2770 6f6c 6172 7327  as', or 'polars'
-0002b910: 292e 0a0a 2020 2020 5265 7475 726e 733a  )...    Returns:
-0002b920: 0a20 2020 2020 2020 2041 6e20 4172 7261  .        An Arra
-0002b930: 7920 6f62 6a65 6374 206c 6f61 6465 6420  y object loaded 
-0002b940: 6672 6f6d 2074 6865 2043 5356 2066 696c  from the CSV fil
-0002b950: 652e 0a0a 2020 2020 4578 616d 706c 653a  e...    Example:
-0002b960: 0a20 2020 2020 2020 2060 6060 7079 7468  .        ```pyth
-0002b970: 6f6e 0a20 2020 2020 2020 203e 3e3e 2063  on.        >>> c
-0002b980: 6f6f 7264 7320 3d20 7b27 6469 6d31 273a  oords = {'dim1':
-0002b990: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
-0002b9a0: 6d32 273a 205b 312c 2032 5d7d 0a20 2020  m2': [1, 2]}.   
-0002b9b0: 2020 2020 203e 3e3e 2061 7272 203d 2066       >>> arr = f
-0002b9c0: 726f 6d5f 6373 7628 2774 6573 7473 2f64  rom_csv('tests/d
-0002b9d0: 6174 612f 6172 7261 792e 6373 7627 2c20  ata/array.csv', 
-0002b9e0: 636f 6f72 6473 3d63 6f6f 7264 732c 2077  coords=coords, w
-0002b9f0: 6974 685f 3d27 6373 7627 290a 2020 2020  ith_='csv').    
-0002ba00: 2020 2020 3e3e 3e20 6172 720a 2020 2020      >>> arr.    
-0002ba10: 2020 2020 4172 7261 7928 6461 7461 3d61      Array(data=a
-0002ba20: 7272 6179 285b 5b31 302c 2020 305d 2c0a  rray([[10,  0],.
-0002ba30: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0002ba40: 2030 2c20 3230 5d5d 292c 2063 6f6f 7264   0, 20]]), coord
-0002ba50: 733d 7b27 6469 6d31 273a 2061 7272 6179  s={'dim1': array
-0002ba60: 285b 2761 272c 2027 6227 5d2c 2064 7479  (['a', 'b'], dty
-0002ba70: 7065 3d6f 626a 6563 7429 2c20 2764 696d  pe=object), 'dim
-0002ba80: 3227 3a20 6172 7261 7928 5b31 2c20 325d  2': array([1, 2]
-0002ba90: 297d 290a 0a20 2020 2020 2020 2060 6060  )})..        ```
-0002baa0: 0a20 2020 2022 2222 0a20 2020 2072 6574  .    """.    ret
-0002bab0: 7572 6e20 4172 7261 7928 2a2a 6672 6f6d  urn Array(**from
-0002bac0: 5f63 7376 5f74 6f5f 6469 6374 2870 6174  _csv_to_dict(pat
-0002bad0: 682c 2063 6f6f 7264 733d 636f 6f72 6473  h, coords=coords
-0002bae0: 2c20 6465 6c69 6d69 7465 723d 6465 6c69  , delimiter=deli
-0002baf0: 6d69 7465 722c 2065 6e63 6f64 696e 673d  miter, encoding=
-0002bb00: 656e 636f 6469 6e67 2c20 7769 7468 5f3d  encoding, with_=
-0002bb10: 7769 7468 5f29 290a 0a0a 6465 6620 5f6a  with_))...def _j
-0002bb20: 6f69 6e5f 7374 7228 6172 723a 204c 6973  oin_str(arr: Lis
-0002bb30: 745b 6e70 2e6e 6461 7272 6179 5d2c 2073  t[np.ndarray], s
-0002bb40: 6570 3a20 7374 7229 202d 3e20 6e70 2e6e  ep: str) -> np.n
-0002bb50: 6461 7272 6179 3a0a 2020 2020 2222 220a  darray:.    """.
-0002bb60: 2020 2020 4a6f 696e 2061 206c 6973 7420      Join a list 
-0002bb70: 6f66 2073 7472 696e 6720 6172 7261 7973  of string arrays
-0002bb80: 2069 6e74 6f20 6120 7369 6e67 6c65 2073   into a single s
-0002bb90: 7472 696e 6720 6172 7261 7920 7573 696e  tring array usin
-0002bba0: 6720 6120 7365 7061 7261 746f 722e 0a0a  g a separator...
-0002bbb0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0002bbc0: 2020 6172 723a 2041 206c 6973 7420 6f66    arr: A list of
-0002bbd0: 2073 7472 696e 6720 6172 7261 7973 2074   string arrays t
-0002bbe0: 6f20 6a6f 696e 2e0a 2020 2020 2020 2020  o join..        
-0002bbf0: 7365 703a 2054 6865 2073 6570 6172 6174  sep: The separat
-0002bc00: 6f72 2074 6f20 7573 6520 666f 7220 6a6f  or to use for jo
-0002bc10: 696e 696e 6720 7468 6520 7374 7269 6e67  ining the string
-0002bc20: 732e 0a0a 2020 2020 5265 7475 726e 733a  s...    Returns:
-0002bc30: 0a20 2020 2020 2020 2041 2073 696e 676c  .        A singl
-0002bc40: 6520 7374 7269 6e67 2061 7272 6179 2077  e string array w
-0002bc50: 6974 6820 7468 6520 6a6f 696e 6564 2073  ith the joined s
-0002bc60: 7472 696e 6773 2e0a 0a20 2020 2045 7861  trings...    Exa
-0002bc70: 6d70 6c65 3a0a 2020 2020 2020 2020 6060  mple:.        ``
-0002bc80: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
-0002bc90: 3e3e 3e20 6172 7220 3d20 5b6e 702e 6172  >>> arr = [np.ar
-0002bca0: 7261 7928 5b27 6127 2c20 2762 275d 292c  ray(['a', 'b']),
-0002bcb0: 206e 702e 6172 7261 7928 5b27 3127 2c20   np.array(['1', 
-0002bcc0: 2732 275d 295d 0a20 2020 2020 2020 203e  '2'])].        >
-0002bcd0: 3e3e 2073 6570 203d 2027 3a27 0a20 2020  >> sep = ':'.   
-0002bce0: 2020 2020 203e 3e3e 206a 6f69 6e65 645f       >>> joined_
-0002bcf0: 6172 7220 3d20 5f6a 6f69 6e5f 7374 7228  arr = _join_str(
-0002bd00: 6172 722c 2073 6570 290a 2020 2020 2020  arr, sep).      
-0002bd10: 2020 3e3e 3e20 6a6f 696e 6564 5f61 7272    >>> joined_arr
-0002bd20: 0a20 2020 2020 2020 2061 7272 6179 285b  .        array([
-0002bd30: 2761 3a31 272c 2027 623a 3227 5d2c 2064  'a:1', 'b:2'], d
-0002bd40: 7479 7065 3d27 3c55 3327 290a 0a20 2020  type='<U3')..   
-0002bd50: 2020 2020 2060 6060 0a20 2020 2022 2222       ```.    """
-0002bd60: 0a20 2020 2072 6f77 7320 3d20 6172 725b  .    rows = arr[
-0002bd70: 305d 2e73 6861 7065 5b30 5d0a 2020 2020  0].shape[0].    
-0002bd80: 636f 6c75 6d6e 7320 3d20 6c65 6e28 6172  columns = len(ar
-0002bd90: 7229 0a20 2020 2073 6570 6172 6174 6f72  r).    separator
-0002bda0: 5f73 7472 203d 206e 702e 7265 7065 6174  _str = np.repeat
-0002bdb0: 285b 7365 705d 2c20 726f 7773 290a 0a20  ([sep], rows).. 
-0002bdc0: 2020 2061 7272 6179 7320 3d20 5b5d 0a20     arrays = []. 
-0002bdd0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-0002bde0: 6528 636f 6c75 6d6e 7329 3a0a 2020 2020  e(columns):.    
-0002bdf0: 2020 2020 6172 7261 7973 2e61 7070 656e      arrays.appen
-0002be00: 6428 6172 725b 695d 2e61 7374 7970 6528  d(arr[i].astype(
-0002be10: 7374 7229 290a 2020 2020 2020 2020 6966  str)).        if
-0002be20: 2069 2021 3d20 636f 6c75 6d6e 732d 313a   i != columns-1:
-0002be30: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-0002be40: 6179 732e 6170 7065 6e64 2873 6570 6172  ays.append(separ
-0002be50: 6174 6f72 5f73 7472 290a 2020 2020 7265  ator_str).    re
-0002be60: 7475 726e 2066 756e 6374 6f6f 6c73 5f72  turn functools_r
-0002be70: 6564 7563 6528 6c61 6d62 6461 2078 2c20  educe(lambda x, 
-0002be80: 793a 206e 702e 6368 6172 2e61 6464 2878  y: np.char.add(x
-0002be90: 2c20 7929 2c20 6172 7261 7973 290a 0a0a  , y), arrays)...
-0002bea0: 6465 6620 6e64 6172 7261 795f 6368 6f69  def ndarray_choi
-0002beb0: 6365 2870 3a20 556e 696f 6e5b 6e70 2e6e  ce(p: Union[np.n
-0002bec0: 6461 7272 6179 2c20 2773 702e 434f 4f27  darray, 'sp.COO'
-0002bed0: 5d2c 2061 7869 733a 2069 6e74 2c20 726e  ], axis: int, rn
-0002bee0: 673a 206e 702e 7261 6e64 6f6d 2e47 656e  g: np.random.Gen
-0002bef0: 6572 6174 6f72 2920 2d3e 2055 6e69 6f6e  erator) -> Union
-0002bf00: 5b6e 702e 6e64 6172 7261 792c 2027 7370  [np.ndarray, 'sp
-0002bf10: 2e43 4f4f 275d 3a0a 2020 2020 2222 220a  .COO']:.    """.
-0002bf20: 2020 2020 5261 6e64 6f6d 6c79 2063 686f      Randomly cho
-0002bf30: 6f73 6520 656c 656d 656e 7473 2061 6c6f  ose elements alo
-0002bf40: 6e67 2061 2073 7065 6369 6669 6564 2061  ng a specified a
-0002bf50: 7869 7320 6261 7365 6420 6f6e 2074 6865  xis based on the
-0002bf60: 2067 6976 656e 2070 726f 6261 6269 6c69   given probabili
-0002bf70: 7469 6573 2e0a 0a20 2020 2041 7267 733a  ties...    Args:
-0002bf80: 0a20 2020 2020 2020 2070 3a20 5468 6520  .        p: The 
-0002bf90: 6172 7261 7920 6f66 2070 726f 6261 6269  array of probabi
-0002bfa0: 6c69 7469 6573 2e0a 2020 2020 2020 2020  lities..        
-0002bfb0: 6178 6973 3a20 5468 6520 6178 6973 2061  axis: The axis a
-0002bfc0: 6c6f 6e67 2077 6869 6368 2074 6f20 7065  long which to pe
-0002bfd0: 7266 6f72 6d20 7468 6520 6368 6f69 6365  rform the choice
-0002bfe0: 2e0a 2020 2020 2020 2020 726e 673a 2054  ..        rng: T
-0002bff0: 6865 2072 616e 646f 6d20 6e75 6d62 6572  he random number
-0002c000: 2067 656e 6572 6174 6f72 2074 6f20 7573   generator to us
-0002c010: 652e 0a0a 2020 2020 5265 7475 726e 733a  e...    Returns:
-0002c020: 0a20 2020 2020 2020 2041 6e20 6172 7261  .        An arra
-0002c030: 7920 6f66 2062 6f6f 6c65 616e 2076 616c  y of boolean val
-0002c040: 7565 7320 696e 6469 6361 7469 6e67 2074  ues indicating t
-0002c050: 6865 2063 686f 7365 6e20 656c 656d 656e  he chosen elemen
-0002c060: 7473 2e0a 0a20 2020 2045 7861 6d70 6c65  ts...    Example
-0002c070: 3a0a 2020 2020 2020 2020 6060 6070 7974  :.        ```pyt
-0002c080: 686f 6e0a 2020 2020 2020 2020 3e3e 3e20  hon.        >>> 
-0002c090: 7020 3d20 6e70 2e61 7272 6179 285b 5b30  p = np.array([[0
-0002c0a0: 2e31 2c20 302e 395d 2c20 5b30 2e37 2c20  .1, 0.9], [0.7, 
-0002c0b0: 302e 335d 5d29 0a20 2020 2020 2020 203e  0.3]]).        >
-0002c0c0: 3e3e 2061 7869 7320 3d20 310a 2020 2020  >> axis = 1.    
-0002c0d0: 2020 2020 3e3e 3e20 726e 6720 3d20 6e70      >>> rng = np
-0002c0e0: 2e72 616e 646f 6d2e 6465 6661 756c 745f  .random.default_
-0002c0f0: 726e 6728 7365 6564 3d34 3229 0a20 2020  rng(seed=42).   
-0002c100: 2020 2020 203e 3e3e 2063 686f 7365 6e5f       >>> chosen_
-0002c110: 6172 7220 3d20 6e64 6172 7261 795f 6368  arr = ndarray_ch
-0002c120: 6f69 6365 2870 2c20 6178 6973 2c20 726e  oice(p, axis, rn
-0002c130: 6729 0a20 2020 2020 2020 203e 3e3e 2063  g).        >>> c
-0002c140: 686f 7365 6e5f 6172 720a 2020 2020 2020  hosen_arr.      
-0002c150: 2020 6172 7261 7928 5b5b 4661 6c73 652c    array([[False,
-0002c160: 2020 5472 7565 5d2c 0a20 2020 2020 2020    True],.       
-0002c170: 2020 2020 2020 2020 5b20 5472 7565 2c20          [ True, 
-0002c180: 4661 6c73 655d 5d29 0a0a 2020 2020 2020  False]])..      
-0002c190: 2020 6060 600a 2020 2020 2222 220a 2020    ```.    """.  
-0002c1a0: 2020 6465 6620 5f6d 6173 6b69 6e67 2870    def _masking(p
-0002c1b0: 2c20 6178 6973 293a 0a20 2020 2020 2020  , axis):.       
-0002c1c0: 2073 6861 7065 203d 205b 6e72 2066 6f72   shape = [nr for
-0002c1d0: 2069 2c20 6e72 2069 6e20 656e 756d 6572   i, nr in enumer
-0002c1e0: 6174 6528 702e 7368 6170 6529 2069 6620  ate(p.shape) if 
-0002c1f0: 6920 213d 2061 7869 735d 0a20 2020 2020  i != axis].     
-0002c200: 2020 2072 616e 6420 3d20 726e 672e 7261     rand = rng.ra
-0002c210: 6e64 6f6d 2874 7570 6c65 2873 6861 7065  ndom(tuple(shape
-0002c220: 2929 0a20 2020 2020 2020 2072 203d 206e  )).        r = n
-0002c230: 702e 6578 7061 6e64 5f64 696d 7328 7261  p.expand_dims(ra
-0002c240: 6e64 2c20 6178 6973 3d61 7869 7329 0a0a  nd, axis=axis)..
-0002c250: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0002c260: 7461 6e63 6528 702c 206e 702e 6e64 6172  tance(p, np.ndar
-0002c270: 7261 7929 3a0a 2020 2020 2020 2020 2020  ray):.          
-0002c280: 2020 6375 6d20 3d20 6e70 2e63 756d 7375    cum = np.cumsu
-0002c290: 6d28 702c 2061 7869 733d 6178 6973 290a  m(p, axis=axis).
-0002c2a0: 2020 2020 2020 2020 656c 6966 205f 6973          elif _is
-0002c2b0: 696e 7374 616e 6365 5f6f 7074 696f 6e61  instance_optiona
-0002c2c0: 6c5f 706b 6773 2870 2c20 2773 702e 434f  l_pkgs(p, 'sp.CO
-0002c2d0: 4f27 293a 0a20 2020 2020 2020 2020 2020  O'):.           
-0002c2e0: 2063 756d 203d 206e 702e 6375 6d73 756d   cum = np.cumsum
-0002c2f0: 2870 2e74 6f64 656e 7365 2829 2c20 6178  (p.todense(), ax
-0002c300: 6973 3d61 7869 7329 0a20 2020 2020 2020  is=axis).       
-0002c310: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0002c320: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
-0002c330: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-0002c340: 2020 2020 2273 7061 7273 6520 7061 636b      "sparse pack
-0002c350: 6167 6520 6d75 7374 2062 6520 696e 7374  age must be inst
-0002c360: 616c 6c65 6420 746f 2075 7365 2074 6869  alled to use thi
-0002c370: 7320 6675 6e63 7469 6f6e 2077 6974 6820  s function with 
-0002c380: 7365 7474 696e 6773 2e64 6174 615f 7479  settings.data_ty
-0002c390: 7065 203d 2027 7370 6172 7365 272e 204f  pe = 'sparse'. O
-0002c3a0: 7468 6572 7769 7365 2c20 7365 7420 7365  therwise, set se
-0002c3b0: 7474 696e 6773 2e64 6174 615f 7479 7065  ttings.data_type
-0002c3c0: 203d 2027 6465 6e73 6527 2229 0a0a 2020   = 'dense'")..  
-0002c3d0: 2020 2020 2020 6173 7365 7274 206e 702e        assert np.
-0002c3e0: 616c 6c63 6c6f 7365 2863 756d 2e6d 6178  allclose(cum.max
-0002c3f0: 2861 7869 733d 6178 6973 292c 0a20 2020  (axis=axis),.   
-0002c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c410: 2020 2020 2020 2020 312e 3029 2c20 2250          1.0), "P
-0002c420: 726f 6261 6269 6c69 7469 6573 2064 6f20  robabilities do 
-0002c430: 6e6f 7420 7375 6d20 746f 2031 220a 2020  not sum to 1".  
-0002c440: 2020 2020 2020 6d61 736b 203d 2028 6375        mask = (cu
-0002c450: 6d20 3e20 7229 0a20 2020 2020 2020 2072  m > r).        r
-0002c460: 6574 7572 6e20 6d61 736b 0a0a 2020 2020  eturn mask..    
-0002c470: 6465 6620 5f75 6e72 6176 656c 286d 6173  def _unravel(mas
-0002c480: 6b2c 2061 7869 7329 3a0a 2020 2020 2020  k, axis):.      
-0002c490: 2020 6172 6773 203d 206d 6173 6b2e 6172    args = mask.ar
-0002c4a0: 676d 6178 2861 7869 733d 6178 6973 2c20  gmax(axis=axis, 
-0002c4b0: 6b65 6570 6469 6d73 3d54 7275 6529 0a20  keepdims=True). 
-0002c4c0: 2020 2020 2020 2069 6478 203d 206e 702e         idx = np.
-0002c4d0: 756e 7261 7665 6c5f 696e 6465 7828 6e70  unravel_index(np
-0002c4e0: 2e61 7261 6e67 6528 6172 6773 2e73 697a  .arange(args.siz
-0002c4f0: 6529 2c20 6172 6773 2e73 6861 7065 290a  e), args.shape).
-0002c500: 2020 2020 2020 2020 6172 6773 5f72 6176          args_rav
-0002c510: 656c 203d 2061 7267 732e 7261 7665 6c28  el = args.ravel(
-0002c520: 290a 2020 2020 2020 2020 6e65 775f 6964  ).        new_id
-0002c530: 7820 3d20 5b61 7272 2069 6620 6920 213d  x = [arr if i !=
-0002c540: 2061 7869 7320 656c 7365 2061 7267 735f   axis else args_
-0002c550: 7261 7665 6c20 666f 7220 692c 0a20 2020  ravel for i,.   
-0002c560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c570: 6172 7220 696e 2065 6e75 6d65 7261 7465  arr in enumerate
-0002c580: 2869 6478 295d 0a20 2020 2020 2020 2072  (idx)].        r
-0002c590: 6574 7572 6e20 6e65 775f 6964 780a 0a20  eturn new_idx.. 
-0002c5a0: 2020 2064 6566 205f 6e64 5f62 6f6f 6c28     def _nd_bool(
-0002c5b0: 6964 7873 2c20 7368 6170 652c 2073 697a  idxs, shape, siz
-0002c5c0: 6529 3a0a 2020 2020 2020 2020 696e 6465  e):.        inde
-0002c5d0: 7865 7320 3d20 6e70 2e72 6176 656c 5f6d  xes = np.ravel_m
-0002c5e0: 756c 7469 5f69 6e64 6578 2869 6478 732c  ulti_index(idxs,
-0002c5f0: 2073 6861 7065 290a 2020 2020 2020 2020   shape).        
-0002c600: 666c 6174 7465 6e5f 6465 6e73 6520 3d20  flatten_dense = 
-0002c610: 6e70 2e65 6d70 7479 2828 7369 7a65 2c29  np.empty((size,)
-0002c620: 2c20 6474 7970 653d 626f 6f6c 290a 2020  , dtype=bool).  
-0002c630: 2020 2020 2020 666c 6174 7465 6e5f 6465        flatten_de
-0002c640: 6e73 655b 3a5d 203d 2046 616c 7365 0a20  nse[:] = False. 
-0002c650: 2020 2020 2020 2066 6c61 7474 656e 5f64         flatten_d
-0002c660: 656e 7365 5b69 6e64 6578 6573 5d20 3d20  ense[indexes] = 
-0002c670: 5472 7565 0a20 2020 2020 2020 206e 645f  True.        nd_
-0002c680: 6465 6e73 6520 3d20 666c 6174 7465 6e5f  dense = flatten_
-0002c690: 6465 6e73 652e 7669 6577 2829 2e72 6573  dense.view().res
-0002c6a0: 6861 7065 2873 6861 7065 290a 2020 2020  hape(shape).    
-0002c6b0: 2020 2020 7265 7475 726e 206e 645f 6465      return nd_de
-0002c6c0: 6e73 650a 0a20 2020 2073 6861 7065 203d  nse..    shape =
-0002c6d0: 2070 2e73 6861 7065 0a20 2020 2073 697a   p.shape.    siz
-0002c6e0: 6520 3d20 702e 7369 7a65 0a20 2020 206d  e = p.size.    m
-0002c6f0: 6173 6b20 3d20 5f6d 6173 6b69 6e67 2870  ask = _masking(p
-0002c700: 2c20 6178 6973 290a 2020 2020 6964 7873  , axis).    idxs
-0002c710: 203d 205f 756e 7261 7665 6c28 6d61 736b   = _unravel(mask
-0002c720: 2c20 6178 6973 290a 2020 2020 6465 6c20  , axis).    del 
-0002c730: 6d61 736b 0a20 2020 2072 6574 7572 6e20  mask.    return 
-0002c740: 5f6e 645f 626f 6f6c 2869 6478 732c 2073  _nd_bool(idxs, s
-0002c750: 6861 7065 2c20 7369 7a65 290a 0a0a 6465  hape, size)...de
-0002c760: 6620 756e 696f 6e5f 6d75 6c74 695f 636f  f union_multi_co
-0002c770: 6f72 6473 282a 6172 6773 3a20 4c69 7374  ords(*args: List
-0002c780: 5b44 6963 745b 7374 722c 206e 702e 6e64  [Dict[str, np.nd
-0002c790: 6172 7261 795d 5d29 202d 3e20 4469 6374  array]]) -> Dict
-0002c7a0: 5b73 7472 2c20 6e70 2e6e 6461 7272 6179  [str, np.ndarray
-0002c7b0: 5d3a 0a20 2020 2022 2222 0a20 2020 2055  ]:.    """.    U
-0002c7c0: 6e69 6f6e 206d 756c 7469 706c 6520 636f  nion multiple co
-0002c7d0: 6f72 6469 6e61 7465 2064 6963 7469 6f6e  ordinate diction
-0002c7e0: 6172 6965 732e 0a0a 2020 2020 4172 6773  aries...    Args
-0002c7f0: 3a0a 2020 2020 2020 2020 2a61 7267 733a  :.        *args:
-0002c800: 2056 6172 6961 626c 6520 6c65 6e67 7468   Variable length
-0002c810: 2061 7267 756d 656e 7420 6c69 7374 206f   argument list o
-0002c820: 6620 636f 6f72 6469 6e61 7465 2064 6963  f coordinate dic
-0002c830: 7469 6f6e 6172 6965 732e 0a0a 2020 2020  tionaries...    
-0002c840: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-0002c850: 2041 2064 6963 7469 6f6e 6172 7920 7769   A dictionary wi
-0002c860: 7468 2074 6865 2075 6e69 6f6e 206f 6620  th the union of 
-0002c870: 636f 6f72 6469 6e61 7465 7320 6672 6f6d  coordinates from
-0002c880: 2061 6c6c 2069 6e70 7574 2064 6963 7469   all input dicti
-0002c890: 6f6e 6172 6965 732e 0a0a 2020 2020 4578  onaries...    Ex
-0002c8a0: 616d 706c 653a 0a20 2020 2020 2020 2060  ample:.        `
-0002c8b0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-0002c8c0: 203e 3e3e 2063 6f6f 7264 7331 203d 207b   >>> coords1 = {
-0002c8d0: 2764 696d 3127 3a20 6e70 2e61 7272 6179  'dim1': np.array
-0002c8e0: 285b 312c 2032 5d29 2c20 2764 696d 3227  ([1, 2]), 'dim2'
-0002c8f0: 3a20 6e70 2e61 7272 6179 285b 332c 2034  : np.array([3, 4
-0002c900: 5d29 7d0a 2020 2020 2020 2020 3e3e 3e20  ])}.        >>> 
-0002c910: 636f 6f72 6473 3220 3d20 7b27 6469 6d31  coords2 = {'dim1
-0002c920: 273a 206e 702e 6172 7261 7928 5b31 2c20  ': np.array([1, 
-0002c930: 325d 292c 2027 6469 6d32 273a 206e 702e  2]), 'dim2': np.
-0002c940: 6172 7261 7928 5b35 2c20 365d 297d 0a20  array([5, 6])}. 
-0002c950: 2020 2020 2020 203e 3e3e 2075 6e69 6f6e         >>> union
-0002c960: 5f6d 756c 7469 5f63 6f6f 7264 7328 636f  _multi_coords(co
-0002c970: 6f72 6473 312c 2063 6f6f 7264 7332 290a  ords1, coords2).
-0002c980: 2020 2020 2020 2020 7b27 6469 6d31 273a          {'dim1':
-0002c990: 2061 7272 6179 285b 312c 2032 5d29 2c20   array([1, 2]), 
-0002c9a0: 2764 696d 3227 3a20 6172 7261 7928 5b33  'dim2': array([3
-0002c9b0: 2c20 342c 2035 2c20 365d 297d 0a0a 2020  , 4, 5, 6])}..  
-0002c9c0: 2020 2020 2020 6060 600a 2020 2020 2222        ```.    ""
-0002c9d0: 220a 2020 2020 6173 7365 7274 2061 6c6c  ".    assert all
-0002c9e0: 285b 7475 706c 6528 636f 6f72 6473 2920  ([tuple(coords) 
-0002c9f0: 3d3d 2074 7570 6c65 2861 7267 735b 305d  == tuple(args[0]
-0002ca00: 2920 666f 7220 636f 6f72 6473 2069 6e20  ) for coords in 
-0002ca10: 6172 6773 5d29 0a20 2020 2064 696d 7320  args]).    dims 
-0002ca20: 3d20 6c69 7374 2861 7267 735b 305d 290a  = list(args[0]).
-0002ca30: 2020 2020 6e65 775f 636f 6f72 6473 203d      new_coords =
-0002ca40: 207b 7d0a 2020 2020 666f 7220 636f 6f72   {}.    for coor
-0002ca50: 6473 2069 6e20 6172 6773 3a0a 2020 2020  ds in args:.    
-0002ca60: 2020 2020 666f 7220 6469 6d20 696e 2064      for dim in d
-0002ca70: 696d 733a 0a20 2020 2020 2020 2020 2020  ims:.           
-0002ca80: 2069 6620 6469 6d20 6e6f 7420 696e 206e   if dim not in n
-0002ca90: 6577 5f63 6f6f 7264 733a 0a20 2020 2020  ew_coords:.     
-0002caa0: 2020 2020 2020 2020 2020 206e 6577 5f63             new_c
-0002cab0: 6f6f 7264 735b 6469 6d5d 203d 2063 6f6f  oords[dim] = coo
-0002cac0: 7264 735b 6469 6d5d 0a20 2020 2020 2020  rds[dim].       
-0002cad0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0002cae0: 2020 2020 2020 2020 2020 2069 6620 6e65             if ne
-0002caf0: 775f 636f 6f72 6473 5b64 696d 5d2e 7369  w_coords[dim].si
-0002cb00: 7a65 203d 3d20 636f 6f72 6473 5b64 696d  ze == coords[dim
-0002cb10: 5d2e 7369 7a65 3a0a 2020 2020 2020 2020  ].size:.        
-0002cb20: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-0002cb30: 6c6c 286e 6577 5f63 6f6f 7264 735b 6469  ll(new_coords[di
-0002cb40: 6d5d 203d 3d20 636f 6f72 6473 5b64 696d  m] == coords[dim
-0002cb50: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-0002cb60: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-0002cb70: 696e 7565 0a20 2020 2020 2020 2020 2020  inue.           
-0002cb80: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0002cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cba0: 2020 2020 2020 206e 6577 5f63 6f6f 7264         new_coord
-0002cbb0: 735b 6469 6d5d 203d 206e 702e 756e 696f  s[dim] = np.unio
-0002cbc0: 6e31 6428 0a20 2020 2020 2020 2020 2020  n1d(.           
+00024010: 2020 2020 2063 6f6f 7264 735b 6e65 775f       coords[new_
+00024020: 6469 6d5d 203d 205f 7465 7374 5f74 7970  dim] = _test_typ
+00024030: 655f 616e 645f 7570 6461 7465 280a 2020  e_and_update(.  
+00024040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024050: 2020 2020 2020 2020 2020 7661 6c75 655b            value[
+00024060: 6578 6973 7469 6e67 5f64 696d 5d5b 315d  existing_dim][1]
+00024070: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00024080: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00024090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000240a0: 2020 2020 636f 6f72 6473 5b6e 6577 5f64      coords[new_d
+000240b0: 696d 5d20 3d20 6e70 2e75 6e69 7175 6528  im] = np.unique(
+000240c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000240d0: 2020 2020 2020 2020 2020 2020 205f 7465               _te
+000240e0: 7374 5f74 7970 655f 616e 645f 7570 6461  st_type_and_upda
+000240f0: 7465 2876 616c 7565 5b65 7869 7374 696e  te(value[existin
+00024100: 675f 6469 6d5d 5b31 5d29 290a 2020 2020  g_dim][1])).    
+00024110: 2020 2020 2020 2020 2320 7468 6973 2069          # this i
+00024120: 7320 6120 6c69 7374 206f 6620 7374 7269  s a list of stri
+00024130: 6e67 7320 7468 6174 2072 6570 7265 7365  ngs that represe
+00024140: 6e74 2073 6576 6572 616c 2064 696d 656e  nt several dimen
+00024150: 7369 6f6e 7320 6e61 6d65 6420 696e 2073  sions named in s
+00024160: 656c 662e 6469 6d73 2e20 5468 6520 6e65  elf.dims. The ne
+00024170: 7720 6469 6d65 6e73 696f 6e20 6973 2074  w dimension is t
+00024180: 6865 2063 6f6e 6361 7465 6e61 7469 6f6e  he concatenation
+00024190: 206f 6620 7468 6520 7365 6c65 6374 6564   of the selected
+000241a0: 2064 696d 656e 7369 6f6e 730a 2020 2020   dimensions.    
+000241b0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+000241c0: 6e73 7461 6e63 6528 7661 6c75 652c 206c  nstance(value, l
+000241d0: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
+000241e0: 2020 2020 2020 6173 7365 7274 2076 616c        assert val
+000241f0: 7565 2c20 224c 6973 7420 6361 6e6e 6f74  ue, "List cannot
+00024200: 2062 6520 656d 7074 7922 0a20 2020 2020   be empty".     
+00024210: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00024220: 7420 616c 6c28 5b69 7369 6e73 7461 6e63  t all([isinstanc
+00024230: 6528 6974 656d 2c20 7374 7229 2066 6f72  e(item, str) for
+00024240: 2069 7465 6d20 696e 2076 616c 7565 5d29   item in value])
+00024250: 2c20 2241 6c6c 2069 7465 6d73 2069 6e20  , "All items in 
+00024260: 7468 6520 6c69 7374 206d 7573 7420 6265  the list must be
+00024270: 2073 7472 220a 2020 2020 2020 2020 2020   str".          
+00024280: 2020 2020 2020 6173 7365 7274 2061 6c6c        assert all
+00024290: 285b 6469 6d20 696e 2073 656c 662e 6469  ([dim in self.di
+000242a0: 6d73 2066 6f72 2064 696d 2069 6e20 7661  ms for dim in va
+000242b0: 6c75 655d 292c 2022 416c 6c20 6974 656d  lue]), "All item
+000242c0: 7320 696e 2074 6865 206c 6973 7420 6d75  s in the list mu
+000242d0: 7374 2062 6520 696e 2064 696d 7322 0a20  st be in dims". 
+000242e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000242f0: 656c 6563 7465 645f 636f 6f72 6473 203d  elected_coords =
+00024300: 207b 6469 6d3a 2073 656c 662e 636f 6f72   {dim: self.coor
+00024310: 6473 5b64 696d 5d20 666f 7220 6469 6d20  ds[dim] for dim 
+00024320: 696e 2076 616c 7565 7d0a 2020 2020 2020  in value}.      
+00024330: 2020 2020 2020 2020 2020 6172 7261 7973            arrays
+00024340: 203d 206e 702e 756e 7261 7665 6c5f 696e   = np.unravel_in
+00024350: 6465 7828 6e70 2e61 7261 6e67 6528 7365  dex(np.arange(se
+00024360: 6c66 2e5f 6361 7061 6369 7479 280a 2020  lf._capacity(.  
+00024370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024380: 2020 7365 6c65 6374 6564 5f63 6f6f 7264    selected_coord
+00024390: 7329 292c 2073 656c 662e 5f73 6861 7065  s)), self._shape
+000243a0: 2873 656c 6563 7465 645f 636f 6f72 6473  (selected_coords
+000243b0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+000243c0: 2020 2069 6e64 6578 203d 207b 6469 6d3a     index = {dim:
+000243d0: 2073 656c 662e 636f 6f72 6473 5b64 696d   self.coords[dim
+000243e0: 5d5b 6964 785d 2066 6f72 2064 696d 2c20  ][idx] for dim, 
+000243f0: 6964 7820 696e 207a 6970 2873 656c 6563  idx in zip(selec
+00024400: 7465 645f 636f 6f72 6473 2c20 6172 7261  ted_coords, arra
+00024410: 7973 297d 0a20 2020 2020 2020 2020 2020  ys)}.           
+00024420: 2020 2020 2063 6f6f 7264 735b 6e65 775f       coords[new_
+00024430: 6469 6d5d 203d 205f 6a6f 696e 5f73 7472  dim] = _join_str
+00024440: 286c 6973 7428 696e 6465 782e 7661 6c75  (list(index.valu
+00024450: 6573 2829 292c 2073 6570 3d22 3a22 290a  es()), sep=":").
+00024460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024470: 6b77 6172 6773 5b6e 6577 5f64 696d 5d20  kwargs[new_dim] 
+00024480: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00024490: 2020 2020 2020 2020 7475 706c 6528 7661          tuple(va
+000244a0: 6c75 6529 3a20 5b73 656c 6563 7465 645f  lue): [selected_
+000244b0: 636f 6f72 6473 2c20 636f 6f72 6473 5b6e  coords, coords[n
+000244c0: 6577 5f64 696d 5d5d 7d0a 2020 2020 2020  ew_dim]]}.      
+000244d0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000244e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000244f0: 6520 4173 7365 7274 696f 6e45 7272 6f72  e AssertionError
+00024500: 2866 2255 6e65 7870 6563 7465 6420 7479  (f"Unexpected ty
+00024510: 7065 3a20 7b74 7970 6528 7661 6c75 6529  pe: {type(value)
+00024520: 7d22 290a 2020 2020 2020 2020 666f 7220  }").        for 
+00024530: 6469 6d20 696e 2073 656c 662e 636f 6f72  dim in self.coor
+00024540: 6473 3a0a 2020 2020 2020 2020 2020 2020  ds:.            
+00024550: 636f 6f72 6473 5b64 696d 5d20 3d20 7365  coords[dim] = se
+00024560: 6c66 2e63 6f6f 7264 735b 6469 6d5d 0a20  lf.coords[dim]. 
+00024570: 2020 2020 2020 206c 6f6e 6720 3d20 7365         long = se
+00024580: 6c66 2e6c 6f6e 672e 696e 7365 7274 282a  lf.long.insert(*
+00024590: 2a6b 7761 7267 7329 0a20 2020 2020 2020  *kwargs).       
+000245a0: 2072 6574 7572 6e20 4172 7261 7928 6461   return Array(da
+000245b0: 7461 3d6c 6f6e 672c 2063 6f6f 7264 733d  ta=long, coords=
+000245c0: 636f 6f72 6473 290a 0a20 2020 2064 6566  coords)..    def
+000245d0: 2061 6464 5f64 696d 2873 656c 662c 202a   add_dim(self, *
+000245e0: 2a6b 7761 7267 733a 2055 6e69 6f6e 5b6e  *kwargs: Union[n
+000245f0: 702e 6474 7970 652c 2074 7970 652c 2073  p.dtype, type, s
+00024600: 7472 2c20 696e 742c 2044 6963 745b 7374  tr, int, Dict[st
+00024610: 722c 2055 6e69 6f6e 5b44 6963 745b 7374  r, Union[Dict[st
+00024620: 722c 2041 6e79 5d2c 204c 6973 745b 556e  r, Any], List[Un
+00024630: 696f 6e5b 4c69 7374 5b73 7472 5d2c 204c  ion[List[str], L
+00024640: 6973 745b 416e 795d 5d5d 5d5d 5d29 202d  ist[Any]]]]]]) -
+00024650: 3e20 2741 7272 6179 273a 0a20 2020 2020  > 'Array':.     
+00024660: 2020 2022 2222 0a20 2020 2020 2020 2041     """.        A
+00024670: 6464 206e 6577 2064 696d 656e 7369 6f6e  dd new dimension
+00024680: 7320 746f 2074 6865 2041 7272 6179 2e0a  s to the Array..
+00024690: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+000246a0: 2020 2020 2020 2020 2020 202a 2a6b 7761             **kwa
+000246b0: 7267 733a 204b 6579 776f 7264 2061 7267  rgs: Keyword arg
+000246c0: 756d 656e 7473 2073 7065 6369 6679 696e  uments specifyin
+000246d0: 6720 7468 6520 6e65 7720 6469 6d65 6e73  g the new dimens
+000246e0: 696f 6e73 2061 6e64 2074 6865 6972 2076  ions and their v
+000246f0: 616c 7565 732e 0a0a 2020 2020 2020 2020  alues...        
+00024700: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+00024710: 2020 2020 2041 206e 6577 2041 7272 6179       A new Array
+00024720: 206f 626a 6563 7420 7769 7468 2074 6865   object with the
+00024730: 2061 6464 6564 2064 696d 656e 7369 6f6e   added dimension
+00024740: 732e 0a0a 2020 2020 2020 2020 4578 616d  s...        Exam
+00024750: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
+00024760: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+00024770: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
+00024780: 7320 3d20 7b27 6469 6d31 273a 205b 2761  s = {'dim1': ['a
+00024790: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
+000247a0: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
+000247b0: 2020 2020 203e 3e3e 206c 6f6e 6720 3d20       >>> long = 
+000247c0: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
+000247d0: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
+000247e0: 2764 696d 3227 3a20 5b31 2c20 325d 7d2c  'dim2': [1, 2]},
+000247f0: 2076 616c 7565 3d5b 3130 2c20 3230 5d29   value=[10, 20])
+00024800: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00024810: 2061 7272 203d 2041 7272 6179 2864 6174   arr = Array(dat
+00024820: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d63  a=long, coords=c
+00024830: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
+00024840: 2020 203e 3e3e 206e 6577 5f61 7272 203d     >>> new_arr =
+00024850: 2061 7272 2e61 6464 5f64 696d 2878 3d30   arr.add_dim(x=0
+00024860: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00024870: 3e20 6e65 775f 6172 720a 2020 2020 2020  > new_arr.      
+00024880: 2020 2020 2020 4172 7261 7928 6461 7461        Array(data
+00024890: 3d61 7272 6179 285b 5b5b 3130 2c20 2030  =array([[[10,  0
+000248a0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+000248b0: 2020 2020 2020 205b 2030 2c20 3230 5d5d         [ 0, 20]]
+000248c0: 5d29 2c20 636f 6f72 6473 3d7b 2778 273a  ]), coords={'x':
+000248d0: 2061 7272 6179 285b 305d 292c 2027 6469   array([0]), 'di
+000248e0: 6d31 273a 2061 7272 6179 285b 2761 272c  m1': array(['a',
+000248f0: 2027 6227 5d2c 2064 7479 7065 3d6f 626a   'b'], dtype=obj
+00024900: 6563 7429 2c20 2764 696d 3227 3a20 6172  ect), 'dim2': ar
+00024910: 7261 7928 5b31 2c20 325d 297d 290a 0a20  ray([1, 2])}).. 
+00024920: 2020 2020 2020 2020 2020 2060 6060 0a20             ```. 
+00024930: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00024940: 2020 2072 6574 7572 6e20 7365 6c66 2e69     return self.i
+00024950: 6e73 6572 7428 2a2a 6b77 6172 6773 290a  nsert(**kwargs).
+00024960: 0a20 2020 2064 6566 2072 656e 616d 6528  .    def rename(
+00024970: 7365 6c66 2c20 2a2a 6b77 6172 6773 3a20  self, **kwargs: 
+00024980: 7374 7229 202d 3e20 2741 7272 6179 273a  str) -> 'Array':
+00024990: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000249a0: 2020 2020 2052 656e 616d 6520 6469 6d65       Rename dime
+000249b0: 6e73 696f 6e73 206f 6620 7468 6520 4172  nsions of the Ar
+000249c0: 7261 792e 0a0a 2020 2020 2020 2020 4172  ray...        Ar
+000249d0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+000249e0: 2a2a 6b77 6172 6773 3a20 4b65 7977 6f72  **kwargs: Keywor
+000249f0: 6420 6172 6775 6d65 6e74 7320 7370 6563  d arguments spec
+00024a00: 6966 7969 6e67 2074 6865 206f 6c64 2064  ifying the old d
+00024a10: 696d 656e 7369 6f6e 206e 616d 6573 2061  imension names a
+00024a20: 6e64 2074 6865 6972 206e 6577 206e 616d  nd their new nam
+00024a30: 6573 2e0a 0a20 2020 2020 2020 2052 6574  es...        Ret
+00024a40: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
+00024a50: 2020 4120 6e65 7720 4172 7261 7920 6f62    A new Array ob
+00024a60: 6a65 6374 2077 6974 6820 7468 6520 7265  ject with the re
+00024a70: 6e61 6d65 6420 6469 6d65 6e73 696f 6e73  named dimensions
+00024a80: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+00024a90: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+00024aa0: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+00024ab0: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
+00024ac0: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
+00024ad0: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
+00024ae0: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
+00024af0: 2020 2020 3e3e 3e20 6c6f 6e67 203d 204c      >>> long = L
+00024b00: 6f6e 6728 696e 6465 783d 7b27 6469 6d31  ong(index={'dim1
+00024b10: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+00024b20: 6469 6d32 273a 205b 312c 2032 5d7d 2c20  dim2': [1, 2]}, 
+00024b30: 7661 6c75 653d 5b31 302c 2032 305d 290a  value=[10, 20]).
+00024b40: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00024b50: 6172 7220 3d20 4172 7261 7928 6461 7461  arr = Array(data
+00024b60: 3d6c 6f6e 672c 2063 6f6f 7264 733d 636f  =long, coords=co
+00024b70: 6f72 6473 290a 2020 2020 2020 2020 2020  ords).          
+00024b80: 2020 3e3e 3e20 6e65 775f 6172 7220 3d20    >>> new_arr = 
+00024b90: 6172 722e 7265 6e61 6d65 2864 696d 313d  arr.rename(dim1=
+00024ba0: 276e 6577 5f64 696d 3127 290a 2020 2020  'new_dim1').    
+00024bb0: 2020 2020 2020 2020 3e3e 3e20 6e65 775f          >>> new_
+00024bc0: 6172 720a 2020 2020 2020 2020 2020 2020  arr.            
+00024bd0: 4172 7261 7928 6461 7461 3d61 7272 6179  Array(data=array
+00024be0: 285b 5b31 302e 2c20 2030 2e5d 2c0a 2020  ([[10.,  0.],.  
+00024bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024c00: 205b 2030 2e2c 2032 302e 5d5d 292c 2063   [ 0., 20.]]), c
+00024c10: 6f6f 7264 733d 7b27 6e65 775f 6469 6d31  oords={'new_dim1
+00024c20: 273a 2061 7272 6179 285b 2761 272c 2027  ': array(['a', '
+00024c30: 6227 5d2c 2064 7479 7065 3d6f 626a 6563  b'], dtype=objec
+00024c40: 7429 2c20 2764 696d 3227 3a20 6172 7261  t), 'dim2': arra
+00024c50: 7928 5b31 2c20 325d 297d 290a 0a20 2020  y([1, 2])})..   
+00024c60: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
+00024c70: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00024c80: 2066 6f72 206f 6c64 6469 6d2c 206e 6577   for olddim, new
+00024c90: 6469 6d20 696e 206b 7761 7267 732e 6974  dim in kwargs.it
+00024ca0: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
+00024cb0: 2020 2061 7373 6572 7420 6f6c 6464 696d     assert olddim
+00024cc0: 2069 6e20 7365 6c66 2e64 696d 732c 2066   in self.dims, f
+00024cd0: 2244 696d 656e 7369 6f6e 207b 6f6c 6464  "Dimension {oldd
+00024ce0: 696d 7d20 6d75 7374 2062 6520 696e 2064  im} must be in d
+00024cf0: 696d 7320 7b73 656c 662e 6469 6d73 7d22  ims {self.dims}"
+00024d00: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+00024d10: 6572 7420 6e65 7764 696d 206e 6f74 2069  ert newdim not i
+00024d20: 6e20 7365 6c66 2e64 696d 732c 2066 2244  n self.dims, f"D
+00024d30: 696d 656e 7369 6f6e 207b 6e65 7764 696d  imension {newdim
+00024d40: 7d20 6d75 7374 206e 6f74 2062 6520 696e  } must not be in
+00024d50: 2064 696d 7320 7b73 656c 662e 6469 6d73   dims {self.dims
+00024d60: 7d22 0a20 2020 2020 2020 2063 6f6f 7264  }".        coord
+00024d70: 7320 3d20 7b7d 0a20 2020 2020 2020 2066  s = {}.        f
+00024d80: 6f72 2064 696d 2c20 656c 656d 7320 696e  or dim, elems in
+00024d90: 2073 656c 662e 636f 6f72 6473 2e69 7465   self.coords.ite
+00024da0: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
+00024db0: 2020 6966 2064 696d 2069 6e20 6b77 6172    if dim in kwar
+00024dc0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00024dd0: 2020 2020 636f 6f72 6473 5b6b 7761 7267      coords[kwarg
+00024de0: 735b 6469 6d5d 5d20 3d20 656c 656d 730a  s[dim]] = elems.
+00024df0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00024e00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00024e10: 2020 636f 6f72 6473 5b64 696d 5d20 3d20    coords[dim] = 
+00024e20: 656c 656d 730a 2020 2020 2020 2020 7265  elems.        re
+00024e30: 7475 726e 2041 7272 6179 2864 6174 613d  turn Array(data=
+00024e40: 7365 6c66 2e64 6174 612c 2063 6f6f 7264  self.data, coord
+00024e50: 733d 636f 6f72 6473 290a 0a20 2020 2064  s=coords)..    d
+00024e60: 6566 2064 726f 7028 7365 6c66 2c20 6469  ef drop(self, di
+00024e70: 6d73 3a20 556e 696f 6e5b 7374 722c 204c  ms: Union[str, L
+00024e80: 6973 745b 7374 725d 5d29 202d 3e20 2741  ist[str]]) -> 'A
+00024e90: 7272 6179 273a 0a20 2020 2020 2020 2022  rray':.        "
+00024ea0: 2222 0a20 2020 2020 2020 2044 726f 7020  "".        Drop 
+00024eb0: 7370 6563 6966 6965 6420 6469 6d65 6e73  specified dimens
+00024ec0: 696f 6e73 2066 726f 6d20 7468 6520 4172  ions from the Ar
+00024ed0: 7261 792e 0a0a 2020 2020 2020 2020 4172  ray...        Ar
+00024ee0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00024ef0: 6469 6d73 3a20 4120 7369 6e67 6c65 2064  dims: A single d
+00024f00: 696d 656e 7369 6f6e 206f 7220 6120 6c69  imension or a li
+00024f10: 7374 206f 6620 6469 6d65 6e73 696f 6e73  st of dimensions
+00024f20: 2074 6f20 6472 6f70 2e0a 0a20 2020 2020   to drop...     
+00024f30: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
+00024f40: 2020 2020 2020 2020 4120 6e65 7720 4172          A new Ar
+00024f50: 7261 7920 6f62 6a65 6374 2077 6974 6820  ray object with 
+00024f60: 7468 6520 7370 6563 6966 6965 6420 6469  the specified di
+00024f70: 6d65 6e73 696f 6e73 2064 726f 7070 6564  mensions dropped
+00024f80: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+00024f90: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+00024fa0: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+00024fb0: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
+00024fc0: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
+00024fd0: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
+00024fe0: 5d7d 0a20 2020 2020 2020 2020 2020 203e  ]}.            >
+00024ff0: 3e3e 206c 6f6e 6720 3d20 4c6f 6e67 2869  >> long = Long(i
+00025000: 6e64 6578 3d7b 2764 696d 3127 3a20 5b27  ndex={'dim1': ['
+00025010: 6127 2c20 2761 275d 2c20 2764 696d 3227  a', 'a'], 'dim2'
+00025020: 3a20 5b31 2c20 325d 7d2c 2076 616c 7565  : [1, 2]}, value
+00025030: 3d5b 3130 2c20 3230 5d29 0a20 2020 2020  =[10, 20]).     
+00025040: 2020 2020 2020 203e 3e3e 2061 7272 203d         >>> arr =
+00025050: 2041 7272 6179 2864 6174 613d 6c6f 6e67   Array(data=long
+00025060: 2c20 636f 6f72 6473 3d63 6f6f 7264 7329  , coords=coords)
+00025070: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00025080: 206e 6577 5f61 7272 203d 2061 7272 2e64   new_arr = arr.d
+00025090: 726f 7028 2764 696d 3127 290a 2020 2020  rop('dim1').    
+000250a0: 2020 2020 2020 2020 3e3e 3e20 6e65 775f          >>> new_
+000250b0: 6172 720a 2020 2020 2020 2020 2020 2020  arr.            
+000250c0: 4172 7261 7928 6461 7461 3d61 7272 6179  Array(data=array
+000250d0: 285b 3130 2c20 3230 5d29 2c20 636f 6f72  ([10, 20]), coor
+000250e0: 6473 3d7b 2764 696d 3227 3a20 6172 7261  ds={'dim2': arra
+000250f0: 7928 5b31 2c20 325d 297d 290a 0a20 2020  y([1, 2])})..   
+00025100: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
+00025110: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00025120: 206c 6f6e 6720 3d20 7365 6c66 2e6c 6f6e   long = self.lon
+00025130: 672e 6472 6f70 2864 696d 733d 6469 6d73  g.drop(dims=dims
+00025140: 290a 2020 2020 2020 2020 636f 6f72 6473  ).        coords
+00025150: 203d 207b 6469 6d3a 2073 656c 662e 636f   = {dim: self.co
+00025160: 6f72 6473 5b64 696d 5d20 666f 7220 6469  ords[dim] for di
+00025170: 6d20 696e 206c 6f6e 672e 6469 6d73 7d0a  m in long.dims}.
+00025180: 2020 2020 2020 2020 7265 7475 726e 2041          return A
+00025190: 7272 6179 2864 6174 613d 6c6f 6e67 2c20  rray(data=long, 
+000251a0: 636f 6f72 6473 3d63 6f6f 7264 7329 0a0a  coords=coords)..
+000251b0: 2020 2020 6465 6620 6472 6f70 6e61 2873      def dropna(s
+000251c0: 656c 6629 202d 3e20 2741 7272 6179 273a  elf) -> 'Array':
+000251d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000251e0: 2020 2020 2044 726f 7020 6d69 7373 696e       Drop missin
+000251f0: 6720 7661 6c75 6573 2028 4e61 4e29 2066  g values (NaN) f
+00025200: 726f 6d20 7468 6520 4172 7261 792e 0a20  rom the Array.. 
+00025210: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00025220: 2020 206c 6f6e 6720 3d20 7365 6c66 2e6c     long = self.l
+00025230: 6f6e 670a 2020 2020 2020 2020 6c6f 6e67  ong.        long
+00025240: 203d 206c 6f6e 675b 6c6f 6e67 2021 3d20   = long[long != 
+00025250: 6e70 2e6e 616e 5d0a 2020 2020 2020 2020  np.nan].        
+00025260: 7265 7475 726e 2041 7272 6179 2864 6174  return Array(dat
+00025270: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d73  a=long, coords=s
+00025280: 656c 662e 636f 6f72 6473 290a 0a20 2020  elf.coords)..   
+00025290: 2064 6566 2064 726f 7069 6e66 2873 656c   def dropinf(sel
+000252a0: 662c 2070 6f73 3a20 626f 6f6c 203d 2046  f, pos: bool = F
+000252b0: 616c 7365 2c20 6e65 673a 2062 6f6f 6c20  alse, neg: bool 
+000252c0: 3d20 4661 6c73 6529 202d 3e20 2741 7272  = False) -> 'Arr
+000252d0: 6179 273a 0a20 2020 2020 2020 2022 2222  ay':.        """
+000252e0: 0a20 2020 2020 2020 2044 726f 7020 696e  .        Drop in
+000252f0: 6669 6e69 7465 2076 616c 7565 7320 2869  finite values (i
+00025300: 6e66 206f 7220 2d69 6e66 2920 6672 6f6d  nf or -inf) from
+00025310: 2074 6865 2041 7272 6179 2e0a 0a20 2020   the Array...   
+00025320: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
+00025330: 2020 2020 2020 2070 6f73 3a20 5768 6574         pos: Whet
+00025340: 6865 7220 746f 2064 726f 7020 706f 7369  her to drop posi
+00025350: 7469 7665 2069 6e66 696e 6974 7920 7661  tive infinity va
+00025360: 6c75 6573 2e0a 2020 2020 2020 2020 2020  lues..          
+00025370: 2020 6e65 673a 2057 6865 7468 6572 2074    neg: Whether t
+00025380: 6f20 6472 6f70 206e 6567 6174 6976 6520  o drop negative 
+00025390: 696e 6669 6e69 7479 2076 616c 7565 732e  infinity values.
+000253a0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+000253b0: 733a 0a20 2020 2020 2020 2020 2020 2041  s:.            A
+000253c0: 206e 6577 2041 7272 6179 206f 626a 6563   new Array objec
+000253d0: 7420 7769 7468 2069 6e66 696e 6974 6520  t with infinite 
+000253e0: 7661 6c75 6573 2072 656d 6f76 6564 2e0a  values removed..
+000253f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00025400: 2020 2020 6173 7365 7274 2061 6e79 285b      assert any([
+00025410: 706f 732c 206e 6567 5d29 2c20 2270 6f73  pos, neg]), "pos
+00025420: 2061 6e64 206e 6567 2063 616e 6e6f 7420   and neg cannot 
+00025430: 6265 2062 6f74 6820 4661 6c73 6522 0a20  be both False". 
+00025440: 2020 2020 2020 206c 6f6e 6720 3d20 7365         long = se
+00025450: 6c66 2e6c 6f6e 670a 2020 2020 2020 2020  lf.long.        
+00025460: 6966 2070 6f73 3a0a 2020 2020 2020 2020  if pos:.        
+00025470: 2020 2020 6c6f 6e67 203d 206c 6f6e 675b      long = long[
+00025480: 6c6f 6e67 2021 3d20 6e70 2e69 6e66 5d0a  long != np.inf].
+00025490: 2020 2020 2020 2020 6966 206e 6567 3a0a          if neg:.
+000254a0: 2020 2020 2020 2020 2020 2020 6c6f 6e67              long
+000254b0: 203d 206c 6f6e 675b 6c6f 6e67 2021 3d20   = long[long != 
+000254c0: 2d6e 702e 696e 665d 0a20 2020 2020 2020  -np.inf].       
+000254d0: 2072 6574 7572 6e20 4172 7261 7928 6461   return Array(da
+000254e0: 7461 3d6c 6f6e 672c 2063 6f6f 7264 733d  ta=long, coords=
+000254f0: 7365 6c66 2e63 6f6f 7264 7329 0a0a 2020  self.coords)..  
+00025500: 2020 6465 6620 726f 756e 6428 7365 6c66    def round(self
+00025510: 2c20 6465 6369 6d61 6c73 3a20 696e 7429  , decimals: int)
+00025520: 202d 3e20 2741 7272 6179 273a 0a20 2020   -> 'Array':.   
+00025530: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00025540: 2052 6f75 6e64 2074 6865 2076 616c 7565   Round the value
+00025550: 7320 696e 2074 6865 2041 7272 6179 2074  s in the Array t
+00025560: 6f20 7468 6520 7370 6563 6966 6965 6420  o the specified 
+00025570: 6e75 6d62 6572 206f 6620 6465 6369 6d61  number of decima
+00025580: 6c20 706c 6163 6573 2e0a 0a20 2020 2020  l places...     
+00025590: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+000255a0: 2020 2020 2064 6563 696d 616c 733a 2054       decimals: T
+000255b0: 6865 206e 756d 6265 7220 6f66 2064 6563  he number of dec
+000255c0: 696d 616c 2070 6c61 6365 7320 746f 2072  imal places to r
+000255d0: 6f75 6e64 2074 6f2e 0a0a 2020 2020 2020  ound to...      
+000255e0: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+000255f0: 2020 2020 2020 2041 206e 6577 2041 7272         A new Arr
+00025600: 6179 206f 626a 6563 7420 7769 7468 2074  ay object with t
+00025610: 6865 2072 6f75 6e64 6564 2076 616c 7565  he rounded value
+00025620: 732e 0a0a 2020 2020 2020 2020 4578 616d  s...        Exam
+00025630: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
+00025640: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+00025650: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
+00025660: 7320 3d20 7b27 6469 6d31 273a 205b 2761  s = {'dim1': ['a
+00025670: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
+00025680: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
+00025690: 2020 2020 203e 3e3e 206c 6f6e 675f 7769       >>> long_wi
+000256a0: 7468 5f64 6563 696d 616c 7320 3d20 4c6f  th_decimals = Lo
+000256b0: 6e67 2869 6e64 6578 3d7b 2764 696d 3127  ng(index={'dim1'
+000256c0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+000256d0: 696d 3227 3a20 5b31 2c20 325d 7d2c 2076  im2': [1, 2]}, v
+000256e0: 616c 7565 3d5b 3130 2e31 3233 2c20 3230  alue=[10.123, 20
+000256f0: 2e34 3536 5d29 0a20 2020 2020 2020 2020  .456]).         
+00025700: 2020 203e 3e3e 2061 7272 5f77 6974 685f     >>> arr_with_
+00025710: 6465 6369 6d61 6c73 203d 2041 7272 6179  decimals = Array
+00025720: 2864 6174 613d 6c6f 6e67 5f77 6974 685f  (data=long_with_
+00025730: 6465 6369 6d61 6c73 2c20 636f 6f72 6473  decimals, coords
+00025740: 3d63 6f6f 7264 7329 0a20 2020 2020 2020  =coords).       
+00025750: 2020 2020 203e 3e3e 2072 6f75 6e64 6564       >>> rounded
+00025760: 5f61 7272 203d 2061 7272 5f77 6974 685f  _arr = arr_with_
+00025770: 6465 6369 6d61 6c73 2e72 6f75 6e64 2864  decimals.round(d
+00025780: 6563 696d 616c 733d 3129 0a20 2020 2020  ecimals=1).     
+00025790: 2020 2020 2020 203e 3e3e 2072 6f75 6e64         >>> round
+000257a0: 6564 5f61 7272 0a20 2020 2020 2020 2020  ed_arr.         
+000257b0: 2020 2041 7272 6179 2864 6174 613d 6172     Array(data=ar
+000257c0: 7261 7928 5b5b 3130 2e31 2c20 2030 2e20  ray([[10.1,  0. 
+000257d0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+000257e0: 2020 2020 2020 5b20 302e 202c 2032 302e        [ 0. , 20.
+000257f0: 355d 5d29 2c20 636f 6f72 6473 3d7b 2764  5]]), coords={'d
+00025800: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
+00025810: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
+00025820: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
+00025830: 7272 6179 285b 312c 2032 5d29 7d29 0a0a  rray([1, 2])})..
+00025840: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
+00025850: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00025860: 2020 2020 6e64 6172 7261 7920 3d20 7365      ndarray = se
+00025870: 6c66 2e64 6174 612e 726f 756e 6428 6465  lf.data.round(de
+00025880: 6369 6d61 6c73 3d64 6563 696d 616c 7329  cimals=decimals)
+00025890: 0a20 2020 2020 2020 2063 6f6f 7264 7320  .        coords 
+000258a0: 3d20 7365 6c66 2e63 6f6f 7264 730a 2020  = self.coords.  
+000258b0: 2020 2020 2020 7265 7475 726e 2041 7272        return Arr
+000258c0: 6179 2864 6174 613d 6e64 6172 7261 792c  ay(data=ndarray,
+000258d0: 2063 6f6f 7264 733d 636f 6f72 6473 290a   coords=coords).
+000258e0: 0a20 2020 2064 6566 2065 6c65 6d73 5f74  .    def elems_t
+000258f0: 6f5f 6461 7465 7469 6d65 2873 656c 662c  o_datetime(self,
+00025900: 206e 6577 5f64 696d 3a20 7374 722c 2061   new_dim: str, a
+00025910: 6374 7561 6c5f 6469 6d3a 2073 7472 2c20  ctual_dim: str, 
+00025920: 7265 6665 7265 6e63 655f 6461 7465 3a20  reference_date: 
+00025930: 7374 722c 2066 7265 713a 2073 7472 2c20  str, freq: str, 
+00025940: 736f 7274 5f63 6f6f 7264 733a 2062 6f6f  sort_coords: boo
+00025950: 6c20 3d20 5472 7565 2920 2d3e 2027 4172  l = True) -> 'Ar
+00025960: 7261 7927 3a0a 2020 2020 2020 2020 2222  ray':.        ""
+00025970: 220a 2020 2020 2020 2020 436f 6e76 6572  ".        Conver
+00025980: 7420 656c 656d 656e 7473 206f 6620 6120  t elements of a 
+00025990: 6469 6d65 6e73 696f 6e20 746f 2064 6174  dimension to dat
+000259a0: 6574 696d 6520 7661 6c75 6573 2061 6e64  etime values and
+000259b0: 2063 7265 6174 6520 6120 6e65 7720 6469   create a new di
+000259c0: 6d65 6e73 696f 6e2e 0a0a 2020 2020 2020  mension...      
+000259d0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+000259e0: 2020 2020 6e65 775f 6469 6d3a 2054 6865      new_dim: The
+000259f0: 206e 616d 6520 6f66 2074 6865 206e 6577   name of the new
+00025a00: 2064 696d 656e 7369 6f6e 2074 6f20 6372   dimension to cr
+00025a10: 6561 7465 2e0a 2020 2020 2020 2020 2020  eate..          
+00025a20: 2020 6163 7475 616c 5f64 696d 3a20 5468    actual_dim: Th
+00025a30: 6520 6e61 6d65 206f 6620 7468 6520 6578  e name of the ex
+00025a40: 6973 7469 6e67 2064 696d 656e 7369 6f6e  isting dimension
+00025a50: 2074 6f20 636f 6e76 6572 742e 0a20 2020   to convert..   
+00025a60: 2020 2020 2020 2020 2072 6566 6572 656e           referen
+00025a70: 6365 5f64 6174 653a 2054 6865 2072 6566  ce_date: The ref
+00025a80: 6572 656e 6365 2064 6174 6520 746f 2073  erence date to s
+00025a90: 7461 7274 2074 6865 2064 6174 6574 696d  tart the datetim
+00025aa0: 6520 7261 6e67 6520 6672 6f6d 2e0a 2020  e range from..  
+00025ab0: 2020 2020 2020 2020 2020 6672 6571 3a20            freq: 
+00025ac0: 5468 6520 6672 6571 7565 6e63 7920 6f66  The frequency of
+00025ad0: 2074 6865 2064 6174 6574 696d 6520 7261   the datetime ra
+00025ae0: 6e67 652e 0a20 2020 2020 2020 2020 2020  nge..           
+00025af0: 2073 6f72 745f 636f 6f72 6473 3a20 5768   sort_coords: Wh
+00025b00: 6574 6865 7220 746f 2073 6f72 7420 7468  ether to sort th
+00025b10: 6520 636f 6f72 6469 6e61 7465 7320 6f66  e coordinates of
+00025b20: 2074 6865 2061 6374 7561 6c20 6469 6d65   the actual dime
+00025b30: 6e73 696f 6e2e 0a0a 2020 2020 2020 2020  nsion...        
+00025b40: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+00025b50: 2020 2020 2041 206e 6577 2041 7272 6179       A new Array
+00025b60: 206f 626a 6563 7420 7769 7468 2074 6865   object with the
+00025b70: 2064 6174 6574 696d 6520 6469 6d65 6e73   datetime dimens
+00025b80: 696f 6e20 6164 6465 642e 0a0a 2020 2020  ion added...    
+00025b90: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+00025ba0: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+00025bb0: 6f6e 0a20 2020 2020 2020 2020 2020 203e  on.            >
+00025bc0: 3e3e 2063 6f6f 7264 7320 3d20 7b27 6469  >> coords = {'di
+00025bd0: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+00025be0: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+00025bf0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00025c00: 206c 6f6e 6720 3d20 4c6f 6e67 2869 6e64   long = Long(ind
+00025c10: 6578 3d7b 2764 696d 3127 3a20 5b27 6127  ex={'dim1': ['a'
+00025c20: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
+00025c30: 5b31 2c20 325d 7d2c 2076 616c 7565 3d5b  [1, 2]}, value=[
+00025c40: 3130 2c20 3230 5d29 0a20 2020 2020 2020  10, 20]).       
+00025c50: 2020 2020 203e 3e3e 2061 7272 203d 2041       >>> arr = A
+00025c60: 7272 6179 2864 6174 613d 6c6f 6e67 2c20  rray(data=long, 
+00025c70: 636f 6f72 6473 3d63 6f6f 7264 7329 0a20  coords=coords). 
+00025c80: 2020 2020 2020 2020 2020 203e 3e3e 206e             >>> n
+00025c90: 6577 5f61 7272 203d 2061 7272 2e65 6c65  ew_arr = arr.ele
+00025ca0: 6d73 5f74 6f5f 6461 7465 7469 6d65 286e  ms_to_datetime(n
+00025cb0: 6577 5f64 696d 3d27 6461 7465 272c 2061  ew_dim='date', a
+00025cc0: 6374 7561 6c5f 6469 6d3d 2764 696d 3227  ctual_dim='dim2'
+00025cd0: 2c20 7265 6665 7265 6e63 655f 6461 7465  , reference_date
+00025ce0: 3d27 3230 3232 2d30 312d 3031 272c 2066  ='2022-01-01', f
+00025cf0: 7265 713d 2744 2729 0a20 2020 2020 2020  req='D').       
+00025d00: 2020 2020 203e 3e3e 206e 6577 5f61 7272       >>> new_arr
+00025d10: 0a20 2020 2020 2020 2020 2020 2041 7272  .            Arr
+00025d20: 6179 2864 6174 613d 6172 7261 7928 5b5b  ay(data=array([[
+00025d30: 5b31 302c 2020 305d 2c0a 2020 2020 2020  [10,  0],.      
+00025d40: 2020 2020 2020 2020 2020 2020 2020 5b20                [ 
+00025d50: 302c 2020 305d 5d2c 0a20 2020 2020 2020  0,  0]],.       
+00025d60: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+00025d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025d80: 2020 2020 5b5b 2030 2c20 2030 5d2c 0a20      [[ 0,  0],. 
+00025d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025da0: 2020 205b 2030 2c20 3230 5d5d 5d29 2c20     [ 0, 20]]]), 
+00025db0: 636f 6f72 6473 3d7b 2764 6174 6527 3a20  coords={'date': 
+00025dc0: 6172 7261 7928 5b27 3230 3232 2d30 312d  array(['2022-01-
+00025dd0: 3031 5430 303a 3030 3a30 302e 3030 3030  01T00:00:00.0000
+00025de0: 3030 3030 3027 2c20 2732 3032 322d 3031  00000', '2022-01
+00025df0: 2d30 3254 3030 3a30 303a 3030 2e30 3030  -02T00:00:00.000
+00025e00: 3030 3030 3030 275d 2c0a 2020 2020 2020  000000'],.      
+00025e10: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+00025e20: 653d 2764 6174 6574 696d 6536 345b 6e73  e='datetime64[ns
+00025e30: 5d27 292c 2027 6469 6d31 273a 2061 7272  ]'), 'dim1': arr
+00025e40: 6179 285b 2761 272c 2027 6227 5d2c 2064  ay(['a', 'b'], d
+00025e50: 7479 7065 3d6f 626a 6563 7429 2c20 2764  type=object), 'd
+00025e60: 696d 3227 3a20 6172 7261 7928 5b31 2c20  im2': array([1, 
+00025e70: 325d 297d 290a 0a20 2020 2020 2020 2020  2])})..         
+00025e80: 2020 2060 6060 0a20 2020 2020 2020 2022     ```.        "
+00025e90: 2222 0a20 2020 2020 2020 2061 7373 6572  "".        asser
+00025ea0: 7420 6163 7475 616c 5f64 696d 2069 6e20  t actual_dim in 
+00025eb0: 7365 6c66 2e64 696d 730a 2020 2020 2020  self.dims.      
+00025ec0: 2020 7374 6172 745f 6461 7465 203d 2070    start_date = p
+00025ed0: 642e 746f 5f64 6174 6574 696d 6528 7265  d.to_datetime(re
+00025ee0: 6665 7265 6e63 655f 6461 7465 290a 2020  ference_date).  
+00025ef0: 2020 2020 2020 7420 3d20 7064 2e64 6174        t = pd.dat
+00025f00: 655f 7261 6e67 6528 7374 6172 743d 7374  e_range(start=st
+00025f10: 6172 745f 6461 7465 2c20 7065 7269 6f64  art_date, period
+00025f20: 733d 7365 6c66 2e63 6f6f 7264 735b 6163  s=self.coords[ac
+00025f30: 7475 616c 5f64 696d 5d2e 7369 7a65 2c20  tual_dim].size, 
+00025f40: 6672 6571 3d66 7265 7129 0a20 2020 2020  freq=freq).     
+00025f50: 2020 2069 6620 736f 7274 5f63 6f6f 7264     if sort_coord
+00025f60: 733a 0a20 2020 2020 2020 2020 2020 206e  s:.            n
+00025f70: 6577 5f61 7272 6179 203d 2073 656c 662e  ew_array = self.
+00025f80: 696e 7365 7274 282a 2a7b 6e65 775f 6469  insert(**{new_di
+00025f90: 6d3a 207b 6163 7475 616c 5f64 696d 3a20  m: {actual_dim: 
+00025fa0: 5b6e 702e 736f 7274 2873 656c 662e 636f  [np.sort(self.co
+00025fb0: 6f72 6473 5b61 6374 7561 6c5f 6469 6d5d  ords[actual_dim]
+00025fc0: 292c 2074 5d7d 7d29 0a20 2020 2020 2020  ), t]}}).       
+00025fd0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00025fe0: 2020 206e 6577 5f61 7272 6179 203d 2073     new_array = s
+00025ff0: 656c 662e 696e 7365 7274 282a 2a7b 6e65  elf.insert(**{ne
+00026000: 775f 6469 6d3a 207b 6163 7475 616c 5f64  w_dim: {actual_d
+00026010: 696d 3a20 5b73 656c 662e 636f 6f72 6473  im: [self.coords
+00026020: 5b61 6374 7561 6c5f 6469 6d5d 2c20 745d  [actual_dim], t]
+00026030: 7d7d 290a 2020 2020 2020 2020 7265 7475  }}).        retu
+00026040: 726e 206e 6577 5f61 7272 6179 0a0a 2020  rn new_array..  
+00026050: 2020 6465 6620 656c 656d 735f 746f 5f69    def elems_to_i
+00026060: 6e74 2873 656c 662c 206e 6577 5f64 696d  nt(self, new_dim
+00026070: 3a20 7374 722c 2061 6374 7561 6c5f 6469  : str, actual_di
+00026080: 6d3a 2073 7472 2920 2d3e 2027 4172 7261  m: str) -> 'Arra
+00026090: 7927 3a0a 2020 2020 2020 2020 2222 220a  y':.        """.
+000260a0: 2020 2020 2020 2020 436f 6e76 6572 7420          Convert 
+000260b0: 656c 656d 656e 7473 206f 6620 6120 6469  elements of a di
+000260c0: 6d65 6e73 696f 6e20 746f 2069 6e74 6567  mension to integ
+000260d0: 6572 2076 616c 7565 7320 616e 6420 6372  er values and cr
+000260e0: 6561 7465 2061 206e 6577 2064 696d 656e  eate a new dimen
+000260f0: 7369 6f6e 2e0a 0a20 2020 2020 2020 2041  sion...        A
+00026100: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+00026110: 206e 6577 5f64 696d 3a20 5468 6520 6e61   new_dim: The na
+00026120: 6d65 206f 6620 7468 6520 6e65 7720 6469  me of the new di
+00026130: 6d65 6e73 696f 6e20 746f 2063 7265 6174  mension to creat
+00026140: 652e 0a20 2020 2020 2020 2020 2020 2061  e..            a
+00026150: 6374 7561 6c5f 6469 6d3a 2054 6865 206e  ctual_dim: The n
+00026160: 616d 6520 6f66 2074 6865 2065 7869 7374  ame of the exist
+00026170: 696e 6720 6469 6d65 6e73 696f 6e20 746f  ing dimension to
+00026180: 2063 6f6e 7665 7274 2e0a 0a20 2020 2020   convert...     
+00026190: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
+000261a0: 2020 2020 2020 2020 4120 6e65 7720 4172          A new Ar
+000261b0: 7261 7920 6f62 6a65 6374 2077 6974 6820  ray object with 
+000261c0: 7468 6520 696e 7465 6765 7220 6469 6d65  the integer dime
+000261d0: 6e73 696f 6e20 6164 6465 642e 0a0a 2020  nsion added...  
+000261e0: 2020 2020 2020 4578 616d 706c 653a 0a20        Example:. 
+000261f0: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
+00026200: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
+00026210: 203e 3e3e 206c 6f6e 6720 3d20 4c6f 6e67   >>> long = Long
+00026220: 2869 6e64 6578 3d7b 2764 696d 3127 3a20  (index={'dim1': 
+00026230: 5b27 6127 2c20 2762 275d 2c20 2764 696d  ['a', 'b'], 'dim
+00026240: 3227 3a20 5b27 3127 2c20 2732 275d 7d2c  2': ['1', '2']},
+00026250: 2076 616c 7565 3d5b 3130 2c20 3230 5d29   value=[10, 20])
+00026260: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00026270: 2061 7272 203d 2041 7272 6179 2864 6174   arr = Array(dat
+00026280: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d7b  a=long, coords={
+00026290: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
+000262a0: 275d 2c20 2764 696d 3227 3a20 5b27 3127  '], 'dim2': ['1'
+000262b0: 2c20 2732 275d 7d29 0a20 2020 2020 2020  , '2']}).       
+000262c0: 2020 2020 203e 3e3e 206e 6577 5f61 7272       >>> new_arr
+000262d0: 203d 2061 7272 2e65 6c65 6d73 5f74 6f5f   = arr.elems_to_
+000262e0: 696e 7428 6e65 775f 6469 6d3d 2769 6e74  int(new_dim='int
+000262f0: 5f64 696d 272c 2061 6374 7561 6c5f 6469  _dim', actual_di
+00026300: 6d3d 2764 696d 3227 290a 2020 2020 2020  m='dim2').      
+00026310: 2020 2020 2020 3e3e 3e20 6e65 775f 6172        >>> new_ar
+00026320: 720a 2020 2020 2020 2020 2020 2020 4172  r.            Ar
+00026330: 7261 7928 6461 7461 3d61 7272 6179 285b  ray(data=array([
+00026340: 5b5b 3130 2c20 2030 5d2c 0a20 2020 2020  [[10,  0],.     
+00026350: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00026360: 2030 2c20 2030 5d5d 2c0a 2020 2020 2020   0,  0]],.      
+00026370: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+00026380: 3e0a 2020 2020 2020 2020 2020 2020 2020  >.              
+00026390: 2020 2020 205b 5b20 302c 2020 305d 2c0a       [[ 0,  0],.
+000263a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000263b0: 2020 2020 5b20 302c 2032 305d 5d5d 292c      [ 0, 20]]]),
+000263c0: 2063 6f6f 7264 733d 7b27 696e 745f 6469   coords={'int_di
+000263d0: 6d27 3a20 6172 7261 7928 5b31 2c20 325d  m': array([1, 2]
+000263e0: 292c 2027 6469 6d31 273a 2061 7272 6179  ), 'dim1': array
+000263f0: 285b 2761 272c 2027 6227 5d2c 2064 7479  (['a', 'b'], dty
+00026400: 7065 3d6f 626a 6563 7429 2c20 2764 696d  pe=object), 'dim
+00026410: 3227 3a20 6172 7261 7928 5b27 3127 2c20  2': array(['1', 
+00026420: 2732 275d 2c20 6474 7970 653d 6f62 6a65  '2'], dtype=obje
+00026430: 6374 297d 290a 0a20 2020 2020 2020 2020  ct)})..         
+00026440: 2020 2060 6060 0a20 2020 2020 2020 2022     ```.        "
+00026450: 2222 0a20 2020 2020 2020 2073 6572 6965  "".        serie
+00026460: 203d 2070 642e 5365 7269 6573 2864 6174   = pd.Series(dat
+00026470: 613d 7365 6c66 2e63 6f6f 7264 735b 6163  a=self.coords[ac
+00026480: 7475 616c 5f64 696d 5d29 0a20 2020 2020  tual_dim]).     
+00026490: 2020 2073 6572 6965 203d 2073 6572 6965     serie = serie
+000264a0: 2e73 7472 2e65 7874 7261 6374 2872 2228  .str.extract(r"(
+000264b0: 5c64 2b29 222c 2065 7870 616e 643d 4661  \d+)", expand=Fa
+000264c0: 6c73 6529 2e61 7374 7970 6528 2269 6e74  lse).astype("int
+000264d0: 2229 0a20 2020 2020 2020 206e 6577 5f61  ").        new_a
+000264e0: 7272 6179 203d 2073 656c 662e 696e 7365  rray = self.inse
+000264f0: 7274 282a 2a7b 6e65 775f 6469 6d3a 207b  rt(**{new_dim: {
+00026500: 6163 7475 616c 5f64 696d 3a20 5b73 656c  actual_dim: [sel
+00026510: 662e 636f 6f72 6473 5b61 6374 7561 6c5f  f.coords[actual_
+00026520: 6469 6d5d 2c20 7365 7269 652e 7661 6c75  dim], serie.valu
+00026530: 6573 5d7d 7d29 0a20 2020 2020 2020 2072  es]}}).        r
+00026540: 6574 7572 6e20 6e65 775f 6172 7261 790a  eturn new_array.
+00026550: 0a20 2020 2064 6566 2065 6d70 7479 2873  .    def empty(s
+00026560: 656c 6629 202d 3e20 2741 7272 6179 273a  elf) -> 'Array':
+00026570: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00026580: 2020 2020 2043 7265 6174 6520 616e 2065       Create an e
+00026590: 6d70 7479 2041 7272 6179 2077 6974 6820  mpty Array with 
+000265a0: 7468 6520 7361 6d65 2064 696d 656e 7369  the same dimensi
+000265b0: 6f6e 7320 616e 6420 636f 6f72 6469 6e61  ons and coordina
+000265c0: 7465 7320 6173 2074 6865 206f 7269 6769  tes as the origi
+000265d0: 6e61 6c20 4172 7261 792e 0a0a 2020 2020  nal Array...    
+000265e0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+000265f0: 2020 2020 2020 2020 2041 206e 6577 2065           A new e
+00026600: 6d70 7479 2041 7272 6179 206f 626a 6563  mpty Array objec
+00026610: 742e 0a0a 2020 2020 2020 2020 4578 616d  t...        Exam
+00026620: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
+00026630: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+00026640: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
+00026650: 7320 3d20 7b27 6469 6d31 273a 205b 2761  s = {'dim1': ['a
+00026660: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
+00026670: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
+00026680: 2020 2020 203e 3e3e 206c 6f6e 6720 3d20       >>> long = 
+00026690: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
+000266a0: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
+000266b0: 2764 696d 3227 3a20 5b31 2c20 325d 7d2c  'dim2': [1, 2]},
+000266c0: 2076 616c 7565 3d5b 3130 2c20 3230 5d29   value=[10, 20])
+000266d0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+000266e0: 2061 7272 203d 2041 7272 6179 2864 6174   arr = Array(dat
+000266f0: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d63  a=long, coords=c
+00026700: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
+00026710: 2020 203e 3e3e 2065 6d70 7479 5f61 7272     >>> empty_arr
+00026720: 203d 2061 7272 2e65 6d70 7479 2829 0a20   = arr.empty(). 
+00026730: 2020 2020 2020 2020 2020 203e 3e3e 2065             >>> e
+00026740: 6d70 7479 5f61 7272 0a20 2020 2020 2020  mpty_arr.       
+00026750: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
+00026760: 6172 7261 7928 5b5b 302c 2030 5d2c 0a20  array([[0, 0],. 
+00026770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026780: 2020 5b30 2c20 305d 5d29 2c20 636f 6f72    [0, 0]]), coor
+00026790: 6473 3d7b 2764 696d 3127 3a20 6172 7261  ds={'dim1': arra
+000267a0: 7928 5b27 6127 2c20 2762 275d 2c20 6474  y(['a', 'b'], dt
+000267b0: 7970 653d 6f62 6a65 6374 292c 2027 6469  ype=object), 'di
+000267c0: 6d32 273a 2061 7272 6179 285b 312c 2032  m2': array([1, 2
+000267d0: 5d29 7d29 0a0a 2020 2020 2020 2020 2020  ])})..          
+000267e0: 2020 6060 600a 2020 2020 2020 2020 2222    ```.        ""
+000267f0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00026800: 2041 7272 6179 2864 6174 613d 287b 6469   Array(data=({di
+00026810: 6d3a 205b 5d20 666f 7220 6469 6d20 696e  m: [] for dim in
+00026820: 2073 656c 662e 6469 6d73 7d2c 206e 702e   self.dims}, np.
+00026830: 6172 7261 7928 5b5d 2c20 6474 7970 653d  array([], dtype=
+00026840: 7365 6c66 2e64 6174 612e 6474 7970 6529  self.data.dtype)
+00026850: 292c 2063 6f6f 7264 733d 7365 6c66 2e63  ), coords=self.c
+00026860: 6f6f 7264 7329 0a0a 2020 2020 6465 6620  oords)..    def 
+00026870: 6368 6f69 6365 2873 656c 662c 2064 696d  choice(self, dim
+00026880: 3a20 7374 722c 2073 6565 643a 2069 6e74  : str, seed: int
+00026890: 203d 2031 2920 2d3e 2027 4172 7261 7927   = 1) -> 'Array'
+000268a0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000268b0: 2020 2020 2020 5261 6e64 6f6d 6c79 2063        Randomly c
+000268c0: 686f 6f73 6520 656c 656d 656e 7473 2061  hoose elements a
+000268d0: 6c6f 6e67 2061 2073 7065 6369 6669 6564  long a specified
+000268e0: 2064 696d 656e 7369 6f6e 2062 6173 6564   dimension based
+000268f0: 206f 6e20 7468 6520 4172 7261 7920 7661   on the Array va
+00026900: 6c75 6573 2061 7320 7072 6f62 6162 696c  lues as probabil
+00026910: 6974 6965 732e 0a0a 2020 2020 2020 2020  ities...        
+00026920: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+00026930: 2020 6469 6d3a 2054 6865 2064 696d 656e    dim: The dimen
+00026940: 7369 6f6e 2074 6f20 7065 7266 6f72 6d20  sion to perform 
+00026950: 7468 6520 6368 6f69 6365 2061 6c6f 6e67  the choice along
+00026960: 2e0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00026970: 6564 3a20 5468 6520 7261 6e64 6f6d 2073  ed: The random s
+00026980: 6565 6420 746f 2075 7365 2066 6f72 2072  eed to use for r
+00026990: 6570 726f 6475 6369 6269 6c69 7479 2e0a  eproducibility..
+000269a0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+000269b0: 3a0a 2020 2020 2020 2020 2020 2020 4120  :.            A 
+000269c0: 6e65 7720 4172 7261 7920 6f62 6a65 6374  new Array object
+000269d0: 2077 6974 6820 7468 6520 6368 6f73 656e   with the chosen
+000269e0: 2065 6c65 6d65 6e74 732e 0a0a 2020 2020   elements...    
+000269f0: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+00026a00: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+00026a10: 6f6e 0a20 2020 2020 2020 2020 2020 203e  on.            >
+00026a20: 3e3e 2063 6f6f 7264 7320 3d20 7b27 6469  >> coords = {'di
+00026a30: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+00026a40: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+00026a50: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00026a60: 206c 6f6e 6720 3d20 4c6f 6e67 2869 6e64   long = Long(ind
+00026a70: 6578 3d7b 2764 696d 3127 3a20 5b27 6127  ex={'dim1': ['a'
+00026a80: 2c20 2761 272c 2027 6227 2c20 2762 275d  , 'a', 'b', 'b']
+00026a90: 2c20 2764 696d 3227 3a20 5b31 2c20 322c  , 'dim2': [1, 2,
+00026aa0: 2031 2c20 325d 7d2c 2076 616c 7565 3d5b   1, 2]}, value=[
+00026ab0: 302e 332c 2030 2e34 2c20 302e 372c 2030  0.3, 0.4, 0.7, 0
+00026ac0: 2e36 5d29 0a20 2020 2020 2020 2020 2020  .6]).           
+00026ad0: 203e 3e3e 2061 7272 203d 2041 7272 6179   >>> arr = Array
+00026ae0: 2864 6174 613d 6c6f 6e67 2c20 636f 6f72  (data=long, coor
+00026af0: 6473 3d63 6f6f 7264 7329 0a20 2020 2020  ds=coords).     
+00026b00: 2020 2020 2020 203e 3e3e 2063 686f 7365         >>> chose
+00026b10: 6e5f 6172 7220 3d20 6172 722e 6368 6f69  n_arr = arr.choi
+00026b20: 6365 2864 696d 3d27 6469 6d31 272c 2073  ce(dim='dim1', s
+00026b30: 6565 643d 3432 290a 2020 2020 2020 2020  eed=42).        
+00026b40: 2020 2020 3e3e 3e20 6368 6f73 656e 5f61      >>> chosen_a
+00026b50: 7272 0a20 2020 2020 2020 2020 2020 2041  rr.            A
+00026b60: 7272 6179 2864 6174 613d 6172 7261 7928  rray(data=array(
+00026b70: 5b5b 4661 6c73 652c 2046 616c 7365 5d2c  [[False, False],
+00026b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026b90: 2020 2020 5b20 5472 7565 2c20 2054 7275      [ True,  Tru
+00026ba0: 655d 5d29 2c20 636f 6f72 6473 3d7b 2764  e]]), coords={'d
+00026bb0: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
+00026bc0: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
+00026bd0: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
+00026be0: 7272 6179 285b 312c 2032 5d29 7d29 0a0a  rray([1, 2])})..
+00026bf0: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
+00026c00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00026c10: 2020 2020 726e 6720 3d20 6e70 2e72 616e      rng = np.ran
+00026c20: 646f 6d2e 6465 6661 756c 745f 726e 6728  dom.default_rng(
+00026c30: 7365 6564 3d73 6565 6429 0a20 2020 2020  seed=seed).     
+00026c40: 2020 2061 7373 6572 7420 6469 6d20 696e     assert dim in
+00026c50: 2073 656c 662e 6469 6d73 2c20 6622 6469   self.dims, f"di
+00026c60: 6d20 7b64 696d 7d20 6e6f 7420 696e 2073  m {dim} not in s
+00026c70: 656c 662e 6469 6d73 3a20 7b73 656c 662e  elf.dims: {self.
+00026c80: 6469 6d73 7d22 0a20 2020 2020 2020 2061  dims}".        a
+00026c90: 7869 7320 3d20 7365 6c66 2e64 696d 732e  xis = self.dims.
+00026ca0: 696e 6465 7828 6469 6d29 0a20 2020 2020  index(dim).     
+00026cb0: 2020 2070 726f 6261 6269 6c69 7469 6573     probabilities
+00026cc0: 203d 2073 656c 662e 6461 7461 0a20 2020   = self.data.   
+00026cd0: 2020 2020 206d 6173 6b20 3d20 6e64 6172       mask = ndar
+00026ce0: 7261 795f 6368 6f69 6365 2870 3d70 726f  ray_choice(p=pro
+00026cf0: 6261 6269 6c69 7469 6573 2c20 6178 6973  babilities, axis
+00026d00: 3d61 7869 732c 2072 6e67 3d72 6e67 290a  =axis, rng=rng).
+00026d10: 2020 2020 2020 2020 6173 7365 7274 206d          assert m
+00026d20: 6173 6b2e 7368 6170 6520 3d3d 2070 726f  ask.shape == pro
+00026d30: 6261 6269 6c69 7469 6573 2e73 6861 7065  babilities.shape
+00026d40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00026d50: 4172 7261 7928 6461 7461 3d6d 6173 6b2c  Array(data=mask,
+00026d60: 2063 6f6f 7264 733d 7365 6c66 2e63 6f6f   coords=self.coo
+00026d70: 7264 7329 0a0a 2020 2020 6465 6620 6578  rds)..    def ex
+00026d80: 7061 6e64 2873 656c 662c 202a 2a6b 7761  pand(self, **kwa
+00026d90: 7267 733a 2044 6963 745b 7374 722c 2055  rgs: Dict[str, U
+00026da0: 6e69 6f6e 5b6e 702e 6e64 6172 7261 792c  nion[np.ndarray,
+00026db0: 204c 6973 745b 7374 725d 2c20 4c69 7374   List[str], List
+00026dc0: 5b69 6e74 5d2c 204c 6973 745b 666c 6f61  [int], List[floa
+00026dd0: 745d 2c20 4c69 7374 5b27 6e70 2e64 6174  t], List['np.dat
+00026de0: 6574 696d 6536 3427 5d2c 204c 6973 745b  etime64'], List[
+00026df0: 2770 642e 4461 7465 7469 6d65 496e 6465  'pd.DatetimeInde
+00026e00: 7827 5d2c 204c 6973 745b 2770 642e 4361  x'], List['pd.Ca
+00026e10: 7465 676f 7269 6361 6c27 5d5d 5d29 202d  tegorical']]]) -
+00026e20: 3e20 2741 7272 6179 273a 0a20 2020 2020  > 'Array':.     
+00026e30: 2020 2022 2222 0a20 2020 2020 2020 2045     """.        E
+00026e40: 7870 616e 6420 7468 6520 4172 7261 7920  xpand the Array 
+00026e50: 7769 7468 206e 6577 2064 696d 656e 7369  with new dimensi
+00026e60: 6f6e 7320 616e 6420 636f 6f72 6469 6e61  ons and coordina
+00026e70: 7465 732e 2049 7420 6272 6f61 6463 6173  tes. It broadcas
+00026e80: 7473 2074 6865 2076 616c 7565 7320 616c  ts the values al
+00026e90: 6f6e 6720 7468 6520 6e65 7720 6469 6d65  ong the new dime
+00026ea0: 6e73 696f 6e73 2e0a 0a20 2020 2020 2020  nsions...       
+00026eb0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+00026ec0: 2020 202a 2a6b 7761 7267 733a 204b 6579     **kwargs: Key
+00026ed0: 776f 7264 2061 7267 756d 656e 7473 2073  word arguments s
+00026ee0: 7065 6369 6679 696e 6720 7468 6520 6e65  pecifying the ne
+00026ef0: 7720 6469 6d65 6e73 696f 6e73 2061 6e64  w dimensions and
+00026f00: 2074 6865 6972 2063 6f6f 7264 696e 6174   their coordinat
+00026f10: 6573 2e0a 0a20 2020 2020 2020 2052 6574  es...        Ret
+00026f20: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
+00026f30: 2020 4120 6e65 7720 4172 7261 7920 6f62    A new Array ob
+00026f40: 6a65 6374 2077 6974 6820 7468 6520 6578  ject with the ex
+00026f50: 7061 6e64 6564 2064 696d 656e 7369 6f6e  panded dimension
+00026f60: 732e 0a0a 2020 2020 2020 2020 4578 616d  s...        Exam
+00026f70: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
+00026f80: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+00026f90: 2020 2020 2020 203e 3e3e 2063 6f6f 7264         >>> coord
+00026fa0: 7320 3d20 7b27 6469 6d31 273a 205b 2761  s = {'dim1': ['a
+00026fb0: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
+00026fc0: 205b 312c 2032 5d7d 0a20 2020 2020 2020   [1, 2]}.       
+00026fd0: 2020 2020 203e 3e3e 206c 6f6e 6720 3d20       >>> long = 
+00026fe0: 4c6f 6e67 2869 6e64 6578 3d7b 2764 696d  Long(index={'dim
+00026ff0: 3127 3a20 5b27 6127 2c20 2762 275d 2c20  1': ['a', 'b'], 
+00027000: 2764 696d 3227 3a20 5b31 2c20 325d 7d2c  'dim2': [1, 2]},
+00027010: 2076 616c 7565 3d5b 3130 2c20 3230 5d29   value=[10, 20])
+00027020: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00027030: 2061 7272 203d 2041 7272 6179 2864 6174   arr = Array(dat
+00027040: 613d 6c6f 6e67 2c20 636f 6f72 6473 3d63  a=long, coords=c
+00027050: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
+00027060: 2020 203e 3e3e 2065 7870 616e 6465 645f     >>> expanded_
+00027070: 6172 7220 3d20 6172 722e 6578 7061 6e64  arr = arr.expand
+00027080: 286e 6577 5f64 696d 3d5b 2778 272c 2779  (new_dim=['x','y
+00027090: 275d 290a 2020 2020 2020 2020 2020 2020  ']).            
+000270a0: 3e3e 3e20 6578 7061 6e64 6564 5f61 7272  >>> expanded_arr
+000270b0: 2e72 656f 7264 6572 2872 656f 7264 6572  .reorder(reorder
+000270c0: 3d5b 2764 696d 3127 2c20 2764 696d 3227  =['dim1', 'dim2'
+000270d0: 2c20 276e 6577 5f64 696d 275d 290a 2020  , 'new_dim']).  
+000270e0: 2020 2020 2020 2020 2020 4172 7261 7928            Array(
+000270f0: 6461 7461 3d61 7272 6179 285b 5b5b 3130  data=array([[[10
+00027100: 2e2c 2031 302e 5d2c 0a20 2020 2020 2020  ., 10.],.       
+00027110: 2020 2020 2020 2020 2020 2020 205b 2030               [ 0
+00027120: 2e2c 2020 302e 5d5d 2c0a 2020 2020 2020  .,  0.]],.      
+00027130: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+00027140: 3e0a 2020 2020 2020 2020 2020 2020 2020  >.              
+00027150: 2020 2020 205b 5b20 302e 2c20 2030 2e5d       [[ 0.,  0.]
+00027160: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00027170: 2020 2020 2020 5b32 302e 2c20 3230 2e5d        [20., 20.]
+00027180: 5d5d 292c 2063 6f6f 7264 733d 7b27 6469  ]]), coords={'di
+00027190: 6d31 273a 2061 7272 6179 285b 2761 272c  m1': array(['a',
+000271a0: 2027 6227 5d2c 2064 7479 7065 3d6f 626a   'b'], dtype=obj
+000271b0: 6563 7429 2c20 2764 696d 3227 3a20 6172  ect), 'dim2': ar
+000271c0: 7261 7928 5b31 2c20 325d 292c 2027 6e65  ray([1, 2]), 'ne
+000271d0: 775f 6469 6d27 3a20 6172 7261 7928 5b27  w_dim': array(['
+000271e0: 7827 2c20 2779 275d 2c20 6474 7970 653d  x', 'y'], dtype=
+000271f0: 6f62 6a65 6374 297d 290a 0a20 2020 2020  object)})..     
+00027200: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+00027210: 2020 2022 2222 0a20 2020 2020 2020 2074     """.        t
+00027220: 7970 6573 203d 207b 7d0a 2020 2020 2020  ypes = {}.      
+00027230: 2020 666f 7220 6469 6d20 696e 206b 7761    for dim in kwa
+00027240: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+00027250: 2061 7373 6572 7420 6469 6d20 6e6f 7420   assert dim not 
+00027260: 696e 2073 656c 662e 6469 6d73 2c20 6622  in self.dims, f"
+00027270: 6469 6d20 7b64 696d 7d20 616c 7265 6164  dim {dim} alread
+00027280: 7920 6578 6973 7473 2069 6e20 7365 6c66  y exists in self
+00027290: 2e64 696d 733a 207b 7365 6c66 2e64 696d  .dims: {self.dim
+000272a0: 737d 220a 2020 2020 2020 2020 2020 2020  s}".            
+000272b0: 7479 7065 735b 6469 6d5d 203d 205f 7465  types[dim] = _te
+000272c0: 7374 5f74 7970 655f 616e 645f 7570 6461  st_type_and_upda
+000272d0: 7465 286b 7761 7267 735b 6469 6d5d 292e  te(kwargs[dim]).
+000272e0: 6474 7970 650a 2020 2020 2020 2020 7265  dtype.        re
+000272f0: 7475 726e 2073 656c 662e 656d 7074 7928  turn self.empty(
+00027300: 292e 696e 7365 7274 282a 2a74 7970 6573  ).insert(**types
+00027310: 292e 6164 645f 656c 656d 282a 2a6b 7761  ).add_elem(**kwa
+00027320: 7267 7329 202b 2073 656c 660a 0a20 2020  rgs) + self..   
+00027330: 2064 6566 2075 6675 6e63 2873 656c 662c   def ufunc(self,
+00027340: 2064 696d 3a20 7374 722c 2066 756e 633a   dim: str, func:
+00027350: 2043 616c 6c61 626c 652c 206b 6565 7064   Callable, keepd
+00027360: 696d 733a 2062 6f6f 6c20 3d20 4661 6c73  ims: bool = Fals
+00027370: 652c 202a 2a66 756e 635f 6b77 6172 6773  e, **func_kwargs
+00027380: 3a20 416e 7929 202d 3e20 2741 7272 6179  : Any) -> 'Array
+00027390: 273a 0a20 2020 2020 2020 2022 2222 0a20  ':.        """. 
+000273a0: 2020 2020 2020 2041 7070 6c79 2061 2075         Apply a u
+000273b0: 6e69 7665 7273 616c 2066 756e 6374 696f  niversal functio
+000273c0: 6e20 616c 6f6e 6720 6120 7370 6563 6966  n along a specif
+000273d0: 6965 6420 6469 6d65 6e73 696f 6e20 6f66  ied dimension of
+000273e0: 2074 6865 2041 7272 6179 2e0a 0a20 2020   the Array...   
+000273f0: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
+00027400: 2020 2020 2020 2064 696d 3a20 5468 6520         dim: The 
+00027410: 6469 6d65 6e73 696f 6e20 746f 2061 7070  dimension to app
+00027420: 6c79 2074 6865 2066 756e 6374 696f 6e20  ly the function 
+00027430: 616c 6f6e 672e 0a20 2020 2020 2020 2020  along..         
+00027440: 2020 2066 756e 633a 2054 6865 2075 6e69     func: The uni
+00027450: 7665 7273 616c 2066 756e 6374 696f 6e20  versal function 
+00027460: 746f 2061 7070 6c79 2e0a 2020 2020 2020  to apply..      
+00027470: 2020 2020 2020 6b65 6570 6469 6d73 3a20        keepdims: 
+00027480: 5768 6574 6865 7220 746f 206b 6565 7020  Whether to keep 
+00027490: 7468 6520 7265 6475 6365 6420 6469 6d65  the reduced dime
+000274a0: 6e73 696f 6e20 696e 2074 6865 2072 6573  nsion in the res
+000274b0: 756c 742e 0a20 2020 2020 2020 2020 2020  ult..           
+000274c0: 202a 2a66 756e 635f 6b77 6172 6773 3a20   **func_kwargs: 
+000274d0: 4164 6469 7469 6f6e 616c 206b 6579 776f  Additional keywo
+000274e0: 7264 2061 7267 756d 656e 7473 2074 6f20  rd arguments to 
+000274f0: 7061 7373 2074 6f20 7468 6520 6675 6e63  pass to the func
+00027500: 7469 6f6e 2e0a 0a20 2020 2020 2020 2052  tion...        R
+00027510: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+00027520: 2020 2020 4120 6e65 7720 4172 7261 7920      A new Array 
+00027530: 6f62 6a65 6374 2077 6974 6820 7468 6520  object with the 
+00027540: 6675 6e63 7469 6f6e 2061 7070 6c69 6564  function applied
+00027550: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+00027560: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+00027570: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+00027580: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
+00027590: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
+000275a0: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
+000275b0: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
+000275c0: 2020 2020 3e3e 3e20 6c6f 6e67 203d 204c      >>> long = L
+000275d0: 6f6e 6728 696e 6465 783d 7b27 6469 6d31  ong(index={'dim1
+000275e0: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+000275f0: 6469 6d32 273a 205b 312c 2032 5d7d 2c20  dim2': [1, 2]}, 
+00027600: 7661 6c75 653d 5b31 302c 2032 305d 290a  value=[10, 20]).
+00027610: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00027620: 6172 7220 3d20 4172 7261 7928 6461 7461  arr = Array(data
+00027630: 3d6c 6f6e 672c 2063 6f6f 7264 733d 636f  =long, coords=co
+00027640: 6f72 6473 290a 2020 2020 2020 2020 2020  ords).          
+00027650: 2020 3e3e 3e20 7265 7375 6c74 5f61 7272    >>> result_arr
+00027660: 203d 2061 7272 2e75 6675 6e63 2864 696d   = arr.ufunc(dim
+00027670: 3d27 6469 6d31 272c 2066 756e 633d 6e70  ='dim1', func=np
+00027680: 2e73 756d 2c20 6b65 6570 6469 6d73 3d54  .sum, keepdims=T
+00027690: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
+000276a0: 203e 3e3e 2072 6573 756c 745f 6172 720a   >>> result_arr.
+000276b0: 2020 2020 2020 2020 2020 2020 4172 7261              Arra
+000276c0: 7928 6461 7461 3d61 7272 6179 285b 5b31  y(data=array([[1
+000276d0: 302e 2c20 3230 2e5d 2c0a 2020 2020 2020  0., 20.],.      
+000276e0: 2020 2020 2020 2020 2020 2020 205b 3130               [10
+000276f0: 2e2c 2032 302e 5d5d 292c 2063 6f6f 7264  ., 20.]]), coord
+00027700: 733d 7b27 6469 6d31 273a 2061 7272 6179  s={'dim1': array
+00027710: 285b 2761 272c 2027 6227 5d2c 2064 7479  (['a', 'b'], dty
+00027720: 7065 3d6f 626a 6563 7429 2c20 2764 696d  pe=object), 'dim
+00027730: 3227 3a20 6172 7261 7928 5b31 2c20 325d  2': array([1, 2]
+00027740: 297d 290a 0a20 2020 2020 2020 2020 2020  )})..           
+00027750: 2060 6060 0a20 2020 2020 2020 2022 2222   ```.        """
+00027760: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
+00027770: 7365 6c66 2e64 696d 732e 696e 6465 7828  self.dims.index(
+00027780: 6469 6d29 0a20 2020 2020 2020 2072 6573  dim).        res
+00027790: 756c 7420 3d20 6675 6e63 2873 656c 662e  ult = func(self.
+000277a0: 746f 6465 6e73 6528 292c 2061 7869 733d  todense(), axis=
+000277b0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+000277c0: 2020 2020 2020 2020 2020 2020 6b65 6570              keep
+000277d0: 6469 6d73 3d6b 6565 7064 696d 732c 202a  dims=keepdims, *
+000277e0: 2a66 756e 635f 6b77 6172 6773 290a 2020  *func_kwargs).  
+000277f0: 2020 2020 2020 6966 206b 6565 7064 696d        if keepdim
+00027800: 733a 0a20 2020 2020 2020 2020 2020 2073  s:.            s
+00027810: 6861 7065 203d 2073 656c 662e 7368 6170  hape = self.shap
+00027820: 650a 2020 2020 2020 2020 2020 2020 7265  e.            re
+00027830: 7375 6c74 203d 206e 702e 6272 6f61 6463  sult = np.broadc
+00027840: 6173 745f 746f 2872 6573 756c 742c 2073  ast_to(result, s
+00027850: 6861 7065 290a 2020 2020 2020 2020 2020  hape).          
+00027860: 2020 636f 6f72 6473 203d 207b 643a 2073    coords = {d: s
+00027870: 656c 662e 636f 6f72 6473 5b64 5d20 666f  elf.coords[d] fo
+00027880: 7220 6420 696e 2073 656c 662e 636f 6f72  r d in self.coor
+00027890: 6473 7d0a 2020 2020 2020 2020 656c 7365  ds}.        else
+000278a0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+000278b0: 6f72 6473 203d 207b 643a 2073 656c 662e  ords = {d: self.
+000278c0: 636f 6f72 6473 5b64 5d20 666f 7220 6420  coords[d] for d 
+000278d0: 696e 2073 656c 662e 636f 6f72 6473 2069  in self.coords i
+000278e0: 6620 6420 213d 2064 696d 7d0a 2020 2020  f d != dim}.    
+000278f0: 2020 2020 7265 7475 726e 2041 7272 6179      return Array
+00027900: 2864 6174 613d 7265 7375 6c74 2c20 636f  (data=result, co
+00027910: 6f72 6473 3d63 6f6f 7264 7329 0a0a 2020  ords=coords)..  
+00027920: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00027930: 6465 6620 6466 2873 656c 6629 202d 3e20  def df(self) -> 
+00027940: 556e 696f 6e5b 2770 642e 4461 7461 4672  Union['pd.DataFr
+00027950: 616d 6527 2c20 2770 6c2e 4461 7461 4672  ame', 'pl.DataFr
+00027960: 616d 6527 5d3a 0a20 2020 2020 2020 2022  ame']:.        "
+00027970: 2222 0a20 2020 2020 2020 2047 6574 2074  "".        Get t
+00027980: 6865 2044 6174 6146 7261 6d65 2072 6570  he DataFrame rep
+00027990: 7265 7365 6e74 6174 696f 6e20 6f66 2074  resentation of t
+000279a0: 6865 2041 7272 6179 2062 6173 6564 206f  he Array based o
+000279b0: 6e20 7468 6520 6465 6661 756c 7420 7365  n the default se
+000279c0: 7474 696e 672e 0a0a 2020 2020 2020 2020  tting...        
+000279d0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+000279e0: 2020 2020 2041 2044 6174 6146 7261 6d65       A DataFrame
+000279f0: 2028 7061 6e64 6173 206f 7220 706f 6c61   (pandas or pola
+00027a00: 7273 2920 7265 7072 6573 656e 7469 6e67  rs) representing
+00027a10: 2074 6865 2041 7272 6179 2e0a 0a20 2020   the Array...   
+00027a20: 2020 2020 2045 7861 6d70 6c65 3a0a 2020       Example:.  
+00027a30: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
+00027a40: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
+00027a50: 3e3e 3e20 636f 6f72 6473 203d 207b 2764  >>> coords = {'d
+00027a60: 696d 3127 3a20 5b27 6127 2c20 2762 275d  im1': ['a', 'b']
+00027a70: 2c20 2764 696d 3227 3a20 5b31 2c20 325d  , 'dim2': [1, 2]
+00027a80: 7d0a 2020 2020 2020 2020 2020 2020 3e3e  }.            >>
+00027a90: 3e20 6c6f 6e67 203d 204c 6f6e 6728 696e  > long = Long(in
+00027aa0: 6465 783d 7b27 6469 6d31 273a 205b 2761  dex={'dim1': ['a
+00027ab0: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
+00027ac0: 205b 312c 2032 5d7d 2c20 7661 6c75 653d   [1, 2]}, value=
+00027ad0: 5b31 302c 2032 305d 290a 2020 2020 2020  [10, 20]).      
+00027ae0: 2020 2020 2020 3e3e 3e20 6172 7220 3d20        >>> arr = 
+00027af0: 4172 7261 7928 6461 7461 3d6c 6f6e 672c  Array(data=long,
+00027b00: 2063 6f6f 7264 733d 636f 6f72 6473 290a   coords=coords).
+00027b10: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00027b20: 6172 722e 6466 0a20 2020 2020 2020 2020  arr.df.         
+00027b30: 2020 2020 2064 696d 3120 2064 696d 3220       dim1  dim2 
+00027b40: 2076 616c 7565 0a20 2020 2020 2020 2020   value.         
+00027b50: 2020 2030 2020 2020 6120 2020 2020 3120     0    a     1 
+00027b60: 2020 2020 3130 0a20 2020 2020 2020 2020      10.         
+00027b70: 2020 2031 2020 2020 6120 2020 2020 3220     1    a     2 
+00027b80: 2020 2020 2030 0a20 2020 2020 2020 2020       0.         
+00027b90: 2020 2032 2020 2020 6220 2020 2020 3120     2    b     1 
+00027ba0: 2020 2020 2030 0a20 2020 2020 2020 2020       0.         
+00027bb0: 2020 2033 2020 2020 6220 2020 2020 3220     3    b     2 
+00027bc0: 2020 2020 3230 0a0a 2020 2020 2020 2020      20..        
+00027bd0: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+00027be0: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
+00027bf0: 656c 662e 6466 5f77 6974 6820 3d3d 2022  elf.df_with == "
+00027c00: 7061 6e64 6173 223a 0a20 2020 2020 2020  pandas":.       
+00027c10: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00027c20: 2e74 6f5f 7061 6e64 6173 2829 0a20 2020  .to_pandas().   
+00027c30: 2020 2020 2065 6c69 6620 7365 6c66 2e64       elif self.d
+00027c40: 665f 7769 7468 203d 3d20 2270 6f6c 6172  f_with == "polar
+00027c50: 7322 3a0a 2020 2020 2020 2020 2020 2020  s":.            
+00027c60: 7265 7475 726e 2073 656c 662e 746f 5f70  return self.to_p
+00027c70: 6f6c 6172 7328 290a 2020 2020 2020 2020  olars().        
+00027c80: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00027c90: 2020 7261 6973 6520 4578 6365 7074 696f    raise Exceptio
+00027ca0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00027cb0: 2020 2022 6b61 2e73 6574 7469 6e67 732e     "ka.settings.
+00027cc0: 6466 5f77 6974 6820 6d75 7374 2062 6520  df_with must be 
+00027cd0: 6569 7468 6572 2027 7061 6e64 6173 2720  either 'pandas' 
+00027ce0: 6f72 2027 706f 6c61 7273 2722 290a 0a20  or 'polars'").. 
+00027cf0: 2020 2064 6566 2074 6f64 656e 7365 2873     def todense(s
+00027d00: 656c 6629 202d 3e20 6e70 2e6e 6461 7272  elf) -> np.ndarr
+00027d10: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
+00027d20: 2020 2020 2020 2020 5461 6b65 7320 6461          Takes da
+00027d30: 7461 2070 726f 7065 7274 7920 616e 6420  ta property and 
+00027d40: 7072 6f76 6964 6520 6120 6465 6e73 6520  provide a dense 
+00027d50: 6e75 6d70 7920 6172 7261 792e 2049 6620  numpy array. If 
+00027d60: 6461 7461 2070 726f 7065 7274 7920 7265  data property re
+00027d70: 7475 726e 2061 2073 7061 7273 6520 6f62  turn a sparse ob
+00027d80: 6a65 6374 2074 6865 6e20 636f 6e76 6572  ject then conver
+00027d90: 7420 6974 2074 6f20 6120 6465 6e73 6520  t it to a dense 
+00027da0: 6e75 6d70 7920 6172 7261 792e 2049 6620  numpy array. If 
+00027db0: 6974 2072 6574 7572 6e73 2064 656e 7365  it returns dense
+00027dc0: 206f 626a 6563 7420 7468 656e 2072 6574   object then ret
+00027dd0: 7572 6e20 7468 6520 6f72 6967 696e 616c  urn the original
+00027de0: 2064 656e 7365 206e 756d 7079 2061 7272   dense numpy arr
+00027df0: 6179 2e0a 0a20 2020 2020 2020 2052 6574  ay...        Ret
+00027e00: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
+00027e10: 2020 4120 6465 6e73 6520 6e75 6d70 7920    A dense numpy 
+00027e20: 6172 7261 792e 0a20 2020 2020 2020 2022  array..        "
+00027e30: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
+00027e40: 696e 7374 616e 6365 2873 656c 662e 6461  instance(self.da
+00027e50: 7461 2c20 6e70 2e6e 6461 7272 6179 293a  ta, np.ndarray):
+00027e60: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00027e70: 7572 6e20 7365 6c66 2e64 6174 610a 2020  urn self.data.  
+00027e80: 2020 2020 2020 656c 6966 205f 6973 696e        elif _isin
+00027e90: 7374 616e 6365 5f6f 7074 696f 6e61 6c5f  stance_optional_
+00027ea0: 706b 6773 2873 656c 662e 6461 7461 2c20  pkgs(self.data, 
+00027eb0: 2773 702e 434f 4f27 293a 0a20 2020 2020  'sp.COO'):.     
+00027ec0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00027ed0: 6c66 2e64 6174 612e 746f 6465 6e73 6528  lf.data.todense(
+00027ee0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00027ef0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00027f00: 6520 4578 6365 7074 696f 6e28 6622 496e  e Exception(f"In
+00027f10: 7661 6c69 6420 7479 7065 2066 6f72 2027  valid type for '
+00027f20: 6461 7461 273a 207b 7479 7065 2873 656c  data': {type(sel
+00027f30: 662e 6461 7461 297d 2229 0a0a 2020 2020  f.data)}")..    
+00027f40: 6465 6620 5f63 6865 636b 5f64 7570 6c69  def _check_dupli
+00027f50: 6361 7465 5f69 6e64 6578 6573 2873 656c  cate_indexes(sel
+00027f60: 662c 2069 6e64 6578 6573 3a20 6e70 2e6e  f, indexes: np.n
+00027f70: 6461 7272 6179 2c20 6469 6d73 3a20 4c69  darray, dims: Li
+00027f80: 7374 5b73 7472 5d2c 2063 6f6f 7264 733a  st[str], coords:
+00027f90: 2044 6963 745b 7374 722c 206e 702e 6e64   Dict[str, np.nd
+00027fa0: 6172 7261 795d 2920 2d3e 204e 6f6e 653a  array]) -> None:
+00027fb0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00027fc0: 2020 2020 2043 6865 636b 2069 6620 7468       Check if th
+00027fd0: 6520 696e 6465 7865 7320 636f 6e74 6169  e indexes contai
+00027fe0: 6e73 2064 7570 6c69 6361 7465 2076 616c  ns duplicate val
+00027ff0: 7565 732e 0a0a 2020 2020 2020 2020 4172  ues...        Ar
+00028000: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00028010: 696e 6465 7865 733a 2054 6865 2069 6e64  indexes: The ind
+00028020: 6578 6573 2074 6f20 6368 6563 6b2e 0a20  exes to check.. 
+00028030: 2020 2020 2020 2020 2020 2064 696d 733a             dims:
+00028040: 2054 6865 2064 696d 656e 7369 6f6e 7320   The dimensions 
+00028050: 6f66 2074 6865 2069 6e64 6578 6573 2e0a  of the indexes..
+00028060: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
+00028070: 6473 3a20 5468 6520 636f 6f72 6469 6e61  ds: The coordina
+00028080: 7465 7320 6f66 2074 6865 2069 6e64 6578  tes of the index
+00028090: 6573 2e0a 0a20 2020 2020 2020 2052 6169  es...        Rai
+000280a0: 7365 733a 0a20 2020 2020 2020 2020 2020  ses:.           
+000280b0: 2056 616c 7565 4572 726f 723a 2049 6620   ValueError: If 
+000280c0: 7468 6520 696e 6465 7865 7320 636f 6e74  the indexes cont
+000280d0: 6169 6e73 2064 7570 6c69 6361 7465 2076  ains duplicate v
+000280e0: 616c 7565 732e 0a0a 2020 2020 2020 2020  alues...        
+000280f0: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+00028100: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
+00028110: 2020 2020 2020 2020 2020 203e 3e3e 2063             >>> c
+00028120: 6f6f 7264 7320 3d20 7b27 6469 6d31 273a  oords = {'dim1':
+00028130: 205b 2761 272c 2027 6227 5d2c 2027 6469   ['a', 'b'], 'di
+00028140: 6d32 273a 205b 312c 2032 5d7d 0a20 2020  m2': [1, 2]}.   
+00028150: 2020 2020 2020 2020 203e 3e3e 206c 6f6e           >>> lon
+00028160: 6720 3d20 4c6f 6e67 2869 6e64 6578 3d7b  g = Long(index={
+00028170: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
+00028180: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
+00028190: 325d 7d2c 2076 616c 7565 3d5b 3130 2c20  2]}, value=[10, 
+000281a0: 3230 5d29 0a20 2020 2020 2020 2020 2020  20]).           
+000281b0: 203e 3e3e 2061 7272 203d 2041 7272 6179   >>> arr = Array
+000281c0: 2864 6174 613d 6c6f 6e67 2c20 636f 6f72  (data=long, coor
+000281d0: 6473 3d63 6f6f 7264 7329 0a20 2020 2020  ds=coords).     
+000281e0: 2020 2020 2020 203e 3e3e 2061 7272 2e5f         >>> arr._
+000281f0: 6368 6563 6b5f 6475 706c 6963 6174 655f  check_duplicate_
+00028200: 696e 6465 7865 7328 696e 6465 7865 733d  indexes(indexes=
+00028210: 6e70 2e61 7272 6179 285b 302c 2030 2c20  np.array([0, 0, 
+00028220: 315d 292c 2064 696d 733d 5b27 6469 6d31  1]), dims=['dim1
+00028230: 272c 2027 6469 6d32 275d 2c20 636f 6f72  ', 'dim2'], coor
+00028240: 6473 3d63 6f6f 7264 7329 0a20 2020 2020  ds=coords).     
+00028250: 2020 2020 2020 2054 7261 6365 6261 636b         Traceback
+00028260: 2028 6d6f 7374 2072 6563 656e 7420 6361   (most recent ca
+00028270: 6c6c 206c 6173 7429 3a0a 2020 2020 2020  ll last):.      
+00028280: 2020 2020 2020 2e2e 2e0a 2020 2020 2020        ....      
+00028290: 2020 2020 2020 5661 6c75 6545 7272 6f72        ValueError
+000282a0: 3a20 5468 6520 4c6f 6e67 206f 626a 6563  : The Long objec
+000282b0: 7420 636f 6e74 6169 6e73 2064 7570 6c69  t contains dupli
+000282c0: 6361 7465 2069 6e64 6578 6573 2e20 4475  cate indexes. Du
+000282d0: 706c 6963 6174 6520 696e 6465 7865 7320  plicate indexes 
+000282e0: 6172 653a 205b 7b27 6c6f 6327 3a20 7b27  are: [{'loc': {'
+000282f0: 6469 6d31 273a 2027 6127 2c20 2764 696d  dim1': 'a', 'dim
+00028300: 3227 3a20 317d 2c20 2763 6f75 6e74 273a  2': 1}, 'count':
+00028310: 2032 7d5d 2e0a 0a20 2020 2020 2020 2020   2}]...         
+00028320: 2020 2060 6060 0a20 2020 2020 2020 2022     ```.        "
+00028330: 2222 0a20 2020 2020 2020 2069 6620 6e6f  "".        if no
+00028340: 7420 6e70 2e75 6e69 7175 6528 696e 6465  t np.unique(inde
+00028350: 7865 7329 2e73 697a 6520 3d3d 2069 6e64  xes).size == ind
+00028360: 6578 6573 2e73 697a 653a 0a20 2020 2020  exes.size:.     
+00028370: 2020 2020 2020 2063 6f75 6e74 5f72 6570         count_rep
+00028380: 6561 7465 6420 3d20 6e70 2e62 696e 636f  eated = np.binco
+00028390: 756e 7428 696e 6465 7865 7329 0a20 2020  unt(indexes).   
+000283a0: 2020 2020 2020 2020 2064 7570 6c69 6361           duplica
+000283b0: 7465 5f69 6e64 6578 6573 203d 206e 702e  te_indexes = np.
+000283c0: 7768 6572 6528 636f 756e 745f 7265 7065  where(count_repe
+000283d0: 6174 6564 203e 2031 295b 305d 0a20 2020  ated > 1)[0].   
+000283e0: 2020 2020 2020 2020 2072 6570 6561 7465           repeate
+000283f0: 6420 3d20 5b5d 0a20 2020 2020 2020 2020  d = [].         
+00028400: 2020 2061 7272 6179 7320 3d20 6e70 2e75     arrays = np.u
+00028410: 6e72 6176 656c 5f69 6e64 6578 2869 6e64  nravel_index(ind
+00028420: 6578 6573 2c20 7365 6c66 2e5f 7368 6170  exes, self._shap
+00028430: 6528 636f 6f72 6473 2929 0a20 2020 2020  e(coords)).     
+00028440: 2020 2020 2020 2069 6e64 6578 5f64 6963         index_dic
+00028450: 7420 3d20 7b64 696d 3a20 636f 6f72 6473  t = {dim: coords
+00028460: 5b64 696d 5d5b 6964 785d 0a20 2020 2020  [dim][idx].     
+00028470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028480: 2020 2020 2066 6f72 2064 696d 2c20 6964       for dim, id
+00028490: 7820 696e 207a 6970 2863 6f6f 7264 732c  x in zip(coords,
+000284a0: 2061 7272 6179 7329 7d0a 2020 2020 2020   arrays)}.      
+000284b0: 2020 2020 2020 666f 7220 6920 696e 2064        for i in d
+000284c0: 7570 6c69 6361 7465 5f69 6e64 6578 6573  uplicate_indexes
+000284d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000284e0: 2020 7265 7065 6174 6564 2e61 7070 656e    repeated.appen
+000284f0: 6428 7b27 6c6f 6327 3a20 7b64 696d 3a20  d({'loc': {dim: 
+00028500: 696e 6465 785f 6469 6374 5b64 696d 5d5b  index_dict[dim][
+00028510: 6e70 2e61 7267 6d61 7828 0a20 2020 2020  np.argmax(.     
+00028520: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00028530: 6e64 6578 6573 203d 3d20 6929 5d20 666f  ndexes == i)] fo
+00028540: 7220 6469 6d20 696e 2064 696d 737d 2c20  r dim in dims}, 
+00028550: 2763 6f75 6e74 273a 2063 6f75 6e74 5f72  'count': count_r
+00028560: 6570 6561 7465 645b 695d 7d29 0a20 2020  epeated[i]}).   
+00028570: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00028580: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00028590: 2020 2020 2020 2020 2020 2066 2254 6865             f"The
+000285a0: 204c 6f6e 6720 6f62 6a65 6374 2063 6f6e   Long object con
+000285b0: 7461 696e 7320 6475 706c 6963 6174 6520  tains duplicate 
+000285c0: 696e 6465 7865 732e 2044 7570 6c69 6361  indexes. Duplica
+000285d0: 7465 2069 6e64 6578 6573 2061 7265 3a20  te indexes are: 
+000285e0: 7b72 6570 6561 7465 647d 2e22 290a 0a0a  {repeated}.")...
+000285f0: 6465 6620 636f 6e63 6174 2861 7272 6179  def concat(array
+00028600: 733a 204c 6973 745b 4172 7261 795d 2920  s: List[Array]) 
+00028610: 2d3e 2041 7272 6179 3a0a 2020 2020 2222  -> Array:.    ""
+00028620: 220a 2020 2020 436f 6e63 6174 656e 6174  ".    Concatenat
+00028630: 6520 6d75 6c74 6970 6c65 2041 7272 6179  e multiple Array
+00028640: 206f 626a 6563 7473 2061 6c6f 6e67 2061   objects along a
+00028650: 206e 6577 2064 696d 656e 7369 6f6e 2e0a   new dimension..
+00028660: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+00028670: 2020 2061 7272 6179 733a 2041 206c 6973     arrays: A lis
+00028680: 7420 6f66 2041 7272 6179 206f 626a 6563  t of Array objec
+00028690: 7473 2074 6f20 636f 6e63 6174 656e 6174  ts to concatenat
+000286a0: 652e 0a0a 2020 2020 5265 7475 726e 733a  e...    Returns:
+000286b0: 0a20 2020 2020 2020 2041 206e 6577 2041  .        A new A
+000286c0: 7272 6179 206f 626a 6563 7420 7769 7468  rray object with
+000286d0: 2074 6865 2063 6f6e 6361 7465 6e61 7465   the concatenate
+000286e0: 6420 6172 7261 7973 2e0a 0a20 2020 2045  d arrays...    E
+000286f0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+00028700: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+00028710: 2020 3e3e 3e20 636f 6f72 6473 203d 207b    >>> coords = {
+00028720: 2764 696d 3127 3a20 5b27 6127 2c20 2762  'dim1': ['a', 'b
+00028730: 275d 2c20 2764 696d 3227 3a20 5b31 2c20  '], 'dim2': [1, 
+00028740: 325d 7d0a 2020 2020 2020 2020 3e3e 3e20  2]}.        >>> 
+00028750: 6c6f 6e67 3120 3d20 4c6f 6e67 2869 6e64  long1 = Long(ind
+00028760: 6578 3d7b 2764 696d 3127 3a20 5b27 6127  ex={'dim1': ['a'
+00028770: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
+00028780: 5b31 2c20 315d 7d2c 2076 616c 7565 3d5b  [1, 1]}, value=[
+00028790: 3130 2c20 3230 5d29 0a20 2020 2020 2020  10, 20]).       
+000287a0: 203e 3e3e 2061 7272 3120 3d20 4172 7261   >>> arr1 = Arra
+000287b0: 7928 6461 7461 3d6c 6f6e 6731 2c20 636f  y(data=long1, co
+000287c0: 6f72 6473 3d63 6f6f 7264 7329 0a20 2020  ords=coords).   
+000287d0: 2020 2020 203e 3e3e 206c 6f6e 6732 203d       >>> long2 =
+000287e0: 204c 6f6e 6728 696e 6465 783d 7b27 6469   Long(index={'di
+000287f0: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+00028800: 2027 6469 6d32 273a 205b 322c 2032 5d7d   'dim2': [2, 2]}
+00028810: 2c20 7661 6c75 653d 5b33 302c 2034 305d  , value=[30, 40]
+00028820: 290a 2020 2020 2020 2020 3e3e 3e20 6172  ).        >>> ar
+00028830: 7232 203d 2041 7272 6179 2864 6174 613d  r2 = Array(data=
+00028840: 6c6f 6e67 322c 2063 6f6f 7264 733d 636f  long2, coords=co
+00028850: 6f72 6473 290a 2020 2020 2020 2020 3e3e  ords).        >>
+00028860: 3e20 636f 6e63 6174 656e 6174 6564 5f61  > concatenated_a
+00028870: 7272 203d 2063 6f6e 6361 7428 5b61 7272  rr = concat([arr
+00028880: 312c 2061 7272 325d 290a 2020 2020 2020  1, arr2]).      
+00028890: 2020 3e3e 3e20 636f 6e63 6174 656e 6174    >>> concatenat
+000288a0: 6564 5f61 7272 0a20 2020 2020 2020 2041  ed_arr.        A
+000288b0: 7272 6179 2864 6174 613d 6172 7261 7928  rray(data=array(
+000288c0: 5b5b 3130 2c20 3330 5d2c 0a20 2020 2020  [[10, 30],.     
+000288d0: 2020 2020 2020 2020 2020 5b32 302c 2034            [20, 4
+000288e0: 305d 5d29 2c20 636f 6f72 6473 3d7b 2764  0]]), coords={'d
+000288f0: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
+00028900: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
+00028910: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
+00028920: 7272 6179 285b 312c 2032 5d29 7d29 0a0a  rray([1, 2])})..
+00028930: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+00028940: 2222 220a 2020 2020 6469 6d73 203d 2061  """.    dims = a
+00028950: 7272 6179 735b 305d 2e64 696d 735b 3a5d  rrays[0].dims[:]
+00028960: 0a20 2020 2061 7373 6572 7420 616c 6c28  .    assert all(
+00028970: 5b69 7369 6e73 7461 6e63 6528 6172 722c  [isinstance(arr,
+00028980: 2041 7272 6179 2920 666f 7220 6172 7220   Array) for arr 
+00028990: 696e 2061 7272 6179 735d 0a20 2020 2020  in arrays].     
+000289a0: 2020 2020 2020 2020 2020 292c 2022 416c            ), "Al
+000289b0: 6c20 6c69 7374 2069 7465 6d73 206d 7573  l list items mus
+000289c0: 7420 6265 206b 6172 7261 792e 6172 7261  t be karray.arra
+000289d0: 7922 0a20 2020 2061 7373 6572 7420 616c  y".    assert al
+000289e0: 6c28 5b73 6574 2861 7272 2e64 696d 7329  l([set(arr.dims)
+000289f0: 203d 3d20 7365 7428 6469 6d73 2920 666f   == set(dims) fo
+00028a00: 7220 6172 7220 696e 2061 7272 6179 735d  r arr in arrays]
+00028a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028a20: 292c 2022 416c 6c20 6172 7261 7920 6d75  ), "All array mu
+00028a30: 7374 2068 6176 6520 7468 6520 7361 6d65  st have the same
+00028a40: 2064 696d 656e 7369 6f6e 7322 0a20 2020   dimensions".   
+00028a50: 2069 6e64 6578 203d 207b 6469 6d3a 205b   index = {dim: [
+00028a60: 5d20 666f 7220 6469 6d20 696e 2064 696d  ] for dim in dim
+00028a70: 737d 0a20 2020 2076 616c 7565 203d 205b  s}.    value = [
+00028a80: 5d0a 2020 2020 5b69 6e64 6578 5b64 696d  ].    [index[dim
+00028a90: 5d2e 6170 7065 6e64 2861 7272 2e6c 6f6e  ].append(arr.lon
+00028aa0: 672e 696e 6465 785b 6469 6d5d 290a 2020  g.index[dim]).  
+00028ab0: 2020 2066 6f72 2061 7272 2069 6e20 6172     for arr in ar
+00028ac0: 7261 7973 2066 6f72 2064 696d 2069 6e20  rays for dim in 
+00028ad0: 6172 722e 6469 6d73 5d0a 2020 2020 696e  arr.dims].    in
+00028ae0: 6465 7820 3d20 7b64 696d 3a20 6e70 2e68  dex = {dim: np.h
+00028af0: 7374 6163 6b28 696e 6465 785b 6469 6d5d  stack(index[dim]
+00028b00: 2920 666f 7220 6469 6d20 696e 2064 696d  ) for dim in dim
+00028b10: 737d 0a20 2020 205b 7661 6c75 652e 6170  s}.    [value.ap
+00028b20: 7065 6e64 2861 7272 2e6c 6f6e 672e 7661  pend(arr.long.va
+00028b30: 6c75 6529 2066 6f72 2061 7272 2069 6e20  lue) for arr in 
+00028b40: 6172 7261 7973 5d0a 2020 2020 7661 6c75  arrays].    valu
+00028b50: 6520 3d20 6e70 2e68 7374 6163 6b28 7661  e = np.hstack(va
+00028b60: 6c75 6529 0a20 2020 206c 6973 745f 6f66  lue).    list_of
+00028b70: 5f63 6f6f 7264 7320 3d20 5b61 7272 2e63  _coords = [arr.c
+00028b80: 6f6f 7264 7320 666f 7220 6172 7220 696e  oords for arr in
+00028b90: 2061 7272 6179 735d 0a20 2020 2063 6f6f   arrays].    coo
+00028ba0: 7264 7320 3d20 756e 696f 6e5f 6d75 6c74  rds = union_mult
+00028bb0: 695f 636f 6f72 6473 282a 6c69 7374 5f6f  i_coords(*list_o
+00028bc0: 665f 636f 6f72 6473 290a 2020 2020 7265  f_coords).    re
+00028bd0: 7475 726e 2041 7272 6179 2864 6174 613d  turn Array(data=
+00028be0: 2869 6e64 6578 2c20 7661 6c75 6529 2c20  (index, value), 
+00028bf0: 636f 6f72 6473 3d63 6f6f 7264 7329 0a0a  coords=coords)..
+00028c00: 0a64 6566 206e 756d 7079 5f74 6f5f 6c6f  .def numpy_to_lo
+00028c10: 6e67 2861 7272 6179 3a20 6e70 2e6e 6461  ng(array: np.nda
+00028c20: 7272 6179 2c20 6469 6d73 3a20 4c69 7374  rray, dims: List
+00028c30: 5b73 7472 5d29 202d 3e20 4c6f 6e67 3a0a  [str]) -> Long:.
+00028c40: 2020 2020 2222 220a 2020 2020 436f 6e76      """.    Conv
+00028c50: 6572 7420 6120 4e75 6d50 7920 6172 7261  ert a NumPy arra
+00028c60: 7920 746f 2061 204c 6f6e 6720 6f62 6a65  y to a Long obje
+00028c70: 6374 2e0a 0a20 2020 2041 7267 733a 0a20  ct...    Args:. 
+00028c80: 2020 2020 2020 2061 7272 6179 3a20 5468         array: Th
+00028c90: 6520 4e75 6d50 7920 6172 7261 7920 746f  e NumPy array to
+00028ca0: 2063 6f6e 7665 7274 2e0a 2020 2020 2020   convert..      
+00028cb0: 2020 6469 6d73 3a20 5468 6520 6c69 7374    dims: The list
+00028cc0: 206f 6620 6469 6d65 6e73 696f 6e20 6e61   of dimension na
+00028cd0: 6d65 7320 666f 7220 7468 6520 4c6f 6e67  mes for the Long
+00028ce0: 206f 626a 6563 742e 0a0a 2020 2020 5265   object...    Re
+00028cf0: 7475 726e 733a 0a20 2020 2020 2020 2041  turns:.        A
+00028d00: 204c 6f6e 6720 6f62 6a65 6374 2063 7265   Long object cre
+00028d10: 6174 6564 2066 726f 6d20 7468 6520 4e75  ated from the Nu
+00028d20: 6d50 7920 6172 7261 792e 0a0a 2020 2020  mPy array...    
+00028d30: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+00028d40: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+00028d50: 2020 203e 3e3e 2061 7272 6179 203d 206e     >>> array = n
+00028d60: 702e 6172 7261 7928 5b5b 312c 2032 2c20  p.array([[1, 2, 
+00028d70: 3130 5d2c 205b 332c 2034 2c20 3230 5d5d  10], [3, 4, 20]]
+00028d80: 290a 2020 2020 2020 2020 3e3e 3e20 6469  ).        >>> di
+00028d90: 6d73 203d 205b 2764 696d 3127 2c20 2764  ms = ['dim1', 'd
+00028da0: 696d 3227 5d0a 2020 2020 2020 2020 3e3e  im2'].        >>
+00028db0: 3e20 6c6f 6e67 5f6f 626a 203d 206e 756d  > long_obj = num
+00028dc0: 7079 5f74 6f5f 6c6f 6e67 2861 7272 6179  py_to_long(array
+00028dd0: 2c20 6469 6d73 290a 2020 2020 2020 2020  , dims).        
+00028de0: 3e3e 3e20 6c6f 6e67 5f6f 626a 0a20 2020  >>> long_obj.   
+00028df0: 2020 2020 204c 6f6e 6728 696e 6465 783d       Long(index=
+00028e00: 7b27 6469 6d31 273a 2061 7272 6179 285b  {'dim1': array([
+00028e10: 312c 2033 5d29 2c20 2764 696d 3227 3a20  1, 3]), 'dim2': 
+00028e20: 6172 7261 7928 5b32 2c20 345d 297d 2c20  array([2, 4])}, 
+00028e30: 7661 6c75 653d 6172 7261 7928 5b31 302e  value=array([10.
+00028e40: 2c20 3230 2e5d 2929 0a0a 2020 2020 2020  , 20.]))..      
+00028e50: 2020 6060 600a 2020 2020 2222 220a 2020    ```.    """.  
+00028e60: 2020 6173 7365 7274 2069 7369 6e73 7461    assert isinsta
+00028e70: 6e63 6528 6172 7261 792c 206e 702e 6e64  nce(array, np.nd
+00028e80: 6172 7261 7929 0a20 2020 2061 7373 6572  array).    asser
+00028e90: 7420 6973 696e 7374 616e 6365 2864 696d  t isinstance(dim
+00028ea0: 732c 206c 6973 7429 0a20 2020 2061 7373  s, list).    ass
+00028eb0: 6572 7420 6172 7261 792e 6e64 696d 203d  ert array.ndim =
+00028ec0: 3d20 322c 2022 4172 7261 7920 6d75 7374  = 2, "Array must
+00028ed0: 2062 6520 6120 3220 6469 6d65 6e73 696f   be a 2 dimensio
+00028ee0: 6e73 2061 7272 6179 220a 2020 2020 6173  ns array".    as
+00028ef0: 7365 7274 206c 656e 280a 2020 2020 2020  sert len(.      
+00028f00: 2020 6469 6d73 2920 2b20 3120 3d3d 206c    dims) + 1 == l
+00028f10: 656e 2861 7272 6179 2e54 292c 2066 224e  en(array.T), f"N
+00028f20: 756d 7079 2061 7272 6179 206d 7573 7420  umpy array must 
+00028f30: 636f 6e74 6169 6e20 7b6c 656e 2864 696d  contain {len(dim
+00028f40: 7329 202b 2031 7d20 636f 6c75 6d6e 7322  s) + 1} columns"
+00028f50: 0a20 2020 2076 616c 7565 203d 2061 7272  .    value = arr
+00028f60: 6179 2e54 5b6c 656e 2864 696d 7329 5d0a  ay.T[len(dims)].
+00028f70: 2020 2020 5f69 6e64 6578 203d 207b 6469      _index = {di
+00028f80: 6d3a 2061 7272 2066 6f72 2064 696d 2c20  m: arr for dim, 
+00028f90: 6172 7220 696e 207a 6970 2864 696d 732c  arr in zip(dims,
+00028fa0: 2061 7272 6179 2e54 5b30 3a6c 656e 2864   array.T[0:len(d
+00028fb0: 696d 7329 5d29 7d0a 2020 2020 5f76 616c  ims)])}.    _val
+00028fc0: 7565 203d 2076 616c 7565 2069 6620 6973  ue = value if is
+00028fd0: 7375 6263 6c61 7373 280a 2020 2020 2020  subclass(.      
+00028fe0: 2020 7661 6c75 652e 6474 7970 652e 7479    value.dtype.ty
+00028ff0: 7065 2c20 666c 6f61 7429 2065 6c73 6520  pe, float) else 
+00029000: 7661 6c75 652e 6173 7479 7065 2866 6c6f  value.astype(flo
+00029010: 6174 290a 2020 2020 7265 7475 726e 204c  at).    return L
+00029020: 6f6e 6728 5f69 6e64 6578 2c20 5f76 616c  ong(_index, _val
+00029030: 7565 290a 0a0a 6465 6620 5f70 616e 6461  ue)...def _panda
+00029040: 735f 746f 5f61 7272 6179 2864 663a 2027  s_to_array(df: '
+00029050: 7064 2e44 6174 6146 7261 6d65 272c 2063  pd.DataFrame', c
+00029060: 6f6f 7264 733a 2055 6e69 6f6e 5b44 6963  oords: Union[Dic
+00029070: 745b 7374 722c 206e 702e 6e64 6172 7261  t[str, np.ndarra
+00029080: 795d 2c20 4e6f 6e65 5d20 3d20 4e6f 6e65  y], None] = None
+00029090: 2920 2d3e 2044 6963 745b 7374 722c 2055  ) -> Dict[str, U
+000290a0: 6e69 6f6e 5b54 7570 6c65 5b44 6963 745b  nion[Tuple[Dict[
+000290b0: 7374 722c 206e 702e 6e64 6172 7261 795d  str, np.ndarray]
+000290c0: 2c20 6e70 2e6e 6461 7272 6179 5d2c 2044  , np.ndarray], D
+000290d0: 6963 745b 7374 722c 206e 702e 6e64 6172  ict[str, np.ndar
+000290e0: 7261 795d 5d5d 3a0a 2020 2020 2222 220a  ray]]]:.    """.
+000290f0: 2020 2020 436f 6e76 6572 7420 6120 7061      Convert a pa
+00029100: 6e64 6173 2044 6174 6146 7261 6d65 2074  ndas DataFrame t
+00029110: 6f20 616e 2041 7272 6179 2064 6963 7469  o an Array dicti
+00029120: 6f6e 6172 792e 0a0a 2020 2020 4172 6773  onary...    Args
+00029130: 3a0a 2020 2020 2020 2020 6466 3a20 5468  :.        df: Th
+00029140: 6520 7061 6e64 6173 2044 6174 6146 7261  e pandas DataFra
+00029150: 6d65 2074 6f20 636f 6e76 6572 742e 0a20  me to convert.. 
+00029160: 2020 2020 2020 2063 6f6f 7264 733a 2054         coords: T
+00029170: 6865 2063 6f6f 7264 696e 6174 6573 2066  he coordinates f
+00029180: 6f72 2074 6865 2041 7272 6179 2e0a 0a20  or the Array... 
+00029190: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
+000291a0: 2020 2020 4120 6469 6374 696f 6e61 7279      A dictionary
+000291b0: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
+000291c0: 6520 4172 7261 7920 6461 7461 2061 6e64  e Array data and
+000291d0: 2063 6f6f 7264 696e 6174 6573 2e0a 0a20   coordinates... 
+000291e0: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
+000291f0: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
+00029200: 2020 2020 2020 3e3e 3e20 6466 203d 2070        >>> df = p
+00029210: 642e 4461 7461 4672 616d 6528 7b27 6469  d.DataFrame({'di
+00029220: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+00029230: 2027 6469 6d32 273a 205b 312c 2032 5d2c   'dim2': [1, 2],
+00029240: 2027 7661 6c75 6527 3a20 5b31 302c 2032   'value': [10, 2
+00029250: 305d 7d29 0a20 2020 2020 2020 203e 3e3e  0]}).        >>>
+00029260: 2063 6f6f 7264 7320 3d20 7b27 6469 6d31   coords = {'dim1
+00029270: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+00029280: 6469 6d32 273a 205b 312c 2032 5d7d 0a20  dim2': [1, 2]}. 
+00029290: 2020 2020 2020 203e 3e3e 2061 7272 6179         >>> array
+000292a0: 5f64 6963 7420 3d20 5f70 616e 6461 735f  _dict = _pandas_
+000292b0: 746f 5f61 7272 6179 2864 662c 2063 6f6f  to_array(df, coo
+000292c0: 7264 7329 0a20 2020 2020 2020 203e 3e3e  rds).        >>>
+000292d0: 2061 7272 6179 5f64 6963 740a 2020 2020   array_dict.    
+000292e0: 2020 2020 7b27 6461 7461 273a 2028 7b27      {'data': ({'
+000292f0: 6469 6d31 273a 2061 7272 6179 285b 2761  dim1': array(['a
+00029300: 272c 2027 6227 5d2c 2064 7479 7065 3d6f  ', 'b'], dtype=o
+00029310: 626a 6563 7429 2c20 2764 696d 3227 3a20  bject), 'dim2': 
+00029320: 6172 7261 7928 5b31 2c20 325d 297d 2c20  array([1, 2])}, 
+00029330: 6172 7261 7928 5b31 302c 2032 305d 2929  array([10, 20]))
+00029340: 2c20 2763 6f6f 7264 7327 3a20 7b27 6469  , 'coords': {'di
+00029350: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+00029360: 2027 6469 6d32 273a 205b 312c 2032 5d7d   'dim2': [1, 2]}
+00029370: 7d0a 0a20 2020 2020 2020 2060 6060 0a20  }..        ```. 
+00029380: 2020 2022 2222 0a20 2020 2061 7373 6572     """.    asser
+00029390: 7420 2276 616c 7565 2220 696e 2064 662e  t "value" in df.
+000293a0: 636f 6c75 6d6e 732c 2022 436f 6c75 6d6e  columns, "Column
+000293b0: 206e 616d 6564 2027 7661 6c75 6527 206d   named 'value' m
+000293c0: 7573 7420 6578 6973 7422 0a20 2020 2076  ust exist".    v
+000293d0: 616c 7565 203d 2064 665b 2276 616c 7565  alue = df["value
+000293e0: 225d 2e76 616c 7565 730a 2020 2020 6466  "].values.    df
+000293f0: 203d 2064 662e 6472 6f70 286c 6162 656c   = df.drop(label
+00029400: 733d 2276 616c 7565 222c 2061 7869 733d  s="value", axis=
+00029410: 3129 0a20 2020 2069 6e64 6578 203d 207b  1).    index = {
+00029420: 7d0a 2020 2020 666f 7220 636f 6c20 696e  }.    for col in
+00029430: 2064 662e 636f 6c75 6d6e 733a 0a20 2020   df.columns:.   
+00029440: 2020 2020 2069 6e64 6578 5b63 6f6c 5d20       index[col] 
+00029450: 3d20 6466 5b63 6f6c 5d2e 7661 6c75 6573  = df[col].values
+00029460: 0a20 2020 2072 6574 7572 6e20 6469 6374  .    return dict
+00029470: 2864 6174 613d 2869 6e64 6578 2c20 7661  (data=(index, va
+00029480: 6c75 6529 2c20 636f 6f72 6473 3d63 6f6f  lue), coords=coo
+00029490: 7264 7329 0a0a 0a64 6566 2066 726f 6d5f  rds)...def from_
+000294a0: 7061 6e64 6173 2864 663a 2027 7064 2e44  pandas(df: 'pd.D
+000294b0: 6174 6146 7261 6d65 272c 2063 6f6f 7264  ataFrame', coord
+000294c0: 733a 2055 6e69 6f6e 5b44 6963 745b 7374  s: Union[Dict[st
+000294d0: 722c 206e 702e 6e64 6172 7261 795d 2c20  r, np.ndarray], 
+000294e0: 4e6f 6e65 5d20 3d20 4e6f 6e65 2920 2d3e  None] = None) ->
+000294f0: 2041 7272 6179 3a0a 2020 2020 2222 220a   Array:.    """.
+00029500: 2020 2020 4372 6561 7465 2061 6e20 4172      Create an Ar
+00029510: 7261 7920 6f62 6a65 6374 2066 726f 6d20  ray object from 
+00029520: 6120 7061 6e64 6173 2044 6174 6146 7261  a pandas DataFra
+00029530: 6d65 2e0a 0a20 2020 2041 7267 733a 0a20  me...    Args:. 
+00029540: 2020 2020 2020 2064 663a 2054 6865 2070         df: The p
+00029550: 616e 6461 7320 4461 7461 4672 616d 6520  andas DataFrame 
+00029560: 746f 2063 6f6e 7665 7274 2e0a 2020 2020  to convert..    
+00029570: 2020 2020 636f 6f72 6473 3a20 5468 6520      coords: The 
+00029580: 636f 6f72 6469 6e61 7465 7320 666f 7220  coordinates for 
+00029590: 7468 6520 4172 7261 792e 0a0a 2020 2020  the Array...    
+000295a0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+000295b0: 2041 6e20 4172 7261 7920 6f62 6a65 6374   An Array object
+000295c0: 2063 7265 6174 6564 2066 726f 6d20 7468   created from th
+000295d0: 6520 7061 6e64 6173 2044 6174 6146 7261  e pandas DataFra
+000295e0: 6d65 2e0a 0a20 2020 2045 7861 6d70 6c65  me...    Example
+000295f0: 3a0a 2020 2020 2020 2020 6060 6070 7974  :.        ```pyt
+00029600: 686f 6e0a 2020 2020 2020 2020 3e3e 3e20  hon.        >>> 
+00029610: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
+00029620: 6528 7b27 6469 6d31 273a 205b 2761 272c  e({'dim1': ['a',
+00029630: 2027 6227 5d2c 2027 6469 6d32 273a 205b   'b'], 'dim2': [
+00029640: 312c 2032 5d2c 2027 7661 6c75 6527 3a20  1, 2], 'value': 
+00029650: 5b31 302c 2032 305d 7d29 0a20 2020 2020  [10, 20]}).     
+00029660: 2020 203e 3e3e 2063 6f6f 7264 7320 3d20     >>> coords = 
+00029670: 7b27 6469 6d31 273a 205b 2761 272c 2027  {'dim1': ['a', '
+00029680: 6227 5d2c 2027 6469 6d32 273a 205b 312c  b'], 'dim2': [1,
+00029690: 2032 5d7d 0a20 2020 2020 2020 203e 3e3e   2]}.        >>>
+000296a0: 2061 7272 203d 2066 726f 6d5f 7061 6e64   arr = from_pand
+000296b0: 6173 2864 662c 2063 6f6f 7264 7329 0a20  as(df, coords). 
+000296c0: 2020 2020 2020 203e 3e3e 2061 7272 0a20         >>> arr. 
+000296d0: 2020 2020 2020 2041 7272 6179 2864 6174         Array(dat
+000296e0: 613d 6172 7261 7928 5b5b 3130 2c20 2030  a=array([[10,  0
+000296f0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00029700: 2020 5b20 302c 2032 305d 5d29 2c20 636f    [ 0, 20]]), co
+00029710: 6f72 6473 3d7b 2764 696d 3127 3a20 6172  ords={'dim1': ar
+00029720: 7261 7928 5b27 6127 2c20 2762 275d 2c20  ray(['a', 'b'], 
+00029730: 6474 7970 653d 6f62 6a65 6374 292c 2027  dtype=object), '
+00029740: 6469 6d32 273a 2061 7272 6179 285b 312c  dim2': array([1,
+00029750: 2032 5d29 7d29 0a0a 2020 2020 2020 2020   2])})..        
+00029760: 6060 600a 2020 2020 2222 220a 2020 2020  ```.    """.    
+00029770: 7265 7475 726e 2041 7272 6179 282a 2a5f  return Array(**_
+00029780: 7061 6e64 6173 5f74 6f5f 6172 7261 7928  pandas_to_array(
+00029790: 6466 2c20 636f 6f72 6473 3d63 6f6f 7264  df, coords=coord
+000297a0: 7329 290a 0a0a 6465 6620 5f70 6f6c 6172  s))...def _polar
+000297b0: 735f 746f 5f61 7272 6179 2864 663a 2027  s_to_array(df: '
+000297c0: 706c 2e44 6174 6146 7261 6d65 272c 2063  pl.DataFrame', c
+000297d0: 6f6f 7264 733a 2055 6e69 6f6e 5b44 6963  oords: Union[Dic
+000297e0: 745b 7374 722c 206e 702e 6e64 6172 7261  t[str, np.ndarra
+000297f0: 795d 2c20 4e6f 6e65 5d20 3d20 4e6f 6e65  y], None] = None
+00029800: 2920 2d3e 2044 6963 745b 7374 722c 2055  ) -> Dict[str, U
+00029810: 6e69 6f6e 5b54 7570 6c65 5b44 6963 745b  nion[Tuple[Dict[
+00029820: 7374 722c 206e 702e 6e64 6172 7261 795d  str, np.ndarray]
+00029830: 2c20 6e70 2e6e 6461 7272 6179 5d2c 2044  , np.ndarray], D
+00029840: 6963 745b 7374 722c 206e 702e 6e64 6172  ict[str, np.ndar
+00029850: 7261 795d 5d5d 3a0a 2020 2020 2222 220a  ray]]]:.    """.
+00029860: 2020 2020 436f 6e76 6572 7420 6120 706f      Convert a po
+00029870: 6c61 7273 2044 6174 6146 7261 6d65 2074  lars DataFrame t
+00029880: 6f20 616e 2041 7272 6179 2064 6963 7469  o an Array dicti
+00029890: 6f6e 6172 792e 0a0a 2020 2020 4172 6773  onary...    Args
+000298a0: 3a0a 2020 2020 2020 2020 6466 3a20 5468  :.        df: Th
+000298b0: 6520 706f 6c61 7273 2044 6174 6146 7261  e polars DataFra
+000298c0: 6d65 2074 6f20 636f 6e76 6572 742e 0a20  me to convert.. 
+000298d0: 2020 2020 2020 2063 6f6f 7264 733a 2054         coords: T
+000298e0: 6865 2063 6f6f 7264 696e 6174 6573 2066  he coordinates f
+000298f0: 6f72 2074 6865 2041 7272 6179 2e0a 0a20  or the Array... 
+00029900: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
+00029910: 2020 2020 4120 6469 6374 696f 6e61 7279      A dictionary
+00029920: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
+00029930: 6520 4172 7261 7920 6461 7461 2061 6e64  e Array data and
+00029940: 2063 6f6f 7264 696e 6174 6573 2e0a 0a20   coordinates... 
+00029950: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
+00029960: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
+00029970: 2020 2020 2020 3e3e 3e20 6466 203d 2070        >>> df = p
+00029980: 6c2e 4461 7461 4672 616d 6528 7b27 6469  l.DataFrame({'di
+00029990: 6d31 273a 205b 2761 272c 2027 6227 5d2c  m1': ['a', 'b'],
+000299a0: 2027 6469 6d32 273a 205b 312c 2032 5d2c   'dim2': [1, 2],
+000299b0: 2027 7661 6c75 6527 3a20 5b31 302c 2032   'value': [10, 2
+000299c0: 305d 7d29 0a20 2020 2020 2020 203e 3e3e  0]}).        >>>
+000299d0: 2063 6f6f 7264 7320 3d20 7b27 6469 6d31   coords = {'dim1
+000299e0: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+000299f0: 6469 6d32 273a 205b 312c 2032 5d7d 0a20  dim2': [1, 2]}. 
+00029a00: 2020 2020 2020 203e 3e3e 2061 7272 6179         >>> array
+00029a10: 5f64 6963 7420 3d20 5f70 6f6c 6172 735f  _dict = _polars_
+00029a20: 746f 5f61 7272 6179 2864 662c 2063 6f6f  to_array(df, coo
+00029a30: 7264 7329 0a20 2020 2020 2020 203e 3e3e  rds).        >>>
+00029a40: 2061 7272 6179 5f64 6963 740a 2020 2020   array_dict.    
+00029a50: 2020 2020 7b27 6461 7461 273a 2028 7b27      {'data': ({'
+00029a60: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
+00029a70: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
+00029a80: 5d7d 2c20 6172 7261 7928 5b31 302c 2032  ]}, array([10, 2
+00029a90: 305d 2929 2c20 2763 6f6f 7264 7327 3a20  0])), 'coords': 
+00029aa0: 7b27 6469 6d31 273a 205b 2761 272c 2027  {'dim1': ['a', '
+00029ab0: 6227 5d2c 2027 6469 6d32 273a 205b 312c  b'], 'dim2': [1,
+00029ac0: 2032 5d7d 7d0a 0a20 2020 2020 2020 2060   2]}}..        `
+00029ad0: 6060 0a20 2020 2022 2222 0a20 2020 2061  ``.    """.    a
+00029ae0: 7373 6572 7420 2276 616c 7565 2220 696e  ssert "value" in
+00029af0: 2064 662e 636f 6c75 6d6e 732c 2022 436f   df.columns, "Co
+00029b00: 6c75 6d6e 206e 616d 6564 2027 7661 6c75  lumn named 'valu
+00029b10: 6527 206d 7573 7420 6578 6973 7422 0a20  e' must exist". 
+00029b20: 2020 2076 616c 7565 203d 2064 665b 2276     value = df["v
+00029b30: 616c 7565 225d 2e74 6f5f 6e75 6d70 7928  alue"].to_numpy(
+00029b40: 290a 2020 2020 6466 203d 2064 662e 6472  ).    df = df.dr
+00029b50: 6f70 2822 7661 6c75 6522 290a 2020 2020  op("value").    
+00029b60: 696e 6465 7820 3d20 6466 2e74 6f5f 6469  index = df.to_di
+00029b70: 6374 2861 735f 7365 7269 6573 3d46 616c  ct(as_series=Fal
+00029b80: 7365 290a 2020 2020 7265 7475 726e 2064  se).    return d
+00029b90: 6963 7428 6461 7461 3d28 696e 6465 782c  ict(data=(index,
+00029ba0: 2076 616c 7565 292c 2063 6f6f 7264 733d   value), coords=
+00029bb0: 636f 6f72 6473 290a 0a0a 6465 6620 6672  coords)...def fr
+00029bc0: 6f6d 5f70 6f6c 6172 7328 6466 3a20 2770  om_polars(df: 'p
+00029bd0: 6c2e 4461 7461 4672 616d 6527 2c20 636f  l.DataFrame', co
+00029be0: 6f72 6473 3a20 556e 696f 6e5b 4469 6374  ords: Union[Dict
+00029bf0: 5b73 7472 2c20 6e70 2e6e 6461 7272 6179  [str, np.ndarray
+00029c00: 5d2c 204e 6f6e 655d 203d 204e 6f6e 6529  ], None] = None)
+00029c10: 202d 3e20 4172 7261 793a 0a20 2020 2022   -> Array:.    "
+00029c20: 2222 0a20 2020 2043 7265 6174 6520 616e  "".    Create an
+00029c30: 2041 7272 6179 206f 626a 6563 7420 6672   Array object fr
+00029c40: 6f6d 2061 2070 6f6c 6172 7320 4461 7461  om a polars Data
+00029c50: 4672 616d 652e 0a0a 2020 2020 4172 6773  Frame...    Args
+00029c60: 3a0a 2020 2020 2020 2020 6466 3a20 5468  :.        df: Th
+00029c70: 6520 706f 6c61 7273 2044 6174 6146 7261  e polars DataFra
+00029c80: 6d65 2074 6f20 636f 6e76 6572 742e 0a20  me to convert.. 
+00029c90: 2020 2020 2020 2063 6f6f 7264 733a 2054         coords: T
+00029ca0: 6865 2063 6f6f 7264 696e 6174 6573 2066  he coordinates f
+00029cb0: 6f72 2074 6865 2041 7272 6179 2e0a 0a20  or the Array... 
+00029cc0: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
+00029cd0: 2020 2020 416e 2041 7272 6179 206f 626a      An Array obj
+00029ce0: 6563 7420 6372 6561 7465 6420 6672 6f6d  ect created from
+00029cf0: 2074 6865 2070 6f6c 6172 7320 4461 7461   the polars Data
+00029d00: 4672 616d 652e 0a0a 2020 2020 4578 616d  Frame...    Exam
+00029d10: 706c 653a 0a20 2020 2020 2020 2060 6060  ple:.        ```
+00029d20: 7079 7468 6f6e 0a20 2020 2020 2020 203e  python.        >
+00029d30: 3e3e 2064 6620 3d20 706c 2e44 6174 6146  >> df = pl.DataF
+00029d40: 7261 6d65 287b 2764 696d 3127 3a20 5b27  rame({'dim1': ['
+00029d50: 6127 2c20 2762 275d 2c20 2764 696d 3227  a', 'b'], 'dim2'
+00029d60: 3a20 5b31 2c20 325d 2c20 2776 616c 7565  : [1, 2], 'value
+00029d70: 273a 205b 3130 2c20 3230 5d7d 290a 2020  ': [10, 20]}).  
+00029d80: 2020 2020 2020 3e3e 3e20 636f 6f72 6473        >>> coords
+00029d90: 203d 207b 2764 696d 3127 3a20 5b27 6127   = {'dim1': ['a'
+00029da0: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
+00029db0: 5b31 2c20 325d 7d0a 2020 2020 2020 2020  [1, 2]}.        
+00029dc0: 3e3e 3e20 6172 7220 3d20 6672 6f6d 5f70  >>> arr = from_p
+00029dd0: 6f6c 6172 7328 6466 2c20 636f 6f72 6473  olars(df, coords
+00029de0: 290a 2020 2020 2020 2020 3e3e 3e20 6172  ).        >>> ar
+00029df0: 720a 2020 2020 2020 2020 4172 7261 7928  r.        Array(
+00029e00: 6461 7461 3d61 7272 6179 285b 5b31 302c  data=array([[10,
+00029e10: 2020 305d 2c0a 2020 2020 2020 2020 2020    0],.          
+00029e20: 2020 2020 205b 2030 2c20 3230 5d5d 292c       [ 0, 20]]),
+00029e30: 2063 6f6f 7264 733d 7b27 6469 6d31 273a   coords={'dim1':
+00029e40: 2061 7272 6179 285b 2761 272c 2027 6227   array(['a', 'b'
+00029e50: 5d2c 2064 7479 7065 3d6f 626a 6563 7429  ], dtype=object)
+00029e60: 2c20 2764 696d 3227 3a20 6172 7261 7928  , 'dim2': array(
+00029e70: 5b31 2c20 325d 297d 290a 0a20 2020 2020  [1, 2])})..     
+00029e80: 2020 2060 6060 0a20 2020 2022 2222 0a20     ```.    """. 
+00029e90: 2020 2072 6574 7572 6e20 4172 7261 7928     return Array(
+00029ea0: 2a2a 5f70 6f6c 6172 735f 746f 5f61 7272  **_polars_to_arr
+00029eb0: 6179 2864 662c 2063 6f6f 7264 733d 636f  ay(df, coords=co
+00029ec0: 6f72 6473 2929 0a0a 0a64 6566 2066 726f  ords))...def fro
+00029ed0: 6d5f 6665 6174 6865 725f 746f 5f64 6963  m_feather_to_dic
+00029ee0: 7428 7061 7468 3a20 7374 722c 2075 7365  t(path: str, use
+00029ef0: 5f74 6872 6561 6473 3a20 626f 6f6c 203d  _threads: bool =
+00029f00: 2054 7275 652c 2077 6974 685f 3a20 556e   True, with_: Un
+00029f10: 696f 6e5b 7374 722c 204e 6f6e 655d 203d  ion[str, None] =
+00029f20: 204e 6f6e 6529 202d 3e20 4469 6374 5b73   None) -> Dict[s
+00029f30: 7472 2c20 556e 696f 6e5b 5475 706c 655b  tr, Union[Tuple[
+00029f40: 4469 6374 5b73 7472 2c20 6e70 2e6e 6461  Dict[str, np.nda
+00029f50: 7272 6179 5d2c 206e 702e 6e64 6172 7261  rray], np.ndarra
+00029f60: 795d 2c20 4469 6374 5b73 7472 2c20 6e70  y], Dict[str, np
+00029f70: 2e6e 6461 7272 6179 5d5d 5d3a 0a20 2020  .ndarray]]]:.   
+00029f80: 2022 2222 0a20 2020 204c 6f61 6420 616e   """.    Load an
+00029f90: 2041 7272 6179 2064 6963 7469 6f6e 6172   Array dictionar
+00029fa0: 7920 6672 6f6d 2061 2046 6561 7468 6572  y from a Feather
+00029fb0: 2066 696c 652e 0a0a 2020 2020 4172 6773   file...    Args
+00029fc0: 3a0a 2020 2020 2020 2020 7061 7468 3a20  :.        path: 
+00029fd0: 5468 6520 7061 7468 2074 6f20 7468 6520  The path to the 
+00029fe0: 4665 6174 6865 7220 6669 6c65 2e0a 2020  Feather file..  
+00029ff0: 2020 2020 2020 7573 655f 7468 7265 6164        use_thread
+0002a000: 733a 2057 6865 7468 6572 2074 6f20 7573  s: Whether to us
+0002a010: 6520 7468 7265 6164 7320 7768 656e 2072  e threads when r
+0002a020: 6561 6469 6e67 2074 6865 2046 6561 7468  eading the Feath
+0002a030: 6572 2066 696c 652e 0a20 2020 2020 2020  er file..       
+0002a040: 2077 6974 685f 3a20 5468 6520 6c69 6272   with_: The libr
+0002a050: 6172 7920 746f 2075 7365 2066 6f72 206c  ary to use for l
+0002a060: 6f61 6469 6e67 2074 6865 2046 6561 7468  oading the Feath
+0002a070: 6572 2066 696c 6520 2827 7061 6e64 6173  er file ('pandas
+0002a080: 2720 6f72 2027 706f 6c61 7273 2729 2e0a  ' or 'polars')..
+0002a090: 0a20 2020 2052 6574 7572 6e73 3a0a 2020  .    Returns:.  
+0002a0a0: 2020 2020 2020 4120 6469 6374 696f 6e61        A dictiona
+0002a0b0: 7279 2072 6570 7265 7365 6e74 696e 6720  ry representing 
+0002a0c0: 7468 6520 4172 7261 7920 6461 7461 2061  the Array data a
+0002a0d0: 6e64 2063 6f6f 7264 696e 6174 6573 206c  nd coordinates l
+0002a0e0: 6f61 6465 6420 6672 6f6d 2074 6865 2046  oaded from the F
+0002a0f0: 6561 7468 6572 2066 696c 652e 0a0a 2020  eather file...  
+0002a100: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
+0002a110: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+0002a120: 2020 2020 203e 3e3e 2061 7272 6179 5f64       >>> array_d
+0002a130: 6963 7420 3d20 6672 6f6d 5f66 6561 7468  ict = from_feath
+0002a140: 6572 5f74 6f5f 6469 6374 2827 7465 7374  er_to_dict('test
+0002a150: 732f 6461 7461 2f61 7272 6179 2e66 6561  s/data/array.fea
+0002a160: 7468 6572 272c 2077 6974 685f 3d27 7061  ther', with_='pa
+0002a170: 6e64 6173 2729 0a20 2020 2020 2020 203e  ndas').        >
+0002a180: 3e3e 2061 7272 6179 5f64 6963 740a 2020  >> array_dict.  
+0002a190: 2020 2020 2020 7b27 6461 7461 273a 2028        {'data': (
+0002a1a0: 7b27 6469 6d31 273a 2061 7272 6179 285b  {'dim1': array([
+0002a1b0: 2761 272c 2027 6227 5d2c 2064 7479 7065  'a', 'b'], dtype
+0002a1c0: 3d6f 626a 6563 7429 2c20 2764 696d 3227  =object), 'dim2'
+0002a1d0: 3a20 6172 7261 7928 5b31 2c20 325d 297d  : array([1, 2])}
+0002a1e0: 2c20 6172 7261 7928 5b31 302c 2032 305d  , array([10, 20]
+0002a1f0: 2929 2c20 2763 6f6f 7264 7327 3a20 7b27  )), 'coords': {'
+0002a200: 6469 6d31 273a 205b 2761 272c 2027 6227  dim1': ['a', 'b'
+0002a210: 5d2c 2027 6469 6d32 273a 205b 312c 2032  ], 'dim2': [1, 2
+0002a220: 5d7d 7d0a 0a20 2020 2020 2020 2060 6060  ]}}..        ```
+0002a230: 0a20 2020 2022 2222 0a20 2020 2061 7373  .    """.    ass
+0002a240: 6572 7420 7769 7468 5f20 696e 205b 2270  ert with_ in ["p
+0002a250: 616e 6461 7322 2c20 2270 6f6c 6172 7322  andas", "polars"
+0002a260: 5d0a 2020 2020 7265 7374 6f72 6564 5f74  ].    restored_t
+0002a270: 6162 6c65 203d 2066 6561 7468 6572 2e72  able = feather.r
+0002a280: 6561 645f 7461 626c 6528 0a20 2020 2020  ead_table(.     
+0002a290: 2020 2070 6174 682c 2075 7365 5f74 6872     path, use_thr
+0002a2a0: 6561 6473 3d75 7365 5f74 6872 6561 6473  eads=use_threads
+0002a2b0: 2c20 6d65 6d6f 7279 5f6d 6170 3d54 7275  , memory_map=Tru
+0002a2c0: 6529 0a20 2020 2063 6f6c 756d 6e5f 6e61  e).    column_na
+0002a2d0: 6d65 7320 3d20 7265 7374 6f72 6564 5f74  mes = restored_t
+0002a2e0: 6162 6c65 2e63 6f6c 756d 6e5f 6e61 6d65  able.column_name
+0002a2f0: 730a 2020 2020 6173 7365 7274 2022 7661  s.    assert "va
+0002a300: 6c75 6522 2069 6e20 636f 6c75 6d6e 5f6e  lue" in column_n
+0002a310: 616d 6573 2c20 2243 6f6c 756d 6e20 6e61  ames, "Column na
+0002a320: 6d65 6420 2776 616c 7565 2720 6d75 7374  med 'value' must
+0002a330: 2065 7869 7374 220a 2020 2020 6375 7374   exist".    cust
+0002a340: 6f6d 5f6d 6574 615f 6b65 7920 3d20 276b  om_meta_key = 'k
+0002a350: 6172 7261 7927 0a20 2020 2069 6620 6375  array'.    if cu
+0002a360: 7374 6f6d 5f6d 6574 615f 6b65 792e 656e  stom_meta_key.en
+0002a370: 636f 6465 2829 2069 6e20 7265 7374 6f72  code() in restor
+0002a380: 6564 5f74 6162 6c65 2e73 6368 656d 612e  ed_table.schema.
+0002a390: 6d65 7461 6461 7461 3a0a 2020 2020 2020  metadata:.      
+0002a3a0: 2020 7265 7374 6f72 6564 5f6d 6574 615f    restored_meta_
+0002a3b0: 6a73 6f6e 203d 2072 6573 746f 7265 645f  json = restored_
+0002a3c0: 7461 626c 652e 7363 6865 6d61 2e6d 6574  table.schema.met
+0002a3d0: 6164 6174 615b 6375 7374 6f6d 5f6d 6574  adata[custom_met
+0002a3e0: 615f 6b65 792e 656e 636f 6465 280a 2020  a_key.encode(.  
+0002a3f0: 2020 2020 2020 295d 0a20 2020 2020 2020        )].       
+0002a400: 2072 6573 746f 7265 645f 6d65 7461 203d   restored_meta =
+0002a410: 206a 736f 6e2e 6c6f 6164 7328 7265 7374   json.loads(rest
+0002a420: 6f72 6564 5f6d 6574 615f 6a73 6f6e 290a  ored_meta_json).
+0002a430: 2020 2020 2020 2020 6173 7365 7274 2022          assert "
+0002a440: 636f 6f72 6473 2220 696e 2072 6573 746f  coords" in resto
+0002a450: 7265 645f 6d65 7461 0a20 2020 2020 2020  red_meta.       
+0002a460: 2069 6620 7769 7468 5f20 3d3d 2022 7061   if with_ == "pa
+0002a470: 6e64 6173 223a 0a20 2020 2020 2020 2020  ndas":.         
+0002a480: 2020 2072 6574 7572 6e20 5f70 616e 6461     return _panda
+0002a490: 735f 746f 5f61 7272 6179 2864 663d 7265  s_to_array(df=re
+0002a4a0: 7374 6f72 6564 5f74 6162 6c65 2e74 6f5f  stored_table.to_
+0002a4b0: 7061 6e64 6173 2829 2c20 636f 6f72 6473  pandas(), coords
+0002a4c0: 3d72 6573 746f 7265 645f 6d65 7461 5b27  =restored_meta['
+0002a4d0: 636f 6f72 6473 275d 290a 2020 2020 2020  coords']).      
+0002a4e0: 2020 656c 6966 2077 6974 685f 203d 3d20    elif with_ == 
+0002a4f0: 2270 6f6c 6172 7322 3a0a 2020 2020 2020  "polars":.      
+0002a500: 2020 2020 2020 7265 7475 726e 205f 706f        return _po
+0002a510: 6c61 7273 5f74 6f5f 6172 7261 7928 6466  lars_to_array(df
+0002a520: 3d70 6c2e 6672 6f6d 5f61 7272 6f77 2872  =pl.from_arrow(r
+0002a530: 6573 746f 7265 645f 7461 626c 6529 2c20  estored_table), 
+0002a540: 636f 6f72 6473 3d72 6573 746f 7265 645f  coords=restored_
+0002a550: 6d65 7461 5b27 636f 6f72 6473 275d 290a  meta['coords']).
+0002a560: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002a570: 2020 6966 2077 6974 685f 203d 3d20 2270    if with_ == "p
+0002a580: 616e 6461 7322 3a0a 2020 2020 2020 2020  andas":.        
+0002a590: 2020 2020 7265 7475 726e 205f 7061 6e64      return _pand
+0002a5a0: 6173 5f74 6f5f 6172 7261 7928 6466 3d72  as_to_array(df=r
+0002a5b0: 6573 746f 7265 645f 7461 626c 652e 746f  estored_table.to
+0002a5c0: 5f70 616e 6461 7328 7370 6c69 745f 626c  _pandas(split_bl
+0002a5d0: 6f63 6b73 3d54 7275 652c 2073 656c 665f  ocks=True, self_
+0002a5e0: 6465 7374 7275 6374 3d54 7275 6529 2c20  destruct=True), 
+0002a5f0: 636f 6f72 6473 3d4e 6f6e 6529 0a20 2020  coords=None).   
+0002a600: 2020 2020 2065 6c69 6620 7769 7468 5f20       elif with_ 
+0002a610: 3d3d 2022 706f 6c61 7273 223a 0a20 2020  == "polars":.   
+0002a620: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002a630: 5f70 6f6c 6172 735f 746f 5f61 7272 6179  _polars_to_array
+0002a640: 2864 663d 706c 2e66 726f 6d5f 6172 726f  (df=pl.from_arro
+0002a650: 7728 7265 7374 6f72 6564 5f74 6162 6c65  w(restored_table
+0002a660: 292c 2063 6f6f 7264 733d 4e6f 6e65 290a  ), coords=None).
+0002a670: 0a0a 6465 6620 6672 6f6d 5f66 6561 7468  ..def from_feath
+0002a680: 6572 2870 6174 683a 2073 7472 2c20 7573  er(path: str, us
+0002a690: 655f 7468 7265 6164 733a 2062 6f6f 6c20  e_threads: bool 
+0002a6a0: 3d20 5472 7565 2c20 7769 7468 5f3a 2073  = True, with_: s
+0002a6b0: 7472 203d 2027 7061 6e64 6173 2729 202d  tr = 'pandas') -
+0002a6c0: 3e20 4172 7261 793a 0a20 2020 2022 2222  > Array:.    """
+0002a6d0: 0a20 2020 204c 6f61 6420 616e 2041 7272  .    Load an Arr
+0002a6e0: 6179 206f 626a 6563 7420 6672 6f6d 2061  ay object from a
+0002a6f0: 2046 6561 7468 6572 2066 696c 652e 0a0a   Feather file...
+0002a700: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0002a710: 2020 7061 7468 3a20 5468 6520 7061 7468    path: The path
+0002a720: 2074 6f20 7468 6520 4665 6174 6865 7220   to the Feather 
+0002a730: 6669 6c65 2e0a 2020 2020 2020 2020 7573  file..        us
+0002a740: 655f 7468 7265 6164 733a 2057 6865 7468  e_threads: Wheth
+0002a750: 6572 2074 6f20 7573 6520 7468 7265 6164  er to use thread
+0002a760: 7320 7768 656e 2072 6561 6469 6e67 2074  s when reading t
+0002a770: 6865 2046 6561 7468 6572 2066 696c 652e  he Feather file.
+0002a780: 0a20 2020 2020 2020 2077 6974 685f 3a20  .        with_: 
+0002a790: 5468 6520 6c69 6272 6172 7920 746f 2075  The library to u
+0002a7a0: 7365 2066 6f72 206c 6f61 6469 6e67 2074  se for loading t
+0002a7b0: 6865 2046 6561 7468 6572 2066 696c 6520  he Feather file 
+0002a7c0: 2827 7061 6e64 6173 2720 6f72 2027 706f  ('pandas' or 'po
+0002a7d0: 6c61 7273 2729 2e0a 0a20 2020 2052 6574  lars')...    Ret
+0002a7e0: 7572 6e73 3a0a 2020 2020 2020 2020 416e  urns:.        An
+0002a7f0: 2041 7272 6179 206f 626a 6563 7420 6c6f   Array object lo
+0002a800: 6164 6564 2066 726f 6d20 7468 6520 4665  aded from the Fe
+0002a810: 6174 6865 7220 6669 6c65 2e0a 0a20 2020  ather file...   
+0002a820: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
+0002a830: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
+0002a840: 2020 2020 3e3e 3e20 6172 7220 3d20 6672      >>> arr = fr
+0002a850: 6f6d 5f66 6561 7468 6572 2827 7465 7374  om_feather('test
+0002a860: 732f 6461 7461 2f61 7272 6179 2e66 6561  s/data/array.fea
+0002a870: 7468 6572 272c 2077 6974 685f 3d27 7061  ther', with_='pa
+0002a880: 6e64 6173 2729 0a20 2020 2020 2020 203e  ndas').        >
+0002a890: 3e3e 2061 7272 0a20 2020 2020 2020 2041  >> arr.        A
+0002a8a0: 7272 6179 2864 6174 613d 6172 7261 7928  rray(data=array(
+0002a8b0: 5b5b 3130 2c20 2030 5d2c 0a20 2020 2020  [[10,  0],.     
+0002a8c0: 2020 2020 2020 2020 2020 5b20 302c 2032            [ 0, 2
+0002a8d0: 305d 5d29 2c20 636f 6f72 6473 3d7b 2764  0]]), coords={'d
+0002a8e0: 696d 3127 3a20 6172 7261 7928 5b27 6127  im1': array(['a'
+0002a8f0: 2c20 2762 275d 2c20 6474 7970 653d 6f62  , 'b'], dtype=ob
+0002a900: 6a65 6374 292c 2027 6469 6d32 273a 2061  ject), 'dim2': a
+0002a910: 7272 6179 285b 312c 2032 5d29 7d29 0a0a  rray([1, 2])})..
+0002a920: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+0002a930: 2222 220a 2020 2020 7265 7475 726e 2041  """.    return A
+0002a940: 7272 6179 282a 2a66 726f 6d5f 6665 6174  rray(**from_feat
+0002a950: 6865 725f 746f 5f64 6963 7428 7061 7468  her_to_dict(path
+0002a960: 3d70 6174 682c 2075 7365 5f74 6872 6561  =path, use_threa
+0002a970: 6473 3d75 7365 5f74 6872 6561 6473 2c20  ds=use_threads, 
+0002a980: 7769 7468 5f3d 7769 7468 5f29 290a 0a0a  with_=with_))...
+0002a990: 6465 6620 5f63 7376 5f74 6f5f 6172 7261  def _csv_to_arra
+0002a9a0: 7928 7061 7468 3a20 7374 722c 2063 6f6f  y(path: str, coo
+0002a9b0: 7264 733a 2055 6e69 6f6e 5b44 6963 745b  rds: Union[Dict[
+0002a9c0: 7374 722c 206e 702e 6e64 6172 7261 795d  str, np.ndarray]
+0002a9d0: 2c20 4e6f 6e65 5d20 3d20 4e6f 6e65 2c20  , None] = None, 
+0002a9e0: 6465 6c69 6d69 7465 723a 2073 7472 203d  delimiter: str =
+0002a9f0: 2027 2c27 2c20 656e 636f 6469 6e67 3a20   ',', encoding: 
+0002aa00: 7374 7220 3d20 2775 7466 2d38 2729 202d  str = 'utf-8') -
+0002aa10: 3e20 4469 6374 5b73 7472 2c20 556e 696f  > Dict[str, Unio
+0002aa20: 6e5b 5475 706c 655b 4469 6374 5b73 7472  n[Tuple[Dict[str
+0002aa30: 2c20 6e70 2e6e 6461 7272 6179 5d2c 206e  , np.ndarray], n
+0002aa40: 702e 6e64 6172 7261 795d 2c20 4469 6374  p.ndarray], Dict
+0002aa50: 5b73 7472 2c20 6e70 2e6e 6461 7272 6179  [str, np.ndarray
+0002aa60: 5d5d 5d3a 0a20 2020 2022 2222 0a20 2020  ]]]:.    """.   
+0002aa70: 2043 6f6e 7665 7274 2061 2043 5356 2066   Convert a CSV f
+0002aa80: 696c 6520 746f 2061 6e20 4172 7261 7920  ile to an Array 
+0002aa90: 6469 6374 696f 6e61 7279 2e0a 0a20 2020  dictionary...   
+0002aaa0: 2041 7267 733a 0a20 2020 2020 2020 2070   Args:.        p
+0002aab0: 6174 683a 2054 6865 2070 6174 6820 746f  ath: The path to
+0002aac0: 2074 6865 2043 5356 2066 696c 652e 0a20   the CSV file.. 
+0002aad0: 2020 2020 2020 2063 6f6f 7264 733a 2054         coords: T
+0002aae0: 6865 2063 6f6f 7264 696e 6174 6573 2066  he coordinates f
+0002aaf0: 6f72 2074 6865 2041 7272 6179 2e0a 2020  or the Array..  
+0002ab00: 2020 2020 2020 6465 6c69 6d69 7465 723a        delimiter:
+0002ab10: 2054 6865 2064 656c 696d 6974 6572 2075   The delimiter u
+0002ab20: 7365 6420 696e 2074 6865 2043 5356 2066  sed in the CSV f
+0002ab30: 696c 652e 0a20 2020 2020 2020 2065 6e63  ile..        enc
+0002ab40: 6f64 696e 673a 2054 6865 2065 6e63 6f64  oding: The encod
+0002ab50: 696e 6720 6f66 2074 6865 2043 5356 2066  ing of the CSV f
+0002ab60: 696c 652e 0a0a 2020 2020 5265 7475 726e  ile...    Return
+0002ab70: 733a 0a20 2020 2020 2020 2041 2064 6963  s:.        A dic
+0002ab80: 7469 6f6e 6172 7920 7265 7072 6573 656e  tionary represen
+0002ab90: 7469 6e67 2074 6865 2041 7272 6179 2064  ting the Array d
+0002aba0: 6174 6120 616e 6420 636f 6f72 6469 6e61  ata and coordina
+0002abb0: 7465 732e 0a0a 2020 2020 4578 616d 706c  tes...    Exampl
+0002abc0: 653a 0a20 2020 2020 2020 2060 6060 7079  e:.        ```py
+0002abd0: 7468 6f6e 0a20 2020 2020 2020 203e 3e3e  thon.        >>>
+0002abe0: 2063 6f6f 7264 7320 3d20 7b27 6469 6d31   coords = {'dim1
+0002abf0: 273a 205b 2761 272c 2027 6227 5d2c 2027  ': ['a', 'b'], '
+0002ac00: 6469 6d32 273a 205b 312c 2032 5d7d 0a20  dim2': [1, 2]}. 
+0002ac10: 2020 2020 2020 203e 3e3e 2061 7272 6179         >>> array
+0002ac20: 5f64 6963 7420 3d20 5f63 7376 5f74 6f5f  _dict = _csv_to_
+0002ac30: 6172 7261 7928 2774 6573 7473 2f64 6174  array('tests/dat
+0002ac40: 612f 6172 7261 792e 6373 7627 2c20 636f  a/array.csv', co
+0002ac50: 6f72 6473 3d63 6f6f 7264 7329 0a20 2020  ords=coords).   
+0002ac60: 2020 2020 203e 3e3e 2061 7272 6179 5f64       >>> array_d
+0002ac70: 6963 740a 2020 2020 2020 2020 7b27 6461  ict.        {'da
+0002ac80: 7461 273a 2028 7b27 6469 6d31 273a 2061  ta': ({'dim1': a
+0002ac90: 7272 6179 285b 2761 272c 2027 6227 5d2c  rray(['a', 'b'],
+0002aca0: 2064 7479 7065 3d6f 626a 6563 7429 2c20   dtype=object), 
+0002acb0: 2764 696d 3227 3a20 6172 7261 7928 5b31  'dim2': array([1
+0002acc0: 2c20 325d 297d 2c20 6172 7261 7928 5b31  , 2])}, array([1
+0002acd0: 302c 2032 305d 2929 2c20 2763 6f6f 7264  0, 20])), 'coord
+0002ace0: 7327 3a20 7b27 6469 6d31 273a 205b 2761  s': {'dim1': ['a
+0002acf0: 272c 2027 6227 5d2c 2027 6469 6d32 273a  ', 'b'], 'dim2':
+0002ad00: 205b 312c 2032 5d7d 7d0a 0a20 2020 2020   [1, 2]}}..     
+0002ad10: 2020 2060 6060 0a20 2020 2022 2222 0a20     ```.    """. 
+0002ad20: 2020 2077 6974 6820 6f70 656e 2866 696c     with open(fil
+0002ad30: 653d 7061 7468 2c20 6d6f 6465 3d27 7227  e=path, mode='r'
+0002ad40: 2c20 656e 636f 6469 6e67 3d65 6e63 6f64  , encoding=encod
+0002ad50: 696e 6729 2061 7320 663a 0a20 2020 2020  ing) as f:.     
+0002ad60: 2020 2072 6561 6465 7220 3d20 6373 762e     reader = csv.
+0002ad70: 4469 6374 5265 6164 6572 2866 2c20 6465  DictReader(f, de
+0002ad80: 6c69 6d69 7465 723d 6465 6c69 6d69 7465  limiter=delimite
+0002ad90: 7229 0a20 2020 2020 2020 2069 6e64 6578  r).        index
+0002ada0: 203d 207b 7d0a 2020 2020 2020 2020 6865   = {}.        he
+0002adb0: 6164 696e 6773 203d 206e 6578 7428 7265  adings = next(re
+0002adc0: 6164 6572 290a 2020 2020 2020 2020 6173  ader).        as
+0002add0: 7365 7274 2022 7661 6c75 6522 2069 6e20  sert "value" in 
+0002ade0: 6865 6164 696e 6773 2c20 2243 6f6c 756d  headings, "Colum
+0002adf0: 6e20 6e61 6d65 6420 2776 616c 7565 2720  n named 'value' 
+0002ae00: 6d75 7374 2065 7869 7374 220a 2020 2020  must exist".    
+0002ae10: 2020 2020 666f 7220 692c 2063 6f6c 2069      for i, col i
+0002ae20: 6e20 656e 756d 6572 6174 6528 6865 6164  n enumerate(head
+0002ae30: 696e 6773 293a 0a20 2020 2020 2020 2020  ings):.         
+0002ae40: 2020 2066 6972 7374 5f76 616c 7565 5f73     first_value_s
+0002ae50: 7472 203d 2068 6561 6469 6e67 735b 636f  tr = headings[co
+0002ae60: 6c5d 0a20 2020 2020 2020 2020 2020 2073  l].            s
+0002ae70: 7472 5f73 7472 6970 203d 2066 6972 7374  tr_strip = first
+0002ae80: 5f76 616c 7565 5f73 7472 2e6c 7374 7269  _value_str.lstri
+0002ae90: 7028 272d 2729 0a20 2020 2020 2020 2020  p('-').         
+0002aea0: 2020 2069 6620 272e 2720 696e 2073 7472     if '.' in str
+0002aeb0: 5f73 7472 6970 3a0a 2020 2020 2020 2020  _strip:.        
+0002aec0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0002aed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aee0: 2066 6c6f 6174 2873 7472 5f73 7472 6970   float(str_strip
+0002aef0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002af00: 2020 2020 2020 6474 7970 6520 3d20 666c        dtype = fl
+0002af10: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
+0002af20: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
+0002af30: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
+0002af40: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
+0002af50: 203d 206e 702e 6f62 6a65 6374 5f0a 2020   = np.object_.  
+0002af60: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0002af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af80: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+0002af90: 2020 2020 2020 2020 2069 6e74 2873 7472           int(str
+0002afa0: 5f73 7472 6970 290a 2020 2020 2020 2020  _strip).        
+0002afb0: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+0002afc0: 6520 3d20 696e 740a 2020 2020 2020 2020  e = int.        
+0002afd0: 2020 2020 2020 2020 6578 6365 7074 2056          except V
+0002afe0: 616c 7565 4572 726f 723a 0a20 2020 2020  alueError:.     
+0002aff0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0002b000: 7479 7065 203d 206e 702e 6f62 6a65 6374  type = np.object
+0002b010: 5f0a 2020 2020 2020 2020 2020 2020 6966  _.            if
+0002b020: 2063 6f6c 203d 3d20 2776 616c 7565 273a   col == 'value':
+0002b030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b040: 2061 7373 6572 7420 6474 7970 6520 3d3d   assert dtype ==
+0002b050: 2066 6c6f 6174 206f 7220 6474 7970 6520   float or dtype 
+0002b060: 3d3d 2069 6e74 2c20 6622 436f 6c75 6d6e  == int, f"Column
+0002b070: 206e 616d 6564 2027 7661 6c75 6527 206d   named 'value' m
+0002b080: 7573 7420 6265 206f 6620 7479 7065 2069  ust be of type i
+0002b090: 6e74 206f 7220 666c 6f61 742e 2047 6f74  nt or float. Got
+0002b0a0: 207b 6474 7970 657d 220a 2020 2020 2020   {dtype}".      
+0002b0b0: 2020 2020 2020 2020 2020 7661 6c75 6520            value 
+0002b0c0: 3d20 6e70 2e6c 6f61 6474 7874 280a 2020  = np.loadtxt(.  
+0002b0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b0e0: 2020 7061 7468 2c20 736b 6970 726f 7773    path, skiprows
+0002b0f0: 3d31 2c20 6465 6c69 6d69 7465 723d 6465  =1, delimiter=de
+0002b100: 6c69 6d69 7465 722c 2075 7365 636f 6c73  limiter, usecols
+0002b110: 3d69 2c20 6474 7970 653d 6474 7970 6529  =i, dtype=dtype)
+0002b120: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0002b130: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002b140: 2020 2069 6e64 6578 5b63 6f6c 5d20 3d20     index[col] = 
+0002b150: 6e70 2e6c 6f61 6474 7874 280a 2020 2020  np.loadtxt(.    
+0002b160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b170: 7061 7468 2c20 736b 6970 726f 7773 3d31  path, skiprows=1
+0002b180: 2c20 6465 6c69 6d69 7465 723d 6465 6c69  , delimiter=deli
+0002b190: 6d69 7465 722c 2075 7365 636f 6c73 3d69  miter, usecols=i
+0002b1a0: 2c20 6474 7970 653d 6474 7970 6529 0a20  , dtype=dtype). 
+0002b1b0: 2020 2072 6574 7572 6e20 6469 6374 2864     return dict(d
+0002b1c0: 6174 613d 2869 6e64 6578 2c20 7661 6c75  ata=(index, valu
+0002b1d0: 6529 2c20 636f 6f72 6473 3d63 6f6f 7264  e), coords=coord
+0002b1e0: 7329 0a0a 0a64 6566 2066 726f 6d5f 6373  s)...def from_cs
+0002b1f0: 765f 746f 5f64 6963 7428 7061 7468 3a20  v_to_dict(path: 
+0002b200: 7374 722c 2063 6f6f 7264 733a 2055 6e69  str, coords: Uni
+0002b210: 6f6e 5b44 6963 745b 7374 722c 206e 702e  on[Dict[str, np.
+0002b220: 6e64 6172 7261 795d 2c20 4e6f 6e65 5d20  ndarray], None] 
+0002b230: 3d20 4e6f 6e65 2c20 6465 6c69 6d69 7465  = None, delimite
+0002b240: 723a 2073 7472 203d 2027 2c27 2c20 656e  r: str = ',', en
+0002b250: 636f 6469 6e67 3a20 7374 7220 3d20 2775  coding: str = 'u
+0002b260: 7466 2d38 272c 2077 6974 685f 3a20 7374  tf-8', with_: st
+0002b270: 7220 3d20 2763 7376 2729 202d 3e20 4469  r = 'csv') -> Di
+0002b280: 6374 5b73 7472 2c20 556e 696f 6e5b 5475  ct[str, Union[Tu
+0002b290: 706c 655b 4469 6374 5b73 7472 2c20 6e70  ple[Dict[str, np
+0002b2a0: 2e6e 6461 7272 6179 5d2c 206e 702e 6e64  .ndarray], np.nd
+0002b2b0: 6172 7261 795d 2c20 4469 6374 5b73 7472  array], Dict[str
+0002b2c0: 2c20 6e70 2e6e 6461 7272 6179 5d5d 5d3a  , np.ndarray]]]:
+0002b2d0: 0a20 2020 2022 2222 0a20 2020 204c 6f61  .    """.    Loa
+0002b2e0: 6420 616e 2041 7272 6179 2064 6963 7469  d an Array dicti
+0002b2f0: 6f6e 6172 7920 6672 6f6d 2061 2043 5356  onary from a CSV
+0002b300: 2066 696c 652e 0a0a 2020 2020 4172 6773   file...    Args
+0002b310: 3a0a 2020 2020 2020 2020 7061 7468 3a20  :.        path: 
+0002b320: 5468 6520 7061 7468 2074 6f20 7468 6520  The path to the 
+0002b330: 4353 5620 6669 6c65 2e0a 2020 2020 2020  CSV file..      
+0002b340: 2020 636f 6f72 6473 3a20 5468 6520 636f    coords: The co
+0002b350: 6f72 6469 6e61 7465 7320 666f 7220 7468  ordinates for th
+0002b360: 6520 4172 7261 792e 0a20 2020 2020 2020  e Array..       
+0002b370: 2064 656c 696d 6974 6572 3a20 5468 6520   delimiter: The 
+0002b380: 6465 6c69 6d69 7465 7220 7573 6564 2069  delimiter used i
+0002b390: 6e20 7468 6520 4353 5620 6669 6c65 2e0a  n the CSV file..
+0002b3a0: 2020 2020 2020 2020 7769 7468 5f3a 2054          with_: T
+0002b3b0: 6865 206c 6962 7261 7279 2074 6f20 7573  he library to us
+0002b3c0: 6520 666f 7220 6c6f 6164 696e 6720 7468  e for loading th
+0002b3d0: 6520 4353 5620 6669 6c65 2028 2763 7376  e CSV file ('csv
+0002b3e0: 272c 2027 7061 6e64 6173 272c 206f 7220  ', 'pandas', or 
+0002b3f0: 2770 6f6c 6172 7327 292e 0a0a 2020 2020  'polars')...    
+0002b400: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+0002b410: 2041 2064 6963 7469 6f6e 6172 7920 7265   A dictionary re
+0002b420: 7072 6573 656e 7469 6e67 2074 6865 2041  presenting the A
+0002b430: 7272 6179 2064 6174 6120 616e 6420 636f  rray data and co
+0002b440: 6f72 6469 6e61 7465 7320 6c6f 6164 6564  ordinates loaded
+0002b450: 2066 726f 6d20 7468 6520 4353 5620 6669   from the CSV fi
+0002b460: 6c65 2e0a 0a20 2020 2045 7861 6d70 6c65  le...    Example
+0002b470: 3a0a 2020 2020 2020 2020 6060 6070 7974  :.        ```pyt
+0002b480: 686f 6e0a 2020 2020 2020 2020 3e3e 3e20  hon.        >>> 
+0002b490: 636f 6f72 6473 203d 207b 2764 696d 3127  coords = {'dim1'
+0002b4a0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+0002b4b0: 696d 3227 3a20 5b31 2c20 325d 7d0a 2020  im2': [1, 2]}.  
+0002b4c0: 2020 2020 2020 3e3e 3e20 6172 7261 795f        >>> array_
+0002b4d0: 6469 6374 203d 2066 726f 6d5f 6373 765f  dict = from_csv_
+0002b4e0: 746f 5f64 6963 7428 2774 6573 7473 2f64  to_dict('tests/d
+0002b4f0: 6174 612f 6172 7261 792e 6373 7627 2c20  ata/array.csv', 
+0002b500: 636f 6f72 6473 3d63 6f6f 7264 732c 2077  coords=coords, w
+0002b510: 6974 685f 3d27 6373 7627 290a 2020 2020  ith_='csv').    
+0002b520: 2020 2020 3e3e 3e20 6172 7261 795f 6469      >>> array_di
+0002b530: 6374 0a20 2020 2020 2020 207b 2764 6174  ct.        {'dat
+0002b540: 6127 3a20 287b 2764 696d 3127 3a20 6172  a': ({'dim1': ar
+0002b550: 7261 7928 5b27 6127 2c20 2762 275d 2c20  ray(['a', 'b'], 
+0002b560: 6474 7970 653d 6f62 6a65 6374 292c 2027  dtype=object), '
+0002b570: 6469 6d32 273a 2061 7272 6179 285b 312c  dim2': array([1,
+0002b580: 2032 5d29 7d2c 2061 7272 6179 285b 3130   2])}, array([10
+0002b590: 2c20 3230 5d29 292c 2027 636f 6f72 6473  , 20])), 'coords
+0002b5a0: 273a 207b 2764 696d 3127 3a20 5b27 6127  ': {'dim1': ['a'
+0002b5b0: 2c20 2762 275d 2c20 2764 696d 3227 3a20  , 'b'], 'dim2': 
+0002b5c0: 5b31 2c20 325d 7d7d 0a0a 2020 2020 2020  [1, 2]}}..      
+0002b5d0: 2020 6060 600a 2020 2020 2222 220a 2020    ```.    """.  
+0002b5e0: 2020 6173 7365 7274 2077 6974 685f 2069    assert with_ i
+0002b5f0: 6e20 5b22 6373 7622 2c20 2270 616e 6461  n ["csv", "panda
+0002b600: 7322 2c20 2270 6f6c 6172 7322 5d0a 2020  s", "polars"].  
+0002b610: 2020 6966 2077 6974 685f 203d 3d20 2263    if with_ == "c
+0002b620: 7376 223a 0a20 2020 2020 2020 2072 6574  sv":.        ret
+0002b630: 7572 6e20 5f63 7376 5f74 6f5f 6172 7261  urn _csv_to_arra
+0002b640: 7928 7061 7468 3d70 6174 682c 2063 6f6f  y(path=path, coo
+0002b650: 7264 733d 636f 6f72 6473 2c20 6465 6c69  rds=coords, deli
+0002b660: 6d69 7465 723d 6465 6c69 6d69 7465 722c  miter=delimiter,
+0002b670: 2065 6e63 6f64 696e 673d 656e 636f 6469   encoding=encodi
+0002b680: 6e67 290a 2020 2020 6966 2077 6974 685f  ng).    if with_
+0002b690: 203d 3d20 2270 616e 6461 7322 3a0a 2020   == "pandas":.  
+0002b6a0: 2020 2020 2020 6466 203d 2070 642e 7265        df = pd.re
+0002b6b0: 6164 5f63 7376 2870 6174 6829 0a20 2020  ad_csv(path).   
+0002b6c0: 2020 2020 2072 6574 7572 6e20 5f70 616e       return _pan
+0002b6d0: 6461 735f 746f 5f61 7272 6179 2864 663d  das_to_array(df=
+0002b6e0: 6466 2c20 636f 6f72 6473 3d63 6f6f 7264  df, coords=coord
+0002b6f0: 7329 0a20 2020 2065 6c69 6620 7769 7468  s).    elif with
+0002b700: 5f20 3d3d 2022 706f 6c61 7273 223a 0a20  _ == "polars":. 
+0002b710: 2020 2020 2020 2064 6620 3d20 706c 2e72         df = pl.r
+0002b720: 6561 645f 6373 7628 7061 7468 290a 2020  ead_csv(path).  
+0002b730: 2020 2020 2020 7265 7475 726e 205f 706f        return _po
+0002b740: 6c61 7273 5f74 6f5f 6172 7261 7928 6466  lars_to_array(df
+0002b750: 3d64 662c 2063 6f6f 7264 733d 636f 6f72  =df, coords=coor
+0002b760: 6473 290a 0a0a 6465 6620 6672 6f6d 5f63  ds)...def from_c
+0002b770: 7376 2870 6174 683a 2073 7472 2c20 636f  sv(path: str, co
+0002b780: 6f72 6473 3a20 556e 696f 6e5b 4469 6374  ords: Union[Dict
+0002b790: 5b73 7472 2c20 6e70 2e6e 6461 7272 6179  [str, np.ndarray
+0002b7a0: 5d2c 204e 6f6e 655d 203d 204e 6f6e 652c  ], None] = None,
+0002b7b0: 2064 656c 696d 6974 6572 3a20 7374 7220   delimiter: str 
+0002b7c0: 3d20 272c 272c 2065 6e63 6f64 696e 673a  = ',', encoding:
+0002b7d0: 2073 7472 203d 2027 7574 662d 3827 2c20   str = 'utf-8', 
+0002b7e0: 7769 7468 5f3a 2073 7472 203d 2027 6373  with_: str = 'cs
+0002b7f0: 7627 2920 2d3e 2041 7272 6179 3a0a 2020  v') -> Array:.  
+0002b800: 2020 2222 220a 2020 2020 4c6f 6164 2061    """.    Load a
+0002b810: 6e20 4172 7261 7920 6f62 6a65 6374 2066  n Array object f
+0002b820: 726f 6d20 6120 4353 5620 6669 6c65 2e0a  rom a CSV file..
+0002b830: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+0002b840: 2020 2070 6174 683a 2054 6865 2070 6174     path: The pat
+0002b850: 6820 746f 2074 6865 2043 5356 2066 696c  h to the CSV fil
+0002b860: 652e 0a20 2020 2020 2020 2063 6f6f 7264  e..        coord
+0002b870: 733a 2054 6865 2063 6f6f 7264 696e 6174  s: The coordinat
+0002b880: 6573 2066 6f72 2074 6865 2041 7272 6179  es for the Array
+0002b890: 2e0a 2020 2020 2020 2020 6465 6c69 6d69  ..        delimi
+0002b8a0: 7465 723a 2054 6865 2064 656c 696d 6974  ter: The delimit
+0002b8b0: 6572 2075 7365 6420 696e 2074 6865 2043  er used in the C
+0002b8c0: 5356 2066 696c 652e 0a20 2020 2020 2020  SV file..       
+0002b8d0: 2065 6e63 6f64 696e 673a 2054 6865 2065   encoding: The e
+0002b8e0: 6e63 6f64 696e 6720 6f66 2074 6865 2043  ncoding of the C
+0002b8f0: 5356 2066 696c 652e 0a20 2020 2020 2020  SV file..       
+0002b900: 2077 6974 685f 3a20 5468 6520 6c69 6272   with_: The libr
+0002b910: 6172 7920 746f 2075 7365 2066 6f72 206c  ary to use for l
+0002b920: 6f61 6469 6e67 2074 6865 2043 5356 2066  oading the CSV f
+0002b930: 696c 6520 2827 6373 7627 2c20 2770 616e  ile ('csv', 'pan
+0002b940: 6461 7327 2c20 6f72 2027 706f 6c61 7273  das', or 'polars
+0002b950: 2729 2e0a 0a20 2020 2052 6574 7572 6e73  ')...    Returns
+0002b960: 3a0a 2020 2020 2020 2020 416e 2041 7272  :.        An Arr
+0002b970: 6179 206f 626a 6563 7420 6c6f 6164 6564  ay object loaded
+0002b980: 2066 726f 6d20 7468 6520 4353 5620 6669   from the CSV fi
+0002b990: 6c65 2e0a 0a20 2020 2045 7861 6d70 6c65  le...    Example
+0002b9a0: 3a0a 2020 2020 2020 2020 6060 6070 7974  :.        ```pyt
+0002b9b0: 686f 6e0a 2020 2020 2020 2020 3e3e 3e20  hon.        >>> 
+0002b9c0: 636f 6f72 6473 203d 207b 2764 696d 3127  coords = {'dim1'
+0002b9d0: 3a20 5b27 6127 2c20 2762 275d 2c20 2764  : ['a', 'b'], 'd
+0002b9e0: 696d 3227 3a20 5b31 2c20 325d 7d0a 2020  im2': [1, 2]}.  
+0002b9f0: 2020 2020 2020 3e3e 3e20 6172 7220 3d20        >>> arr = 
+0002ba00: 6672 6f6d 5f63 7376 2827 7465 7374 732f  from_csv('tests/
+0002ba10: 6461 7461 2f61 7272 6179 2e63 7376 272c  data/array.csv',
+0002ba20: 2063 6f6f 7264 733d 636f 6f72 6473 2c20   coords=coords, 
+0002ba30: 7769 7468 5f3d 2763 7376 2729 0a20 2020  with_='csv').   
+0002ba40: 2020 2020 203e 3e3e 2061 7272 0a20 2020       >>> arr.   
+0002ba50: 2020 2020 2041 7272 6179 2864 6174 613d       Array(data=
+0002ba60: 6172 7261 7928 5b5b 3130 2c20 2030 5d2c  array([[10,  0],
+0002ba70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ba80: 5b20 302c 2032 305d 5d29 2c20 636f 6f72  [ 0, 20]]), coor
+0002ba90: 6473 3d7b 2764 696d 3127 3a20 6172 7261  ds={'dim1': arra
+0002baa0: 7928 5b27 6127 2c20 2762 275d 2c20 6474  y(['a', 'b'], dt
+0002bab0: 7970 653d 6f62 6a65 6374 292c 2027 6469  ype=object), 'di
+0002bac0: 6d32 273a 2061 7272 6179 285b 312c 2032  m2': array([1, 2
+0002bad0: 5d29 7d29 0a0a 2020 2020 2020 2020 6060  ])})..        ``
+0002bae0: 600a 2020 2020 2222 220a 2020 2020 7265  `.    """.    re
+0002baf0: 7475 726e 2041 7272 6179 282a 2a66 726f  turn Array(**fro
+0002bb00: 6d5f 6373 765f 746f 5f64 6963 7428 7061  m_csv_to_dict(pa
+0002bb10: 7468 2c20 636f 6f72 6473 3d63 6f6f 7264  th, coords=coord
+0002bb20: 732c 2064 656c 696d 6974 6572 3d64 656c  s, delimiter=del
+0002bb30: 696d 6974 6572 2c20 656e 636f 6469 6e67  imiter, encoding
+0002bb40: 3d65 6e63 6f64 696e 672c 2077 6974 685f  =encoding, with_
+0002bb50: 3d77 6974 685f 2929 0a0a 0a64 6566 205f  =with_))...def _
+0002bb60: 6a6f 696e 5f73 7472 2861 7272 3a20 4c69  join_str(arr: Li
+0002bb70: 7374 5b6e 702e 6e64 6172 7261 795d 2c20  st[np.ndarray], 
+0002bb80: 7365 703a 2073 7472 2920 2d3e 206e 702e  sep: str) -> np.
+0002bb90: 6e64 6172 7261 793a 0a20 2020 2022 2222  ndarray:.    """
+0002bba0: 0a20 2020 204a 6f69 6e20 6120 6c69 7374  .    Join a list
+0002bbb0: 206f 6620 7374 7269 6e67 2061 7272 6179   of string array
+0002bbc0: 7320 696e 746f 2061 2073 696e 676c 6520  s into a single 
+0002bbd0: 7374 7269 6e67 2061 7272 6179 2075 7369  string array usi
+0002bbe0: 6e67 2061 2073 6570 6172 6174 6f72 2e0a  ng a separator..
+0002bbf0: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+0002bc00: 2020 2061 7272 3a20 4120 6c69 7374 206f     arr: A list o
+0002bc10: 6620 7374 7269 6e67 2061 7272 6179 7320  f string arrays 
+0002bc20: 746f 206a 6f69 6e2e 0a20 2020 2020 2020  to join..       
+0002bc30: 2073 6570 3a20 5468 6520 7365 7061 7261   sep: The separa
+0002bc40: 746f 7220 746f 2075 7365 2066 6f72 206a  tor to use for j
+0002bc50: 6f69 6e69 6e67 2074 6865 2073 7472 696e  oining the strin
+0002bc60: 6773 2e0a 0a20 2020 2052 6574 7572 6e73  gs...    Returns
+0002bc70: 3a0a 2020 2020 2020 2020 4120 7369 6e67  :.        A sing
+0002bc80: 6c65 2073 7472 696e 6720 6172 7261 7920  le string array 
+0002bc90: 7769 7468 2074 6865 206a 6f69 6e65 6420  with the joined 
+0002bca0: 7374 7269 6e67 732e 0a0a 2020 2020 4578  strings...    Ex
+0002bcb0: 616d 706c 653a 0a20 2020 2020 2020 2060  ample:.        `
+0002bcc0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
+0002bcd0: 203e 3e3e 2061 7272 203d 205b 6e70 2e61   >>> arr = [np.a
+0002bce0: 7272 6179 285b 2761 272c 2027 6227 5d29  rray(['a', 'b'])
+0002bcf0: 2c20 6e70 2e61 7272 6179 285b 2731 272c  , np.array(['1',
+0002bd00: 2027 3227 5d29 5d0a 2020 2020 2020 2020   '2'])].        
+0002bd10: 3e3e 3e20 7365 7020 3d20 273a 270a 2020  >>> sep = ':'.  
+0002bd20: 2020 2020 2020 3e3e 3e20 6a6f 696e 6564        >>> joined
+0002bd30: 5f61 7272 203d 205f 6a6f 696e 5f73 7472  _arr = _join_str
+0002bd40: 2861 7272 2c20 7365 7029 0a20 2020 2020  (arr, sep).     
+0002bd50: 2020 203e 3e3e 206a 6f69 6e65 645f 6172     >>> joined_ar
+0002bd60: 720a 2020 2020 2020 2020 6172 7261 7928  r.        array(
+0002bd70: 5b27 613a 3127 2c20 2762 3a32 275d 2c20  ['a:1', 'b:2'], 
+0002bd80: 6474 7970 653d 273c 5533 2729 0a0a 2020  dtype='<U3')..  
+0002bd90: 2020 2020 2020 6060 600a 2020 2020 2222        ```.    ""
+0002bda0: 220a 2020 2020 726f 7773 203d 2061 7272  ".    rows = arr
+0002bdb0: 5b30 5d2e 7368 6170 655b 305d 0a20 2020  [0].shape[0].   
+0002bdc0: 2063 6f6c 756d 6e73 203d 206c 656e 2861   columns = len(a
+0002bdd0: 7272 290a 2020 2020 7365 7061 7261 746f  rr).    separato
+0002bde0: 725f 7374 7220 3d20 6e70 2e72 6570 6561  r_str = np.repea
+0002bdf0: 7428 5b73 6570 5d2c 2072 6f77 7329 0a0a  t([sep], rows)..
+0002be00: 2020 2020 6172 7261 7973 203d 205b 5d0a      arrays = [].
+0002be10: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+0002be20: 6765 2863 6f6c 756d 6e73 293a 0a20 2020  ge(columns):.   
+0002be30: 2020 2020 2061 7272 6179 732e 6170 7065       arrays.appe
+0002be40: 6e64 2861 7272 5b69 5d2e 6173 7479 7065  nd(arr[i].astype
+0002be50: 2873 7472 2929 0a20 2020 2020 2020 2069  (str)).        i
+0002be60: 6620 6920 213d 2063 6f6c 756d 6e73 2d31  f i != columns-1
+0002be70: 3a0a 2020 2020 2020 2020 2020 2020 6172  :.            ar
+0002be80: 7261 7973 2e61 7070 656e 6428 7365 7061  rays.append(sepa
+0002be90: 7261 746f 725f 7374 7229 0a20 2020 2072  rator_str).    r
+0002bea0: 6574 7572 6e20 6675 6e63 746f 6f6c 735f  eturn functools_
+0002beb0: 7265 6475 6365 286c 616d 6264 6120 782c  reduce(lambda x,
+0002bec0: 2079 3a20 6e70 2e63 6861 722e 6164 6428   y: np.char.add(
+0002bed0: 782c 2079 292c 2061 7272 6179 7329 0a0a  x, y), arrays)..
+0002bee0: 0a64 6566 206e 6461 7272 6179 5f63 686f  .def ndarray_cho
+0002bef0: 6963 6528 703a 2055 6e69 6f6e 5b6e 702e  ice(p: Union[np.
+0002bf00: 6e64 6172 7261 792c 2027 7370 2e43 4f4f  ndarray, 'sp.COO
+0002bf10: 275d 2c20 6178 6973 3a20 696e 742c 2072  '], axis: int, r
+0002bf20: 6e67 3a20 6e70 2e72 616e 646f 6d2e 4765  ng: np.random.Ge
+0002bf30: 6e65 7261 746f 7229 202d 3e20 556e 696f  nerator) -> Unio
+0002bf40: 6e5b 6e70 2e6e 6461 7272 6179 2c20 2773  n[np.ndarray, 's
+0002bf50: 702e 434f 4f27 5d3a 0a20 2020 2022 2222  p.COO']:.    """
+0002bf60: 0a20 2020 2052 616e 646f 6d6c 7920 6368  .    Randomly ch
+0002bf70: 6f6f 7365 2065 6c65 6d65 6e74 7320 616c  oose elements al
+0002bf80: 6f6e 6720 6120 7370 6563 6966 6965 6420  ong a specified 
+0002bf90: 6178 6973 2062 6173 6564 206f 6e20 7468  axis based on th
+0002bfa0: 6520 6769 7665 6e20 7072 6f62 6162 696c  e given probabil
+0002bfb0: 6974 6965 732e 0a0a 2020 2020 4172 6773  ities...    Args
+0002bfc0: 3a0a 2020 2020 2020 2020 703a 2054 6865  :.        p: The
+0002bfd0: 2061 7272 6179 206f 6620 7072 6f62 6162   array of probab
+0002bfe0: 696c 6974 6965 732e 0a20 2020 2020 2020  ilities..       
+0002bff0: 2061 7869 733a 2054 6865 2061 7869 7320   axis: The axis 
+0002c000: 616c 6f6e 6720 7768 6963 6820 746f 2070  along which to p
+0002c010: 6572 666f 726d 2074 6865 2063 686f 6963  erform the choic
+0002c020: 652e 0a20 2020 2020 2020 2072 6e67 3a20  e..        rng: 
+0002c030: 5468 6520 7261 6e64 6f6d 206e 756d 6265  The random numbe
+0002c040: 7220 6765 6e65 7261 746f 7220 746f 2075  r generator to u
+0002c050: 7365 2e0a 0a20 2020 2052 6574 7572 6e73  se...    Returns
+0002c060: 3a0a 2020 2020 2020 2020 416e 2061 7272  :.        An arr
+0002c070: 6179 206f 6620 626f 6f6c 6561 6e20 7661  ay of boolean va
+0002c080: 6c75 6573 2069 6e64 6963 6174 696e 6720  lues indicating 
+0002c090: 7468 6520 6368 6f73 656e 2065 6c65 6d65  the chosen eleme
+0002c0a0: 6e74 732e 0a0a 2020 2020 4578 616d 706c  nts...    Exampl
+0002c0b0: 653a 0a20 2020 2020 2020 2060 6060 7079  e:.        ```py
+0002c0c0: 7468 6f6e 0a20 2020 2020 2020 203e 3e3e  thon.        >>>
+0002c0d0: 2070 203d 206e 702e 6172 7261 7928 5b5b   p = np.array([[
+0002c0e0: 302e 312c 2030 2e39 5d2c 205b 302e 372c  0.1, 0.9], [0.7,
+0002c0f0: 2030 2e33 5d5d 290a 2020 2020 2020 2020   0.3]]).        
+0002c100: 3e3e 3e20 6178 6973 203d 2031 0a20 2020  >>> axis = 1.   
+0002c110: 2020 2020 203e 3e3e 2072 6e67 203d 206e       >>> rng = n
+0002c120: 702e 7261 6e64 6f6d 2e64 6566 6175 6c74  p.random.default
+0002c130: 5f72 6e67 2873 6565 643d 3432 290a 2020  _rng(seed=42).  
+0002c140: 2020 2020 2020 3e3e 3e20 6368 6f73 656e        >>> chosen
+0002c150: 5f61 7272 203d 206e 6461 7272 6179 5f63  _arr = ndarray_c
+0002c160: 686f 6963 6528 702c 2061 7869 732c 2072  hoice(p, axis, r
+0002c170: 6e67 290a 2020 2020 2020 2020 3e3e 3e20  ng).        >>> 
+0002c180: 6368 6f73 656e 5f61 7272 0a20 2020 2020  chosen_arr.     
+0002c190: 2020 2061 7272 6179 285b 5b46 616c 7365     array([[False
+0002c1a0: 2c20 2054 7275 655d 2c0a 2020 2020 2020  ,  True],.      
+0002c1b0: 2020 2020 2020 2020 205b 2054 7275 652c           [ True,
+0002c1c0: 2046 616c 7365 5d5d 290a 0a20 2020 2020   False]])..     
+0002c1d0: 2020 2060 6060 0a20 2020 2022 2222 0a20     ```.    """. 
+0002c1e0: 2020 2064 6566 205f 6d61 736b 696e 6728     def _masking(
+0002c1f0: 702c 2061 7869 7329 3a0a 2020 2020 2020  p, axis):.      
+0002c200: 2020 7368 6170 6520 3d20 5b6e 7220 666f    shape = [nr fo
+0002c210: 7220 692c 206e 7220 696e 2065 6e75 6d65  r i, nr in enume
+0002c220: 7261 7465 2870 2e73 6861 7065 2920 6966  rate(p.shape) if
+0002c230: 2069 2021 3d20 6178 6973 5d0a 2020 2020   i != axis].    
+0002c240: 2020 2020 7261 6e64 203d 2072 6e67 2e72      rand = rng.r
+0002c250: 616e 646f 6d28 7475 706c 6528 7368 6170  andom(tuple(shap
+0002c260: 6529 290a 2020 2020 2020 2020 7220 3d20  e)).        r = 
+0002c270: 6e70 2e65 7870 616e 645f 6469 6d73 2872  np.expand_dims(r
+0002c280: 616e 642c 2061 7869 733d 6178 6973 290a  and, axis=axis).
+0002c290: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0002c2a0: 7374 616e 6365 2870 2c20 6e70 2e6e 6461  stance(p, np.nda
+0002c2b0: 7272 6179 293a 0a20 2020 2020 2020 2020  rray):.         
+0002c2c0: 2020 2063 756d 203d 206e 702e 6375 6d73     cum = np.cums
+0002c2d0: 756d 2870 2c20 6178 6973 3d61 7869 7329  um(p, axis=axis)
+0002c2e0: 0a20 2020 2020 2020 2065 6c69 6620 5f69  .        elif _i
+0002c2f0: 7369 6e73 7461 6e63 655f 6f70 7469 6f6e  sinstance_option
+0002c300: 616c 5f70 6b67 7328 702c 2027 7370 2e43  al_pkgs(p, 'sp.C
+0002c310: 4f4f 2729 3a0a 2020 2020 2020 2020 2020  OO'):.          
+0002c320: 2020 6375 6d20 3d20 6e70 2e63 756d 7375    cum = np.cumsu
+0002c330: 6d28 702e 746f 6465 6e73 6528 292c 2061  m(p.todense(), a
+0002c340: 7869 733d 6178 6973 290a 2020 2020 2020  xis=axis).      
+0002c350: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0002c360: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
+0002c370: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+0002c380: 2020 2020 2022 7370 6172 7365 2070 6163       "sparse pac
+0002c390: 6b61 6765 206d 7573 7420 6265 2069 6e73  kage must be ins
+0002c3a0: 7461 6c6c 6564 2074 6f20 7573 6520 7468  talled to use th
+0002c3b0: 6973 2066 756e 6374 696f 6e20 7769 7468  is function with
+0002c3c0: 2073 6574 7469 6e67 732e 6461 7461 5f74   settings.data_t
+0002c3d0: 7970 6520 3d20 2773 7061 7273 6527 2e20  ype = 'sparse'. 
+0002c3e0: 4f74 6865 7277 6973 652c 2073 6574 2073  Otherwise, set s
+0002c3f0: 6574 7469 6e67 732e 6461 7461 5f74 7970  ettings.data_typ
+0002c400: 6520 3d20 2764 656e 7365 2722 290a 0a20  e = 'dense'").. 
+0002c410: 2020 2020 2020 2061 7373 6572 7420 6e70         assert np
+0002c420: 2e61 6c6c 636c 6f73 6528 6375 6d2e 6d61  .allclose(cum.ma
+0002c430: 7828 6178 6973 3d61 7869 7329 2c0a 2020  x(axis=axis),.  
+0002c440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c450: 2020 2020 2020 2020 2031 2e30 292c 2022           1.0), "
+0002c460: 5072 6f62 6162 696c 6974 6965 7320 646f  Probabilities do
+0002c470: 206e 6f74 2073 756d 2074 6f20 3122 0a20   not sum to 1". 
+0002c480: 2020 2020 2020 206d 6173 6b20 3d20 2863         mask = (c
+0002c490: 756d 203e 2072 290a 2020 2020 2020 2020  um > r).        
+0002c4a0: 7265 7475 726e 206d 6173 6b0a 0a20 2020  return mask..   
+0002c4b0: 2064 6566 205f 756e 7261 7665 6c28 6d61   def _unravel(ma
+0002c4c0: 736b 2c20 6178 6973 293a 0a20 2020 2020  sk, axis):.     
+0002c4d0: 2020 2061 7267 7320 3d20 6d61 736b 2e61     args = mask.a
+0002c4e0: 7267 6d61 7828 6178 6973 3d61 7869 732c  rgmax(axis=axis,
+0002c4f0: 206b 6565 7064 696d 733d 5472 7565 290a   keepdims=True).
+0002c500: 2020 2020 2020 2020 6964 7820 3d20 6e70          idx = np
+0002c510: 2e75 6e72 6176 656c 5f69 6e64 6578 286e  .unravel_index(n
+0002c520: 702e 6172 616e 6765 2861 7267 732e 7369  p.arange(args.si
+0002c530: 7a65 292c 2061 7267 732e 7368 6170 6529  ze), args.shape)
+0002c540: 0a20 2020 2020 2020 2061 7267 735f 7261  .        args_ra
+0002c550: 7665 6c20 3d20 6172 6773 2e72 6176 656c  vel = args.ravel
+0002c560: 2829 0a20 2020 2020 2020 206e 6577 5f69  ().        new_i
+0002c570: 6478 203d 205b 6172 7220 6966 2069 2021  dx = [arr if i !
+0002c580: 3d20 6178 6973 2065 6c73 6520 6172 6773  = axis else args
+0002c590: 5f72 6176 656c 2066 6f72 2069 2c0a 2020  _ravel for i,.  
+0002c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c5b0: 2061 7272 2069 6e20 656e 756d 6572 6174   arr in enumerat
+0002c5c0: 6528 6964 7829 5d0a 2020 2020 2020 2020  e(idx)].        
+0002c5d0: 7265 7475 726e 206e 6577 5f69 6478 0a0a  return new_idx..
+0002c5e0: 2020 2020 6465 6620 5f6e 645f 626f 6f6c      def _nd_bool
+0002c5f0: 2869 6478 732c 2073 6861 7065 2c20 7369  (idxs, shape, si
+0002c600: 7a65 293a 0a20 2020 2020 2020 2069 6e64  ze):.        ind
+0002c610: 6578 6573 203d 206e 702e 7261 7665 6c5f  exes = np.ravel_
+0002c620: 6d75 6c74 695f 696e 6465 7828 6964 7873  multi_index(idxs
+0002c630: 2c20 7368 6170 6529 0a20 2020 2020 2020  , shape).       
+0002c640: 2066 6c61 7474 656e 5f64 656e 7365 203d   flatten_dense =
+0002c650: 206e 702e 656d 7074 7928 2873 697a 652c   np.empty((size,
+0002c660: 292c 2064 7479 7065 3d62 6f6f 6c29 0a20  ), dtype=bool). 
+0002c670: 2020 2020 2020 2066 6c61 7474 656e 5f64         flatten_d
+0002c680: 656e 7365 5b3a 5d20 3d20 4661 6c73 650a  ense[:] = False.
+0002c690: 2020 2020 2020 2020 666c 6174 7465 6e5f          flatten_
+0002c6a0: 6465 6e73 655b 696e 6465 7865 735d 203d  dense[indexes] =
+0002c6b0: 2054 7275 650a 2020 2020 2020 2020 6e64   True.        nd
+0002c6c0: 5f64 656e 7365 203d 2066 6c61 7474 656e  _dense = flatten
+0002c6d0: 5f64 656e 7365 2e76 6965 7728 292e 7265  _dense.view().re
+0002c6e0: 7368 6170 6528 7368 6170 6529 0a20 2020  shape(shape).   
+0002c6f0: 2020 2020 2072 6574 7572 6e20 6e64 5f64       return nd_d
+0002c700: 656e 7365 0a0a 2020 2020 7368 6170 6520  ense..    shape 
+0002c710: 3d20 702e 7368 6170 650a 2020 2020 7369  = p.shape.    si
+0002c720: 7a65 203d 2070 2e73 697a 650a 2020 2020  ze = p.size.    
+0002c730: 6d61 736b 203d 205f 6d61 736b 696e 6728  mask = _masking(
+0002c740: 702c 2061 7869 7329 0a20 2020 2069 6478  p, axis).    idx
+0002c750: 7320 3d20 5f75 6e72 6176 656c 286d 6173  s = _unravel(mas
+0002c760: 6b2c 2061 7869 7329 0a20 2020 2064 656c  k, axis).    del
+0002c770: 206d 6173 6b0a 2020 2020 7265 7475 726e   mask.    return
+0002c780: 205f 6e64 5f62 6f6f 6c28 6964 7873 2c20   _nd_bool(idxs, 
+0002c790: 7368 6170 652c 2073 697a 6529 0a0a 0a64  shape, size)...d
+0002c7a0: 6566 2075 6e69 6f6e 5f6d 756c 7469 5f63  ef union_multi_c
+0002c7b0: 6f6f 7264 7328 2a61 7267 733a 204c 6973  oords(*args: Lis
+0002c7c0: 745b 4469 6374 5b73 7472 2c20 6e70 2e6e  t[Dict[str, np.n
+0002c7d0: 6461 7272 6179 5d5d 2920 2d3e 2044 6963  darray]]) -> Dic
+0002c7e0: 745b 7374 722c 206e 702e 6e64 6172 7261  t[str, np.ndarra
+0002c7f0: 795d 3a0a 2020 2020 2222 220a 2020 2020  y]:.    """.    
+0002c800: 556e 696f 6e20 6d75 6c74 6970 6c65 2063  Union multiple c
+0002c810: 6f6f 7264 696e 6174 6520 6469 6374 696f  oordinate dictio
+0002c820: 6e61 7269 6573 2e0a 0a20 2020 2041 7267  naries...    Arg
+0002c830: 733a 0a20 2020 2020 2020 202a 6172 6773  s:.        *args
+0002c840: 3a20 5661 7269 6162 6c65 206c 656e 6774  : Variable lengt
+0002c850: 6820 6172 6775 6d65 6e74 206c 6973 7420  h argument list 
+0002c860: 6f66 2063 6f6f 7264 696e 6174 6520 6469  of coordinate di
+0002c870: 6374 696f 6e61 7269 6573 2e0a 0a20 2020  ctionaries...   
+0002c880: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+0002c890: 2020 4120 6469 6374 696f 6e61 7279 2077    A dictionary w
+0002c8a0: 6974 6820 7468 6520 756e 696f 6e20 6f66  ith the union of
+0002c8b0: 2063 6f6f 7264 696e 6174 6573 2066 726f   coordinates fro
+0002c8c0: 6d20 616c 6c20 696e 7075 7420 6469 6374  m all input dict
+0002c8d0: 696f 6e61 7269 6573 2e0a 0a20 2020 2045  ionaries...    E
+0002c8e0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+0002c8f0: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+0002c900: 2020 3e3e 3e20 636f 6f72 6473 3120 3d20    >>> coords1 = 
+0002c910: 7b27 6469 6d31 273a 206e 702e 6172 7261  {'dim1': np.arra
+0002c920: 7928 5b31 2c20 325d 292c 2027 6469 6d32  y([1, 2]), 'dim2
+0002c930: 273a 206e 702e 6172 7261 7928 5b33 2c20  ': np.array([3, 
+0002c940: 345d 297d 0a20 2020 2020 2020 203e 3e3e  4])}.        >>>
+0002c950: 2063 6f6f 7264 7332 203d 207b 2764 696d   coords2 = {'dim
+0002c960: 3127 3a20 6e70 2e61 7272 6179 285b 312c  1': np.array([1,
+0002c970: 2032 5d29 2c20 2764 696d 3227 3a20 6e70   2]), 'dim2': np
+0002c980: 2e61 7272 6179 285b 352c 2036 5d29 7d0a  .array([5, 6])}.
+0002c990: 2020 2020 2020 2020 3e3e 3e20 756e 696f          >>> unio
+0002c9a0: 6e5f 6d75 6c74 695f 636f 6f72 6473 2863  n_multi_coords(c
+0002c9b0: 6f6f 7264 7331 2c20 636f 6f72 6473 3229  oords1, coords2)
+0002c9c0: 0a20 2020 2020 2020 207b 2764 696d 3127  .        {'dim1'
+0002c9d0: 3a20 6172 7261 7928 5b31 2c20 325d 292c  : array([1, 2]),
+0002c9e0: 2027 6469 6d32 273a 2061 7272 6179 285b   'dim2': array([
+0002c9f0: 332c 2034 2c20 352c 2036 5d29 7d0a 0a20  3, 4, 5, 6])}.. 
+0002ca00: 2020 2020 2020 2060 6060 0a20 2020 2022         ```.    "
+0002ca10: 2222 0a20 2020 2061 7373 6572 7420 616c  "".    assert al
+0002ca20: 6c28 5b74 7570 6c65 2863 6f6f 7264 7329  l([tuple(coords)
+0002ca30: 203d 3d20 7475 706c 6528 6172 6773 5b30   == tuple(args[0
+0002ca40: 5d29 2066 6f72 2063 6f6f 7264 7320 696e  ]) for coords in
+0002ca50: 2061 7267 735d 290a 2020 2020 6469 6d73   args]).    dims
+0002ca60: 203d 206c 6973 7428 6172 6773 5b30 5d29   = list(args[0])
+0002ca70: 0a20 2020 206e 6577 5f63 6f6f 7264 7320  .    new_coords 
+0002ca80: 3d20 7b7d 0a20 2020 2066 6f72 2063 6f6f  = {}.    for coo
+0002ca90: 7264 7320 696e 2061 7267 733a 0a20 2020  rds in args:.   
+0002caa0: 2020 2020 2066 6f72 2064 696d 2069 6e20       for dim in 
+0002cab0: 6469 6d73 3a0a 2020 2020 2020 2020 2020  dims:.          
+0002cac0: 2020 6966 2064 696d 206e 6f74 2069 6e20    if dim not in 
+0002cad0: 6e65 775f 636f 6f72 6473 3a0a 2020 2020  new_coords:.    
+0002cae0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+0002caf0: 636f 6f72 6473 5b64 696d 5d20 3d20 636f  coords[dim] = co
+0002cb00: 6f72 6473 5b64 696d 5d0a 2020 2020 2020  ords[dim].      
+0002cb10: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0002cb20: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0002cb30: 6577 5f63 6f6f 7264 735b 6469 6d5d 2e73  ew_coords[dim].s
+0002cb40: 697a 6520 3d3d 2063 6f6f 7264 735b 6469  ize == coords[di
+0002cb50: 6d5d 2e73 697a 653a 0a20 2020 2020 2020  m].size:.       
+0002cb60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0002cb70: 616c 6c28 6e65 775f 636f 6f72 6473 5b64  all(new_coords[d
+0002cb80: 696d 5d20 3d3d 2063 6f6f 7264 735b 6469  im] == coords[di
+0002cb90: 6d5d 293a 0a20 2020 2020 2020 2020 2020  m]):.           
+0002cba0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0002cbb0: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
+0002cbc0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
 0002cbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cbe0: 206e 6577 5f63 6f6f 7264 735b 6469 6d5d   new_coords[dim]
-0002cbf0: 2c20 636f 6f72 6473 5b64 696d 5d29 0a20  , coords[dim]). 
-0002cc00: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002cc10: 6c69 6620 7365 7428 6e65 775f 636f 6f72  lif set(new_coor
-0002cc20: 6473 5b64 696d 5d29 2e69 7373 7562 7365  ds[dim]).issubse
-0002cc30: 7428 7365 7428 636f 6f72 6473 5b64 696d  t(set(coords[dim
-0002cc40: 5d29 293a 0a20 2020 2020 2020 2020 2020  ])):.           
-0002cc50: 2020 2020 2020 2020 206e 6577 5f63 6f6f           new_coo
-0002cc60: 7264 735b 6469 6d5d 203d 2063 6f6f 7264  rds[dim] = coord
-0002cc70: 735b 6469 6d5d 0a20 2020 2020 2020 2020  s[dim].         
-0002cc80: 2020 2020 2020 2065 6c69 6620 7365 7428         elif set(
-0002cc90: 636f 6f72 6473 5b64 696d 5d29 2e69 7373  coords[dim]).iss
-0002cca0: 7562 7365 7428 7365 7428 6e65 775f 636f  ubset(set(new_co
-0002ccb0: 6f72 6473 5b64 696d 5d29 293a 0a20 2020  ords[dim])):.   
-0002ccc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ccd0: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
-0002cce0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0002ccf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cd00: 2020 2020 6e65 775f 636f 6f72 6473 5b64      new_coords[d
-0002cd10: 696d 5d20 3d20 6e70 2e75 6e69 6f6e 3164  im] = np.union1d
-0002cd20: 286e 6577 5f63 6f6f 7264 735b 6469 6d5d  (new_coords[dim]
-0002cd30: 2c20 636f 6f72 6473 5b64 696d 5d29 0a20  , coords[dim]). 
-0002cd40: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-0002cd50: 6f72 6473 0a0a 0a64 6566 205f 7465 7374  ords...def _test
-0002cd60: 5f74 7970 655f 616e 645f 7570 6461 7465  _type_and_update
-0002cd70: 2869 7465 6d3a 2055 6e69 6f6e 5b4c 6973  (item: Union[Lis
-0002cd80: 745b 7374 725d 2c20 4c69 7374 5b69 6e74  t[str], List[int
-0002cd90: 5d2c 204c 6973 745b 666c 6f61 745d 2c20  ], List[float], 
-0002cda0: 4c69 7374 5b6e 702e 6461 7465 7469 6d65  List[np.datetime
-0002cdb0: 3634 5d2c 206e 702e 6e64 6172 7261 795d  64], np.ndarray]
-0002cdc0: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
-0002cdd0: 0a20 2020 2022 2222 0a20 2020 2054 6573  .    """.    Tes
-0002cde0: 7420 7468 6520 7479 7065 206f 6620 7468  t the type of th
-0002cdf0: 6520 696e 7075 7420 6974 656d 2061 6e64  e input item and
-0002ce00: 2075 7064 6174 6520 6974 2061 6363 6f72   update it accor
-0002ce10: 6469 6e67 6c79 2e0a 0a20 2020 2041 7267  dingly...    Arg
-0002ce20: 733a 0a20 2020 2020 2020 2069 7465 6d3a  s:.        item:
-0002ce30: 2049 6e70 7574 2069 7465 6d20 6173 2061   Input item as a
-0002ce40: 206c 6973 7420 6f66 2073 7472 696e 6773   list of strings
-0002ce50: 2c20 696e 7465 6765 7273 2c20 666c 6f61  , integers, floa
-0002ce60: 7473 2c20 6461 7465 7469 6d65 3634 2c20  ts, datetime64, 
-0002ce70: 6f72 2061 206e 756d 7079 2061 7272 6179  or a numpy array
-0002ce80: 2e0a 0a20 2020 2052 6574 7572 6e73 3a0a  ...    Returns:.
-0002ce90: 2020 2020 2020 2020 416e 2075 7064 6174          An updat
-0002cea0: 6564 206e 756d 7079 2061 7272 6179 2062  ed numpy array b
-0002ceb0: 6173 6564 206f 6e20 7468 6520 696e 7075  ased on the inpu
-0002cec0: 7420 6974 656d 2074 7970 652e 0a0a 2020  t item type...  
-0002ced0: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
-0002cee0: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
-0002cef0: 2020 2020 203e 3e3e 205f 7465 7374 5f74       >>> _test_t
-0002cf00: 7970 655f 616e 645f 7570 6461 7465 285b  ype_and_update([
-0002cf10: 312c 2032 2c20 335d 290a 2020 2020 2020  1, 2, 3]).      
-0002cf20: 2020 6172 7261 7928 5b31 2c20 322c 2033    array([1, 2, 3
-0002cf30: 5d29 0a20 2020 2020 2020 203e 3e3e 205f  ]).        >>> _
-0002cf40: 7465 7374 5f74 7970 655f 616e 645f 7570  test_type_and_up
-0002cf50: 6461 7465 285b 2761 272c 2027 6227 2c20  date(['a', 'b', 
-0002cf60: 2763 275d 290a 2020 2020 2020 2020 6172  'c']).        ar
-0002cf70: 7261 7928 5b27 6127 2c20 2762 272c 2027  ray(['a', 'b', '
-0002cf80: 6327 5d2c 2064 7479 7065 3d6f 626a 6563  c'], dtype=objec
-0002cf90: 7429 0a0a 2020 2020 2020 2020 6060 600a  t)..        ```.
-0002cfa0: 2020 2020 2222 220a 2020 2020 6966 206c      """.    if l
-0002cfb0: 656e 2869 7465 6d29 203d 3d20 303a 0a20  en(item) == 0:. 
-0002cfc0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0002cfd0: 616e 6365 2869 7465 6d2c 206e 702e 6e64  ance(item, np.nd
-0002cfe0: 6172 7261 7929 3a0a 2020 2020 2020 2020  array):.        
-0002cff0: 2020 2020 7265 7475 726e 2069 7465 6d0a      return item.
-0002d000: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002d010: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002d020: 206e 702e 6172 7261 7928 5b5d 290a 2020   np.array([]).  
-0002d030: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0002d040: 6966 2069 7369 6e73 7461 6e63 6528 6974  if isinstance(it
-0002d050: 656d 2c20 6e70 2e6e 6461 7272 6179 293a  em, np.ndarray):
-0002d060: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0002d070: 6973 7375 6263 6c61 7373 2874 7970 6528  issubclass(type(
-0002d080: 6974 656d 5b30 5d29 2c20 7374 7229 3a0a  item[0]), str):.
-0002d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d0a0: 6966 2069 7373 7562 636c 6173 7328 6974  if issubclass(it
-0002d0b0: 656d 2e64 7479 7065 2e74 7970 652c 206e  em.dtype.type, n
-0002d0c0: 702e 6f62 6a65 6374 5f29 3a0a 2020 2020  p.object_):.    
-0002d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d0e0: 7661 7269 6162 6c65 5f6f 7574 203d 2069  variable_out = i
-0002d0f0: 7465 6d0a 2020 2020 2020 2020 2020 2020  tem.            
-0002d100: 2020 2020 656c 6966 2069 7373 7562 636c      elif issubcl
-0002d110: 6173 7328 6974 656d 2e64 7479 7065 2e74  ass(item.dtype.t
-0002d120: 7970 652c 2073 7472 293a 0a20 2020 2020  ype, str):.     
-0002d130: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0002d140: 6172 6961 626c 655f 6f75 7420 3d20 6974  ariable_out = it
-0002d150: 656d 2e61 7374 7970 6528 276f 626a 6563  em.astype('objec
-0002d160: 7427 290a 2020 2020 2020 2020 2020 2020  t').            
-0002d170: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0002d180: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0002d190: 6973 6520 4578 6365 7074 696f 6e28 6622  ise Exception(f"
-0002d1a0: 5479 7065 3a20 7b74 7970 6528 6974 656d  Type: {type(item
-0002d1b0: 5b30 5d29 7d20 6e6f 7420 696d 706c 656d  [0])} not implem
-0002d1c0: 656e 7465 642e 2049 7465 6d3a 207b 6974  ented. Item: {it
-0002d1d0: 656d 7d22 290a 2020 2020 2020 2020 2020  em}").          
-0002d1e0: 2020 656c 6966 2069 7373 7562 636c 6173    elif issubclas
-0002d1f0: 7328 6974 656d 2e64 7479 7065 2e74 7970  s(item.dtype.typ
-0002d200: 652c 206e 702e 6f62 6a65 6374 5f29 3a0a  e, np.object_):.
-0002d210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d220: 6966 2069 7373 7562 636c 6173 7328 7479  if issubclass(ty
-0002d230: 7065 2869 7465 6d5b 305d 292c 2069 6e74  pe(item[0]), int
-0002d240: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0002d250: 2020 2020 2020 2076 6172 6961 626c 655f         variable_
-0002d260: 6f75 7420 3d20 6974 656d 2e61 7374 7970  out = item.astyp
-0002d270: 6528 6e70 2e69 6e74 3332 290a 2020 2020  e(np.int32).    
-0002d280: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0002d290: 2069 7369 6e73 7461 6e63 6528 7479 7065   isinstance(type
-0002d2a0: 2869 7465 6d5b 305d 292c 2066 6c6f 6174  (item[0]), float
-0002d2b0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0002d2c0: 2020 2020 2020 2076 6172 6961 626c 655f         variable_
-0002d2d0: 6f75 7420 3d20 6974 656d 2e61 7374 7970  out = item.astyp
-0002d2e0: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
-0002d2f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0002d300: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0002d310: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
-0002d320: 6365 7074 696f 6e28 6622 5479 7065 3a20  ception(f"Type: 
-0002d330: 7b74 7970 6528 6974 656d 5b30 5d29 7d20  {type(item[0])} 
-0002d340: 6e6f 7420 696d 706c 656d 656e 7465 642e  not implemented.
-0002d350: 2049 7465 6d3a 207b 6974 656d 7d22 290a   Item: {item}").
-0002d360: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0002d370: 2069 7373 7562 636c 6173 7328 6974 656d   issubclass(item
-0002d380: 2e64 7479 7065 2e74 7970 652c 2028 6e70  .dtype.type, (np
-0002d390: 2e69 6e74 3136 2c20 6e70 2e69 6e74 3332  .int16, np.int32
-0002d3a0: 2c20 6e70 2e69 6e74 3634 2929 3a0a 2020  , np.int64)):.  
-0002d3b0: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0002d3c0: 7269 6162 6c65 5f6f 7574 203d 2069 7465  riable_out = ite
-0002d3d0: 6d0a 2020 2020 2020 2020 2020 2020 656c  m.            el
-0002d3e0: 6966 2069 7373 7562 636c 6173 7328 6974  if issubclass(it
-0002d3f0: 656d 2e64 7479 7065 2e74 7970 652c 2028  em.dtype.type, (
-0002d400: 6e70 2e66 6c6f 6174 3136 2c20 6e70 2e66  np.float16, np.f
-0002d410: 6c6f 6174 3332 2c20 6e70 2e66 6c6f 6174  loat32, np.float
-0002d420: 3634 2929 3a0a 2020 2020 2020 2020 2020  64)):.          
-0002d430: 2020 2020 2020 7661 7269 6162 6c65 5f6f        variable_o
-0002d440: 7574 203d 2069 7465 6d0a 2020 2020 2020  ut = item.      
-0002d450: 2020 2020 2020 656c 6966 2069 7373 7562        elif issub
-0002d460: 636c 6173 7328 6974 656d 2e64 7479 7065  class(item.dtype
-0002d470: 2e74 7970 652c 206e 702e 6461 7465 7469  .type, np.dateti
-0002d480: 6d65 3634 293a 0a20 2020 2020 2020 2020  me64):.         
-0002d490: 2020 2020 2020 2076 6172 6961 626c 655f         variable_
-0002d4a0: 6f75 7420 3d20 6974 656d 0a20 2020 2020  out = item.     
-0002d4b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002d4c0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0002d4d0: 7365 2045 7863 6570 7469 6f6e 2866 2254  se Exception(f"T
-0002d4e0: 7970 653a 207b 7479 7065 2869 7465 6d5b  ype: {type(item[
-0002d4f0: 305d 297d 206e 6f74 2069 6d70 6c65 6d65  0])} not impleme
-0002d500: 6e74 6564 2e20 4974 656d 3a20 7b69 7465  nted. Item: {ite
-0002d510: 6d7d 2229 0a20 2020 2020 2020 2065 6c69  m}").        eli
-0002d520: 6620 6973 696e 7374 616e 6365 2869 7465  f isinstance(ite
-0002d530: 6d2c 206c 6973 7429 3a0a 2020 2020 2020  m, list):.      
-0002d540: 2020 2020 2020 7661 6c75 655f 7479 7065        value_type
-0002d550: 203d 2074 7970 6528 6974 656d 5b30 5d29   = type(item[0])
-0002d560: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0002d570: 6973 7375 6263 6c61 7373 2876 616c 7565  issubclass(value
-0002d580: 5f74 7970 652c 2073 7472 293a 0a20 2020  _type, str):.   
-0002d590: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0002d5a0: 6563 7465 645f 7479 7065 203d 2027 6f62  ected_type = 'ob
-0002d5b0: 6a65 6374 270a 2020 2020 2020 2020 2020  ject'.          
-0002d5c0: 2020 656c 6966 2069 7373 7562 636c 6173    elif issubclas
-0002d5d0: 7328 7661 6c75 655f 7479 7065 2c20 696e  s(value_type, in
-0002d5e0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-0002d5f0: 2020 2020 7365 6c65 6374 6564 5f74 7970      selected_typ
-0002d600: 6520 3d20 6e70 2e69 6e74 3332 0a20 2020  e = np.int32.   
-0002d610: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
-0002d620: 7375 6263 6c61 7373 2876 616c 7565 5f74  subclass(value_t
-0002d630: 7970 652c 2066 6c6f 6174 293a 0a20 2020  ype, float):.   
-0002d640: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0002d650: 6563 7465 645f 7479 7065 203d 206e 702e  ected_type = np.
-0002d660: 666c 6f61 7433 320a 2020 2020 2020 2020  float32.        
-0002d670: 2020 2020 656c 6966 2069 7373 7562 636c      elif issubcl
-0002d680: 6173 7328 7661 6c75 655f 7479 7065 2c20  ass(value_type, 
-0002d690: 6e70 2e64 6174 6574 696d 6536 3429 3a0a  np.datetime64):.
-0002d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6b0: 7365 6c65 6374 6564 5f74 7970 6520 3d20  selected_type = 
-0002d6c0: 2764 6174 6574 696d 6536 345b 6e73 5d27  'datetime64[ns]'
-0002d6d0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0002d6e0: 6620 6973 7375 6263 6c61 7373 2876 616c  f issubclass(val
-0002d6f0: 7565 5f74 7970 652c 2028 6e70 2e69 6e74  ue_type, (np.int
-0002d700: 3136 2c20 6e70 2e69 6e74 3332 2c20 6e70  16, np.int32, np
-0002d710: 2e69 6e74 3634 2929 3a0a 2020 2020 2020  .int64)):.      
-0002d720: 2020 2020 2020 2020 2020 7365 6c65 6374            select
-0002d730: 6564 5f74 7970 6520 3d20 6974 656d 5b30  ed_type = item[0
-0002d740: 5d2e 6474 7970 650a 2020 2020 2020 2020  ].dtype.        
-0002d750: 2020 2020 656c 6966 2069 7373 7562 636c      elif issubcl
-0002d760: 6173 7328 7661 6c75 655f 7479 7065 2c20  ass(value_type, 
-0002d770: 286e 702e 666c 6f61 7431 362c 206e 702e  (np.float16, np.
-0002d780: 666c 6f61 7433 322c 206e 702e 666c 6f61  float32, np.floa
-0002d790: 7436 3429 293a 0a20 2020 2020 2020 2020  t64)):.         
-0002d7a0: 2020 2020 2020 2073 656c 6563 7465 645f         selected_
-0002d7b0: 7479 7065 203d 2069 7465 6d5b 305d 2e64  type = item[0].d
-0002d7c0: 7479 7065 0a20 2020 2020 2020 2020 2020  type.           
-0002d7d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0002d7e0: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
-0002d7f0: 6570 7469 6f6e 280a 2020 2020 2020 2020  eption(.        
-0002d800: 2020 2020 2020 2020 2020 2020 6622 5479              f"Ty
-0002d810: 7065 3a20 7b74 7970 6528 6974 656d 5b30  pe: {type(item[0
-0002d820: 5d29 7d20 6e6f 7420 696d 706c 656d 656e  ])} not implemen
-0002d830: 7465 642e 2049 7465 6d3a 207b 6974 656d  ted. Item: {item
-0002d840: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
-0002d850: 7661 7269 6162 6c65 5f6f 7574 203d 206e  variable_out = n
-0002d860: 702e 6172 7261 7928 6974 656d 2c20 6474  p.array(item, dt
-0002d870: 7970 653d 7365 6c65 6374 6564 5f74 7970  ype=selected_typ
-0002d880: 6529 0a20 2020 2020 2020 2065 6c69 6620  e).        elif 
-0002d890: 5f69 7369 6e73 7461 6e63 655f 6f70 7469  _isinstance_opti
-0002d8a0: 6f6e 616c 5f70 6b67 7328 6974 656d 2c20  onal_pkgs(item, 
-0002d8b0: 2770 642e 4461 7465 7469 6d65 496e 6465  'pd.DatetimeInde
-0002d8c0: 7827 293a 0a20 2020 2020 2020 2020 2020  x'):.           
-0002d8d0: 2076 6172 6961 626c 655f 6f75 7420 3d20   variable_out = 
-0002d8e0: 6974 656d 2e76 616c 7565 730a 2020 2020  item.values.    
-0002d8f0: 2020 2020 656c 6966 205f 6973 696e 7374      elif _isinst
-0002d900: 616e 6365 5f6f 7074 696f 6e61 6c5f 706b  ance_optional_pk
-0002d910: 6773 2869 7465 6d2c 2027 7064 2e43 6174  gs(item, 'pd.Cat
-0002d920: 6567 6f72 6963 616c 2729 3a0a 2020 2020  egorical'):.    
-0002d930: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-0002d940: 5f6f 7574 203d 2069 7465 6d2e 746f 5f6e  _out = item.to_n
-0002d950: 756d 7079 2863 6f70 793d 5472 7565 290a  umpy(copy=True).
-0002d960: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002d970: 2020 2020 2020 2020 2020 4578 6365 7074            Except
-0002d980: 696f 6e28 6622 5479 7065 3a20 7b74 7970  ion(f"Type: {typ
-0002d990: 6528 6974 656d 297d 206e 6f74 2069 6d70  e(item)} not imp
-0002d9a0: 6c65 6d65 6e74 6564 2e20 4974 656d 3a20  lemented. Item: 
-0002d9b0: 7b69 7465 6d7d 2229 0a0a 2020 2020 2020  {item}")..      
-0002d9c0: 2020 6173 7365 7274 2069 7369 6e73 7461    assert isinsta
-0002d9d0: 6e63 6528 7661 7269 6162 6c65 5f6f 7574  nce(variable_out
-0002d9e0: 2c20 6e70 2e6e 6461 7272 6179 292c 2066  , np.ndarray), f
-0002d9f0: 2254 7970 653a 207b 7479 7065 2869 7465  "Type: {type(ite
-0002da00: 6d29 7d20 6e6f 7420 696d 706c 656d 656e  m)} not implemen
-0002da10: 7465 642e 2049 7465 6d3a 207b 6974 656d  ted. Item: {item
-0002da20: 7d22 0a20 2020 2020 2020 2061 7373 6572  }".        asser
-0002da30: 7420 7661 7269 6162 6c65 5f6f 7574 2e6e  t variable_out.n
-0002da40: 6469 6d20 3d3d 2031 2c20 224f 6e6c 7920  dim == 1, "Only 
-0002da50: 3144 2061 7272 6179 7320 6172 6520 7375  1D arrays are su
-0002da60: 7070 6f72 7465 6422 0a20 2020 2020 2020  pported".       
-0002da70: 2072 6574 7572 6e20 7661 7269 6162 6c65   return variable
-0002da80: 5f6f 7574 0a0a 0a64 6566 205f 7465 7374  _out...def _test
-0002da90: 5f74 7970 655f 616e 645f 7570 6461 7465  _type_and_update
-0002daa0: 5f76 616c 7565 2876 616c 7565 3a20 556e  _value(value: Un
-0002dab0: 696f 6e5b 6e70 2e6e 6461 7272 6179 2c20  ion[np.ndarray, 
-0002dac0: 6c69 7374 2c20 666c 6f61 742c 2069 6e74  list, float, int
-0002dad0: 2c20 626f 6f6c 2c20 6e70 2e62 6f6f 6c5f  , bool, np.bool_
-0002dae0: 2c20 6e70 2e69 6e74 3136 2c20 6e70 2e69  , np.int16, np.i
-0002daf0: 6e74 3332 2c20 6e70 2e69 6e74 3634 2c20  nt32, np.int64, 
-0002db00: 6e70 2e66 6c6f 6174 3136 2c20 6e70 2e66  np.float16, np.f
-0002db10: 6c6f 6174 3332 2c20 6e70 2e66 6c6f 6174  loat32, np.float
-0002db20: 3634 5d29 202d 3e20 6e70 2e6e 6461 7272  64]) -> np.ndarr
-0002db30: 6179 3a0a 2020 2020 6173 7365 7274 2069  ay:.    assert i
-0002db40: 7369 6e73 7461 6e63 6528 7661 6c75 652c  sinstance(value,
-0002db50: 2028 6e70 2e6e 6461 7272 6179 2c20 6c69   (np.ndarray, li
-0002db60: 7374 2c20 666c 6f61 742c 2069 6e74 2c20  st, float, int, 
-0002db70: 626f 6f6c 2c20 6e70 2e62 6f6f 6c5f 2c20  bool, np.bool_, 
-0002db80: 6e70 2e69 6e74 3136 2c20 6e70 2e69 6e74  np.int16, np.int
-0002db90: 3332 2c20 6e70 2e69 6e74 3634 2c20 6e70  32, np.int64, np
-0002dba0: 2e66 6c6f 6174 3136 2c0a 2020 2020 2020  .float16,.      
-0002dbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dbc0: 6e70 2e66 6c6f 6174 3332 2c20 6e70 2e66  np.float32, np.f
-0002dbd0: 6c6f 6174 3634 2929 2c20 6622 5661 6c75  loat64)), f"Valu
-0002dbe0: 6520 6174 7472 6962 7574 6520 6d75 7374  e attribute must
-0002dbf0: 2062 6520 6120 6e75 6d70 7920 6172 7261   be a numpy arra
-0002dc00: 792c 206c 6973 742c 2066 6c6f 6174 2c20  y, list, float, 
-0002dc10: 696e 742c 206f 7220 626f 6f6c 2e20 476f  int, or bool. Go
-0002dc20: 7420 7b74 7970 6528 7661 6c75 6529 7d22  t {type(value)}"
-0002dc30: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-0002dc40: 6365 2876 616c 7565 2c20 6e70 2e6e 6461  ce(value, np.nda
-0002dc50: 7272 6179 293a 0a20 2020 2020 2020 2061  rray):.        a
-0002dc60: 7373 6572 7420 6973 7375 6263 6c61 7373  ssert issubclass
-0002dc70: 2876 616c 7565 2e64 7479 7065 2e74 7970  (value.dtype.typ
-0002dc80: 652c 2028 6e70 2e62 6f6f 6c5f 2c20 6e70  e, (np.bool_, np
-0002dc90: 2e69 6e74 3136 2c20 6e70 2e69 6e74 3332  .int16, np.int32
-0002dca0: 2c20 6e70 2e69 6e74 3634 2c20 6e70 2e66  , np.int64, np.f
-0002dcb0: 6c6f 6174 3136 2c20 6e70 2e66 6c6f 6174  loat16, np.float
-0002dcc0: 3332 2c20 6e70 2e66 6c6f 6174 3634 290a  32, np.float64).
-0002dcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dce0: 2020 2020 2020 2020 2020 292c 2022 6474            ), "dt
-0002dcf0: 7970 6520 7375 7070 6f65 7274 6564 2066  ype suppoerted f
-0002dd00: 6f72 2076 616c 7565 2061 7474 7269 6275  or value attribu
-0002dd10: 7465 3a20 6e70 2e62 6f6f 6c5f 2c20 6e70  te: np.bool_, np
-0002dd20: 2e69 6e74 3136 2c20 6e70 2e69 6e74 3332  .int16, np.int32
-0002dd30: 2c20 6e70 2e69 6e74 3634 2c20 6e70 2e66  , np.int64, np.f
-0002dd40: 6c6f 6174 3136 2c20 6e70 2e66 6c6f 6174  loat16, np.float
-0002dd50: 3332 2c20 6e70 2e66 6c6f 6174 3634 220a  32, np.float64".
-0002dd60: 2020 2020 2020 2020 6966 2076 616c 7565          if value
-0002dd70: 2e6e 6469 6d20 3d3d 2030 3a0a 2020 2020  .ndim == 0:.    
-0002dd80: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
-0002dd90: 7661 6c75 652e 7265 7368 6170 6528 2876  value.reshape((v
-0002dda0: 616c 7565 2e73 697a 652c 2929 0a20 2020  alue.size,)).   
-0002ddb0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-0002ddc0: 2876 616c 7565 2c20 2866 6c6f 6174 2c20  (value, (float, 
-0002ddd0: 696e 742c 2062 6f6f 6c2c 206e 702e 626f  int, bool, np.bo
-0002dde0: 6f6c 5f2c 206e 702e 696e 7431 362c 206e  ol_, np.int16, n
-0002ddf0: 702e 696e 7433 322c 206e 702e 696e 7436  p.int32, np.int6
-0002de00: 342c 206e 702e 666c 6f61 7431 362c 206e  4, np.float16, n
-0002de10: 702e 666c 6f61 7433 322c 206e 702e 666c  p.float32, np.fl
-0002de20: 6f61 7436 3429 293a 0a20 2020 2020 2020  oat64)):.       
-0002de30: 2076 616c 7565 203d 206e 702e 6172 7261   value = np.arra
-0002de40: 7928 5b76 616c 7565 5d29 0a20 2020 2065  y([value]).    e
-0002de50: 6c69 6620 6973 696e 7374 616e 6365 2876  lif isinstance(v
-0002de60: 616c 7565 2c20 6c69 7374 293a 0a20 2020  alue, list):.   
-0002de70: 2020 2020 2069 6620 7661 6c75 653a 0a20       if value:. 
-0002de80: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0002de90: 696e 7374 616e 6365 2876 616c 7565 5b30  instance(value[0
-0002dea0: 5d2c 2073 7472 293a 0a20 2020 2020 2020  ], str):.       
-0002deb0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0002dec0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0002ded0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0002dee0: 2020 2020 2020 2020 224c 6f6e 6720 6f62          "Long ob
-0002def0: 6a65 6374 2064 6f65 7320 6e6f 7420 7375  ject does not su
-0002df00: 7070 6f72 7420 7374 7269 6e67 2076 616c  pport string val
-0002df10: 7565 7320 666f 7220 7661 6c75 6520 6174  ues for value at
-0002df20: 7472 6962 7574 6522 290a 2020 2020 2020  tribute").      
-0002df30: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-0002df40: 7461 6e63 6528 7661 6c75 655b 305d 2c20  tance(value[0], 
-0002df50: 2869 6e74 2c20 666c 6f61 742c 2062 6f6f  (int, float, boo
-0002df60: 6c29 293a 0a20 2020 2020 2020 2020 2020  l)):.           
-0002df70: 2020 2020 2076 616c 7565 203d 206e 702e       value = np.
-0002df80: 6172 7261 7928 7661 6c75 6529 0a20 2020  array(value).   
-0002df90: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
-0002dfa0: 696e 7374 616e 6365 2876 616c 7565 5b30  instance(value[0
-0002dfb0: 5d2c 206e 702e 6e64 6172 7261 7929 3a0a  ], np.ndarray):.
-0002dfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dfd0: 6966 2069 7373 7562 636c 6173 7328 7661  if issubclass(va
-0002dfe0: 6c75 655b 305d 2e64 7479 7065 2e74 7970  lue[0].dtype.typ
-0002dff0: 652c 2028 6e70 2e62 6f6f 6c5f 2c20 6e70  e, (np.bool_, np
-0002e000: 2e69 6e74 3136 2c20 6e70 2e69 6e74 3332  .int16, np.int32
-0002e010: 2c20 6e70 2e69 6e74 3634 2c20 6e70 2e66  , np.int64, np.f
-0002e020: 6c6f 6174 3136 2c20 6e70 2e66 6c6f 6174  loat16, np.float
-0002e030: 3332 2c20 6e70 2e66 6c6f 6174 3634 2929  32, np.float64))
-0002e040: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002e050: 2020 2020 2020 7661 6c75 6520 3d20 6e70        value = np
-0002e060: 2e61 7272 6179 2876 616c 7565 2c20 6474  .array(value, dt
-0002e070: 7970 653d 7661 6c75 655b 305d 2e64 7479  ype=value[0].dty
-0002e080: 7065 290a 2020 2020 2020 2020 2020 2020  pe).            
-0002e090: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0002e0a0: 2020 2020 2020 2020 2020 2020 2020 4578                Ex
-0002e0b0: 6365 7074 696f 6e28 224e 6573 7465 6420  ception("Nested 
-0002e0c0: 6172 7261 7973 206e 6f74 2073 7570 706f  arrays not suppo
-0002e0d0: 7274 6564 2229 0a20 2020 2020 2020 2065  rted").        e
-0002e0e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002e0f0: 2076 616c 7565 203d 206e 702e 6172 7261   value = np.arra
-0002e100: 7928 7661 6c75 652c 2064 7479 7065 3d4e  y(value, dtype=N
-0002e110: 6f6e 6529 0a20 2020 2065 6c73 653a 0a20  one).    else:. 
-0002e120: 2020 2020 2020 2045 7863 6570 7469 6f6e         Exception
-0002e130: 280a 2020 2020 2020 2020 2020 2020 6622  (.            f"
-0002e140: 5661 6c75 6520 6174 7472 6962 7574 6520  Value attribute 
-0002e150: 6d75 7374 2062 6520 6120 6e75 6d70 7920  must be a numpy 
-0002e160: 6172 7261 792c 206c 6973 742c 2066 6c6f  array, list, flo
-0002e170: 6174 2c20 696e 742c 206f 7220 626f 6f6c  at, int, or bool
-0002e180: 2e20 476f 7420 7b74 7970 6528 7661 6c75  . Got {type(valu
-0002e190: 6529 7d22 290a 2020 2020 6173 7365 7274  e)}").    assert
-0002e1a0: 2069 7369 6e73 7461 6e63 6528 0a20 2020   isinstance(.   
-0002e1b0: 2020 2020 2076 616c 7565 2c20 6e70 2e6e       value, np.n
-0002e1c0: 6461 7272 6179 292c 2066 2241 6674 6572  darray), f"After
-0002e1d0: 2076 616c 6964 6174 696f 6e2c 2056 616c   validation, Val
-0002e1e0: 7565 2061 7474 7269 6275 7465 206d 7573  ue attribute mus
-0002e1f0: 7420 6265 2061 206e 756d 7079 2061 7272  t be a numpy arr
-0002e200: 6179 2e20 476f 7420 7b74 7970 6528 7661  ay. Got {type(va
-0002e210: 6c75 6529 7d22 0a20 2020 2061 7373 6572  lue)}".    asser
-0002e220: 7420 7661 6c75 652e 6e64 696d 203d 3d20  t value.ndim == 
-0002e230: 312c 2022 4f6e 6c79 2031 4420 6172 7261  1, "Only 1D arra
-0002e240: 7973 2061 7265 2073 7570 706f 7274 6564  ys are supported
-0002e250: 220a 2020 2020 7265 7475 726e 2076 616c  ".    return val
-0002e260: 7565 0a0a 0a64 6566 205f 666f 726d 6174  ue...def _format
-0002e270: 5f62 7974 6573 2873 697a 653a 2069 6e74  _bytes(size: int
-0002e280: 2920 2d3e 2073 7472 3a0a 2020 2020 2222  ) -> str:.    ""
-0002e290: 220a 2020 2020 466f 726d 6174 2061 2062  ".    Format a b
-0002e2a0: 7974 6520 7369 7a65 2061 7320 6120 6875  yte size as a hu
-0002e2b0: 6d61 6e2d 7265 6164 6162 6c65 2073 7472  man-readable str
-0002e2c0: 696e 672e 0a0a 2020 2020 4172 6773 3a0a  ing...    Args:.
-0002e2d0: 2020 2020 2020 2020 7369 7a65 3a20 5369          size: Si
-0002e2e0: 7a65 2069 6e20 6279 7465 732e 0a0a 2020  ze in bytes...  
-0002e2f0: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-0002e300: 2020 2041 2068 756d 616e 2d72 6561 6461     A human-reada
-0002e310: 626c 6520 7374 7269 6e67 2072 6570 7265  ble string repre
-0002e320: 7365 6e74 6174 696f 6e20 6f66 2074 6865  sentation of the
-0002e330: 2062 7974 6520 7369 7a65 2e0a 0a20 2020   byte size...   
-0002e340: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
-0002e350: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-0002e360: 2020 2020 3e3e 3e20 5f66 6f72 6d61 745f      >>> _format_
-0002e370: 6279 7465 7328 3130 3234 290a 2020 2020  bytes(1024).    
-0002e380: 2020 2020 2731 2e30 204b 4227 0a20 2020      '1.0 KB'.   
-0002e390: 2020 2020 203e 3e3e 205f 666f 726d 6174       >>> _format
-0002e3a0: 5f62 7974 6573 2831 3034 3835 3736 290a  _bytes(1048576).
-0002e3b0: 2020 2020 2020 2020 2731 2e30 204d 4227          '1.0 MB'
-0002e3c0: 0a0a 2020 2020 2020 2020 6060 600a 2020  ..        ```.  
-0002e3d0: 2020 2222 220a 2020 2020 706f 7765 725f    """.    power_
-0002e3e0: 6c61 6265 6c73 203d 207b 3430 3a20 2254  labels = {40: "T
-0002e3f0: 4222 2c20 3330 3a20 2247 4222 2c20 3230  B", 30: "GB", 20
-0002e400: 3a20 224d 4222 2c20 3130 3a20 224b 4222  : "MB", 10: "KB"
-0002e410: 7d0a 2020 2020 666f 7220 706f 7765 722c  }.    for power,
-0002e420: 206c 6162 656c 2069 6e20 706f 7765 725f   label in power_
-0002e430: 6c61 6265 6c73 2e69 7465 6d73 2829 3a0a  labels.items():.
-0002e440: 2020 2020 2020 2020 6966 2073 697a 6520          if size 
-0002e450: 3e3d 2032 202a 2a20 706f 7765 723a 0a20  >= 2 ** power:. 
-0002e460: 2020 2020 2020 2020 2020 2061 7070 726f             appro
-0002e470: 785f 7369 7a65 203d 2073 697a 6520 2f20  x_size = size / 
-0002e480: 3220 2a2a 2070 6f77 6572 0a20 2020 2020  2 ** power.     
-0002e490: 2020 2020 2020 2072 6574 7572 6e20 6622         return f"
-0002e4a0: 7b61 7070 726f 785f 7369 7a65 3a2e 3166  {approx_size:.1f
-0002e4b0: 7d20 7b6c 6162 656c 7d22 0a20 2020 2072  } {label}".    r
-0002e4c0: 6574 7572 6e20 6622 7b73 697a 657d 2062  eturn f"{size} b
-0002e4d0: 7974 6573 220a 0a0a 6465 6620 5f69 735f  ytes"...def _is_
-0002e4e0: 696e 5f72 616e 6765 2873 7461 7274 3a20  in_range(start: 
-0002e4f0: 696e 742c 2065 6e64 3a20 696e 742c 206c  int, end: int, l
-0002e500: 6f77 6572 3a20 696e 742c 2075 7070 6572  ower: int, upper
-0002e510: 3a20 696e 742c 2073 7465 703a 2069 6e74  : int, step: int
-0002e520: 203d 2031 2920 2d3e 2062 6f6f 6c3a 0a20   = 1) -> bool:. 
-0002e530: 2020 2022 2222 0a20 2020 2043 6865 636b     """.    Check
-0002e540: 2062 6566 6f72 6520 7061 7373 696e 6720   before passing 
-0002e550: 736c 6963 6573 2069 6620 7468 6579 2061  slices if they a
-0002e560: 7265 2069 6e20 7468 6520 6578 7065 6374  re in the expect
-0002e570: 6564 2072 616e 6765 2e0a 0a20 2020 2041  ed range...    A
-0002e580: 7267 733a 0a20 2020 2020 2020 2073 7461  rgs:.        sta
-0002e590: 7274 3a20 5374 6172 7420 6f66 2074 6865  rt: Start of the
-0002e5a0: 2073 6c69 6365 0a20 2020 2020 2020 2065   slice.        e
-0002e5b0: 6e64 3a20 456e 6420 6f66 2074 6865 2073  nd: End of the s
-0002e5c0: 6c69 6365 0a20 2020 2020 2020 2075 7070  lice.        upp
-0002e5d0: 6572 3a20 5570 7065 7220 626f 756e 640a  er: Upper bound.
-0002e5e0: 2020 2020 2020 2020 6c6f 7765 723a 204c          lower: L
-0002e5f0: 6f77 6572 2062 6f75 6e64 0a20 2020 2020  ower bound.     
-0002e600: 2020 2073 7465 703a 2053 7465 7020 7369     step: Step si
-0002e610: 7a65 0a0a 2020 2020 5261 6973 6573 3a0a  ze..    Raises:.
-0002e620: 2020 2020 2020 2020 4173 7365 7274 696f          Assertio
-0002e630: 6e45 7272 6f72 3a20 4966 2074 6865 2073  nError: If the s
-0002e640: 6c69 6365 2069 7320 6e6f 7420 696e 2074  lice is not in t
-0002e650: 6865 2065 7870 6563 7465 6420 7261 6e67  he expected rang
-0002e660: 652e 0a0a 2020 2020 5265 7475 726e 733a  e...    Returns:
-0002e670: 0a20 2020 2020 2020 2054 7275 6520 6966  .        True if
-0002e680: 2074 6865 2073 6c69 6365 2069 7320 696e   the slice is in
-0002e690: 2074 6865 2065 7870 6563 7465 6420 7261   the expected ra
-0002e6a0: 6e67 652c 2072 6169 7365 7320 616e 2065  nge, raises an e
-0002e6b0: 7863 6570 7469 6f6e 206f 7468 6572 7769  xception otherwi
-0002e6c0: 7365 2e0a 2020 2020 2222 220a 2020 2020  se..    """.    
-0002e6d0: 6173 7365 7274 2073 7465 7020 696e 205b  assert step in [
-0002e6e0: 312c 202d 315d 0a20 2020 2069 6620 7374  1, -1].    if st
-0002e6f0: 6172 7420 3e20 303a 0a20 2020 2020 2020  art > 0:.       
-0002e700: 2061 7373 6572 7420 7374 6172 7420 3c20   assert start < 
-0002e710: 7570 7065 7220 616e 6420 7374 6172 7420  upper and start 
-0002e720: 3e3d 206c 6f77 6572 2c20 6622 7b73 7461  >= lower, f"{sta
-0002e730: 7274 3d7d 203c 207b 7570 7065 723d 7d20  rt=} < {upper=} 
-0002e740: 616e 6420 7b73 7461 7274 3d7d 203e 3d20  and {start=} >= 
-0002e750: 7b6c 6f77 6572 3d7d 220a 2020 2020 2020  {lower=}".      
-0002e760: 2020 6173 7365 7274 2065 6e64 203e 2073    assert end > s
-0002e770: 7461 7274 206f 7220 656e 6420 3c20 302c  tart or end < 0,
-0002e780: 2066 227b 656e 643d 7d20 3e20 7b73 7461   f"{end=} > {sta
-0002e790: 7274 3d7d 206f 7220 7b65 6e64 3d7d 203c  rt=} or {end=} <
-0002e7a0: 2030 220a 2020 2020 2020 2020 6966 2065   0".        if e
-0002e7b0: 6e64 203c 2030 3a0a 2020 2020 2020 2020  nd < 0:.        
-0002e7c0: 2020 2020 6173 7365 7274 2065 6e64 203e      assert end >
-0002e7d0: 3d20 2d75 7070 6572 2061 6e64 2065 6e64  = -upper and end
-0002e7e0: 203c 3d20 2d6c 6f77 6572 2c20 6622 7b65   <= -lower, f"{e
-0002e7f0: 6e64 3d7d 203e 3d20 7b2d 7570 7065 723d  nd=} >= {-upper=
-0002e800: 7d20 616e 6420 7b65 6e64 3d7d 203c 3d20  } and {end=} <= 
-0002e810: 7b2d 6c6f 7765 723d 7d22 0a20 2020 2020  {-lower=}".     
-0002e820: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002e830: 2020 2020 2061 7373 6572 7420 656e 6420       assert end 
-0002e840: 3c3d 2075 7070 6572 2061 6e64 2065 6e64  <= upper and end
-0002e850: 203e 3d20 6c6f 7765 722c 2066 227b 656e   >= lower, f"{en
-0002e860: 643d 7d20 3c3d 207b 7570 7065 723d 7d20  d=} <= {upper=} 
-0002e870: 616e 6420 7b65 6e64 3d7d 203e 3d20 7b6c  and {end=} >= {l
-0002e880: 6f77 6572 3d7d 220a 2020 2020 656c 6966  ower=}".    elif
-0002e890: 2073 7461 7274 203c 2030 3a0a 2020 2020   start < 0:.    
-0002e8a0: 2020 2020 6173 7365 7274 2073 7461 7274      assert start
-0002e8b0: 203e 202d 7570 7065 7220 616e 6420 7374   > -upper and st
-0002e8c0: 6172 7420 3c3d 202d 6c6f 7765 722c 2066  art <= -lower, f
-0002e8d0: 227b 7374 6172 743d 7d20 3e20 7b2d 7570  "{start=} > {-up
-0002e8e0: 7065 723d 7d20 616e 6420 7b73 7461 7274  per=} and {start
-0002e8f0: 3d7d 203c 3d20 7b2d 6c6f 7765 723d 7d22  =} <= {-lower=}"
-0002e900: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0002e910: 656e 6420 3e20 2d75 7070 6572 2061 6e64  end > -upper and
-0002e920: 2065 6e64 203c 3d20 2d6c 6f77 6572 2c20   end <= -lower, 
-0002e930: 6622 7b65 6e64 3d7d 203e 207b 2d75 7070  f"{end=} > {-upp
-0002e940: 6572 3d7d 2061 6e64 207b 656e 643d 7d20  er=} and {end=} 
-0002e950: 3c3d 207b 2d6c 6f77 6572 3d7d 2061 7320  <= {-lower=} as 
-0002e960: 7b73 7461 7274 3d7d 203c 2030 220a 2020  {start=} < 0".  
-0002e970: 2020 2020 2020 6173 7365 7274 2065 6e64        assert end
-0002e980: 203e 2073 7461 7274 2061 6e64 2065 6e64   > start and end
-0002e990: 203c 2030 2c20 6622 7b65 6e64 3d7d 203e   < 0, f"{end=} >
-0002e9a0: 207b 7374 6172 743d 7d20 616e 6420 7b65   {start=} and {e
-0002e9b0: 6e64 3d7d 203c 2030 2061 7320 7b73 7461  nd=} < 0 as {sta
-0002e9c0: 7274 3d7d 203c 2030 220a 2020 2020 656c  rt=} < 0".    el
-0002e9d0: 7365 3a0a 2020 2020 2020 2020 6173 7365  se:.        asse
-0002e9e0: 7274 2073 7461 7274 203c 2075 7070 6572  rt start < upper
-0002e9f0: 2061 6e64 2073 7461 7274 203e 3d20 6c6f   and start >= lo
-0002ea00: 7765 722c 2066 227b 7374 6172 743d 7d20  wer, f"{start=} 
-0002ea10: 3c20 7b75 7070 6572 3d7d 2061 6e64 207b  < {upper=} and {
-0002ea20: 7374 6172 743d 7d20 3e3d 207b 6c6f 7765  start=} >= {lowe
-0002ea30: 723d 7d22 0a20 2020 2020 2020 2061 7373  r=}".        ass
-0002ea40: 6572 7420 656e 6420 3e20 7374 6172 7420  ert end > start 
-0002ea50: 6f72 2065 6e64 203c 2030 2c20 6622 7b65  or end < 0, f"{e
-0002ea60: 6e64 3d7d 203e 207b 7374 6172 743d 7d20  nd=} > {start=} 
-0002ea70: 6f72 207b 656e 643d 7d20 3c20 3020 6173  or {end=} < 0 as
-0002ea80: 207b 7374 6172 743d 7d20 3c20 3022 0a20   {start=} < 0". 
-0002ea90: 2020 2020 2020 2069 6620 656e 6420 3c20         if end < 
-0002eaa0: 303a 0a20 2020 2020 2020 2020 2020 2061  0:.            a
-0002eab0: 7373 6572 7420 656e 6420 3e3d 202d 7570  ssert end >= -up
-0002eac0: 7065 7220 616e 6420 656e 6420 3c20 2d6c  per and end < -l
-0002ead0: 6f77 6572 2c20 6622 7b65 6e64 3d7d 203e  ower, f"{end=} >
-0002eae0: 3d20 7b2d 7570 7065 723d 7d20 616e 6420  = {-upper=} and 
-0002eaf0: 7b65 6e64 3d7d 203c 207b 2d6c 6f77 6572  {end=} < {-lower
-0002eb00: 3d7d 220a 2020 2020 2020 2020 656c 7365  =}".        else
-0002eb10: 3a0a 2020 2020 2020 2020 2020 2020 6173  :.            as
-0002eb20: 7365 7274 2065 6e64 203c 3d20 7570 7065  sert end <= uppe
-0002eb30: 7220 616e 6420 656e 6420 3e20 6c6f 7765  r and end > lowe
-0002eb40: 722c 2066 227b 656e 643d 7d20 3c3d 207b  r, f"{end=} <= {
-0002eb50: 7570 7065 723d 7d20 616e 6420 7b65 6e64  upper=} and {end
-0002eb60: 3d7d 203e 207b 6c6f 7765 723d 7d22 0a20  =} > {lower=}". 
-0002eb70: 2020 2072 6574 7572 6e20 5472 7565 0a       return True.
+0002cbe0: 2020 2020 2020 2020 6e65 775f 636f 6f72          new_coor
+0002cbf0: 6473 5b64 696d 5d20 3d20 6e70 2e75 6e69  ds[dim] = np.uni
+0002cc00: 6f6e 3164 280a 2020 2020 2020 2020 2020  on1d(.          
+0002cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cc20: 2020 6e65 775f 636f 6f72 6473 5b64 696d    new_coords[dim
+0002cc30: 5d2c 2063 6f6f 7264 735b 6469 6d5d 290a  ], coords[dim]).
+0002cc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cc50: 656c 6966 2073 6574 286e 6577 5f63 6f6f  elif set(new_coo
+0002cc60: 7264 735b 6469 6d5d 292e 6973 7375 6273  rds[dim]).issubs
+0002cc70: 6574 2873 6574 2863 6f6f 7264 735b 6469  et(set(coords[di
+0002cc80: 6d5d 2929 3a0a 2020 2020 2020 2020 2020  m])):.          
+0002cc90: 2020 2020 2020 2020 2020 6e65 775f 636f            new_co
+0002cca0: 6f72 6473 5b64 696d 5d20 3d20 636f 6f72  ords[dim] = coor
+0002ccb0: 6473 5b64 696d 5d0a 2020 2020 2020 2020  ds[dim].        
+0002ccc0: 2020 2020 2020 2020 656c 6966 2073 6574          elif set
+0002ccd0: 2863 6f6f 7264 735b 6469 6d5d 292e 6973  (coords[dim]).is
+0002cce0: 7375 6273 6574 2873 6574 286e 6577 5f63  subset(set(new_c
+0002ccf0: 6f6f 7264 735b 6469 6d5d 2929 3a0a 2020  oords[dim])):.  
+0002cd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cd10: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
+0002cd20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0002cd30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002cd40: 2020 2020 206e 6577 5f63 6f6f 7264 735b       new_coords[
+0002cd50: 6469 6d5d 203d 206e 702e 756e 696f 6e31  dim] = np.union1
+0002cd60: 6428 6e65 775f 636f 6f72 6473 5b64 696d  d(new_coords[dim
+0002cd70: 5d2c 2063 6f6f 7264 735b 6469 6d5d 290a  ], coords[dim]).
+0002cd80: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+0002cd90: 6f6f 7264 730a 0a0a 6465 6620 5f74 6573  oords...def _tes
+0002cda0: 745f 7479 7065 5f61 6e64 5f75 7064 6174  t_type_and_updat
+0002cdb0: 6528 6974 656d 3a20 556e 696f 6e5b 4c69  e(item: Union[Li
+0002cdc0: 7374 5b73 7472 5d2c 204c 6973 745b 696e  st[str], List[in
+0002cdd0: 745d 2c20 4c69 7374 5b66 6c6f 6174 5d2c  t], List[float],
+0002cde0: 204c 6973 745b 6e70 2e64 6174 6574 696d   List[np.datetim
+0002cdf0: 6536 345d 2c20 6e70 2e6e 6461 7272 6179  e64], np.ndarray
+0002ce00: 5d29 202d 3e20 6e70 2e6e 6461 7272 6179  ]) -> np.ndarray
+0002ce10: 3a0a 2020 2020 2222 220a 2020 2020 5465  :.    """.    Te
+0002ce20: 7374 2074 6865 2074 7970 6520 6f66 2074  st the type of t
+0002ce30: 6865 2069 6e70 7574 2069 7465 6d20 616e  he input item an
+0002ce40: 6420 7570 6461 7465 2069 7420 6163 636f  d update it acco
+0002ce50: 7264 696e 676c 792e 0a0a 2020 2020 4172  rdingly...    Ar
+0002ce60: 6773 3a0a 2020 2020 2020 2020 6974 656d  gs:.        item
+0002ce70: 3a20 496e 7075 7420 6974 656d 2061 7320  : Input item as 
+0002ce80: 6120 6c69 7374 206f 6620 7374 7269 6e67  a list of string
+0002ce90: 732c 2069 6e74 6567 6572 732c 2066 6c6f  s, integers, flo
+0002cea0: 6174 732c 2064 6174 6574 696d 6536 342c  ats, datetime64,
+0002ceb0: 206f 7220 6120 6e75 6d70 7920 6172 7261   or a numpy arra
+0002cec0: 792e 0a0a 2020 2020 5265 7475 726e 733a  y...    Returns:
+0002ced0: 0a20 2020 2020 2020 2041 6e20 7570 6461  .        An upda
+0002cee0: 7465 6420 6e75 6d70 7920 6172 7261 7920  ted numpy array 
+0002cef0: 6261 7365 6420 6f6e 2074 6865 2069 6e70  based on the inp
+0002cf00: 7574 2069 7465 6d20 7479 7065 2e0a 0a20  ut item type... 
+0002cf10: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
+0002cf20: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
+0002cf30: 2020 2020 2020 3e3e 3e20 5f74 6573 745f        >>> _test_
+0002cf40: 7479 7065 5f61 6e64 5f75 7064 6174 6528  type_and_update(
+0002cf50: 5b31 2c20 322c 2033 5d29 0a20 2020 2020  [1, 2, 3]).     
+0002cf60: 2020 2061 7272 6179 285b 312c 2032 2c20     array([1, 2, 
+0002cf70: 335d 290a 2020 2020 2020 2020 3e3e 3e20  3]).        >>> 
+0002cf80: 5f74 6573 745f 7479 7065 5f61 6e64 5f75  _test_type_and_u
+0002cf90: 7064 6174 6528 5b27 6127 2c20 2762 272c  pdate(['a', 'b',
+0002cfa0: 2027 6327 5d29 0a20 2020 2020 2020 2061   'c']).        a
+0002cfb0: 7272 6179 285b 2761 272c 2027 6227 2c20  rray(['a', 'b', 
+0002cfc0: 2763 275d 2c20 6474 7970 653d 6f62 6a65  'c'], dtype=obje
+0002cfd0: 6374 290a 0a20 2020 2020 2020 2060 6060  ct)..        ```
+0002cfe0: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
+0002cff0: 6c65 6e28 6974 656d 2920 3d3d 2030 3a0a  len(item) == 0:.
+0002d000: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0002d010: 7461 6e63 6528 6974 656d 2c20 6e70 2e6e  tance(item, np.n
+0002d020: 6461 7272 6179 293a 0a20 2020 2020 2020  darray):.       
+0002d030: 2020 2020 2072 6574 7572 6e20 6974 656d       return item
+0002d040: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0002d050: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0002d060: 6e20 6e70 2e61 7272 6179 285b 5d29 0a20  n np.array([]). 
+0002d070: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002d080: 2069 6620 6973 696e 7374 616e 6365 2869   if isinstance(i
+0002d090: 7465 6d2c 206e 702e 6e64 6172 7261 7929  tem, np.ndarray)
+0002d0a0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0002d0b0: 2069 7373 7562 636c 6173 7328 7479 7065   issubclass(type
+0002d0c0: 2869 7465 6d5b 305d 292c 2073 7472 293a  (item[0]), str):
+0002d0d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d0e0: 2069 6620 6973 7375 6263 6c61 7373 2869   if issubclass(i
+0002d0f0: 7465 6d2e 6474 7970 652e 7479 7065 2c20  tem.dtype.type, 
+0002d100: 6e70 2e6f 626a 6563 745f 293a 0a20 2020  np.object_):.   
+0002d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d120: 2076 6172 6961 626c 655f 6f75 7420 3d20   variable_out = 
+0002d130: 6974 656d 0a20 2020 2020 2020 2020 2020  item.           
+0002d140: 2020 2020 2065 6c69 6620 6973 7375 6263       elif issubc
+0002d150: 6c61 7373 2869 7465 6d2e 6474 7970 652e  lass(item.dtype.
+0002d160: 7479 7065 2c20 7374 7229 3a0a 2020 2020  type, str):.    
+0002d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d180: 7661 7269 6162 6c65 5f6f 7574 203d 2069  variable_out = i
+0002d190: 7465 6d2e 6173 7479 7065 2827 6f62 6a65  tem.astype('obje
+0002d1a0: 6374 2729 0a20 2020 2020 2020 2020 2020  ct').           
+0002d1b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0002d1c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0002d1d0: 6169 7365 2045 7863 6570 7469 6f6e 2866  aise Exception(f
+0002d1e0: 2254 7970 653a 207b 7479 7065 2869 7465  "Type: {type(ite
+0002d1f0: 6d5b 305d 297d 206e 6f74 2069 6d70 6c65  m[0])} not imple
+0002d200: 6d65 6e74 6564 2e20 4974 656d 3a20 7b69  mented. Item: {i
+0002d210: 7465 6d7d 2229 0a20 2020 2020 2020 2020  tem}").         
+0002d220: 2020 2065 6c69 6620 6973 7375 6263 6c61     elif issubcla
+0002d230: 7373 2869 7465 6d2e 6474 7970 652e 7479  ss(item.dtype.ty
+0002d240: 7065 2c20 6e70 2e6f 626a 6563 745f 293a  pe, np.object_):
+0002d250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d260: 2069 6620 6973 7375 6263 6c61 7373 2874   if issubclass(t
+0002d270: 7970 6528 6974 656d 5b30 5d29 2c20 696e  ype(item[0]), in
+0002d280: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0002d290: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+0002d2a0: 5f6f 7574 203d 2069 7465 6d2e 6173 7479  _out = item.asty
+0002d2b0: 7065 286e 702e 696e 7433 3229 0a20 2020  pe(np.int32).   
+0002d2c0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+0002d2d0: 6620 6973 696e 7374 616e 6365 2874 7970  f isinstance(typ
+0002d2e0: 6528 6974 656d 5b30 5d29 2c20 666c 6f61  e(item[0]), floa
+0002d2f0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0002d300: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+0002d310: 5f6f 7574 203d 2069 7465 6d2e 6173 7479  _out = item.asty
+0002d320: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
+0002d330: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002d340: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002d350: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
+0002d360: 7863 6570 7469 6f6e 2866 2254 7970 653a  xception(f"Type:
+0002d370: 207b 7479 7065 2869 7465 6d5b 305d 297d   {type(item[0])}
+0002d380: 206e 6f74 2069 6d70 6c65 6d65 6e74 6564   not implemented
+0002d390: 2e20 4974 656d 3a20 7b69 7465 6d7d 2229  . Item: {item}")
+0002d3a0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0002d3b0: 6620 6973 7375 6263 6c61 7373 2869 7465  f issubclass(ite
+0002d3c0: 6d2e 6474 7970 652e 7479 7065 2c20 286e  m.dtype.type, (n
+0002d3d0: 702e 696e 7431 362c 206e 702e 696e 7433  p.int16, np.int3
+0002d3e0: 322c 206e 702e 696e 7436 3429 293a 0a20  2, np.int64)):. 
+0002d3f0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0002d400: 6172 6961 626c 655f 6f75 7420 3d20 6974  ariable_out = it
+0002d410: 656d 0a20 2020 2020 2020 2020 2020 2065  em.            e
+0002d420: 6c69 6620 6973 7375 6263 6c61 7373 2869  lif issubclass(i
+0002d430: 7465 6d2e 6474 7970 652e 7479 7065 2c20  tem.dtype.type, 
+0002d440: 286e 702e 666c 6f61 7431 362c 206e 702e  (np.float16, np.
+0002d450: 666c 6f61 7433 322c 206e 702e 666c 6f61  float32, np.floa
+0002d460: 7436 3429 293a 0a20 2020 2020 2020 2020  t64)):.         
+0002d470: 2020 2020 2020 2076 6172 6961 626c 655f         variable_
+0002d480: 6f75 7420 3d20 6974 656d 0a20 2020 2020  out = item.     
+0002d490: 2020 2020 2020 2065 6c69 6620 6973 7375         elif issu
+0002d4a0: 6263 6c61 7373 2869 7465 6d2e 6474 7970  bclass(item.dtyp
+0002d4b0: 652e 7479 7065 2c20 6e70 2e64 6174 6574  e.type, np.datet
+0002d4c0: 696d 6536 3429 3a0a 2020 2020 2020 2020  ime64):.        
+0002d4d0: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+0002d4e0: 5f6f 7574 203d 2069 7465 6d0a 2020 2020  _out = item.    
+0002d4f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002d500: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0002d510: 6973 6520 4578 6365 7074 696f 6e28 6622  ise Exception(f"
+0002d520: 5479 7065 3a20 7b74 7970 6528 6974 656d  Type: {type(item
+0002d530: 5b30 5d29 7d20 6e6f 7420 696d 706c 656d  [0])} not implem
+0002d540: 656e 7465 642e 2049 7465 6d3a 207b 6974  ented. Item: {it
+0002d550: 656d 7d22 290a 2020 2020 2020 2020 656c  em}").        el
+0002d560: 6966 2069 7369 6e73 7461 6e63 6528 6974  if isinstance(it
+0002d570: 656d 2c20 6c69 7374 293a 0a20 2020 2020  em, list):.     
+0002d580: 2020 2020 2020 2076 616c 7565 5f74 7970         value_typ
+0002d590: 6520 3d20 7479 7065 2869 7465 6d5b 305d  e = type(item[0]
+0002d5a0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0002d5b0: 2069 7373 7562 636c 6173 7328 7661 6c75   issubclass(valu
+0002d5c0: 655f 7479 7065 2c20 7374 7229 3a0a 2020  e_type, str):.  
+0002d5d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002d5e0: 6c65 6374 6564 5f74 7970 6520 3d20 276f  lected_type = 'o
+0002d5f0: 626a 6563 7427 0a20 2020 2020 2020 2020  bject'.         
+0002d600: 2020 2065 6c69 6620 6973 7375 6263 6c61     elif issubcla
+0002d610: 7373 2876 616c 7565 5f74 7970 652c 2069  ss(value_type, i
+0002d620: 6e74 293a 0a20 2020 2020 2020 2020 2020  nt):.           
+0002d630: 2020 2020 2073 656c 6563 7465 645f 7479       selected_ty
+0002d640: 7065 203d 206e 702e 696e 7433 320a 2020  pe = np.int32.  
+0002d650: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+0002d660: 7373 7562 636c 6173 7328 7661 6c75 655f  ssubclass(value_
+0002d670: 7479 7065 2c20 666c 6f61 7429 3a0a 2020  type, float):.  
+0002d680: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002d690: 6c65 6374 6564 5f74 7970 6520 3d20 6e70  lected_type = np
+0002d6a0: 2e66 6c6f 6174 3332 0a20 2020 2020 2020  .float32.       
+0002d6b0: 2020 2020 2065 6c69 6620 6973 7375 6263       elif issubc
+0002d6c0: 6c61 7373 2876 616c 7565 5f74 7970 652c  lass(value_type,
+0002d6d0: 206e 702e 6461 7465 7469 6d65 3634 293a   np.datetime64):
+0002d6e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d6f0: 2073 656c 6563 7465 645f 7479 7065 203d   selected_type =
+0002d700: 2027 6461 7465 7469 6d65 3634 5b6e 735d   'datetime64[ns]
+0002d710: 270a 2020 2020 2020 2020 2020 2020 656c  '.            el
+0002d720: 6966 2069 7373 7562 636c 6173 7328 7661  if issubclass(va
+0002d730: 6c75 655f 7479 7065 2c20 286e 702e 696e  lue_type, (np.in
+0002d740: 7431 362c 206e 702e 696e 7433 322c 206e  t16, np.int32, n
+0002d750: 702e 696e 7436 3429 293a 0a20 2020 2020  p.int64)):.     
+0002d760: 2020 2020 2020 2020 2020 2073 656c 6563             selec
+0002d770: 7465 645f 7479 7065 203d 2069 7465 6d5b  ted_type = item[
+0002d780: 305d 2e64 7479 7065 0a20 2020 2020 2020  0].dtype.       
+0002d790: 2020 2020 2065 6c69 6620 6973 7375 6263       elif issubc
+0002d7a0: 6c61 7373 2876 616c 7565 5f74 7970 652c  lass(value_type,
+0002d7b0: 2028 6e70 2e66 6c6f 6174 3136 2c20 6e70   (np.float16, np
+0002d7c0: 2e66 6c6f 6174 3332 2c20 6e70 2e66 6c6f  .float32, np.flo
+0002d7d0: 6174 3634 2929 3a0a 2020 2020 2020 2020  at64)):.        
+0002d7e0: 2020 2020 2020 2020 7365 6c65 6374 6564          selected
+0002d7f0: 5f74 7970 6520 3d20 6974 656d 5b30 5d2e  _type = item[0].
+0002d800: 6474 7970 650a 2020 2020 2020 2020 2020  dtype.          
+0002d810: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0002d820: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
+0002d830: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
+0002d840: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
+0002d850: 7970 653a 207b 7479 7065 2869 7465 6d5b  ype: {type(item[
+0002d860: 305d 297d 206e 6f74 2069 6d70 6c65 6d65  0])} not impleme
+0002d870: 6e74 6564 2e20 4974 656d 3a20 7b69 7465  nted. Item: {ite
+0002d880: 6d7d 2229 0a20 2020 2020 2020 2020 2020  m}").           
+0002d890: 2076 6172 6961 626c 655f 6f75 7420 3d20   variable_out = 
+0002d8a0: 6e70 2e61 7272 6179 2869 7465 6d2c 2064  np.array(item, d
+0002d8b0: 7479 7065 3d73 656c 6563 7465 645f 7479  type=selected_ty
+0002d8c0: 7065 290a 2020 2020 2020 2020 656c 6966  pe).        elif
+0002d8d0: 205f 6973 696e 7374 616e 6365 5f6f 7074   _isinstance_opt
+0002d8e0: 696f 6e61 6c5f 706b 6773 2869 7465 6d2c  ional_pkgs(item,
+0002d8f0: 2027 7064 2e44 6174 6574 696d 6549 6e64   'pd.DatetimeInd
+0002d900: 6578 2729 3a0a 2020 2020 2020 2020 2020  ex'):.          
+0002d910: 2020 7661 7269 6162 6c65 5f6f 7574 203d    variable_out =
+0002d920: 2069 7465 6d2e 7661 6c75 6573 0a20 2020   item.values.   
+0002d930: 2020 2020 2065 6c69 6620 5f69 7369 6e73       elif _isins
+0002d940: 7461 6e63 655f 6f70 7469 6f6e 616c 5f70  tance_optional_p
+0002d950: 6b67 7328 6974 656d 2c20 2770 642e 4361  kgs(item, 'pd.Ca
+0002d960: 7465 676f 7269 6361 6c27 293a 0a20 2020  tegorical'):.   
+0002d970: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
+0002d980: 655f 6f75 7420 3d20 6974 656d 2e74 6f5f  e_out = item.to_
+0002d990: 6e75 6d70 7928 636f 7079 3d54 7275 6529  numpy(copy=True)
+0002d9a0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0002d9b0: 2020 2020 2020 2020 2020 2045 7863 6570             Excep
+0002d9c0: 7469 6f6e 2866 2254 7970 653a 207b 7479  tion(f"Type: {ty
+0002d9d0: 7065 2869 7465 6d29 7d20 6e6f 7420 696d  pe(item)} not im
+0002d9e0: 706c 656d 656e 7465 642e 2049 7465 6d3a  plemented. Item:
+0002d9f0: 207b 6974 656d 7d22 290a 0a20 2020 2020   {item}")..     
+0002da00: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
+0002da10: 616e 6365 2876 6172 6961 626c 655f 6f75  ance(variable_ou
+0002da20: 742c 206e 702e 6e64 6172 7261 7929 2c20  t, np.ndarray), 
+0002da30: 6622 5479 7065 3a20 7b74 7970 6528 6974  f"Type: {type(it
+0002da40: 656d 297d 206e 6f74 2069 6d70 6c65 6d65  em)} not impleme
+0002da50: 6e74 6564 2e20 4974 656d 3a20 7b69 7465  nted. Item: {ite
+0002da60: 6d7d 220a 2020 2020 2020 2020 6173 7365  m}".        asse
+0002da70: 7274 2076 6172 6961 626c 655f 6f75 742e  rt variable_out.
+0002da80: 6e64 696d 203d 3d20 312c 2022 4f6e 6c79  ndim == 1, "Only
+0002da90: 2031 4420 6172 7261 7973 2061 7265 2073   1D arrays are s
+0002daa0: 7570 706f 7274 6564 220a 2020 2020 2020  upported".      
+0002dab0: 2020 7265 7475 726e 2076 6172 6961 626c    return variabl
+0002dac0: 655f 6f75 740a 0a0a 6465 6620 5f74 6573  e_out...def _tes
+0002dad0: 745f 7479 7065 5f61 6e64 5f75 7064 6174  t_type_and_updat
+0002dae0: 655f 7661 6c75 6528 7661 6c75 653a 2055  e_value(value: U
+0002daf0: 6e69 6f6e 5b6e 702e 6e64 6172 7261 792c  nion[np.ndarray,
+0002db00: 206c 6973 742c 2066 6c6f 6174 2c20 696e   list, float, in
+0002db10: 742c 2062 6f6f 6c2c 206e 702e 626f 6f6c  t, bool, np.bool
+0002db20: 5f2c 206e 702e 696e 7431 362c 206e 702e  _, np.int16, np.
+0002db30: 696e 7433 322c 206e 702e 696e 7436 342c  int32, np.int64,
+0002db40: 206e 702e 666c 6f61 7431 362c 206e 702e   np.float16, np.
+0002db50: 666c 6f61 7433 322c 206e 702e 666c 6f61  float32, np.floa
+0002db60: 7436 345d 2920 2d3e 206e 702e 6e64 6172  t64]) -> np.ndar
+0002db70: 7261 793a 0a20 2020 2061 7373 6572 7420  ray:.    assert 
+0002db80: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
+0002db90: 2c20 286e 702e 6e64 6172 7261 792c 206c  , (np.ndarray, l
+0002dba0: 6973 742c 2066 6c6f 6174 2c20 696e 742c  ist, float, int,
+0002dbb0: 2062 6f6f 6c2c 206e 702e 626f 6f6c 5f2c   bool, np.bool_,
+0002dbc0: 206e 702e 696e 7431 362c 206e 702e 696e   np.int16, np.in
+0002dbd0: 7433 322c 206e 702e 696e 7436 342c 206e  t32, np.int64, n
+0002dbe0: 702e 666c 6f61 7431 362c 0a20 2020 2020  p.float16,.     
+0002dbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dc00: 206e 702e 666c 6f61 7433 322c 206e 702e   np.float32, np.
+0002dc10: 666c 6f61 7436 3429 292c 2066 2256 616c  float64)), f"Val
+0002dc20: 7565 2061 7474 7269 6275 7465 206d 7573  ue attribute mus
+0002dc30: 7420 6265 2061 206e 756d 7079 2061 7272  t be a numpy arr
+0002dc40: 6179 2c20 6c69 7374 2c20 666c 6f61 742c  ay, list, float,
+0002dc50: 2069 6e74 2c20 6f72 2062 6f6f 6c2e 2047   int, or bool. G
+0002dc60: 6f74 207b 7479 7065 2876 616c 7565 297d  ot {type(value)}
+0002dc70: 220a 2020 2020 6966 2069 7369 6e73 7461  ".    if isinsta
+0002dc80: 6e63 6528 7661 6c75 652c 206e 702e 6e64  nce(value, np.nd
+0002dc90: 6172 7261 7929 3a0a 2020 2020 2020 2020  array):.        
+0002dca0: 6173 7365 7274 2069 7373 7562 636c 6173  assert issubclas
+0002dcb0: 7328 7661 6c75 652e 6474 7970 652e 7479  s(value.dtype.ty
+0002dcc0: 7065 2c20 286e 702e 626f 6f6c 5f2c 206e  pe, (np.bool_, n
+0002dcd0: 702e 696e 7431 362c 206e 702e 696e 7433  p.int16, np.int3
+0002dce0: 322c 206e 702e 696e 7436 342c 206e 702e  2, np.int64, np.
+0002dcf0: 666c 6f61 7431 362c 206e 702e 666c 6f61  float16, np.floa
+0002dd00: 7433 322c 206e 702e 666c 6f61 7436 3429  t32, np.float64)
+0002dd10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002dd20: 2020 2020 2020 2020 2020 2029 2c20 2264             ), "d
+0002dd30: 7479 7065 2073 7570 706f 6572 7465 6420  type suppoerted 
+0002dd40: 666f 7220 7661 6c75 6520 6174 7472 6962  for value attrib
+0002dd50: 7574 653a 206e 702e 626f 6f6c 5f2c 206e  ute: np.bool_, n
+0002dd60: 702e 696e 7431 362c 206e 702e 696e 7433  p.int16, np.int3
+0002dd70: 322c 206e 702e 696e 7436 342c 206e 702e  2, np.int64, np.
+0002dd80: 666c 6f61 7431 362c 206e 702e 666c 6f61  float16, np.floa
+0002dd90: 7433 322c 206e 702e 666c 6f61 7436 3422  t32, np.float64"
+0002dda0: 0a20 2020 2020 2020 2069 6620 7661 6c75  .        if valu
+0002ddb0: 652e 6e64 696d 203d 3d20 303a 0a20 2020  e.ndim == 0:.   
+0002ddc0: 2020 2020 2020 2020 2076 616c 7565 203d           value =
+0002ddd0: 2076 616c 7565 2e72 6573 6861 7065 2828   value.reshape((
+0002dde0: 7661 6c75 652e 7369 7a65 2c29 290a 2020  value.size,)).  
+0002ddf0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+0002de00: 6528 7661 6c75 652c 2028 666c 6f61 742c  e(value, (float,
+0002de10: 2069 6e74 2c20 626f 6f6c 2c20 6e70 2e62   int, bool, np.b
+0002de20: 6f6f 6c5f 2c20 6e70 2e69 6e74 3136 2c20  ool_, np.int16, 
+0002de30: 6e70 2e69 6e74 3332 2c20 6e70 2e69 6e74  np.int32, np.int
+0002de40: 3634 2c20 6e70 2e66 6c6f 6174 3136 2c20  64, np.float16, 
+0002de50: 6e70 2e66 6c6f 6174 3332 2c20 6e70 2e66  np.float32, np.f
+0002de60: 6c6f 6174 3634 2929 3a0a 2020 2020 2020  loat64)):.      
+0002de70: 2020 7661 6c75 6520 3d20 6e70 2e61 7272    value = np.arr
+0002de80: 6179 285b 7661 6c75 655d 290a 2020 2020  ay([value]).    
+0002de90: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+0002dea0: 7661 6c75 652c 206c 6973 7429 3a0a 2020  value, list):.  
+0002deb0: 2020 2020 2020 6966 2076 616c 7565 3a0a        if value:.
+0002dec0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0002ded0: 7369 6e73 7461 6e63 6528 7661 6c75 655b  sinstance(value[
+0002dee0: 305d 2c20 7374 7229 3a0a 2020 2020 2020  0], str):.      
+0002def0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0002df00: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+0002df10: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0002df20: 2020 2020 2020 2020 2022 4c6f 6e67 206f           "Long o
+0002df30: 626a 6563 7420 646f 6573 206e 6f74 2073  bject does not s
+0002df40: 7570 706f 7274 2073 7472 696e 6720 7661  upport string va
+0002df50: 6c75 6573 2066 6f72 2076 616c 7565 2061  lues for value a
+0002df60: 7474 7269 6275 7465 2229 0a20 2020 2020  ttribute").     
+0002df70: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+0002df80: 7374 616e 6365 2876 616c 7565 5b30 5d2c  stance(value[0],
+0002df90: 2028 696e 742c 2066 6c6f 6174 2c20 626f   (int, float, bo
+0002dfa0: 6f6c 2929 3a0a 2020 2020 2020 2020 2020  ol)):.          
+0002dfb0: 2020 2020 2020 7661 6c75 6520 3d20 6e70        value = np
+0002dfc0: 2e61 7272 6179 2876 616c 7565 290a 2020  .array(value).  
+0002dfd0: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+0002dfe0: 7369 6e73 7461 6e63 6528 7661 6c75 655b  sinstance(value[
+0002dff0: 305d 2c20 6e70 2e6e 6461 7272 6179 293a  0], np.ndarray):
+0002e000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e010: 2069 6620 6973 7375 6263 6c61 7373 2876   if issubclass(v
+0002e020: 616c 7565 5b30 5d2e 6474 7970 652e 7479  alue[0].dtype.ty
+0002e030: 7065 2c20 286e 702e 626f 6f6c 5f2c 206e  pe, (np.bool_, n
+0002e040: 702e 696e 7431 362c 206e 702e 696e 7433  p.int16, np.int3
+0002e050: 322c 206e 702e 696e 7436 342c 206e 702e  2, np.int64, np.
+0002e060: 666c 6f61 7431 362c 206e 702e 666c 6f61  float16, np.floa
+0002e070: 7433 322c 206e 702e 666c 6f61 7436 3429  t32, np.float64)
+0002e080: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0002e090: 2020 2020 2020 2076 616c 7565 203d 206e         value = n
+0002e0a0: 702e 6172 7261 7928 7661 6c75 652c 2064  p.array(value, d
+0002e0b0: 7479 7065 3d76 616c 7565 5b30 5d2e 6474  type=value[0].dt
+0002e0c0: 7970 6529 0a20 2020 2020 2020 2020 2020  ype).           
+0002e0d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0002e0e0: 2020 2020 2020 2020 2020 2020 2020 2045                 E
+0002e0f0: 7863 6570 7469 6f6e 2822 4e65 7374 6564  xception("Nested
+0002e100: 2061 7272 6179 7320 6e6f 7420 7375 7070   arrays not supp
+0002e110: 6f72 7465 6422 290a 2020 2020 2020 2020  orted").        
+0002e120: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002e130: 2020 7661 6c75 6520 3d20 6e70 2e61 7272    value = np.arr
+0002e140: 6179 2876 616c 7565 2c20 6474 7970 653d  ay(value, dtype=
+0002e150: 4e6f 6e65 290a 2020 2020 656c 7365 3a0a  None).    else:.
+0002e160: 2020 2020 2020 2020 4578 6365 7074 696f          Exceptio
+0002e170: 6e28 0a20 2020 2020 2020 2020 2020 2066  n(.            f
+0002e180: 2256 616c 7565 2061 7474 7269 6275 7465  "Value attribute
+0002e190: 206d 7573 7420 6265 2061 206e 756d 7079   must be a numpy
+0002e1a0: 2061 7272 6179 2c20 6c69 7374 2c20 666c   array, list, fl
+0002e1b0: 6f61 742c 2069 6e74 2c20 6f72 2062 6f6f  oat, int, or boo
+0002e1c0: 6c2e 2047 6f74 207b 7479 7065 2876 616c  l. Got {type(val
+0002e1d0: 7565 297d 2229 0a20 2020 2061 7373 6572  ue)}").    asser
+0002e1e0: 7420 6973 696e 7374 616e 6365 280a 2020  t isinstance(.  
+0002e1f0: 2020 2020 2020 7661 6c75 652c 206e 702e        value, np.
+0002e200: 6e64 6172 7261 7929 2c20 6622 4166 7465  ndarray), f"Afte
+0002e210: 7220 7661 6c69 6461 7469 6f6e 2c20 5661  r validation, Va
+0002e220: 6c75 6520 6174 7472 6962 7574 6520 6d75  lue attribute mu
+0002e230: 7374 2062 6520 6120 6e75 6d70 7920 6172  st be a numpy ar
+0002e240: 7261 792e 2047 6f74 207b 7479 7065 2876  ray. Got {type(v
+0002e250: 616c 7565 297d 220a 2020 2020 6173 7365  alue)}".    asse
+0002e260: 7274 2076 616c 7565 2e6e 6469 6d20 3d3d  rt value.ndim ==
+0002e270: 2031 2c20 224f 6e6c 7920 3144 2061 7272   1, "Only 1D arr
+0002e280: 6179 7320 6172 6520 7375 7070 6f72 7465  ays are supporte
+0002e290: 6422 0a20 2020 2072 6574 7572 6e20 7661  d".    return va
+0002e2a0: 6c75 650a 0a0a 6465 6620 5f66 6f72 6d61  lue...def _forma
+0002e2b0: 745f 6279 7465 7328 7369 7a65 3a20 696e  t_bytes(size: in
+0002e2c0: 7429 202d 3e20 7374 723a 0a20 2020 2022  t) -> str:.    "
+0002e2d0: 2222 0a20 2020 2046 6f72 6d61 7420 6120  "".    Format a 
+0002e2e0: 6279 7465 2073 697a 6520 6173 2061 2068  byte size as a h
+0002e2f0: 756d 616e 2d72 6561 6461 626c 6520 7374  uman-readable st
+0002e300: 7269 6e67 2e0a 0a20 2020 2041 7267 733a  ring...    Args:
+0002e310: 0a20 2020 2020 2020 2073 697a 653a 2053  .        size: S
+0002e320: 697a 6520 696e 2062 7974 6573 2e0a 0a20  ize in bytes... 
+0002e330: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
+0002e340: 2020 2020 4120 6875 6d61 6e2d 7265 6164      A human-read
+0002e350: 6162 6c65 2073 7472 696e 6720 7265 7072  able string repr
+0002e360: 6573 656e 7461 7469 6f6e 206f 6620 7468  esentation of th
+0002e370: 6520 6279 7465 2073 697a 652e 0a0a 2020  e byte size...  
+0002e380: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
+0002e390: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+0002e3a0: 2020 2020 203e 3e3e 205f 666f 726d 6174       >>> _format
+0002e3b0: 5f62 7974 6573 2831 3032 3429 0a20 2020  _bytes(1024).   
+0002e3c0: 2020 2020 2027 312e 3020 4b42 270a 2020       '1.0 KB'.  
+0002e3d0: 2020 2020 2020 3e3e 3e20 5f66 6f72 6d61        >>> _forma
+0002e3e0: 745f 6279 7465 7328 3130 3438 3537 3629  t_bytes(1048576)
+0002e3f0: 0a20 2020 2020 2020 2027 312e 3020 4d42  .        '1.0 MB
+0002e400: 270a 0a20 2020 2020 2020 2060 6060 0a20  '..        ```. 
+0002e410: 2020 2022 2222 0a20 2020 2070 6f77 6572     """.    power
+0002e420: 5f6c 6162 656c 7320 3d20 7b34 303a 2022  _labels = {40: "
+0002e430: 5442 222c 2033 303a 2022 4742 222c 2032  TB", 30: "GB", 2
+0002e440: 303a 2022 4d42 222c 2031 303a 2022 4b42  0: "MB", 10: "KB
+0002e450: 227d 0a20 2020 2066 6f72 2070 6f77 6572  "}.    for power
+0002e460: 2c20 6c61 6265 6c20 696e 2070 6f77 6572  , label in power
+0002e470: 5f6c 6162 656c 732e 6974 656d 7328 293a  _labels.items():
+0002e480: 0a20 2020 2020 2020 2069 6620 7369 7a65  .        if size
+0002e490: 203e 3d20 3220 2a2a 2070 6f77 6572 3a0a   >= 2 ** power:.
+0002e4a0: 2020 2020 2020 2020 2020 2020 6170 7072              appr
+0002e4b0: 6f78 5f73 697a 6520 3d20 7369 7a65 202f  ox_size = size /
+0002e4c0: 2032 202a 2a20 706f 7765 720a 2020 2020   2 ** power.    
+0002e4d0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+0002e4e0: 227b 6170 7072 6f78 5f73 697a 653a 2e31  "{approx_size:.1
+0002e4f0: 667d 207b 6c61 6265 6c7d 220a 2020 2020  f} {label}".    
+0002e500: 7265 7475 726e 2066 227b 7369 7a65 7d20  return f"{size} 
+0002e510: 6279 7465 7322 0a0a 0a64 6566 205f 6973  bytes"...def _is
+0002e520: 5f69 6e5f 7261 6e67 6528 7374 6172 743a  _in_range(start:
+0002e530: 2069 6e74 2c20 656e 643a 2069 6e74 2c20   int, end: int, 
+0002e540: 6c6f 7765 723a 2069 6e74 2c20 7570 7065  lower: int, uppe
+0002e550: 723a 2069 6e74 2c20 7374 6570 3a20 696e  r: int, step: in
+0002e560: 7420 3d20 3129 202d 3e20 626f 6f6c 3a0a  t = 1) -> bool:.
+0002e570: 2020 2020 2222 220a 2020 2020 4368 6563      """.    Chec
+0002e580: 6b20 6265 666f 7265 2070 6173 7369 6e67  k before passing
+0002e590: 2073 6c69 6365 7320 6966 2074 6865 7920   slices if they 
+0002e5a0: 6172 6520 696e 2074 6865 2065 7870 6563  are in the expec
+0002e5b0: 7465 6420 7261 6e67 652e 0a0a 2020 2020  ted range...    
+0002e5c0: 4172 6773 3a0a 2020 2020 2020 2020 7374  Args:.        st
+0002e5d0: 6172 743a 2053 7461 7274 206f 6620 7468  art: Start of th
+0002e5e0: 6520 736c 6963 650a 2020 2020 2020 2020  e slice.        
+0002e5f0: 656e 643a 2045 6e64 206f 6620 7468 6520  end: End of the 
+0002e600: 736c 6963 650a 2020 2020 2020 2020 7570  slice.        up
+0002e610: 7065 723a 2055 7070 6572 2062 6f75 6e64  per: Upper bound
+0002e620: 0a20 2020 2020 2020 206c 6f77 6572 3a20  .        lower: 
+0002e630: 4c6f 7765 7220 626f 756e 640a 2020 2020  Lower bound.    
+0002e640: 2020 2020 7374 6570 3a20 5374 6570 2073      step: Step s
+0002e650: 697a 650a 0a20 2020 2052 6169 7365 733a  ize..    Raises:
+0002e660: 0a20 2020 2020 2020 2041 7373 6572 7469  .        Asserti
+0002e670: 6f6e 4572 726f 723a 2049 6620 7468 6520  onError: If the 
+0002e680: 736c 6963 6520 6973 206e 6f74 2069 6e20  slice is not in 
+0002e690: 7468 6520 6578 7065 6374 6564 2072 616e  the expected ran
+0002e6a0: 6765 2e0a 0a20 2020 2052 6574 7572 6e73  ge...    Returns
+0002e6b0: 3a0a 2020 2020 2020 2020 5472 7565 2069  :.        True i
+0002e6c0: 6620 7468 6520 736c 6963 6520 6973 2069  f the slice is i
+0002e6d0: 6e20 7468 6520 6578 7065 6374 6564 2072  n the expected r
+0002e6e0: 616e 6765 2c20 7261 6973 6573 2061 6e20  ange, raises an 
+0002e6f0: 6578 6365 7074 696f 6e20 6f74 6865 7277  exception otherw
+0002e700: 6973 652e 0a20 2020 2022 2222 0a20 2020  ise..    """.   
+0002e710: 2061 7373 6572 7420 7374 6570 2069 6e20   assert step in 
+0002e720: 5b31 2c20 2d31 5d0a 2020 2020 6966 2073  [1, -1].    if s
+0002e730: 7461 7274 203e 2030 3a0a 2020 2020 2020  tart > 0:.      
+0002e740: 2020 6173 7365 7274 2073 7461 7274 203c    assert start <
+0002e750: 2075 7070 6572 2061 6e64 2073 7461 7274   upper and start
+0002e760: 203e 3d20 6c6f 7765 722c 2066 227b 7374   >= lower, f"{st
+0002e770: 6172 743d 7d20 3c20 7b75 7070 6572 3d7d  art=} < {upper=}
+0002e780: 2061 6e64 207b 7374 6172 743d 7d20 3e3d   and {start=} >=
+0002e790: 207b 6c6f 7765 723d 7d22 0a20 2020 2020   {lower=}".     
+0002e7a0: 2020 2061 7373 6572 7420 656e 6420 3e20     assert end > 
+0002e7b0: 7374 6172 7420 6f72 2065 6e64 203c 2030  start or end < 0
+0002e7c0: 2c20 6622 7b65 6e64 3d7d 203e 207b 7374  , f"{end=} > {st
+0002e7d0: 6172 743d 7d20 6f72 207b 656e 643d 7d20  art=} or {end=} 
+0002e7e0: 3c20 3022 0a20 2020 2020 2020 2069 6620  < 0".        if 
+0002e7f0: 656e 6420 3c20 303a 0a20 2020 2020 2020  end < 0:.       
+0002e800: 2020 2020 2061 7373 6572 7420 656e 6420       assert end 
+0002e810: 3e3d 202d 7570 7065 7220 616e 6420 656e  >= -upper and en
+0002e820: 6420 3c3d 202d 6c6f 7765 722c 2066 227b  d <= -lower, f"{
+0002e830: 656e 643d 7d20 3e3d 207b 2d75 7070 6572  end=} >= {-upper
+0002e840: 3d7d 2061 6e64 207b 656e 643d 7d20 3c3d  =} and {end=} <=
+0002e850: 207b 2d6c 6f77 6572 3d7d 220a 2020 2020   {-lower=}".    
+0002e860: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002e870: 2020 2020 2020 6173 7365 7274 2065 6e64        assert end
+0002e880: 203c 3d20 7570 7065 7220 616e 6420 656e   <= upper and en
+0002e890: 6420 3e3d 206c 6f77 6572 2c20 6622 7b65  d >= lower, f"{e
+0002e8a0: 6e64 3d7d 203c 3d20 7b75 7070 6572 3d7d  nd=} <= {upper=}
+0002e8b0: 2061 6e64 207b 656e 643d 7d20 3e3d 207b   and {end=} >= {
+0002e8c0: 6c6f 7765 723d 7d22 0a20 2020 2065 6c69  lower=}".    eli
+0002e8d0: 6620 7374 6172 7420 3c20 303a 0a20 2020  f start < 0:.   
+0002e8e0: 2020 2020 2061 7373 6572 7420 7374 6172       assert star
+0002e8f0: 7420 3e20 2d75 7070 6572 2061 6e64 2073  t > -upper and s
+0002e900: 7461 7274 203c 3d20 2d6c 6f77 6572 2c20  tart <= -lower, 
+0002e910: 6622 7b73 7461 7274 3d7d 203e 207b 2d75  f"{start=} > {-u
+0002e920: 7070 6572 3d7d 2061 6e64 207b 7374 6172  pper=} and {star
+0002e930: 743d 7d20 3c3d 207b 2d6c 6f77 6572 3d7d  t=} <= {-lower=}
+0002e940: 220a 2020 2020 2020 2020 6173 7365 7274  ".        assert
+0002e950: 2065 6e64 203e 202d 7570 7065 7220 616e   end > -upper an
+0002e960: 6420 656e 6420 3c3d 202d 6c6f 7765 722c  d end <= -lower,
+0002e970: 2066 227b 656e 643d 7d20 3e20 7b2d 7570   f"{end=} > {-up
+0002e980: 7065 723d 7d20 616e 6420 7b65 6e64 3d7d  per=} and {end=}
+0002e990: 203c 3d20 7b2d 6c6f 7765 723d 7d20 6173   <= {-lower=} as
+0002e9a0: 207b 7374 6172 743d 7d20 3c20 3022 0a20   {start=} < 0". 
+0002e9b0: 2020 2020 2020 2061 7373 6572 7420 656e         assert en
+0002e9c0: 6420 3e20 7374 6172 7420 616e 6420 656e  d > start and en
+0002e9d0: 6420 3c20 302c 2066 227b 656e 643d 7d20  d < 0, f"{end=} 
+0002e9e0: 3e20 7b73 7461 7274 3d7d 2061 6e64 207b  > {start=} and {
+0002e9f0: 656e 643d 7d20 3c20 3020 6173 207b 7374  end=} < 0 as {st
+0002ea00: 6172 743d 7d20 3c20 3022 0a20 2020 2065  art=} < 0".    e
+0002ea10: 6c73 653a 0a20 2020 2020 2020 2061 7373  lse:.        ass
+0002ea20: 6572 7420 7374 6172 7420 3c20 7570 7065  ert start < uppe
+0002ea30: 7220 616e 6420 7374 6172 7420 3e3d 206c  r and start >= l
+0002ea40: 6f77 6572 2c20 6622 7b73 7461 7274 3d7d  ower, f"{start=}
+0002ea50: 203c 207b 7570 7065 723d 7d20 616e 6420   < {upper=} and 
+0002ea60: 7b73 7461 7274 3d7d 203e 3d20 7b6c 6f77  {start=} >= {low
+0002ea70: 6572 3d7d 220a 2020 2020 2020 2020 6173  er=}".        as
+0002ea80: 7365 7274 2065 6e64 203e 2073 7461 7274  sert end > start
+0002ea90: 206f 7220 656e 6420 3c20 302c 2066 227b   or end < 0, f"{
+0002eaa0: 656e 643d 7d20 3e20 7b73 7461 7274 3d7d  end=} > {start=}
+0002eab0: 206f 7220 7b65 6e64 3d7d 203c 2030 2061   or {end=} < 0 a
+0002eac0: 7320 7b73 7461 7274 3d7d 203c 2030 220a  s {start=} < 0".
+0002ead0: 2020 2020 2020 2020 6966 2065 6e64 203c          if end <
+0002eae0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0002eaf0: 6173 7365 7274 2065 6e64 203e 3d20 2d75  assert end >= -u
+0002eb00: 7070 6572 2061 6e64 2065 6e64 203c 202d  pper and end < -
+0002eb10: 6c6f 7765 722c 2066 227b 656e 643d 7d20  lower, f"{end=} 
+0002eb20: 3e3d 207b 2d75 7070 6572 3d7d 2061 6e64  >= {-upper=} and
+0002eb30: 207b 656e 643d 7d20 3c20 7b2d 6c6f 7765   {end=} < {-lowe
+0002eb40: 723d 7d22 0a20 2020 2020 2020 2065 6c73  r=}".        els
+0002eb50: 653a 0a20 2020 2020 2020 2020 2020 2061  e:.            a
+0002eb60: 7373 6572 7420 656e 6420 3c3d 2075 7070  ssert end <= upp
+0002eb70: 6572 2061 6e64 2065 6e64 203e 206c 6f77  er and end > low
+0002eb80: 6572 2c20 6622 7b65 6e64 3d7d 203c 3d20  er, f"{end=} <= 
+0002eb90: 7b75 7070 6572 3d7d 2061 6e64 207b 656e  {upper=} and {en
+0002eba0: 643d 7d20 3e20 7b6c 6f77 6572 3d7d 220a  d=} > {lower=}".
+0002ebb0: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
```

### Comparing `karray-2024.3.6/src/karray.egg-info/PKG-INFO` & `karray-2024.3.7/src/karray.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: karray
-Version: 2024.3.6
+Version: 2024.3.7
 Summary: Lightweight labelled multidimensional arrays with NumPy arrays under the hood.
 Author-email: Carlos Gaete-Morales <cdgaete@gmail.com>
 License: MIT License
 Project-URL: Documentation, https://diw-evu.gitlab.io/karray
 Project-URL: Source-code, https://gitlab.com/diw-evu/karray
 Project-URL: Issue-tracker, https://gitlab.com/diw-evu/karray/issues
 Keywords: ndarray,labeled,multidimensional,element-wise,dense,sparse,arrays
```

### Comparing `karray-2024.3.6/tests/test_dense.py` & `karray-2024.3.7/tests/test_dense.py`

 * *Files identical despite different names*

### Comparing `karray-2024.3.6/tests/test_sparse.py` & `karray-2024.3.7/tests/test_sparse.py`

 * *Files identical despite different names*

